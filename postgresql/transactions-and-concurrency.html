<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transactions and Concurrency</title>

    <link rel="alternate" href="https://campusempresa.com/postgresql/transactions-and-concurrency" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/postgresql/transactions-and-concurrency" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/postgresql/transactions-and-concurrency" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/postgresql/transactions-and-concurrency" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/postgresql/transactions-and-concurrency" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='vacuuming-and-maintenance'>&#x25C4;Vacuuming and Maintenance</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Transactions and Concurrency</a>
	</div>
	<div class='col-4 text-end'>
					<a href='views-and-materialized-views'>Views and Materialized Views &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Transactions</h1>
<div class='content'><p>Transactions are a fundamental concept in databases, ensuring that a series of operations either complete successfully together or fail together, maintaining data integrity.</p>
<ul>
<li><strong>Atomicity</strong>: Ensures that all operations within a transaction are completed; if not, the transaction is aborted.</li>
<li><strong>Consistency</strong>: Ensures that a transaction brings the database from one valid state to another.</li>
<li><strong>Isolation</strong>: Ensures that transactions are securely and independently processed at the same time without interference.</li>
<li><strong>Durability</strong>: Ensures that once a transaction has been committed, it will remain so, even in the event of a system failure.</li>
</ul>
</div><h2>Basic Transaction Commands</h2>
<div class='content'><ul>
<li><code>BEGIN</code>: Starts a new transaction.</li>
<li><code>COMMIT</code>: Saves all changes made during the transaction.</li>
<li><code>ROLLBACK</code>: Reverts all changes made during the transaction.</li>
</ul>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkVHSU47CgpJTlNFUlQgSU5UTyBhY2NvdW50cyAodXNlcl9pZCwgYmFsYW5jZSkgVkFMVUVTICgxLCAxMDAwKTsKVVBEQVRFIGFjY291bnRzIFNFVCBiYWxhbmNlID0gYmFsYW5jZSAtIDEwMCBXSEVSRSB1c2VyX2lkID0gMTsKCkNPTU1JVDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BEGIN;

INSERT INTO accounts (user_id, balance) VALUES (1, 1000);
UPDATE accounts SET balance = balance - 100 WHERE user_id = 1;

COMMIT;</pre></div><div class='content'><p>In this example:</p>
<ol>
<li>A transaction is started with <code>BEGIN</code>.</li>
<li>A new account is inserted.</li>
<li>The balance of the account is updated.</li>
<li>The transaction is committed, making all changes permanent.</li>
</ol>
</div><h1>Concurrency Control</h1>
<div class='content'><p>Concurrency control is essential for ensuring that database transactions are performed concurrently without violating the integrity of the data.</p>
</div><h2>Isolation Levels</h2>
<div class='content'><p>PostgreSQL supports several isolation levels that control the visibility of changes made by concurrent transactions.</p>
<ul>
<li><strong>Read Uncommitted</strong>: Transactions can see uncommitted changes made by other transactions.</li>
<li><strong>Read Committed</strong>: A transaction sees only committed changes made by other transactions.</li>
<li><strong>Repeatable Read</strong>: Ensures that if a transaction reads a value, it will see the same value if it reads it again.</li>
<li><strong>Serializable</strong>: Ensures complete isolation from other transactions, providing the highest level of isolation.</li>
</ul>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VUIFRSQU5TQUNUSU9OIElTT0xBVElPTiBMRVZFTCBSRVBFQVRBQkxFIFJFQUQ7CgpCRUdJTjsKClNFTEVDVCBiYWxhbmNlIEZST00gYWNjb3VudHMgV0hFUkUgdXNlcl9pZCA9IDE7CgotLSBQZXJmb3JtIHNvbWUgb3BlcmF0aW9ucwoKQ09NTUlUOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;

BEGIN;

SELECT balance FROM accounts WHERE user_id = 1;

-- Perform some operations

COMMIT;</pre></div><div class='content'><p>In this example:</p>
<ol>
<li>The transaction isolation level is set to <code>REPEATABLE READ</code>.</li>
<li>A transaction is started.</li>
<li>The balance is read from the <code>accounts</code> table.</li>
<li>The transaction is committed.</li>
</ol>
</div><h2>Locking Mechanisms</h2>
<div class='content'><p>PostgreSQL uses locks to manage concurrent access to data.</p>
<ul>
<li><strong>Row-level locks</strong>: Lock individual rows.</li>
<li><strong>Table-level locks</strong>: Lock entire tables.</li>
</ul>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkVHSU47CgpTRUxFQ1QgKiBGUk9NIGFjY291bnRzIFdIRVJFIHVzZXJfaWQgPSAxIEZPUiBVUERBVEU7CgotLSBQZXJmb3JtIHNvbWUgb3BlcmF0aW9ucwoKQ09NTUlUOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BEGIN;

SELECT * FROM accounts WHERE user_id = 1 FOR UPDATE;

-- Perform some operations

COMMIT;</pre></div><div class='content'><p>In this example:</p>
<ol>
<li>A transaction is started.</li>
<li>A row-level lock is acquired on the selected row using <code>FOR UPDATE</code>.</li>
<li>Operations are performed.</li>
<li>The transaction is committed.</li>
</ol>
</div><h2>Deadlocks</h2>
<div class='content'><p>Deadlocks occur when two or more transactions are waiting for each other to release locks, causing a cycle of dependencies.</p>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gVHJhbnNhY3Rpb24gMQpCRUdJTjsKVVBEQVRFIGFjY291bnRzIFNFVCBiYWxhbmNlID0gYmFsYW5jZSAtIDEwMCBXSEVSRSB1c2VyX2lkID0gMTsKCi0tIFRyYW5zYWN0aW9uIDIKQkVHSU47ClVQREFURSBhY2NvdW50cyBTRVQgYmFsYW5jZSA9IGJhbGFuY2UgKyAxMDAgV0hFUkUgdXNlcl9pZCA9IDI7CgotLSBUcmFuc2FjdGlvbiAxClVQREFURSBhY2NvdW50cyBTRVQgYmFsYW5jZSA9IGJhbGFuY2UgKyAxMDAgV0hFUkUgdXNlcl9pZCA9IDI7IC0tIHdhaXRzIGZvciBUcmFuc2FjdGlvbiAyCgotLSBUcmFuc2FjdGlvbiAyClVQREFURSBhY2NvdW50cyBTRVQgYmFsYW5jZSA9IGJhbGFuY2UgLSAxMDAgV0hFUkUgdXNlcl9pZCA9IDE7IC0tIHdhaXRzIGZvciBUcmFuc2FjdGlvbiAx"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Transaction 1
BEGIN;
UPDATE accounts SET balance = balance - 100 WHERE user_id = 1;

-- Transaction 2
BEGIN;
UPDATE accounts SET balance = balance + 100 WHERE user_id = 2;

-- Transaction 1
UPDATE accounts SET balance = balance + 100 WHERE user_id = 2; -- waits for Transaction 2

-- Transaction 2
UPDATE accounts SET balance = balance - 100 WHERE user_id = 1; -- waits for Transaction 1</pre></div><div class='content'><p>In this example:</p>
<ol>
<li>Transaction 1 locks a row.</li>
<li>Transaction 2 locks another row.</li>
<li>Both transactions then wait for each other to release their locks, causing a deadlock.</li>
</ol>
</div><h1>Conclusion</h1>
<div class='content'><p>Understanding transactions and concurrency control is crucial for maintaining data integrity and performance in PostgreSQL. By mastering transaction commands, isolation levels, locking mechanisms, and handling deadlocks, you can ensure that your database operations are reliable and efficient.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='vacuuming-and-maintenance'>&#x25C4;Vacuuming and Maintenance</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Transactions and Concurrency</a>
	</div>
	<div class='col-4 text-end'>
					<a href='views-and-materialized-views'>Views and Materialized Views &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
