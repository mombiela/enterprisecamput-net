<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User-Defined Functions in PostgreSQL</title>

    <link rel="alternate" href="https://campusempresa.com/postgresql/user-defined-functions" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/postgresql/user-defined-functions" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/postgresql/user-defined-functions" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/postgresql/user-defined-functions" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/postgresql/user-defined-functions" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='string-functions'>&#x25C4;String Functions</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">User-Defined Functions in PostgreSQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-indexes'>Introduction to Indexes &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>User-defined functions (UDFs) in PostgreSQL allow you to encapsulate reusable code logic within the database. This can help improve code organization, maintainability, and performance. In this section, we will cover the basics of creating and using UDFs, progressing from simple examples to more advanced use cases.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Function Definition</strong>: The syntax and structure for defining a function.</li>
<li><strong>Function Parameters</strong>: How to pass input values to functions.</li>
<li><strong>Return Types</strong>: Different types of values that functions can return.</li>
<li><strong>Language Options</strong>: Various languages supported for writing functions.</li>
<li><strong>Error Handling</strong>: Techniques for managing errors within functions.</li>
</ul>
</div><h1>Creating a Simple Function</h1>
<div class='content'><p>To create a function in PostgreSQL, you use the <code>CREATE FUNCTION</code> statement. Here is a basic example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIGFkZF9udW1iZXJzKGEgSU5URUdFUiwgYiBJTlRFR0VSKSAKUkVUVVJOUyBJTlRFR0VSIEFTICQkCkJFR0lOCiAgICBSRVRVUk4gYSArIGI7CkVORDsKJCQgTEFOR1VBR0UgcGxwZ3NxbDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION add_numbers(a INTEGER, b INTEGER) 
RETURNS INTEGER AS $$
BEGIN
    RETURN a + b;
END;
$$ LANGUAGE plpgsql;</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><code>CREATE FUNCTION add_numbers(a INTEGER, b INTEGER)</code>: Defines a function named <code>add_numbers</code> with two integer parameters, <code>a</code> and <code>b</code>.</li>
<li><code>RETURNS INTEGER</code>: Specifies that the function returns an integer.</li>
<li><code>AS $$ ... $$ LANGUAGE plpgsql</code>: The function body is enclosed in <code>$$</code> and written in the <code>plpgsql</code> language.</li>
</ul>
</div><h2>Usage:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGFkZF9udW1iZXJzKDUsIDMpOyAgLS0gUmV0dXJucyA4"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT add_numbers(5, 3);  -- Returns 8</pre></div><div class='content'></div><h1>Function Parameters</h1>
<div class='content'><p>Functions can take different types of parameters, including default values and variadic parameters.</p>
</div><h2>Default Parameters:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIGdyZWV0KG5hbWUgVEVYVCBERUZBVUxUICdXb3JsZCcpIApSRVRVUk5TIFRFWFQgQVMgJCQKQkVHSU4KICAgIFJFVFVSTiAnSGVsbG8sICcgfHwgbmFtZSB8fCAnISc7CkVORDsKJCQgTEFOR1VBR0UgcGxwZ3NxbDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION greet(name TEXT DEFAULT 'World') 
RETURNS TEXT AS $$
BEGIN
    RETURN 'Hello, ' || name || '!';
END;
$$ LANGUAGE plpgsql;</pre></div><div class='content'></div><h2>Usage:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGdyZWV0KCk7ICAgICAgICAgLS0gUmV0dXJucyAnSGVsbG8sIFdvcmxkIScKU0VMRUNUIGdyZWV0KCdBbGljZScpOyAgLS0gUmV0dXJucyAnSGVsbG8sIEFsaWNlISc="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT greet();         -- Returns 'Hello, World!'
SELECT greet('Alice');  -- Returns 'Hello, Alice!'</pre></div><div class='content'></div><h2>Variadic Parameters:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIHN1bV9udW1iZXJzKFZBUklBRElDIG51bXMgSU5URUdFUltdKSAKUkVUVVJOUyBJTlRFR0VSIEFTICQkCkRFQ0xBUkUKICAgIHRvdGFsIElOVEVHRVIgOj0gMDsKQkVHSU4KICAgIEZPUkVBQ0ggbnVtIElOIEFSUkFZIG51bXMKICAgIExPT1AKICAgICAgICB0b3RhbCA6PSB0b3RhbCArIG51bTsKICAgIEVORCBMT09QOwogICAgUkVUVVJOIHRvdGFsOwpFTkQ7CiQkIExBTkdVQUdFIHBscGdzcWw7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION sum_numbers(VARIADIC nums INTEGER[]) 
RETURNS INTEGER AS $$
DECLARE
    total INTEGER := 0;
BEGIN
    FOREACH num IN ARRAY nums
    LOOP
        total := total + num;
    END LOOP;
    RETURN total;
END;
$$ LANGUAGE plpgsql;</pre></div><div class='content'></div><h2>Usage:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIHN1bV9udW1iZXJzKDEsIDIsIDMsIDQpOyAgLS0gUmV0dXJucyAxMA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT sum_numbers(1, 2, 3, 4);  -- Returns 10</pre></div><div class='content'></div><h1>Return Types</h1>
<div class='content'><p>Functions can return various types of values, including scalar values, composite types, and sets.</p>
</div><h2>Scalar Return Type:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIG11bHRpcGx5KGEgSU5URUdFUiwgYiBJTlRFR0VSKSAKUkVUVVJOUyBJTlRFR0VSIEFTICQkCkJFR0lOCiAgICBSRVRVUk4gYSAqIGI7CkVORDsKJCQgTEFOR1VBR0UgcGxwZ3NxbDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION multiply(a INTEGER, b INTEGER) 
RETURNS INTEGER AS $$
BEGIN
    RETURN a * b;
END;
$$ LANGUAGE plpgsql;</pre></div><div class='content'></div><h2>Composite Return Type:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFRZUEUgcGVyc29uIEFTIChmaXJzdF9uYW1lIFRFWFQsIGxhc3RfbmFtZSBURVhUKTsKCkNSRUFURSBGVU5DVElPTiBnZXRfcGVyc29uKCkgClJFVFVSTlMgcGVyc29uIEFTICQkCkJFR0lOCiAgICBSRVRVUk4gKCdKb2huJywgJ0RvZScpOwpFTkQ7CiQkIExBTkdVQUdFIHBscGdzcWw7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE TYPE person AS (first_name TEXT, last_name TEXT);

CREATE FUNCTION get_person() 
RETURNS person AS $$
BEGIN
    RETURN ('John', 'Doe');
END;
$$ LANGUAGE plpgsql;</pre></div><div class='content'></div><h2>Set Return Type:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIGdlbmVyYXRlX3NlcmllcyhzdGFydCBJTlRFR0VSLCBzdG9wIElOVEVHRVIpIApSRVRVUk5TIFNFVE9GIElOVEVHRVIgQVMgJCQKQkVHSU4KICAgIEZPUiBpIElOIHN0YXJ0Li5zdG9wIExPT1AKICAgICAgICBSRVRVUk4gTkVYVCBpOwogICAgRU5EIExPT1A7CiAgICBSRVRVUk47CkVORDsKJCQgTEFOR1VBR0UgcGxwZ3NxbDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION generate_series(start INTEGER, stop INTEGER) 
RETURNS SETOF INTEGER AS $$
BEGIN
    FOR i IN start..stop LOOP
        RETURN NEXT i;
    END LOOP;
    RETURN;
END;
$$ LANGUAGE plpgsql;</pre></div><div class='content'></div><h2>Usage:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUICogRlJPTSBnZW5lcmF0ZV9zZXJpZXMoMSwgNSk7ICAtLSBSZXR1cm5zIDEsIDIsIDMsIDQsIDU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT * FROM generate_series(1, 5);  -- Returns 1, 2, 3, 4, 5</pre></div><div class='content'></div><h1>Language Options</h1>
<div class='content'><p>PostgreSQL supports multiple languages for writing functions, including SQL, PL/pgSQL, PL/Python, PL/Perl, and more.</p>
</div><h2>SQL Language:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIGFkZF9zcWwoYSBJTlRFR0VSLCBiIElOVEVHRVIpIApSRVRVUk5TIElOVEVHRVIgQVMgJCQKICAgIFNFTEVDVCBhICsgYjsKJCQgTEFOR1VBR0Ugc3FsOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION add_sql(a INTEGER, b INTEGER) 
RETURNS INTEGER AS $$
    SELECT a + b;
$$ LANGUAGE sql;</pre></div><div class='content'></div><h2>PL/Python Language:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIGFkZF9weXRob24oYSBJTlRFR0VSLCBiIElOVEVHRVIpIApSRVRVUk5TIElOVEVHRVIgQVMgJCQKICAgIHJldHVybiBhICsgYgokJCBMQU5HVUFHRSBwbHB5dGhvbnU7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION add_python(a INTEGER, b INTEGER) 
RETURNS INTEGER AS $$
    return a + b
$$ LANGUAGE plpythonu;</pre></div><div class='content'></div><h1>Error Handling</h1>
<div class='content'><p>Error handling in functions is crucial for robust applications. You can use <code>EXCEPTION</code> blocks to catch and handle errors.</p>
</div><h2>Example:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIGRpdmlkZShhIElOVEVHRVIsIGIgSU5URUdFUikgClJFVFVSTlMgSU5URUdFUiBBUyAkJApCRUdJTgogICAgUkVUVVJOIGEgLyBiOwpFWENFUFRJT04KICAgIFdIRU4gZGl2aXNpb25fYnlfemVybyBUSEVOCiAgICAgICAgUkVUVVJOIE5VTEw7CkVORDsKJCQgTEFOR1VBR0UgcGxwZ3NxbDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION divide(a INTEGER, b INTEGER) 
RETURNS INTEGER AS $$
BEGIN
    RETURN a / b;
EXCEPTION
    WHEN division_by_zero THEN
        RETURN NULL;
END;
$$ LANGUAGE plpgsql;</pre></div><div class='content'></div><h2>Usage:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGRpdmlkZSgxMCwgMik7ICAtLSBSZXR1cm5zIDUKU0VMRUNUIGRpdmlkZSgxMCwgMCk7ICAtLSBSZXR1cm5zIE5VTEw="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT divide(10, 2);  -- Returns 5
SELECT divide(10, 0);  -- Returns NULL</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>User-defined functions in PostgreSQL provide a powerful way to encapsulate and reuse logic within your database. By understanding the basics of function creation, parameter handling, return types, language options, and error handling, you can write efficient and maintainable database code. Practice creating and using functions to become proficient in leveraging this feature in PostgreSQL.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='string-functions'>&#x25C4;String Functions</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">User-Defined Functions in PostgreSQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-indexes'>Introduction to Indexes &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
