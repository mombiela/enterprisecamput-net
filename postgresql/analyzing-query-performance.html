<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analyzing Query Performance</title>

    <link rel="alternate" href="https://campusempresa.com/postgresql/analyzing-query-performance" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/postgresql/analyzing-query-performance" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/postgresql/analyzing-query-performance" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/postgresql/analyzing-query-performance" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/postgresql/analyzing-query-performance" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='query-optimization'>&#x25C4;Query Optimization</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Analyzing Query Performance</a>
	</div>
	<div class='col-4 text-end'>
					<a href='vacuuming-and-maintenance'>Vacuuming and Maintenance &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Analyzing query performance is crucial for optimizing database operations and ensuring efficient data retrieval. In this section, we will cover the basics of query performance analysis in PostgreSQL, progressing from beginner to advanced techniques.</p>
</div><h1>Understanding Query Performance</h1>
<div class='content'><ul>
<li><strong>Query Execution Time</strong>: The duration it takes for a query to execute.</li>
<li><strong>Resource Utilization</strong>: CPU, memory, and I/O resources consumed by the query.</li>
<li><strong>Indexes</strong>: Structures that improve the speed of data retrieval.</li>
<li><strong>Query Plans</strong>: The sequence of operations PostgreSQL uses to execute a query.</li>
</ul>
</div><h1>Tools for Analyzing Query Performance</h1>
<h2>EXPLAIN and EXPLAIN ANALYZE</h2>
<div class='content'><ul>
<li><strong>EXPLAIN</strong>: Provides the execution plan of a query without running it.</li>
<li><strong>EXPLAIN ANALYZE</strong>: Executes the query and provides the execution plan along with actual run times.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gVXNpbmcgRVhQTEFJTgpFWFBMQUlOIFNFTEVDVCAqIEZST00gZW1wbG95ZWVzIFdIRVJFIGRlcGFydG1lbnQgPSAnU2FsZXMnOwoKLS0gVXNpbmcgRVhQTEFJTiBBTkFMWVpFCkVYUExBSU4gQU5BTFlaRSBTRUxFQ1QgKiBGUk9NIGVtcGxveWVlcyBXSEVSRSBkZXBhcnRtZW50ID0gJ1NhbGVzJzs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Using EXPLAIN
EXPLAIN SELECT * FROM employees WHERE department = 'Sales';

-- Using EXPLAIN ANALYZE
EXPLAIN ANALYZE SELECT * FROM employees WHERE department = 'Sales';</pre></div><div class='content'></div><h2>pg_stat_statements</h2>
<div class='content'><ul>
<li><strong>pg_stat_statements</strong>: An extension that tracks execution statistics of all SQL statements executed by a server.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRW5hYmxpbmcgcGdfc3RhdF9zdGF0ZW1lbnRzCkNSRUFURSBFWFRFTlNJT04gcGdfc3RhdF9zdGF0ZW1lbnRzOwoKLS0gUXVlcnlpbmcgcGdfc3RhdF9zdGF0ZW1lbnRzClNFTEVDVCAqIEZST00gcGdfc3RhdF9zdGF0ZW1lbnRzIE9SREVSIEJZIHRvdGFsX3RpbWUgREVTQyBMSU1JVCA1Ow=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Enabling pg_stat_statements
CREATE EXTENSION pg_stat_statements;

-- Querying pg_stat_statements
SELECT * FROM pg_stat_statements ORDER BY total_time DESC LIMIT 5;</pre></div><div class='content'></div><h1>Indexes and Their Impact</h1>
<h2>Types of Indexes</h2>
<div class='content'><ul>
<li><strong>B-tree Indexes</strong>: Default index type, suitable for most queries.</li>
<li><strong>Hash Indexes</strong>: Useful for equality comparisons.</li>
<li><strong>GIN and GiST Indexes</strong>: Suitable for full-text search and complex data types.</li>
</ul>
</div><h2>Creating and Using Indexes</h2>
<div class='content'><ul>
<li><strong>Creating an Index</strong>: Improves query performance by reducing the amount of data scanned.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ3JlYXRpbmcgYSBCLXRyZWUgaW5kZXgKQ1JFQVRFIElOREVYIGlkeF9kZXBhcnRtZW50IE9OIGVtcGxveWVlcyhkZXBhcnRtZW50KTsKCi0tIFF1ZXJ5IHVzaW5nIHRoZSBpbmRleApTRUxFQ1QgKiBGUk9NIGVtcGxveWVlcyBXSEVSRSBkZXBhcnRtZW50ID0gJ1NhbGVzJzs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Creating a B-tree index
CREATE INDEX idx_department ON employees(department);

-- Query using the index
SELECT * FROM employees WHERE department = 'Sales';</pre></div><div class='content'></div><h2>Analyzing Index Usage</h2>
<div class='content'><ul>
<li><strong>Checking Index Usage</strong>: Use the <code>EXPLAIN</code> command to see if an index is being used.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhQTEFJTiBTRUxFQ1QgKiBGUk9NIGVtcGxveWVlcyBXSEVSRSBkZXBhcnRtZW50ID0gJ1NhbGVzJzs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXPLAIN SELECT * FROM employees WHERE department = 'Sales';</pre></div><div class='content'></div><h1>Optimizing Queries</h1>
<h2>Query Rewriting</h2>
<div class='content'><ul>
<li><strong>Using Subqueries</strong>: Sometimes breaking down complex queries into subqueries can improve performance.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gVXNpbmcgYSBzdWJxdWVyeQpTRUxFQ1QgKiBGUk9NIGVtcGxveWVlcyBXSEVSRSBkZXBhcnRtZW50X2lkIElOIChTRUxFQ1QgaWQgRlJPTSBkZXBhcnRtZW50cyBXSEVSRSBuYW1lID0gJ1NhbGVzJyk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Using a subquery
SELECT * FROM employees WHERE department_id IN (SELECT id FROM departments WHERE name = 'Sales');</pre></div><div class='content'></div><h2>Avoiding Common Pitfalls</h2>
<div class='content'><ul>
<li>*<em>Avoiding SELECT <em>:</em></em> Specify only the columns you need.</li>
<li><strong>Using JOINs Efficiently</strong>: Ensure that JOINs are necessary and properly indexed.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQXZvaWRpbmcgU0VMRUNUICoKU0VMRUNUIGlkLCBuYW1lIEZST00gZW1wbG95ZWVzIFdIRVJFIGRlcGFydG1lbnQgPSAnU2FsZXMnOwoKLS0gRWZmaWNpZW50IEpPSU4KU0VMRUNUIGUubmFtZSwgZC5uYW1lIApGUk9NIGVtcGxveWVlcyBlCkpPSU4gZGVwYXJ0bWVudHMgZCBPTiBlLmRlcGFydG1lbnRfaWQgPSBkLmlkCldIRVJFIGQubmFtZSA9ICdTYWxlcyc7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Avoiding SELECT *
SELECT id, name FROM employees WHERE department = 'Sales';

-- Efficient JOIN
SELECT e.name, d.name 
FROM employees e
JOIN departments d ON e.department_id = d.id
WHERE d.name = 'Sales';</pre></div><div class='content'></div><h1>Advanced Techniques</h1>
<h2>Partitioning</h2>
<div class='content'><ul>
<li><strong>Partitioning Tables</strong>: Splitting large tables into smaller, more manageable pieces.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ3JlYXRpbmcgYSBwYXJ0aXRpb25lZCB0YWJsZQpDUkVBVEUgVEFCTEUgZW1wbG95ZWVzICgKICAgIGlkIFNFUklBTCBQUklNQVJZIEtFWSwKICAgIG5hbWUgVkFSQ0hBUigxMDApLAogICAgZGVwYXJ0bWVudCBWQVJDSEFSKDUwKSwKICAgIGhpcmVfZGF0ZSBEQVRFCikgUEFSVElUSU9OIEJZIFJBTkdFIChoaXJlX2RhdGUpOwoKLS0gQ3JlYXRpbmcgcGFydGl0aW9ucwpDUkVBVEUgVEFCTEUgZW1wbG95ZWVzXzIwMjAgUEFSVElUSU9OIE9GIGVtcGxveWVlcyBGT1IgVkFMVUVTIEZST00gKCcyMDIwLTAxLTAxJykgVE8gKCcyMDIxLTAxLTAxJyk7CkNSRUFURSBUQUJMRSBlbXBsb3llZXNfMjAyMSBQQVJUSVRJT04gT0YgZW1wbG95ZWVzIEZPUiBWQUxVRVMgRlJPTSAoJzIwMjEtMDEtMDEnKSBUTyAoJzIwMjItMDEtMDEnKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Creating a partitioned table
CREATE TABLE employees (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    department VARCHAR(50),
    hire_date DATE
) PARTITION BY RANGE (hire_date);

-- Creating partitions
CREATE TABLE employees_2020 PARTITION OF employees FOR VALUES FROM ('2020-01-01') TO ('2021-01-01');
CREATE TABLE employees_2021 PARTITION OF employees FOR VALUES FROM ('2021-01-01') TO ('2022-01-01');</pre></div><div class='content'></div><h2>Using CTEs (Common Table Expressions)</h2>
<div class='content'><ul>
<li><strong>CTEs</strong>: Improve readability and maintainability of complex queries.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gVXNpbmcgYSBDVEUKV0lUSCBTYWxlc0VtcGxveWVlcyBBUyAoCiAgICBTRUxFQ1QgKiBGUk9NIGVtcGxveWVlcyBXSEVSRSBkZXBhcnRtZW50ID0gJ1NhbGVzJwopClNFTEVDVCAqIEZST00gU2FsZXNFbXBsb3llZXMgV0hFUkUgaGlyZV9kYXRlID4gJzIwMjAtMDEtMDEnOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Using a CTE
WITH SalesEmployees AS (
    SELECT * FROM employees WHERE department = 'Sales'
)
SELECT * FROM SalesEmployees WHERE hire_date &gt; '2020-01-01';</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Analyzing query performance in PostgreSQL involves understanding execution plans, using indexes effectively, and optimizing queries through various techniques. By leveraging tools like <code>EXPLAIN</code>, <code>pg_stat_statements</code>, and advanced features like partitioning and CTEs, you can significantly improve the performance of your database queries. Regularly monitoring and analyzing query performance is key to maintaining an efficient and responsive PostgreSQL database.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='query-optimization'>&#x25C4;Query Optimization</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Analyzing Query Performance</a>
	</div>
	<div class='col-4 text-end'>
					<a href='vacuuming-and-maintenance'>Vacuuming and Maintenance &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
