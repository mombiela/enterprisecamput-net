<!DOCTYPE html>
<html lang="en">
<head>
    <title> Model Evaluation and Tuning </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, nofollow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/r/07-05-model-evaluation-tuning" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/r/07-05-model-evaluation-tuning" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/r/07-05-model-evaluation-tuning" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.ea63f62b9e.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "languages";
  		var MOD_NAME = "r";
  		var TEMA_NAME = "7-5";
  		var TYPE = "mod";
  		var PATH = "mod/r/07-05-model-evaluation-tuning";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/r/07-05-model-evaluation-tuning" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/r/07-05-model-evaluation-tuning" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="r">
		<a  href="#" class="text-secondary d-none" data-read-mod="r" data-read-unit="7-5" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="r" data-unread-unit="7-5" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='07-04-unsupervised-learning' title="Unsupervised Learning" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='07-04-unsupervised-learning' title="Unsupervised Learning" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h2 style="text-decoration:underline">Model Evaluation and Tuning</h2>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='08-01-time-series-analysis' title="Time Series Analysis" class="py-2 px-3 btn btn-primary"
				data-read-mod="r" data-read-unit="7-5">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='08-01-time-series-analysis' title="Time Series Analysis" class="py-2 px-3 btn btn-primary" 
				data-read-mod="r" data-read-unit="7-5">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will cover the essential concepts and techniques for evaluating and tuning machine learning models in R. Proper evaluation and tuning are crucial for building robust and accurate models. This module will guide you through various methods and best practices.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li>
<p><strong>Model Evaluation Metrics</strong></p>
<ul>
<li>Accuracy</li>
<li>Precision, Recall, and F1 Score</li>
<li>ROC Curve and AUC</li>
<li>Mean Squared Error (MSE) and Root Mean Squared Error (RMSE)</li>
<li>R-squared</li>
</ul>
</li>
<li>
<p><strong>Cross-Validation</strong></p>
<ul>
<li>k-Fold Cross-Validation</li>
<li>Leave-One-Out Cross-Validation (LOOCV)</li>
<li>Stratified k-Fold Cross-Validation</li>
</ul>
</li>
<li>
<p><strong>Hyperparameter Tuning</strong></p>
<ul>
<li>Grid Search</li>
<li>Random Search</li>
<li>Bayesian Optimization</li>
</ul>
</li>
<li>
<p><strong>Model Selection</strong></p>
<ul>
<li>Comparing Multiple Models</li>
<li>Model Complexity and Overfitting</li>
<li>Bias-Variance Tradeoff</li>
</ul>
</li>
</ol>
</div><h1>Model Evaluation Metrics</h1>
<div class='content'></div><h2>Accuracy</h2>
<div class='content'><p>Accuracy is the ratio of correctly predicted observations to the total observations. It is suitable for balanced datasets.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlOiBDYWxjdWxhdGluZyBhY2N1cmFjeQp0cnVlX2xhYmVscyA8LSBjKDEsIDAsIDEsIDEsIDAsIDEsIDAsIDAsIDEsIDApCnByZWRpY3RlZF9sYWJlbHMgPC0gYygxLCAwLCAxLCAwLCAwLCAxLCAwLCAxLCAxLCAwKQoKYWNjdXJhY3kgPC0gc3VtKHRydWVfbGFiZWxzID09IHByZWRpY3RlZF9sYWJlbHMpIC8gbGVuZ3RoKHRydWVfbGFiZWxzKQpwcmludChwYXN0ZSgiQWNjdXJhY3k6IiwgYWNjdXJhY3kpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example: Calculating accuracy
true_labels &lt;- c(1, 0, 1, 1, 0, 1, 0, 0, 1, 0)
predicted_labels &lt;- c(1, 0, 1, 0, 0, 1, 0, 1, 1, 0)

accuracy &lt;- sum(true_labels == predicted_labels) / length(true_labels)
print(paste(&quot;Accuracy:&quot;, accuracy))</pre></div><div class='content'></div><h2>Precision, Recall, and F1 Score</h2>
<div class='content'><p>Precision is the ratio of correctly predicted positive observations to the total predicted positives. Recall is the ratio of correctly predicted positive observations to all observations in the actual class. F1 Score is the weighted average of Precision and Recall.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlOiBDYWxjdWxhdGluZyBwcmVjaXNpb24sIHJlY2FsbCwgYW5kIEYxIHNjb3JlCmxpYnJhcnkoY2FyZXQpCgpjb25mX21hdHJpeCA8LSBjb25mdXNpb25NYXRyaXgoZmFjdG9yKHByZWRpY3RlZF9sYWJlbHMpLCBmYWN0b3IodHJ1ZV9sYWJlbHMpKQpwcmVjaXNpb24gPC0gY29uZl9tYXRyaXgkYnlDbGFzc1snUG9zIFByZWQgVmFsdWUnXQpyZWNhbGwgPC0gY29uZl9tYXRyaXgkYnlDbGFzc1snU2Vuc2l0aXZpdHknXQpmMV9zY29yZSA8LSAyICogKHByZWNpc2lvbiAqIHJlY2FsbCkgLyAocHJlY2lzaW9uICsgcmVjYWxsKQoKcHJpbnQocGFzdGUoIlByZWNpc2lvbjoiLCBwcmVjaXNpb24pKQpwcmludChwYXN0ZSgiUmVjYWxsOiIsIHJlY2FsbCkpCnByaW50KHBhc3RlKCJGMSBTY29yZToiLCBmMV9zY29yZSkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example: Calculating precision, recall, and F1 score
library(caret)

conf_matrix &lt;- confusionMatrix(factor(predicted_labels), factor(true_labels))
precision &lt;- conf_matrix$byClass['Pos Pred Value']
recall &lt;- conf_matrix$byClass['Sensitivity']
f1_score &lt;- 2 * (precision * recall) / (precision + recall)

print(paste(&quot;Precision:&quot;, precision))
print(paste(&quot;Recall:&quot;, recall))
print(paste(&quot;F1 Score:&quot;, f1_score))</pre></div><div class='content'></div><h2>ROC Curve and AUC</h2>
<div class='content'><p>The ROC curve is a graphical representation of the true positive rate against the false positive rate. AUC (Area Under the Curve) measures the entire two-dimensional area underneath the entire ROC curve.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlOiBQbG90dGluZyBST0MgY3VydmUgYW5kIGNhbGN1bGF0aW5nIEFVQwpsaWJyYXJ5KHBST0MpCgpyb2NfY3VydmUgPC0gcm9jKHRydWVfbGFiZWxzLCBwcmVkaWN0ZWRfbGFiZWxzKQpwbG90KHJvY19jdXJ2ZSkKYXVjX3ZhbHVlIDwtIGF1Yyhyb2NfY3VydmUpCnByaW50KHBhc3RlKCJBVUM6IiwgYXVjX3ZhbHVlKSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example: Plotting ROC curve and calculating AUC
library(pROC)

roc_curve &lt;- roc(true_labels, predicted_labels)
plot(roc_curve)
auc_value &lt;- auc(roc_curve)
print(paste(&quot;AUC:&quot;, auc_value))</pre></div><div class='content'></div><h2>Mean Squared Error (MSE) and Root Mean Squared Error (RMSE)</h2>
<div class='content'><p>MSE is the average of the squared differences between the predicted and actual values. RMSE is the square root of MSE.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlOiBDYWxjdWxhdGluZyBNU0UgYW5kIFJNU0UKYWN0dWFsX3ZhbHVlcyA8LSBjKDMuMCwgLTAuNSwgMi4wLCA3LjApCnByZWRpY3RlZF92YWx1ZXMgPC0gYygyLjUsIDAuMCwgMi4xLCA3LjgpCgptc2UgPC0gbWVhbigoYWN0dWFsX3ZhbHVlcyAtIHByZWRpY3RlZF92YWx1ZXMpXjIpCnJtc2UgPC0gc3FydChtc2UpCgpwcmludChwYXN0ZSgiTVNFOiIsIG1zZSkpCnByaW50KHBhc3RlKCJSTVNFOiIsIHJtc2UpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example: Calculating MSE and RMSE
actual_values &lt;- c(3.0, -0.5, 2.0, 7.0)
predicted_values &lt;- c(2.5, 0.0, 2.1, 7.8)

mse &lt;- mean((actual_values - predicted_values)^2)
rmse &lt;- sqrt(mse)

print(paste(&quot;MSE:&quot;, mse))
print(paste(&quot;RMSE:&quot;, rmse))</pre></div><div class='content'></div><h2>R-squared</h2>
<div class='content'><p>R-squared is a statistical measure that represents the proportion of the variance for a dependent variable that's explained by an independent variable or variables in a regression model.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlOiBDYWxjdWxhdGluZyBSLXNxdWFyZWQKcnNzIDwtIHN1bSgoYWN0dWFsX3ZhbHVlcyAtIHByZWRpY3RlZF92YWx1ZXMpXjIpCnRzcyA8LSBzdW0oKGFjdHVhbF92YWx1ZXMgLSBtZWFuKGFjdHVhbF92YWx1ZXMpKV4yKQpyX3NxdWFyZWQgPC0gMSAtIChyc3MvdHNzKQoKcHJpbnQocGFzdGUoIlItc3F1YXJlZDoiLCByX3NxdWFyZWQpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example: Calculating R-squared
rss &lt;- sum((actual_values - predicted_values)^2)
tss &lt;- sum((actual_values - mean(actual_values))^2)
r_squared &lt;- 1 - (rss/tss)

print(paste(&quot;R-squared:&quot;, r_squared))</pre></div><div class='content'></div><h1>Cross-Validation</h1>
<div class='content'></div><h2>k-Fold Cross-Validation</h2>
<div class='content'><p>k-Fold Cross-Validation involves splitting the dataset into k subsets. The model is trained on k-1 subsets and tested on the remaining subset. This process is repeated k times.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlOiBrLUZvbGQgQ3Jvc3MtVmFsaWRhdGlvbgpsaWJyYXJ5KGNhcmV0KQoKZGF0YShpcmlzKQp0cmFpbl9jb250cm9sIDwtIHRyYWluQ29udHJvbChtZXRob2Q9ImN2IiwgbnVtYmVyPTEwKQptb2RlbCA8LSB0cmFpbihTcGVjaWVzfi4sIGRhdGE9aXJpcywgdHJDb250cm9sPXRyYWluX2NvbnRyb2wsIG1ldGhvZD0icnBhcnQiKQoKcHJpbnQobW9kZWwp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example: k-Fold Cross-Validation
library(caret)

data(iris)
train_control &lt;- trainControl(method=&quot;cv&quot;, number=10)
model &lt;- train(Species~., data=iris, trControl=train_control, method=&quot;rpart&quot;)

print(model)</pre></div><div class='content'></div><h2>Leave-One-Out Cross-Validation (LOOCV)</h2>
<div class='content'><p>LOOCV is a special case of k-Fold Cross-Validation where k is equal to the number of observations in the dataset.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlOiBMT09DVgp0cmFpbl9jb250cm9sIDwtIHRyYWluQ29udHJvbChtZXRob2Q9IkxPT0NWIikKbW9kZWwgPC0gdHJhaW4oU3BlY2llc34uLCBkYXRhPWlyaXMsIHRyQ29udHJvbD10cmFpbl9jb250cm9sLCBtZXRob2Q9InJwYXJ0IikKCnByaW50KG1vZGVsKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example: LOOCV
train_control &lt;- trainControl(method=&quot;LOOCV&quot;)
model &lt;- train(Species~., data=iris, trControl=train_control, method=&quot;rpart&quot;)

print(model)</pre></div><div class='content'></div><h2>Stratified k-Fold Cross-Validation</h2>
<div class='content'><p>Stratified k-Fold Cross-Validation ensures that each fold is representative of the overall class distribution.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlOiBTdHJhdGlmaWVkIGstRm9sZCBDcm9zcy1WYWxpZGF0aW9uCnRyYWluX2NvbnRyb2wgPC0gdHJhaW5Db250cm9sKG1ldGhvZD0iY3YiLCBudW1iZXI9MTAsIGNsYXNzUHJvYnM9VFJVRSwgc3VtbWFyeUZ1bmN0aW9uPXR3b0NsYXNzU3VtbWFyeSkKbW9kZWwgPC0gdHJhaW4oU3BlY2llc34uLCBkYXRhPWlyaXMsIHRyQ29udHJvbD10cmFpbl9jb250cm9sLCBtZXRob2Q9InJwYXJ0IiwgbWV0cmljPSJST0MiKQoKcHJpbnQobW9kZWwp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example: Stratified k-Fold Cross-Validation
train_control &lt;- trainControl(method=&quot;cv&quot;, number=10, classProbs=TRUE, summaryFunction=twoClassSummary)
model &lt;- train(Species~., data=iris, trControl=train_control, method=&quot;rpart&quot;, metric=&quot;ROC&quot;)

print(model)</pre></div><div class='content'></div><h1>Hyperparameter Tuning</h1>
<div class='content'></div><h2>Grid Search</h2>
<div class='content'><p>Grid Search involves searching through a manually specified subset of the hyperparameter space of a learning algorithm.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlOiBHcmlkIFNlYXJjaAp0dW5lX2dyaWQgPC0gZXhwYW5kLmdyaWQoLmNwPXNlcSgwLjAxLCAwLjEsIGJ5PTAuMDEpKQp0cmFpbl9jb250cm9sIDwtIHRyYWluQ29udHJvbChtZXRob2Q9ImN2IiwgbnVtYmVyPTEwKQptb2RlbCA8LSB0cmFpbihTcGVjaWVzfi4sIGRhdGE9aXJpcywgdHJDb250cm9sPXRyYWluX2NvbnRyb2wsIG1ldGhvZD0icnBhcnQiLCB0dW5lR3JpZD10dW5lX2dyaWQpCgpwcmludChtb2RlbCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example: Grid Search
tune_grid &lt;- expand.grid(.cp=seq(0.01, 0.1, by=0.01))
train_control &lt;- trainControl(method=&quot;cv&quot;, number=10)
model &lt;- train(Species~., data=iris, trControl=train_control, method=&quot;rpart&quot;, tuneGrid=tune_grid)

print(model)</pre></div><div class='content'></div><h2>Random Search</h2>
<div class='content'><p>Random Search involves searching through a random subset of the hyperparameter space.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlOiBSYW5kb20gU2VhcmNoCnRyYWluX2NvbnRyb2wgPC0gdHJhaW5Db250cm9sKG1ldGhvZD0iY3YiLCBudW1iZXI9MTAsIHNlYXJjaD0icmFuZG9tIikKbW9kZWwgPC0gdHJhaW4oU3BlY2llc34uLCBkYXRhPWlyaXMsIHRyQ29udHJvbD10cmFpbl9jb250cm9sLCBtZXRob2Q9InJwYXJ0IiwgdHVuZUxlbmd0aD0xMCkKCnByaW50KG1vZGVsKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example: Random Search
train_control &lt;- trainControl(method=&quot;cv&quot;, number=10, search=&quot;random&quot;)
model &lt;- train(Species~., data=iris, trControl=train_control, method=&quot;rpart&quot;, tuneLength=10)

print(model)</pre></div><div class='content'></div><h2>Bayesian Optimization</h2>
<div class='content'><p>Bayesian Optimization is a probabilistic model-based optimization technique.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlOiBCYXllc2lhbiBPcHRpbWl6YXRpb24gKHVzaW5nIHRoZSBgckJheWVzaWFuT3B0aW1pemF0aW9uYCBwYWNrYWdlKQpsaWJyYXJ5KHJCYXllc2lhbk9wdGltaXphdGlvbikKCiMgRGVmaW5lIHRoZSBmdW5jdGlvbiB0byBvcHRpbWl6ZQpvcHRpbWl6ZV9mdW5jdGlvbiA8LSBmdW5jdGlvbihjcCkgewogIG1vZGVsIDwtIHRyYWluKFNwZWNpZXN+LiwgZGF0YT1pcmlzLCBtZXRob2Q9InJwYXJ0IiwgdHJDb250cm9sPXRyYWluQ29udHJvbChtZXRob2Q9ImN2IiwgbnVtYmVyPTEwKSwgdHVuZUdyaWQ9ZGF0YS5mcmFtZShjcD1jcCkpCiAgcmV0dXJuKGxpc3QoU2NvcmU9bW9kZWwkcmVzdWx0cyRBY2N1cmFjeSwgUHJlZD1tb2RlbCkpCn0KCiMgUGVyZm9ybSBCYXllc2lhbiBPcHRpbWl6YXRpb24KYmF5ZXNfb3B0IDwtIEJheWVzaWFuT3B0aW1pemF0aW9uKG9wdGltaXplX2Z1bmN0aW9uLCBib3VuZHM9bGlzdChjcD1jKDAuMDEsIDAuMSkpLCBpbml0X3BvaW50cz01LCBuX2l0ZXI9MTApCgpwcmludChiYXllc19vcHQp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example: Bayesian Optimization (using the `rBayesianOptimization` package)
library(rBayesianOptimization)

# Define the function to optimize
optimize_function &lt;- function(cp) {
  model &lt;- train(Species~., data=iris, method=&quot;rpart&quot;, trControl=trainControl(method=&quot;cv&quot;, number=10), tuneGrid=data.frame(cp=cp))
  return(list(Score=model$results$Accuracy, Pred=model))
}

# Perform Bayesian Optimization
bayes_opt &lt;- BayesianOptimization(optimize_function, bounds=list(cp=c(0.01, 0.1)), init_points=5, n_iter=10)

print(bayes_opt)</pre></div><div class='content'></div><h1>Model Selection</h1>
<div class='content'></div><h2>Comparing Multiple Models</h2>
<div class='content'><p>Comparing multiple models helps in selecting the best model based on performance metrics.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlOiBDb21wYXJpbmcgbXVsdGlwbGUgbW9kZWxzCm1vZGVscyA8LSBsaXN0KCkKbW9kZWxzW1sncnBhcnQnXV0gPC0gdHJhaW4oU3BlY2llc34uLCBkYXRhPWlyaXMsIG1ldGhvZD0icnBhcnQiLCB0ckNvbnRyb2w9dHJhaW5Db250cm9sKG1ldGhvZD0iY3YiLCBudW1iZXI9MTApKQptb2RlbHNbWydyZiddXSA8LSB0cmFpbihTcGVjaWVzfi4sIGRhdGE9aXJpcywgbWV0aG9kPSJyZiIsIHRyQ29udHJvbD10cmFpbkNvbnRyb2wobWV0aG9kPSJjdiIsIG51bWJlcj0xMCkpCgpyZXN1bHRzIDwtIHJlc2FtcGxlcyhtb2RlbHMpCnN1bW1hcnkocmVzdWx0cyk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example: Comparing multiple models
models &lt;- list()
models[['rpart']] &lt;- train(Species~., data=iris, method=&quot;rpart&quot;, trControl=trainControl(method=&quot;cv&quot;, number=10))
models[['rf']] &lt;- train(Species~., data=iris, method=&quot;rf&quot;, trControl=trainControl(method=&quot;cv&quot;, number=10))

results &lt;- resamples(models)
summary(results)</pre></div><div class='content'></div><h2>Model Complexity and Overfitting</h2>
<div class='content'><p>Model complexity can lead to overfitting, where the model performs well on training data but poorly on unseen data. Regularization techniques can help mitigate overfitting.</p>
</div><h2>Bias-Variance Tradeoff</h2>
<div class='content'><p>The bias-variance tradeoff is the balance between the error introduced by the bias and the variance. A good model should have low bias and low variance.</p>
</div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Evaluate a Classification Model</h2>
<div class='content'><ol>
<li>Load the <code>iris</code> dataset.</li>
<li>Split the dataset into training and testing sets.</li>
<li>Train a decision tree model on the training set.</li>
<li>Evaluate the model using accuracy, precision, recall, and F1 score on the testing set.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTb2x1dGlvbgpsaWJyYXJ5KGNhcmV0KQpkYXRhKGlyaXMpCgojIFNwbGl0IHRoZSBkYXRhc2V0CnNldC5zZWVkKDEyMykKdHJhaW5faW5kZXggPC0gY3JlYXRlRGF0YVBhcnRpdGlvbihpcmlzJFNwZWNpZXMsIHA9MC44LCBsaXN0PUZBTFNFKQp0cmFpbl9kYXRhIDwtIGlyaXNbdHJhaW5faW5kZXgsIF0KdGVzdF9kYXRhIDwtIGlyaXNbLXRyYWluX2luZGV4LCBdCgojIFRyYWluIHRoZSBtb2RlbAptb2RlbCA8LSB0cmFpbihTcGVjaWVzfi4sIGRhdGE9dHJhaW5fZGF0YSwgbWV0aG9kPSJycGFydCIpCgojIE1ha2UgcHJlZGljdGlvbnMKcHJlZGljdGlvbnMgPC0gcHJlZGljdChtb2RlbCwgdGVzdF9kYXRhKQoKIyBFdmFsdWF0ZSB0aGUgbW9kZWwKY29uZl9tYXRyaXggPC0gY29uZnVzaW9uTWF0cml4KHByZWRpY3Rpb25zLCB0ZXN0X2RhdGEkU3BlY2llcykKYWNjdXJhY3kgPC0gY29uZl9tYXRyaXgkb3ZlcmFsbFsnQWNjdXJhY3knXQpwcmVjaXNpb24gPC0gY29uZl9tYXRyaXgkYnlDbGFzc1snUG9zIFByZWQgVmFsdWUnXQpyZWNhbGwgPC0gY29uZl9tYXRyaXgkYnlDbGFzc1snU2Vuc2l0aXZpdHknXQpmMV9zY29yZSA8LSAyICogKHByZWNpc2lvbiAqIHJlY2FsbCkgLyAocHJlY2lzaW9uICsgcmVjYWxsKQoKcHJpbnQocGFzdGUoIkFjY3VyYWN5OiIsIGFjY3VyYWN5KSkKcHJpbnQocGFzdGUoIlByZWNpc2lvbjoiLCBwcmVjaXNpb24pKQpwcmludChwYXN0ZSgiUmVjYWxsOiIsIHJlY2FsbCkpCnByaW50KHBhc3RlKCJGMSBTY29yZToiLCBmMV9zY29yZSkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Solution
library(caret)
data(iris)

# Split the dataset
set.seed(123)
train_index &lt;- createDataPartition(iris$Species, p=0.8, list=FALSE)
train_data &lt;- iris[train_index, ]
test_data &lt;- iris[-train_index, ]

# Train the model
model &lt;- train(Species~., data=train_data, method=&quot;rpart&quot;)

# Make predictions
predictions &lt;- predict(model, test_data)

# Evaluate the model
conf_matrix &lt;- confusionMatrix(predictions, test_data$Species)
accuracy &lt;- conf_matrix$overall['Accuracy']
precision &lt;- conf_matrix$byClass['Pos Pred Value']
recall &lt;- conf_matrix$byClass['Sensitivity']
f1_score &lt;- 2 * (precision * recall) / (precision + recall)

print(paste(&quot;Accuracy:&quot;, accuracy))
print(paste(&quot;Precision:&quot;, precision))
print(paste(&quot;Recall:&quot;, recall))
print(paste(&quot;F1 Score:&quot;, f1_score))</pre></div><div class='content'></div><h2>Exercise 2: Perform k-Fold Cross-Validation</h2>
<div class='content'><ol>
<li>Load the <code>iris</code> dataset.</li>
<li>Perform 10-fold cross-validation on a random forest model.</li>
<li>Print the cross-validation results.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTb2x1dGlvbgpsaWJyYXJ5KGNhcmV0KQpkYXRhKGlyaXMpCgojIFBlcmZvcm0gMTAtZm9sZCBjcm9zcy12YWxpZGF0aW9uCnRyYWluX2NvbnRyb2wgPC0gdHJhaW5Db250cm9sKG1ldGhvZD0iY3YiLCBudW1iZXI9MTApCm1vZGVsIDwtIHRyYWluKFNwZWNpZXN+LiwgZGF0YT1pcmlzLCB0ckNvbnRyb2w9dHJhaW5fY29udHJvbCwgbWV0aG9kPSJyZiIpCgpwcmludChtb2RlbCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Solution
library(caret)
data(iris)

# Perform 10-fold cross-validation
train_control &lt;- trainControl(method=&quot;cv&quot;, number=10)
model &lt;- train(Species~., data=iris, trControl=train_control, method=&quot;rf&quot;)

print(model)</pre></div><div class='content'></div><h2>Exercise 3: Hyperparameter Tuning with Grid Search</h2>
<div class='content'><ol>
<li>Load the <code>iris</code> dataset.</li>
<li>Perform grid search to tune the <code>cp</code> parameter of a decision tree model.</li>
<li>Print the best model and its parameters.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTb2x1dGlvbgpsaWJyYXJ5KGNhcmV0KQpkYXRhKGlyaXMpCgojIERlZmluZSB0aGUgZ3JpZAp0dW5lX2dyaWQgPC0gZXhwYW5kLmdyaWQoLmNwPXNlcSgwLjAxLCAwLjEsIGJ5PTAuMDEpKQoKIyBQZXJmb3JtIGdyaWQgc2VhcmNoCnRyYWluX2NvbnRyb2wgPC0gdHJhaW5Db250cm9sKG1ldGhvZD0iY3YiLCBudW1iZXI9MTApCm1vZGVsIDwtIHRyYWluKFNwZWNpZXN+LiwgZGF0YT1pcmlzLCB0ckNvbnRyb2w9dHJhaW5fY29udHJvbCwgbWV0aG9kPSJycGFydCIsIHR1bmVHcmlkPXR1bmVfZ3JpZCkKCnByaW50KG1vZGVsKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Solution
library(caret)
data(iris)

# Define the grid
tune_grid &lt;- expand.grid(.cp=seq(0.01, 0.1, by=0.01))

# Perform grid search
train_control &lt;- trainControl(method=&quot;cv&quot;, number=10)
model &lt;- train(Species~., data=iris, trControl=train_control, method=&quot;rpart&quot;, tuneGrid=tune_grid)

print(model)</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the essential techniques for evaluating and tuning machine learning models in R. We discussed various evaluation metrics, cross-validation methods, and hyperparameter tuning techniques. By mastering these concepts, you can build more robust and accurate models. In the next module, we will delve into specialized topics in machine learning with R.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='07-04-unsupervised-learning' title="Unsupervised Learning" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='07-04-unsupervised-learning' title="Unsupervised Learning" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='08-01-time-series-analysis' title="Time Series Analysis" class="py-2 px-3 btn btn-primary"
				data-read-mod="r" data-read-unit="7-5">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='08-01-time-series-analysis' title="Time Series Analysis" class="py-2 px-3 btn btn-primary" 
				data-read-mod="r" data-read-unit="7-5">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>R Programming: From Beginner to Advanced</h1>
<h2>Module 1: Introduction to R</h2>
<ul>
<li><a href="01-01-introduction-r-rstudio">Introduction to R and RStudio</a></li>
<li><a href="01-02-basic-r-syntax">Basic R Syntax</a></li>
<li><a href="01-03-data-types-structures">Data Types and Structures</a></li>
<li><a href="01-04-basic-operations-functions">Basic Operations and Functions</a></li>
<li><a href="01-05-importing-exporting-data">Importing and Exporting Data</a></li>
</ul>
<h2>Module 2: Data Manipulation</h2>
<ul>
<li><a href="02-01-vectors-lists">Vectors and Lists</a></li>
<li><a href="02-02-matrices-arrays">Matrices and Arrays</a></li>
<li><a href="02-03-data-frames">Data Frames</a></li>
<li><a href="02-04-factors">Factors</a></li>
<li><a href="02-05-data-manipulation-dplyr">Data Manipulation with dplyr</a></li>
<li><a href="02-06-string-manipulation">String Manipulation</a></li>
</ul>
<h2>Module 3: Data Visualization</h2>
<ul>
<li><a href="03-01-introduction-data-visualization">Introduction to Data Visualization</a></li>
<li><a href="03-02-base-r-graphics">Base R Graphics</a></li>
<li><a href="03-03-ggplot2-basics">ggplot2 Basics</a></li>
<li><a href="03-04-advanced-ggplot2">Advanced ggplot2</a></li>
<li><a href="03-05-interactive-visualizations-plotly">Interactive Visualizations with plotly</a></li>
</ul>
<h2>Module 4: Statistical Analysis</h2>
<ul>
<li><a href="04-01-descriptive-statistics">Descriptive Statistics</a></li>
<li><a href="04-02-probability-distributions">Probability Distributions</a></li>
<li><a href="04-03-hypothesis-testing">Hypothesis Testing</a></li>
<li><a href="04-04-correlation-regression">Correlation and Regression</a></li>
<li><a href="04-05-anova-chi-square-tests">ANOVA and Chi-Square Tests</a></li>
</ul>
<h2>Module 5: Advanced Data Handling</h2>
<ul>
<li><a href="05-01-handling-dates-times">Handling Dates and Times</a></li>
<li><a href="05-02-data-reshaping">Data Reshaping</a></li>
<li><a href="05-03-working-large-datasets">Working with Large Datasets</a></li>
<li><a href="05-04-web-scraping">Web Scraping</a></li>
<li><a href="05-05-apis-json">APIs and JSON</a></li>
</ul>
<h2>Module 6: Advanced Programming Concepts</h2>
<ul>
<li><a href="06-01-writing-functions">Writing Functions</a></li>
<li><a href="06-02-debugging-error-handling">Debugging and Error Handling</a></li>
<li><a href="06-03-object-oriented-programming">Object-Oriented Programming in R</a></li>
<li><a href="06-04-functional-programming">Functional Programming</a></li>
<li><a href="06-05-parallel-computing">Parallel Computing</a></li>
</ul>
<h2>Module 7: Machine Learning with R</h2>
<ul>
<li><a href="07-01-introduction-machine-learning">Introduction to Machine Learning</a></li>
<li><a href="07-02-data-preprocessing">Data Preprocessing</a></li>
<li><a href="07-03-supervised-learning">Supervised Learning</a></li>
<li><a href="07-04-unsupervised-learning">Unsupervised Learning</a></li>
<li><a href="07-05-model-evaluation-tuning">Model Evaluation and Tuning</a></li>
</ul>
<h2>Module 8: Specialized Topics</h2>
<ul>
<li><a href="08-01-time-series-analysis">Time Series Analysis</a></li>
<li><a href="08-02-spatial-data-analysis">Spatial Data Analysis</a></li>
<li><a href="08-03-text-mining-nlp">Text Mining and Natural Language Processing</a></li>
<li><a href="08-04-bioinformatics-r">Bioinformatics with R</a></li>
<li><a href="08-05-financial-data-analysis">Financial Data Analysis</a></li>
</ul>
<h2>Module 9: Project and Case Studies</h2>
<ul>
<li><a href="09-01-capstone-project">Capstone Project</a></li>
<li><a href="09-02-case-study-data-analysis">Case Study 1: Data Analysis</a></li>
<li><a href="09-03-case-study-machine-learning">Case Study 2: Machine Learning</a></li>
<li><a href="09-04-case-study-data-visualization">Case Study 3: Data Visualization</a></li>
<li><a href="09-05-case-study-statistical-analysis">Case Study 4: Statistical Analysis</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
