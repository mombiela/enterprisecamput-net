<!DOCTYPE html>
<html lang="en">
<head>
    <title> Project 3: Development of an Agent with Machine Learning </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/ia-para-videojuegos/06-03-proyecto-agente" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/ia-per-a-videojocs/06-03-projecte-agent" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/ai-for-video-games/06-03-project-agent" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "foundations";
  		var MOD_NAME = "ia_videojuegos";
  		var TEMA_NAME = "6-3";
  		var TYPE = "mod";
  		var PATH = "mod/ia_videojuegos/06-03-project-agent";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.688defeeef.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/ia-para-videojuegos/06-03-proyecto-agente" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/ia-per-a-videojocs/06-03-projecte-agent" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="ia_videojuegos">
		<a  href="#" class="text-secondary d-none" data-read-mod="ia_videojuegos" data-read-unit="6-3" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="ia_videojuegos" data-unread-unit="6-3" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-02-project-npc' title="Project 2: Creation of an NPC with Decision Making" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-02-project-npc' title="Project 2: Creation of an NPC with Decision Making" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Project 3: Development of an Agent with Machine Learning</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='07-01-books-articles' title="Recommended Books and Articles" class="py-2 px-3 btn btn-primary"
				data-read-mod="ia_videojuegos" data-read-unit="6-3">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='07-01-books-articles' title="Recommended Books and Articles" class="py-2 px-3 btn btn-primary" 
				data-read-mod="ia_videojuegos" data-read-unit="6-3">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this project, you will develop an intelligent agent using machine learning techniques. This agent will learn from its environment and improve its performance over time. We will focus on reinforcement learning, a popular method in game AI for training agents to make decisions.</p>
</div><h2>Objectives</h2>
<div class='content'><ul>
<li>Understand the basics of reinforcement learning.</li>
<li>Implement a simple reinforcement learning algorithm.</li>
<li>Train an agent to perform a specific task.</li>
<li>Evaluate and optimize the agent's performance.</li>
</ul>
</div><h2>Prerequisites</h2>
<div class='content'><p>Before starting this project, ensure you have a good understanding of the following concepts:</p>
<ul>
<li>Basic programming skills in Python.</li>
<li>Understanding of machine learning concepts.</li>
<li>Familiarity with reinforcement learning principles.</li>
</ul>
</div><h2>Step-by-Step Guide</h2>
<div class='content'></div><h3>Step 1: Setting Up the Environment</h3>
<div class='content'><ol>
<li>
<p><strong>Install Required Libraries:</strong>
Ensure you have Python installed. You will also need libraries like <code>numpy</code>, <code>gym</code>, and <code>tensorflow</code> or <code>pytorch</code>. Install them using pip:</p>
<pre><code class="language-bash">pip install numpy gym tensorflow
</code></pre>
</li>
<li>
<p><strong>Create a New Project Directory:</strong>
Organize your files by creating a new directory for this project.</p>
<pre><code class="language-bash">mkdir RL_Agent_Project
cd RL_Agent_Project
</code></pre>
</li>
</ol>
</div><h3>Step 2: Understanding the Problem</h3>
<div class='content'><p>For this project, we will use the OpenAI Gym environment, specifically the CartPole-v1 environment. The objective is to balance a pole on a cart by applying forces to the cart.</p>
</div><h3>Step 3: Implementing the Agent</h3>
<div class='content'><ol>
<li>
<p><strong>Import Libraries:</strong></p>
<pre><code class="language-python">import gym
import numpy as np
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.optimizers import Adam
</code></pre>
</li>
<li>
<p><strong>Create the Environment:</strong></p>
<pre><code class="language-python">env = gym.make('CartPole-v1')
state_size = env.observation_space.shape[0]
action_size = env.action_space.n
</code></pre>
</li>
<li>
<p><strong>Build the Neural Network:</strong></p>
<pre><code class="language-python">def build_model(state_size, action_size):
    model = Sequential()
    model.add(Dense(24, input_dim=state_size, activation='relu'))
    model.add(Dense(24, activation='relu'))
    model.add(Dense(action_size, activation='linear'))
    model.compile(loss='mse', optimizer=Adam(lr=0.001))
    return model

model = build_model(state_size, action_size)
</code></pre>
</li>
<li>
<p><strong>Define the Agent:</strong></p>
<pre><code class="language-python">class DQNAgent:
    def __init__(self, state_size, action_size):
        self.state_size = state_size
        self.action_size = action_size
        self.memory = []
        self.gamma = 0.95    # discount rate
        self.epsilon = 1.0   # exploration rate
        self.epsilon_min = 0.01
        self.epsilon_decay = 0.995
        self.model = build_model(state_size, action_size)

    def remember(self, state, action, reward, next_state, done):
        self.memory.append((state, action, reward, next_state, done))

    def act(self, state):
        if np.random.rand() &lt;= self.epsilon:
            return np.random.choice(self.action_size)
        act_values = self.model.predict(state)
        return np.argmax(act_values[0])

    def replay(self, batch_size):
        minibatch = np.random.choice(self.memory, batch_size)
        for state, action, reward, next_state, done in minibatch:
            target = reward
            if not done:
                target = (reward + self.gamma *
                          np.amax(self.model.predict(next_state)[0]))
            target_f = self.model.predict(state)
            target_f[0][action] = target
            self.model.fit(state, target_f, epochs=1, verbose=0)
        if self.epsilon &gt; self.epsilon_min:
            self.epsilon *= self.epsilon_decay
</code></pre>
</li>
</ol>
</div><h3>Step 4: Training the Agent</h3>
<div class='content'><ol>
<li>
<p><strong>Initialize the Agent:</strong></p>
<pre><code class="language-python">agent = DQNAgent(state_size, action_size)
</code></pre>
</li>
<li>
<p><strong>Train the Agent:</strong></p>
<pre><code class="language-python">episodes = 1000
batch_size = 32

for e in range(episodes):
    state = env.reset()
    state = np.reshape(state, [1, state_size])
    for time in range(500):
        action = agent.act(state)
        next_state, reward, done, _ = env.step(action)
        reward = reward if not done else -10
        next_state = np.reshape(next_state, [1, state_size])
        agent.remember(state, action, reward, next_state, done)
        state = next_state
        if done:
            print(f&quot;episode: {e}/{episodes}, score: {time}, e: {agent.epsilon:.2}&quot;)
            break
        if len(agent.memory) &gt; batch_size:
            agent.replay(batch_size)
</code></pre>
</li>
</ol>
</div><h3>Step 5: Evaluating the Agent</h3>
<div class='content'><ol>
<li><strong>Test the Agent:</strong>
<pre><code class="language-python">for e in range(10):
    state = env.reset()
    state = np.reshape(state, [1, state_size])
    for time in range(500):
        env.render()
        action = agent.act(state)
        next_state, reward, done, _ = env.step(action)
        next_state = np.reshape(next_state, [1, state_size])
        state = next_state
        if done:
            print(f&quot;episode: {e}/10, score: {time}&quot;)
            break
env.close()
</code></pre>
</li>
</ol>
</div><h3>Step 6: Optimization and Fine-Tuning</h3>
<div class='content'><ol>
<li>
<p><strong>Hyperparameter Tuning:</strong>
Experiment with different values for learning rate, discount factor, and exploration rate to improve the agent's performance.</p>
</li>
<li>
<p><strong>Memory Management:</strong>
Implement techniques to manage the memory efficiently, such as using a deque with a fixed size.</p>
</li>
<li>
<p><strong>Advanced Techniques:</strong>
Explore advanced reinforcement learning algorithms like Double DQN, Dueling DQN, or Prioritized Experience Replay for better performance.</p>
</li>
</ol>
</div><h2>Conclusion</h2>
<div class='content'><p>In this project, you have successfully developed an intelligent agent using reinforcement learning. You have learned how to set up the environment, implement a neural network, train the agent, and evaluate its performance. By experimenting with different parameters and techniques, you can further improve the agent's capabilities.</p>
<p>This project serves as a foundation for more complex AI implementations in video games. Continue exploring and experimenting with different environments and algorithms to enhance your skills in game AI development.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-02-project-npc' title="Project 2: Creation of an NPC with Decision Making" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-02-project-npc' title="Project 2: Creation of an NPC with Decision Making" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='07-01-books-articles' title="Recommended Books and Articles" class="py-2 px-3 btn btn-primary"
				data-read-mod="ia_videojuegos" data-read-unit="6-3">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='07-01-books-articles' title="Recommended Books and Articles" class="py-2 px-3 btn btn-primary" 
				data-read-mod="ia_videojuegos" data-read-unit="6-3">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>AI for Video Games</h1>
<h2>Module 1: Introduction to AI in Video Games</h2>
<ul>
<li><a href="01-01-history-evolution">History and Evolution of AI in Video Games</a></li>
<li><a href="01-02-basic-concepts">Basic AI Concepts</a></li>
<li><a href="01-03-tools-languages">Tools and Programming Languages</a></li>
</ul>
<h2>Module 2: Navigation in Video Games</h2>
<ul>
<li><a href="02-01-pathfinding-algorithms">Pathfinding Algorithms</a></li>
<li><a href="02-02-a-star-implementation">A* Implementation</a></li>
<li><a href="02-03-navigation-navmesh">Navigation with NavMesh</a></li>
<li><a href="02-04-obstacle-avoidance">Obstacle Avoidance</a></li>
</ul>
<h2>Module 3: Decision Making</h2>
<ul>
<li><a href="03-01-finite-state-machines">Finite State Machines (FSM)</a></li>
<li><a href="03-02-decision-trees">Decision Trees</a></li>
<li><a href="03-03-behavior-trees">Behavior Trees</a></li>
<li><a href="03-04-rule-based-systems">Rule-Based Systems</a></li>
</ul>
<h2>Module 4: Machine Learning</h2>
<ul>
<li><a href="04-01-introduction-machine-learning">Introduction to Machine Learning</a></li>
<li><a href="04-02-neural-networks">Neural Networks in Video Games</a></li>
<li><a href="04-03-reinforcement-learning">Reinforcement Learning</a></li>
<li><a href="04-04-implementation-agent">Implementation of a Learning Agent</a></li>
</ul>
<h2>Module 5: Integration and Optimization</h2>
<ul>
<li><a href="05-01-integration-engines">Integration of AI in Game Engines</a></li>
<li><a href="05-02-optimization-algorithms">Optimization of AI Algorithms</a></li>
<li><a href="05-03-testing-debugging">AI Testing and Debugging</a></li>
</ul>
<h2>Module 6: Practical Projects</h2>
<ul>
<li><a href="06-01-project-navigation">Project 1: Implementation of Basic Navigation</a></li>
<li><a href="06-02-project-npc">Project 2: Creation of an NPC with Decision Making</a></li>
<li><a href="06-03-project-agent">Project 3: Development of an Agent with Machine Learning</a></li>
</ul>
<h2>Module 7: Additional Resources</h2>
<ul>
<li><a href="07-01-books-articles">Recommended Books and Articles</a></li>
<li><a href="07-02-communities-forums">Communities and Forums</a></li>
<li><a href="07-03-tools-libraries">Useful Tools and Libraries</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
