<!DOCTYPE html>
<html lang="en">
<head>
    <title> Spark with Kubernetes </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/apache-spark/06-04-spark-kubernetes" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/apache-spark/06-04-spark-kubernetes" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/apache-spark/06-04-spark-kubernetes" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.188a386f47.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "apachespark";
  		var TEMA_NAME = "6-4";
  		var TYPE = "mod";
  		var PATH = "mod/apachespark/06-04-spark-kubernetes";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/apache-spark/06-04-spark-kubernetes" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/apache-spark/06-04-spark-kubernetes" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="apachespark">
		<a  href="#" class="text-secondary d-none" data-read-mod="apachespark" data-read-unit="6-4" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="apachespark" data-unread-unit="6-4" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-03-running-spark-google-cloud' title="Running Spark on Google Cloud" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-03-running-spark-google-cloud' title="Running Spark on Google Cloud" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Spark with Kubernetes</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='07-01-real-time-data-processing' title="Real-Time Data Processing" class="py-2 px-3 btn btn-primary"
				data-read-mod="apachespark" data-read-unit="6-4">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='07-01-real-time-data-processing' title="Real-Time Data Processing" class="py-2 px-3 btn btn-primary" 
				data-read-mod="apachespark" data-read-unit="6-4">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to run Apache Spark on Kubernetes. Kubernetes is an open-source platform designed to automate deploying, scaling, and operating application containers. Running Spark on Kubernetes allows for better resource management, scalability, and integration with cloud-native environments.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ol>
<li>
<p><strong>Kubernetes Overview</strong>:</p>
<ul>
<li><strong>Kubernetes Cluster</strong>: A set of nodes (machines) that run containerized applications managed by Kubernetes.</li>
<li><strong>Pods</strong>: The smallest deployable units in Kubernetes, which can contain one or more containers.</li>
<li><strong>Services</strong>: Abstractions that define a logical set of Pods and a policy by which to access them.</li>
<li><strong>ConfigMaps and Secrets</strong>: Mechanisms to manage configuration data and sensitive information.</li>
</ul>
</li>
<li>
<p><strong>Spark on Kubernetes</strong>:</p>
<ul>
<li><strong>Spark Driver</strong>: The process that runs the main() function of the application and creates SparkContext.</li>
<li><strong>Spark Executors</strong>: Processes launched by the driver to run individual tasks.</li>
<li><strong>Cluster Mode</strong>: The driver runs inside a Kubernetes pod.</li>
<li><strong>Client Mode</strong>: The driver runs on the local machine, and executors run on Kubernetes pods.</li>
</ul>
</li>
</ol>
</div><h2>Setting Up Spark on Kubernetes</h2>
<div class='content'></div><h3>Prerequisites</h3>
<div class='content'><ul>
<li>A running Kubernetes cluster.</li>
<li><code>kubectl</code> command-line tool configured to communicate with your Kubernetes cluster.</li>
<li>Docker installed to build container images.</li>
<li>Apache Spark distribution with Kubernetes support.</li>
</ul>
</div><h3>Steps to Run Spark on Kubernetes</h3>
<div class='content'><ol>
<li>
<p><strong>Build Docker Image for Spark</strong>:</p>
<ul>
<li>Create a Dockerfile for Spark:
<pre><code class="language-dockerfile">FROM spark:latest
COPY your-spark-application.jar /opt/spark/jars/
</code></pre>
</li>
<li>Build and push the Docker image:
<pre><code class="language-sh">docker build -t your-docker-repo/spark-app:latest .
docker push your-docker-repo/spark-app:latest
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Create Kubernetes Resources</strong>:</p>
<ul>
<li>Define a YAML file for the Spark driver and executor pods:
<pre><code class="language-yaml">apiVersion: v1
kind: Pod
metadata:
  name: spark-driver
spec:
  containers:
  - name: spark-driver
    image: your-docker-repo/spark-app:latest
    args: [&quot;spark-submit&quot;, &quot;--master&quot;, &quot;k8s://https://&lt;k8s-master-url&gt;:6443&quot;, &quot;--deploy-mode&quot;, &quot;cluster&quot;, &quot;--class&quot;, &quot;org.apache.spark.examples.SparkPi&quot;, &quot;local:///opt/spark/jars/your-spark-application.jar&quot;]
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Submit Spark Application</strong>:</p>
<ul>
<li>Use <code>spark-submit</code> to deploy the application:
<pre><code class="language-sh">./bin/spark-submit <br>       --master k8s://https://&lt;k8s-master-url&gt;:6443 <br>       --deploy-mode cluster <br>       --name spark-pi <br>       --class org.apache.spark.examples.SparkPi <br>       --conf spark.executor.instances=2 <br>       --conf spark.kubernetes.container.image=your-docker-repo/spark-app:latest <br>       local:///opt/spark/jars/your-spark-application.jar
</code></pre>
</li>
</ul>
</li>
</ol>
</div><h3>Practical Example</h3>
<div class='content'><p>Let's run a simple Spark application that calculates Pi using Kubernetes.</p>
<ol>
<li>
<p><strong>Dockerfile</strong>:</p>
<pre><code class="language-dockerfile">FROM bitnami/spark:latest
COPY spark-examples_2.12-3.0.1.jar /opt/spark/jars/
</code></pre>
</li>
<li>
<p><strong>Build and Push Docker Image</strong>:</p>
<pre><code class="language-sh">docker build -t your-docker-repo/spark-pi:latest .
docker push your-docker-repo/spark-pi:latest
</code></pre>
</li>
<li>
<p><strong>Submit Spark Application</strong>:</p>
<pre><code class="language-sh">./bin/spark-submit <br>     --master k8s://https://&lt;k8s-master-url&gt;:6443 <br>     --deploy-mode cluster <br>     --name spark-pi <br>     --class org.apache.spark.examples.SparkPi <br>     --conf spark.executor.instances=2 <br>     --conf spark.kubernetes.container.image=your-docker-repo/spark-pi:latest <br>     local:///opt/spark/jars/spark-examples_2.12-3.0.1.jar
</code></pre>
</li>
</ol>
</div><h3>Common Mistakes and Tips</h3>
<div class='content'><ul>
<li><strong>Image Pull Errors</strong>: Ensure your Docker image is accessible from the Kubernetes cluster.</li>
<li><strong>Configuration Issues</strong>: Double-check the Kubernetes master URL and Spark configurations.</li>
<li><strong>Resource Management</strong>: Properly configure resource requests and limits for Spark driver and executor pods.</li>
</ul>
</div><h2>Conclusion</h2>
<div class='content'><p>Running Apache Spark on Kubernetes provides a robust and scalable environment for big data processing. By leveraging Kubernetes' orchestration capabilities, you can efficiently manage Spark applications, ensuring high availability and resource optimization. In the next module, we will explore real-world applications and case studies to see how Spark is used in various industries.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-03-running-spark-google-cloud' title="Running Spark on Google Cloud" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-03-running-spark-google-cloud' title="Running Spark on Google Cloud" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='07-01-real-time-data-processing' title="Real-Time Data Processing" class="py-2 px-3 btn btn-primary"
				data-read-mod="apachespark" data-read-unit="6-4">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='07-01-real-time-data-processing' title="Real-Time Data Processing" class="py-2 px-3 btn btn-primary" 
				data-read-mod="apachespark" data-read-unit="6-4">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Apache Spark Course</h1>
<h2>Module 1: Introduction to Apache Spark</h2>
<ul>
<li><a href="01-01-what-is-apache-spark">What is Apache Spark?</a></li>
<li><a href="01-02-setting-up-spark-environment">Setting Up the Spark Environment</a></li>
<li><a href="01-03-spark-architecture">Spark Architecture</a></li>
<li><a href="01-04-spark-shell">Spark Shell</a></li>
</ul>
<h2>Module 2: Spark Core Concepts</h2>
<ul>
<li><a href="02-01-rdds">RDDs (Resilient Distributed Datasets)</a></li>
<li><a href="02-02-transformations-actions">Transformations and Actions</a></li>
<li><a href="02-03-spark-dataframes">Spark DataFrames</a></li>
<li><a href="02-04-spark-sql">Spark SQL</a></li>
</ul>
<h2>Module 3: Data Processing with Spark</h2>
<ul>
<li><a href="03-01-loading-saving-data">Loading and Saving Data</a></li>
<li><a href="03-02-dataframe-operations">DataFrame Operations</a></li>
<li><a href="03-03-working-with-datasets">Working with Datasets</a></li>
<li><a href="03-04-handling-missing-data">Handling Missing Data</a></li>
</ul>
<h2>Module 4: Advanced Spark Programming</h2>
<ul>
<li><a href="04-01-spark-streaming">Spark Streaming</a></li>
<li><a href="04-02-structured-streaming">Structured Streaming</a></li>
<li><a href="04-03-spark-mllib">Spark MLlib</a></li>
<li><a href="04-04-graphx">GraphX</a></li>
</ul>
<h2>Module 5: Performance Tuning and Optimization</h2>
<ul>
<li><a href="05-01-understanding-spark-jobs">Understanding Spark Jobs</a></li>
<li><a href="05-02-caching-persistence">Caching and Persistence</a></li>
<li><a href="05-03-memory-management">Memory Management</a></li>
<li><a href="05-04-optimizing-spark-applications">Optimizing Spark Applications</a></li>
</ul>
<h2>Module 6: Spark in the Cloud</h2>
<ul>
<li><a href="06-01-running-spark-aws">Running Spark on AWS</a></li>
<li><a href="06-02-running-spark-azure">Running Spark on Azure</a></li>
<li><a href="06-03-running-spark-google-cloud">Running Spark on Google Cloud</a></li>
<li><a href="06-04-spark-kubernetes">Spark with Kubernetes</a></li>
</ul>
<h2>Module 7: Real-World Applications and Case Studies</h2>
<ul>
<li><a href="07-01-real-time-data-processing">Real-Time Data Processing</a></li>
<li><a href="07-02-big-data-analytics">Big Data Analytics</a></li>
<li><a href="07-03-machine-learning-pipelines">Machine Learning Pipelines</a></li>
<li><a href="07-04-case-studies">Case Studies</a></li>
</ul>
<h2>Module 8: Capstone Project</h2>
<ul>
<li><a href="08-01-project-overview">Project Overview</a></li>
<li><a href="08-02-project-setup">Project Setup</a></li>
<li><a href="08-03-implementation">Implementation</a></li>
<li><a href="08-04-presentation-review">Presentation and Review</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
