<!DOCTYPE html>
<html lang="en">
<head>
    <title> Spark DataFrames </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/apache-spark/02-03-spark-dataframes" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/apache-spark/02-03-spark-dataframes" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/apache-spark/02-03-spark-dataframes" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "apachespark";
  		var TEMA_NAME = "2-3";
  		var TYPE = "mod";
  		var PATH = "mod/apachespark/02-03-spark-dataframes";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.8d8afe898f.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/apache-spark/02-03-spark-dataframes" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/apache-spark/02-03-spark-dataframes" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="apachespark">
		<a  href="#" class="text-secondary d-none" data-read-mod="apachespark" data-read-unit="2-3" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="apachespark" data-unread-unit="2-3" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='02-02-transformations-actions' title="Transformations and Actions" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='02-02-transformations-actions' title="Transformations and Actions" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Spark DataFrames</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='02-04-spark-sql' title="Spark SQL" class="py-2 px-3 btn btn-primary"
				data-read-mod="apachespark" data-read-unit="2-3">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='02-04-spark-sql' title="Spark SQL" class="py-2 px-3 btn btn-primary" 
				data-read-mod="apachespark" data-read-unit="2-3">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'></div><h2>Introduction</h2>
<div class='content'><p>Spark DataFrames are a distributed collection of data organized into named columns, similar to a table in a relational database or a data frame in R/Python. They provide a higher-level abstraction than RDDs and are optimized for performance.</p>
</div><h2>Key Concepts</h2>
<div class='content'></div><h3><ol>
<li>What is a DataFrame?</li>
</ol></h3>
<div class='content'><ul>
<li><strong>Definition</strong>: A DataFrame is a distributed collection of data organized into named columns.</li>
<li><strong>Schema</strong>: DataFrames have a schema, which is a structure that defines the column names and data types.</li>
<li><strong>Optimization</strong>: DataFrames are optimized for performance using Catalyst Optimizer and Tungsten execution engine.</li>
</ul>
</div><h3><ol start="2">
<li>Creating DataFrames</li>
</ol></h3>
<div class='content'><ul>
<li><strong>From RDDs</strong>: Convert an existing RDD to a DataFrame.</li>
<li><strong>From Structured Data</strong>: Load data from structured data sources like JSON, CSV, Parquet, etc.</li>
<li><strong>From Existing Data</strong>: Create DataFrames from existing data structures like lists or dictionaries in Python.</li>
</ul>
</div><h3><ol start="3">
<li>DataFrame Operations</li>
</ol></h3>
<div class='content'><ul>
<li><strong>Transformations</strong>: Operations that return a new DataFrame, such as <code>select</code>, <code>filter</code>, <code>groupBy</code>, etc.</li>
<li><strong>Actions</strong>: Operations that trigger computation and return results, such as <code>show</code>, <code>collect</code>, <code>count</code>, etc.</li>
</ul>
</div><h2>Practical Examples</h2>
<div class='content'></div><h3>Example 1: Creating a DataFrame from a List</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaXRpYWxpemUgU3BhcmsgU2Vzc2lvbgpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIkRhdGFGcmFtZUV4YW1wbGUiKS5nZXRPckNyZWF0ZSgpCgojIFNhbXBsZSBkYXRhCmRhdGEgPSBbKCJBbGljZSIsIDM0KSwgKCJCb2IiLCA0NSksICgiQ2F0aHkiLCAyOSldCgojIERlZmluZSBzY2hlbWEKY29sdW1ucyA9IFsiTmFtZSIsICJBZ2UiXQoKIyBDcmVhdGUgRGF0YUZyYW1lCmRmID0gc3BhcmsuY3JlYXRlRGF0YUZyYW1lKGRhdGEsIGNvbHVtbnMpCgojIFNob3cgRGF0YUZyYW1lCmRmLnNob3coKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Initialize Spark Session
spark = SparkSession.builder.appName(&quot;DataFrameExample&quot;).getOrCreate()

# Sample data
data = [(&quot;Alice&quot;, 34), (&quot;Bob&quot;, 45), (&quot;Cathy&quot;, 29)]

# Define schema
columns = [&quot;Name&quot;, &quot;Age&quot;]

# Create DataFrame
df = spark.createDataFrame(data, columns)

# Show DataFrame
df.show()</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>We start by initializing a Spark session.</li>
<li>We define a list of tuples containing sample data.</li>
<li>We specify the column names.</li>
<li>We create a DataFrame using <code>createDataFrame</code> method.</li>
<li>Finally, we display the DataFrame using the <code>show</code> method.</li>
</ul>
</div><h3>Example 2: Loading Data from a CSV File</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMb2FkIERhdGFGcmFtZSBmcm9tIENTViBmaWxlCmRmID0gc3BhcmsucmVhZC5jc3YoInBhdGgvdG8vZmlsZS5jc3YiLCBoZWFkZXI9VHJ1ZSwgaW5mZXJTY2hlbWE9VHJ1ZSkKCiMgU2hvdyBEYXRhRnJhbWUKZGYuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Load DataFrame from CSV file
df = spark.read.csv(&quot;path/to/file.csv&quot;, header=True, inferSchema=True)

# Show DataFrame
df.show()</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>We use the <code>read.csv</code> method to load data from a CSV file.</li>
<li>The <code>header=True</code> option indicates that the first row contains column names.</li>
<li>The <code>inferSchema=True</code> option automatically infers the data types of the columns.</li>
<li>We display the DataFrame using the <code>show</code> method.</li>
</ul>
</div><h3>Example 3: DataFrame Transformations</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTZWxlY3Qgc3BlY2lmaWMgY29sdW1ucwpkZl9zZWxlY3RlZCA9IGRmLnNlbGVjdCgiTmFtZSIsICJBZ2UiKQoKIyBGaWx0ZXIgcm93cwpkZl9maWx0ZXJlZCA9IGRmLmZpbHRlcihkZi5BZ2UgPiAzMCkKCiMgR3JvdXAgYnkgYW5kIGFnZ3JlZ2F0ZQpkZl9ncm91cGVkID0gZGYuZ3JvdXBCeSgiQWdlIikuY291bnQoKQoKIyBTaG93IHJlc3VsdHMKZGZfc2VsZWN0ZWQuc2hvdygpCmRmX2ZpbHRlcmVkLnNob3coKQpkZl9ncm91cGVkLnNob3coKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Select specific columns
df_selected = df.select(&quot;Name&quot;, &quot;Age&quot;)

# Filter rows
df_filtered = df.filter(df.Age &gt; 30)

# Group by and aggregate
df_grouped = df.groupBy(&quot;Age&quot;).count()

# Show results
df_selected.show()
df_filtered.show()
df_grouped.show()</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>We use the <code>select</code> method to choose specific columns.</li>
<li>We use the <code>filter</code> method to filter rows based on a condition.</li>
<li>We use the <code>groupBy</code> method to group rows by a specific column and then apply an aggregation function (<code>count</code> in this case).</li>
<li>We display the results using the <code>show</code> method.</li>
</ul>
</div><h2>Practical Exercises</h2>
<div class='content'></div><h3>Exercise 1: Creating and Displaying a DataFrame</h3>
<div class='content'><p><strong>Task</strong>: Create a DataFrame from a list of tuples containing employee names and salaries. Display the DataFrame.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTYW1wbGUgZGF0YQpkYXRhID0gWygiSm9obiIsIDUwMDAwKSwgKCJKYW5lIiwgNjAwMDApLCAoIkRvZSIsIDcwMDAwKV0KCiMgRGVmaW5lIHNjaGVtYQpjb2x1bW5zID0gWyJOYW1lIiwgIlNhbGFyeSJdCgojIENyZWF0ZSBEYXRhRnJhbWUKZGYgPSBzcGFyay5jcmVhdGVEYXRhRnJhbWUoZGF0YSwgY29sdW1ucykKCiMgU2hvdyBEYXRhRnJhbWUKZGYuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Sample data
data = [(&quot;John&quot;, 50000), (&quot;Jane&quot;, 60000), (&quot;Doe&quot;, 70000)]

# Define schema
columns = [&quot;Name&quot;, &quot;Salary&quot;]

# Create DataFrame
df = spark.createDataFrame(data, columns)

# Show DataFrame
df.show()</pre></div><div class='content'></div><h3>Exercise 2: Loading and Filtering Data</h3>
<div class='content'><p><strong>Task</strong>: Load a DataFrame from a CSV file containing product information (ProductID, ProductName, Price). Filter the DataFrame to show only products with a price greater than 100.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMb2FkIERhdGFGcmFtZSBmcm9tIENTViBmaWxlCmRmID0gc3BhcmsucmVhZC5jc3YoInBhdGgvdG8vcHJvZHVjdHMuY3N2IiwgaGVhZGVyPVRydWUsIGluZmVyU2NoZW1hPVRydWUpCgojIEZpbHRlciByb3dzCmRmX2ZpbHRlcmVkID0gZGYuZmlsdGVyKGRmLlByaWNlID4gMTAwKQoKIyBTaG93IGZpbHRlcmVkIERhdGFGcmFtZQpkZl9maWx0ZXJlZC5zaG93KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Load DataFrame from CSV file
df = spark.read.csv(&quot;path/to/products.csv&quot;, header=True, inferSchema=True)

# Filter rows
df_filtered = df.filter(df.Price &gt; 100)

# Show filtered DataFrame
df_filtered.show()</pre></div><div class='content'></div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Schema Mismatch</strong>: Ensure that the schema matches the data types in the source data.</li>
<li><strong>Case Sensitivity</strong>: Column names are case-sensitive. Ensure consistent use of column names.</li>
<li><strong>Lazy Evaluation</strong>: Remember that transformations are lazy and actions trigger computation.</li>
</ul>
</div><h2>Conclusion</h2>
<div class='content'><p>In this section, we introduced Spark DataFrames, a powerful abstraction for working with structured data. We covered how to create DataFrames from various sources, perform transformations and actions, and provided practical examples and exercises. Understanding DataFrames is crucial for efficient data processing in Spark, and this knowledge will be built upon in subsequent modules.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='02-02-transformations-actions' title="Transformations and Actions" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='02-02-transformations-actions' title="Transformations and Actions" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='02-04-spark-sql' title="Spark SQL" class="py-2 px-3 btn btn-primary"
				data-read-mod="apachespark" data-read-unit="2-3">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='02-04-spark-sql' title="Spark SQL" class="py-2 px-3 btn btn-primary" 
				data-read-mod="apachespark" data-read-unit="2-3">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Apache Spark Course</h1>
<h2>Module 1: Introduction to Apache Spark</h2>
<ul>
<li><a href="01-01-what-is-apache-spark">What is Apache Spark?</a></li>
<li><a href="01-02-setting-up-spark-environment">Setting Up the Spark Environment</a></li>
<li><a href="01-03-spark-architecture">Spark Architecture</a></li>
<li><a href="01-04-spark-shell">Spark Shell</a></li>
</ul>
<h2>Module 2: Spark Core Concepts</h2>
<ul>
<li><a href="02-01-rdds">RDDs (Resilient Distributed Datasets)</a></li>
<li><a href="02-02-transformations-actions">Transformations and Actions</a></li>
<li><a href="02-03-spark-dataframes">Spark DataFrames</a></li>
<li><a href="02-04-spark-sql">Spark SQL</a></li>
</ul>
<h2>Module 3: Data Processing with Spark</h2>
<ul>
<li><a href="03-01-loading-saving-data">Loading and Saving Data</a></li>
<li><a href="03-02-dataframe-operations">DataFrame Operations</a></li>
<li><a href="03-03-working-with-datasets">Working with Datasets</a></li>
<li><a href="03-04-handling-missing-data">Handling Missing Data</a></li>
</ul>
<h2>Module 4: Advanced Spark Programming</h2>
<ul>
<li><a href="04-01-spark-streaming">Spark Streaming</a></li>
<li><a href="04-02-structured-streaming">Structured Streaming</a></li>
<li><a href="04-03-spark-mllib">Spark MLlib</a></li>
<li><a href="04-04-graphx">GraphX</a></li>
</ul>
<h2>Module 5: Performance Tuning and Optimization</h2>
<ul>
<li><a href="05-01-understanding-spark-jobs">Understanding Spark Jobs</a></li>
<li><a href="05-02-caching-persistence">Caching and Persistence</a></li>
<li><a href="05-03-memory-management">Memory Management</a></li>
<li><a href="05-04-optimizing-spark-applications">Optimizing Spark Applications</a></li>
</ul>
<h2>Module 6: Spark in the Cloud</h2>
<ul>
<li><a href="06-01-running-spark-aws">Running Spark on AWS</a></li>
<li><a href="06-02-running-spark-azure">Running Spark on Azure</a></li>
<li><a href="06-03-running-spark-google-cloud">Running Spark on Google Cloud</a></li>
<li><a href="06-04-spark-kubernetes">Spark with Kubernetes</a></li>
</ul>
<h2>Module 7: Real-World Applications and Case Studies</h2>
<ul>
<li><a href="07-01-real-time-data-processing">Real-Time Data Processing</a></li>
<li><a href="07-02-big-data-analytics">Big Data Analytics</a></li>
<li><a href="07-03-machine-learning-pipelines">Machine Learning Pipelines</a></li>
<li><a href="07-04-case-studies">Case Studies</a></li>
</ul>
<h2>Module 8: Capstone Project</h2>
<ul>
<li><a href="08-01-project-overview">Project Overview</a></li>
<li><a href="08-02-project-setup">Project Setup</a></li>
<li><a href="08-03-implementation">Implementation</a></li>
<li><a href="08-04-presentation-review">Presentation and Review</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
