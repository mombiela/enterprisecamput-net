<!DOCTYPE html>
<html lang="en">
<head>
    <title> Understanding Spark Jobs </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/apache-spark/05-01-understanding-spark-jobs" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/apache-spark/05-01-understanding-spark-jobs" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/apache-spark/05-01-understanding-spark-jobs" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "apachespark";
  		var TEMA_NAME = "5-1";
  		var TYPE = "mod";
  		var PATH = "mod/apachespark/05-01-understanding-spark-jobs";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/apache-spark/05-01-understanding-spark-jobs" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/apache-spark/05-01-understanding-spark-jobs" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="apachespark">
		<a  href="#" class="text-secondary d-none" data-read-mod="apachespark" data-read-unit="5-1" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="apachespark" data-unread-unit="5-1" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='04-04-graphx' title="GraphX" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='04-04-graphx' title="GraphX" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Understanding Spark Jobs</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='05-02-caching-persistence' title="Caching and Persistence" class="py-2 px-3 btn btn-primary"
				data-read-mod="apachespark" data-read-unit="5-1">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='05-02-caching-persistence' title="Caching and Persistence" class="py-2 px-3 btn btn-primary" 
				data-read-mod="apachespark" data-read-unit="5-1">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into the intricacies of Spark jobs, understanding their lifecycle, components, and how they are executed within the Spark framework. This knowledge is crucial for optimizing and troubleshooting Spark applications.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ol>
<li><strong>Spark Application</strong>: A user program built on Spark using its APIs. It consists of a driver program and executors on the cluster.</li>
<li><strong>Job</strong>: A parallel computation consisting of multiple tasks that gets spawned in response to a Spark action (e.g., <code>count()</code>, <code>saveAsTextFile()</code>).</li>
<li><strong>Stage</strong>: A job is divided into stages, which are sets of tasks that can be executed in parallel. Stages are determined by shuffle boundaries.</li>
<li><strong>Task</strong>: The smallest unit of work in Spark, executed by an executor. Each stage consists of multiple tasks.</li>
</ol>
</div><h2>Spark Job Lifecycle</h2>
<div class='content'><ol>
<li><strong>Job Submission</strong>: When an action is called on an RDD, Spark creates a job.</li>
<li><strong>DAG (Directed Acyclic Graph) Creation</strong>: Spark constructs a DAG of stages to execute the job.</li>
<li><strong>Stage Division</strong>: The DAG is divided into stages based on shuffle dependencies.</li>
<li><strong>Task Scheduling</strong>: Tasks are scheduled on executors.</li>
<li><strong>Task Execution</strong>: Executors run the tasks and return the results to the driver.</li>
<li><strong>Job Completion</strong>: The job completes when all tasks are finished.</li>
</ol>
</div><h2>Practical Example</h2>
<div class='content'><p>Let's consider a simple example where we read a text file, perform a word count, and save the results.</p>
</div><h3>Code Example</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrIGltcG9ydCBTcGFya0NvbnRleHQsIFNwYXJrQ29uZgoKIyBJbml0aWFsaXplIFNwYXJrIENvbnRleHQKY29uZiA9IFNwYXJrQ29uZigpLnNldEFwcE5hbWUoIldvcmRDb3VudEV4YW1wbGUiKQpzYyA9IFNwYXJrQ29udGV4dChjb25mPWNvbmYpCgojIFJlYWQgdGhlIGlucHV0IGZpbGUKdGV4dF9maWxlID0gc2MudGV4dEZpbGUoImhkZnM6Ly9wYXRoL3RvL2lucHV0LnR4dCIpCgojIFBlcmZvcm0gd29yZCBjb3VudAp3b3JkX2NvdW50cyA9IHRleHRfZmlsZS5mbGF0TWFwKGxhbWJkYSBsaW5lOiBsaW5lLnNwbGl0KCIgIikpIFwKICAgICAgICAgICAgICAgICAgICAgICAubWFwKGxhbWJkYSB3b3JkOiAod29yZCwgMSkpIFwKICAgICAgICAgICAgICAgICAgICAgICAucmVkdWNlQnlLZXkobGFtYmRhIGEsIGI6IGEgKyBiKQoKIyBTYXZlIHRoZSByZXN1bHRzCndvcmRfY291bnRzLnNhdmVBc1RleHRGaWxlKCJoZGZzOi8vcGF0aC90by9vdXRwdXQiKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark import SparkContext, SparkConf

# Initialize Spark Context
conf = SparkConf().setAppName(&quot;WordCountExample&quot;)
sc = SparkContext(conf=conf)

# Read the input file
text_file = sc.textFile(&quot;hdfs://path/to/input.txt&quot;)

# Perform word count
word_counts = text_file.flatMap(lambda line: line.split(&quot; &quot;)) \
                       .map(lambda word: (word, 1)) \
                       .reduceByKey(lambda a, b: a + b)

# Save the results
word_counts.saveAsTextFile(&quot;hdfs://path/to/output&quot;)</pre></div><div class='content'></div><h3>Explanation</h3>
<div class='content'><ol>
<li><strong>Reading the File</strong>: <code>sc.textFile(&quot;hdfs://path/to/input.txt&quot;)</code> creates an RDD from the input file.</li>
<li><strong>Transformations</strong>:
<ul>
<li><code>flatMap(lambda line: line.split(&quot; &quot;))</code>: Splits each line into words.</li>
<li><code>map(lambda word: (word, 1))</code>: Maps each word to a tuple (word, 1).</li>
<li><code>reduceByKey(lambda a, b: a + b)</code>: Reduces tuples by key (word) to count occurrences.</li>
</ul>
</li>
<li><strong>Action</strong>: <code>saveAsTextFile(&quot;hdfs://path/to/output&quot;)</code> triggers the execution of the job.</li>
</ol>
</div><h3>Job Breakdown</h3>
<div class='content'><ul>
<li><strong>Job</strong>: The action <code>saveAsTextFile</code> triggers a job.</li>
<li><strong>Stages</strong>: The job is divided into stages. For example, <code>flatMap</code> and <code>map</code> might be in one stage, and <code>reduceByKey</code> in another.</li>
<li><strong>Tasks</strong>: Each stage is divided into tasks, which are distributed across the cluster nodes.</li>
</ul>
</div><h2>Practical Exercise</h2>
<div class='content'></div><h3>Exercise</h3>
<div class='content'><ol>
<li>Write a Spark application that reads a CSV file, filters rows based on a condition, and saves the filtered data.</li>
<li>Identify the jobs, stages, and tasks in your application.</li>
</ol>
</div><h3>Solution</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaXRpYWxpemUgU3BhcmsgU2Vzc2lvbgpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIkZpbHRlckNTVkV4YW1wbGUiKS5nZXRPckNyZWF0ZSgpCgojIFJlYWQgdGhlIENTViBmaWxlCmRmID0gc3BhcmsucmVhZC5jc3YoImhkZnM6Ly9wYXRoL3RvL2lucHV0LmNzdiIsIGhlYWRlcj1UcnVlLCBpbmZlclNjaGVtYT1UcnVlKQoKIyBGaWx0ZXIgcm93cyB3aGVyZSAnYWdlJyA+IDMwCmZpbHRlcmVkX2RmID0gZGYuZmlsdGVyKGRmLmFnZSA+IDMwKQoKIyBTYXZlIHRoZSBmaWx0ZXJlZCBkYXRhCmZpbHRlcmVkX2RmLndyaXRlLmNzdigiaGRmczovL3BhdGgvdG8vb3V0cHV0IiwgaGVhZGVyPVRydWUpCgojIFN0b3AgdGhlIFNwYXJrIHNlc3Npb24Kc3Bhcmsuc3RvcCgp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Initialize Spark Session
spark = SparkSession.builder.appName(&quot;FilterCSVExample&quot;).getOrCreate()

# Read the CSV file
df = spark.read.csv(&quot;hdfs://path/to/input.csv&quot;, header=True, inferSchema=True)

# Filter rows where 'age' &gt; 30
filtered_df = df.filter(df.age &gt; 30)

# Save the filtered data
filtered_df.write.csv(&quot;hdfs://path/to/output&quot;, header=True)

# Stop the Spark session
spark.stop()</pre></div><div class='content'></div><h3>Explanation</h3>
<div class='content'><ol>
<li><strong>Reading the File</strong>: <code>spark.read.csv</code> reads the CSV file into a DataFrame.</li>
<li><strong>Transformation</strong>: <code>df.filter(df.age &gt; 30)</code> filters rows where the age is greater than 30.</li>
<li><strong>Action</strong>: <code>filtered_df.write.csv</code> triggers the execution of the job.</li>
</ol>
</div><h3>Job Breakdown</h3>
<div class='content'><ul>
<li><strong>Job</strong>: The action <code>write.csv</code> triggers a job.</li>
<li><strong>Stages</strong>: The job is divided into stages, such as reading the file and filtering the data.</li>
<li><strong>Tasks</strong>: Each stage is divided into tasks, which are distributed across the cluster nodes.</li>
</ul>
</div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Mistake</strong>: Not understanding the difference between transformations and actions.
<ul>
<li><strong>Tip</strong>: Remember that transformations are lazy and actions trigger execution.</li>
</ul>
</li>
<li><strong>Mistake</strong>: Ignoring the DAG visualization in Spark UI.
<ul>
<li><strong>Tip</strong>: Use the Spark UI to visualize and understand the DAG of your jobs.</li>
</ul>
</li>
</ul>
</div><h2>Conclusion</h2>
<div class='content'><p>Understanding Spark jobs is fundamental for optimizing and troubleshooting Spark applications. By breaking down jobs into stages and tasks, you can gain insights into the execution process and identify potential bottlenecks. In the next section, we will explore caching and persistence to further enhance the performance of your Spark applications.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='04-04-graphx' title="GraphX" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='04-04-graphx' title="GraphX" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='05-02-caching-persistence' title="Caching and Persistence" class="py-2 px-3 btn btn-primary"
				data-read-mod="apachespark" data-read-unit="5-1">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='05-02-caching-persistence' title="Caching and Persistence" class="py-2 px-3 btn btn-primary" 
				data-read-mod="apachespark" data-read-unit="5-1">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Apache Spark Course</h1>
<h2>Module 1: Introduction to Apache Spark</h2>
<ul>
<li><a href="01-01-what-is-apache-spark">What is Apache Spark?</a></li>
<li><a href="01-02-setting-up-spark-environment">Setting Up the Spark Environment</a></li>
<li><a href="01-03-spark-architecture">Spark Architecture</a></li>
<li><a href="01-04-spark-shell">Spark Shell</a></li>
</ul>
<h2>Module 2: Spark Core Concepts</h2>
<ul>
<li><a href="02-01-rdds">RDDs (Resilient Distributed Datasets)</a></li>
<li><a href="02-02-transformations-actions">Transformations and Actions</a></li>
<li><a href="02-03-spark-dataframes">Spark DataFrames</a></li>
<li><a href="02-04-spark-sql">Spark SQL</a></li>
</ul>
<h2>Module 3: Data Processing with Spark</h2>
<ul>
<li><a href="03-01-loading-saving-data">Loading and Saving Data</a></li>
<li><a href="03-02-dataframe-operations">DataFrame Operations</a></li>
<li><a href="03-03-working-with-datasets">Working with Datasets</a></li>
<li><a href="03-04-handling-missing-data">Handling Missing Data</a></li>
</ul>
<h2>Module 4: Advanced Spark Programming</h2>
<ul>
<li><a href="04-01-spark-streaming">Spark Streaming</a></li>
<li><a href="04-02-structured-streaming">Structured Streaming</a></li>
<li><a href="04-03-spark-mllib">Spark MLlib</a></li>
<li><a href="04-04-graphx">GraphX</a></li>
</ul>
<h2>Module 5: Performance Tuning and Optimization</h2>
<ul>
<li><a href="05-01-understanding-spark-jobs">Understanding Spark Jobs</a></li>
<li><a href="05-02-caching-persistence">Caching and Persistence</a></li>
<li><a href="05-03-memory-management">Memory Management</a></li>
<li><a href="05-04-optimizing-spark-applications">Optimizing Spark Applications</a></li>
</ul>
<h2>Module 6: Spark in the Cloud</h2>
<ul>
<li><a href="06-01-running-spark-aws">Running Spark on AWS</a></li>
<li><a href="06-02-running-spark-azure">Running Spark on Azure</a></li>
<li><a href="06-03-running-spark-google-cloud">Running Spark on Google Cloud</a></li>
<li><a href="06-04-spark-kubernetes">Spark with Kubernetes</a></li>
</ul>
<h2>Module 7: Real-World Applications and Case Studies</h2>
<ul>
<li><a href="07-01-real-time-data-processing">Real-Time Data Processing</a></li>
<li><a href="07-02-big-data-analytics">Big Data Analytics</a></li>
<li><a href="07-03-machine-learning-pipelines">Machine Learning Pipelines</a></li>
<li><a href="07-04-case-studies">Case Studies</a></li>
</ul>
<h2>Module 8: Capstone Project</h2>
<ul>
<li><a href="08-01-project-overview">Project Overview</a></li>
<li><a href="08-02-project-setup">Project Setup</a></li>
<li><a href="08-03-implementation">Implementation</a></li>
<li><a href="08-04-presentation-review">Presentation and Review</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
