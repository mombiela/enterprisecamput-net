<!DOCTYPE html>
<html lang="en">
<head>
    <title> Append-Only Files (AOF) </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/redis/04-02-append-only-files-aof" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/redis/04-02-append-only-files-aof" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/redis/04-02-append-only-files-aof" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.188a386f47.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "redis";
  		var TEMA_NAME = "4-2";
  		var TYPE = "mod";
  		var PATH = "mod/redis/04-02-append-only-files-aof";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/redis/04-02-append-only-files-aof" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/redis/04-02-append-only-files-aof" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="redis">
		<a  href="#" class="text-secondary d-none" data-read-mod="redis" data-read-unit="4-2" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="redis" data-unread-unit="4-2" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='04-01-snapshots-rdb' title="Snapshots (RDB)" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='04-01-snapshots-rdb' title="Snapshots (RDB)" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Append-Only Files (AOF)</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='04-03-persistence-configuration' title="Persistence Configuration" class="py-2 px-3 btn btn-primary"
				data-read-mod="redis" data-read-unit="4-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='04-03-persistence-configuration' title="Persistence Configuration" class="py-2 px-3 btn btn-primary" 
				data-read-mod="redis" data-read-unit="4-2">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>Append-Only Files (AOF) is one of the persistence mechanisms provided by Redis to ensure data durability. Unlike snapshots (RDB), which save the entire dataset at specific intervals, AOF logs every write operation received by the server. This allows Redis to reconstruct the dataset by replaying the logged operations.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ol>
<li><strong>AOF File</strong>: A log file where each write operation is appended.</li>
<li><strong>Rewrite Process</strong>: A mechanism to compact the AOF file to prevent it from growing indefinitely.</li>
<li><strong>AOF Configuration</strong>: Settings that control how AOF behaves, including synchronization policies and rewrite thresholds.</li>
</ol>
</div><h2>How AOF Works</h2>
<div class='content'><ol>
<li><strong>Logging Operations</strong>: Every write operation (e.g., <code>SET</code>, <code>LPUSH</code>) is logged to the AOF file.</li>
<li><strong>Synchronization</strong>: The AOF file is synchronized to disk based on the configured policy.</li>
<li><strong>Reconstruction</strong>: On server restart, Redis reads the AOF file and replays the operations to reconstruct the dataset.</li>
</ol>
</div><h2>AOF Configuration</h2>
<div class='content'></div><h3>Enabling AOF</h3>
<div class='content'><p>To enable AOF, you need to set the <code>appendonly</code> directive to <code>yes</code> in the Redis configuration file (<code>redis.conf</code>):</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwZW5kb25seSB5ZXM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>appendonly yes</pre></div><div class='content'></div><h3>Synchronization Policies</h3>
<div class='content'><p>Redis provides three synchronization policies for AOF:</p>
<ol>
<li><strong>Always (<code>appendfsync always</code>)</strong>: Every write operation is immediately flushed to disk. This is the safest but slowest option.</li>
<li><strong>Every Second (<code>appendfsync everysec</code>)</strong>: Write operations are flushed to disk every second. This is a good balance between performance and durability.</li>
<li><strong>No (<code>appendfsync no</code>)</strong>: Write operations are not explicitly flushed to disk. The operating system handles the synchronization. This is the fastest but least safe option.</li>
</ol>
<p>Example configuration:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwZW5kZnN5bmMgZXZlcnlzZWM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>appendfsync everysec</pre></div><div class='content'></div><h3>AOF Rewrite</h3>
<div class='content'><p>To prevent the AOF file from growing indefinitely, Redis performs an AOF rewrite. This process creates a new, compacted AOF file that contains the minimal set of commands needed to reconstruct the dataset.</p>
<h4>Configuration Options</h4>
<ul>
<li><strong>Auto-Triggering Rewrite</strong>: Redis can automatically trigger an AOF rewrite based on the growth of the AOF file. This is controlled by the <code>auto-aof-rewrite-percentage</code> and <code>auto-aof-rewrite-min-size</code> directives.</li>
</ul>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXV0by1hb2YtcmV3cml0ZS1wZXJjZW50YWdlIDEwMAphdXRvLWFvZi1yZXdyaXRlLW1pbi1zaXplIDY0bWI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb</pre></div><div class='content'><ul>
<li><strong>Manual Rewrite</strong>: You can manually trigger an AOF rewrite using the <code>BGREWRITEAOF</code> command.</li>
</ul>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkdSRVdSSVRFQU9G"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BGREWRITEAOF</pre></div><div class='content'></div><h2>Practical Example</h2>
<div class='content'></div><h3>Enabling AOF and Configuring Synchronization</h3>
<div class='content'><ol>
<li>Open the <code>redis.conf</code> file.</li>
<li>Set <code>appendonly</code> to <code>yes</code>.</li>
<li>Set <code>appendfsync</code> to <code>everysec</code>.</li>
</ol>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwZW5kb25seSB5ZXMKYXBwZW5kZnN5bmMgZXZlcnlzZWM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>appendonly yes
appendfsync everysec</pre></div><div class='content'><ol start="4">
<li>Restart the Redis server to apply the changes.</li>
</ol>
</div><h3>Verifying AOF Functionality</h3>
<div class='content'><ol>
<li>Start the Redis server with AOF enabled.</li>
<li>Perform some write operations:</li>
</ol>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VUIGtleTEgInZhbHVlMSIKTFBVU0ggbGlzdDEgImVsZW1lbnQxIgpTQUREIHNldDEgIm1lbWJlcjEi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SET key1 &quot;value1&quot;
LPUSH list1 &quot;element1&quot;
SADD set1 &quot;member1&quot;</pre></div><div class='content'><ol start="3">
<li>Check the AOF file (<code>appendonly.aof</code>) to see the logged operations.</li>
</ol>
</div><h3>Triggering AOF Rewrite</h3>
<div class='content'><ol>
<li>Manually trigger an AOF rewrite:</li>
</ol>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkdSRVdSSVRFQU9G"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BGREWRITEAOF</pre></div><div class='content'><ol start="2">
<li>Check the Redis logs to verify that the rewrite process has completed.</li>
</ol>
</div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Not Enabling AOF</strong>: Ensure that <code>appendonly</code> is set to <code>yes</code> in the configuration file.</li>
<li><strong>Improper Synchronization Policy</strong>: Choose the synchronization policy that best fits your use case. <code>everysec</code> is generally a good balance.</li>
<li><strong>Ignoring AOF Rewrite</strong>: Regularly monitor the size of the AOF file and configure auto-rewrite settings to prevent excessive growth.</li>
</ul>
</div><h2>Summary</h2>
<div class='content'><p>Append-Only Files (AOF) provide a robust mechanism for ensuring data durability in Redis. By logging every write operation, AOF allows Redis to reconstruct the dataset accurately. Proper configuration of synchronization policies and AOF rewrite settings is crucial for maintaining performance and preventing excessive file growth. Understanding and utilizing AOF effectively can significantly enhance the reliability of your Redis deployment.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='04-01-snapshots-rdb' title="Snapshots (RDB)" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='04-01-snapshots-rdb' title="Snapshots (RDB)" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='04-03-persistence-configuration' title="Persistence Configuration" class="py-2 px-3 btn btn-primary"
				data-read-mod="redis" data-read-unit="4-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='04-03-persistence-configuration' title="Persistence Configuration" class="py-2 px-3 btn btn-primary" 
				data-read-mod="redis" data-read-unit="4-2">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Redis Course</h1>
<h2>Module 1: Introduction to Redis</h2>
<ul>
<li><a href="01-01-what-is-redis">What is Redis?</a></li>
<li><a href="01-02-installing-redis">Installing Redis</a></li>
<li><a href="01-03-basic-redis-data-types">Basic Redis Data Types</a></li>
<li><a href="01-04-redis-cli-basics">Redis CLI Basics</a></li>
</ul>
<h2>Module 2: Redis Data Structures</h2>
<ul>
<li><a href="02-01-strings">Strings</a></li>
<li><a href="02-02-lists">Lists</a></li>
<li><a href="02-03-sets">Sets</a></li>
<li><a href="02-04-hashes">Hashes</a></li>
<li><a href="02-05-sorted-sets">Sorted Sets</a></li>
</ul>
<h2>Module 3: Redis Commands and Operations</h2>
<ul>
<li><a href="03-01-basic-commands">Basic Commands</a></li>
<li><a href="03-02-advanced-commands">Advanced Commands</a></li>
<li><a href="03-03-transactions">Transactions</a></li>
<li><a href="03-04-pipelining">Pipelining</a></li>
</ul>
<h2>Module 4: Redis Persistence</h2>
<ul>
<li><a href="04-01-snapshots-rdb">Snapshots (RDB)</a></li>
<li><a href="04-02-append-only-files-aof">Append-Only Files (AOF)</a></li>
<li><a href="04-03-persistence-configuration">Persistence Configuration</a></li>
<li><a href="04-04-backup-and-restore">Backup and Restore</a></li>
</ul>
<h2>Module 5: Redis Security</h2>
<ul>
<li><a href="05-01-authentication">Authentication</a></li>
<li><a href="05-02-encryption">Encryption</a></li>
<li><a href="05-03-access-control-lists-acls">Access Control Lists (ACLs)</a></li>
<li><a href="05-04-security-best-practices">Security Best Practices</a></li>
</ul>
<h2>Module 6: Redis Performance Optimization</h2>
<ul>
<li><a href="06-01-memory-optimization">Memory Optimization</a></li>
<li><a href="06-02-latency-and-throughput">Latency and Throughput</a></li>
<li><a href="06-03-performance-tuning">Performance Tuning</a></li>
<li><a href="06-04-monitoring-and-metrics">Monitoring and Metrics</a></li>
</ul>
<h2>Module 7: Redis Clustering and High Availability</h2>
<ul>
<li><a href="07-01-replication">Replication</a></li>
<li><a href="07-02-sentinel">Sentinel</a></li>
<li><a href="07-03-cluster-mode">Cluster Mode</a></li>
<li><a href="07-04-scaling-redis">Scaling Redis</a></li>
</ul>
<h2>Module 8: Redis Modules and Extensions</h2>
<ul>
<li><a href="08-01-introduction-to-redis-modules">Introduction to Redis Modules</a></li>
<li><a href="08-02-popular-redis-modules">Popular Redis Modules</a></li>
<li><a href="08-03-creating-custom-modules">Creating Custom Modules</a></li>
<li><a href="08-04-using-redis-with-other-technologies">Using Redis with Other Technologies</a></li>
</ul>
<h2>Module 9: Advanced Redis Use Cases</h2>
<ul>
<li><a href="09-01-caching">Caching</a></li>
<li><a href="09-02-session-storage">Session Storage</a></li>
<li><a href="09-03-message-queues">Message Queues</a></li>
<li><a href="09-04-real-time-analytics">Real-Time Analytics</a></li>
</ul>
<h2>Module 10: Redis in Production</h2>
<ul>
<li><a href="10-01-deployment-strategies">Deployment Strategies</a></li>
<li><a href="10-02-monitoring-and-maintenance">Monitoring and Maintenance</a></li>
<li><a href="10-03-troubleshooting">Troubleshooting</a></li>
<li><a href="10-04-case-studies">Case Studies</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
