<!DOCTYPE html>
<html lang="en">
<head>
    <title> Producers and Consumers </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/kafka/02-01-producers-and-consumers" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/kafka/02-01-producers-and-consumers" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/kafka/02-01-producers-and-consumers" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "kafka";
  		var TEMA_NAME = "2-1";
  		var TYPE = "mod";
  		var PATH = "mod/kafka/02-01-producers-and-consumers";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.8d8afe898f.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/kafka/02-01-producers-and-consumers" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/kafka/02-01-producers-and-consumers" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="kafka">
		<a  href="#" class="text-secondary d-none" data-read-mod="kafka" data-read-unit="2-1" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="kafka" data-unread-unit="2-1" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='01-04-setting-up-kafka' title="Setting Up Kafka" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='01-04-setting-up-kafka' title="Setting Up Kafka" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Producers and Consumers</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='02-02-topics-and-partitions' title="Topics and Partitions" class="py-2 px-3 btn btn-primary"
				data-read-mod="kafka" data-read-unit="2-1">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='02-02-topics-and-partitions' title="Topics and Partitions" class="py-2 px-3 btn btn-primary" 
				data-read-mod="kafka" data-read-unit="2-1">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into the core concepts of Kafka producers and consumers. Understanding these components is crucial for effectively working with Kafka, as they form the backbone of Kafka's messaging system.</p>
</div><h2>What are Producers and Consumers?</h2>
<div class='content'></div><h3>Producers</h3>
<div class='content'><ul>
<li><strong>Definition</strong>: Producers are applications that send (or produce) messages to Kafka topics.</li>
<li><strong>Functionality</strong>: They are responsible for creating and sending data to Kafka. Producers can send data to one or more topics.</li>
<li><strong>Key Characteristics</strong>:
<ul>
<li><strong>Asynchronous</strong>: Producers can send messages asynchronously, allowing for high throughput.</li>
<li><strong>Partitioning</strong>: Producers can specify the partition to which a message should be sent, or Kafka can determine the partition based on a partitioning strategy.</li>
<li><strong>Acknowledgments</strong>: Producers can be configured to wait for acknowledgments from Kafka brokers to ensure message delivery.</li>
</ul>
</li>
</ul>
</div><h3>Consumers</h3>
<div class='content'><ul>
<li><strong>Definition</strong>: Consumers are applications that read (or consume) messages from Kafka topics.</li>
<li><strong>Functionality</strong>: They subscribe to one or more topics and process the messages produced to those topics.</li>
<li><strong>Key Characteristics</strong>:
<ul>
<li><strong>Consumer Groups</strong>: Consumers can be part of a consumer group. Each message is delivered to one consumer within the group, enabling load balancing.</li>
<li><strong>Offset Management</strong>: Consumers keep track of the messages they have read using offsets. This allows them to resume reading from where they left off in case of a failure.</li>
</ul>
</li>
</ul>
</div><h2>How Producers and Consumers Work</h2>
<div class='content'></div><h3>Producers</h3>
<div class='content'><ol>
<li><strong>Create a Producer Instance</strong>: Initialize a producer with the necessary configurations.</li>
<li><strong>Send Messages</strong>: Use the producer instance to send messages to a specified topic.</li>
<li><strong>Handle Acknowledgments</strong>: Optionally, handle acknowledgments to ensure message delivery.</li>
</ol>
</div><h3>Consumers</h3>
<div class='content'><ol>
<li><strong>Create a Consumer Instance</strong>: Initialize a consumer with the necessary configurations.</li>
<li><strong>Subscribe to Topics</strong>: Subscribe to one or more topics to start receiving messages.</li>
<li><strong>Poll for Messages</strong>: Continuously poll Kafka for new messages.</li>
<li><strong>Process Messages</strong>: Process the received messages.</li>
<li><strong>Commit Offsets</strong>: Commit the offsets of the processed messages to keep track of the consumer's progress.</li>
</ol>
</div><h2>Practical Example</h2>
<div class='content'></div><h3>Producer Example</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBrYWZrYSBpbXBvcnQgS2Fma2FQcm9kdWNlcgoKIyBDcmVhdGUgYSBLYWZrYSBwcm9kdWNlciBpbnN0YW5jZQpwcm9kdWNlciA9IEthZmthUHJvZHVjZXIoYm9vdHN0cmFwX3NlcnZlcnM9J2xvY2FsaG9zdDo5MDkyJykKCiMgU2VuZCBhIG1lc3NhZ2UgdG8gdGhlICd0ZXN0LXRvcGljJyB0b3BpYwpwcm9kdWNlci5zZW5kKCd0ZXN0LXRvcGljJywgYidIZWxsbywgS2Fma2EhJykKCiMgRW5zdXJlIGFsbCBtZXNzYWdlcyBhcmUgc2VudCBiZWZvcmUgY2xvc2luZyB0aGUgcHJvZHVjZXIKcHJvZHVjZXIuZmx1c2goKQpwcm9kdWNlci5jbG9zZSgp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from kafka import KafkaProducer

# Create a Kafka producer instance
producer = KafkaProducer(bootstrap_servers='localhost:9092')

# Send a message to the 'test-topic' topic
producer.send('test-topic', b'Hello, Kafka!')

# Ensure all messages are sent before closing the producer
producer.flush()
producer.close()</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>KafkaProducer</code>: Initializes a producer instance.</li>
<li><code>bootstrap_servers</code>: Specifies the Kafka broker address.</li>
<li><code>send</code>: Sends a message to the specified topic.</li>
<li><code>flush</code>: Ensures all messages are sent.</li>
<li><code>close</code>: Closes the producer instance.</li>
</ul>
</div><h3>Consumer Example</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBrYWZrYSBpbXBvcnQgS2Fma2FDb25zdW1lcgoKIyBDcmVhdGUgYSBLYWZrYSBjb25zdW1lciBpbnN0YW5jZQpjb25zdW1lciA9IEthZmthQ29uc3VtZXIoJ3Rlc3QtdG9waWMnLCBib290c3RyYXBfc2VydmVycz0nbG9jYWxob3N0OjkwOTInLCBhdXRvX29mZnNldF9yZXNldD0nZWFybGllc3QnLCBncm91cF9pZD0nbXktZ3JvdXAnKQoKIyBDb250aW51b3VzbHkgcG9sbCBmb3IgbmV3IG1lc3NhZ2VzCmZvciBtZXNzYWdlIGluIGNvbnN1bWVyOgogICAgcHJpbnQoZiJSZWNlaXZlZCBtZXNzYWdlOiB7bWVzc2FnZS52YWx1ZS5kZWNvZGUoJ3V0Zi04Jyl9IikKCiMgQ2xvc2UgdGhlIGNvbnN1bWVyIGluc3RhbmNlCmNvbnN1bWVyLmNsb3NlKCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from kafka import KafkaConsumer

# Create a Kafka consumer instance
consumer = KafkaConsumer('test-topic', bootstrap_servers='localhost:9092', auto_offset_reset='earliest', group_id='my-group')

# Continuously poll for new messages
for message in consumer:
    print(f&quot;Received message: {message.value.decode('utf-8')}&quot;)

# Close the consumer instance
consumer.close()</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>KafkaConsumer</code>: Initializes a consumer instance.</li>
<li><code>auto_offset_reset</code>: Specifies where to start reading messages if no offset is found.</li>
<li><code>group_id</code>: Specifies the consumer group ID.</li>
<li><code>for message in consumer</code>: Continuously polls for new messages.</li>
<li><code>message.value.decode('utf-8')</code>: Decodes the message value from bytes to a string.</li>
<li><code>close</code>: Closes the consumer instance.</li>
</ul>
</div><h2>Exercises</h2>
<div class='content'></div><h3>Exercise 1: Create a Producer</h3>
<div class='content'><ol>
<li>Initialize a Kafka producer.</li>
<li>Send a message to a topic named <code>exercise-topic</code>.</li>
<li>Ensure the message is sent and close the producer.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBrYWZrYSBpbXBvcnQgS2Fma2FQcm9kdWNlcgoKcHJvZHVjZXIgPSBLYWZrYVByb2R1Y2VyKGJvb3RzdHJhcF9zZXJ2ZXJzPSdsb2NhbGhvc3Q6OTA5MicpCnByb2R1Y2VyLnNlbmQoJ2V4ZXJjaXNlLXRvcGljJywgYidUaGlzIGlzIGEgdGVzdCBtZXNzYWdlJykKcHJvZHVjZXIuZmx1c2goKQpwcm9kdWNlci5jbG9zZSgp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from kafka import KafkaProducer

producer = KafkaProducer(bootstrap_servers='localhost:9092')
producer.send('exercise-topic', b'This is a test message')
producer.flush()
producer.close()</pre></div><div class='content'></div><h3>Exercise 2: Create a Consumer</h3>
<div class='content'><ol>
<li>Initialize a Kafka consumer.</li>
<li>Subscribe to the <code>exercise-topic</code>.</li>
<li>Print the messages received from the topic.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBrYWZrYSBpbXBvcnQgS2Fma2FDb25zdW1lcgoKY29uc3VtZXIgPSBLYWZrYUNvbnN1bWVyKCdleGVyY2lzZS10b3BpYycsIGJvb3RzdHJhcF9zZXJ2ZXJzPSdsb2NhbGhvc3Q6OTA5MicsIGF1dG9fb2Zmc2V0X3Jlc2V0PSdlYXJsaWVzdCcsIGdyb3VwX2lkPSdleGVyY2lzZS1ncm91cCcpCgpmb3IgbWVzc2FnZSBpbiBjb25zdW1lcjoKICAgIHByaW50KGYiUmVjZWl2ZWQgbWVzc2FnZToge21lc3NhZ2UudmFsdWUuZGVjb2RlKCd1dGYtOCcpfSIpCgpjb25zdW1lci5jbG9zZSgp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from kafka import KafkaConsumer

consumer = KafkaConsumer('exercise-topic', bootstrap_servers='localhost:9092', auto_offset_reset='earliest', group_id='exercise-group')

for message in consumer:
    print(f&quot;Received message: {message.value.decode('utf-8')}&quot;)

consumer.close()</pre></div><div class='content'></div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Producer Configuration</strong>: Ensure the <code>bootstrap_servers</code> configuration is correct. Incorrect broker addresses will prevent the producer from connecting.</li>
<li><strong>Consumer Offsets</strong>: Always manage offsets properly to avoid reprocessing messages or missing messages.</li>
<li><strong>Error Handling</strong>: Implement error handling in both producers and consumers to handle network issues, broker failures, etc.</li>
</ul>
</div><h2>Conclusion</h2>
<div class='content'><p>In this section, we covered the fundamental concepts of Kafka producers and consumers. We learned how to create and configure producers and consumers, send and receive messages, and manage offsets. Understanding these concepts is essential for building robust Kafka applications. In the next section, we will explore topics and partitions, which are crucial for organizing and distributing messages in Kafka.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='01-04-setting-up-kafka' title="Setting Up Kafka" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='01-04-setting-up-kafka' title="Setting Up Kafka" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='02-02-topics-and-partitions' title="Topics and Partitions" class="py-2 px-3 btn btn-primary"
				data-read-mod="kafka" data-read-unit="2-1">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='02-02-topics-and-partitions' title="Topics and Partitions" class="py-2 px-3 btn btn-primary" 
				data-read-mod="kafka" data-read-unit="2-1">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Kafka Course</h1>
<h2>Module 1: Introduction to Kafka</h2>
<ul>
<li><a href="01-01-what-is-kafka">What is Kafka?</a></li>
<li><a href="01-02-kafka-use-cases">Kafka Use Cases</a></li>
<li><a href="01-03-kafka-architecture-overview">Kafka Architecture Overview</a></li>
<li><a href="01-04-setting-up-kafka">Setting Up Kafka</a></li>
</ul>
<h2>Module 2: Kafka Core Concepts</h2>
<ul>
<li><a href="02-01-producers-and-consumers">Producers and Consumers</a></li>
<li><a href="02-02-topics-and-partitions">Topics and Partitions</a></li>
<li><a href="02-03-brokers-and-clusters">Brokers and Clusters</a></li>
<li><a href="02-04-messages-and-offsets">Messages and Offsets</a></li>
</ul>
<h2>Module 3: Kafka Operations</h2>
<ul>
<li><a href="03-01-producing-messages">Producing Messages</a></li>
<li><a href="03-02-consuming-messages">Consuming Messages</a></li>
<li><a href="03-03-kafka-connect">Kafka Connect</a></li>
<li><a href="03-04-kafka-streams">Kafka Streams</a></li>
</ul>
<h2>Module 4: Kafka Configuration and Management</h2>
<ul>
<li><a href="04-01-configuring-kafka">Configuring Kafka</a></li>
<li><a href="04-02-managing-kafka-topics">Managing Kafka Topics</a></li>
<li><a href="04-03-monitoring-kafka">Monitoring Kafka</a></li>
<li><a href="04-04-kafka-security">Kafka Security</a></li>
</ul>
<h2>Module 5: Advanced Kafka Topics</h2>
<ul>
<li><a href="05-01-kafka-performance-tuning">Kafka Performance Tuning</a></li>
<li><a href="05-02-kafka-multi-data-center">Kafka in a Multi-Data Center Setup</a></li>
<li><a href="05-03-kafka-schema-registry">Kafka with Schema Registry</a></li>
<li><a href="05-04-kafka-streams-advanced">Kafka Streams Advanced</a></li>
</ul>
<h2>Module 6: Kafka Ecosystem and Integrations</h2>
<ul>
<li><a href="06-01-kafka-hadoop">Kafka with Hadoop</a></li>
<li><a href="06-02-kafka-spark">Kafka with Spark</a></li>
<li><a href="06-03-kafka-flink">Kafka with Flink</a></li>
<li><a href="06-04-kafka-elasticsearch">Kafka with Elasticsearch</a></li>
</ul>
<h2>Module 7: Kafka Case Studies and Best Practices</h2>
<ul>
<li><a href="07-01-real-world-kafka-use-cases">Real-World Kafka Use Cases</a></li>
<li><a href="07-02-kafka-best-practices">Kafka Best Practices</a></li>
<li><a href="07-03-common-kafka-pitfalls">Common Kafka Pitfalls</a></li>
<li><a href="07-04-future-of-kafka">Future of Kafka</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
