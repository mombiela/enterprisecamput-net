<!DOCTYPE html>
<html lang="en">
<head>
    <title> Consuming Messages </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/kafka/03-02-consuming-messages" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/kafka/03-02-consuming-messages" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/kafka/03-02-consuming-messages" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "kafka";
  		var TEMA_NAME = "3-2";
  		var TYPE = "mod";
  		var PATH = "mod/kafka/03-02-consuming-messages";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.ae32789132.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/kafka/03-02-consuming-messages" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/kafka/03-02-consuming-messages" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="kafka">
		<a  href="#" class="text-secondary d-none" data-read-mod="kafka" data-read-unit="3-2" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="kafka" data-unread-unit="3-2" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='03-01-producing-messages' title="Producing Messages" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='03-01-producing-messages' title="Producing Messages" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Consuming Messages</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='03-03-kafka-connect' title="Kafka Connect" class="py-2 px-3 btn btn-primary"
				data-read-mod="kafka" data-read-unit="3-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='03-03-kafka-connect' title="Kafka Connect" class="py-2 px-3 btn btn-primary" 
				data-read-mod="kafka" data-read-unit="3-2">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into the process of consuming messages from Kafka topics. Consuming messages is a fundamental operation in Kafka, allowing applications to read and process data streams. We will cover the following key concepts:</p>
<ol>
<li><strong>Introduction to Consumers</strong></li>
<li><strong>Consumer Groups</strong></li>
<li><strong>Consumer Configuration</strong></li>
<li><strong>Consuming Messages with Java</strong></li>
<li><strong>Practical Exercises</strong></li>
</ol>
</div><h2><ol>
<li>Introduction to Consumers</li>
</ol></h2>
<div class='content'><p>A Kafka consumer is an application that reads records from Kafka topics. Consumers subscribe to one or more topics and process the records in the order they are stored in the partitions.</p>
</div><h3>Key Concepts:</h3>
<div class='content'><ul>
<li><strong>Consumer</strong>: An application that reads data from Kafka topics.</li>
<li><strong>Subscription</strong>: The process of a consumer registering interest in one or more topics.</li>
<li><strong>Polling</strong>: The method by which a consumer fetches data from Kafka.</li>
</ul>
</div><h2><ol start="2">
<li>Consumer Groups</li>
</ol></h2>
<div class='content'><p>Consumers in Kafka are organized into consumer groups. Each consumer in a group reads data from a subset of the partitions in the topic(s) they subscribe to. This allows for parallel processing and load balancing.</p>
</div><h3>Key Concepts:</h3>
<div class='content'><ul>
<li><strong>Consumer Group</strong>: A group of consumers that work together to consume data from a set of topics.</li>
<li><strong>Partition Assignment</strong>: The process of assigning partitions to consumers within a group.</li>
<li><strong>Rebalancing</strong>: The process of redistributing partitions among consumers when the group membership changes.</li>
</ul>
</div><h3>Example:</h3>
<div class='content'><ul>
<li>If a topic has 4 partitions and there are 2 consumers in a group, each consumer will read from 2 partitions.</li>
</ul>
</div><h2><ol start="3">
<li>Consumer Configuration</li>
</ol></h2>
<div class='content'><p>Configuring a Kafka consumer involves setting various properties that control its behavior. Some important configurations include:</p>
<table>
<thead>
<tr>
<th>Configuration Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>bootstrap.servers</code></td>
<td>A list of host/port pairs to use for establishing the initial connection to the Kafka cluster.</td>
</tr>
<tr>
<td><code>group.id</code></td>
<td>A unique string that identifies the consumer group this consumer belongs to.</td>
</tr>
<tr>
<td><code>key.deserializer</code></td>
<td>The class name of the deserializer for the key.</td>
</tr>
<tr>
<td><code>value.deserializer</code></td>
<td>The class name of the deserializer for the value.</td>
</tr>
<tr>
<td><code>auto.offset.reset</code></td>
<td>What to do when there is no initial offset in Kafka or if the current offset does not exist. Options are <code>earliest</code>, <code>latest</code>, and <code>none</code>.</td>
</tr>
</tbody>
</table>
</div><h2><ol start="4">
<li>Consuming Messages with Java</li>
</ol></h2>
<div class='content'><p>Let's look at a practical example of consuming messages using the Kafka Java client.</p>
</div><h3>Example Code:</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5Db25zdW1lclJlY29yZDsKaW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5Db25zdW1lclJlY29yZHM7CmltcG9ydCBvcmcuYXBhY2hlLmthZmthLmNsaWVudHMuY29uc3VtZXIuS2Fma2FDb25zdW1lcjsKCmltcG9ydCBqYXZhLnRpbWUuRHVyYXRpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuUHJvcGVydGllczsKCnB1YmxpYyBjbGFzcyBTaW1wbGVDb25zdW1lciB7CiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7CiAgICAgICAgUHJvcGVydGllcyBwcm9wcyA9IG5ldyBQcm9wZXJ0aWVzKCk7CiAgICAgICAgcHJvcHMucHV0KCJib290c3RyYXAuc2VydmVycyIsICJsb2NhbGhvc3Q6OTA5MiIpOwogICAgICAgIHByb3BzLnB1dCgiZ3JvdXAuaWQiLCAidGVzdC1ncm91cCIpOwogICAgICAgIHByb3BzLnB1dCgia2V5LmRlc2VyaWFsaXplciIsICJvcmcuYXBhY2hlLmthZmthLmNvbW1vbi5zZXJpYWxpemF0aW9uLlN0cmluZ0Rlc2VyaWFsaXplciIpOwogICAgICAgIHByb3BzLnB1dCgidmFsdWUuZGVzZXJpYWxpemVyIiwgIm9yZy5hcGFjaGUua2Fma2EuY29tbW9uLnNlcmlhbGl6YXRpb24uU3RyaW5nRGVzZXJpYWxpemVyIik7CgogICAgICAgIEthZmthQ29uc3VtZXI8U3RyaW5nLCBTdHJpbmc+IGNvbnN1bWVyID0gbmV3IEthZmthQ29uc3VtZXI8Pihwcm9wcyk7CiAgICAgICAgY29uc3VtZXIuc3Vic2NyaWJlKENvbGxlY3Rpb25zLnNpbmdsZXRvbkxpc3QoInRlc3QtdG9waWMiKSk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgICAgICBDb25zdW1lclJlY29yZHM8U3RyaW5nLCBTdHJpbmc+IHJlY29yZHMgPSBjb25zdW1lci5wb2xsKER1cmF0aW9uLm9mTWlsbGlzKDEwMCkpOwogICAgICAgICAgICAgICAgZm9yIChDb25zdW1lclJlY29yZDxTdHJpbmcsIFN0cmluZz4gcmVjb3JkIDogcmVjb3JkcykgewogICAgICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRmKCJvZmZzZXQgPSAlZCwga2V5ID0gJXMsIHZhbHVlID0gJXMlbiIsIHJlY29yZC5vZmZzZXQoKSwgcmVjb3JkLmtleSgpLCByZWNvcmQudmFsdWUoKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICBjb25zdW1lci5jbG9zZSgpOwogICAgICAgIH0KICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.consumer.ConsumerRecord;
import org.apache.kafka.clients.consumer.ConsumerRecords;
import org.apache.kafka.clients.consumer.KafkaConsumer;

import java.time.Duration;
import java.util.Collections;
import java.util.Properties;

public class SimpleConsumer {
    public static void main(String[] args) {
        Properties props = new Properties();
        props.put(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
        props.put(&quot;group.id&quot;, &quot;test-group&quot;);
        props.put(&quot;key.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);
        props.put(&quot;value.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);

        KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props);
        consumer.subscribe(Collections.singletonList(&quot;test-topic&quot;));

        try {
            while (true) {
                ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMillis(100));
                for (ConsumerRecord&lt;String, String&gt; record : records) {
                    System.out.printf(&quot;offset = %d, key = %s, value = %s%n&quot;, record.offset(), record.key(), record.value());
                }
            }
        } finally {
            consumer.close();
        }
    }
}</pre></div><div class='content'></div><h3>Explanation:</h3>
<div class='content'><ul>
<li><strong>Properties</strong>: Configures the consumer with necessary properties.</li>
<li><strong>KafkaConsumer</strong>: Creates a new consumer instance.</li>
<li><strong>subscribe</strong>: Subscribes to the specified topic.</li>
<li><strong>poll</strong>: Fetches data from the topic.</li>
<li><strong>ConsumerRecords</strong>: Represents the records fetched from Kafka.</li>
<li><strong>ConsumerRecord</strong>: Represents an individual record.</li>
</ul>
</div><h2><ol start="5">
<li>Practical Exercises</li>
</ol></h2>
<div class='content'></div><h3>Exercise 1: Basic Consumer</h3>
<div class='content'><p>Write a Kafka consumer that subscribes to a topic named <code>my-topic</code> and prints the messages to the console.</p>
</div><h3>Solution:</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5Db25zdW1lclJlY29yZDsKaW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5Db25zdW1lclJlY29yZHM7CmltcG9ydCBvcmcuYXBhY2hlLmthZmthLmNsaWVudHMuY29uc3VtZXIuS2Fma2FDb25zdW1lcjsKCmltcG9ydCBqYXZhLnRpbWUuRHVyYXRpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuUHJvcGVydGllczsKCnB1YmxpYyBjbGFzcyBNeUNvbnN1bWVyIHsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBQcm9wZXJ0aWVzIHByb3BzID0gbmV3IFByb3BlcnRpZXMoKTsKICAgICAgICBwcm9wcy5wdXQoImJvb3RzdHJhcC5zZXJ2ZXJzIiwgImxvY2FsaG9zdDo5MDkyIik7CiAgICAgICAgcHJvcHMucHV0KCJncm91cC5pZCIsICJteS1ncm91cCIpOwogICAgICAgIHByb3BzLnB1dCgia2V5LmRlc2VyaWFsaXplciIsICJvcmcuYXBhY2hlLmthZmthLmNvbW1vbi5zZXJpYWxpemF0aW9uLlN0cmluZ0Rlc2VyaWFsaXplciIpOwogICAgICAgIHByb3BzLnB1dCgidmFsdWUuZGVzZXJpYWxpemVyIiwgIm9yZy5hcGFjaGUua2Fma2EuY29tbW9uLnNlcmlhbGl6YXRpb24uU3RyaW5nRGVzZXJpYWxpemVyIik7CgogICAgICAgIEthZmthQ29uc3VtZXI8U3RyaW5nLCBTdHJpbmc+IGNvbnN1bWVyID0gbmV3IEthZmthQ29uc3VtZXI8Pihwcm9wcyk7CiAgICAgICAgY29uc3VtZXIuc3Vic2NyaWJlKENvbGxlY3Rpb25zLnNpbmdsZXRvbkxpc3QoIm15LXRvcGljIikpOwoKICAgICAgICB0cnkgewogICAgICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICAgICAgQ29uc3VtZXJSZWNvcmRzPFN0cmluZywgU3RyaW5nPiByZWNvcmRzID0gY29uc3VtZXIucG9sbChEdXJhdGlvbi5vZk1pbGxpcygxMDApKTsKICAgICAgICAgICAgICAgIGZvciAoQ29uc3VtZXJSZWNvcmQ8U3RyaW5nLCBTdHJpbmc+IHJlY29yZCA6IHJlY29yZHMpIHsKICAgICAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50Zigib2Zmc2V0ID0gJWQsIGtleSA9ICVzLCB2YWx1ZSA9ICVzJW4iLCByZWNvcmQub2Zmc2V0KCksIHJlY29yZC5rZXkoKSwgcmVjb3JkLnZhbHVlKCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgY29uc3VtZXIuY2xvc2UoKTsKICAgICAgICB9CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.consumer.ConsumerRecord;
import org.apache.kafka.clients.consumer.ConsumerRecords;
import org.apache.kafka.clients.consumer.KafkaConsumer;

import java.time.Duration;
import java.util.Collections;
import java.util.Properties;

public class MyConsumer {
    public static void main(String[] args) {
        Properties props = new Properties();
        props.put(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
        props.put(&quot;group.id&quot;, &quot;my-group&quot;);
        props.put(&quot;key.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);
        props.put(&quot;value.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);

        KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props);
        consumer.subscribe(Collections.singletonList(&quot;my-topic&quot;));

        try {
            while (true) {
                ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMillis(100));
                for (ConsumerRecord&lt;String, String&gt; record : records) {
                    System.out.printf(&quot;offset = %d, key = %s, value = %s%n&quot;, record.offset(), record.key(), record.value());
                }
            }
        } finally {
            consumer.close();
        }
    }
}</pre></div><div class='content'></div><h3>Exercise 2: Handling Rebalancing</h3>
<div class='content'><p>Modify the consumer to handle rebalancing events by implementing a <code>ConsumerRebalanceListener</code>.</p>
</div><h3>Solution:</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5Db25zdW1lclJlYmFsYW5jZUxpc3RlbmVyOwppbXBvcnQgb3JnLmFwYWNoZS5rYWZrYS5jbGllbnRzLmNvbnN1bWVyLkNvbnN1bWVyUmVjb3JkOwppbXBvcnQgb3JnLmFwYWNoZS5rYWZrYS5jbGllbnRzLmNvbnN1bWVyLkNvbnN1bWVyUmVjb3JkczsKaW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5LYWZrYUNvbnN1bWVyOwppbXBvcnQgb3JnLmFwYWNoZS5rYWZrYS5jb21tb24uVG9waWNQYXJ0aXRpb247CgppbXBvcnQgamF2YS50aW1lLkR1cmF0aW9uOwppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuUHJvcGVydGllczsKCnB1YmxpYyBjbGFzcyBSZWJhbGFuY2VDb25zdW1lciB7CiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7CiAgICAgICAgUHJvcGVydGllcyBwcm9wcyA9IG5ldyBQcm9wZXJ0aWVzKCk7CiAgICAgICAgcHJvcHMucHV0KCJib290c3RyYXAuc2VydmVycyIsICJsb2NhbGhvc3Q6OTA5MiIpOwogICAgICAgIHByb3BzLnB1dCgiZ3JvdXAuaWQiLCAicmViYWxhbmNlLWdyb3VwIik7CiAgICAgICAgcHJvcHMucHV0KCJrZXkuZGVzZXJpYWxpemVyIiwgIm9yZy5hcGFjaGUua2Fma2EuY29tbW9uLnNlcmlhbGl6YXRpb24uU3RyaW5nRGVzZXJpYWxpemVyIik7CiAgICAgICAgcHJvcHMucHV0KCJ2YWx1ZS5kZXNlcmlhbGl6ZXIiLCAib3JnLmFwYWNoZS5rYWZrYS5jb21tb24uc2VyaWFsaXphdGlvbi5TdHJpbmdEZXNlcmlhbGl6ZXIiKTsKCiAgICAgICAgS2Fma2FDb25zdW1lcjxTdHJpbmcsIFN0cmluZz4gY29uc3VtZXIgPSBuZXcgS2Fma2FDb25zdW1lcjw+KHByb3BzKTsKICAgICAgICBjb25zdW1lci5zdWJzY3JpYmUoQ29sbGVjdGlvbnMuc2luZ2xldG9uTGlzdCgicmViYWxhbmNlLXRvcGljIiksIG5ldyBDb25zdW1lclJlYmFsYW5jZUxpc3RlbmVyKCkgewogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgb25QYXJ0aXRpb25zUmV2b2tlZChDb2xsZWN0aW9uPFRvcGljUGFydGl0aW9uPiBwYXJ0aXRpb25zKSB7CiAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlBhcnRpdGlvbnMgcmV2b2tlZDogIiArIHBhcnRpdGlvbnMpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBAT3ZlcnJpZGUKICAgICAgICAgICAgcHVibGljIHZvaWQgb25QYXJ0aXRpb25zQXNzaWduZWQoQ29sbGVjdGlvbjxUb3BpY1BhcnRpdGlvbj4gcGFydGl0aW9ucykgewogICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJQYXJ0aXRpb25zIGFzc2lnbmVkOiAiICsgcGFydGl0aW9ucyk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAgICAgIENvbnN1bWVyUmVjb3JkczxTdHJpbmcsIFN0cmluZz4gcmVjb3JkcyA9IGNvbnN1bWVyLnBvbGwoRHVyYXRpb24ub2ZNaWxsaXMoMTAwKSk7CiAgICAgICAgICAgICAgICBmb3IgKENvbnN1bWVyUmVjb3JkPFN0cmluZywgU3RyaW5nPiByZWNvcmQgOiByZWNvcmRzKSB7CiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGYoIm9mZnNldCA9ICVkLCBrZXkgPSAlcywgdmFsdWUgPSAlcyVuIiwgcmVjb3JkLm9mZnNldCgpLCByZWNvcmQua2V5KCksIHJlY29yZC52YWx1ZSgpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgIGNvbnN1bWVyLmNsb3NlKCk7CiAgICAgICAgfQogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.consumer.ConsumerRebalanceListener;
import org.apache.kafka.clients.consumer.ConsumerRecord;
import org.apache.kafka.clients.consumer.ConsumerRecords;
import org.apache.kafka.clients.consumer.KafkaConsumer;
import org.apache.kafka.common.TopicPartition;

import java.time.Duration;
import java.util.Collection;
import java.util.Collections;
import java.util.Properties;

public class RebalanceConsumer {
    public static void main(String[] args) {
        Properties props = new Properties();
        props.put(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
        props.put(&quot;group.id&quot;, &quot;rebalance-group&quot;);
        props.put(&quot;key.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);
        props.put(&quot;value.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);

        KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props);
        consumer.subscribe(Collections.singletonList(&quot;rebalance-topic&quot;), new ConsumerRebalanceListener() {
            @Override
            public void onPartitionsRevoked(Collection&lt;TopicPartition&gt; partitions) {
                System.out.println(&quot;Partitions revoked: &quot; + partitions);
            }

            @Override
            public void onPartitionsAssigned(Collection&lt;TopicPartition&gt; partitions) {
                System.out.println(&quot;Partitions assigned: &quot; + partitions);
            }
        });

        try {
            while (true) {
                ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMillis(100));
                for (ConsumerRecord&lt;String, String&gt; record : records) {
                    System.out.printf(&quot;offset = %d, key = %s, value = %s%n&quot;, record.offset(), record.key(), record.value());
                }
            }
        } finally {
            consumer.close();
        }
    }
}</pre></div><div class='content'></div><h3>Common Mistakes:</h3>
<div class='content'><ul>
<li><strong>Not closing the consumer</strong>: Always close the consumer to release resources.</li>
<li><strong>Incorrect deserializer configuration</strong>: Ensure the deserializer matches the data type of the messages.</li>
<li><strong>Ignoring rebalancing</strong>: Handle rebalancing to ensure smooth operation of the consumer group.</li>
</ul>
</div><h2>Conclusion</h2>
<div class='content'><p>In this section, we covered the basics of consuming messages in Kafka, including consumer groups, configuration, and practical examples using Java. Understanding these concepts is crucial for building robust Kafka consumers that can efficiently process data streams. In the next section, we will explore Kafka Connect, a tool for integrating Kafka with other data systems.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='03-01-producing-messages' title="Producing Messages" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='03-01-producing-messages' title="Producing Messages" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='03-03-kafka-connect' title="Kafka Connect" class="py-2 px-3 btn btn-primary"
				data-read-mod="kafka" data-read-unit="3-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='03-03-kafka-connect' title="Kafka Connect" class="py-2 px-3 btn btn-primary" 
				data-read-mod="kafka" data-read-unit="3-2">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Kafka Course</h1>
<h2>Module 1: Introduction to Kafka</h2>
<ul>
<li><a href="01-01-what-is-kafka">What is Kafka?</a></li>
<li><a href="01-02-kafka-use-cases">Kafka Use Cases</a></li>
<li><a href="01-03-kafka-architecture-overview">Kafka Architecture Overview</a></li>
<li><a href="01-04-setting-up-kafka">Setting Up Kafka</a></li>
</ul>
<h2>Module 2: Kafka Core Concepts</h2>
<ul>
<li><a href="02-01-producers-and-consumers">Producers and Consumers</a></li>
<li><a href="02-02-topics-and-partitions">Topics and Partitions</a></li>
<li><a href="02-03-brokers-and-clusters">Brokers and Clusters</a></li>
<li><a href="02-04-messages-and-offsets">Messages and Offsets</a></li>
</ul>
<h2>Module 3: Kafka Operations</h2>
<ul>
<li><a href="03-01-producing-messages">Producing Messages</a></li>
<li><a href="03-02-consuming-messages">Consuming Messages</a></li>
<li><a href="03-03-kafka-connect">Kafka Connect</a></li>
<li><a href="03-04-kafka-streams">Kafka Streams</a></li>
</ul>
<h2>Module 4: Kafka Configuration and Management</h2>
<ul>
<li><a href="04-01-configuring-kafka">Configuring Kafka</a></li>
<li><a href="04-02-managing-kafka-topics">Managing Kafka Topics</a></li>
<li><a href="04-03-monitoring-kafka">Monitoring Kafka</a></li>
<li><a href="04-04-kafka-security">Kafka Security</a></li>
</ul>
<h2>Module 5: Advanced Kafka Topics</h2>
<ul>
<li><a href="05-01-kafka-performance-tuning">Kafka Performance Tuning</a></li>
<li><a href="05-02-kafka-multi-data-center">Kafka in a Multi-Data Center Setup</a></li>
<li><a href="05-03-kafka-schema-registry">Kafka with Schema Registry</a></li>
<li><a href="05-04-kafka-streams-advanced">Kafka Streams Advanced</a></li>
</ul>
<h2>Module 6: Kafka Ecosystem and Integrations</h2>
<ul>
<li><a href="06-01-kafka-hadoop">Kafka with Hadoop</a></li>
<li><a href="06-02-kafka-spark">Kafka with Spark</a></li>
<li><a href="06-03-kafka-flink">Kafka with Flink</a></li>
<li><a href="06-04-kafka-elasticsearch">Kafka with Elasticsearch</a></li>
</ul>
<h2>Module 7: Kafka Case Studies and Best Practices</h2>
<ul>
<li><a href="07-01-real-world-kafka-use-cases">Real-World Kafka Use Cases</a></li>
<li><a href="07-02-kafka-best-practices">Kafka Best Practices</a></li>
<li><a href="07-03-common-kafka-pitfalls">Common Kafka Pitfalls</a></li>
<li><a href="07-04-future-of-kafka">Future of Kafka</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
