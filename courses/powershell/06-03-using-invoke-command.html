<!DOCTYPE html>
<html lang="en">
<head>
    <title> Using Invoke-Command </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/powershell/06-03-using-invoke-command" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/powershell/06-03-using-invoke-command" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/powershell/06-03-using-invoke-command" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "languages";
  		var MOD_NAME = "powershell";
  		var TEMA_NAME = "6-3";
  		var TYPE = "mod";
  		var PATH = "mod/powershell/06-03-using-invoke-command";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.688defeeef.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/powershell/06-03-using-invoke-command" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/powershell/06-03-using-invoke-command" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="powershell">
		<a  href="#" class="text-secondary d-none" data-read-mod="powershell" data-read-unit="6-3" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="powershell" data-unread-unit="6-3" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-02-setting-up-remoting' title="Setting Up Remoting" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-02-setting-up-remoting' title="Setting Up Remoting" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Using Invoke-Command</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='06-04-session-management' title="Session Management" class="py-2 px-3 btn btn-primary"
				data-read-mod="powershell" data-read-unit="6-3">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='06-04-session-management' title="Session Management" class="py-2 px-3 btn btn-primary" 
				data-read-mod="powershell" data-read-unit="6-3">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'></div><h2>Introduction</h2>
<div class='content'><p><code>Invoke-Command</code> is a powerful cmdlet in PowerShell that allows you to run commands on local and remote computers. This is particularly useful for managing multiple systems simultaneously, automating tasks, and performing administrative functions across a network.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Cmdlet</strong>: A lightweight command used in the PowerShell environment.</li>
<li><strong>Remote Session</strong>: A connection to a remote computer that allows you to run commands as if you were logged in locally.</li>
<li><strong>ScriptBlock</strong>: A block of code or a script that you want to execute.</li>
</ul>
</div><h2>Basic Syntax</h2>
<div class='content'><p>The basic syntax for <code>Invoke-Command</code> is as follows:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSA8Q29tcHV0ZXJOYW1lPiAtU2NyaXB0QmxvY2sgeyA8U2NyaXB0PiB9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName &lt;ComputerName&gt; -ScriptBlock { &lt;Script&gt; }</pre></div><div class='content'><ul>
<li><code>-ComputerName</code>: Specifies the remote computer(s) on which the command should be executed.</li>
<li><code>-ScriptBlock</code>: Contains the commands or script to be executed.</li>
</ul>
</div><h2>Examples</h2>
<div class='content'></div><h3>Example 1: Running a Command on a Remote Computer</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAiU2VydmVyMDEiIC1TY3JpcHRCbG9jayB7IEdldC1Qcm9jZXNzIH0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName &quot;Server01&quot; -ScriptBlock { Get-Process }</pre></div><div class='content'><p>This command retrieves the list of processes running on the remote computer &quot;Server01&quot;.</p>
</div><h3>Example 2: Running a ScriptBlock on Multiple Computers</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGNvbXB1dGVycyA9ICJTZXJ2ZXIwMSIsICJTZXJ2ZXIwMiIsICJTZXJ2ZXIwMyIKSW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAkY29tcHV0ZXJzIC1TY3JpcHRCbG9jayB7IEdldC1TZXJ2aWNlIH0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$computers = &quot;Server01&quot;, &quot;Server02&quot;, &quot;Server03&quot;
Invoke-Command -ComputerName $computers -ScriptBlock { Get-Service }</pre></div><div class='content'><p>This command retrieves the list of services running on multiple remote computers specified in the <code>$computers</code> array.</p>
</div><h3>Example 3: Using Credentials for Remote Execution</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGNyZWQgPSBHZXQtQ3JlZGVudGlhbApJbnZva2UtQ29tbWFuZCAtQ29tcHV0ZXJOYW1lICJTZXJ2ZXIwMSIgLUNyZWRlbnRpYWwgJGNyZWQgLVNjcmlwdEJsb2NrIHsgR2V0LUV2ZW50TG9nIC1Mb2dOYW1lIFN5c3RlbSB9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$cred = Get-Credential
Invoke-Command -ComputerName &quot;Server01&quot; -Credential $cred -ScriptBlock { Get-EventLog -LogName System }</pre></div><div class='content'><p>This command retrieves the system event log from &quot;Server01&quot; using the credentials provided by the user.</p>
</div><h3>Example 4: Running a Local Command</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLVNjcmlwdEJsb2NrIHsgR2V0LUNoaWxkSXRlbSAiQzpcV2luZG93cyIgfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ScriptBlock { Get-ChildItem &quot;C:\Windows&quot; }</pre></div><div class='content'><p>This command lists the contents of the &quot;C:\Windows&quot; directory on the local computer.</p>
</div><h2>Practical Exercise</h2>
<div class='content'></div><h3>Exercise 1: Retrieve Disk Space Information</h3>
<div class='content'><p><strong>Objective</strong>: Use <code>Invoke-Command</code> to retrieve disk space information from multiple remote computers.</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Create an array of computer names.</li>
<li>Use <code>Invoke-Command</code> to run a script block that retrieves disk space information.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGNvbXB1dGVycyA9ICJTZXJ2ZXIwMSIsICJTZXJ2ZXIwMiIsICJTZXJ2ZXIwMyIKSW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAkY29tcHV0ZXJzIC1TY3JpcHRCbG9jayB7CiAgICBHZXQtUFNEcml2ZSAtUFNQcm92aWRlciBGaWxlU3lzdGVtIHwgU2VsZWN0LU9iamVjdCBOYW1lLCBAe05hbWU9IkZyZWVTcGFjZShHQikiO0V4cHJlc3Npb249e1ttYXRoXTo6cm91bmQoJF8uRnJlZS8xR0IsMil9fQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$computers = &quot;Server01&quot;, &quot;Server02&quot;, &quot;Server03&quot;
Invoke-Command -ComputerName $computers -ScriptBlock {
    Get-PSDrive -PSProvider FileSystem | Select-Object Name, @{Name=&quot;FreeSpace(GB)&quot;;Expression={[math]::round($_.Free/1GB,2)}}
}</pre></div><div class='content'></div><h3>Exercise 2: Restart a Service on a Remote Computer</h3>
<div class='content'><p><strong>Objective</strong>: Use <code>Invoke-Command</code> to restart the &quot;Spooler&quot; service on a remote computer.</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Specify the remote computer name.</li>
<li>Use <code>Invoke-Command</code> to run a script block that restarts the &quot;Spooler&quot; service.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAiU2VydmVyMDEiIC1TY3JpcHRCbG9jayB7CiAgICBSZXN0YXJ0LVNlcnZpY2UgLU5hbWUgIlNwb29sZXIiCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName &quot;Server01&quot; -ScriptBlock {
    Restart-Service -Name &quot;Spooler&quot;
}</pre></div><div class='content'></div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Incorrect Computer Name</strong>: Ensure that the computer names are correct and reachable.</li>
<li><strong>Permissions</strong>: Make sure you have the necessary permissions to run commands on the remote computer.</li>
<li><strong>Firewall Settings</strong>: Ensure that the firewall settings on the remote computer allow remote management.</li>
<li><strong>Credential Management</strong>: Use <code>Get-Credential</code> to securely manage credentials for remote sessions.</li>
</ul>
</div><h2>Conclusion</h2>
<div class='content'><p><code>Invoke-Command</code> is an essential cmdlet for remote management and automation in PowerShell. By understanding its syntax and usage, you can efficiently manage multiple systems and perform complex administrative tasks. Practice using <code>Invoke-Command</code> with different scenarios to become proficient in remote command execution.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-02-setting-up-remoting' title="Setting Up Remoting" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-02-setting-up-remoting' title="Setting Up Remoting" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='06-04-session-management' title="Session Management" class="py-2 px-3 btn btn-primary"
				data-read-mod="powershell" data-read-unit="6-3">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='06-04-session-management' title="Session Management" class="py-2 px-3 btn btn-primary" 
				data-read-mod="powershell" data-read-unit="6-3">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>PowerShell Course</h1>
<h2>Module 1: Introduction to PowerShell</h2>
<ul>
<li><a href="01-01-what-is-powershell">What is PowerShell?</a></li>
<li><a href="01-02-installing-setting-up">Installing and Setting Up PowerShell</a></li>
<li><a href="01-03-console-ise">PowerShell Console and ISE</a></li>
<li><a href="01-04-basic-commands-syntax">Basic Commands and Syntax</a></li>
<li><a href="01-05-help-system">Help System in PowerShell</a></li>
</ul>
<h2>Module 2: Basic Scripting</h2>
<ul>
<li><a href="02-01-variables-data-types">Variables and Data Types</a></li>
<li><a href="02-02-operators">Operators in PowerShell</a></li>
<li><a href="02-03-conditional-statements">Conditional Statements</a></li>
<li><a href="02-04-loops">Loops in PowerShell</a></li>
<li><a href="02-05-functions-scripts">Functions and Scripts</a></li>
</ul>
<h2>Module 3: Working with Objects</h2>
<ul>
<li><a href="03-01-understanding-objects">Understanding Objects</a></li>
<li><a href="03-02-properties-methods">Object Properties and Methods</a></li>
<li><a href="03-03-pipelines-manipulation">Pipelines and Object Manipulation</a></li>
<li><a href="03-04-filtering-selecting">Filtering and Selecting Objects</a></li>
<li><a href="03-05-sorting-grouping">Sorting and Grouping Objects</a></li>
</ul>
<h2>Module 4: Advanced Scripting Techniques</h2>
<ul>
<li><a href="04-01-error-handling">Error Handling</a></li>
<li><a href="04-02-debugging-scripts">Debugging Scripts</a></li>
<li><a href="04-03-regular-expressions">Regular Expressions</a></li>
<li><a href="04-04-files-directories">Working with Files and Directories</a></li>
<li><a href="04-05-modules-snap-ins">Using Modules and Snap-ins</a></li>
</ul>
<h2>Module 5: Automation and Task Scheduling</h2>
<ul>
<li><a href="05-01-introduction-automation">Introduction to Automation</a></li>
<li><a href="05-02-creating-scheduled-tasks">Creating Scheduled Tasks</a></li>
<li><a href="05-03-system-administration">Using PowerShell for System Administration</a></li>
<li><a href="05-04-automating-active-directory">Automating Active Directory Tasks</a></li>
<li><a href="05-05-automating-network-tasks">Automating Network Tasks</a></li>
</ul>
<h2>Module 6: PowerShell Remoting</h2>
<ul>
<li><a href="06-01-introduction-remoting">Introduction to Remoting</a></li>
<li><a href="06-02-setting-up-remoting">Setting Up Remoting</a></li>
<li><a href="06-03-using-invoke-command">Using Invoke-Command</a></li>
<li><a href="06-04-session-management">Session Management</a></li>
<li><a href="06-05-security-considerations">Security Considerations</a></li>
</ul>
<h2>Module 7: Advanced PowerShell Features</h2>
<ul>
<li><a href="07-01-powershell-profiles">PowerShell Profiles</a></li>
<li><a href="07-02-customizing-environment">Customizing the PowerShell Environment</a></li>
<li><a href="07-03-creating-using-classes">Creating and Using Classes</a></li>
<li><a href="07-04-working-xml-json">Working with XML and JSON</a></li>
<li><a href="07-05-using-rest-apis">Using PowerShell with REST APIs</a></li>
</ul>
<h2>Module 8: PowerShell and DevOps</h2>
<ul>
<li><a href="08-01-introduction-devops">Introduction to DevOps</a></li>
<li><a href="08-02-using-ci-cd-pipelines">Using PowerShell with CI/CD Pipelines</a></li>
<li><a href="08-03-infrastructure-as-code">Infrastructure as Code (IaC)</a></li>
<li><a href="08-04-managing-cloud-resources">Managing Cloud Resources with PowerShell</a></li>
<li><a href="08-05-powershell-docker">PowerShell and Docker</a></li>
</ul>
<h2>Module 9: Best Practices and Advanced Tips</h2>
<ul>
<li><a href="09-01-readable-maintainable-code">Writing Readable and Maintainable Code</a></li>
<li><a href="09-02-performance-optimization">Performance Optimization</a></li>
<li><a href="09-03-security-best-practices">Security Best Practices</a></li>
<li><a href="09-04-version-control-git">Version Control with Git</a></li>
<li><a href="09-05-community-resources">Community Resources and Further Learning</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
