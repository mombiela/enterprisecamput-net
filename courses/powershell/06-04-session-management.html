<!DOCTYPE html>
<html lang="en">
<head>
    <title> Session Management </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, nofollow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/powershell/06-04-session-management" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/powershell/06-04-session-management" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/powershell/06-04-session-management" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.188a386f47.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "languages";
  		var MOD_NAME = "powershell";
  		var TEMA_NAME = "6-4";
  		var TYPE = "mod";
  		var PATH = "mod/powershell/06-04-session-management";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/powershell/06-04-session-management" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/powershell/06-04-session-management" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="powershell">
		<a  href="#" class="text-secondary d-none" data-read-mod="powershell" data-read-unit="6-4" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="powershell" data-unread-unit="6-4" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-03-using-invoke-command' title="Using Invoke-Command" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-03-using-invoke-command' title="Using Invoke-Command" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Session Management</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='06-05-security-considerations' title="Security Considerations" class="py-2 px-3 btn btn-primary"
				data-read-mod="powershell" data-read-unit="6-4">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='06-05-security-considerations' title="Security Considerations" class="py-2 px-3 btn btn-primary" 
				data-read-mod="powershell" data-read-unit="6-4">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to manage sessions in PowerShell Remoting. Sessions allow you to maintain a persistent connection to a remote computer, which can be reused for multiple commands. This can be more efficient than creating a new connection for each command.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ol>
<li><strong>PowerShell Sessions</strong>: Persistent connections to remote computers.</li>
<li><strong>Creating Sessions</strong>: Using <code>New-PSSession</code> to establish a session.</li>
<li><strong>Using Sessions</strong>: Running commands within an established session.</li>
<li><strong>Managing Sessions</strong>: Viewing, disconnecting, and removing sessions.</li>
<li><strong>Session Options</strong>: Configuring session options for specific needs.</li>
</ol>
</div><h2>Creating a Session</h2>
<div class='content'><p>To create a new session, use the <code>New-PSSession</code> cmdlet. This cmdlet establishes a persistent connection to a remote computer.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcgc2Vzc2lvbiB0byBhIHJlbW90ZSBjb21wdXRlcgokc2Vzc2lvbiA9IE5ldy1QU1Nlc3Npb24gLUNvbXB1dGVyTmFtZSAiUmVtb3RlQ29tcHV0ZXJOYW1lIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new session to a remote computer
$session = New-PSSession -ComputerName &quot;RemoteComputerName&quot;</pre></div><div class='content'></div><h3>Explanation</h3>
<div class='content'><ul>
<li><code>New-PSSession</code>: Cmdlet to create a new session.</li>
<li><code>-ComputerName</code>: Specifies the name of the remote computer.</li>
</ul>
</div><h2>Using a Session</h2>
<div class='content'><p>Once a session is created, you can use it to run commands on the remote computer. Use the <code>Invoke-Command</code> cmdlet with the <code>-Session</code> parameter.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSdW4gYSBjb21tYW5kIGluIHRoZSBlc3RhYmxpc2hlZCBzZXNzaW9uCkludm9rZS1Db21tYW5kIC1TZXNzaW9uICRzZXNzaW9uIC1TY3JpcHRCbG9jayB7IEdldC1Qcm9jZXNzIH0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Run a command in the established session
Invoke-Command -Session $session -ScriptBlock { Get-Process }</pre></div><div class='content'></div><h3>Explanation</h3>
<div class='content'><ul>
<li><code>Invoke-Command</code>: Cmdlet to run commands on a remote computer.</li>
<li><code>-Session</code>: Specifies the session to use.</li>
<li><code>-ScriptBlock</code>: Contains the commands to run on the remote computer.</li>
</ul>
</div><h2>Managing Sessions</h2>
<div class='content'></div><h3>Viewing Sessions</h3>
<div class='content'><p>To view all active sessions, use the <code>Get-PSSession</code> cmdlet.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBHZXQgYWxsIGFjdGl2ZSBzZXNzaW9ucwpHZXQtUFNTZXNzaW9u"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Get all active sessions
Get-PSSession</pre></div><div class='content'></div><h3>Disconnecting Sessions</h3>
<div class='content'><p>To disconnect a session without removing it, use the <code>Disconnect-PSSession</code> cmdlet.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEaXNjb25uZWN0IGEgc2Vzc2lvbgpEaXNjb25uZWN0LVBTU2Vzc2lvbiAtU2Vzc2lvbiAkc2Vzc2lvbg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Disconnect a session
Disconnect-PSSession -Session $session</pre></div><div class='content'></div><h3>Removing Sessions</h3>
<div class='content'><p>To remove a session, use the <code>Remove-PSSession</code> cmdlet.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSZW1vdmUgYSBzZXNzaW9uClJlbW92ZS1QU1Nlc3Npb24gLVNlc3Npb24gJHNlc3Npb24="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Remove a session
Remove-PSSession -Session $session</pre></div><div class='content'></div><h3>Explanation</h3>
<div class='content'><ul>
<li><code>Get-PSSession</code>: Lists all active sessions.</li>
<li><code>Disconnect-PSSession</code>: Disconnects a session but keeps it available for reconnection.</li>
<li><code>Remove-PSSession</code>: Removes a session, terminating the connection.</li>
</ul>
</div><h2>Session Options</h2>
<div class='content'><p>You can configure various options for sessions using the <code>New-PSSessionOption</code> cmdlet. For example, you can set the idle timeout for a session.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgc2Vzc2lvbiBvcHRpb25zIHdpdGggYSAzMC1taW51dGUgaWRsZSB0aW1lb3V0CiRzZXNzaW9uT3B0aW9ucyA9IE5ldy1QU1Nlc3Npb25PcHRpb24gLUlkbGVUaW1lb3V0ICgzMCAqIDYwICogMTAwMCkKCiMgQ3JlYXRlIGEgbmV3IHNlc3Npb24gd2l0aCB0aGUgc3BlY2lmaWVkIG9wdGlvbnMKJHNlc3Npb24gPSBOZXctUFNTZXNzaW9uIC1Db21wdXRlck5hbWUgIlJlbW90ZUNvbXB1dGVyTmFtZSIgLVNlc3Npb25PcHRpb24gJHNlc3Npb25PcHRpb25z"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create session options with a 30-minute idle timeout
$sessionOptions = New-PSSessionOption -IdleTimeout (30 * 60 * 1000)

# Create a new session with the specified options
$session = New-PSSession -ComputerName &quot;RemoteComputerName&quot; -SessionOption $sessionOptions</pre></div><div class='content'></div><h3>Explanation</h3>
<div class='content'><ul>
<li><code>New-PSSessionOption</code>: Cmdlet to create session options.</li>
<li><code>-IdleTimeout</code>: Specifies the idle timeout in milliseconds.</li>
</ul>
</div><h2>Practical Exercise</h2>
<div class='content'></div><h3>Exercise</h3>
<div class='content'><ol>
<li>Create a new session to a remote computer named &quot;Server01&quot;.</li>
<li>Run the <code>Get-Service</code> command in the session to list all services on the remote computer.</li>
<li>View all active sessions.</li>
<li>Disconnect the session.</li>
<li>Reconnect the session and run the <code>Get-EventLog -LogName System</code> command.</li>
<li>Remove the session.</li>
</ol>
</div><h3>Solution</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTdGVwIDE6IENyZWF0ZSBhIG5ldyBzZXNzaW9uCiRzZXNzaW9uID0gTmV3LVBTU2Vzc2lvbiAtQ29tcHV0ZXJOYW1lICJTZXJ2ZXIwMSIKCiMgU3RlcCAyOiBSdW4gR2V0LVNlcnZpY2UgaW4gdGhlIHNlc3Npb24KSW52b2tlLUNvbW1hbmQgLVNlc3Npb24gJHNlc3Npb24gLVNjcmlwdEJsb2NrIHsgR2V0LVNlcnZpY2UgfQoKIyBTdGVwIDM6IFZpZXcgYWxsIGFjdGl2ZSBzZXNzaW9ucwpHZXQtUFNTZXNzaW9uCgojIFN0ZXAgNDogRGlzY29ubmVjdCB0aGUgc2Vzc2lvbgpEaXNjb25uZWN0LVBTU2Vzc2lvbiAtU2Vzc2lvbiAkc2Vzc2lvbgoKIyBTdGVwIDU6IFJlY29ubmVjdCB0aGUgc2Vzc2lvbiBhbmQgcnVuIEdldC1FdmVudExvZwpDb25uZWN0LVBTU2Vzc2lvbiAtU2Vzc2lvbiAkc2Vzc2lvbgpJbnZva2UtQ29tbWFuZCAtU2Vzc2lvbiAkc2Vzc2lvbiAtU2NyaXB0QmxvY2sgeyBHZXQtRXZlbnRMb2cgLUxvZ05hbWUgU3lzdGVtIH0KCiMgU3RlcCA2OiBSZW1vdmUgdGhlIHNlc3Npb24KUmVtb3ZlLVBTU2Vzc2lvbiAtU2Vzc2lvbiAkc2Vzc2lvbg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Step 1: Create a new session
$session = New-PSSession -ComputerName &quot;Server01&quot;

# Step 2: Run Get-Service in the session
Invoke-Command -Session $session -ScriptBlock { Get-Service }

# Step 3: View all active sessions
Get-PSSession

# Step 4: Disconnect the session
Disconnect-PSSession -Session $session

# Step 5: Reconnect the session and run Get-EventLog
Connect-PSSession -Session $session
Invoke-Command -Session $session -ScriptBlock { Get-EventLog -LogName System }

# Step 6: Remove the session
Remove-PSSession -Session $session</pre></div><div class='content'></div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Mistake</strong>: Forgetting to remove sessions after use.
<ul>
<li><strong>Tip</strong>: Always clean up sessions to free up resources.</li>
</ul>
</li>
<li><strong>Mistake</strong>: Not specifying session options for long-running tasks.
<ul>
<li><strong>Tip</strong>: Configure session options to prevent timeouts during long operations.</li>
</ul>
</li>
</ul>
</div><h2>Conclusion</h2>
<div class='content'><p>In this section, we covered the basics of session management in PowerShell Remoting. You learned how to create, use, view, disconnect, and remove sessions, as well as how to configure session options. Proper session management is crucial for efficient and effective remote administration. In the next section, we will delve into security considerations for PowerShell Remoting.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-03-using-invoke-command' title="Using Invoke-Command" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-03-using-invoke-command' title="Using Invoke-Command" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='06-05-security-considerations' title="Security Considerations" class="py-2 px-3 btn btn-primary"
				data-read-mod="powershell" data-read-unit="6-4">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='06-05-security-considerations' title="Security Considerations" class="py-2 px-3 btn btn-primary" 
				data-read-mod="powershell" data-read-unit="6-4">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>PowerShell Course</h1>
<h2>Module 1: Introduction to PowerShell</h2>
<ul>
<li><a href="01-01-what-is-powershell">What is PowerShell?</a></li>
<li><a href="01-02-installing-setting-up">Installing and Setting Up PowerShell</a></li>
<li><a href="01-03-console-ise">PowerShell Console and ISE</a></li>
<li><a href="01-04-basic-commands-syntax">Basic Commands and Syntax</a></li>
<li><a href="01-05-help-system">Help System in PowerShell</a></li>
</ul>
<h2>Module 2: Basic Scripting</h2>
<ul>
<li><a href="02-01-variables-data-types">Variables and Data Types</a></li>
<li><a href="02-02-operators">Operators in PowerShell</a></li>
<li><a href="02-03-conditional-statements">Conditional Statements</a></li>
<li><a href="02-04-loops">Loops in PowerShell</a></li>
<li><a href="02-05-functions-scripts">Functions and Scripts</a></li>
</ul>
<h2>Module 3: Working with Objects</h2>
<ul>
<li><a href="03-01-understanding-objects">Understanding Objects</a></li>
<li><a href="03-02-properties-methods">Object Properties and Methods</a></li>
<li><a href="03-03-pipelines-manipulation">Pipelines and Object Manipulation</a></li>
<li><a href="03-04-filtering-selecting">Filtering and Selecting Objects</a></li>
<li><a href="03-05-sorting-grouping">Sorting and Grouping Objects</a></li>
</ul>
<h2>Module 4: Advanced Scripting Techniques</h2>
<ul>
<li><a href="04-01-error-handling">Error Handling</a></li>
<li><a href="04-02-debugging-scripts">Debugging Scripts</a></li>
<li><a href="04-03-regular-expressions">Regular Expressions</a></li>
<li><a href="04-04-files-directories">Working with Files and Directories</a></li>
<li><a href="04-05-modules-snap-ins">Using Modules and Snap-ins</a></li>
</ul>
<h2>Module 5: Automation and Task Scheduling</h2>
<ul>
<li><a href="05-01-introduction-automation">Introduction to Automation</a></li>
<li><a href="05-02-creating-scheduled-tasks">Creating Scheduled Tasks</a></li>
<li><a href="05-03-system-administration">Using PowerShell for System Administration</a></li>
<li><a href="05-04-automating-active-directory">Automating Active Directory Tasks</a></li>
<li><a href="05-05-automating-network-tasks">Automating Network Tasks</a></li>
</ul>
<h2>Module 6: PowerShell Remoting</h2>
<ul>
<li><a href="06-01-introduction-remoting">Introduction to Remoting</a></li>
<li><a href="06-02-setting-up-remoting">Setting Up Remoting</a></li>
<li><a href="06-03-using-invoke-command">Using Invoke-Command</a></li>
<li><a href="06-04-session-management">Session Management</a></li>
<li><a href="06-05-security-considerations">Security Considerations</a></li>
</ul>
<h2>Module 7: Advanced PowerShell Features</h2>
<ul>
<li><a href="07-01-powershell-profiles">PowerShell Profiles</a></li>
<li><a href="07-02-customizing-environment">Customizing the PowerShell Environment</a></li>
<li><a href="07-03-creating-using-classes">Creating and Using Classes</a></li>
<li><a href="07-04-working-xml-json">Working with XML and JSON</a></li>
<li><a href="07-05-using-rest-apis">Using PowerShell with REST APIs</a></li>
</ul>
<h2>Module 8: PowerShell and DevOps</h2>
<ul>
<li><a href="08-01-introduction-devops">Introduction to DevOps</a></li>
<li><a href="08-02-using-ci-cd-pipelines">Using PowerShell with CI/CD Pipelines</a></li>
<li><a href="08-03-infrastructure-as-code">Infrastructure as Code (IaC)</a></li>
<li><a href="08-04-managing-cloud-resources">Managing Cloud Resources with PowerShell</a></li>
<li><a href="08-05-powershell-docker">PowerShell and Docker</a></li>
</ul>
<h2>Module 9: Best Practices and Advanced Tips</h2>
<ul>
<li><a href="09-01-readable-maintainable-code">Writing Readable and Maintainable Code</a></li>
<li><a href="09-02-performance-optimization">Performance Optimization</a></li>
<li><a href="09-03-security-best-practices">Security Best Practices</a></li>
<li><a href="09-04-version-control-git">Version Control with Git</a></li>
<li><a href="09-05-community-resources">Community Resources and Further Learning</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
