<!DOCTYPE html>
<html lang="en">
<head>
    <title> Creating Scheduled Tasks </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/powershell/05-02-creating-scheduled-tasks" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/powershell/05-02-creating-scheduled-tasks" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/powershell/05-02-creating-scheduled-tasks" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "languages";
  		var MOD_NAME = "powershell";
  		var TEMA_NAME = "5-2";
  		var TYPE = "mod";
  		var PATH = "mod/powershell/05-02-creating-scheduled-tasks";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.e0e4cfcd99.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/powershell/05-02-creating-scheduled-tasks" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/powershell/05-02-creating-scheduled-tasks" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="powershell">
		<a  href="#" class="text-secondary d-none" data-read-mod="powershell" data-read-unit="5-2" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="powershell" data-unread-unit="5-2" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='05-01-introduction-automation' title="Introduction to Automation" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='05-01-introduction-automation' title="Introduction to Automation" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Creating Scheduled Tasks</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='05-03-system-administration' title="Using PowerShell for System Administration" class="py-2 px-3 btn btn-primary"
				data-read-mod="powershell" data-read-unit="5-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='05-03-system-administration' title="Using PowerShell for System Administration" class="py-2 px-3 btn btn-primary" 
				data-read-mod="powershell" data-read-unit="5-2">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to create and manage scheduled tasks using PowerShell. Scheduled tasks allow you to automate repetitive tasks, ensuring they run at specified times without manual intervention. This is particularly useful for system maintenance, backups, and other routine operations.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ol>
<li><strong>Task Scheduler</strong>: A Windows feature that allows you to schedule the launch of programs or scripts at predefined times or intervals.</li>
<li><strong>Scheduled Task Cmdlets</strong>: PowerShell provides a set of cmdlets specifically for creating, managing, and running scheduled tasks.</li>
</ol>
</div><h2>Prerequisites</h2>
<div class='content'><ul>
<li>Basic understanding of PowerShell commands and syntax.</li>
<li>Administrative privileges on the system where you are creating the scheduled tasks.</li>
</ul>
</div><h2>Cmdlets for Scheduled Tasks</h2>
<div class='content'><p>Here are some of the key cmdlets used for managing scheduled tasks:</p>
<table>
<thead>
<tr>
<th>Cmdlet</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>New-ScheduledTaskTrigger</code></td>
<td>Creates a new trigger for a scheduled task.</td>
</tr>
<tr>
<td><code>New-ScheduledTaskAction</code></td>
<td>Defines the action that the scheduled task will perform.</td>
</tr>
<tr>
<td><code>New-ScheduledTaskPrincipal</code></td>
<td>Specifies the user account under which the task runs.</td>
</tr>
<tr>
<td><code>Register-ScheduledTask</code></td>
<td>Registers a new scheduled task in the Task Scheduler.</td>
</tr>
<tr>
<td><code>Get-ScheduledTask</code></td>
<td>Retrieves the definition of a scheduled task.</td>
</tr>
<tr>
<td><code>Unregister-ScheduledTask</code></td>
<td>Deletes a scheduled task.</td>
</tr>
</tbody>
</table>
</div><h2>Creating a Simple Scheduled Task</h2>
<div class='content'><p>Let's create a simple scheduled task that runs a PowerShell script every day at a specific time.</p>
</div><h3>Step-by-Step Example</h3>
<div class='content'><ol>
<li>
<p><strong>Define the Trigger</strong>: The trigger specifies when the task will run.</p>
<pre><code class="language-powershell">$trigger = New-ScheduledTaskTrigger -Daily -At 3AM
</code></pre>
</li>
<li>
<p><strong>Define the Action</strong>: The action specifies what the task will do. In this case, it will run a PowerShell script.</p>
<pre><code class="language-powershell">$action = New-ScheduledTaskAction -Execute &quot;PowerShell.exe&quot; -Argument &quot;C:\Scripts\Backup.ps1&quot;
</code></pre>
</li>
<li>
<p><strong>Define the Principal</strong>: The principal specifies the user account under which the task will run.</p>
<pre><code class="language-powershell">$principal = New-ScheduledTaskPrincipal -UserId &quot;SYSTEM&quot; -LogonType ServiceAccount
</code></pre>
</li>
<li>
<p><strong>Register the Task</strong>: Finally, register the task with the Task Scheduler.</p>
<pre><code class="language-powershell">Register-ScheduledTask -TaskName &quot;DailyBackup&quot; -Trigger $trigger -Action $action -Principal $principal -Description &quot;Daily backup task&quot;
</code></pre>
</li>
</ol>
</div><h3>Full Script</h3>
<div class='content'><p>Here is the complete script to create the scheduled task:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEZWZpbmUgdGhlIHRyaWdnZXIKJHRyaWdnZXIgPSBOZXctU2NoZWR1bGVkVGFza1RyaWdnZXIgLURhaWx5IC1BdCAzQU0KCiMgRGVmaW5lIHRoZSBhY3Rpb24KJGFjdGlvbiA9IE5ldy1TY2hlZHVsZWRUYXNrQWN0aW9uIC1FeGVjdXRlICJQb3dlclNoZWxsLmV4ZSIgLUFyZ3VtZW50ICJDOlxTY3JpcHRzXEJhY2t1cC5wczEiCgojIERlZmluZSB0aGUgcHJpbmNpcGFsCiRwcmluY2lwYWwgPSBOZXctU2NoZWR1bGVkVGFza1ByaW5jaXBhbCAtVXNlcklkICJTWVNURU0iIC1Mb2dvblR5cGUgU2VydmljZUFjY291bnQKCiMgUmVnaXN0ZXIgdGhlIHRhc2sKUmVnaXN0ZXItU2NoZWR1bGVkVGFzayAtVGFza05hbWUgIkRhaWx5QmFja3VwIiAtVHJpZ2dlciAkdHJpZ2dlciAtQWN0aW9uICRhY3Rpb24gLVByaW5jaXBhbCAkcHJpbmNpcGFsIC1EZXNjcmlwdGlvbiAiRGFpbHkgYmFja3VwIHRhc2si"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Define the trigger
$trigger = New-ScheduledTaskTrigger -Daily -At 3AM

# Define the action
$action = New-ScheduledTaskAction -Execute &quot;PowerShell.exe&quot; -Argument &quot;C:\Scripts\Backup.ps1&quot;

# Define the principal
$principal = New-ScheduledTaskPrincipal -UserId &quot;SYSTEM&quot; -LogonType ServiceAccount

# Register the task
Register-ScheduledTask -TaskName &quot;DailyBackup&quot; -Trigger $trigger -Action $action -Principal $principal -Description &quot;Daily backup task&quot;</pre></div><div class='content'></div><h2>Practical Exercise</h2>
<div class='content'></div><h3>Exercise 1: Create a Scheduled Task</h3>
<div class='content'><p><strong>Objective</strong>: Create a scheduled task that runs a PowerShell script every Monday at 2 PM.</p>
<ol>
<li>
<p><strong>Define the Trigger</strong>:</p>
<pre><code class="language-powershell">$trigger = New-ScheduledTaskTrigger -Weekly -DaysOfWeek Monday -At 2PM
</code></pre>
</li>
<li>
<p><strong>Define the Action</strong>:</p>
<pre><code class="language-powershell">$action = New-ScheduledTaskAction -Execute &quot;PowerShell.exe&quot; -Argument &quot;C:\Scripts\WeeklyReport.ps1&quot;
</code></pre>
</li>
<li>
<p><strong>Define the Principal</strong>:</p>
<pre><code class="language-powershell">$principal = New-ScheduledTaskPrincipal -UserId &quot;SYSTEM&quot; -LogonType ServiceAccount
</code></pre>
</li>
<li>
<p><strong>Register the Task</strong>:</p>
<pre><code class="language-powershell">Register-ScheduledTask -TaskName &quot;WeeklyReport&quot; -Trigger $trigger -Action $action -Principal $principal -Description &quot;Weekly report generation task&quot;
</code></pre>
</li>
</ol>
</div><h3>Solution</h3>
<div class='content'><p>Here is the complete script for the exercise:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEZWZpbmUgdGhlIHRyaWdnZXIKJHRyaWdnZXIgPSBOZXctU2NoZWR1bGVkVGFza1RyaWdnZXIgLVdlZWtseSAtRGF5c09mV2VlayBNb25kYXkgLUF0IDJQTQoKIyBEZWZpbmUgdGhlIGFjdGlvbgokYWN0aW9uID0gTmV3LVNjaGVkdWxlZFRhc2tBY3Rpb24gLUV4ZWN1dGUgIlBvd2VyU2hlbGwuZXhlIiAtQXJndW1lbnQgIkM6XFNjcmlwdHNcV2Vla2x5UmVwb3J0LnBzMSIKCiMgRGVmaW5lIHRoZSBwcmluY2lwYWwKJHByaW5jaXBhbCA9IE5ldy1TY2hlZHVsZWRUYXNrUHJpbmNpcGFsIC1Vc2VySWQgIlNZU1RFTSIgLUxvZ29uVHlwZSBTZXJ2aWNlQWNjb3VudAoKIyBSZWdpc3RlciB0aGUgdGFzawpSZWdpc3Rlci1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiV2Vla2x5UmVwb3J0IiAtVHJpZ2dlciAkdHJpZ2dlciAtQWN0aW9uICRhY3Rpb24gLVByaW5jaXBhbCAkcHJpbmNpcGFsIC1EZXNjcmlwdGlvbiAiV2Vla2x5IHJlcG9ydCBnZW5lcmF0aW9uIHRhc2si"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Define the trigger
$trigger = New-ScheduledTaskTrigger -Weekly -DaysOfWeek Monday -At 2PM

# Define the action
$action = New-ScheduledTaskAction -Execute &quot;PowerShell.exe&quot; -Argument &quot;C:\Scripts\WeeklyReport.ps1&quot;

# Define the principal
$principal = New-ScheduledTaskPrincipal -UserId &quot;SYSTEM&quot; -LogonType ServiceAccount

# Register the task
Register-ScheduledTask -TaskName &quot;WeeklyReport&quot; -Trigger $trigger -Action $action -Principal $principal -Description &quot;Weekly report generation task&quot;</pre></div><div class='content'></div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Incorrect Paths</strong>: Ensure that the path to the script is correct and accessible by the user account under which the task runs.</li>
<li><strong>Permissions</strong>: Make sure the user account has the necessary permissions to execute the script and access any resources it needs.</li>
<li><strong>Testing</strong>: Test the script manually before scheduling it to ensure it works as expected.</li>
</ul>
</div><h2>Conclusion</h2>
<div class='content'><p>In this section, we learned how to create and manage scheduled tasks using PowerShell. We covered the key cmdlets, provided a step-by-step example, and included a practical exercise to reinforce the concepts. Scheduled tasks are a powerful tool for automating routine tasks, and mastering them can significantly enhance your productivity and system management capabilities.</p>
<p>Next, we will explore how to use PowerShell for system administration tasks in the following section.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='05-01-introduction-automation' title="Introduction to Automation" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='05-01-introduction-automation' title="Introduction to Automation" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='05-03-system-administration' title="Using PowerShell for System Administration" class="py-2 px-3 btn btn-primary"
				data-read-mod="powershell" data-read-unit="5-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='05-03-system-administration' title="Using PowerShell for System Administration" class="py-2 px-3 btn btn-primary" 
				data-read-mod="powershell" data-read-unit="5-2">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>PowerShell Course</h1>
<h2>Module 1: Introduction to PowerShell</h2>
<ul>
<li><a href="01-01-what-is-powershell">What is PowerShell?</a></li>
<li><a href="01-02-installing-setting-up">Installing and Setting Up PowerShell</a></li>
<li><a href="01-03-console-ise">PowerShell Console and ISE</a></li>
<li><a href="01-04-basic-commands-syntax">Basic Commands and Syntax</a></li>
<li><a href="01-05-help-system">Help System in PowerShell</a></li>
</ul>
<h2>Module 2: Basic Scripting</h2>
<ul>
<li><a href="02-01-variables-data-types">Variables and Data Types</a></li>
<li><a href="02-02-operators">Operators in PowerShell</a></li>
<li><a href="02-03-conditional-statements">Conditional Statements</a></li>
<li><a href="02-04-loops">Loops in PowerShell</a></li>
<li><a href="02-05-functions-scripts">Functions and Scripts</a></li>
</ul>
<h2>Module 3: Working with Objects</h2>
<ul>
<li><a href="03-01-understanding-objects">Understanding Objects</a></li>
<li><a href="03-02-properties-methods">Object Properties and Methods</a></li>
<li><a href="03-03-pipelines-manipulation">Pipelines and Object Manipulation</a></li>
<li><a href="03-04-filtering-selecting">Filtering and Selecting Objects</a></li>
<li><a href="03-05-sorting-grouping">Sorting and Grouping Objects</a></li>
</ul>
<h2>Module 4: Advanced Scripting Techniques</h2>
<ul>
<li><a href="04-01-error-handling">Error Handling</a></li>
<li><a href="04-02-debugging-scripts">Debugging Scripts</a></li>
<li><a href="04-03-regular-expressions">Regular Expressions</a></li>
<li><a href="04-04-files-directories">Working with Files and Directories</a></li>
<li><a href="04-05-modules-snap-ins">Using Modules and Snap-ins</a></li>
</ul>
<h2>Module 5: Automation and Task Scheduling</h2>
<ul>
<li><a href="05-01-introduction-automation">Introduction to Automation</a></li>
<li><a href="05-02-creating-scheduled-tasks">Creating Scheduled Tasks</a></li>
<li><a href="05-03-system-administration">Using PowerShell for System Administration</a></li>
<li><a href="05-04-automating-active-directory">Automating Active Directory Tasks</a></li>
<li><a href="05-05-automating-network-tasks">Automating Network Tasks</a></li>
</ul>
<h2>Module 6: PowerShell Remoting</h2>
<ul>
<li><a href="06-01-introduction-remoting">Introduction to Remoting</a></li>
<li><a href="06-02-setting-up-remoting">Setting Up Remoting</a></li>
<li><a href="06-03-using-invoke-command">Using Invoke-Command</a></li>
<li><a href="06-04-session-management">Session Management</a></li>
<li><a href="06-05-security-considerations">Security Considerations</a></li>
</ul>
<h2>Module 7: Advanced PowerShell Features</h2>
<ul>
<li><a href="07-01-powershell-profiles">PowerShell Profiles</a></li>
<li><a href="07-02-customizing-environment">Customizing the PowerShell Environment</a></li>
<li><a href="07-03-creating-using-classes">Creating and Using Classes</a></li>
<li><a href="07-04-working-xml-json">Working with XML and JSON</a></li>
<li><a href="07-05-using-rest-apis">Using PowerShell with REST APIs</a></li>
</ul>
<h2>Module 8: PowerShell and DevOps</h2>
<ul>
<li><a href="08-01-introduction-devops">Introduction to DevOps</a></li>
<li><a href="08-02-using-ci-cd-pipelines">Using PowerShell with CI/CD Pipelines</a></li>
<li><a href="08-03-infrastructure-as-code">Infrastructure as Code (IaC)</a></li>
<li><a href="08-04-managing-cloud-resources">Managing Cloud Resources with PowerShell</a></li>
<li><a href="08-05-powershell-docker">PowerShell and Docker</a></li>
</ul>
<h2>Module 9: Best Practices and Advanced Tips</h2>
<ul>
<li><a href="09-01-readable-maintainable-code">Writing Readable and Maintainable Code</a></li>
<li><a href="09-02-performance-optimization">Performance Optimization</a></li>
<li><a href="09-03-security-best-practices">Security Best Practices</a></li>
<li><a href="09-04-version-control-git">Version Control with Git</a></li>
<li><a href="09-05-community-resources">Community Resources and Further Learning</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
