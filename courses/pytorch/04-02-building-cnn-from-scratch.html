<!DOCTYPE html>
<html lang="en">
<head>
    <title> Building a CNN from Scratch </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/pytorch/04-02-building-cnn-from-scratch" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/pytorch/04-02-building-cnn-from-scratch" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/pytorch/04-02-building-cnn-from-scratch" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "pytorch";
  		var TEMA_NAME = "4-2";
  		var TYPE = "mod";
  		var PATH = "mod/pytorch/04-02-building-cnn-from-scratch";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.688defeeef.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/pytorch/04-02-building-cnn-from-scratch" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/pytorch/04-02-building-cnn-from-scratch" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="pytorch">
		<a  href="#" class="text-secondary d-none" data-read-mod="pytorch" data-read-unit="4-2" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="pytorch" data-unread-unit="4-2" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='04-01-introduction-to-cnns' title="Introduction to CNNs" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='04-01-introduction-to-cnns' title="Introduction to CNNs" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Building a CNN from Scratch</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='04-03-transfer-learning' title="Transfer Learning with Pre-trained Models" class="py-2 px-3 btn btn-primary"
				data-read-mod="pytorch" data-read-unit="4-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='04-03-transfer-learning' title="Transfer Learning with Pre-trained Models" class="py-2 px-3 btn btn-primary" 
				data-read-mod="pytorch" data-read-unit="4-2">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will learn how to build a Convolutional Neural Network (CNN) from scratch using PyTorch. CNNs are particularly effective for image recognition tasks due to their ability to capture spatial hierarchies in images.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ol>
<li><strong>Convolutional Layers</strong>: These layers apply convolution operations to the input, which helps in detecting features such as edges, textures, and patterns.</li>
<li><strong>Pooling Layers</strong>: These layers reduce the spatial dimensions of the input, which helps in reducing the computational load and controlling overfitting.</li>
<li><strong>Fully Connected Layers</strong>: These layers are used at the end of the network to make predictions based on the features extracted by the convolutional and pooling layers.</li>
<li><strong>Activation Functions</strong>: Functions like ReLU (Rectified Linear Unit) introduce non-linearity into the model, enabling it to learn complex patterns.</li>
</ol>
</div><h2>Step-by-Step Guide</h2>
<div class='content'></div><h3>Step 1: Import Libraries</h3>
<div class='content'><p>First, we need to import the necessary libraries.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubiBhcyBubgppbXBvcnQgdG9yY2gub3B0aW0gYXMgb3B0aW0KaW1wb3J0IHRvcmNoLm5uLmZ1bmN0aW9uYWwgYXMgRgpmcm9tIHRvcmNodmlzaW9uIGltcG9ydCBkYXRhc2V0cywgdHJhbnNmb3Jtcw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch
import torch.nn as nn
import torch.optim as optim
import torch.nn.functional as F
from torchvision import datasets, transforms</pre></div><div class='content'></div><h3>Step 2: Define the CNN Architecture</h3>
<div class='content'><p>We will define a simple CNN with the following architecture:</p>
<ul>
<li>Two convolutional layers</li>
<li>Two pooling layers</li>
<li>Two fully connected layers</li>
</ul>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgU2ltcGxlQ05OKG5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoU2ltcGxlQ05OLCBzZWxmKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5jb252MSA9IG5uLkNvbnYyZChpbl9jaGFubmVscz0xLCBvdXRfY2hhbm5lbHM9MzIsIGtlcm5lbF9zaXplPTMsIHN0cmlkZT0xLCBwYWRkaW5nPTEpCiAgICAgICAgc2VsZi5wb29sID0gbm4uTWF4UG9vbDJkKGtlcm5lbF9zaXplPTIsIHN0cmlkZT0yLCBwYWRkaW5nPTApCiAgICAgICAgc2VsZi5jb252MiA9IG5uLkNvbnYyZChpbl9jaGFubmVscz0zMiwgb3V0X2NoYW5uZWxzPTY0LCBrZXJuZWxfc2l6ZT0zLCBzdHJpZGU9MSwgcGFkZGluZz0xKQogICAgICAgIHNlbGYuZmMxID0gbm4uTGluZWFyKDY0ICogNyAqIDcsIDEyOCkKICAgICAgICBzZWxmLmZjMiA9IG5uLkxpbmVhcigxMjgsIDEwKQogICAgCiAgICBkZWYgZm9yd2FyZChzZWxmLCB4KToKICAgICAgICB4ID0gc2VsZi5wb29sKEYucmVsdShzZWxmLmNvbnYxKHgpKSkKICAgICAgICB4ID0gc2VsZi5wb29sKEYucmVsdShzZWxmLmNvbnYyKHgpKSkKICAgICAgICB4ID0geC52aWV3KC0xLCA2NCAqIDcgKiA3KSAgIyBGbGF0dGVuIHRoZSB0ZW5zb3IKICAgICAgICB4ID0gRi5yZWx1KHNlbGYuZmMxKHgpKQogICAgICAgIHggPSBzZWxmLmZjMih4KQogICAgICAgIHJldHVybiB4"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class SimpleCNN(nn.Module):
    def __init__(self):
        super(SimpleCNN, self).__init__()
        self.conv1 = nn.Conv2d(in_channels=1, out_channels=32, kernel_size=3, stride=1, padding=1)
        self.pool = nn.MaxPool2d(kernel_size=2, stride=2, padding=0)
        self.conv2 = nn.Conv2d(in_channels=32, out_channels=64, kernel_size=3, stride=1, padding=1)
        self.fc1 = nn.Linear(64 * 7 * 7, 128)
        self.fc2 = nn.Linear(128, 10)
    
    def forward(self, x):
        x = self.pool(F.relu(self.conv1(x)))
        x = self.pool(F.relu(self.conv2(x)))
        x = x.view(-1, 64 * 7 * 7)  # Flatten the tensor
        x = F.relu(self.fc1(x))
        x = self.fc2(x)
        return x</pre></div><div class='content'></div><h3>Step 3: Load and Preprocess Data</h3>
<div class='content'><p>We will use the MNIST dataset for this example. The dataset will be downloaded and transformed into tensors.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJhbnNmb3JtID0gdHJhbnNmb3Jtcy5Db21wb3NlKFsKICAgIHRyYW5zZm9ybXMuVG9UZW5zb3IoKSwKICAgIHRyYW5zZm9ybXMuTm9ybWFsaXplKCgwLjEzMDcsKSwgKDAuMzA4MSwpKQpdKQoKdHJhaW5fZGF0YXNldCA9IGRhdGFzZXRzLk1OSVNUKHJvb3Q9Jy4vZGF0YScsIHRyYWluPVRydWUsIGRvd25sb2FkPVRydWUsIHRyYW5zZm9ybT10cmFuc2Zvcm0pCnRlc3RfZGF0YXNldCA9IGRhdGFzZXRzLk1OSVNUKHJvb3Q9Jy4vZGF0YScsIHRyYWluPUZhbHNlLCBkb3dubG9hZD1UcnVlLCB0cmFuc2Zvcm09dHJhbnNmb3JtKQoKdHJhaW5fbG9hZGVyID0gdG9yY2gudXRpbHMuZGF0YS5EYXRhTG9hZGVyKGRhdGFzZXQ9dHJhaW5fZGF0YXNldCwgYmF0Y2hfc2l6ZT02NCwgc2h1ZmZsZT1UcnVlKQp0ZXN0X2xvYWRlciA9IHRvcmNoLnV0aWxzLmRhdGEuRGF0YUxvYWRlcihkYXRhc2V0PXRlc3RfZGF0YXNldCwgYmF0Y2hfc2l6ZT0xMDAwLCBzaHVmZmxlPUZhbHNlKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>transform = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize((0.1307,), (0.3081,))
])

train_dataset = datasets.MNIST(root='./data', train=True, download=True, transform=transform)
test_dataset = datasets.MNIST(root='./data', train=False, download=True, transform=transform)

train_loader = torch.utils.data.DataLoader(dataset=train_dataset, batch_size=64, shuffle=True)
test_loader = torch.utils.data.DataLoader(dataset=test_dataset, batch_size=1000, shuffle=False)</pre></div><div class='content'></div><h3>Step 4: Define Loss Function and Optimizer</h3>
<div class='content'><p>We will use Cross-Entropy Loss and the Adam optimizer.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwgPSBTaW1wbGVDTk4oKQpjcml0ZXJpb24gPSBubi5Dcm9zc0VudHJvcHlMb3NzKCkKb3B0aW1pemVyID0gb3B0aW0uQWRhbShtb2RlbC5wYXJhbWV0ZXJzKCksIGxyPTAuMDAxKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model = SimpleCNN()
criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=0.001)</pre></div><div class='content'></div><h3>Step 5: Train the Model</h3>
<div class='content'><p>We will train the model for a few epochs and print the loss for each epoch.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnVtX2Vwb2NocyA9IDUKCmZvciBlcG9jaCBpbiByYW5nZShudW1fZXBvY2hzKToKICAgIG1vZGVsLnRyYWluKCkKICAgIHJ1bm5pbmdfbG9zcyA9IDAuMAogICAgZm9yIGltYWdlcywgbGFiZWxzIGluIHRyYWluX2xvYWRlcjoKICAgICAgICBvcHRpbWl6ZXIuemVyb19ncmFkKCkKICAgICAgICBvdXRwdXRzID0gbW9kZWwoaW1hZ2VzKQogICAgICAgIGxvc3MgPSBjcml0ZXJpb24ob3V0cHV0cywgbGFiZWxzKQogICAgICAgIGxvc3MuYmFja3dhcmQoKQogICAgICAgIG9wdGltaXplci5zdGVwKCkKICAgICAgICBydW5uaW5nX2xvc3MgKz0gbG9zcy5pdGVtKCkKICAgIAogICAgcHJpbnQoZidFcG9jaCBbe2Vwb2NoKzF9L3tudW1fZXBvY2hzfV0sIExvc3M6IHtydW5uaW5nX2xvc3MvbGVuKHRyYWluX2xvYWRlcik6LjRmfScp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>num_epochs = 5

for epoch in range(num_epochs):
    model.train()
    running_loss = 0.0
    for images, labels in train_loader:
        optimizer.zero_grad()
        outputs = model(images)
        loss = criterion(outputs, labels)
        loss.backward()
        optimizer.step()
        running_loss += loss.item()
    
    print(f'Epoch [{epoch+1}/{num_epochs}], Loss: {running_loss/len(train_loader):.4f}')</pre></div><div class='content'></div><h3>Step 6: Evaluate the Model</h3>
<div class='content'><p>We will evaluate the model on the test dataset to check its performance.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwuZXZhbCgpCmNvcnJlY3QgPSAwCnRvdGFsID0gMAp3aXRoIHRvcmNoLm5vX2dyYWQoKToKICAgIGZvciBpbWFnZXMsIGxhYmVscyBpbiB0ZXN0X2xvYWRlcjoKICAgICAgICBvdXRwdXRzID0gbW9kZWwoaW1hZ2VzKQogICAgICAgIF8sIHByZWRpY3RlZCA9IHRvcmNoLm1heChvdXRwdXRzLmRhdGEsIDEpCiAgICAgICAgdG90YWwgKz0gbGFiZWxzLnNpemUoMCkKICAgICAgICBjb3JyZWN0ICs9IChwcmVkaWN0ZWQgPT0gbGFiZWxzKS5zdW0oKS5pdGVtKCkKCnByaW50KGYnQWNjdXJhY3kgb2YgdGhlIG1vZGVsIG9uIHRoZSB0ZXN0IGltYWdlczogezEwMCAqIGNvcnJlY3QgLyB0b3RhbDouMmZ9JScp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model.eval()
correct = 0
total = 0
with torch.no_grad():
    for images, labels in test_loader:
        outputs = model(images)
        _, predicted = torch.max(outputs.data, 1)
        total += labels.size(0)
        correct += (predicted == labels).sum().item()

print(f'Accuracy of the model on the test images: {100 * correct / total:.2f}%')</pre></div><div class='content'></div><h2>Practical Exercises</h2>
<div class='content'></div><h3>Exercise 1: Modify the CNN Architecture</h3>
<div class='content'><p>Modify the <code>SimpleCNN</code> class to include an additional convolutional layer and observe how it affects the model's performance.</p>
</div><h3>Solution</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgTW9kaWZpZWRDTk4obm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcihNb2RpZmllZENOTiwgc2VsZikuX19pbml0X18oKQogICAgICAgIHNlbGYuY29udjEgPSBubi5Db252MmQoaW5fY2hhbm5lbHM9MSwgb3V0X2NoYW5uZWxzPTMyLCBrZXJuZWxfc2l6ZT0zLCBzdHJpZGU9MSwgcGFkZGluZz0xKQogICAgICAgIHNlbGYucG9vbCA9IG5uLk1heFBvb2wyZChrZXJuZWxfc2l6ZT0yLCBzdHJpZGU9MiwgcGFkZGluZz0wKQogICAgICAgIHNlbGYuY29udjIgPSBubi5Db252MmQoaW5fY2hhbm5lbHM9MzIsIG91dF9jaGFubmVscz02NCwga2VybmVsX3NpemU9Mywgc3RyaWRlPTEsIHBhZGRpbmc9MSkKICAgICAgICBzZWxmLmNvbnYzID0gbm4uQ29udjJkKGluX2NoYW5uZWxzPTY0LCBvdXRfY2hhbm5lbHM9MTI4LCBrZXJuZWxfc2l6ZT0zLCBzdHJpZGU9MSwgcGFkZGluZz0xKQogICAgICAgIHNlbGYuZmMxID0gbm4uTGluZWFyKDEyOCAqIDMgKiAzLCAxMjgpCiAgICAgICAgc2VsZi5mYzIgPSBubi5MaW5lYXIoMTI4LCAxMCkKICAgIAogICAgZGVmIGZvcndhcmQoc2VsZiwgeCk6CiAgICAgICAgeCA9IHNlbGYucG9vbChGLnJlbHUoc2VsZi5jb252MSh4KSkpCiAgICAgICAgeCA9IHNlbGYucG9vbChGLnJlbHUoc2VsZi5jb252Mih4KSkpCiAgICAgICAgeCA9IHNlbGYucG9vbChGLnJlbHUoc2VsZi5jb252Myh4KSkpCiAgICAgICAgeCA9IHgudmlldygtMSwgMTI4ICogMyAqIDMpICAjIEZsYXR0ZW4gdGhlIHRlbnNvcgogICAgICAgIHggPSBGLnJlbHUoc2VsZi5mYzEoeCkpCiAgICAgICAgeCA9IHNlbGYuZmMyKHgpCiAgICAgICAgcmV0dXJuIHg="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class ModifiedCNN(nn.Module):
    def __init__(self):
        super(ModifiedCNN, self).__init__()
        self.conv1 = nn.Conv2d(in_channels=1, out_channels=32, kernel_size=3, stride=1, padding=1)
        self.pool = nn.MaxPool2d(kernel_size=2, stride=2, padding=0)
        self.conv2 = nn.Conv2d(in_channels=32, out_channels=64, kernel_size=3, stride=1, padding=1)
        self.conv3 = nn.Conv2d(in_channels=64, out_channels=128, kernel_size=3, stride=1, padding=1)
        self.fc1 = nn.Linear(128 * 3 * 3, 128)
        self.fc2 = nn.Linear(128, 10)
    
    def forward(self, x):
        x = self.pool(F.relu(self.conv1(x)))
        x = self.pool(F.relu(self.conv2(x)))
        x = self.pool(F.relu(self.conv3(x)))
        x = x.view(-1, 128 * 3 * 3)  # Flatten the tensor
        x = F.relu(self.fc1(x))
        x = self.fc2(x)
        return x</pre></div><div class='content'></div><h3>Exercise 2: Implement Dropout</h3>
<div class='content'><p>Add dropout layers to the <code>SimpleCNN</code> class to prevent overfitting and observe the changes in performance.</p>
</div><h3>Solution</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgRHJvcG91dENOTihubi5Nb2R1bGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHN1cGVyKERyb3BvdXRDTk4sIHNlbGYpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmNvbnYxID0gbm4uQ29udjJkKGluX2NoYW5uZWxzPTEsIG91dF9jaGFubmVscz0zMiwga2VybmVsX3NpemU9Mywgc3RyaWRlPTEsIHBhZGRpbmc9MSkKICAgICAgICBzZWxmLnBvb2wgPSBubi5NYXhQb29sMmQoa2VybmVsX3NpemU9Miwgc3RyaWRlPTIsIHBhZGRpbmc9MCkKICAgICAgICBzZWxmLmNvbnYyID0gbm4uQ29udjJkKGluX2NoYW5uZWxzPTMyLCBvdXRfY2hhbm5lbHM9NjQsIGtlcm5lbF9zaXplPTMsIHN0cmlkZT0xLCBwYWRkaW5nPTEpCiAgICAgICAgc2VsZi5mYzEgPSBubi5MaW5lYXIoNjQgKiA3ICogNywgMTI4KQogICAgICAgIHNlbGYuZmMyID0gbm4uTGluZWFyKDEyOCwgMTApCiAgICAgICAgc2VsZi5kcm9wb3V0ID0gbm4uRHJvcG91dCgwLjUpCiAgICAKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgpOgogICAgICAgIHggPSBzZWxmLnBvb2woRi5yZWx1KHNlbGYuY29udjEoeCkpKQogICAgICAgIHggPSBzZWxmLnBvb2woRi5yZWx1KHNlbGYuY29udjIoeCkpKQogICAgICAgIHggPSB4LnZpZXcoLTEsIDY0ICogNyAqIDcpICAjIEZsYXR0ZW4gdGhlIHRlbnNvcgogICAgICAgIHggPSBGLnJlbHUoc2VsZi5mYzEoeCkpCiAgICAgICAgeCA9IHNlbGYuZHJvcG91dCh4KQogICAgICAgIHggPSBzZWxmLmZjMih4KQogICAgICAgIHJldHVybiB4"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class DropoutCNN(nn.Module):
    def __init__(self):
        super(DropoutCNN, self).__init__()
        self.conv1 = nn.Conv2d(in_channels=1, out_channels=32, kernel_size=3, stride=1, padding=1)
        self.pool = nn.MaxPool2d(kernel_size=2, stride=2, padding=0)
        self.conv2 = nn.Conv2d(in_channels=32, out_channels=64, kernel_size=3, stride=1, padding=1)
        self.fc1 = nn.Linear(64 * 7 * 7, 128)
        self.fc2 = nn.Linear(128, 10)
        self.dropout = nn.Dropout(0.5)
    
    def forward(self, x):
        x = self.pool(F.relu(self.conv1(x)))
        x = self.pool(F.relu(self.conv2(x)))
        x = x.view(-1, 64 * 7 * 7)  # Flatten the tensor
        x = F.relu(self.fc1(x))
        x = self.dropout(x)
        x = self.fc2(x)
        return x</pre></div><div class='content'></div><h2>Conclusion</h2>
<div class='content'><p>In this section, we have learned how to build a simple CNN from scratch using PyTorch. We covered the key components of a CNN, including convolutional layers, pooling layers, and fully connected layers. We also walked through the process of loading and preprocessing data, defining the model architecture, training the model, and evaluating its performance. Finally, we provided practical exercises to reinforce the learned concepts.</p>
<p>In the next section, we will explore transfer learning with pre-trained models, which can significantly speed up the training process and improve performance on complex tasks.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='04-01-introduction-to-cnns' title="Introduction to CNNs" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='04-01-introduction-to-cnns' title="Introduction to CNNs" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='04-03-transfer-learning' title="Transfer Learning with Pre-trained Models" class="py-2 px-3 btn btn-primary"
				data-read-mod="pytorch" data-read-unit="4-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='04-03-transfer-learning' title="Transfer Learning with Pre-trained Models" class="py-2 px-3 btn btn-primary" 
				data-read-mod="pytorch" data-read-unit="4-2">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>PyTorch: From Beginner to Advanced</h1>
<h2>Module 1: Introduction to PyTorch</h2>
<ul>
<li><a href="01-01-what-is-pytorch">What is PyTorch?</a></li>
<li><a href="01-02-setting-up-environment">Setting Up the Environment</a></li>
<li><a href="01-03-basic-tensor-operations">Basic Tensor Operations</a></li>
<li><a href="01-04-autograd">Autograd: Automatic Differentiation</a></li>
</ul>
<h2>Module 2: Building Neural Networks</h2>
<ul>
<li><a href="02-01-introduction-to-neural-networks">Introduction to Neural Networks</a></li>
<li><a href="02-02-creating-simple-neural-network">Creating a Simple Neural Network</a></li>
<li><a href="02-03-activation-functions">Activation Functions</a></li>
<li><a href="02-04-loss-functions-optimization">Loss Functions and Optimization</a></li>
</ul>
<h2>Module 3: Training Neural Networks</h2>
<ul>
<li><a href="03-01-data-loading-preprocessing">Data Loading and Preprocessing</a></li>
<li><a href="03-02-training-loop">Training Loop</a></li>
<li><a href="03-03-validation-testing">Validation and Testing</a></li>
<li><a href="03-04-saving-loading-models">Saving and Loading Models</a></li>
</ul>
<h2>Module 4: Convolutional Neural Networks (CNNs)</h2>
<ul>
<li><a href="04-01-introduction-to-cnns">Introduction to CNNs</a></li>
<li><a href="04-02-building-cnn-from-scratch">Building a CNN from Scratch</a></li>
<li><a href="04-03-transfer-learning">Transfer Learning with Pre-trained Models</a></li>
<li><a href="04-04-fine-tuning-cnns">Fine-Tuning CNNs</a></li>
</ul>
<h2>Module 5: Recurrent Neural Networks (RNNs)</h2>
<ul>
<li><a href="05-01-introduction-to-rnns">Introduction to RNNs</a></li>
<li><a href="05-02-building-rnn-from-scratch">Building an RNN from Scratch</a></li>
<li><a href="05-03-lstm-networks">Long Short-Term Memory (LSTM) Networks</a></li>
<li><a href="05-04-gru-networks">Gated Recurrent Units (GRUs)</a></li>
</ul>
<h2>Module 6: Advanced Topics</h2>
<ul>
<li><a href="06-01-gans">Generative Adversarial Networks (GANs)</a></li>
<li><a href="06-02-reinforcement-learning">Reinforcement Learning with PyTorch</a></li>
<li><a href="06-03-deploying-models">Deploying PyTorch Models</a></li>
<li><a href="06-04-optimizing-performance">Optimizing Performance</a></li>
</ul>
<h2>Module 7: Case Studies and Projects</h2>
<ul>
<li><a href="07-01-image-classification-project">Image Classification Project</a></li>
<li><a href="07-02-nlp-project">Natural Language Processing Project</a></li>
<li><a href="07-03-time-series-forecasting-project">Time Series Forecasting Project</a></li>
<li><a href="07-04-custom-project">Custom Project</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
