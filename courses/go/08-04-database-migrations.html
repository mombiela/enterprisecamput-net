<!DOCTYPE html>
<html lang="en">
<head>
    <title> Database Migrations </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/go/08-04-database-migrations" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/go/08-04-database-migrations" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/go/08-04-database-migrations" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "languages";
  		var MOD_NAME = "go";
  		var TEMA_NAME = "8-4";
  		var TYPE = "mod";
  		var PATH = "mod/go/08-04-database-migrations";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/go/08-04-database-migrations" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/go/08-04-database-migrations" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="go">
		<a  href="#" class="text-secondary d-none" data-read-mod="go" data-read-unit="8-4" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="go" data-unread-unit="8-4" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='08-03-using-orm' title="Using ORM" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='08-03-using-orm' title="Using ORM" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Database Migrations</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='09-01-building-and-deploying-go-applications' title="Building and Deploying Go Applications" class="py-2 px-3 btn btn-primary"
				data-read-mod="go" data-read-unit="8-4">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='09-01-building-and-deploying-go-applications' title="Building and Deploying Go Applications" class="py-2 px-3 btn btn-primary" 
				data-read-mod="go" data-read-unit="8-4">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>Database migrations are a crucial aspect of managing and evolving your database schema over time. They allow you to apply incremental changes to your database structure in a controlled and consistent manner. In this section, we will cover the basics of database migrations, how to create and apply migrations in Go, and best practices for managing migrations.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ol>
<li><strong>Migration</strong>: A migration is a set of changes to the database schema, such as creating tables, adding columns, or modifying indexes.</li>
<li><strong>Migration Tool</strong>: A tool or library that helps you create, apply, and track migrations.</li>
<li><strong>Versioning</strong>: Keeping track of which migrations have been applied to the database to ensure consistency across different environments.</li>
</ol>
</div><h2>Setting Up a Migration Tool</h2>
<div class='content'><p>There are several migration tools available for Go, such as <code>golang-migrate</code>, <code>goose</code>, and <code>sql-migrate</code>. In this section, we will use <code>golang-migrate</code> as an example.</p>
</div><h3>Installing <code>golang-migrate</code></h3>
<div class='content'><p>First, install the <code>golang-migrate</code> CLI tool:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z28gaW5zdGFsbCAtdGFncyAncG9zdGdyZXMnIGdpdGh1Yi5jb20vZ29sYW5nLW1pZ3JhdGUvbWlncmF0ZS92NC9jbWQvbWlncmF0ZUBsYXRlc3Q="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>go install -tags 'postgres' github.com/golang-migrate/migrate/v4/cmd/migrate@latest</pre></div><div class='content'></div><h3>Creating a Migration</h3>
<div class='content'><p>To create a new migration, use the <code>migrate create</code> command:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWlncmF0ZSBjcmVhdGUgLWV4dCBzcWwgLWRpciBkYi9taWdyYXRpb25zIC1zZXEgY3JlYXRlX3VzZXJzX3RhYmxl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>migrate create -ext sql -dir db/migrations -seq create_users_table</pre></div><div class='content'><p>This command will generate two files in the <code>db/migrations</code> directory:</p>
<ul>
<li><code>000001_create_users_table.up.sql</code></li>
<li><code>000001_create_users_table.down.sql</code></li>
</ul>
</div><h3>Writing Migration Scripts</h3>
<div class='content'><p>Edit the <code>.up.sql</code> file to define the changes you want to apply:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gMDAwMDAxX2NyZWF0ZV91c2Vyc190YWJsZS51cC5zcWwKQ1JFQVRFIFRBQkxFIHVzZXJzICgKICAgIGlkIFNFUklBTCBQUklNQVJZIEtFWSwKICAgIHVzZXJuYW1lIFZBUkNIQVIoNTApIE5PVCBOVUxMLAogICAgZW1haWwgVkFSQ0hBUigxMDApIE5PVCBOVUxMIFVOSVFVRSwKICAgIGNyZWF0ZWRfYXQgVElNRVNUQU1QIE5PVCBOVUxMIERFRkFVTFQgTk9XKCkKKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- 000001_create_users_table.up.sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    username VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL UNIQUE,
    created_at TIMESTAMP NOT NULL DEFAULT NOW()
);</pre></div><div class='content'><p>Edit the <code>.down.sql</code> file to define how to revert the changes:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gMDAwMDAxX2NyZWF0ZV91c2Vyc190YWJsZS5kb3duLnNxbApEUk9QIFRBQkxFIHVzZXJzOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- 000001_create_users_table.down.sql
DROP TABLE users;</pre></div><div class='content'></div><h3>Applying Migrations</h3>
<div class='content'><p>To apply the migrations, use the <code>migrate up</code> command:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWlncmF0ZSAtcGF0aCBkYi9taWdyYXRpb25zIC1kYXRhYmFzZSBwb3N0Z3JlczovL3VzZXI6cGFzc3dvcmRAbG9jYWxob3N0OjU0MzIvZGJuYW1lP3NzbG1vZGU9ZGlzYWJsZSB1cA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>migrate -path db/migrations -database postgres://user:password@localhost:5432/dbname?sslmode=disable up</pre></div><div class='content'><p>To roll back the last migration, use the <code>migrate down</code> command:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWlncmF0ZSAtcGF0aCBkYi9taWdyYXRpb25zIC1kYXRhYmFzZSBwb3N0Z3JlczovL3VzZXI6cGFzc3dvcmRAbG9jYWxob3N0OjU0MzIvZGJuYW1lP3NzbG1vZGU9ZGlzYWJsZSBkb3du"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>migrate -path db/migrations -database postgres://user:password@localhost:5432/dbname?sslmode=disable down</pre></div><div class='content'></div><h2>Practical Example</h2>
<div class='content'><p>Let's walk through a practical example of creating and applying a migration.</p>
</div><h3>Step 1: Create a Migration</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWlncmF0ZSBjcmVhdGUgLWV4dCBzcWwgLWRpciBkYi9taWdyYXRpb25zIC1zZXEgYWRkX2FnZV90b191c2Vycw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>migrate create -ext sql -dir db/migrations -seq add_age_to_users</pre></div><div class='content'></div><h3>Step 2: Edit the Migration Files</h3>
<div class='content'><p><strong><code>000002_add_age_to_users.up.sql</code></strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QUxURVIgVEFCTEUgdXNlcnMgQUREIENPTFVNTiBhZ2UgSU5UOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ALTER TABLE users ADD COLUMN age INT;</pre></div><div class='content'><p><strong><code>000002_add_age_to_users.down.sql</code></strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QUxURVIgVEFCTEUgdXNlcnMgRFJPUCBDT0xVTU4gYWdlOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ALTER TABLE users DROP COLUMN age;</pre></div><div class='content'></div><h3>Step 3: Apply the Migration</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWlncmF0ZSAtcGF0aCBkYi9taWdyYXRpb25zIC1kYXRhYmFzZSBwb3N0Z3JlczovL3VzZXI6cGFzc3dvcmRAbG9jYWxob3N0OjU0MzIvZGJuYW1lP3NzbG1vZGU9ZGlzYWJsZSB1cA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>migrate -path db/migrations -database postgres://user:password@localhost:5432/dbname?sslmode=disable up</pre></div><div class='content'></div><h3>Step 4: Verify the Changes</h3>
<div class='content'><p>Check the database to ensure the <code>age</code> column has been added to the <code>users</code> table.</p>
</div><h2>Best Practices</h2>
<div class='content'><ol>
<li><strong>Version Control</strong>: Always keep your migration scripts in version control to track changes and collaborate with your team.</li>
<li><strong>Atomic Migrations</strong>: Ensure each migration is atomic and can be applied or rolled back independently.</li>
<li><strong>Testing</strong>: Test your migrations in a staging environment before applying them to production.</li>
<li><strong>Documentation</strong>: Document each migration to explain the purpose and any potential impact on the application.</li>
</ol>
</div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Forgetting to Roll Back</strong>: Always provide a rollback script to revert changes if something goes wrong.</li>
<li><strong>Large Migrations</strong>: Break down large migrations into smaller, manageable steps to reduce the risk of errors.</li>
<li><strong>Inconsistent Environments</strong>: Ensure all environments (development, staging, production) are in sync with the same migration state.</li>
</ul>
</div><h2>Conclusion</h2>
<div class='content'><p>In this section, we covered the basics of database migrations, how to set up and use the <code>golang-migrate</code> tool, and best practices for managing migrations. By following these guidelines, you can ensure your database schema evolves smoothly and consistently across different environments. In the next section, we will explore building and deploying Go applications, which will help you take your Go projects to the next level.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='08-03-using-orm' title="Using ORM" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='08-03-using-orm' title="Using ORM" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='09-01-building-and-deploying-go-applications' title="Building and Deploying Go Applications" class="py-2 px-3 btn btn-primary"
				data-read-mod="go" data-read-unit="8-4">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='09-01-building-and-deploying-go-applications' title="Building and Deploying Go Applications" class="py-2 px-3 btn btn-primary" 
				data-read-mod="go" data-read-unit="8-4">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Go Programming Course</h1>
<h2>Module 1: Introduction to Go</h2>
<ul>
<li><a href="01-01-introduction-to-go">Introduction to Go</a></li>
<li><a href="01-02-setting-up-go-environment">Setting Up Go Environment</a></li>
<li><a href="01-03-your-first-go-program">Your First Go Program</a></li>
<li><a href="01-04-basic-syntax-and-structure">Basic Syntax and Structure</a></li>
</ul>
<h2>Module 2: Basic Concepts</h2>
<ul>
<li><a href="02-01-variables-and-constants">Variables and Constants</a></li>
<li><a href="02-02-data-types">Data Types</a></li>
<li><a href="02-03-operators">Operators</a></li>
<li><a href="02-04-control-structures">Control Structures</a></li>
<li><a href="02-05-functions">Functions</a></li>
</ul>
<h2>Module 3: Advanced Data Structures</h2>
<ul>
<li><a href="03-01-arrays-and-slices">Arrays and Slices</a></li>
<li><a href="03-02-maps">Maps</a></li>
<li><a href="03-03-structs">Structs</a></li>
<li><a href="03-04-pointers">Pointers</a></li>
</ul>
<h2>Module 4: Error Handling</h2>
<ul>
<li><a href="04-01-error-handling-basics">Error Handling Basics</a></li>
<li><a href="04-02-custom-errors">Custom Errors</a></li>
<li><a href="04-03-panic-and-recover">Panic and Recover</a></li>
</ul>
<h2>Module 5: Concurrency</h2>
<ul>
<li><a href="05-01-goroutines">Goroutines</a></li>
<li><a href="05-02-channels">Channels</a></li>
<li><a href="05-03-select-statement">Select Statement</a></li>
<li><a href="05-04-mutexes-and-synchronization">Mutexes and Synchronization</a></li>
</ul>
<h2>Module 6: Advanced Topics</h2>
<ul>
<li><a href="06-01-interfaces">Interfaces</a></li>
<li><a href="06-02-reflection">Reflection</a></li>
<li><a href="06-03-testing">Testing</a></li>
<li><a href="06-04-benchmarking">Benchmarking</a></li>
</ul>
<h2>Module 7: Web Development with Go</h2>
<ul>
<li><a href="07-01-building-a-simple-web-server">Building a Simple Web Server</a></li>
<li><a href="07-02-routing">Routing</a></li>
<li><a href="07-03-middleware">Middleware</a></li>
<li><a href="07-04-working-with-templates">Working with Templates</a></li>
</ul>
<h2>Module 8: Working with Databases</h2>
<ul>
<li><a href="08-01-connecting-to-a-database">Connecting to a Database</a></li>
<li><a href="08-02-crud-operations">CRUD Operations</a></li>
<li><a href="08-03-using-orm">Using ORM</a></li>
<li><a href="08-04-database-migrations">Database Migrations</a></li>
</ul>
<h2>Module 9: Deployment and Maintenance</h2>
<ul>
<li><a href="09-01-building-and-deploying-go-applications">Building and Deploying Go Applications</a></li>
<li><a href="09-02-logging">Logging</a></li>
<li><a href="09-03-monitoring-and-performance-tuning">Monitoring and Performance Tuning</a></li>
<li><a href="09-04-security-best-practices">Security Best Practices</a></li>
</ul>
<h2>Module 10: Final Project</h2>
<ul>
<li><a href="10-01-project-overview">Project Overview</a></li>
<li><a href="10-02-project-planning">Project Planning</a></li>
<li><a href="10-03-implementation">Implementation</a></li>
<li><a href="10-04-testing-and-deployment">Testing and Deployment</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
