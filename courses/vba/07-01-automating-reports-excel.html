<!DOCTYPE html>
<html lang="en">
<head>
    <title> Automating Reports in Excel </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/vba/07-01-automating-reports-excel" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/vba/07-01-automating-reports-excel" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/vba/07-01-automating-reports-excel" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.188a386f47.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "languages";
  		var MOD_NAME = "vba";
  		var TEMA_NAME = "7-1";
  		var TYPE = "mod";
  		var PATH = "mod/vba/07-01-automating-reports-excel";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/vba/07-01-automating-reports-excel" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/vba/07-01-automating-reports-excel" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="vba">
		<a  href="#" class="text-secondary d-none" data-read-mod="vba" data-read-unit="7-1" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="vba" data-unread-unit="7-1" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-04-version-control-vba-projects' title="Version Control for VBA Projects" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-04-version-control-vba-projects' title="Version Control for VBA Projects" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Automating Reports in Excel</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='07-02-creating-custom-excel-addin' title="Creating a Custom Excel Add-In" class="py-2 px-3 btn btn-primary"
				data-read-mod="vba" data-read-unit="7-1">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='07-02-creating-custom-excel-addin' title="Creating a Custom Excel Add-In" class="py-2 px-3 btn btn-primary" 
				data-read-mod="vba" data-read-unit="7-1">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to automate the generation of reports in Excel using VBA. Automating reports can save a significant amount of time and reduce the risk of human error. By the end of this module, you will be able to create a VBA script that generates a report based on data in an Excel workbook.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ol>
<li><strong>Understanding the Report Requirements</strong>: Define what data needs to be included in the report and the format of the report.</li>
<li><strong>Data Extraction</strong>: Learn how to extract data from Excel sheets using VBA.</li>
<li><strong>Data Manipulation</strong>: Understand how to manipulate and format data to fit the report requirements.</li>
<li><strong>Report Generation</strong>: Automate the creation of the report, including formatting and layout.</li>
<li><strong>Saving and Distributing the Report</strong>: Learn how to save the report in different formats and distribute it.</li>
</ol>
</div><h2>Step-by-Step Guide</h2>
<div class='content'></div><h3><ol>
<li>Understanding the Report Requirements</li>
</ol></h3>
<div class='content'><p>Before writing any code, it's crucial to understand what the report should look like. For this example, let's assume we need to generate a sales report that includes:</p>
<ul>
<li>Total sales per region</li>
<li>Total sales per product</li>
<li>A summary table with overall sales</li>
</ul>
</div><h3><ol start="2">
<li>Data Extraction</li>
</ol></h3>
<div class='content'><p>We will start by extracting data from an Excel sheet. Assume we have a sheet named &quot;SalesData&quot; with the following columns: <code>Date</code>, <code>Region</code>, <code>Product</code>, <code>Quantity</code>, and <code>Sales</code>.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEV4dHJhY3REYXRhKCkKICAgIERpbSB3cyBBcyBXb3Jrc2hlZXQKICAgIFNldCB3cyA9IFRoaXNXb3JrYm9vay5TaGVldHMoIlNhbGVzRGF0YSIpCiAgICAKICAgIERpbSBsYXN0Um93IEFzIExvbmcKICAgIGxhc3RSb3cgPSB3cy5DZWxscyh3cy5Sb3dzLkNvdW50LCAiQSIpLkVuZCh4bFVwKS5Sb3cKICAgIAogICAgRGltIGRhdGFSYW5nZSBBcyBSYW5nZQogICAgU2V0IGRhdGFSYW5nZSA9IHdzLlJhbmdlKCJBMjpFIiAmIGxhc3RSb3cpCiAgICAKICAgICcgRGlzcGxheSB0aGUgZGF0YSByYW5nZSBpbiB0aGUgSW1tZWRpYXRlIFdpbmRvdwogICAgRGVidWcuUHJpbnQgZGF0YVJhbmdlLkFkZHJlc3MKRW5kIFN1Yg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub ExtractData()
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets(&quot;SalesData&quot;)
    
    Dim lastRow As Long
    lastRow = ws.Cells(ws.Rows.Count, &quot;A&quot;).End(xlUp).Row
    
    Dim dataRange As Range
    Set dataRange = ws.Range(&quot;A2:E&quot; &amp; lastRow)
    
    ' Display the data range in the Immediate Window
    Debug.Print dataRange.Address
End Sub</pre></div><div class='content'></div><h3><ol start="3">
<li>Data Manipulation</li>
</ol></h3>
<div class='content'><p>Next, we will manipulate the data to calculate total sales per region and per product.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIENhbGN1bGF0ZVRvdGFscygpCiAgICBEaW0gd3MgQXMgV29ya3NoZWV0CiAgICBTZXQgd3MgPSBUaGlzV29ya2Jvb2suU2hlZXRzKCJTYWxlc0RhdGEiKQogICAgCiAgICBEaW0gbGFzdFJvdyBBcyBMb25nCiAgICBsYXN0Um93ID0gd3MuQ2VsbHMod3MuUm93cy5Db3VudCwgIkEiKS5FbmQoeGxVcCkuUm93CiAgICAKICAgIERpbSByZWdpb25Ub3RhbHMgQXMgT2JqZWN0CiAgICBTZXQgcmVnaW9uVG90YWxzID0gQ3JlYXRlT2JqZWN0KCJTY3JpcHRpbmcuRGljdGlvbmFyeSIpCiAgICAKICAgIERpbSBwcm9kdWN0VG90YWxzIEFzIE9iamVjdAogICAgU2V0IHByb2R1Y3RUb3RhbHMgPSBDcmVhdGVPYmplY3QoIlNjcmlwdGluZy5EaWN0aW9uYXJ5IikKICAgIAogICAgRGltIGkgQXMgTG9uZwogICAgRm9yIGkgPSAyIFRvIGxhc3RSb3cKICAgICAgICBEaW0gcmVnaW9uIEFzIFN0cmluZwogICAgICAgIHJlZ2lvbiA9IHdzLkNlbGxzKGksIDIpLlZhbHVlCiAgICAgICAgCiAgICAgICAgRGltIHByb2R1Y3QgQXMgU3RyaW5nCiAgICAgICAgcHJvZHVjdCA9IHdzLkNlbGxzKGksIDMpLlZhbHVlCiAgICAgICAgCiAgICAgICAgRGltIHNhbGVzIEFzIERvdWJsZQogICAgICAgIHNhbGVzID0gd3MuQ2VsbHMoaSwgNSkuVmFsdWUKICAgICAgICAKICAgICAgICBJZiBOb3QgcmVnaW9uVG90YWxzLmV4aXN0cyhyZWdpb24pIFRoZW4KICAgICAgICAgICAgcmVnaW9uVG90YWxzLkFkZCByZWdpb24sIDAKICAgICAgICBFbmQgSWYKICAgICAgICByZWdpb25Ub3RhbHMocmVnaW9uKSA9IHJlZ2lvblRvdGFscyhyZWdpb24pICsgc2FsZXMKICAgICAgICAKICAgICAgICBJZiBOb3QgcHJvZHVjdFRvdGFscy5leGlzdHMocHJvZHVjdCkgVGhlbgogICAgICAgICAgICBwcm9kdWN0VG90YWxzLkFkZCBwcm9kdWN0LCAwCiAgICAgICAgRW5kIElmCiAgICAgICAgcHJvZHVjdFRvdGFscyhwcm9kdWN0KSA9IHByb2R1Y3RUb3RhbHMocHJvZHVjdCkgKyBzYWxlcwogICAgTmV4dCBpCiAgICAKICAgICcgRGlzcGxheSB0aGUgdG90YWxzIGluIHRoZSBJbW1lZGlhdGUgV2luZG93CiAgICBEaW0ga2V5IEFzIFZhcmlhbnQKICAgIEZvciBFYWNoIGtleSBJbiByZWdpb25Ub3RhbHMua2V5cwogICAgICAgIERlYnVnLlByaW50ICJSZWdpb246ICIgJiBrZXkgJiAiLCBUb3RhbCBTYWxlczogIiAmIHJlZ2lvblRvdGFscyhrZXkpCiAgICBOZXh0IGtleQogICAgCiAgICBGb3IgRWFjaCBrZXkgSW4gcHJvZHVjdFRvdGFscy5rZXlzCiAgICAgICAgRGVidWcuUHJpbnQgIlByb2R1Y3Q6ICIgJiBrZXkgJiAiLCBUb3RhbCBTYWxlczogIiAmIHByb2R1Y3RUb3RhbHMoa2V5KQogICAgTmV4dCBrZXkKRW5kIFN1Yg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub CalculateTotals()
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets(&quot;SalesData&quot;)
    
    Dim lastRow As Long
    lastRow = ws.Cells(ws.Rows.Count, &quot;A&quot;).End(xlUp).Row
    
    Dim regionTotals As Object
    Set regionTotals = CreateObject(&quot;Scripting.Dictionary&quot;)
    
    Dim productTotals As Object
    Set productTotals = CreateObject(&quot;Scripting.Dictionary&quot;)
    
    Dim i As Long
    For i = 2 To lastRow
        Dim region As String
        region = ws.Cells(i, 2).Value
        
        Dim product As String
        product = ws.Cells(i, 3).Value
        
        Dim sales As Double
        sales = ws.Cells(i, 5).Value
        
        If Not regionTotals.exists(region) Then
            regionTotals.Add region, 0
        End If
        regionTotals(region) = regionTotals(region) + sales
        
        If Not productTotals.exists(product) Then
            productTotals.Add product, 0
        End If
        productTotals(product) = productTotals(product) + sales
    Next i
    
    ' Display the totals in the Immediate Window
    Dim key As Variant
    For Each key In regionTotals.keys
        Debug.Print &quot;Region: &quot; &amp; key &amp; &quot;, Total Sales: &quot; &amp; regionTotals(key)
    Next key
    
    For Each key In productTotals.keys
        Debug.Print &quot;Product: &quot; &amp; key &amp; &quot;, Total Sales: &quot; &amp; productTotals(key)
    Next key
End Sub</pre></div><div class='content'></div><h3><ol start="4">
<li>Report Generation</li>
</ol></h3>
<div class='content'><p>Now, we will generate the report in a new worksheet.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEdlbmVyYXRlUmVwb3J0KCkKICAgIERpbSByZXBvcnRTaGVldCBBcyBXb3Jrc2hlZXQKICAgIFNldCByZXBvcnRTaGVldCA9IFRoaXNXb3JrYm9vay5TaGVldHMuQWRkCiAgICByZXBvcnRTaGVldC5OYW1lID0gIlNhbGVzIFJlcG9ydCIKICAgIAogICAgJyBBZGQgaGVhZGVycwogICAgcmVwb3J0U2hlZXQuQ2VsbHMoMSwgMSkuVmFsdWUgPSAiUmVnaW9uIgogICAgcmVwb3J0U2hlZXQuQ2VsbHMoMSwgMikuVmFsdWUgPSAiVG90YWwgU2FsZXMiCiAgICByZXBvcnRTaGVldC5DZWxscygxLCA0KS5WYWx1ZSA9ICJQcm9kdWN0IgogICAgcmVwb3J0U2hlZXQuQ2VsbHMoMSwgNSkuVmFsdWUgPSAiVG90YWwgU2FsZXMiCiAgICAKICAgICcgUG9wdWxhdGUgcmVnaW9uIHRvdGFscwogICAgRGltIHJvdyBBcyBMb25nCiAgICByb3cgPSAyCiAgICBEaW0ga2V5IEFzIFZhcmlhbnQKICAgIEZvciBFYWNoIGtleSBJbiByZWdpb25Ub3RhbHMua2V5cwogICAgICAgIHJlcG9ydFNoZWV0LkNlbGxzKHJvdywgMSkuVmFsdWUgPSBrZXkKICAgICAgICByZXBvcnRTaGVldC5DZWxscyhyb3csIDIpLlZhbHVlID0gcmVnaW9uVG90YWxzKGtleSkKICAgICAgICByb3cgPSByb3cgKyAxCiAgICBOZXh0IGtleQogICAgCiAgICAnIFBvcHVsYXRlIHByb2R1Y3QgdG90YWxzCiAgICByb3cgPSAyCiAgICBGb3IgRWFjaCBrZXkgSW4gcHJvZHVjdFRvdGFscy5rZXlzCiAgICAgICAgcmVwb3J0U2hlZXQuQ2VsbHMocm93LCA0KS5WYWx1ZSA9IGtleQogICAgICAgIHJlcG9ydFNoZWV0LkNlbGxzKHJvdywgNSkuVmFsdWUgPSBwcm9kdWN0VG90YWxzKGtleSkKICAgICAgICByb3cgPSByb3cgKyAxCiAgICBOZXh0IGtleQogICAgCiAgICAnIEFkZCBzdW1tYXJ5CiAgICByZXBvcnRTaGVldC5DZWxscygxLCA3KS5WYWx1ZSA9ICJPdmVyYWxsIFNhbGVzIgogICAgcmVwb3J0U2hlZXQuQ2VsbHMoMiwgNykuVmFsdWUgPSBBcHBsaWNhdGlvbi5Xb3Jrc2hlZXRGdW5jdGlvbi5TdW0ocmVwb3J0U2hlZXQuUmFuZ2UoIkIyOkIiICYgbGFzdFJvdykpCkVuZCBTdWI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub GenerateReport()
    Dim reportSheet As Worksheet
    Set reportSheet = ThisWorkbook.Sheets.Add
    reportSheet.Name = &quot;Sales Report&quot;
    
    ' Add headers
    reportSheet.Cells(1, 1).Value = &quot;Region&quot;
    reportSheet.Cells(1, 2).Value = &quot;Total Sales&quot;
    reportSheet.Cells(1, 4).Value = &quot;Product&quot;
    reportSheet.Cells(1, 5).Value = &quot;Total Sales&quot;
    
    ' Populate region totals
    Dim row As Long
    row = 2
    Dim key As Variant
    For Each key In regionTotals.keys
        reportSheet.Cells(row, 1).Value = key
        reportSheet.Cells(row, 2).Value = regionTotals(key)
        row = row + 1
    Next key
    
    ' Populate product totals
    row = 2
    For Each key In productTotals.keys
        reportSheet.Cells(row, 4).Value = key
        reportSheet.Cells(row, 5).Value = productTotals(key)
        row = row + 1
    Next key
    
    ' Add summary
    reportSheet.Cells(1, 7).Value = &quot;Overall Sales&quot;
    reportSheet.Cells(2, 7).Value = Application.WorksheetFunction.Sum(reportSheet.Range(&quot;B2:B&quot; &amp; lastRow))
End Sub</pre></div><div class='content'></div><h3><ol start="5">
<li>Saving and Distributing the Report</li>
</ol></h3>
<div class='content'><p>Finally, we will save the report as a new workbook and distribute it.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIFNhdmVBbmREaXN0cmlidXRlUmVwb3J0KCkKICAgIERpbSByZXBvcnRQYXRoIEFzIFN0cmluZwogICAgcmVwb3J0UGF0aCA9IFRoaXNXb3JrYm9vay5QYXRoICYgIlxTYWxlc19SZXBvcnQueGxzeCIKICAgIAogICAgVGhpc1dvcmtib29rLlNoZWV0cygiU2FsZXMgUmVwb3J0IikuQ29weQogICAgQWN0aXZlV29ya2Jvb2suU2F2ZUFzIEZpbGVuYW1lOj1yZXBvcnRQYXRoCiAgICBBY3RpdmVXb3JrYm9vay5DbG9zZQogICAgCiAgICBNc2dCb3ggIlJlcG9ydCBzYXZlZCBhdDogIiAmIHJlcG9ydFBhdGgKRW5kIFN1Yg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub SaveAndDistributeReport()
    Dim reportPath As String
    reportPath = ThisWorkbook.Path &amp; &quot;\Sales_Report.xlsx&quot;
    
    ThisWorkbook.Sheets(&quot;Sales Report&quot;).Copy
    ActiveWorkbook.SaveAs Filename:=reportPath
    ActiveWorkbook.Close
    
    MsgBox &quot;Report saved at: &quot; &amp; reportPath
End Sub</pre></div><div class='content'></div><h3>Putting It All Together</h3>
<div class='content'><p>Here is the complete code to automate the report generation:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEF1dG9tYXRlUmVwb3J0KCkKICAgIEV4dHJhY3REYXRhCiAgICBDYWxjdWxhdGVUb3RhbHMKICAgIEdlbmVyYXRlUmVwb3J0CiAgICBTYXZlQW5kRGlzdHJpYnV0ZVJlcG9ydApFbmQgU3Vi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub AutomateReport()
    ExtractData
    CalculateTotals
    GenerateReport
    SaveAndDistributeReport
End Sub</pre></div><div class='content'></div><h2>Practical Exercise</h2>
<div class='content'><p><strong>Exercise</strong>: Modify the above code to include a chart in the report that visualizes the total sales per region.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEdlbmVyYXRlUmVwb3J0V2l0aENoYXJ0KCkKICAgIERpbSByZXBvcnRTaGVldCBBcyBXb3Jrc2hlZXQKICAgIFNldCByZXBvcnRTaGVldCA9IFRoaXNXb3JrYm9vay5TaGVldHMuQWRkCiAgICByZXBvcnRTaGVldC5OYW1lID0gIlNhbGVzIFJlcG9ydCIKICAgIAogICAgJyBBZGQgaGVhZGVycwogICAgcmVwb3J0U2hlZXQuQ2VsbHMoMSwgMSkuVmFsdWUgPSAiUmVnaW9uIgogICAgcmVwb3J0U2hlZXQuQ2VsbHMoMSwgMikuVmFsdWUgPSAiVG90YWwgU2FsZXMiCiAgICByZXBvcnRTaGVldC5DZWxscygxLCA0KS5WYWx1ZSA9ICJQcm9kdWN0IgogICAgcmVwb3J0U2hlZXQuQ2VsbHMoMSwgNSkuVmFsdWUgPSAiVG90YWwgU2FsZXMiCiAgICAKICAgICcgUG9wdWxhdGUgcmVnaW9uIHRvdGFscwogICAgRGltIHJvdyBBcyBMb25nCiAgICByb3cgPSAyCiAgICBEaW0ga2V5IEFzIFZhcmlhbnQKICAgIEZvciBFYWNoIGtleSBJbiByZWdpb25Ub3RhbHMua2V5cwogICAgICAgIHJlcG9ydFNoZWV0LkNlbGxzKHJvdywgMSkuVmFsdWUgPSBrZXkKICAgICAgICByZXBvcnRTaGVldC5DZWxscyhyb3csIDIpLlZhbHVlID0gcmVnaW9uVG90YWxzKGtleSkKICAgICAgICByb3cgPSByb3cgKyAxCiAgICBOZXh0IGtleQogICAgCiAgICAnIFBvcHVsYXRlIHByb2R1Y3QgdG90YWxzCiAgICByb3cgPSAyCiAgICBGb3IgRWFjaCBrZXkgSW4gcHJvZHVjdFRvdGFscy5rZXlzCiAgICAgICAgcmVwb3J0U2hlZXQuQ2VsbHMocm93LCA0KS5WYWx1ZSA9IGtleQogICAgICAgIHJlcG9ydFNoZWV0LkNlbGxzKHJvdywgNSkuVmFsdWUgPSBwcm9kdWN0VG90YWxzKGtleSkKICAgICAgICByb3cgPSByb3cgKyAxCiAgICBOZXh0IGtleQogICAgCiAgICAnIEFkZCBzdW1tYXJ5CiAgICByZXBvcnRTaGVldC5DZWxscygxLCA3KS5WYWx1ZSA9ICJPdmVyYWxsIFNhbGVzIgogICAgcmVwb3J0U2hlZXQuQ2VsbHMoMiwgNykuVmFsdWUgPSBBcHBsaWNhdGlvbi5Xb3Jrc2hlZXRGdW5jdGlvbi5TdW0ocmVwb3J0U2hlZXQuUmFuZ2UoIkIyOkIiICYgbGFzdFJvdykpCiAgICAKICAgICcgQWRkIGNoYXJ0CiAgICBEaW0gY2hhcnRPYmogQXMgQ2hhcnRPYmplY3QKICAgIFNldCBjaGFydE9iaiA9IHJlcG9ydFNoZWV0LkNoYXJ0T2JqZWN0cy5BZGQoTGVmdDo9MzAwLCBXaWR0aDo9NDAwLCBUb3A6PTUwLCBIZWlnaHQ6PTMwMCkKICAgIFdpdGggY2hhcnRPYmouQ2hhcnQKICAgICAgICAuU2V0U291cmNlRGF0YSBTb3VyY2U6PXJlcG9ydFNoZWV0LlJhbmdlKCJBMTpCIiAmIHJvdyAtIDEpCiAgICAgICAgLkNoYXJ0VHlwZSA9IHhsQ29sdW1uQ2x1c3RlcmVkCiAgICAgICAgLkhhc1RpdGxlID0gVHJ1ZQogICAgICAgIC5DaGFydFRpdGxlLlRleHQgPSAiVG90YWwgU2FsZXMgcGVyIFJlZ2lvbiIKICAgIEVuZCBXaXRoCkVuZCBTdWI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub GenerateReportWithChart()
    Dim reportSheet As Worksheet
    Set reportSheet = ThisWorkbook.Sheets.Add
    reportSheet.Name = &quot;Sales Report&quot;
    
    ' Add headers
    reportSheet.Cells(1, 1).Value = &quot;Region&quot;
    reportSheet.Cells(1, 2).Value = &quot;Total Sales&quot;
    reportSheet.Cells(1, 4).Value = &quot;Product&quot;
    reportSheet.Cells(1, 5).Value = &quot;Total Sales&quot;
    
    ' Populate region totals
    Dim row As Long
    row = 2
    Dim key As Variant
    For Each key In regionTotals.keys
        reportSheet.Cells(row, 1).Value = key
        reportSheet.Cells(row, 2).Value = regionTotals(key)
        row = row + 1
    Next key
    
    ' Populate product totals
    row = 2
    For Each key In productTotals.keys
        reportSheet.Cells(row, 4).Value = key
        reportSheet.Cells(row, 5).Value = productTotals(key)
        row = row + 1
    Next key
    
    ' Add summary
    reportSheet.Cells(1, 7).Value = &quot;Overall Sales&quot;
    reportSheet.Cells(2, 7).Value = Application.WorksheetFunction.Sum(reportSheet.Range(&quot;B2:B&quot; &amp; lastRow))
    
    ' Add chart
    Dim chartObj As ChartObject
    Set chartObj = reportSheet.ChartObjects.Add(Left:=300, Width:=400, Top:=50, Height:=300)
    With chartObj.Chart
        .SetSourceData Source:=reportSheet.Range(&quot;A1:B&quot; &amp; row - 1)
        .ChartType = xlColumnClustered
        .HasTitle = True
        .ChartTitle.Text = &quot;Total Sales per Region&quot;
    End With
End Sub</pre></div><div class='content'></div><h2>Conclusion</h2>
<div class='content'><p>In this section, we learned how to automate the generation of reports in Excel using VBA. We covered data extraction, manipulation, report generation, and saving the report. By automating these tasks, you can save time and ensure consistency in your reports. In the next section, we will explore how to create a custom Excel add-in to further enhance your productivity.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-04-version-control-vba-projects' title="Version Control for VBA Projects" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-04-version-control-vba-projects' title="Version Control for VBA Projects" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='07-02-creating-custom-excel-addin' title="Creating a Custom Excel Add-In" class="py-2 px-3 btn btn-primary"
				data-read-mod="vba" data-read-unit="7-1">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='07-02-creating-custom-excel-addin' title="Creating a Custom Excel Add-In" class="py-2 px-3 btn btn-primary" 
				data-read-mod="vba" data-read-unit="7-1">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>VBA (Visual Basic for Applications) Course</h1>
<h2>Module 1: Introduction to VBA</h2>
<ul>
<li><a href="01-01-what-is-vba">What is VBA?</a></li>
<li><a href="01-02-setting-up-vba-environment">Setting Up the VBA Environment</a></li>
<li><a href="01-03-first-vba-program">First VBA Program</a></li>
<li><a href="01-04-understanding-vba-editor">Understanding the VBA Editor</a></li>
</ul>
<h2>Module 2: VBA Basics</h2>
<ul>
<li><a href="02-01-variables-data-types">Variables and Data Types</a></li>
<li><a href="02-02-operators-in-vba">Operators in VBA</a></li>
<li><a href="02-03-control-structures-if-then-else">Control Structures: If...Then...Else</a></li>
<li><a href="02-04-loops-for-while-do-until">Loops: For, While, Do Until</a></li>
<li><a href="02-05-working-with-arrays">Working with Arrays</a></li>
</ul>
<h2>Module 3: Working with Excel Objects</h2>
<ul>
<li><a href="03-01-understanding-excel-object-model">Understanding Excel Object Model</a></li>
<li><a href="03-02-working-with-workbooks-worksheets">Working with Workbooks and Worksheets</a></li>
<li><a href="03-03-manipulating-cells-ranges">Manipulating Cells and Ranges</a></li>
<li><a href="03-04-using-range-object">Using the Range Object</a></li>
<li><a href="03-05-formatting-cells-vba">Formatting Cells with VBA</a></li>
</ul>
<h2>Module 4: Advanced VBA Programming</h2>
<ul>
<li><a href="04-01-creating-using-functions">Creating and Using Functions</a></li>
<li><a href="04-02-error-handling-vba">Error Handling in VBA</a></li>
<li><a href="04-03-debugging-techniques">Debugging Techniques</a></li>
<li><a href="04-04-working-with-userforms">Working with UserForms</a></li>
<li><a href="04-05-event-driven-programming">Event-Driven Programming</a></li>
</ul>
<h2>Module 5: Interacting with Other Applications</h2>
<ul>
<li><a href="05-01-automating-word-vba">Automating Word with VBA</a></li>
<li><a href="05-02-automating-outlook-vba">Automating Outlook with VBA</a></li>
<li><a href="05-03-accessing-databases-vba">Accessing Databases with VBA</a></li>
<li><a href="05-04-using-vba-control-powerpoint">Using VBA to Control PowerPoint</a></li>
</ul>
<h2>Module 6: Best Practices and Optimization</h2>
<ul>
<li><a href="06-01-writing-efficient-vba-code">Writing Efficient VBA Code</a></li>
<li><a href="06-02-code-refactoring-techniques">Code Refactoring Techniques</a></li>
<li><a href="06-03-documenting-your-code">Documenting Your Code</a></li>
<li><a href="06-04-version-control-vba-projects">Version Control for VBA Projects</a></li>
</ul>
<h2>Module 7: Real-World Projects</h2>
<ul>
<li><a href="07-01-automating-reports-excel">Automating Reports in Excel</a></li>
<li><a href="07-02-creating-custom-excel-addin">Creating a Custom Excel Add-In</a></li>
<li><a href="07-03-building-data-entry-form">Building a Data Entry Form</a></li>
<li><a href="07-04-developing-dashboard-vba">Developing a Dashboard with VBA</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
