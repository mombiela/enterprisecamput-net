<!DOCTYPE html>
<html lang="en">
<head>
    <title> Ansible Plugins </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/ansible/10-03-ansible-plugins" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/ansible/10-03-ansible-plugins" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/ansible/10-03-ansible-plugins" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "ansible";
  		var TEMA_NAME = "10-3";
  		var TYPE = "mod";
  		var PATH = "mod/ansible/10-03-ansible-plugins";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.ae32789132.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/ansible/10-03-ansible-plugins" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/ansible/10-03-ansible-plugins" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="ansible">
		<a  href="#" class="text-secondary d-none" data-read-mod="ansible" data-read-unit="10-3" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="ansible" data-unread-unit="10-3" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='10-02-dynamic-inventory' title="Dynamic Inventory" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='10-02-dynamic-inventory' title="Dynamic Inventory" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Ansible Plugins</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='10-04-ansible-api' title="Ansible API" class="py-2 px-3 btn btn-primary"
				data-read-mod="ansible" data-read-unit="10-3">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='10-04-ansible-api' title="Ansible API" class="py-2 px-3 btn btn-primary" 
				data-read-mod="ansible" data-read-unit="10-3">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>Ansible plugins are pieces of code that augment Ansible's core functionality. They allow you to extend Ansible's capabilities in various ways, such as adding new connection methods, lookup methods, or even custom actions. This topic will cover the different types of plugins available in Ansible, how to create your own plugins, and practical examples to help you understand their usage.</p>
</div><h2>Types of Ansible Plugins</h2>
<div class='content'><p>Ansible supports several types of plugins, each serving a different purpose:</p>
<ol>
<li><strong>Action Plugins</strong>: Modify the behavior of Ansible modules.</li>
<li><strong>Callback Plugins</strong>: Respond to events during playbook execution.</li>
<li><strong>Connection Plugins</strong>: Define how Ansible connects to hosts.</li>
<li><strong>Lookup Plugins</strong>: Retrieve data from external sources.</li>
<li><strong>Filter Plugins</strong>: Transform data within Jinja2 templates.</li>
<li><strong>Test Plugins</strong>: Provide custom tests for conditionals in Jinja2 templates.</li>
<li><strong>Vars Plugins</strong>: Load variables from external sources.</li>
<li><strong>Inventory Plugins</strong>: Dynamically generate inventory from external sources.</li>
</ol>
</div><h2>Creating a Custom Filter Plugin</h2>
<div class='content'><p>Let's create a simple custom filter plugin that reverses a string. This example will help you understand the structure and implementation of a filter plugin.</p>
</div><h3>Step-by-Step Guide</h3>
<div class='content'><ol>
<li>
<p><strong>Directory Structure</strong>:
Create a directory structure for your custom plugin. For this example, we'll place our plugin in a directory named <code>filter_plugins</code>.</p>
<pre><code>my_ansible_project/
├── filter_plugins/
│   └── reverse.py
└── playbook.yml
</code></pre>
</li>
<li>
<p><strong>Plugin Code</strong>:
In the <code>reverse.py</code> file, write the following code:</p>
<pre><code class="language-python"># reverse.py
class FilterModule(object):
    def filters(self):
        return {
            'reverse_string': self.reverse_string
        }

    def reverse_string(self, value):
        return value[::-1]
</code></pre>
<p><strong>Explanation</strong>:</p>
<ul>
<li><code>FilterModule</code> class: Defines the plugin.</li>
<li><code>filters</code> method: Returns a dictionary mapping filter names to their corresponding methods.</li>
<li><code>reverse_string</code> method: Implements the logic to reverse a string.</li>
</ul>
</li>
<li>
<p><strong>Using the Plugin in a Playbook</strong>:
Create a playbook <code>playbook.yml</code> to use the custom filter plugin.</p>
<pre><code class="language-yaml"># playbook.yml
- name: Test custom filter plugin
  hosts: localhost
  vars:
    my_string: &quot;Hello, Ansible!&quot;
  tasks:
    - name: Reverse the string
      debug:
        msg: &quot;{{ my_string | reverse_string }}&quot;
</code></pre>
<p><strong>Explanation</strong>:</p>
<ul>
<li><code>vars</code>: Defines a variable <code>my_string</code>.</li>
<li><code>tasks</code>: Uses the <code>debug</code> module to print the reversed string using the custom filter <code>reverse_string</code>.</li>
</ul>
</li>
<li>
<p><strong>Running the Playbook</strong>:
Execute the playbook to see the custom filter in action.</p>
<pre><code class="language-sh">ansible-playbook playbook.yml
</code></pre>
<p><strong>Expected Output</strong>:</p>
<pre><code>TASK [Reverse the string] ****************************************************
ok: [localhost] =&gt; {
    &quot;msg&quot;: &quot;!elbisnA ,olleH&quot;
}
</code></pre>
</li>
</ol>
</div><h2>Practical Exercises</h2>
<div class='content'></div><h3>Exercise 1: Create a Custom Lookup Plugin</h3>
<div class='content'><p><strong>Objective</strong>: Create a custom lookup plugin that reads data from a local JSON file.</p>
<ol>
<li>
<p><strong>Directory Structure</strong>:</p>
<pre><code>my_ansible_project/
├── lookup_plugins/
│   └── json_lookup.py
├── data.json
└── playbook.yml
</code></pre>
</li>
<li>
<p><strong>Plugin Code</strong>:</p>
<pre><code class="language-python"># json_lookup.py
import json

class LookupModule(object):
    def __init__(self, *args, **kwargs):
        pass

    def run(self, terms, variables=None, **kwargs):
        with open(terms[0], 'r') as f:
            data = json.load(f)
        return [data]
</code></pre>
</li>
<li>
<p><strong>JSON Data</strong> (<code>data.json</code>):</p>
<pre><code class="language-json">{
    &quot;name&quot;: &quot;Ansible&quot;,
    &quot;type&quot;: &quot;Automation&quot;
}
</code></pre>
</li>
<li>
<p><strong>Playbook</strong> (<code>playbook.yml</code>):</p>
<pre><code class="language-yaml">- name: Test custom lookup plugin
  hosts: localhost
  tasks:
    - name: Read data from JSON file
      debug:
        msg: &quot;{{ lookup('json_lookup', 'data.json') }}&quot;
</code></pre>
</li>
<li>
<p><strong>Run the Playbook</strong>:</p>
<pre><code class="language-sh">ansible-playbook playbook.yml
</code></pre>
</li>
</ol>
<p><strong>Expected Output</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VEFTSyBbUmVhZCBkYXRhIGZyb20gSlNPTiBmaWxlXSAKb2s6IFtsb2NhbGhvc3RdID0+IHsKICAgICJtc2ciOiBbCiAgICAgICAgewogICAgICAgICAgICAibmFtZSI6ICJBbnNpYmxlIiwKICAgICAgICAgICAgInR5cGUiOiAiQXV0b21hdGlvbiIKICAgICAgICB9CiAgICBdCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>TASK [Read data from JSON file] <strong></strong><strong></strong><strong></strong><strong></strong><strong></strong><strong></strong><strong></strong><strong></strong>
ok: [localhost] =&gt; {
    &quot;msg&quot;: [
        {
            &quot;name&quot;: &quot;Ansible&quot;,
            &quot;type&quot;: &quot;Automation&quot;
        }
    ]
}</pre></div><div class='content'></div><h3>Exercise 2: Create a Custom Callback Plugin</h3>
<div class='content'><p><strong>Objective</strong>: Create a custom callback plugin that logs task results to a file.</p>
<ol>
<li>
<p><strong>Directory Structure</strong>:</p>
<pre><code>my_ansible_project/
├── callback_plugins/
│   └── log_results.py
└── playbook.yml
</code></pre>
</li>
<li>
<p><strong>Plugin Code</strong>:</p>
<pre><code class="language-python"># log_results.py
from ansible.plugins.callback import CallbackBase

class CallbackModule(CallbackBase):
    def v2_runner_on_ok(self, result):
        with open('task_results.log', 'a') as f:
            f.write(f&quot;Task {result.task_name} succeeded: {result._result}\n&quot;)
</code></pre>
</li>
<li>
<p><strong>Playbook</strong> (<code>playbook.yml</code>):</p>
<pre><code class="language-yaml">- name: Test custom callback plugin
  hosts: localhost
  tasks:
    - name: Test task
      debug:
        msg: &quot;This is a test message&quot;
</code></pre>
</li>
<li>
<p><strong>Run the Playbook</strong>:</p>
<pre><code class="language-sh">ANSIBLE_STDOUT_CALLBACK=log_results ansible-playbook playbook.yml
</code></pre>
</li>
</ol>
<p><strong>Expected Output</strong>:
Check the <code>task_results.log</code> file for the logged task results.</p>
</div><h2>Summary</h2>
<div class='content'><p>In this section, we covered the different types of Ansible plugins and how they can extend Ansible's functionality. We walked through creating a custom filter plugin and provided practical exercises for creating custom lookup and callback plugins. Understanding and utilizing plugins can significantly enhance your Ansible automation capabilities, allowing for more flexible and powerful playbooks.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='10-02-dynamic-inventory' title="Dynamic Inventory" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='10-02-dynamic-inventory' title="Dynamic Inventory" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='10-04-ansible-api' title="Ansible API" class="py-2 px-3 btn btn-primary"
				data-read-mod="ansible" data-read-unit="10-3">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='10-04-ansible-api' title="Ansible API" class="py-2 px-3 btn btn-primary" 
				data-read-mod="ansible" data-read-unit="10-3">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Ansible: From Beginner to Advanced</h1>
<h2>Module 1: Introduction to Ansible</h2>
<ul>
<li><a href="01-01-what-is-ansible">What is Ansible?</a></li>
<li><a href="01-02-installing-ansible">Installing Ansible</a></li>
<li><a href="01-03-ansible-architecture">Ansible Architecture</a></li>
<li><a href="01-04-basic-ansible-commands">Basic Ansible Commands</a></li>
</ul>
<h2>Module 2: Ansible Basics</h2>
<ul>
<li><a href="02-01-inventory-files">Inventory Files</a></li>
<li><a href="02-02-ansible-configuration">Ansible Configuration</a></li>
<li><a href="02-03-ad-hoc-commands">Ad-Hoc Commands</a></li>
<li><a href="02-04-ansible-modules">Ansible Modules</a></li>
</ul>
<h2>Module 3: Playbooks</h2>
<ul>
<li><a href="03-01-introduction-to-playbooks">Introduction to Playbooks</a></li>
<li><a href="03-02-writing-your-first-playbook">Writing Your First Playbook</a></li>
<li><a href="03-03-playbook-structure">Playbook Structure</a></li>
<li><a href="03-04-variables-and-facts">Variables and Facts</a></li>
<li><a href="03-05-conditionals-and-loops">Conditionals and Loops</a></li>
</ul>
<h2>Module 4: Roles</h2>
<ul>
<li><a href="04-01-introduction-to-roles">Introduction to Roles</a></li>
<li><a href="04-02-creating-roles">Creating Roles</a></li>
<li><a href="04-03-role-directory-structure">Role Directory Structure</a></li>
<li><a href="04-04-using-roles-in-playbooks">Using Roles in Playbooks</a></li>
</ul>
<h2>Module 5: Advanced Playbook Techniques</h2>
<ul>
<li><a href="05-01-handlers">Handlers</a></li>
<li><a href="05-02-templates">Templates</a></li>
<li><a href="05-03-ansible-vault">Ansible Vault</a></li>
<li><a href="05-04-error-handling">Error Handling</a></li>
<li><a href="05-05-optimizing-playbooks">Optimizing Playbooks</a></li>
</ul>
<h2>Module 6: Ansible Galaxy</h2>
<ul>
<li><a href="06-01-what-is-ansible-galaxy">What is Ansible Galaxy?</a></li>
<li><a href="06-02-using-ansible-galaxy">Using Ansible Galaxy</a></li>
<li><a href="06-03-creating-and-sharing-roles">Creating and Sharing Roles</a></li>
</ul>
<h2>Module 7: Ansible Tower</h2>
<ul>
<li><a href="07-01-introduction-to-ansible-tower">Introduction to Ansible Tower</a></li>
<li><a href="07-02-installing-ansible-tower">Installing Ansible Tower</a></li>
<li><a href="07-03-using-ansible-tower">Using Ansible Tower</a></li>
<li><a href="07-04-managing-projects-and-inventories">Managing Projects and Inventories</a></li>
</ul>
<h2>Module 8: Ansible for DevOps</h2>
<ul>
<li><a href="08-01-ansible-and-docker">Ansible and Docker</a></li>
<li><a href="08-02-ansible-and-kubernetes">Ansible and Kubernetes</a></li>
<li><a href="08-03-ci-cd-with-ansible">CI/CD with Ansible</a></li>
<li><a href="08-04-ansible-in-cloud-environments">Ansible in Cloud Environments</a></li>
</ul>
<h2>Module 9: Ansible Best Practices</h2>
<ul>
<li><a href="09-01-code-organization">Code Organization</a></li>
<li><a href="09-02-security-best-practices">Security Best Practices</a></li>
<li><a href="09-03-performance-tuning">Performance Tuning</a></li>
<li><a href="09-04-testing-ansible-code">Testing Ansible Code</a></li>
</ul>
<h2>Module 10: Advanced Ansible Topics</h2>
<ul>
<li><a href="10-01-custom-modules">Custom Modules</a></li>
<li><a href="10-02-dynamic-inventory">Dynamic Inventory</a></li>
<li><a href="10-03-ansible-plugins">Ansible Plugins</a></li>
<li><a href="10-04-ansible-api">Ansible API</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
