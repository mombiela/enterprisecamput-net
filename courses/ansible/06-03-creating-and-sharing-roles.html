<!DOCTYPE html>
<html lang="en">
<head>
    <title> Creating and Sharing Roles </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/ansible/06-03-creating-and-sharing-roles" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/ansible/06-03-creating-and-sharing-roles" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/ansible/06-03-creating-and-sharing-roles" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "ansible";
  		var TEMA_NAME = "6-3";
  		var TYPE = "mod";
  		var PATH = "mod/ansible/06-03-creating-and-sharing-roles";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.688defeeef.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/ansible/06-03-creating-and-sharing-roles" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/ansible/06-03-creating-and-sharing-roles" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="ansible">
		<a  href="#" class="text-secondary d-none" data-read-mod="ansible" data-read-unit="6-3" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="ansible" data-unread-unit="6-3" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-02-using-ansible-galaxy' title="Using Ansible Galaxy" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-02-using-ansible-galaxy' title="Using Ansible Galaxy" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Creating and Sharing Roles</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='07-01-introduction-to-ansible-tower' title="Introduction to Ansible Tower" class="py-2 px-3 btn btn-primary"
				data-read-mod="ansible" data-read-unit="6-3">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='07-01-introduction-to-ansible-tower' title="Introduction to Ansible Tower" class="py-2 px-3 btn btn-primary" 
				data-read-mod="ansible" data-read-unit="6-3">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into the process of creating and sharing roles in Ansible. Roles are a powerful way to organize and reuse Ansible code, making your playbooks more modular and maintainable. By the end of this section, you will understand how to create roles, structure them properly, and share them using Ansible Galaxy.</p>
</div><h2>What is a Role?</h2>
<div class='content'><p>A role in Ansible is a way to group related tasks, variables, files, templates, and handlers into a single unit. Roles help in organizing playbooks and make them reusable and easier to manage.</p>
</div><h2>Creating a Role</h2>
<div class='content'></div><h3>Step-by-Step Guide</h3>
<div class='content'><ol>
<li>
<p><strong>Create a Role Directory Structure:</strong>
Use the <code>ansible-galaxy</code> command to create a new role. This command will generate the necessary directory structure for you.</p>
<pre><code class="language-bash">ansible-galaxy init my_role
</code></pre>
<p>This will create a directory named <code>my_role</code> with the following structure:</p>
<pre><code>my_role/
├── defaults
│   └── main.yml
├── files
├── handlers
│   └── main.yml
├── meta
│   └── main.yml
├── tasks
│   └── main.yml
├── templates
├── tests
│   ├── inventory
│   └── test.yml
└── vars
    └── main.yml
</code></pre>
</li>
<li>
<p><strong>Define Tasks:</strong>
Add tasks to the <code>tasks/main.yml</code> file. Tasks are the core of a role and define the actions to be performed.</p>
<pre><code class="language-yaml"># my_role/tasks/main.yml
- name: Install Nginx
  apt:
    name: nginx
    state: present
</code></pre>
</li>
<li>
<p><strong>Set Default Variables:</strong>
Define default variables in the <code>defaults/main.yml</code> file. These variables can be overridden by the user.</p>
<pre><code class="language-yaml"># my_role/defaults/main.yml
nginx_port: 80
</code></pre>
</li>
<li>
<p><strong>Add Handlers:</strong>
Handlers are tasks that are triggered by other tasks. Define them in the <code>handlers/main.yml</code> file.</p>
<pre><code class="language-yaml"># my_role/handlers/main.yml
- name: restart nginx
  service:
    name: nginx
    state: restarted
</code></pre>
</li>
<li>
<p><strong>Include Files and Templates:</strong>
Place any files or templates your role needs in the <code>files</code> and <code>templates</code> directories, respectively.</p>
<pre><code class="language-yaml"># my_role/templates/nginx.conf.j2
server {
    listen {{ nginx_port }};
    server_name localhost;
}
</code></pre>
</li>
<li>
<p><strong>Meta Information:</strong>
Provide metadata about your role in the <code>meta/main.yml</code> file. This includes information like the author, license, and dependencies.</p>
<pre><code class="language-yaml"># my_role/meta/main.yml
galaxy_info:
  author: Your Name
  description: Install and configure Nginx
  license: MIT
  min_ansible_version: 2.9
</code></pre>
</li>
</ol>
</div><h2>Sharing Roles</h2>
<div class='content'></div><h3>Using Ansible Galaxy</h3>
<div class='content'><p>Ansible Galaxy is a hub for finding, reusing, and sharing Ansible roles. To share your role on Ansible Galaxy, follow these steps:</p>
<ol>
<li>
<p><strong>Create a Galaxy Account:</strong>
Sign up for an account on <a href="https://galaxy.ansible.com/">Ansible Galaxy</a>.</p>
</li>
<li>
<p><strong>Prepare Your Role:</strong>
Ensure your role follows the best practices and includes all necessary metadata in the <code>meta/main.yml</code> file.</p>
</li>
<li>
<p><strong>Publish Your Role:</strong>
Use the <code>ansible-galaxy</code> command to publish your role.</p>
<pre><code class="language-bash">ansible-galaxy import username my_role
</code></pre>
<p>Replace <code>username</code> with your Galaxy username and <code>my_role</code> with the name of your role.</p>
</li>
<li>
<p><strong>Versioning:</strong>
Tag your role with a version number using Git. This helps users to track changes and use specific versions of your role.</p>
<pre><code class="language-bash">git tag 1.0.0
git push origin 1.0.0
</code></pre>
</li>
</ol>
</div><h3>Using GitHub</h3>
<div class='content'><p>You can also share your roles via GitHub. Simply push your role to a GitHub repository and provide the URL to users.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2l0IGluaXQKZ2l0IGFkZCAuCmdpdCBjb21taXQgLW0gIkluaXRpYWwgY29tbWl0IgpnaXQgcmVtb3RlIGFkZCBvcmlnaW4gaHR0cHM6Ly9naXRodWIuY29tL3VzZXJuYW1lL215X3JvbGUuZ2l0CmdpdCBwdXNoIC11IG9yaWdpbiBtYXN0ZXI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>git init
git add .
git commit -m &quot;Initial commit&quot;
git remote add origin https://github.com/username/my_role.git
git push -u origin master</pre></div><div class='content'></div><h2>Practical Exercise</h2>
<div class='content'></div><h3>Exercise: Create and Share a Role</h3>
<div class='content'><ol>
<li>
<p><strong>Create a Role:</strong>
Create a role named <code>webserver</code> that installs and configures Apache.</p>
</li>
<li>
<p><strong>Define Tasks:</strong>
Add tasks to install Apache and start the service.</p>
</li>
<li>
<p><strong>Set Default Variables:</strong>
Define a default variable for the Apache port.</p>
</li>
<li>
<p><strong>Add Handlers:</strong>
Add a handler to restart Apache.</p>
</li>
<li>
<p><strong>Share the Role:</strong>
Publish the role on Ansible Galaxy or share it via GitHub.</p>
</li>
</ol>
</div><h3>Solution</h3>
<div class='content'><ol>
<li>
<p><strong>Create a Role:</strong></p>
<pre><code class="language-bash">ansible-galaxy init webserver
</code></pre>
</li>
<li>
<p><strong>Define Tasks:</strong></p>
<pre><code class="language-yaml"># webserver/tasks/main.yml
- name: Install Apache
  apt:
    name: apache2
    state: present

- name: Start Apache
  service:
    name: apache2
    state: started
    enabled: true
</code></pre>
</li>
<li>
<p><strong>Set Default Variables:</strong></p>
<pre><code class="language-yaml"># webserver/defaults/main.yml
apache_port: 80
</code></pre>
</li>
<li>
<p><strong>Add Handlers:</strong></p>
<pre><code class="language-yaml"># webserver/handlers/main.yml
- name: restart apache
  service:
    name: apache2
    state: restarted
</code></pre>
</li>
<li>
<p><strong>Share the Role:</strong>
Follow the steps mentioned above to publish the role on Ansible Galaxy or share it via GitHub.</p>
</li>
</ol>
</div><h2>Conclusion</h2>
<div class='content'><p>In this section, we covered the creation and sharing of Ansible roles. Roles help in organizing and reusing Ansible code, making your playbooks more modular and maintainable. We also explored how to share roles using Ansible Galaxy and GitHub. In the next module, we will dive into Ansible Tower and learn how to manage projects and inventories.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-02-using-ansible-galaxy' title="Using Ansible Galaxy" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-02-using-ansible-galaxy' title="Using Ansible Galaxy" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='07-01-introduction-to-ansible-tower' title="Introduction to Ansible Tower" class="py-2 px-3 btn btn-primary"
				data-read-mod="ansible" data-read-unit="6-3">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='07-01-introduction-to-ansible-tower' title="Introduction to Ansible Tower" class="py-2 px-3 btn btn-primary" 
				data-read-mod="ansible" data-read-unit="6-3">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Ansible: From Beginner to Advanced</h1>
<h2>Module 1: Introduction to Ansible</h2>
<ul>
<li><a href="01-01-what-is-ansible">What is Ansible?</a></li>
<li><a href="01-02-installing-ansible">Installing Ansible</a></li>
<li><a href="01-03-ansible-architecture">Ansible Architecture</a></li>
<li><a href="01-04-basic-ansible-commands">Basic Ansible Commands</a></li>
</ul>
<h2>Module 2: Ansible Basics</h2>
<ul>
<li><a href="02-01-inventory-files">Inventory Files</a></li>
<li><a href="02-02-ansible-configuration">Ansible Configuration</a></li>
<li><a href="02-03-ad-hoc-commands">Ad-Hoc Commands</a></li>
<li><a href="02-04-ansible-modules">Ansible Modules</a></li>
</ul>
<h2>Module 3: Playbooks</h2>
<ul>
<li><a href="03-01-introduction-to-playbooks">Introduction to Playbooks</a></li>
<li><a href="03-02-writing-your-first-playbook">Writing Your First Playbook</a></li>
<li><a href="03-03-playbook-structure">Playbook Structure</a></li>
<li><a href="03-04-variables-and-facts">Variables and Facts</a></li>
<li><a href="03-05-conditionals-and-loops">Conditionals and Loops</a></li>
</ul>
<h2>Module 4: Roles</h2>
<ul>
<li><a href="04-01-introduction-to-roles">Introduction to Roles</a></li>
<li><a href="04-02-creating-roles">Creating Roles</a></li>
<li><a href="04-03-role-directory-structure">Role Directory Structure</a></li>
<li><a href="04-04-using-roles-in-playbooks">Using Roles in Playbooks</a></li>
</ul>
<h2>Module 5: Advanced Playbook Techniques</h2>
<ul>
<li><a href="05-01-handlers">Handlers</a></li>
<li><a href="05-02-templates">Templates</a></li>
<li><a href="05-03-ansible-vault">Ansible Vault</a></li>
<li><a href="05-04-error-handling">Error Handling</a></li>
<li><a href="05-05-optimizing-playbooks">Optimizing Playbooks</a></li>
</ul>
<h2>Module 6: Ansible Galaxy</h2>
<ul>
<li><a href="06-01-what-is-ansible-galaxy">What is Ansible Galaxy?</a></li>
<li><a href="06-02-using-ansible-galaxy">Using Ansible Galaxy</a></li>
<li><a href="06-03-creating-and-sharing-roles">Creating and Sharing Roles</a></li>
</ul>
<h2>Module 7: Ansible Tower</h2>
<ul>
<li><a href="07-01-introduction-to-ansible-tower">Introduction to Ansible Tower</a></li>
<li><a href="07-02-installing-ansible-tower">Installing Ansible Tower</a></li>
<li><a href="07-03-using-ansible-tower">Using Ansible Tower</a></li>
<li><a href="07-04-managing-projects-and-inventories">Managing Projects and Inventories</a></li>
</ul>
<h2>Module 8: Ansible for DevOps</h2>
<ul>
<li><a href="08-01-ansible-and-docker">Ansible and Docker</a></li>
<li><a href="08-02-ansible-and-kubernetes">Ansible and Kubernetes</a></li>
<li><a href="08-03-ci-cd-with-ansible">CI/CD with Ansible</a></li>
<li><a href="08-04-ansible-in-cloud-environments">Ansible in Cloud Environments</a></li>
</ul>
<h2>Module 9: Ansible Best Practices</h2>
<ul>
<li><a href="09-01-code-organization">Code Organization</a></li>
<li><a href="09-02-security-best-practices">Security Best Practices</a></li>
<li><a href="09-03-performance-tuning">Performance Tuning</a></li>
<li><a href="09-04-testing-ansible-code">Testing Ansible Code</a></li>
</ul>
<h2>Module 10: Advanced Ansible Topics</h2>
<ul>
<li><a href="10-01-custom-modules">Custom Modules</a></li>
<li><a href="10-02-dynamic-inventory">Dynamic Inventory</a></li>
<li><a href="10-03-ansible-plugins">Ansible Plugins</a></li>
<li><a href="10-04-ansible-api">Ansible API</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
