<!DOCTYPE html>
<html lang="en">
<head>
    <title> Conditionals and Loops </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/ansible/03-05-conditionals-and-loops" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/ansible/03-05-conditionals-and-loops" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/ansible/03-05-conditionals-and-loops" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "ansible";
  		var TEMA_NAME = "3-5";
  		var TYPE = "mod";
  		var PATH = "mod/ansible/03-05-conditionals-and-loops";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.e0e4cfcd99.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/ansible/03-05-conditionals-and-loops" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/ansible/03-05-conditionals-and-loops" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="ansible">
		<a  href="#" class="text-secondary d-none" data-read-mod="ansible" data-read-unit="3-5" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="ansible" data-unread-unit="3-5" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='03-04-variables-and-facts' title="Variables and Facts" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='03-04-variables-and-facts' title="Variables and Facts" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Conditionals and Loops</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='04-01-introduction-to-roles' title="Introduction to Roles" class="py-2 px-3 btn btn-primary"
				data-read-mod="ansible" data-read-unit="3-5">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='04-01-introduction-to-roles' title="Introduction to Roles" class="py-2 px-3 btn btn-primary" 
				data-read-mod="ansible" data-read-unit="3-5">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to use conditionals and loops in Ansible playbooks. These features allow you to create more dynamic and flexible automation scripts.</p>
</div><h2>Conditionals</h2>
<div class='content'><p>Conditionals in Ansible allow you to execute tasks based on certain conditions. This is useful when you want to perform actions only if specific criteria are met.</p>
</div><h3>Basic Syntax</h3>
<div class='content'><p>The basic syntax for conditionals in Ansible is to use the <code>when</code> keyword followed by a Jinja2 expression.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBJbnN0YWxsIEFwYWNoZSBvbiBEZWJpYW4tYmFzZWQgc3lzdGVtcwogIGFwdDoKICAgIG5hbWU6IGFwYWNoZTIKICAgIHN0YXRlOiBwcmVzZW50CiAgd2hlbjogYW5zaWJsZV9vc19mYW1pbHkgPT0gIkRlYmlhbiI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Install Apache on Debian-based systems
  apt:
    name: apache2
    state: present
  when: ansible_os_family == &quot;Debian&quot;</pre></div><div class='content'></div><h3>Practical Example</h3>
<div class='content'><p>Let's consider a more detailed example where we install different packages based on the operating system.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBJbnN0YWxsIHdlYiBzZXJ2ZXIKICBob3N0czogYWxsCiAgdGFza3M6CiAgICAtIG5hbWU6IEluc3RhbGwgQXBhY2hlIG9uIERlYmlhbi1iYXNlZCBzeXN0ZW1zCiAgICAgIGFwdDoKICAgICAgICBuYW1lOiBhcGFjaGUyCiAgICAgICAgc3RhdGU6IHByZXNlbnQKICAgICAgd2hlbjogYW5zaWJsZV9vc19mYW1pbHkgPT0gIkRlYmlhbiIKCiAgICAtIG5hbWU6IEluc3RhbGwgQXBhY2hlIG9uIFJlZEhhdC1iYXNlZCBzeXN0ZW1zCiAgICAgIHl1bToKICAgICAgICBuYW1lOiBodHRwZAogICAgICAgIHN0YXRlOiBwcmVzZW50CiAgICAgIHdoZW46IGFuc2libGVfb3NfZmFtaWx5ID09ICJSZWRIYXQi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Install web server
  hosts: all
  tasks:
    - name: Install Apache on Debian-based systems
      apt:
        name: apache2
        state: present
      when: ansible_os_family == &quot;Debian&quot;

    - name: Install Apache on RedHat-based systems
      yum:
        name: httpd
        state: present
      when: ansible_os_family == &quot;RedHat&quot;</pre></div><div class='content'></div><h3>Common Mistakes</h3>
<div class='content'><ul>
<li><strong>Incorrect Condition Syntax</strong>: Ensure that the condition is a valid Jinja2 expression.</li>
<li><strong>Indentation Errors</strong>: Make sure the <code>when</code> keyword is correctly indented under the task.</li>
</ul>
</div><h2>Loops</h2>
<div class='content'><p>Loops in Ansible allow you to repeat a task multiple times with different parameters. This is useful for tasks like installing multiple packages or creating multiple users.</p>
</div><h3>Basic Syntax</h3>
<div class='content'><p>The basic syntax for loops in Ansible is to use the <code>loop</code> keyword followed by a list of items.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBJbnN0YWxsIG11bHRpcGxlIHBhY2thZ2VzCiAgYXB0OgogICAgbmFtZTogInt7IGl0ZW0gfX0iCiAgICBzdGF0ZTogcHJlc2VudAogIGxvb3A6CiAgICAtIGFwYWNoZTIKICAgIC0gbXlzcWwtc2VydmVyCiAgICAtIHBocA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Install multiple packages
  apt:
    name: &quot;{{ item }}&quot;
    state: present
  loop:
    - apache2
    - mysql-server
    - php</pre></div><div class='content'></div><h3>Practical Example</h3>
<div class='content'><p>Let's consider a more detailed example where we create multiple users.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBDcmVhdGUgbXVsdGlwbGUgdXNlcnMKICBob3N0czogYWxsCiAgdGFza3M6CiAgICAtIG5hbWU6IEFkZCB1c2VycwogICAgICB1c2VyOgogICAgICAgIG5hbWU6ICJ7eyBpdGVtLm5hbWUgfX0iCiAgICAgICAgc3RhdGU6IHByZXNlbnQKICAgICAgICBncm91cHM6ICJ7eyBpdGVtLmdyb3VwcyB9fSIKICAgICAgbG9vcDoKICAgICAgICAtIHsgbmFtZTogJ2FsaWNlJywgZ3JvdXBzOiAnYWRtaW4nIH0KICAgICAgICAtIHsgbmFtZTogJ2JvYicsIGdyb3VwczogJ3VzZXJzJyB9CiAgICAgICAgLSB7IG5hbWU6ICdjaGFybGllJywgZ3JvdXBzOiAndXNlcnMnIH0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Create multiple users
  hosts: all
  tasks:
    - name: Add users
      user:
        name: &quot;{{ item.name }}&quot;
        state: present
        groups: &quot;{{ item.groups }}&quot;
      loop:
        - { name: 'alice', groups: 'admin' }
        - { name: 'bob', groups: 'users' }
        - { name: 'charlie', groups: 'users' }</pre></div><div class='content'></div><h3>Loop Control</h3>
<div class='content'><p>You can also control the behavior of loops using <code>loop_control</code>.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBJbnN0YWxsIG11bHRpcGxlIHBhY2thZ2VzIHdpdGggaW5kZXgKICBhcHQ6CiAgICBuYW1lOiAie3sgaXRlbSB9fSIKICAgIHN0YXRlOiBwcmVzZW50CiAgbG9vcDoKICAgIC0gYXBhY2hlMgogICAgLSBteXNxbC1zZXJ2ZXIKICAgIC0gcGhwCiAgbG9vcF9jb250cm9sOgogICAgaW5kZXhfdmFyOiBwa2dfaW5kZXg="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Install multiple packages with index
  apt:
    name: &quot;{{ item }}&quot;
    state: present
  loop:
    - apache2
    - mysql-server
    - php
  loop_control:
    index_var: pkg_index</pre></div><div class='content'></div><h3>Common Mistakes</h3>
<div class='content'><ul>
<li><strong>Incorrect Loop Syntax</strong>: Ensure that the loop is a valid list.</li>
<li><strong>Variable Scope</strong>: Be cautious about variable scope within loops.</li>
</ul>
</div><h2>Practical Exercise</h2>
<div class='content'></div><h3>Exercise</h3>
<div class='content'><p>Write a playbook that performs the following tasks:</p>
<ol>
<li>Installs <code>nginx</code> on Debian-based systems and <code>httpd</code> on RedHat-based systems.</li>
<li>Creates three users: <code>user1</code>, <code>user2</code>, and <code>user3</code>, each belonging to the <code>users</code> group.</li>
</ol>
</div><h3>Solution</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBDb25kaXRpb25hbCBhbmQgTG9vcCBFeGVyY2lzZQogIGhvc3RzOiBhbGwKICB0YXNrczoKICAgIC0gbmFtZTogSW5zdGFsbCB3ZWIgc2VydmVyIG9uIERlYmlhbi1iYXNlZCBzeXN0ZW1zCiAgICAgIGFwdDoKICAgICAgICBuYW1lOiBuZ2lueAogICAgICAgIHN0YXRlOiBwcmVzZW50CiAgICAgIHdoZW46IGFuc2libGVfb3NfZmFtaWx5ID09ICJEZWJpYW4iCgogICAgLSBuYW1lOiBJbnN0YWxsIHdlYiBzZXJ2ZXIgb24gUmVkSGF0LWJhc2VkIHN5c3RlbXMKICAgICAgeXVtOgogICAgICAgIG5hbWU6IGh0dHBkCiAgICAgICAgc3RhdGU6IHByZXNlbnQKICAgICAgd2hlbjogYW5zaWJsZV9vc19mYW1pbHkgPT0gIlJlZEhhdCIKCiAgICAtIG5hbWU6IENyZWF0ZSBtdWx0aXBsZSB1c2VycwogICAgICB1c2VyOgogICAgICAgIG5hbWU6ICJ7eyBpdGVtIH19IgogICAgICAgIHN0YXRlOiBwcmVzZW50CiAgICAgICAgZ3JvdXBzOiB1c2VycwogICAgICBsb29wOgogICAgICAgIC0gdXNlcjEKICAgICAgICAtIHVzZXIyCiAgICAgICAgLSB1c2VyMw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Conditional and Loop Exercise
  hosts: all
  tasks:
    - name: Install web server on Debian-based systems
      apt:
        name: nginx
        state: present
      when: ansible_os_family == &quot;Debian&quot;

    - name: Install web server on RedHat-based systems
      yum:
        name: httpd
        state: present
      when: ansible_os_family == &quot;RedHat&quot;

    - name: Create multiple users
      user:
        name: &quot;{{ item }}&quot;
        state: present
        groups: users
      loop:
        - user1
        - user2
        - user3</pre></div><div class='content'></div><h2>Summary</h2>
<div class='content'><p>In this section, we covered:</p>
<ul>
<li>The use of conditionals with the <code>when</code> keyword to execute tasks based on specific conditions.</li>
<li>The use of loops with the <code>loop</code> keyword to repeat tasks with different parameters.</li>
<li>Practical examples and common mistakes to avoid.</li>
</ul>
<p>Understanding conditionals and loops will help you create more dynamic and flexible Ansible playbooks. In the next section, we will delve into roles, which allow you to organize your playbooks into reusable components.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='03-04-variables-and-facts' title="Variables and Facts" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='03-04-variables-and-facts' title="Variables and Facts" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='04-01-introduction-to-roles' title="Introduction to Roles" class="py-2 px-3 btn btn-primary"
				data-read-mod="ansible" data-read-unit="3-5">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='04-01-introduction-to-roles' title="Introduction to Roles" class="py-2 px-3 btn btn-primary" 
				data-read-mod="ansible" data-read-unit="3-5">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Ansible: From Beginner to Advanced</h1>
<h2>Module 1: Introduction to Ansible</h2>
<ul>
<li><a href="01-01-what-is-ansible">What is Ansible?</a></li>
<li><a href="01-02-installing-ansible">Installing Ansible</a></li>
<li><a href="01-03-ansible-architecture">Ansible Architecture</a></li>
<li><a href="01-04-basic-ansible-commands">Basic Ansible Commands</a></li>
</ul>
<h2>Module 2: Ansible Basics</h2>
<ul>
<li><a href="02-01-inventory-files">Inventory Files</a></li>
<li><a href="02-02-ansible-configuration">Ansible Configuration</a></li>
<li><a href="02-03-ad-hoc-commands">Ad-Hoc Commands</a></li>
<li><a href="02-04-ansible-modules">Ansible Modules</a></li>
</ul>
<h2>Module 3: Playbooks</h2>
<ul>
<li><a href="03-01-introduction-to-playbooks">Introduction to Playbooks</a></li>
<li><a href="03-02-writing-your-first-playbook">Writing Your First Playbook</a></li>
<li><a href="03-03-playbook-structure">Playbook Structure</a></li>
<li><a href="03-04-variables-and-facts">Variables and Facts</a></li>
<li><a href="03-05-conditionals-and-loops">Conditionals and Loops</a></li>
</ul>
<h2>Module 4: Roles</h2>
<ul>
<li><a href="04-01-introduction-to-roles">Introduction to Roles</a></li>
<li><a href="04-02-creating-roles">Creating Roles</a></li>
<li><a href="04-03-role-directory-structure">Role Directory Structure</a></li>
<li><a href="04-04-using-roles-in-playbooks">Using Roles in Playbooks</a></li>
</ul>
<h2>Module 5: Advanced Playbook Techniques</h2>
<ul>
<li><a href="05-01-handlers">Handlers</a></li>
<li><a href="05-02-templates">Templates</a></li>
<li><a href="05-03-ansible-vault">Ansible Vault</a></li>
<li><a href="05-04-error-handling">Error Handling</a></li>
<li><a href="05-05-optimizing-playbooks">Optimizing Playbooks</a></li>
</ul>
<h2>Module 6: Ansible Galaxy</h2>
<ul>
<li><a href="06-01-what-is-ansible-galaxy">What is Ansible Galaxy?</a></li>
<li><a href="06-02-using-ansible-galaxy">Using Ansible Galaxy</a></li>
<li><a href="06-03-creating-and-sharing-roles">Creating and Sharing Roles</a></li>
</ul>
<h2>Module 7: Ansible Tower</h2>
<ul>
<li><a href="07-01-introduction-to-ansible-tower">Introduction to Ansible Tower</a></li>
<li><a href="07-02-installing-ansible-tower">Installing Ansible Tower</a></li>
<li><a href="07-03-using-ansible-tower">Using Ansible Tower</a></li>
<li><a href="07-04-managing-projects-and-inventories">Managing Projects and Inventories</a></li>
</ul>
<h2>Module 8: Ansible for DevOps</h2>
<ul>
<li><a href="08-01-ansible-and-docker">Ansible and Docker</a></li>
<li><a href="08-02-ansible-and-kubernetes">Ansible and Kubernetes</a></li>
<li><a href="08-03-ci-cd-with-ansible">CI/CD with Ansible</a></li>
<li><a href="08-04-ansible-in-cloud-environments">Ansible in Cloud Environments</a></li>
</ul>
<h2>Module 9: Ansible Best Practices</h2>
<ul>
<li><a href="09-01-code-organization">Code Organization</a></li>
<li><a href="09-02-security-best-practices">Security Best Practices</a></li>
<li><a href="09-03-performance-tuning">Performance Tuning</a></li>
<li><a href="09-04-testing-ansible-code">Testing Ansible Code</a></li>
</ul>
<h2>Module 10: Advanced Ansible Topics</h2>
<ul>
<li><a href="10-01-custom-modules">Custom Modules</a></li>
<li><a href="10-02-dynamic-inventory">Dynamic Inventory</a></li>
<li><a href="10-03-ansible-plugins">Ansible Plugins</a></li>
<li><a href="10-04-ansible-api">Ansible API</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
