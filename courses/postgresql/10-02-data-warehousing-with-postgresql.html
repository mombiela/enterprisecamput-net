<!DOCTYPE html>
<html lang="en">
<head>
    <title> Data Warehousing with PostgreSQL </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/postgresql/10-02-data-warehousing-with-postgresql" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/postgresql/10-02-data-warehousing-with-postgresql" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/postgresql/10-02-data-warehousing-with-postgresql" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "languages";
  		var MOD_NAME = "postgresql";
  		var TEMA_NAME = "10-2";
  		var TYPE = "mod";
  		var PATH = "mod/postgresql/10-02-data-warehousing-with-postgresql";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.ae32789132.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/postgresql/10-02-data-warehousing-with-postgresql" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/postgresql/10-02-data-warehousing-with-postgresql" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="postgresql">
		<a  href="#" class="text-secondary d-none" data-read-mod="postgresql" data-read-unit="10-2" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="postgresql" data-unread-unit="10-2" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='10-01-e-commerce-database-design' title="E-commerce Database Design" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='10-01-e-commerce-database-design' title="E-commerce Database Design" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Data Warehousing with PostgreSQL</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='10-03-handling-big-data' title="Handling Big Data" class="py-2 px-3 btn btn-primary"
				data-read-mod="postgresql" data-read-unit="10-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='10-03-handling-big-data' title="Handling Big Data" class="py-2 px-3 btn btn-primary" 
				data-read-mod="postgresql" data-read-unit="10-2">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>Data warehousing is a critical component of modern data management strategies, enabling organizations to consolidate and analyze large volumes of data from various sources. PostgreSQL, with its robust feature set and extensibility, is a powerful tool for building and managing data warehouses. In this section, we will explore the key concepts, techniques, and best practices for using PostgreSQL in data warehousing.</p>
</div><h2>Key Concepts</h2>
<div class='content'></div><h3>What is a Data Warehouse?</h3>
<div class='content'><p>A data warehouse is a centralized repository that stores integrated data from multiple sources. It is designed to support business intelligence (BI) activities, such as querying, reporting, and data analysis. Key characteristics of a data warehouse include:</p>
<ul>
<li><strong>Subject-Oriented</strong>: Organized around key subjects or areas of interest (e.g., sales, finance).</li>
<li><strong>Integrated</strong>: Combines data from different sources into a cohesive format.</li>
<li><strong>Non-Volatile</strong>: Data is stable and not frequently updated.</li>
<li><strong>Time-Variant</strong>: Historical data is maintained to track changes over time.</li>
</ul>
</div><h3>ETL Process</h3>
<div class='content'><p>ETL stands for Extract, Transform, Load, and it is the process used to move data from source systems into the data warehouse:</p>
<ol>
<li><strong>Extract</strong>: Retrieve data from various source systems.</li>
<li><strong>Transform</strong>: Cleanse, format, and integrate the data.</li>
<li><strong>Load</strong>: Load the transformed data into the data warehouse.</li>
</ol>
</div><h2>Setting Up a Data Warehouse in PostgreSQL</h2>
<div class='content'></div><h3>Schema Design</h3>
<div class='content'><p>Designing the schema for a data warehouse involves creating fact and dimension tables:</p>
<ul>
<li><strong>Fact Tables</strong>: Store quantitative data for analysis (e.g., sales transactions).</li>
<li><strong>Dimension Tables</strong>: Store descriptive attributes related to the facts (e.g., customer information).</li>
</ul>
<h4>Example Schema</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ3JlYXRlIGEgZGltZW5zaW9uIHRhYmxlIGZvciBjdXN0b21lcnMKQ1JFQVRFIFRBQkxFIGN1c3RvbWVycyAoCiAgICBjdXN0b21lcl9pZCBTRVJJQUwgUFJJTUFSWSBLRVksCiAgICBuYW1lIFZBUkNIQVIoMTAwKSwKICAgIGFkZHJlc3MgVkFSQ0hBUigyNTUpLAogICAgcGhvbmUgVkFSQ0hBUigyMCkKKTsKCi0tIENyZWF0ZSBhIGRpbWVuc2lvbiB0YWJsZSBmb3IgcHJvZHVjdHMKQ1JFQVRFIFRBQkxFIHByb2R1Y3RzICgKICAgIHByb2R1Y3RfaWQgU0VSSUFMIFBSSU1BUlkgS0VZLAogICAgbmFtZSBWQVJDSEFSKDEwMCksCiAgICBjYXRlZ29yeSBWQVJDSEFSKDUwKSwKICAgIHByaWNlIE5VTUVSSUMKKTsKCi0tIENyZWF0ZSBhIGZhY3QgdGFibGUgZm9yIHNhbGVzCkNSRUFURSBUQUJMRSBzYWxlcyAoCiAgICBzYWxlX2lkIFNFUklBTCBQUklNQVJZIEtFWSwKICAgIGN1c3RvbWVyX2lkIElOVCBSRUZFUkVOQ0VTIGN1c3RvbWVycyhjdXN0b21lcl9pZCksCiAgICBwcm9kdWN0X2lkIElOVCBSRUZFUkVOQ0VTIHByb2R1Y3RzKHByb2R1Y3RfaWQpLAogICAgc2FsZV9kYXRlIERBVEUsCiAgICBxdWFudGl0eSBJTlQsCiAgICB0b3RhbF9hbW91bnQgTlVNRVJJQwopOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Create a dimension table for customers
CREATE TABLE customers (
    customer_id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    address VARCHAR(255),
    phone VARCHAR(20)
);

-- Create a dimension table for products
CREATE TABLE products (
    product_id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    category VARCHAR(50),
    price NUMERIC
);

-- Create a fact table for sales
CREATE TABLE sales (
    sale_id SERIAL PRIMARY KEY,
    customer_id INT REFERENCES customers(customer_id),
    product_id INT REFERENCES products(product_id),
    sale_date DATE,
    quantity INT,
    total_amount NUMERIC
);</pre></div><div class='content'></div><h3>Loading Data</h3>
<div class='content'><p>Loading data into the data warehouse can be done using the COPY command or ETL tools like Apache NiFi, Talend, or custom scripts.</p>
<h4>Example: Using COPY Command</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q09QWSBjdXN0b21lcnMgKG5hbWUsIGFkZHJlc3MsIHBob25lKSBGUk9NICcvcGF0aC90by9jdXN0b21lcnMuY3N2JyBERUxJTUlURVIgJywnIENTViBIRUFERVI7CkNPUFkgcHJvZHVjdHMgKG5hbWUsIGNhdGVnb3J5LCBwcmljZSkgRlJPTSAnL3BhdGgvdG8vcHJvZHVjdHMuY3N2JyBERUxJTUlURVIgJywnIENTViBIRUFERVI7CkNPUFkgc2FsZXMgKGN1c3RvbWVyX2lkLCBwcm9kdWN0X2lkLCBzYWxlX2RhdGUsIHF1YW50aXR5LCB0b3RhbF9hbW91bnQpIEZST00gJy9wYXRoL3RvL3NhbGVzLmNzdicgREVMSU1JVEVSICcsJyBDU1YgSEVBREVSOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>COPY customers (name, address, phone) FROM '/path/to/customers.csv' DELIMITER ',' CSV HEADER;
COPY products (name, category, price) FROM '/path/to/products.csv' DELIMITER ',' CSV HEADER;
COPY sales (customer_id, product_id, sale_date, quantity, total_amount) FROM '/path/to/sales.csv' DELIMITER ',' CSV HEADER;</pre></div><div class='content'></div><h3>Indexing</h3>
<div class='content'><p>Proper indexing is crucial for optimizing query performance in a data warehouse. Common indexing strategies include:</p>
<ul>
<li><strong>B-Tree Indexes</strong>: Suitable for equality and range queries.</li>
<li><strong>Bitmap Indexes</strong>: Efficient for columns with low cardinality.</li>
<li><strong>Partial Indexes</strong>: Index a subset of rows to improve performance.</li>
</ul>
<h4>Example: Creating Indexes</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ3JlYXRlIGFuIGluZGV4IG9uIHRoZSBzYWxlX2RhdGUgY29sdW1uIGluIHRoZSBzYWxlcyB0YWJsZQpDUkVBVEUgSU5ERVggaWR4X3NhbGVfZGF0ZSBPTiBzYWxlcyhzYWxlX2RhdGUpOwoKLS0gQ3JlYXRlIGEgY29tcG9zaXRlIGluZGV4IG9uIGN1c3RvbWVyX2lkIGFuZCBwcm9kdWN0X2lkIGluIHRoZSBzYWxlcyB0YWJsZQpDUkVBVEUgSU5ERVggaWR4X2N1c3RvbWVyX3Byb2R1Y3QgT04gc2FsZXMoY3VzdG9tZXJfaWQsIHByb2R1Y3RfaWQpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Create an index on the sale_date column in the sales table
CREATE INDEX idx_sale_date ON sales(sale_date);

-- Create a composite index on customer_id and product_id in the sales table
CREATE INDEX idx_customer_product ON sales(customer_id, product_id);</pre></div><div class='content'></div><h2>Querying the Data Warehouse</h2>
<div class='content'></div><h3>Aggregate Queries</h3>
<div class='content'><p>Aggregate queries are commonly used in data warehousing to summarize data.</p>
<h4>Example: Total Sales by Product</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIHAubmFtZSBBUyBwcm9kdWN0X25hbWUsIFNVTShzLnRvdGFsX2Ftb3VudCkgQVMgdG90YWxfc2FsZXMKRlJPTSBzYWxlcyBzCkpPSU4gcHJvZHVjdHMgcCBPTiBzLnByb2R1Y3RfaWQgPSBwLnByb2R1Y3RfaWQKR1JPVVAgQlkgcC5uYW1lCk9SREVSIEJZIHRvdGFsX3NhbGVzIERFU0M7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT p.name AS product_name, SUM(s.total_amount) AS total_sales
FROM sales s
JOIN products p ON s.product_id = p.product_id
GROUP BY p.name
ORDER BY total_sales DESC;</pre></div><div class='content'></div><h3>Time-Series Analysis</h3>
<div class='content'><p>Analyzing data over time is a key use case in data warehousing.</p>
<h4>Example: Monthly Sales Trend</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIERBVEVfVFJVTkMoJ21vbnRoJywgc2FsZV9kYXRlKSBBUyBtb250aCwgU1VNKHRvdGFsX2Ftb3VudCkgQVMgdG90YWxfc2FsZXMKRlJPTSBzYWxlcwpHUk9VUCBCWSBtb250aApPUkRFUiBCWSBtb250aDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT DATE_TRUNC('month', sale_date) AS month, SUM(total_amount) AS total_sales
FROM sales
GROUP BY month
ORDER BY month;</pre></div><div class='content'></div><h2>Best Practices</h2>
<div class='content'></div><h3>Data Partitioning</h3>
<div class='content'><p>Partitioning large tables can improve query performance and manageability.</p>
<h4>Example: Range Partitioning by Sale Date</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ3JlYXRlIGEgcGFydGl0aW9uZWQgdGFibGUKQ1JFQVRFIFRBQkxFIHNhbGVzX3BhcnRpdGlvbmVkICgKICAgIHNhbGVfaWQgU0VSSUFMIFBSSU1BUlkgS0VZLAogICAgY3VzdG9tZXJfaWQgSU5ULAogICAgcHJvZHVjdF9pZCBJTlQsCiAgICBzYWxlX2RhdGUgREFURSwKICAgIHF1YW50aXR5IElOVCwKICAgIHRvdGFsX2Ftb3VudCBOVU1FUklDCikgUEFSVElUSU9OIEJZIFJBTkdFIChzYWxlX2RhdGUpOwoKLS0gQ3JlYXRlIHBhcnRpdGlvbnMKQ1JFQVRFIFRBQkxFIHNhbGVzXzIwMjIgUEFSVElUSU9OIE9GIHNhbGVzX3BhcnRpdGlvbmVkIEZPUiBWQUxVRVMgRlJPTSAoJzIwMjItMDEtMDEnKSBUTyAoJzIwMjMtMDEtMDEnKTsKQ1JFQVRFIFRBQkxFIHNhbGVzXzIwMjMgUEFSVElUSU9OIE9GIHNhbGVzX3BhcnRpdGlvbmVkIEZPUiBWQUxVRVMgRlJPTSAoJzIwMjMtMDEtMDEnKSBUTyAoJzIwMjQtMDEtMDEnKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Create a partitioned table
CREATE TABLE sales_partitioned (
    sale_id SERIAL PRIMARY KEY,
    customer_id INT,
    product_id INT,
    sale_date DATE,
    quantity INT,
    total_amount NUMERIC
) PARTITION BY RANGE (sale_date);

-- Create partitions
CREATE TABLE sales_2022 PARTITION OF sales_partitioned FOR VALUES FROM ('2022-01-01') TO ('2023-01-01');
CREATE TABLE sales_2023 PARTITION OF sales_partitioned FOR VALUES FROM ('2023-01-01') TO ('2024-01-01');</pre></div><div class='content'></div><h3>Data Compression</h3>
<div class='content'><p>Using data compression can save storage space and improve I/O performance.</p>
<h4>Example: Enabling Compression</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRW5hYmxlIGNvbXByZXNzaW9uIG9uIGEgdGFibGUKQUxURVIgVEFCTEUgc2FsZXMgU0VUIChhdXRvdmFjdXVtX2VuYWJsZWQgPSBmYWxzZSk7CkNMVVNURVIgc2FsZXMgVVNJTkcgaWR4X3NhbGVfZGF0ZTsKVkFDVVVNIEZVTEwgc2FsZXM7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Enable compression on a table
ALTER TABLE sales SET (autovacuum_enabled = false);
CLUSTER sales USING idx_sale_date;
VACUUM FULL sales;</pre></div><div class='content'></div><h2>Practical Exercise</h2>
<div class='content'></div><h3>Exercise: Create and Query a Data Warehouse</h3>
<div class='content'><ol>
<li><strong>Create the Schema</strong>: Define the schema for a simple data warehouse with customers, products, and sales tables.</li>
<li><strong>Load Data</strong>: Load sample data into the tables using the COPY command.</li>
<li><strong>Create Indexes</strong>: Create appropriate indexes to optimize query performance.</li>
<li><strong>Run Queries</strong>: Write and execute queries to analyze total sales by product and monthly sales trends.</li>
</ol>
<h4>Solution</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gU3RlcCAxOiBDcmVhdGUgdGhlIFNjaGVtYQpDUkVBVEUgVEFCTEUgY3VzdG9tZXJzICgKICAgIGN1c3RvbWVyX2lkIFNFUklBTCBQUklNQVJZIEtFWSwKICAgIG5hbWUgVkFSQ0hBUigxMDApLAogICAgYWRkcmVzcyBWQVJDSEFSKDI1NSksCiAgICBwaG9uZSBWQVJDSEFSKDIwKQopOwoKQ1JFQVRFIFRBQkxFIHByb2R1Y3RzICgKICAgIHByb2R1Y3RfaWQgU0VSSUFMIFBSSU1BUlkgS0VZLAogICAgbmFtZSBWQVJDSEFSKDEwMCksCiAgICBjYXRlZ29yeSBWQVJDSEFSKDUwKSwKICAgIHByaWNlIE5VTUVSSUMKKTsKCkNSRUFURSBUQUJMRSBzYWxlcyAoCiAgICBzYWxlX2lkIFNFUklBTCBQUklNQVJZIEtFWSwKICAgIGN1c3RvbWVyX2lkIElOVCBSRUZFUkVOQ0VTIGN1c3RvbWVycyhjdXN0b21lcl9pZCksCiAgICBwcm9kdWN0X2lkIElOVCBSRUZFUkVOQ0VTIHByb2R1Y3RzKHByb2R1Y3RfaWQpLAogICAgc2FsZV9kYXRlIERBVEUsCiAgICBxdWFudGl0eSBJTlQsCiAgICB0b3RhbF9hbW91bnQgTlVNRVJJQwopOwoKLS0gU3RlcCAyOiBMb2FkIERhdGEKQ09QWSBjdXN0b21lcnMgKG5hbWUsIGFkZHJlc3MsIHBob25lKSBGUk9NICcvcGF0aC90by9jdXN0b21lcnMuY3N2JyBERUxJTUlURVIgJywnIENTViBIRUFERVI7CkNPUFkgcHJvZHVjdHMgKG5hbWUsIGNhdGVnb3J5LCBwcmljZSkgRlJPTSAnL3BhdGgvdG8vcHJvZHVjdHMuY3N2JyBERUxJTUlURVIgJywnIENTViBIRUFERVI7CkNPUFkgc2FsZXMgKGN1c3RvbWVyX2lkLCBwcm9kdWN0X2lkLCBzYWxlX2RhdGUsIHF1YW50aXR5LCB0b3RhbF9hbW91bnQpIEZST00gJy9wYXRoL3RvL3NhbGVzLmNzdicgREVMSU1JVEVSICcsJyBDU1YgSEVBREVSOwoKLS0gU3RlcCAzOiBDcmVhdGUgSW5kZXhlcwpDUkVBVEUgSU5ERVggaWR4X3NhbGVfZGF0ZSBPTiBzYWxlcyhzYWxlX2RhdGUpOwpDUkVBVEUgSU5ERVggaWR4X2N1c3RvbWVyX3Byb2R1Y3QgT04gc2FsZXMoY3VzdG9tZXJfaWQsIHByb2R1Y3RfaWQpOwoKLS0gU3RlcCA0OiBSdW4gUXVlcmllcwotLSBUb3RhbCBTYWxlcyBieSBQcm9kdWN0ClNFTEVDVCBwLm5hbWUgQVMgcHJvZHVjdF9uYW1lLCBTVU0ocy50b3RhbF9hbW91bnQpIEFTIHRvdGFsX3NhbGVzCkZST00gc2FsZXMgcwpKT0lOIHByb2R1Y3RzIHAgT04gcy5wcm9kdWN0X2lkID0gcC5wcm9kdWN0X2lkCkdST1VQIEJZIHAubmFtZQpPUkRFUiBCWSB0b3RhbF9zYWxlcyBERVNDOwoKLS0gTW9udGhseSBTYWxlcyBUcmVuZApTRUxFQ1QgREFURV9UUlVOQygnbW9udGgnLCBzYWxlX2RhdGUpIEFTIG1vbnRoLCBTVU0odG90YWxfYW1vdW50KSBBUyB0b3RhbF9zYWxlcwpGUk9NIHNhbGVzCkdST1VQIEJZIG1vbnRoCk9SREVSIEJZIG1vbnRoOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Step 1: Create the Schema
CREATE TABLE customers (
    customer_id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    address VARCHAR(255),
    phone VARCHAR(20)
);

CREATE TABLE products (
    product_id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    category VARCHAR(50),
    price NUMERIC
);

CREATE TABLE sales (
    sale_id SERIAL PRIMARY KEY,
    customer_id INT REFERENCES customers(customer_id),
    product_id INT REFERENCES products(product_id),
    sale_date DATE,
    quantity INT,
    total_amount NUMERIC
);

-- Step 2: Load Data
COPY customers (name, address, phone) FROM '/path/to/customers.csv' DELIMITER ',' CSV HEADER;
COPY products (name, category, price) FROM '/path/to/products.csv' DELIMITER ',' CSV HEADER;
COPY sales (customer_id, product_id, sale_date, quantity, total_amount) FROM '/path/to/sales.csv' DELIMITER ',' CSV HEADER;

-- Step 3: Create Indexes
CREATE INDEX idx_sale_date ON sales(sale_date);
CREATE INDEX idx_customer_product ON sales(customer_id, product_id);

-- Step 4: Run Queries
-- Total Sales by Product
SELECT p.name AS product_name, SUM(s.total_amount) AS total_sales
FROM sales s
JOIN products p ON s.product_id = p.product_id
GROUP BY p.name
ORDER BY total_sales DESC;

-- Monthly Sales Trend
SELECT DATE_TRUNC('month', sale_date) AS month, SUM(total_amount) AS total_sales
FROM sales
GROUP BY month
ORDER BY month;</pre></div><div class='content'></div><h2>Conclusion</h2>
<div class='content'><p>In this section, we covered the essentials of setting up and managing a data warehouse using PostgreSQL. We discussed key concepts, schema design, data loading, indexing, and querying techniques. By following best practices and leveraging PostgreSQL's powerful features, you can build efficient and scalable data warehouses to support your organization's data analysis needs.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='10-01-e-commerce-database-design' title="E-commerce Database Design" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='10-01-e-commerce-database-design' title="E-commerce Database Design" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='10-03-handling-big-data' title="Handling Big Data" class="py-2 px-3 btn btn-primary"
				data-read-mod="postgresql" data-read-unit="10-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='10-03-handling-big-data' title="Handling Big Data" class="py-2 px-3 btn btn-primary" 
				data-read-mod="postgresql" data-read-unit="10-2">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>PostgreSQL Course</h1>
<h2>Module 1: Introduction to PostgreSQL</h2>
<ul>
<li><a href="01-01-what-is-postgresql">What is PostgreSQL?</a></li>
<li><a href="01-02-installing-postgresql">Installing PostgreSQL</a></li>
<li><a href="01-03-basic-sql-concepts">Basic SQL Concepts</a></li>
<li><a href="01-04-connecting-to-postgresql">Connecting to PostgreSQL</a></li>
</ul>
<h2>Module 2: Basic SQL Operations</h2>
<ul>
<li><a href="02-01-creating-databases-and-tables">Creating Databases and Tables</a></li>
<li><a href="02-02-inserting-data">Inserting Data</a></li>
<li><a href="02-03-querying-data">Querying Data</a></li>
<li><a href="02-04-updating-data">Updating Data</a></li>
<li><a href="02-05-deleting-data">Deleting Data</a></li>
</ul>
<h2>Module 3: Advanced SQL Queries</h2>
<ul>
<li><a href="03-01-joins">Joins</a></li>
<li><a href="03-02-subqueries">Subqueries</a></li>
<li><a href="03-03-aggregate-functions">Aggregate Functions</a></li>
<li><a href="03-04-window-functions">Window Functions</a></li>
<li><a href="03-05-common-table-expressions">Common Table Expressions (CTEs)</a></li>
</ul>
<h2>Module 4: Database Design and Normalization</h2>
<ul>
<li><a href="04-01-database-design-principles">Database Design Principles</a></li>
<li><a href="04-02-normalization">Normalization</a></li>
<li><a href="04-03-primary-and-foreign-keys">Primary and Foreign Keys</a></li>
<li><a href="04-04-indexes">Indexes</a></li>
</ul>
<h2>Module 5: Advanced PostgreSQL Features</h2>
<ul>
<li><a href="05-01-views">Views</a></li>
<li><a href="05-02-triggers">Triggers</a></li>
<li><a href="05-03-stored-procedures-and-functions">Stored Procedures and Functions</a></li>
<li><a href="05-04-transactions-and-concurrency">Transactions and Concurrency</a></li>
</ul>
<h2>Module 6: Performance Tuning and Optimization</h2>
<ul>
<li><a href="06-01-query-optimization">Query Optimization</a></li>
<li><a href="06-02-indexing-strategies">Indexing Strategies</a></li>
<li><a href="06-03-analyzing-query-performance">Analyzing Query Performance</a></li>
<li><a href="06-04-vacuuming-and-maintenance">Vacuuming and Maintenance</a></li>
</ul>
<h2>Module 7: Security and User Management</h2>
<ul>
<li><a href="07-01-user-roles-and-permissions">User Roles and Permissions</a></li>
<li><a href="07-02-authentication-methods">Authentication Methods</a></li>
<li><a href="07-03-data-encryption">Data Encryption</a></li>
<li><a href="07-04-backup-and-restore">Backup and Restore</a></li>
</ul>
<h2>Module 8: Working with JSON and NoSQL Features</h2>
<ul>
<li><a href="08-01-json-data-types">JSON Data Types</a></li>
<li><a href="08-02-json-functions-and-operators">JSON Functions and Operators</a></li>
<li><a href="08-03-using-postgresql-as-nosql">Using PostgreSQL as a NoSQL Database</a></li>
</ul>
<h2>Module 9: Extensions and Advanced Tools</h2>
<ul>
<li><a href="09-01-postgis-for-geospatial-data">PostGIS for Geospatial Data</a></li>
<li><a href="09-02-full-text-search">Full-Text Search</a></li>
<li><a href="09-03-foreign-data-wrappers">Foreign Data Wrappers</a></li>
<li><a href="09-04-plpgsql-and-other-procedural-languages">PL/pgSQL and Other Procedural Languages</a></li>
</ul>
<h2>Module 10: Case Studies and Real-World Applications</h2>
<ul>
<li><a href="10-01-e-commerce-database-design">E-commerce Database Design</a></li>
<li><a href="10-02-data-warehousing-with-postgresql">Data Warehousing with PostgreSQL</a></li>
<li><a href="10-03-handling-big-data">Handling Big Data</a></li>
<li><a href="10-04-postgresql-in-microservices-architecture">PostgreSQL in Microservices Architecture</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
