<!DOCTYPE html>
<html lang="en">
<head>
    <title> Window Functions </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/postgresql/03-04-window-functions" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/postgresql/03-04-window-functions" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/postgresql/03-04-window-functions" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.188a386f47.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "languages";
  		var MOD_NAME = "postgresql";
  		var TEMA_NAME = "3-4";
  		var TYPE = "mod";
  		var PATH = "mod/postgresql/03-04-window-functions";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/postgresql/03-04-window-functions" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/postgresql/03-04-window-functions" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="postgresql">
		<a  href="#" class="text-secondary d-none" data-read-mod="postgresql" data-read-unit="3-4" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="postgresql" data-unread-unit="3-4" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='03-03-aggregate-functions' title="Aggregate Functions" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='03-03-aggregate-functions' title="Aggregate Functions" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Window Functions</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='03-05-common-table-expressions' title="Common Table Expressions (CTEs)" class="py-2 px-3 btn btn-primary"
				data-read-mod="postgresql" data-read-unit="3-4">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='03-05-common-table-expressions' title="Common Table Expressions (CTEs)" class="py-2 px-3 btn btn-primary" 
				data-read-mod="postgresql" data-read-unit="3-4">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>Window functions are a powerful feature in SQL that allow you to perform calculations across a set of table rows that are somehow related to the current row. Unlike aggregate functions, which return a single value for a group of rows, window functions return a value for each row in the result set.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ol>
<li>
<p><strong>Window Function Syntax</strong>:</p>
<pre><code class="language-sql">function_name (expression) OVER (
    [PARTITION BY partition_expression]
    [ORDER BY sort_expression]
    [frame_clause]
)
</code></pre>
</li>
<li>
<p><strong>Components</strong>:</p>
<ul>
<li><strong>function_name</strong>: The name of the window function (e.g., <code>ROW_NUMBER()</code>, <code>RANK()</code>, <code>SUM()</code>, etc.).</li>
<li><strong>expression</strong>: The column or expression to be used in the function.</li>
<li><strong>PARTITION BY</strong>: Divides the result set into partitions to which the window function is applied.</li>
<li><strong>ORDER BY</strong>: Defines the order of rows within each partition.</li>
<li><strong>frame_clause</strong>: Specifies the subset of rows within the partition to be considered by the window function.</li>
</ul>
</li>
</ol>
</div><h2>Common Window Functions</h2>
<div class='content'><ol>
<li>
<p><strong>ROW_NUMBER()</strong>: Assigns a unique sequential integer to rows within a partition.</p>
<pre><code class="language-sql">SELECT 
    column1,
    ROW_NUMBER() OVER (PARTITION BY column2 ORDER BY column3) AS row_num
FROM 
    table_name;
</code></pre>
</li>
<li>
<p><strong>RANK()</strong>: Assigns a rank to each row within a partition, with gaps in the ranking for ties.</p>
<pre><code class="language-sql">SELECT 
    column1,
    RANK() OVER (PARTITION BY column2 ORDER BY column3) AS rank
FROM 
    table_name;
</code></pre>
</li>
<li>
<p><strong>DENSE_RANK()</strong>: Similar to <code>RANK()</code>, but without gaps in the ranking for ties.</p>
<pre><code class="language-sql">SELECT 
    column1,
    DENSE_RANK() OVER (PARTITION BY column2 ORDER BY column3) AS dense_rank
FROM 
    table_name;
</code></pre>
</li>
<li>
<p><strong>SUM()</strong>: Calculates the cumulative sum of a column's values within a partition.</p>
<pre><code class="language-sql">SELECT 
    column1,
    SUM(column4) OVER (PARTITION BY column2 ORDER BY column3) AS cumulative_sum
FROM 
    table_name;
</code></pre>
</li>
<li>
<p><strong>AVG()</strong>: Calculates the cumulative average of a column's values within a partition.</p>
<pre><code class="language-sql">SELECT 
    column1,
    AVG(column4) OVER (PARTITION BY column2 ORDER BY column3) AS cumulative_avg
FROM 
    table_name;
</code></pre>
</li>
</ol>
</div><h2>Practical Examples</h2>
<div class='content'></div><h3>Example 1: Using ROW_NUMBER()</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgZW1wbG95ZWVfaWQsCiAgICBkZXBhcnRtZW50X2lkLAogICAgc2FsYXJ5LAogICAgUk9XX05VTUJFUigpIE9WRVIgKFBBUlRJVElPTiBCWSBkZXBhcnRtZW50X2lkIE9SREVSIEJZIHNhbGFyeSBERVNDKSBBUyByb3dfbnVtCkZST00gCiAgICBlbXBsb3llZXM7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    employee_id,
    department_id,
    salary,
    ROW_NUMBER() OVER (PARTITION BY department_id ORDER BY salary DESC) AS row_num
FROM 
    employees;</pre></div><div class='content'><p><strong>Explanation</strong>: This query assigns a unique row number to each employee within their department, ordered by salary in descending order.</p>
</div><h3>Example 2: Using RANK()</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgZW1wbG95ZWVfaWQsCiAgICBkZXBhcnRtZW50X2lkLAogICAgc2FsYXJ5LAogICAgUkFOSygpIE9WRVIgKFBBUlRJVElPTiBCWSBkZXBhcnRtZW50X2lkIE9SREVSIEJZIHNhbGFyeSBERVNDKSBBUyByYW5rCkZST00gCiAgICBlbXBsb3llZXM7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    employee_id,
    department_id,
    salary,
    RANK() OVER (PARTITION BY department_id ORDER BY salary DESC) AS rank
FROM 
    employees;</pre></div><div class='content'><p><strong>Explanation</strong>: This query ranks employees within their department based on their salary. Employees with the same salary receive the same rank, and the next rank is skipped.</p>
</div><h3>Example 3: Using SUM()</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgZW1wbG95ZWVfaWQsCiAgICBkZXBhcnRtZW50X2lkLAogICAgc2FsYXJ5LAogICAgU1VNKHNhbGFyeSkgT1ZFUiAoUEFSVElUSU9OIEJZIGRlcGFydG1lbnRfaWQgT1JERVIgQlkgZW1wbG95ZWVfaWQpIEFTIGN1bXVsYXRpdmVfc2FsYXJ5CkZST00gCiAgICBlbXBsb3llZXM7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    employee_id,
    department_id,
    salary,
    SUM(salary) OVER (PARTITION BY department_id ORDER BY employee_id) AS cumulative_salary
FROM 
    employees;</pre></div><div class='content'><p><strong>Explanation</strong>: This query calculates the cumulative salary for each employee within their department, ordered by employee ID.</p>
</div><h2>Exercises</h2>
<div class='content'></div><h3>Exercise 1: Calculate Row Numbers</h3>
<div class='content'><p><strong>Task</strong>: Write a query to assign row numbers to each product within its category, ordered by price in ascending order.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgcHJvZHVjdF9pZCwKICAgIGNhdGVnb3J5X2lkLAogICAgcHJpY2UsCiAgICBST1dfTlVNQkVSKCkgT1ZFUiAoUEFSVElUSU9OIEJZIGNhdGVnb3J5X2lkIE9SREVSIEJZIHByaWNlIEFTQykgQVMgcm93X251bQpGUk9NIAogICAgcHJvZHVjdHM7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    product_id,
    category_id,
    price,
    ROW_NUMBER() OVER (PARTITION BY category_id ORDER BY price ASC) AS row_num
FROM 
    products;</pre></div><div class='content'></div><h3>Exercise 2: Rank Employees by Performance</h3>
<div class='content'><p><strong>Task</strong>: Write a query to rank employees within their department based on their performance score. Handle ties by assigning the same rank to employees with the same score.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgZW1wbG95ZWVfaWQsCiAgICBkZXBhcnRtZW50X2lkLAogICAgcGVyZm9ybWFuY2Vfc2NvcmUsCiAgICBSQU5LKCkgT1ZFUiAoUEFSVElUSU9OIEJZIGRlcGFydG1lbnRfaWQgT1JERVIgQlkgcGVyZm9ybWFuY2Vfc2NvcmUgREVTQykgQVMgcmFuawpGUk9NIAogICAgZW1wbG95ZWVzOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    employee_id,
    department_id,
    performance_score,
    RANK() OVER (PARTITION BY department_id ORDER BY performance_score DESC) AS rank
FROM 
    employees;</pre></div><div class='content'></div><h3>Exercise 3: Calculate Cumulative Sales</h3>
<div class='content'><p><strong>Task</strong>: Write a query to calculate the cumulative sales for each salesperson within their region, ordered by the date of sale.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgc2FsZXNwZXJzb25faWQsCiAgICByZWdpb25faWQsCiAgICBzYWxlX2RhdGUsCiAgICBzYWxlX2Ftb3VudCwKICAgIFNVTShzYWxlX2Ftb3VudCkgT1ZFUiAoUEFSVElUSU9OIEJZIHJlZ2lvbl9pZCBPUkRFUiBCWSBzYWxlX2RhdGUpIEFTIGN1bXVsYXRpdmVfc2FsZXMKRlJPTSAKICAgIHNhbGVzOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    salesperson_id,
    region_id,
    sale_date,
    sale_amount,
    SUM(sale_amount) OVER (PARTITION BY region_id ORDER BY sale_date) AS cumulative_sales
FROM 
    sales;</pre></div><div class='content'></div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Incorrect Partitioning</strong>: Ensure that the <code>PARTITION BY</code> clause correctly defines the logical groups for your calculation.</li>
<li><strong>Ordering Issues</strong>: The <code>ORDER BY</code> clause within the <code>OVER</code> clause is crucial for functions like <code>ROW_NUMBER()</code> and <code>RANK()</code>. Ensure it reflects the desired order.</li>
<li><strong>Frame Clause Misuse</strong>: Be cautious with the frame clause. The default is <code>RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</code>, which might not always be what you need.</li>
</ul>
</div><h2>Conclusion</h2>
<div class='content'><p>Window functions are a versatile tool in SQL that allow for complex calculations over partitions of data. By understanding and utilizing window functions, you can perform advanced data analysis and reporting tasks with ease. In the next module, we will delve into database design principles, which will help you structure your databases efficiently and effectively.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='03-03-aggregate-functions' title="Aggregate Functions" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='03-03-aggregate-functions' title="Aggregate Functions" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='03-05-common-table-expressions' title="Common Table Expressions (CTEs)" class="py-2 px-3 btn btn-primary"
				data-read-mod="postgresql" data-read-unit="3-4">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='03-05-common-table-expressions' title="Common Table Expressions (CTEs)" class="py-2 px-3 btn btn-primary" 
				data-read-mod="postgresql" data-read-unit="3-4">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>PostgreSQL Course</h1>
<h2>Module 1: Introduction to PostgreSQL</h2>
<ul>
<li><a href="01-01-what-is-postgresql">What is PostgreSQL?</a></li>
<li><a href="01-02-installing-postgresql">Installing PostgreSQL</a></li>
<li><a href="01-03-basic-sql-concepts">Basic SQL Concepts</a></li>
<li><a href="01-04-connecting-to-postgresql">Connecting to PostgreSQL</a></li>
</ul>
<h2>Module 2: Basic SQL Operations</h2>
<ul>
<li><a href="02-01-creating-databases-and-tables">Creating Databases and Tables</a></li>
<li><a href="02-02-inserting-data">Inserting Data</a></li>
<li><a href="02-03-querying-data">Querying Data</a></li>
<li><a href="02-04-updating-data">Updating Data</a></li>
<li><a href="02-05-deleting-data">Deleting Data</a></li>
</ul>
<h2>Module 3: Advanced SQL Queries</h2>
<ul>
<li><a href="03-01-joins">Joins</a></li>
<li><a href="03-02-subqueries">Subqueries</a></li>
<li><a href="03-03-aggregate-functions">Aggregate Functions</a></li>
<li><a href="03-04-window-functions">Window Functions</a></li>
<li><a href="03-05-common-table-expressions">Common Table Expressions (CTEs)</a></li>
</ul>
<h2>Module 4: Database Design and Normalization</h2>
<ul>
<li><a href="04-01-database-design-principles">Database Design Principles</a></li>
<li><a href="04-02-normalization">Normalization</a></li>
<li><a href="04-03-primary-and-foreign-keys">Primary and Foreign Keys</a></li>
<li><a href="04-04-indexes">Indexes</a></li>
</ul>
<h2>Module 5: Advanced PostgreSQL Features</h2>
<ul>
<li><a href="05-01-views">Views</a></li>
<li><a href="05-02-triggers">Triggers</a></li>
<li><a href="05-03-stored-procedures-and-functions">Stored Procedures and Functions</a></li>
<li><a href="05-04-transactions-and-concurrency">Transactions and Concurrency</a></li>
</ul>
<h2>Module 6: Performance Tuning and Optimization</h2>
<ul>
<li><a href="06-01-query-optimization">Query Optimization</a></li>
<li><a href="06-02-indexing-strategies">Indexing Strategies</a></li>
<li><a href="06-03-analyzing-query-performance">Analyzing Query Performance</a></li>
<li><a href="06-04-vacuuming-and-maintenance">Vacuuming and Maintenance</a></li>
</ul>
<h2>Module 7: Security and User Management</h2>
<ul>
<li><a href="07-01-user-roles-and-permissions">User Roles and Permissions</a></li>
<li><a href="07-02-authentication-methods">Authentication Methods</a></li>
<li><a href="07-03-data-encryption">Data Encryption</a></li>
<li><a href="07-04-backup-and-restore">Backup and Restore</a></li>
</ul>
<h2>Module 8: Working with JSON and NoSQL Features</h2>
<ul>
<li><a href="08-01-json-data-types">JSON Data Types</a></li>
<li><a href="08-02-json-functions-and-operators">JSON Functions and Operators</a></li>
<li><a href="08-03-using-postgresql-as-nosql">Using PostgreSQL as a NoSQL Database</a></li>
</ul>
<h2>Module 9: Extensions and Advanced Tools</h2>
<ul>
<li><a href="09-01-postgis-for-geospatial-data">PostGIS for Geospatial Data</a></li>
<li><a href="09-02-full-text-search">Full-Text Search</a></li>
<li><a href="09-03-foreign-data-wrappers">Foreign Data Wrappers</a></li>
<li><a href="09-04-plpgsql-and-other-procedural-languages">PL/pgSQL and Other Procedural Languages</a></li>
</ul>
<h2>Module 10: Case Studies and Real-World Applications</h2>
<ul>
<li><a href="10-01-e-commerce-database-design">E-commerce Database Design</a></li>
<li><a href="10-02-data-warehousing-with-postgresql">Data Warehousing with PostgreSQL</a></li>
<li><a href="10-03-handling-big-data">Handling Big Data</a></li>
<li><a href="10-04-postgresql-in-microservices-architecture">PostgreSQL in Microservices Architecture</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
