<!DOCTYPE html>
<html lang="en">
<head>
    <title> Transactions and Concurrency </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, nofollow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/mod/postgresql/05-04-transactions-and-concurrency" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/postgresql/05-04-transactions-and-concurrency" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/postgresql/05-04-transactions-and-concurrency" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.ea63f62b9e.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "languages";
  		var MOD_NAME = "postgresql";
  		var TEMA_NAME = "5-4";
  		var TYPE = "mod";
  		var PATH = "mod/postgresql/05-04-transactions-and-concurrency";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/postgresql/05-04-transactions-and-concurrency" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/postgresql/05-04-transactions-and-concurrency" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="postgresql">
		<a  href="#" class="text-secondary d-none" data-read-mod="postgresql" data-read-unit="5-4" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="postgresql" data-unread-unit="5-4" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='05-03-stored-procedures-and-functions' title="Stored Procedures and Functions" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='05-03-stored-procedures-and-functions' title="Stored Procedures and Functions" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h2 style="text-decoration:underline">Transactions and Concurrency</h2>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='06-01-query-optimization' title="Query Optimization" class="py-2 px-3 btn btn-primary"
				data-read-mod="postgresql" data-read-unit="5-4">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='06-01-query-optimization' title="Query Optimization" class="py-2 px-3 btn btn-primary" 
				data-read-mod="postgresql" data-read-unit="5-4">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into the concepts of transactions and concurrency in PostgreSQL. Understanding these concepts is crucial for ensuring data integrity and performance in multi-user environments.</p>
</div><h1>What is a Transaction?</h1>
<div class='content'><p>A transaction is a sequence of one or more SQL operations treated as a single unit of work. Transactions ensure that either all operations within the transaction are completed successfully, or none are. This is known as the ACID properties:</p>
<ol>
<li><strong>Atomicity</strong>: Ensures that all operations within the transaction are completed; if not, the transaction is aborted.</li>
<li><strong>Consistency</strong>: Ensures that the database remains in a consistent state before and after the transaction.</li>
<li><strong>Isolation</strong>: Ensures that transactions are isolated from each other until they are completed.</li>
<li><strong>Durability</strong>: Ensures that once a transaction is committed, it remains so, even in the event of a system failure.</li>
</ol>
</div><h2>Starting and Ending Transactions</h2>
<div class='content'><p>In PostgreSQL, transactions are managed using the following commands:</p>
<ul>
<li><code>BEGIN</code>: Starts a new transaction.</li>
<li><code>COMMIT</code>: Ends the current transaction and makes all changes permanent.</li>
<li><code>ROLLBACK</code>: Ends the current transaction and undoes all changes.</li>
</ul>
</div><h2>Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkVHSU47CgpJTlNFUlQgSU5UTyBhY2NvdW50cyAodXNlcl9pZCwgYmFsYW5jZSkgVkFMVUVTICgxLCAxMDAwKTsKVVBEQVRFIGFjY291bnRzIFNFVCBiYWxhbmNlID0gYmFsYW5jZSAtIDEwMCBXSEVSRSB1c2VyX2lkID0gMTsKVVBEQVRFIGFjY291bnRzIFNFVCBiYWxhbmNlID0gYmFsYW5jZSArIDEwMCBXSEVSRSB1c2VyX2lkID0gMjsKCkNPTU1JVDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BEGIN;

INSERT INTO accounts (user_id, balance) VALUES (1, 1000);
UPDATE accounts SET balance = balance - 100 WHERE user_id = 1;
UPDATE accounts SET balance = balance + 100 WHERE user_id = 2;

COMMIT;</pre></div><div class='content'><p>In this example:</p>
<ul>
<li>The transaction starts with <code>BEGIN</code>.</li>
<li>Several operations are performed.</li>
<li>The transaction is committed with <code>COMMIT</code>, making all changes permanent.</li>
</ul>
<p>If any operation fails, you can use <code>ROLLBACK</code> to undo all changes:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkVHSU47CgpJTlNFUlQgSU5UTyBhY2NvdW50cyAodXNlcl9pZCwgYmFsYW5jZSkgVkFMVUVTICgxLCAxMDAwKTsKVVBEQVRFIGFjY291bnRzIFNFVCBiYWxhbmNlID0gYmFsYW5jZSAtIDEwMCBXSEVSRSB1c2VyX2lkID0gMTsKVVBEQVRFIGFjY291bnRzIFNFVCBiYWxhbmNlID0gYmFsYW5jZSArIDEwMCBXSEVSRSB1c2VyX2lkID0gMjsKClJPTExCQUNLOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BEGIN;

INSERT INTO accounts (user_id, balance) VALUES (1, 1000);
UPDATE accounts SET balance = balance - 100 WHERE user_id = 1;
UPDATE accounts SET balance = balance + 100 WHERE user_id = 2;

ROLLBACK;</pre></div><div class='content'></div><h1>Concurrency Control</h1>
<div class='content'><p>Concurrency control is the management of simultaneous operations on the database without conflicting. PostgreSQL uses several mechanisms to handle concurrency:</p>
</div><h2>Isolation Levels</h2>
<div class='content'><p>PostgreSQL supports four isolation levels:</p>
<ol>
<li><strong>Read Uncommitted</strong>: Transactions can read uncommitted changes made by other transactions.</li>
<li><strong>Read Committed</strong>: Transactions can only read committed changes made by other transactions.</li>
<li><strong>Repeatable Read</strong>: Ensures that if a transaction reads a row, it will see the same data if it reads that row again.</li>
<li><strong>Serializable</strong>: Ensures that transactions are executed in a way that they could have been executed serially.</li>
</ol>
</div><h2>Setting Isolation Levels</h2>
<div class='content'><p>You can set the isolation level for a transaction using the <code>SET TRANSACTION</code> command:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkVHSU47ClNFVCBUUkFOU0FDVElPTiBJU09MQVRJT04gTEVWRUwgU0VSSUFMSVpBQkxFOwoKLS0gWW91ciBTUUwgb3BlcmF0aW9ucyBoZXJlCgpDT01NSVQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BEGIN;
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;

-- Your SQL operations here

COMMIT;</pre></div><div class='content'></div><h2>Locking Mechanisms</h2>
<div class='content'><p>PostgreSQL uses locks to manage concurrent access to data:</p>
<ul>
<li><strong>Row-level locks</strong>: Lock individual rows.</li>
<li><strong>Table-level locks</strong>: Lock entire tables.</li>
</ul>
</div><h2>Example of Row-Level Locking</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkVHSU47CgpTRUxFQ1QgKiBGUk9NIGFjY291bnRzIFdIRVJFIHVzZXJfaWQgPSAxIEZPUiBVUERBVEU7CgotLSBQZXJmb3JtIG9wZXJhdGlvbnMgb24gdGhlIHNlbGVjdGVkIHJvdwoKQ09NTUlUOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BEGIN;

SELECT * FROM accounts WHERE user_id = 1 FOR UPDATE;

-- Perform operations on the selected row

COMMIT;</pre></div><div class='content'><p>In this example, the <code>FOR UPDATE</code> clause locks the selected row, preventing other transactions from modifying it until the current transaction is committed.</p>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise 1: Implementing a Transaction</h2>
<div class='content'><ol>
<li>Start a new transaction.</li>
<li>Insert a new record into a table.</li>
<li>Update another record in the same table.</li>
<li>Commit the transaction.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkVHSU47CgpJTlNFUlQgSU5UTyBwcm9kdWN0cyAocHJvZHVjdF9pZCwgbmFtZSwgcHJpY2UpIFZBTFVFUyAoMTAxLCAnTGFwdG9wJywgMTUwMCk7ClVQREFURSBwcm9kdWN0cyBTRVQgcHJpY2UgPSBwcmljZSAtIDEwMCBXSEVSRSBwcm9kdWN0X2lkID0gMTAyOwoKQ09NTUlUOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BEGIN;

INSERT INTO products (product_id, name, price) VALUES (101, 'Laptop', 1500);
UPDATE products SET price = price - 100 WHERE product_id = 102;

COMMIT;</pre></div><div class='content'></div><h2>Exercise 2: Handling Concurrency</h2>
<div class='content'><ol>
<li>Start a new transaction.</li>
<li>Select a row for update.</li>
<li>Update the selected row.</li>
<li>Commit the transaction.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkVHSU47CgpTRUxFQ1QgKiBGUk9NIHByb2R1Y3RzIFdIRVJFIHByb2R1Y3RfaWQgPSAxMDEgRk9SIFVQREFURTsKVVBEQVRFIHByb2R1Y3RzIFNFVCBwcmljZSA9IHByaWNlICsgNTAgV0hFUkUgcHJvZHVjdF9pZCA9IDEwMTsKCkNPTU1JVDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BEGIN;

SELECT * FROM products WHERE product_id = 101 FOR UPDATE;
UPDATE products SET price = price + 50 WHERE product_id = 101;

COMMIT;</pre></div><div class='content'></div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Forgetting to Commit or Rollback</strong>: Always ensure that you end your transactions with either <code>COMMIT</code> or <code>ROLLBACK</code>.</li>
<li><strong>Deadlocks</strong>: Be aware of potential deadlocks when multiple transactions are trying to lock the same resources. Use appropriate isolation levels and locking mechanisms to avoid them.</li>
<li><strong>Choosing the Right Isolation Level</strong>: Higher isolation levels provide more consistency but can reduce concurrency. Choose the appropriate level based on your application's requirements.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the basics of transactions and concurrency in PostgreSQL. We learned about the ACID properties, how to start and end transactions, and how to manage concurrency using isolation levels and locking mechanisms. Understanding these concepts is essential for maintaining data integrity and performance in multi-user environments. In the next module, we will explore performance tuning and optimization techniques to further enhance your PostgreSQL skills.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='05-03-stored-procedures-and-functions' title="Stored Procedures and Functions" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='05-03-stored-procedures-and-functions' title="Stored Procedures and Functions" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='06-01-query-optimization' title="Query Optimization" class="py-2 px-3 btn btn-primary"
				data-read-mod="postgresql" data-read-unit="5-4">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='06-01-query-optimization' title="Query Optimization" class="py-2 px-3 btn btn-primary" 
				data-read-mod="postgresql" data-read-unit="5-4">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>PostgreSQL Course</h1>
<h2>Module 1: Introduction to PostgreSQL</h2>
<ul>
<li><a href="01-01-what-is-postgresql">What is PostgreSQL?</a></li>
<li><a href="01-02-installing-postgresql">Installing PostgreSQL</a></li>
<li><a href="01-03-basic-sql-concepts">Basic SQL Concepts</a></li>
<li><a href="01-04-connecting-to-postgresql">Connecting to PostgreSQL</a></li>
</ul>
<h2>Module 2: Basic SQL Operations</h2>
<ul>
<li><a href="02-01-creating-databases-and-tables">Creating Databases and Tables</a></li>
<li><a href="02-02-inserting-data">Inserting Data</a></li>
<li><a href="02-03-querying-data">Querying Data</a></li>
<li><a href="02-04-updating-data">Updating Data</a></li>
<li><a href="02-05-deleting-data">Deleting Data</a></li>
</ul>
<h2>Module 3: Advanced SQL Queries</h2>
<ul>
<li><a href="03-01-joins">Joins</a></li>
<li><a href="03-02-subqueries">Subqueries</a></li>
<li><a href="03-03-aggregate-functions">Aggregate Functions</a></li>
<li><a href="03-04-window-functions">Window Functions</a></li>
<li><a href="03-05-common-table-expressions">Common Table Expressions (CTEs)</a></li>
</ul>
<h2>Module 4: Database Design and Normalization</h2>
<ul>
<li><a href="04-01-database-design-principles">Database Design Principles</a></li>
<li><a href="04-02-normalization">Normalization</a></li>
<li><a href="04-03-primary-and-foreign-keys">Primary and Foreign Keys</a></li>
<li><a href="04-04-indexes">Indexes</a></li>
</ul>
<h2>Module 5: Advanced PostgreSQL Features</h2>
<ul>
<li><a href="05-01-views">Views</a></li>
<li><a href="05-02-triggers">Triggers</a></li>
<li><a href="05-03-stored-procedures-and-functions">Stored Procedures and Functions</a></li>
<li><a href="05-04-transactions-and-concurrency">Transactions and Concurrency</a></li>
</ul>
<h2>Module 6: Performance Tuning and Optimization</h2>
<ul>
<li><a href="06-01-query-optimization">Query Optimization</a></li>
<li><a href="06-02-indexing-strategies">Indexing Strategies</a></li>
<li><a href="06-03-analyzing-query-performance">Analyzing Query Performance</a></li>
<li><a href="06-04-vacuuming-and-maintenance">Vacuuming and Maintenance</a></li>
</ul>
<h2>Module 7: Security and User Management</h2>
<ul>
<li><a href="07-01-user-roles-and-permissions">User Roles and Permissions</a></li>
<li><a href="07-02-authentication-methods">Authentication Methods</a></li>
<li><a href="07-03-data-encryption">Data Encryption</a></li>
<li><a href="07-04-backup-and-restore">Backup and Restore</a></li>
</ul>
<h2>Module 8: Working with JSON and NoSQL Features</h2>
<ul>
<li><a href="08-01-json-data-types">JSON Data Types</a></li>
<li><a href="08-02-json-functions-and-operators">JSON Functions and Operators</a></li>
<li><a href="08-03-using-postgresql-as-nosql">Using PostgreSQL as a NoSQL Database</a></li>
</ul>
<h2>Module 9: Extensions and Advanced Tools</h2>
<ul>
<li><a href="09-01-postgis-for-geospatial-data">PostGIS for Geospatial Data</a></li>
<li><a href="09-02-full-text-search">Full-Text Search</a></li>
<li><a href="09-03-foreign-data-wrappers">Foreign Data Wrappers</a></li>
<li><a href="09-04-plpgsql-and-other-procedural-languages">PL/pgSQL and Other Procedural Languages</a></li>
</ul>
<h2>Module 10: Case Studies and Real-World Applications</h2>
<ul>
<li><a href="10-01-e-commerce-database-design">E-commerce Database Design</a></li>
<li><a href="10-02-data-warehousing-with-postgresql">Data Warehousing with PostgreSQL</a></li>
<li><a href="10-03-handling-big-data">Handling Big Data</a></li>
<li><a href="10-04-postgresql-in-microservices-architecture">PostgreSQL in Microservices Architecture</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
