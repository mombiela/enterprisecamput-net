<!DOCTYPE html>
<html lang="en">
<head>
    <title> User-Defined Functions (UDFs) </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, nofollow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/bigquery/04-03-user-defined-functions" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/bigquery/04-03-user-defined-functions" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/bigquery/04-03-user-defined-functions" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.ea63f62b9e.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "bigquery";
  		var TEMA_NAME = "4-3";
  		var TYPE = "mod";
  		var PATH = "mod/bigquery/04-03-user-defined-functions";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/bigquery/04-03-user-defined-functions" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/bigquery/04-03-user-defined-functions" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="bigquery">
		<a  href="#" class="text-secondary d-none" data-read-mod="bigquery" data-read-unit="4-3" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="bigquery" data-unread-unit="4-3" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='04-02-nested-repeated-fields' title="Nested and Repeated Fields" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='04-02-nested-repeated-fields' title="Nested and Repeated Fields" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h2 style="text-decoration:underline">User-Defined Functions (UDFs)</h2>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='04-04-partitioning-clustering' title="Partitioning and Clustering" class="py-2 px-3 btn btn-primary"
				data-read-mod="bigquery" data-read-unit="4-3">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='04-04-partitioning-clustering' title="Partitioning and Clustering" class="py-2 px-3 btn btn-primary" 
				data-read-mod="bigquery" data-read-unit="4-3">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>User-Defined Functions (UDFs) in BigQuery allow you to extend the capabilities of SQL by writing custom functions using JavaScript or SQL. UDFs can be used to encapsulate complex logic, perform transformations, and reuse code across multiple queries.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li>
<p><strong>Types of UDFs</strong>:</p>
<ul>
<li><strong>SQL UDFs</strong>: Written in SQL, these functions allow you to encapsulate SQL logic.</li>
<li><strong>JavaScript UDFs</strong>: Written in JavaScript, these functions provide more flexibility and can handle more complex logic.</li>
</ul>
</li>
<li>
<p><strong>Creating UDFs</strong>:</p>
<ul>
<li><strong>SQL UDFs</strong>: Defined using the <code>CREATE FUNCTION</code> statement.</li>
<li><strong>JavaScript UDFs</strong>: Defined using the <code>CREATE FUNCTION</code> statement with JavaScript code embedded.</li>
</ul>
</li>
<li>
<p><strong>Using UDFs</strong>:</p>
<ul>
<li>UDFs can be called in SQL queries just like built-in functions.</li>
<li>They can accept parameters and return values.</li>
</ul>
</li>
</ol>
</div><h1>Creating SQL UDFs</h1>
<div class='content'></div><h2>Example: Simple SQL UDF</h2>
<div class='content'><p>Let's create a simple SQL UDF that calculates the square of a number.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIG15X3Byb2plY3QubXlfZGF0YXNldC5zcXVhcmUoeCBJTlQ2NCkgClJFVFVSTlMgSU5UNjQgCkFTICgKICB4ICogeAopOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION my_project.my_dataset.square(x INT64) 
RETURNS INT64 
AS (
  x * x
);</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><code>CREATE FUNCTION my_project.my_dataset.square(x INT64)</code>: Defines a new function named <code>square</code> in the specified project and dataset. The function takes an integer parameter <code>x</code>.</li>
<li><code>RETURNS INT64</code>: Specifies that the function returns an integer.</li>
<li><code>AS (x * x)</code>: The function body, which calculates the square of <code>x</code>.</li>
</ul>
</div><h2>Using the SQL UDF</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIG15X3Byb2plY3QubXlfZGF0YXNldC5zcXVhcmUoNCkgQVMgcmVzdWx0Ow=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT my_project.my_dataset.square(4) AS result;</pre></div><div class='content'></div><h2>Output</h2>
<div class='content'><table>
<thead>
<tr>
<th>result</th>
</tr>
</thead>
<tbody>
<tr>
<td>16</td>
</tr>
</tbody>
</table>
</div><h1>Creating JavaScript UDFs</h1>
<div class='content'></div><h2>Example: JavaScript UDF</h2>
<div class='content'><p>Let's create a JavaScript UDF that reverses a string.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIG15X3Byb2plY3QubXlfZGF0YXNldC5yZXZlcnNlX3N0cmluZyhpbnB1dCBTVFJJTkcpIApSRVRVUk5TIFNUUklORyAKTEFOR1VBR0UganMgCkFTICIiIgogIHJldHVybiBpbnB1dC5zcGxpdCgnJykucmV2ZXJzZSgpLmpvaW4oJycpOwoiIiI7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION my_project.my_dataset.reverse_string(input STRING) 
RETURNS STRING 
LANGUAGE js 
AS &quot;&quot;&quot;
  return input.split('').reverse().join('');
&quot;&quot;&quot;;</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><code>CREATE FUNCTION my_project.my_dataset.reverse_string(input STRING)</code>: Defines a new function named <code>reverse_string</code> in the specified project and dataset. The function takes a string parameter <code>input</code>.</li>
<li><code>RETURNS STRING</code>: Specifies that the function returns a string.</li>
<li><code>LANGUAGE js</code>: Indicates that the function is written in JavaScript.</li>
<li><code>AS &quot;&quot;&quot; ... &quot;&quot;&quot;</code>: The function body, which contains JavaScript code to reverse the input string.</li>
</ul>
</div><h2>Using the JavaScript UDF</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIG15X3Byb2plY3QubXlfZGF0YXNldC5yZXZlcnNlX3N0cmluZygnQmlnUXVlcnknKSBBUyByZXN1bHQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT my_project.my_dataset.reverse_string('BigQuery') AS result;</pre></div><div class='content'></div><h2>Output</h2>
<div class='content'><table>
<thead>
<tr>
<th>result</th>
</tr>
</thead>
<tbody>
<tr>
<td>yreuQgiB</td>
</tr>
</tbody>
</table>
</div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Create a SQL UDF</h2>
<div class='content'><p><strong>Task</strong>: Create a SQL UDF named <code>cube</code> that calculates the cube of a number.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIG15X3Byb2plY3QubXlfZGF0YXNldC5jdWJlKHggSU5UNjQpIApSRVRVUk5TIElOVDY0IApBUyAoCiAgeCAqIHggKiB4Cik7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION my_project.my_dataset.cube(x INT64) 
RETURNS INT64 
AS (
  x * x * x
);</pre></div><div class='content'><p><strong>Test the UDF</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIG15X3Byb2plY3QubXlfZGF0YXNldC5jdWJlKDMpIEFTIHJlc3VsdDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT my_project.my_dataset.cube(3) AS result;</pre></div><div class='content'><p><strong>Expected Output</strong>:</p>
<table>
<thead>
<tr>
<th>result</th>
</tr>
</thead>
<tbody>
<tr>
<td>27</td>
</tr>
</tbody>
</table>
</div><h2>Exercise 2: Create a JavaScript UDF</h2>
<div class='content'><p><strong>Task</strong>: Create a JavaScript UDF named <code>to_uppercase</code> that converts a string to uppercase.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIG15X3Byb2plY3QubXlfZGF0YXNldC50b191cHBlcmNhc2UoaW5wdXQgU1RSSU5HKSAKUkVUVVJOUyBTVFJJTkcgCkxBTkdVQUdFIGpzIApBUyAiIiIKICByZXR1cm4gaW5wdXQudG9VcHBlckNhc2UoKTsKIiIiOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION my_project.my_dataset.to_uppercase(input STRING) 
RETURNS STRING 
LANGUAGE js 
AS &quot;&quot;&quot;
  return input.toUpperCase();
&quot;&quot;&quot;;</pre></div><div class='content'><p><strong>Test the UDF</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIG15X3Byb2plY3QubXlfZGF0YXNldC50b191cHBlcmNhc2UoJ2JpZ3F1ZXJ5JykgQVMgcmVzdWx0Ow=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT my_project.my_dataset.to_uppercase('bigquery') AS result;</pre></div><div class='content'><p><strong>Expected Output</strong>:</p>
<table>
<thead>
<tr>
<th>result</th>
</tr>
</thead>
<tbody>
<tr>
<td>BIGQUERY</td>
</tr>
</tbody>
</table>
</div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Syntax Errors</strong>: Ensure that the SQL or JavaScript syntax is correct. Use the appropriate language keywords and structure.</li>
<li><strong>Parameter Types</strong>: Make sure the parameter types match the expected input types.</li>
<li><strong>Return Types</strong>: Ensure the return type of the UDF matches the expected output type.</li>
<li><strong>Testing</strong>: Always test your UDFs with various inputs to ensure they work as expected.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>User-Defined Functions (UDFs) in BigQuery provide a powerful way to extend SQL capabilities by encapsulating complex logic in reusable functions. By understanding how to create and use both SQL and JavaScript UDFs, you can enhance your data processing and analysis workflows in BigQuery. In the next section, we will explore partitioning and clustering to optimize query performance.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='04-02-nested-repeated-fields' title="Nested and Repeated Fields" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='04-02-nested-repeated-fields' title="Nested and Repeated Fields" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='04-04-partitioning-clustering' title="Partitioning and Clustering" class="py-2 px-3 btn btn-primary"
				data-read-mod="bigquery" data-read-unit="4-3">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='04-04-partitioning-clustering' title="Partitioning and Clustering" class="py-2 px-3 btn btn-primary" 
				data-read-mod="bigquery" data-read-unit="4-3">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>BigQuery Course</h1>
<h2>Module 1: Introduction to BigQuery</h2>
<ul>
<li><a href="01-01-what-is-bigquery">What is BigQuery?</a></li>
<li><a href="01-02-setting-up-environment">Setting Up Your BigQuery Environment</a></li>
<li><a href="01-03-understanding-architecture">Understanding BigQuery Architecture</a></li>
<li><a href="01-04-console-overview">BigQuery Console Overview</a></li>
</ul>
<h2>Module 2: Basic SQL in BigQuery</h2>
<ul>
<li><a href="02-01-introduction-to-sql">Introduction to SQL</a></li>
<li><a href="02-02-basic-sql-queries">Basic SQL Queries</a></li>
<li><a href="02-03-filtering-sorting-data">Filtering and Sorting Data</a></li>
<li><a href="02-04-aggregating-data">Aggregating Data</a></li>
</ul>
<h2>Module 3: Intermediate SQL in BigQuery</h2>
<ul>
<li><a href="03-01-joins-unions">Joins and Unions</a></li>
<li><a href="03-02-subqueries">Subqueries</a></li>
<li><a href="03-03-common-table-expressions">Common Table Expressions (CTEs)</a></li>
<li><a href="03-04-window-functions">Window Functions</a></li>
</ul>
<h2>Module 4: Advanced SQL in BigQuery</h2>
<ul>
<li><a href="04-01-advanced-joins">Advanced Joins</a></li>
<li><a href="04-02-nested-repeated-fields">Nested and Repeated Fields</a></li>
<li><a href="04-03-user-defined-functions">User-Defined Functions (UDFs)</a></li>
<li><a href="04-04-partitioning-clustering">Partitioning and Clustering</a></li>
</ul>
<h2>Module 5: BigQuery Data Management</h2>
<ul>
<li><a href="05-01-loading-data">Loading Data into BigQuery</a></li>
<li><a href="05-02-exporting-data">Exporting Data from BigQuery</a></li>
<li><a href="05-03-data-transformation-cleaning">Data Transformation and Cleaning</a></li>
<li><a href="05-04-managing-datasets-tables">Managing Datasets and Tables</a></li>
</ul>
<h2>Module 6: BigQuery Performance Optimization</h2>
<ul>
<li><a href="06-01-query-optimization-techniques">Query Optimization Techniques</a></li>
<li><a href="06-02-query-execution-plans">Understanding Query Execution Plans</a></li>
<li><a href="06-03-using-materialized-views">Using Materialized Views</a></li>
<li><a href="06-04-optimizing-storage">Optimizing Storage</a></li>
</ul>
<h2>Module 7: BigQuery Security and Compliance</h2>
<ul>
<li><a href="07-01-access-control-permissions">Access Control and Permissions</a></li>
<li><a href="07-02-data-encryption">Data Encryption</a></li>
<li><a href="07-03-auditing-monitoring">Auditing and Monitoring</a></li>
<li><a href="07-04-compliance-best-practices">Compliance and Best Practices</a></li>
</ul>
<h2>Module 8: BigQuery Integration and Automation</h2>
<ul>
<li><a href="08-01-integrating-google-cloud">Integrating with Google Cloud Services</a></li>
<li><a href="08-02-using-dataflow">Using BigQuery with Dataflow</a></li>
<li><a href="08-03-automating-workflows">Automating Workflows with Cloud Functions</a></li>
<li><a href="08-04-scheduling-queries">Scheduling Queries with Cloud Scheduler</a></li>
</ul>
<h2>Module 9: BigQuery Machine Learning (BQML)</h2>
<ul>
<li><a href="09-01-introduction-bqml">Introduction to BigQuery ML</a></li>
<li><a href="09-02-creating-training-models">Creating and Training Models</a></li>
<li><a href="09-03-evaluating-predicting-models">Evaluating and Predicting with Models</a></li>
<li><a href="09-04-advanced-bqml-features">Advanced BQML Features</a></li>
</ul>
<h2>Module 10: Real-World BigQuery Use Cases</h2>
<ul>
<li><a href="10-01-analyzing-web-app-analytics">Analyzing Web and App Analytics</a></li>
<li><a href="10-02-financial-data-analysis">Financial Data Analysis</a></li>
<li><a href="10-03-iot-data-processing">IoT Data Processing</a></li>
<li><a href="10-04-building-dashboards-data-studio">Building Dashboards with Data Studio</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
