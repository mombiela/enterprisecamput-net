<!DOCTYPE html>
<html lang="en">
<head>
    <title> LSTM and GRU </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/deep-learning/04-02-lstm-gru" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/deep-learning/04-02-lstm-gru" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/deep-learning/04-02-lstm-gru" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.188a386f47.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "foundations";
  		var MOD_NAME = "deep_learning";
  		var TEMA_NAME = "4-2";
  		var TYPE = "mod";
  		var PATH = "mod/deep_learning/04-02-lstm-gru";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/deep-learning/04-02-lstm-gru" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/deep-learning/04-02-lstm-gru" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="deep_learning">
		<a  href="#" class="text-secondary d-none" data-read-mod="deep_learning" data-read-unit="4-2" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="deep_learning" data-unread-unit="4-2" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='04-01-introduction-rnn' title="Introduction to RNN" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='04-01-introduction-rnn' title="Introduction to RNN" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">LSTM and GRU</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='04-03-rnn-applications-nlp' title="RNN Applications in Natural Language Processing" class="py-2 px-3 btn btn-primary"
				data-read-mod="deep_learning" data-read-unit="4-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='04-03-rnn-applications-nlp' title="RNN Applications in Natural Language Processing" class="py-2 px-3 btn btn-primary" 
				data-read-mod="deep_learning" data-read-unit="4-2">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into Long Short-Term Memory (LSTM) and Gated Recurrent Unit (GRU) networks, which are advanced types of Recurrent Neural Networks (RNNs) designed to address the limitations of traditional RNNs, particularly the vanishing gradient problem.</p>
</div><h2><ol>
<li>Introduction to LSTM</li>
</ol></h2>
<div class='content'></div><h3>What is LSTM?</h3>
<div class='content'><p>LSTM stands for Long Short-Term Memory. It is a type of RNN architecture that is capable of learning long-term dependencies. LSTMs were introduced by Hochreiter and Schmidhuber in 1997 and have been refined and popularized over the years.</p>
</div><h3>Key Components of LSTM</h3>
<div class='content'><p>LSTM networks have a more complex structure compared to traditional RNNs. The key components include:</p>
<ul>
<li><strong>Cell State</strong>: The cell state is the memory of the network. It carries information across different time steps.</li>
<li><strong>Gates</strong>: LSTMs use gates to control the flow of information. There are three types of gates:
<ul>
<li><strong>Forget Gate</strong>: Decides what information to discard from the cell state.</li>
<li><strong>Input Gate</strong>: Decides which values from the input to update the cell state.</li>
<li><strong>Output Gate</strong>: Decides what part of the cell state to output.</li>
</ul>
</li>
</ul>
</div><h3>LSTM Cell Structure</h3>
<div class='content'><p>The structure of an LSTM cell can be visualized as follows:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ICAgICAgRm9yZ2V0IEdhdGUgICAgICAgSW5wdXQgR2F0ZSAgICAgICAgT3V0cHV0IEdhdGUKICAgICAgICAgfCAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICB8CiAgICAgICAgIHYgICAgICAgICAgICAgICAgICB2ICAgICAgICAgICAgICAgICAgdgogICAgIFtzaWdtb2lkXSAgICAgICAgICAgW3NpZ21vaWRdICAgICAgICAgIFtzaWdtb2lkXQogICAgICAgICB8ICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgIHwKICAgICAgICAgdiAgICAgICAgICAgICAgICAgIHYgICAgICAgICAgICAgICAgICB2CiAgICAgW2VsZW1lbnQtd2lzZV0gICAgIFtlbGVtZW50LXdpc2VdICAgICBbZWxlbWVudC13aXNlXQogICAgICAgICB8ICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgIHwKICAgICAgICAgdiAgICAgICAgICAgICAgICAgIHYgICAgICAgICAgICAgICAgICB2CiAgICAgW2NlbGwgc3RhdGVdICAgICAgIFtjZWxsIHN0YXRlXSAgICAgICBbY2VsbCBzdGF0ZV0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>      Forget Gate       Input Gate        Output Gate
         |                  |                  |
         v                  v                  v
     [sigmoid]           [sigmoid]          [sigmoid]
         |                  |                  |
         v                  v                  v
     [element-wise]     [element-wise]     [element-wise]
         |                  |                  |
         v                  v                  v
     [cell state]       [cell state]       [cell state]</pre></div><div class='content'></div><h3>LSTM Equations</h3>
<div class='content'><p>The operations within an LSTM cell can be described by the following equations:</p>
<ol>
<li><strong>Forget Gate</strong>:
\[
f_t = \sigma(W_f \cdot [h_{t-1}, x_t] + b_f)
\]</li>
<li><strong>Input Gate</strong>:
\[
i_t = \sigma(W_i \cdot [h_{t-1}, x_t] + b_i)
\]
\[
\tilde{C}<em>t = \tanh(W_C \cdot [h</em>{t-1}, x_t] + b_C)
\]</li>
<li><strong>Cell State Update</strong>:
\[
C_t = f_t * C_{t-1} + i_t * \tilde{C}_t
\]</li>
<li><strong>Output Gate</strong>:
\[
o_t = \sigma(W_o \cdot [h_{t-1}, x_t] + b_o)
\]
\[
h_t = o_t * \tanh(C_t)
\]</li>
</ol>
</div><h2><ol start="2">
<li>Introduction to GRU</li>
</ol></h2>
<div class='content'></div><h3>What is GRU?</h3>
<div class='content'><p>GRU stands for Gated Recurrent Unit. It is a variant of the LSTM network introduced by Cho et al. in 2014. GRUs aim to simplify the LSTM architecture while maintaining its performance.</p>
</div><h3>Key Components of GRU</h3>
<div class='content'><p>GRUs combine the forget and input gates into a single update gate and merge the cell state and hidden state. The key components include:</p>
<ul>
<li><strong>Update Gate</strong>: Controls how much of the past information needs to be passed along to the future.</li>
<li><strong>Reset Gate</strong>: Controls how much of the past information to forget.</li>
</ul>
</div><h3>GRU Cell Structure</h3>
<div class='content'><p>The structure of a GRU cell can be visualized as follows:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ICAgICAgVXBkYXRlIEdhdGUgICAgICAgIFJlc2V0IEdhdGUKICAgICAgICAgfCAgICAgICAgICAgICAgICAgIHwKICAgICAgICAgdiAgICAgICAgICAgICAgICAgIHYKICAgICBbc2lnbW9pZF0gICAgICAgICAgIFtzaWdtb2lkXQogICAgICAgICB8ICAgICAgICAgICAgICAgICAgfAogICAgICAgICB2ICAgICAgICAgICAgICAgICAgdgogICAgIFtlbGVtZW50LXdpc2VdICAgICBbZWxlbWVudC13aXNlXQogICAgICAgICB8ICAgICAgICAgICAgICAgICAgfAogICAgICAgICB2ICAgICAgICAgICAgICAgICAgdgogICAgIFtoaWRkZW4gc3RhdGVdICAgICBbaGlkZGVuIHN0YXRlXQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>      Update Gate        Reset Gate
         |                  |
         v                  v
     [sigmoid]           [sigmoid]
         |                  |
         v                  v
     [element-wise]     [element-wise]
         |                  |
         v                  v
     [hidden state]     [hidden state]</pre></div><div class='content'></div><h3>GRU Equations</h3>
<div class='content'><p>The operations within a GRU cell can be described by the following equations:</p>
<ol>
<li><strong>Update Gate</strong>:
\[
z_t = \sigma(W_z \cdot [h_{t-1}, x_t] + b_z)
\]</li>
<li><strong>Reset Gate</strong>:
\[
r_t = \sigma(W_r \cdot [h_{t-1}, x_t] + b_r)
\]</li>
<li><strong>Candidate Hidden State</strong>:
\[
\tilde{h}<em>t = \tanh(W \cdot [r_t * h</em>{t-1}, x_t] + b)
\]</li>
<li><strong>Final Hidden State</strong>:
\[
h_t = (1 - z_t) * h_{t-1} + z_t * \tilde{h}_t
\]</li>
</ol>
</div><h2><ol start="3">
<li>Practical Example</li>
</ol></h2>
<div class='content'></div><h3>Implementing LSTM in Python with TensorFlow</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLm1vZGVscyBpbXBvcnQgU2VxdWVudGlhbApmcm9tIHRlbnNvcmZsb3cua2VyYXMubGF5ZXJzIGltcG9ydCBMU1RNLCBEZW5zZQoKIyBTYW1wbGUgZGF0YQpYX3RyYWluID0gW1swLjEsIDAuMiwgMC4zXSwgWzAuMiwgMC4zLCAwLjRdLCBbMC4zLCAwLjQsIDAuNV1dCnlfdHJhaW4gPSBbMC40LCAwLjUsIDAuNl0KCiMgUmVzaGFwZSBkYXRhIHRvIFtzYW1wbGVzLCB0aW1lIHN0ZXBzLCBmZWF0dXJlc10KWF90cmFpbiA9IHRmLnJlc2hhcGUoWF90cmFpbiwgKDMsIDMsIDEpKQoKIyBCdWlsZCBMU1RNIG1vZGVsCm1vZGVsID0gU2VxdWVudGlhbCgpCm1vZGVsLmFkZChMU1RNKDUwLCBhY3RpdmF0aW9uPSdyZWx1JywgaW5wdXRfc2hhcGU9KDMsIDEpKSkKbW9kZWwuYWRkKERlbnNlKDEpKQptb2RlbC5jb21waWxlKG9wdGltaXplcj0nYWRhbScsIGxvc3M9J21zZScpCgojIFRyYWluIHRoZSBtb2RlbAptb2RlbC5maXQoWF90cmFpbiwgeV90cmFpbiwgZXBvY2hzPTIwMCwgdmVyYm9zZT0wKQoKIyBNYWtlIHByZWRpY3Rpb25zCnByZWRpY3Rpb25zID0gbW9kZWwucHJlZGljdChYX3RyYWluKQpwcmludChwcmVkaWN0aW9ucyk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import LSTM, Dense

# Sample data
X_train = [[0.1, 0.2, 0.3], [0.2, 0.3, 0.4], [0.3, 0.4, 0.5]]
y_train = [0.4, 0.5, 0.6]

# Reshape data to [samples, time steps, features]
X_train = tf.reshape(X_train, (3, 3, 1))

# Build LSTM model
model = Sequential()
model.add(LSTM(50, activation='relu', input_shape=(3, 1)))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mse')

# Train the model
model.fit(X_train, y_train, epochs=200, verbose=0)

# Make predictions
predictions = model.predict(X_train)
print(predictions)</pre></div><div class='content'></div><h3>Implementing GRU in Python with TensorFlow</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLm1vZGVscyBpbXBvcnQgU2VxdWVudGlhbApmcm9tIHRlbnNvcmZsb3cua2VyYXMubGF5ZXJzIGltcG9ydCBHUlUsIERlbnNlCgojIFNhbXBsZSBkYXRhClhfdHJhaW4gPSBbWzAuMSwgMC4yLCAwLjNdLCBbMC4yLCAwLjMsIDAuNF0sIFswLjMsIDAuNCwgMC41XV0KeV90cmFpbiA9IFswLjQsIDAuNSwgMC42XQoKIyBSZXNoYXBlIGRhdGEgdG8gW3NhbXBsZXMsIHRpbWUgc3RlcHMsIGZlYXR1cmVzXQpYX3RyYWluID0gdGYucmVzaGFwZShYX3RyYWluLCAoMywgMywgMSkpCgojIEJ1aWxkIEdSVSBtb2RlbAptb2RlbCA9IFNlcXVlbnRpYWwoKQptb2RlbC5hZGQoR1JVKDUwLCBhY3RpdmF0aW9uPSdyZWx1JywgaW5wdXRfc2hhcGU9KDMsIDEpKSkKbW9kZWwuYWRkKERlbnNlKDEpKQptb2RlbC5jb21waWxlKG9wdGltaXplcj0nYWRhbScsIGxvc3M9J21zZScpCgojIFRyYWluIHRoZSBtb2RlbAptb2RlbC5maXQoWF90cmFpbiwgeV90cmFpbiwgZXBvY2hzPTIwMCwgdmVyYm9zZT0wKQoKIyBNYWtlIHByZWRpY3Rpb25zCnByZWRpY3Rpb25zID0gbW9kZWwucHJlZGljdChYX3RyYWluKQpwcmludChwcmVkaWN0aW9ucyk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import GRU, Dense

# Sample data
X_train = [[0.1, 0.2, 0.3], [0.2, 0.3, 0.4], [0.3, 0.4, 0.5]]
y_train = [0.4, 0.5, 0.6]

# Reshape data to [samples, time steps, features]
X_train = tf.reshape(X_train, (3, 3, 1))

# Build GRU model
model = Sequential()
model.add(GRU(50, activation='relu', input_shape=(3, 1)))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mse')

# Train the model
model.fit(X_train, y_train, epochs=200, verbose=0)

# Make predictions
predictions = model.predict(X_train)
print(predictions)</pre></div><div class='content'></div><h2><ol start="4">
<li>Practical Exercises</li>
</ol></h2>
<div class='content'></div><h3>Exercise 1: Implementing LSTM for Time Series Prediction</h3>
<div class='content'><p><strong>Task</strong>: Use LSTM to predict the next value in a given time series.</p>
<p><strong>Dataset</strong>: Use a simple sine wave dataset.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCB0ZW5zb3JmbG93IGFzIHRmCmZyb20gdGVuc29yZmxvdy5rZXJhcy5tb2RlbHMgaW1wb3J0IFNlcXVlbnRpYWwKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmxheWVycyBpbXBvcnQgTFNUTSwgRGVuc2UKCiMgR2VuZXJhdGUgc2luZSB3YXZlIGRhdGEKdGltZV9zdGVwcyA9IG5wLmxpbnNwYWNlKDAsIDEwMCwgMTAwMCkKZGF0YSA9IG5wLnNpbih0aW1lX3N0ZXBzKQoKIyBQcmVwYXJlIHRoZSBkYXRhc2V0CmRlZiBjcmVhdGVfZGF0YXNldChkYXRhLCB0aW1lX3N0ZXA9MSk6CiAgICBYLCB5ID0gW10sIFtdCiAgICBmb3IgaSBpbiByYW5nZShsZW4oZGF0YSkgLSB0aW1lX3N0ZXAgLSAxKToKICAgICAgICBYLmFwcGVuZChkYXRhW2k6KGkgKyB0aW1lX3N0ZXApXSkKICAgICAgICB5LmFwcGVuZChkYXRhW2kgKyB0aW1lX3N0ZXBdKQogICAgcmV0dXJuIG5wLmFycmF5KFgpLCBucC5hcnJheSh5KQoKdGltZV9zdGVwID0gMTAKWCwgeSA9IGNyZWF0ZV9kYXRhc2V0KGRhdGEsIHRpbWVfc3RlcCkKCiMgUmVzaGFwZSBkYXRhIHRvIFtzYW1wbGVzLCB0aW1lIHN0ZXBzLCBmZWF0dXJlc10KWCA9IFgucmVzaGFwZShYLnNoYXBlWzBdLCBYLnNoYXBlWzFdLCAxKQoKIyBCdWlsZCBMU1RNIG1vZGVsCm1vZGVsID0gU2VxdWVudGlhbCgpCm1vZGVsLmFkZChMU1RNKDUwLCBhY3RpdmF0aW9uPSdyZWx1JywgaW5wdXRfc2hhcGU9KHRpbWVfc3RlcCwgMSkpKQptb2RlbC5hZGQoRGVuc2UoMSkpCm1vZGVsLmNvbXBpbGUob3B0aW1pemVyPSdhZGFtJywgbG9zcz0nbXNlJykKCiMgVHJhaW4gdGhlIG1vZGVsCm1vZGVsLmZpdChYLCB5LCBlcG9jaHM9MTAwLCB2ZXJib3NlPTApCgojIE1ha2UgcHJlZGljdGlvbnMKcHJlZGljdGlvbnMgPSBtb2RlbC5wcmVkaWN0KFgpCnByaW50KHByZWRpY3Rpb25zKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import LSTM, Dense

# Generate sine wave data
time_steps = np.linspace(0, 100, 1000)
data = np.sin(time_steps)

# Prepare the dataset
def create_dataset(data, time_step=1):
    X, y = [], []
    for i in range(len(data) - time_step - 1):
        X.append(data[i:(i + time_step)])
        y.append(data[i + time_step])
    return np.array(X), np.array(y)

time_step = 10
X, y = create_dataset(data, time_step)

# Reshape data to [samples, time steps, features]
X = X.reshape(X.shape[0], X.shape[1], 1)

# Build LSTM model
model = Sequential()
model.add(LSTM(50, activation='relu', input_shape=(time_step, 1)))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mse')

# Train the model
model.fit(X, y, epochs=100, verbose=0)

# Make predictions
predictions = model.predict(X)
print(predictions)</pre></div><div class='content'></div><h3>Exercise 2: Implementing GRU for Text Generation</h3>
<div class='content'><p><strong>Task</strong>: Use GRU to generate text based on a given input sequence.</p>
<p><strong>Dataset</strong>: Use a simple text dataset.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCB0ZW5zb3JmbG93IGFzIHRmCmZyb20gdGVuc29yZmxvdy5rZXJhcy5tb2RlbHMgaW1wb3J0IFNlcXVlbnRpYWwKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmxheWVycyBpbXBvcnQgR1JVLCBEZW5zZSwgRW1iZWRkaW5nCgojIFNhbXBsZSB0ZXh0IGRhdGEKdGV4dCA9ICJoZWxsbyB3b3JsZCIKY2hhcnMgPSBzb3J0ZWQobGlzdChzZXQodGV4dCkpKQpjaGFyX3RvX2luZGV4ID0ge2M6IGkgZm9yIGksIGMgaW4gZW51bWVyYXRlKGNoYXJzKX0KaW5kZXhfdG9fY2hhciA9IHtpOiBjIGZvciBpLCBjIGluIGVudW1lcmF0ZShjaGFycyl9CgojIFByZXBhcmUgdGhlIGRhdGFzZXQKZGVmIGNyZWF0ZV9kYXRhc2V0KHRleHQsIGNoYXJfdG9faW5kZXgsIHRpbWVfc3RlcD0xKToKICAgIFgsIHkgPSBbXSwgW10KICAgIGZvciBpIGluIHJhbmdlKGxlbih0ZXh0KSAtIHRpbWVfc3RlcCk6CiAgICAgICAgWC5hcHBlbmQoW2NoYXJfdG9faW5kZXhbY2hhcl0gZm9yIGNoYXIgaW4gdGV4dFtpOmkgKyB0aW1lX3N0ZXBdXSkKICAgICAgICB5LmFwcGVuZChjaGFyX3RvX2luZGV4W3RleHRbaSArIHRpbWVfc3RlcF1dKQogICAgcmV0dXJuIG5wLmFycmF5KFgpLCBucC5hcnJheSh5KQoKdGltZV9zdGVwID0gMwpYLCB5ID0gY3JlYXRlX2RhdGFzZXQodGV4dCwgY2hhcl90b19pbmRleCwgdGltZV9zdGVwKQoKIyBSZXNoYXBlIGRhdGEgdG8gW3NhbXBsZXMsIHRpbWUgc3RlcHMsIGZlYXR1cmVzXQpYID0gWC5yZXNoYXBlKFguc2hhcGVbMF0sIFguc2hhcGVbMV0pCgojIEJ1aWxkIEdSVSBtb2RlbAptb2RlbCA9IFNlcXVlbnRpYWwoKQptb2RlbC5hZGQoRW1iZWRkaW5nKGxlbihjaGFycyksIDEwLCBpbnB1dF9sZW5ndGg9dGltZV9zdGVwKSkKbW9kZWwuYWRkKEdSVSg1MCwgYWN0aXZhdGlvbj0ncmVsdScpKQptb2RlbC5hZGQoRGVuc2UobGVuKGNoYXJzKSwgYWN0aXZhdGlvbj0nc29mdG1heCcpKQptb2RlbC5jb21waWxlKG9wdGltaXplcj0nYWRhbScsIGxvc3M9J3NwYXJzZV9jYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknKQoKIyBUcmFpbiB0aGUgbW9kZWwKbW9kZWwuZml0KFgsIHksIGVwb2Nocz0xMDAsIHZlcmJvc2U9MCkKCiMgR2VuZXJhdGUgdGV4dApkZWYgZ2VuZXJhdGVfdGV4dChtb2RlbCwgc3RhcnRfdGV4dCwgY2hhcl90b19pbmRleCwgaW5kZXhfdG9fY2hhciwgbGVuZ3RoPTEwKToKICAgIGZvciBfIGluIHJhbmdlKGxlbmd0aCk6CiAgICAgICAgeCA9IG5wLmFycmF5KFtjaGFyX3RvX2luZGV4W2NoYXJdIGZvciBjaGFyIGluIHN0YXJ0X3RleHRbLXRpbWVfc3RlcDpdXSkucmVzaGFwZSgxLCB0aW1lX3N0ZXApCiAgICAgICAgcHJlZGljdGlvbiA9IG1vZGVsLnByZWRpY3QoeCwgdmVyYm9zZT0wKQogICAgICAgIG5leHRfY2hhciA9IGluZGV4X3RvX2NoYXJbbnAuYXJnbWF4KHByZWRpY3Rpb24pXQogICAgICAgIHN0YXJ0X3RleHQgKz0gbmV4dF9jaGFyCiAgICByZXR1cm4gc3RhcnRfdGV4dAoKZ2VuZXJhdGVkX3RleHQgPSBnZW5lcmF0ZV90ZXh0KG1vZGVsLCAiaGVsIiwgY2hhcl90b19pbmRleCwgaW5kZXhfdG9fY2hhcikKcHJpbnQoZ2VuZXJhdGVkX3RleHQp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import GRU, Dense, Embedding

# Sample text data
text = &quot;hello world&quot;
chars = sorted(list(set(text)))
char_to_index = {c: i for i, c in enumerate(chars)}
index_to_char = {i: c for i, c in enumerate(chars)}

# Prepare the dataset
def create_dataset(text, char_to_index, time_step=1):
    X, y = [], []
    for i in range(len(text) - time_step):
        X.append([char_to_index[char] for char in text[i:i + time_step]])
        y.append(char_to_index[text[i + time_step]])
    return np.array(X), np.array(y)

time_step = 3
X, y = create_dataset(text, char_to_index, time_step)

# Reshape data to [samples, time steps, features]
X = X.reshape(X.shape[0], X.shape[1])

# Build GRU model
model = Sequential()
model.add(Embedding(len(chars), 10, input_length=time_step))
model.add(GRU(50, activation='relu'))
model.add(Dense(len(chars), activation='softmax'))
model.compile(optimizer='adam', loss='sparse_categorical_crossentropy')

# Train the model
model.fit(X, y, epochs=100, verbose=0)

# Generate text
def generate_text(model, start_text, char_to_index, index_to_char, length=10):
    for _ in range(length):
        x = np.array([char_to_index[char] for char in start_text[-time_step:]]).reshape(1, time_step)
        prediction = model.predict(x, verbose=0)
        next_char = index_to_char[np.argmax(prediction)]
        start_text += next_char
    return start_text

generated_text = generate_text(model, &quot;hel&quot;, char_to_index, index_to_char)
print(generated_text)</pre></div><div class='content'></div><h2><ol start="5">
<li>Summary</li>
</ol></h2>
<div class='content'><p>In this section, we explored LSTM and GRU networks, which are advanced types of RNNs designed to handle long-term dependencies and mitigate the vanishing gradient problem. We discussed their key components, cell structures, and equations. Additionally, we provided practical examples and exercises to implement LSTM and GRU using TensorFlow.</p>
<p>In the next section, we will explore the applications of RNNs in Natural Language Processing (NLP).</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='04-01-introduction-rnn' title="Introduction to RNN" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='04-01-introduction-rnn' title="Introduction to RNN" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='04-03-rnn-applications-nlp' title="RNN Applications in Natural Language Processing" class="py-2 px-3 btn btn-primary"
				data-read-mod="deep_learning" data-read-unit="4-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='04-03-rnn-applications-nlp' title="RNN Applications in Natural Language Processing" class="py-2 px-3 btn btn-primary" 
				data-read-mod="deep_learning" data-read-unit="4-2">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Deep Learning Course</h1>
<h2>Module 1: Introduction to Deep Learning</h2>
<ul>
<li><a href="01-01-what-is-deep-learning">What is Deep Learning?</a></li>
<li><a href="01-02-history-evolution-deep-learning">History and Evolution of Deep Learning</a></li>
<li><a href="01-03-applications-deep-learning">Applications of Deep Learning</a></li>
<li><a href="01-04-basic-concepts-neural-networks">Basic Concepts of Neural Networks</a></li>
</ul>
<h2>Module 2: Fundamentals of Neural Networks</h2>
<ul>
<li><a href="02-01-perceptron-multilayer-perceptron">Perceptron and Multilayer Perceptron</a></li>
<li><a href="02-02-activation-function">Activation Function</a></li>
<li><a href="02-03-forward-backward-propagation">Forward and Backward Propagation</a></li>
<li><a href="02-04-optimization-loss-function">Optimization and Loss Function</a></li>
</ul>
<h2>Module 3: Convolutional Neural Networks (CNN)</h2>
<ul>
<li><a href="03-01-introduction-cnn">Introduction to CNN</a></li>
<li><a href="03-02-convolutional-pooling-layers">Convolutional and Pooling Layers</a></li>
<li><a href="03-03-popular-cnn-architectures">Popular CNN Architectures</a></li>
<li><a href="03-04-cnn-applications-image-recognition">CNN Applications in Image Recognition</a></li>
</ul>
<h2>Module 4: Recurrent Neural Networks (RNN)</h2>
<ul>
<li><a href="04-01-introduction-rnn">Introduction to RNN</a></li>
<li><a href="04-02-lstm-gru">LSTM and GRU</a></li>
<li><a href="04-03-rnn-applications-nlp">RNN Applications in Natural Language Processing</a></li>
<li><a href="04-04-sequences-time-series">Sequences and Time Series</a></li>
</ul>
<h2>Module 5: Advanced Techniques in Deep Learning</h2>
<ul>
<li><a href="05-01-generative-adversarial-networks">Generative Adversarial Networks (GAN)</a></li>
<li><a href="05-02-autoencoders">Autoencoders</a></li>
<li><a href="05-03-transfer-learning">Transfer Learning</a></li>
<li><a href="05-04-regularization-improvement-techniques">Regularization and Improvement Techniques</a></li>
</ul>
<h2>Module 6: Tools and Frameworks</h2>
<ul>
<li><a href="06-01-introduction-tensorflow">Introduction to TensorFlow</a></li>
<li><a href="06-02-introduction-pytorch">Introduction to PyTorch</a></li>
<li><a href="06-03-framework-comparison">Framework Comparison</a></li>
<li><a href="06-04-development-environments-resources">Development Environments and Additional Resources</a></li>
</ul>
<h2>Module 7: Practical Projects</h2>
<ul>
<li><a href="07-01-image-classification-cnn">Image Classification with CNN</a></li>
<li><a href="07-02-text-generation-rnn">Text Generation with RNN</a></li>
<li><a href="07-03-anomaly-detection-autoencoders">Anomaly Detection with Autoencoders</a></li>
<li><a href="07-04-creating-gan-image-generation">Creating a GAN for Image Generation</a></li>
</ul>
<h2>Module 8: Ethical Considerations and the Future of Deep Learning</h2>
<ul>
<li><a href="08-01-ethics-deep-learning">Ethics in Deep Learning</a></li>
<li><a href="08-02-social-economic-impact">Social and Economic Impact</a></li>
<li><a href="08-03-future-trends-deep-learning">Future Trends in Deep Learning</a></li>
<li><a href="08-04-challenges-opportunities">Challenges and Opportunities</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
