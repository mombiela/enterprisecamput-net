<!DOCTYPE html>
<html lang="en">
<head>
    <title> A5: Broken Access Control </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, nofollow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/owasp-seguridad-aplicaciones-web/03-05-control-acceso-roto" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/owasp-seguretat-aplicacions-web/03-05-control-acces-trencat" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/owasp-web-application-security/03-05-broken-access-control" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.188a386f47.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "foundations";
  		var MOD_NAME = "owasp";
  		var TEMA_NAME = "3-5";
  		var TYPE = "mod";
  		var PATH = "mod/owasp/03-05-broken-access-control";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/owasp-seguridad-aplicaciones-web/03-05-control-acceso-roto" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/owasp-seguretat-aplicacions-web/03-05-control-acces-trencat" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="owasp">
		<a  href="#" class="text-secondary d-none" data-read-mod="owasp" data-read-unit="3-5" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="owasp" data-unread-unit="3-5" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='03-04-xxe' title="A4: XML External Entities (XXE)" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='03-04-xxe' title="A4: XML External Entities (XXE)" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">A5: Broken Access Control</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='03-06-security-misconfiguration' title="A6: Security Misconfiguration" class="py-2 px-3 btn btn-primary"
				data-read-mod="owasp" data-read-unit="3-5">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='03-06-security-misconfiguration' title="A6: Security Misconfiguration" class="py-2 px-3 btn btn-primary" 
				data-read-mod="owasp" data-read-unit="3-5">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'></div><h2>Introduction</h2>
<div class='content'><p>Broken Access Control is a critical security vulnerability that occurs when an application does not properly enforce access controls, allowing unauthorized users to access restricted resources or perform actions they should not be able to. This can lead to data breaches, unauthorized data manipulation, and other serious security issues.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ol>
<li><strong>Access Control</strong>: Mechanisms that restrict access to resources based on user roles, permissions, and policies.</li>
<li><strong>Broken Access Control</strong>: Failures in enforcing these mechanisms, leading to unauthorized access.</li>
<li><strong>Common Scenarios</strong>:
<ul>
<li><strong>Vertical Privilege Escalation</strong>: Lower-privileged users gain higher-level privileges.</li>
<li><strong>Horizontal Privilege Escalation</strong>: Users access resources or functions of other users with the same privilege level.</li>
</ul>
</li>
</ol>
</div><h2>Examples of Broken Access Control</h2>
<div class='content'></div><h3>Example 1: Insecure Direct Object References (IDOR)</h3>
<div class='content'><p>An application allows users to access resources by specifying a unique identifier in the URL. If the application does not verify the user's authorization to access the resource, it can lead to IDOR.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlIG9mIGluc2VjdXJlIGRpcmVjdCBvYmplY3QgcmVmZXJlbmNlCkBhcHAucm91dGUoJy91c2VyLzx1c2VyX2lkPicpCmRlZiBnZXRfdXNlcl9wcm9maWxlKHVzZXJfaWQpOgogICAgdXNlciA9IFVzZXIucXVlcnkuZ2V0KHVzZXJfaWQpCiAgICByZXR1cm4gcmVuZGVyX3RlbXBsYXRlKCdwcm9maWxlLmh0bWwnLCB1c2VyPXVzZXIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example of insecure direct object reference
@app.route('/user/&lt;user_id&gt;')
def get_user_profile(user_id):
    user = User.query.get(user_id)
    return render_template('profile.html', user=user)</pre></div><div class='content'><p><strong>Explanation</strong>: In this example, any user can access any other user's profile by changing the <code>user_id</code> in the URL.</p>
</div><h3>Example 2: Missing Function Level Access Control</h3>
<div class='content'><p>An application does not enforce access control checks on sensitive functions, allowing unauthorized users to perform restricted actions.</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlIG9mIG1pc3NpbmcgZnVuY3Rpb24gbGV2ZWwgYWNjZXNzIGNvbnRyb2wKQGFwcC5yb3V0ZSgnL2FkbWluL2RlbGV0ZV91c2VyLzx1c2VyX2lkPicsIG1ldGhvZHM9WydQT1NUJ10pCmRlZiBkZWxldGVfdXNlcih1c2VyX2lkKToKICAgIHVzZXIgPSBVc2VyLnF1ZXJ5LmdldCh1c2VyX2lkKQogICAgZGIuc2Vzc2lvbi5kZWxldGUodXNlcikKICAgIGRiLnNlc3Npb24uY29tbWl0KCkKICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCdhZG1pbl9kYXNoYm9hcmQnKSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example of missing function level access control
@app.route('/admin/delete_user/&lt;user_id&gt;', methods=['POST'])
def delete_user(user_id):
    user = User.query.get(user_id)
    db.session.delete(user)
    db.session.commit()
    return redirect(url_for('admin_dashboard'))</pre></div><div class='content'><p><strong>Explanation</strong>: In this example, any user can delete any other user by accessing the URL, as there is no check to ensure the user has admin privileges.</p>
</div><h2>Preventing Broken Access Control</h2>
<div class='content'><ol>
<li><strong>Implement Role-Based Access Control (RBAC)</strong>: Define roles and permissions clearly and enforce them throughout the application.</li>
<li><strong>Use Secure Frameworks</strong>: Leverage security features provided by frameworks to manage access control.</li>
<li><strong>Validate User Permissions</strong>: Always check user permissions before granting access to resources or functions.</li>
<li><strong>Least Privilege Principle</strong>: Grant users the minimum level of access necessary for their role.</li>
<li><strong>Regular Audits and Testing</strong>: Conduct regular security audits and penetration testing to identify and fix access control issues.</li>
</ol>
</div><h2>Practical Exercise</h2>
<div class='content'></div><h3>Exercise: Implementing Access Control</h3>
<div class='content'><p><strong>Objective</strong>: Secure the <code>delete_user</code> function to ensure only admin users can delete other users.</p>
<p><strong>Instructions</strong>:</p>
<ol>
<li>Define an <code>is_admin</code> attribute for the <code>User</code> model.</li>
<li>Modify the <code>delete_user</code> function to check if the current user is an admin before allowing the deletion.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTdGVwIDE6IERlZmluZSBhbiBpc19hZG1pbiBhdHRyaWJ1dGUgZm9yIHRoZSBVc2VyIG1vZGVsCmNsYXNzIFVzZXIoZGIuTW9kZWwpOgogICAgaWQgPSBkYi5Db2x1bW4oZGIuSW50ZWdlciwgcHJpbWFyeV9rZXk9VHJ1ZSkKICAgIHVzZXJuYW1lID0gZGIuQ29sdW1uKGRiLlN0cmluZyg4MCksIHVuaXF1ZT1UcnVlLCBudWxsYWJsZT1GYWxzZSkKICAgIGlzX2FkbWluID0gZGIuQ29sdW1uKGRiLkJvb2xlYW4sIGRlZmF1bHQ9RmFsc2UpCgojIFN0ZXAgMjogTW9kaWZ5IHRoZSBkZWxldGVfdXNlciBmdW5jdGlvbiB0byBjaGVjayBmb3IgYWRtaW4gcHJpdmlsZWdlcwpAYXBwLnJvdXRlKCcvYWRtaW4vZGVsZXRlX3VzZXIvPHVzZXJfaWQ+JywgbWV0aG9kcz1bJ1BPU1QnXSkKQGxvZ2luX3JlcXVpcmVkCmRlZiBkZWxldGVfdXNlcih1c2VyX2lkKToKICAgIGlmIG5vdCBjdXJyZW50X3VzZXIuaXNfYWRtaW46CiAgICAgICAgYWJvcnQoNDAzKSAgIyBGb3JiaWRkZW4KICAgIHVzZXIgPSBVc2VyLnF1ZXJ5LmdldCh1c2VyX2lkKQogICAgaWYgdXNlcjoKICAgICAgICBkYi5zZXNzaW9uLmRlbGV0ZSh1c2VyKQogICAgICAgIGRiLnNlc3Npb24uY29tbWl0KCkKICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCdhZG1pbl9kYXNoYm9hcmQnKSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Step 1: Define an is_admin attribute for the User model
class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80), unique=True, nullable=False)
    is_admin = db.Column(db.Boolean, default=False)

# Step 2: Modify the delete_user function to check for admin privileges
@app.route('/admin/delete_user/&lt;user_id&gt;', methods=['POST'])
@login_required
def delete_user(user_id):
    if not current_user.is_admin:
        abort(403)  # Forbidden
    user = User.query.get(user_id)
    if user:
        db.session.delete(user)
        db.session.commit()
    return redirect(url_for('admin_dashboard'))</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The <code>is_admin</code> attribute is added to the <code>User</code> model to indicate whether a user has admin privileges.</li>
<li>The <code>delete_user</code> function now checks if the current user is an admin before proceeding with the deletion. If the user is not an admin, a <code>403 Forbidden</code> error is returned.</li>
</ul>
</div><h2>Common Mistakes and Tips</h2>
<div class='content'><ol>
<li><strong>Assuming Client-Side Checks Are Sufficient</strong>: Always enforce access control on the server side. Client-side checks can be bypassed.</li>
<li><strong>Hardcoding Access Control Logic</strong>: Use centralized access control mechanisms to avoid inconsistencies and errors.</li>
<li><strong>Ignoring Indirect Access Paths</strong>: Ensure all paths to sensitive resources are protected, including indirect access through APIs or background processes.</li>
</ol>
</div><h2>Conclusion</h2>
<div class='content'><p>Broken Access Control is a serious vulnerability that can lead to unauthorized access and data breaches. By understanding common scenarios and implementing robust access control mechanisms, you can significantly enhance the security of your web applications. Regular audits and adherence to best practices are essential to maintaining secure access controls.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='03-04-xxe' title="A4: XML External Entities (XXE)" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='03-04-xxe' title="A4: XML External Entities (XXE)" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='03-06-security-misconfiguration' title="A6: Security Misconfiguration" class="py-2 px-3 btn btn-primary"
				data-read-mod="owasp" data-read-unit="3-5">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='03-06-security-misconfiguration' title="A6: Security Misconfiguration" class="py-2 px-3 btn btn-primary" 
				data-read-mod="owasp" data-read-unit="3-5">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>OWASP Course: Guidelines and Standards for Web Application Security</h1>
<h2>Module 1: Introduction to OWASP</h2>
<ul>
<li><a href="01-01-what-is-owasp">What is OWASP?</a></li>
<li><a href="01-02-history-mission-owasp">History and Mission of OWASP</a></li>
<li><a href="01-03-importance-web-application-security">Importance of Web Application Security</a></li>
</ul>
<h2>Module 2: Main OWASP Projects</h2>
<ul>
<li><a href="02-01-owasp-top-ten">OWASP Top Ten</a></li>
<li><a href="02-02-owasp-asvs">OWASP ASVS (Application Security Verification Standard)</a></li>
<li><a href="02-03-owasp-samm">OWASP SAMM (Software Assurance Maturity Model)</a></li>
<li><a href="02-04-owasp-zap">OWASP ZAP (Zed Attack Proxy)</a></li>
</ul>
<h2>Module 3: OWASP Top Ten</h2>
<ul>
<li><a href="03-01-injection">A1: Injection</a></li>
<li><a href="03-02-broken-authentication">A2: Broken Authentication</a></li>
<li><a href="03-03-sensitive-data-exposure">A3: Sensitive Data Exposure</a></li>
<li><a href="03-04-xxe">A4: XML External Entities (XXE)</a></li>
<li><a href="03-05-broken-access-control">A5: Broken Access Control</a></li>
<li><a href="03-06-security-misconfiguration">A6: Security Misconfiguration</a></li>
<li><a href="03-07-xss">A7: Cross-Site Scripting (XSS)</a></li>
<li><a href="03-08-insecure-deserialization">A8: Insecure Deserialization</a></li>
<li><a href="03-09-components-vulnerabilities">A9: Using Components with Known Vulnerabilities</a></li>
<li><a href="03-10-insufficient-logging-monitoring">A10: Insufficient Logging and Monitoring</a></li>
</ul>
<h2>Module 4: OWASP ASVS (Application Security Verification Standard)</h2>
<ul>
<li><a href="04-01-introduction-asvs">Introduction to ASVS</a></li>
<li><a href="04-02-verification-levels">Verification Levels</a></li>
<li><a href="04-03-security-requirements">Security Requirements</a></li>
<li><a href="04-04-implementing-asvs">Implementing ASVS in Projects</a></li>
</ul>
<h2>Module 5: OWASP SAMM (Software Assurance Maturity Model)</h2>
<ul>
<li><a href="05-01-introduction-samm">Introduction to SAMM</a></li>
<li><a href="05-02-samm-domains">SAMM Domains</a></li>
<li><a href="05-03-maturity-assessment">Maturity Assessment</a></li>
<li><a href="05-04-continuous-improvement-samm">Continuous Improvement with SAMM</a></li>
</ul>
<h2>Module 6: OWASP ZAP (Zed Attack Proxy)</h2>
<ul>
<li><a href="06-01-introduction-zap">Introduction to ZAP</a></li>
<li><a href="06-02-installation-configuration">Installation and Configuration</a></li>
<li><a href="06-03-vulnerability-scanning">Vulnerability Scanning</a></li>
<li><a href="06-04-automating-security-tests">Automating Security Tests</a></li>
</ul>
<h2>Module 7: Best Practices and Recommendations</h2>
<ul>
<li><a href="07-01-sdlc">Secure Development Lifecycle (SDLC)</a></li>
<li><a href="07-02-security-devops">Integrating Security in DevOps</a></li>
<li><a href="07-03-security-training-awareness">Security Training and Awareness</a></li>
<li><a href="07-04-tools-resources">Additional Tools and Resources</a></li>
</ul>
<h2>Module 8: Practical Exercises and Case Studies</h2>
<ul>
<li><a href="08-01-exercise-identifying-vulnerabilities">Exercise 1: Identifying Vulnerabilities</a></li>
<li><a href="08-02-exercise-implementing-controls">Exercise 2: Implementing Security Controls</a></li>
<li><a href="08-03-case-study-analyzing-incident">Case Study 1: Analyzing a Security Incident</a></li>
<li><a href="08-04-case-study-improving-security">Case Study 2: Improving Security in a Web Application</a></li>
</ul>
<h2>Module 9: Evaluation and Certification</h2>
<ul>
<li><a href="09-01-final-evaluation">Final Evaluation</a></li>
<li><a href="09-02-owasp-certification">OWASP Certification</a></li>
<li><a href="09-03-resources-certification-preparation">Resources for Certification Preparation</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
