<!DOCTYPE html>
<html lang="en">
<head>
    <title> A2: Broken Authentication </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, nofollow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/mod/owasp/03-02-perdida-autenticacion" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/owasp/03-02-perdua-autenticacio" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/owasp/03-02-broken-authentication" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.ea63f62b9e.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "foundations";
  		var MOD_NAME = "owasp";
  		var TEMA_NAME = "3-2";
  		var TYPE = "mod";
  		var PATH = "mod/owasp/03-02-broken-authentication";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/owasp/03-02-perdida-autenticacion" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/owasp/03-02-perdua-autenticacio" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="owasp">
		<a  href="#" class="text-secondary d-none" data-read-mod="owasp" data-read-unit="3-2" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="owasp" data-unread-unit="3-2" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='03-01-injection' title="A1: Injection" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='03-01-injection' title="A1: Injection" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h2 style="text-decoration:underline">A2: Broken Authentication</h2>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='03-03-sensitive-data-exposure' title="A3: Sensitive Data Exposure" class="py-2 px-3 btn btn-primary"
				data-read-mod="owasp" data-read-unit="3-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='03-03-sensitive-data-exposure' title="A3: Sensitive Data Exposure" class="py-2 px-3 btn btn-primary" 
				data-read-mod="owasp" data-read-unit="3-2">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Broken Authentication is one of the most critical vulnerabilities in web applications, as identified by the OWASP Top Ten. This vulnerability occurs when application functions related to authentication and session management are implemented incorrectly, allowing attackers to compromise passwords, keys, or session tokens, or exploit other implementation flaws to assume other users' identities temporarily or permanently.</p>
</div><h1>Key Concepts</h1>
<div class='content'></div><h2><ol>
<li>Authentication vs. Authorization</li>
</ol></h2>
<div class='content'><ul>
<li><strong>Authentication</strong>: The process of verifying the identity of a user or system.</li>
<li><strong>Authorization</strong>: The process of determining what an authenticated user or system is allowed to do.</li>
</ul>
</div><h2><ol start="2">
<li>Common Authentication Flaws</li>
</ol></h2>
<div class='content'><ul>
<li>Weak password policies</li>
<li>Credential stuffing (using lists of known passwords)</li>
<li>Brute force attacks</li>
<li>Session fixation</li>
<li>Insecure password recovery mechanisms</li>
</ul>
</div><h2><ol start="3">
<li>Session Management</li>
</ol></h2>
<div class='content'><ul>
<li><strong>Session ID</strong>: A unique identifier assigned to a user session.</li>
<li><strong>Session Hijacking</strong>: An attack where an attacker takes over a valid session by stealing the session ID.</li>
</ul>
</div><h1>Examples of Broken Authentication</h1>
<div class='content'></div><h2>Example 1: Weak Password Policy</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QSB3ZWIgYXBwbGljYXRpb24gYWxsb3dzIHVzZXJzIHRvIHNldCBwYXNzd29yZHMgd2l0aCBtaW5pbWFsIGNvbXBsZXhpdHkgcmVxdWlyZW1lbnRzLCBzdWNoIGFzICJwYXNzd29yZDEyMyIgb3IgIjEyMzQ1NiIu"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>A web application allows users to set passwords with minimal complexity requirements, such as &quot;password123&quot; or &quot;123456&quot;.</pre></div><div class='content'><p><strong>Explanation</strong>: Weak passwords are easily guessable and can be cracked using brute force attacks.</p>
</div><h2>Example 2: Insecure Password Storage</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UGFzc3dvcmRzIGFyZSBzdG9yZWQgaW4gdGhlIGRhdGFiYXNlIGluIHBsYWluIHRleHQgb3IgdXNpbmcgd2VhayBoYXNoaW5nIGFsZ29yaXRobXMgbGlrZSBNRDUu"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Passwords are stored in the database in plain text or using weak hashing algorithms like MD5.</pre></div><div class='content'><p><strong>Explanation</strong>: If the database is compromised, attackers can easily retrieve and use these passwords.</p>
</div><h2>Example 3: Session Fixation</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QW4gYXR0YWNrZXIgc2V0cyBhIHNlc3Npb24gSUQgdmFsdWUgYW5kIHRyaWNrcyBhIHVzZXIgaW50byBsb2dnaW5nIGluIHdpdGggdGhhdCBzZXNzaW9uIElELiBUaGUgYXR0YWNrZXIgY2FuIHRoZW4gdXNlIHRoZSBzYW1lIHNlc3Npb24gSUQgdG8gaW1wZXJzb25hdGUgdGhlIHVzZXIu"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>An attacker sets a session ID value and tricks a user into logging in with that session ID. The attacker can then use the same session ID to impersonate the user.</pre></div><div class='content'><p><strong>Explanation</strong>: The application does not generate a new session ID upon user login, allowing the attacker to hijack the session.</p>
</div><h1>Preventive Measures</h1>
<div class='content'></div><h2><ol>
<li>Implement Strong Password Policies</li>
</ol></h2>
<div class='content'><ul>
<li>Enforce minimum password length (e.g., at least 12 characters).</li>
<li>Require a mix of upper and lower case letters, numbers, and special characters.</li>
<li>Implement account lockout mechanisms after a certain number of failed login attempts.</li>
</ul>
</div><h2><ol start="2">
<li>Secure Password Storage</li>
</ol></h2>
<div class='content'><ul>
<li>Use strong, adaptive hashing algorithms like bcrypt, scrypt, or Argon2.</li>
<li>Salt passwords before hashing to prevent rainbow table attacks.</li>
</ul>
</div><h2><ol start="3">
<li>Protect Session IDs</li>
</ol></h2>
<div class='content'><ul>
<li>Generate a new session ID upon user login.</li>
<li>Use secure cookies (HttpOnly and Secure flags).</li>
<li>Implement session timeout and logout mechanisms.</li>
</ul>
</div><h2><ol start="4">
<li>Multi-Factor Authentication (MFA)</li>
</ol></h2>
<div class='content'><ul>
<li>Require users to provide two or more verification factors to gain access to an application.</li>
<li>Common factors include something the user knows (password), something the user has (security token), and something the user is (biometric verification).</li>
</ul>
</div><h1>Practical Example</h1>
<div class='content'></div><h2>Implementing Secure Password Storage in Python</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGJjcnlwdAoKIyBIYXNoaW5nIGEgcGFzc3dvcmQKcGFzc3dvcmQgPSBiInN1cGVyX3NlY3JldF9wYXNzd29yZCIKaGFzaGVkID0gYmNyeXB0Lmhhc2hwdyhwYXNzd29yZCwgYmNyeXB0LmdlbnNhbHQoKSkKCiMgVmVyaWZ5aW5nIGEgcGFzc3dvcmQKaWYgYmNyeXB0LmNoZWNrcHcocGFzc3dvcmQsIGhhc2hlZCk6CiAgICBwcmludCgiUGFzc3dvcmQgbWF0Y2giKQplbHNlOgogICAgcHJpbnQoIlBhc3N3b3JkIGRvZXMgbm90IG1hdGNoIik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import bcrypt

# Hashing a password
password = b&quot;super_secret_password&quot;
hashed = bcrypt.hashpw(password, bcrypt.gensalt())

# Verifying a password
if bcrypt.checkpw(password, hashed):
    print(&quot;Password match&quot;)
else:
    print(&quot;Password does not match&quot;)</pre></div><div class='content'><p><strong>Explanation</strong>: This code snippet demonstrates how to securely hash and verify passwords using the bcrypt library in Python.</p>
</div><h1>Exercise: Implementing Strong Password Policies</h1>
<div class='content'></div><h2>Task</h2>
<div class='content'><p>Write a function in Python that checks if a given password meets the following criteria:</p>
<ul>
<li>At least 12 characters long</li>
<li>Contains both uppercase and lowercase letters</li>
<li>Includes at least one numerical digit</li>
<li>Has at least one special character</li>
</ul>
</div><h2>Solution</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHJlCgpkZWYgaXNfc3Ryb25nX3Bhc3N3b3JkKHBhc3N3b3JkKToKICAgIGlmIGxlbihwYXNzd29yZCkgPCAxMjoKICAgICAgICByZXR1cm4gRmFsc2UKICAgIGlmIG5vdCByZS5zZWFyY2gociJbQS1aXSIsIHBhc3N3b3JkKToKICAgICAgICByZXR1cm4gRmFsc2UKICAgIGlmIG5vdCByZS5zZWFyY2gociJbYS16XSIsIHBhc3N3b3JkKToKICAgICAgICByZXR1cm4gRmFsc2UKICAgIGlmIG5vdCByZS5zZWFyY2gociJcZCIsIHBhc3N3b3JkKToKICAgICAgICByZXR1cm4gRmFsc2UKICAgIGlmIG5vdCByZS5zZWFyY2gociJbIUAjJCVeJiooKSwuP1wiOnt9fDw+XSIsIHBhc3N3b3JkKToKICAgICAgICByZXR1cm4gRmFsc2UKICAgIHJldHVybiBUcnVlCgojIFRlc3QgdGhlIGZ1bmN0aW9uCnBhc3N3b3JkID0gIlN0cm9uZ1Bhc3N3MHJkISIKcHJpbnQoaXNfc3Ryb25nX3Bhc3N3b3JkKHBhc3N3b3JkKSkgICMgT3V0cHV0OiBUcnVl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import re

def is_strong_password(password):
    if len(password) &lt; 12:
        return False
    if not re.search(r&quot;[A-Z]&quot;, password):
        return False
    if not re.search(r&quot;[a-z]&quot;, password):
        return False
    if not re.search(r&quot;\d&quot;, password):
        return False
    if not re.search(r&quot;[!@#$%^&amp;*(),.?\&quot;:{}|&lt;&gt;]&quot;, password):
        return False
    return True

# Test the function
password = &quot;StrongPassw0rd!&quot;
print(is_strong_password(password))  # Output: True</pre></div><div class='content'><p><strong>Explanation</strong>: This function uses regular expressions to check if the password meets the specified criteria.</p>
</div><h1>Common Mistakes and Tips</h1>
<div class='content'></div><h2>Mistake 1: Using Weak Hashing Algorithms</h2>
<div class='content'><ul>
<li><strong>Tip</strong>: Always use strong, adaptive hashing algorithms like bcrypt, scrypt, or Argon2.</li>
</ul>
</div><h2>Mistake 2: Not Regenerating Session IDs</h2>
<div class='content'><ul>
<li><strong>Tip</strong>: Ensure that a new session ID is generated upon user login to prevent session fixation attacks.</li>
</ul>
</div><h2>Mistake 3: Ignoring Account Lockout Mechanisms</h2>
<div class='content'><ul>
<li><strong>Tip</strong>: Implement account lockout mechanisms to prevent brute force attacks.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Broken Authentication is a critical vulnerability that can lead to severe security breaches. By understanding common authentication flaws and implementing preventive measures such as strong password policies, secure password storage, and session management best practices, you can significantly enhance the security of your web applications. In the next section, we will explore the vulnerability of Sensitive Data Exposure and how to protect sensitive information in web applications.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='03-01-injection' title="A1: Injection" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='03-01-injection' title="A1: Injection" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='03-03-sensitive-data-exposure' title="A3: Sensitive Data Exposure" class="py-2 px-3 btn btn-primary"
				data-read-mod="owasp" data-read-unit="3-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='03-03-sensitive-data-exposure' title="A3: Sensitive Data Exposure" class="py-2 px-3 btn btn-primary" 
				data-read-mod="owasp" data-read-unit="3-2">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>OWASP Course: Guidelines and Standards for Web Application Security</h1>
<h2>Module 1: Introduction to OWASP</h2>
<ul>
<li><a href="01-01-what-is-owasp">What is OWASP?</a></li>
<li><a href="01-02-history-mission-owasp">History and Mission of OWASP</a></li>
<li><a href="01-03-importance-web-application-security">Importance of Web Application Security</a></li>
</ul>
<h2>Module 2: Main OWASP Projects</h2>
<ul>
<li><a href="02-01-owasp-top-ten">OWASP Top Ten</a></li>
<li><a href="02-02-owasp-asvs">OWASP ASVS (Application Security Verification Standard)</a></li>
<li><a href="02-03-owasp-samm">OWASP SAMM (Software Assurance Maturity Model)</a></li>
<li><a href="02-04-owasp-zap">OWASP ZAP (Zed Attack Proxy)</a></li>
</ul>
<h2>Module 3: OWASP Top Ten</h2>
<ul>
<li><a href="03-01-injection">A1: Injection</a></li>
<li><a href="03-02-broken-authentication">A2: Broken Authentication</a></li>
<li><a href="03-03-sensitive-data-exposure">A3: Sensitive Data Exposure</a></li>
<li><a href="03-04-xxe">A4: XML External Entities (XXE)</a></li>
<li><a href="03-05-broken-access-control">A5: Broken Access Control</a></li>
<li><a href="03-06-security-misconfiguration">A6: Security Misconfiguration</a></li>
<li><a href="03-07-xss">A7: Cross-Site Scripting (XSS)</a></li>
<li><a href="03-08-insecure-deserialization">A8: Insecure Deserialization</a></li>
<li><a href="03-09-components-vulnerabilities">A9: Using Components with Known Vulnerabilities</a></li>
<li><a href="03-10-insufficient-logging-monitoring">A10: Insufficient Logging and Monitoring</a></li>
</ul>
<h2>Module 4: OWASP ASVS (Application Security Verification Standard)</h2>
<ul>
<li><a href="04-01-introduction-asvs">Introduction to ASVS</a></li>
<li><a href="04-02-verification-levels">Verification Levels</a></li>
<li><a href="04-03-security-requirements">Security Requirements</a></li>
<li><a href="04-04-implementing-asvs">Implementing ASVS in Projects</a></li>
</ul>
<h2>Module 5: OWASP SAMM (Software Assurance Maturity Model)</h2>
<ul>
<li><a href="05-01-introduction-samm">Introduction to SAMM</a></li>
<li><a href="05-02-samm-domains">SAMM Domains</a></li>
<li><a href="05-03-maturity-assessment">Maturity Assessment</a></li>
<li><a href="05-04-continuous-improvement-samm">Continuous Improvement with SAMM</a></li>
</ul>
<h2>Module 6: OWASP ZAP (Zed Attack Proxy)</h2>
<ul>
<li><a href="06-01-introduction-zap">Introduction to ZAP</a></li>
<li><a href="06-02-installation-configuration">Installation and Configuration</a></li>
<li><a href="06-03-vulnerability-scanning">Vulnerability Scanning</a></li>
<li><a href="06-04-automating-security-tests">Automating Security Tests</a></li>
</ul>
<h2>Module 7: Best Practices and Recommendations</h2>
<ul>
<li><a href="07-01-sdlc">Secure Development Lifecycle (SDLC)</a></li>
<li><a href="07-02-security-devops">Integrating Security in DevOps</a></li>
<li><a href="07-03-security-training-awareness">Security Training and Awareness</a></li>
<li><a href="07-04-tools-resources">Additional Tools and Resources</a></li>
</ul>
<h2>Module 8: Practical Exercises and Case Studies</h2>
<ul>
<li><a href="08-01-exercise-identifying-vulnerabilities">Exercise 1: Identifying Vulnerabilities</a></li>
<li><a href="08-02-exercise-implementing-controls">Exercise 2: Implementing Security Controls</a></li>
<li><a href="08-03-case-study-analyzing-incident">Case Study 1: Analyzing a Security Incident</a></li>
<li><a href="08-04-case-study-improving-security">Case Study 2: Improving Security in a Web Application</a></li>
</ul>
<h2>Module 9: Evaluation and Certification</h2>
<ul>
<li><a href="09-01-final-evaluation">Final Evaluation</a></li>
<li><a href="09-02-owasp-certification">OWASP Certification</a></li>
<li><a href="09-03-resources-certification-preparation">Resources for Certification Preparation</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
