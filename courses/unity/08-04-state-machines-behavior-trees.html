<!DOCTYPE html>
<html lang="en">
<head>
    <title> State Machines and Behavior Trees </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/unity/08-04-state-machines-behavior-trees" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/unity/08-04-state-machines-behavior-trees" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/unity/08-04-state-machines-behavior-trees" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "unity";
  		var TEMA_NAME = "8-4";
  		var TYPE = "mod";
  		var PATH = "mod/unity/08-04-state-machines-behavior-trees";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.ae32789132.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/unity/08-04-state-machines-behavior-trees" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/unity/08-04-state-machines-behavior-trees" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="unity">
		<a  href="#" class="text-secondary d-none" data-read-mod="unity" data-read-unit="8-4" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="unity" data-unread-unit="8-4" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='08-03-basic-ai-scripting' title="Basic AI Scripting" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='08-03-basic-ai-scripting' title="Basic AI Scripting" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">State Machines and Behavior Trees</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='09-01-profiling-optimization-techniques' title="Profiling and Optimization Techniques" class="py-2 px-3 btn btn-primary"
				data-read-mod="unity" data-read-unit="8-4">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='09-01-profiling-optimization-techniques' title="Profiling and Optimization Techniques" class="py-2 px-3 btn btn-primary" 
				data-read-mod="unity" data-read-unit="8-4">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this module, we will delve into advanced AI techniques using state machines and behavior trees. These concepts are crucial for creating complex and responsive AI behaviors in your Unity projects.</p>
</div><h2>State Machines</h2>
<div class='content'></div><h3>What is a State Machine?</h3>
<div class='content'><p>A state machine is a computational model used to design algorithms. It consists of:</p>
<ul>
<li><strong>States</strong>: Different conditions or modes in which an object can exist.</li>
<li><strong>Transitions</strong>: Rules that determine when and how the object moves from one state to another.</li>
<li><strong>Events</strong>: Triggers that cause transitions between states.</li>
</ul>
</div><h3>Key Concepts</h3>
<div class='content'><ol>
<li><strong>State</strong>: Represents a specific condition or situation.</li>
<li><strong>Transition</strong>: The movement from one state to another.</li>
<li><strong>Event</strong>: An occurrence that triggers a transition.</li>
</ol>
</div><h3>Example: Simple State Machine for an Enemy AI</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgVW5pdHlFbmdpbmU7CgpwdWJsaWMgY2xhc3MgRW5lbXlBSSA6IE1vbm9CZWhhdmlvdXIKewogICAgcHJpdmF0ZSBlbnVtIFN0YXRlCiAgICB7CiAgICAgICAgSWRsZSwKICAgICAgICBQYXRyb2wsCiAgICAgICAgQ2hhc2UsCiAgICAgICAgQXR0YWNrCiAgICB9CgogICAgcHJpdmF0ZSBTdGF0ZSBjdXJyZW50U3RhdGU7CgogICAgdm9pZCBTdGFydCgpCiAgICB7CiAgICAgICAgY3VycmVudFN0YXRlID0gU3RhdGUuSWRsZTsKICAgIH0KCiAgICB2b2lkIFVwZGF0ZSgpCiAgICB7CiAgICAgICAgc3dpdGNoIChjdXJyZW50U3RhdGUpCiAgICAgICAgewogICAgICAgICAgICBjYXNlIFN0YXRlLklkbGU6CiAgICAgICAgICAgICAgICAvLyBJZGxlIGJlaGF2aW9yCiAgICAgICAgICAgICAgICBpZiAoU2VlUGxheWVyKCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gU3RhdGUuQ2hhc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBTdGF0ZS5QYXRyb2w6CiAgICAgICAgICAgICAgICAvLyBQYXRyb2wgYmVoYXZpb3IKICAgICAgICAgICAgICAgIGlmIChTZWVQbGF5ZXIoKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSBTdGF0ZS5DaGFzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFN0YXRlLkNoYXNlOgogICAgICAgICAgICAgICAgLy8gQ2hhc2UgYmVoYXZpb3IKICAgICAgICAgICAgICAgIGlmIChJbkF0dGFja1JhbmdlKCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gU3RhdGUuQXR0YWNrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgU3RhdGUuQXR0YWNrOgogICAgICAgICAgICAgICAgLy8gQXR0YWNrIGJlaGF2aW9yCiAgICAgICAgICAgICAgICBpZiAoIUluQXR0YWNrUmFuZ2UoKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSBTdGF0ZS5DaGFzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KCiAgICBib29sIFNlZVBsYXllcigpCiAgICB7CiAgICAgICAgLy8gTG9naWMgdG8gZGV0ZWN0IHBsYXllcgogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICBib29sIEluQXR0YWNrUmFuZ2UoKQogICAgewogICAgICAgIC8vIExvZ2ljIHRvIGNoZWNrIGlmIHBsYXllciBpcyBpbiBhdHRhY2sgcmFuZ2UKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using UnityEngine;

public class EnemyAI : MonoBehaviour
{
    private enum State
    {
        Idle,
        Patrol,
        Chase,
        Attack
    }

    private State currentState;

    void Start()
    {
        currentState = State.Idle;
    }

    void Update()
    {
        switch (currentState)
        {
            case State.Idle:
                // Idle behavior
                if (SeePlayer())
                {
                    currentState = State.Chase;
                }
                break;
            case State.Patrol:
                // Patrol behavior
                if (SeePlayer())
                {
                    currentState = State.Chase;
                }
                break;
            case State.Chase:
                // Chase behavior
                if (InAttackRange())
                {
                    currentState = State.Attack;
                }
                break;
            case State.Attack:
                // Attack behavior
                if (!InAttackRange())
                {
                    currentState = State.Chase;
                }
                break;
        }
    }

    bool SeePlayer()
    {
        // Logic to detect player
        return false;
    }

    bool InAttackRange()
    {
        // Logic to check if player is in attack range
        return false;
    }
}</pre></div><div class='content'></div><h3>Explanation</h3>
<div class='content'><ul>
<li><strong>State Enum</strong>: Defines the possible states (Idle, Patrol, Chase, Attack).</li>
<li><strong>currentState</strong>: Tracks the current state of the AI.</li>
<li><strong>Update Method</strong>: Checks conditions and transitions between states based on events (e.g., seeing the player, being in attack range).</li>
</ul>
</div><h2>Behavior Trees</h2>
<div class='content'></div><h3>What is a Behavior Tree?</h3>
<div class='content'><p>A behavior tree is a hierarchical model used to control the decision-making process of AI. It consists of:</p>
<ul>
<li><strong>Nodes</strong>: Represent tasks or actions.</li>
<li><strong>Branches</strong>: Define the flow of execution.</li>
<li><strong>Root</strong>: The starting point of the tree.</li>
</ul>
</div><h3>Key Concepts</h3>
<div class='content'><ol>
<li><strong>Root Node</strong>: The entry point of the behavior tree.</li>
<li><strong>Composite Nodes</strong>: Control the flow of execution (e.g., Sequence, Selector).</li>
<li><strong>Leaf Nodes</strong>: Perform actions or check conditions.</li>
</ol>
</div><h3>Example: Simple Behavior Tree for an Enemy AI</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgVW5pdHlFbmdpbmU7CgpwdWJsaWMgY2xhc3MgRW5lbXlCZWhhdmlvclRyZWUgOiBNb25vQmVoYXZpb3VyCnsKICAgIHByaXZhdGUgZW51bSBOb2RlU3RhdGUKICAgIHsKICAgICAgICBTdWNjZXNzLAogICAgICAgIEZhaWx1cmUsCiAgICAgICAgUnVubmluZwogICAgfQoKICAgIHByaXZhdGUgYWJzdHJhY3QgY2xhc3MgTm9kZQogICAgewogICAgICAgIHB1YmxpYyBhYnN0cmFjdCBOb2RlU3RhdGUgRXZhbHVhdGUoKTsKICAgIH0KCiAgICBwcml2YXRlIGNsYXNzIFNlcXVlbmNlIDogTm9kZQogICAgewogICAgICAgIHByaXZhdGUgTm9kZVtdIG5vZGVzOwoKICAgICAgICBwdWJsaWMgU2VxdWVuY2UocGFyYW1zIE5vZGVbXSBub2RlcykKICAgICAgICB7CiAgICAgICAgICAgIHRoaXMubm9kZXMgPSBub2RlczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBvdmVycmlkZSBOb2RlU3RhdGUgRXZhbHVhdGUoKQogICAgICAgIHsKICAgICAgICAgICAgZm9yZWFjaCAoTm9kZSBub2RlIGluIG5vZGVzKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBOb2RlU3RhdGUgcmVzdWx0ID0gbm9kZS5FdmFsdWF0ZSgpOwogICAgICAgICAgICAgICAgaWYgKHJlc3VsdCA9PSBOb2RlU3RhdGUuRmFpbHVyZSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gTm9kZVN0YXRlLkZhaWx1cmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09IE5vZGVTdGF0ZS5SdW5uaW5nKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBOb2RlU3RhdGUuUnVubmluZzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gTm9kZVN0YXRlLlN1Y2Nlc3M7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgY2xhc3MgU2VsZWN0b3IgOiBOb2RlCiAgICB7CiAgICAgICAgcHJpdmF0ZSBOb2RlW10gbm9kZXM7CgogICAgICAgIHB1YmxpYyBTZWxlY3RvcihwYXJhbXMgTm9kZVtdIG5vZGVzKQogICAgICAgIHsKICAgICAgICAgICAgdGhpcy5ub2RlcyA9IG5vZGVzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIG92ZXJyaWRlIE5vZGVTdGF0ZSBFdmFsdWF0ZSgpCiAgICAgICAgewogICAgICAgICAgICBmb3JlYWNoIChOb2RlIG5vZGUgaW4gbm9kZXMpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIE5vZGVTdGF0ZSByZXN1bHQgPSBub2RlLkV2YWx1YXRlKCk7CiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09IE5vZGVTdGF0ZS5TdWNjZXNzKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBOb2RlU3RhdGUuU3VjY2VzczsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgPT0gTm9kZVN0YXRlLlJ1bm5pbmcpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5vZGVTdGF0ZS5SdW5uaW5nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBOb2RlU3RhdGUuRmFpbHVyZTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBjbGFzcyBDaGVja1BsYXllckluUmFuZ2UgOiBOb2RlCiAgICB7CiAgICAgICAgcHVibGljIG92ZXJyaWRlIE5vZGVTdGF0ZSBFdmFsdWF0ZSgpCiAgICAgICAgewogICAgICAgICAgICAvLyBMb2dpYyB0byBjaGVjayBpZiBwbGF5ZXIgaXMgaW4gcmFuZ2UKICAgICAgICAgICAgcmV0dXJuIE5vZGVTdGF0ZS5TdWNjZXNzOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIGNsYXNzIEF0dGFja1BsYXllciA6IE5vZGUKICAgIHsKICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgTm9kZVN0YXRlIEV2YWx1YXRlKCkKICAgICAgICB7CiAgICAgICAgICAgIC8vIExvZ2ljIHRvIGF0dGFjayBwbGF5ZXIKICAgICAgICAgICAgcmV0dXJuIE5vZGVTdGF0ZS5TdWNjZXNzOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIE5vZGUgcm9vdE5vZGU7CgogICAgdm9pZCBTdGFydCgpCiAgICB7CiAgICAgICAgcm9vdE5vZGUgPSBuZXcgU2VxdWVuY2UoCiAgICAgICAgICAgIG5ldyBDaGVja1BsYXllckluUmFuZ2UoKSwKICAgICAgICAgICAgbmV3IEF0dGFja1BsYXllcigpCiAgICAgICAgKTsKICAgIH0KCiAgICB2b2lkIFVwZGF0ZSgpCiAgICB7CiAgICAgICAgcm9vdE5vZGUuRXZhbHVhdGUoKTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using UnityEngine;

public class EnemyBehaviorTree : MonoBehaviour
{
    private enum NodeState
    {
        Success,
        Failure,
        Running
    }

    private abstract class Node
    {
        public abstract NodeState Evaluate();
    }

    private class Sequence : Node
    {
        private Node[] nodes;

        public Sequence(params Node[] nodes)
        {
            this.nodes = nodes;
        }

        public override NodeState Evaluate()
        {
            foreach (Node node in nodes)
            {
                NodeState result = node.Evaluate();
                if (result == NodeState.Failure)
                {
                    return NodeState.Failure;
                }
                if (result == NodeState.Running)
                {
                    return NodeState.Running;
                }
            }
            return NodeState.Success;
        }
    }

    private class Selector : Node
    {
        private Node[] nodes;

        public Selector(params Node[] nodes)
        {
            this.nodes = nodes;
        }

        public override NodeState Evaluate()
        {
            foreach (Node node in nodes)
            {
                NodeState result = node.Evaluate();
                if (result == NodeState.Success)
                {
                    return NodeState.Success;
                }
                if (result == NodeState.Running)
                {
                    return NodeState.Running;
                }
            }
            return NodeState.Failure;
        }
    }

    private class CheckPlayerInRange : Node
    {
        public override NodeState Evaluate()
        {
            // Logic to check if player is in range
            return NodeState.Success;
        }
    }

    private class AttackPlayer : Node
    {
        public override NodeState Evaluate()
        {
            // Logic to attack player
            return NodeState.Success;
        }
    }

    private Node rootNode;

    void Start()
    {
        rootNode = new Sequence(
            new CheckPlayerInRange(),
            new AttackPlayer()
        );
    }

    void Update()
    {
        rootNode.Evaluate();
    }
}</pre></div><div class='content'></div><h3>Explanation</h3>
<div class='content'><ul>
<li><strong>NodeState Enum</strong>: Represents the possible states of a node (Success, Failure, Running).</li>
<li><strong>Node Class</strong>: Abstract base class for all nodes.</li>
<li><strong>Sequence and Selector Classes</strong>: Composite nodes that control the flow of execution.</li>
<li><strong>CheckPlayerInRange and AttackPlayer Classes</strong>: Leaf nodes that perform specific actions.</li>
</ul>
</div><h2>Practical Exercise</h2>
<div class='content'></div><h3>Task</h3>
<div class='content'><p>Create a state machine and a behavior tree for an AI character that can:</p>
<ol>
<li>Patrol between waypoints.</li>
<li>Chase the player when in sight.</li>
<li>Attack the player when in range.</li>
</ol>
</div><h3>Solution</h3>
<div class='content'><h4>State Machine</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgVW5pdHlFbmdpbmU7CgpwdWJsaWMgY2xhc3MgUGF0cm9sQ2hhc2VBdHRhY2tBSSA6IE1vbm9CZWhhdmlvdXIKewogICAgcHJpdmF0ZSBlbnVtIFN0YXRlCiAgICB7CiAgICAgICAgUGF0cm9sLAogICAgICAgIENoYXNlLAogICAgICAgIEF0dGFjawogICAgfQoKICAgIHByaXZhdGUgU3RhdGUgY3VycmVudFN0YXRlOwogICAgcHVibGljIFRyYW5zZm9ybVtdIHdheXBvaW50czsKICAgIHByaXZhdGUgaW50IGN1cnJlbnRXYXlwb2ludEluZGV4ID0gMDsKCiAgICB2b2lkIFN0YXJ0KCkKICAgIHsKICAgICAgICBjdXJyZW50U3RhdGUgPSBTdGF0ZS5QYXRyb2w7CiAgICB9CgogICAgdm9pZCBVcGRhdGUoKQogICAgewogICAgICAgIHN3aXRjaCAoY3VycmVudFN0YXRlKQogICAgICAgIHsKICAgICAgICAgICAgY2FzZSBTdGF0ZS5QYXRyb2w6CiAgICAgICAgICAgICAgICBQYXRyb2woKTsKICAgICAgICAgICAgICAgIGlmIChTZWVQbGF5ZXIoKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSBTdGF0ZS5DaGFzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFN0YXRlLkNoYXNlOgogICAgICAgICAgICAgICAgQ2hhc2UoKTsKICAgICAgICAgICAgICAgIGlmIChJbkF0dGFja1JhbmdlKCkpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gU3RhdGUuQXR0YWNrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgU3RhdGUuQXR0YWNrOgogICAgICAgICAgICAgICAgQXR0YWNrKCk7CiAgICAgICAgICAgICAgICBpZiAoIUluQXR0YWNrUmFuZ2UoKSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSBTdGF0ZS5DaGFzZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KCiAgICB2b2lkIFBhdHJvbCgpCiAgICB7CiAgICAgICAgLy8gUGF0cm9sIGxvZ2ljCiAgICB9CgogICAgdm9pZCBDaGFzZSgpCiAgICB7CiAgICAgICAgLy8gQ2hhc2UgbG9naWMKICAgIH0KCiAgICB2b2lkIEF0dGFjaygpCiAgICB7CiAgICAgICAgLy8gQXR0YWNrIGxvZ2ljCiAgICB9CgogICAgYm9vbCBTZWVQbGF5ZXIoKQogICAgewogICAgICAgIC8vIExvZ2ljIHRvIGRldGVjdCBwbGF5ZXIKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgYm9vbCBJbkF0dGFja1JhbmdlKCkKICAgIHsKICAgICAgICAvLyBMb2dpYyB0byBjaGVjayBpZiBwbGF5ZXIgaXMgaW4gYXR0YWNrIHJhbmdlCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using UnityEngine;

public class PatrolChaseAttackAI : MonoBehaviour
{
    private enum State
    {
        Patrol,
        Chase,
        Attack
    }

    private State currentState;
    public Transform[] waypoints;
    private int currentWaypointIndex = 0;

    void Start()
    {
        currentState = State.Patrol;
    }

    void Update()
    {
        switch (currentState)
        {
            case State.Patrol:
                Patrol();
                if (SeePlayer())
                {
                    currentState = State.Chase;
                }
                break;
            case State.Chase:
                Chase();
                if (InAttackRange())
                {
                    currentState = State.Attack;
                }
                break;
            case State.Attack:
                Attack();
                if (!InAttackRange())
                {
                    currentState = State.Chase;
                }
                break;
        }
    }

    void Patrol()
    {
        // Patrol logic
    }

    void Chase()
    {
        // Chase logic
    }

    void Attack()
    {
        // Attack logic
    }

    bool SeePlayer()
    {
        // Logic to detect player
        return false;
    }

    bool InAttackRange()
    {
        // Logic to check if player is in attack range
        return false;
    }
}</pre></div><div class='content'><h4>Behavior Tree</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgVW5pdHlFbmdpbmU7CgpwdWJsaWMgY2xhc3MgUGF0cm9sQ2hhc2VBdHRhY2tCZWhhdmlvclRyZWUgOiBNb25vQmVoYXZpb3VyCnsKICAgIHByaXZhdGUgZW51bSBOb2RlU3RhdGUKICAgIHsKICAgICAgICBTdWNjZXNzLAogICAgICAgIEZhaWx1cmUsCiAgICAgICAgUnVubmluZwogICAgfQoKICAgIHByaXZhdGUgYWJzdHJhY3QgY2xhc3MgTm9kZQogICAgewogICAgICAgIHB1YmxpYyBhYnN0cmFjdCBOb2RlU3RhdGUgRXZhbHVhdGUoKTsKICAgIH0KCiAgICBwcml2YXRlIGNsYXNzIFNlcXVlbmNlIDogTm9kZQogICAgewogICAgICAgIHByaXZhdGUgTm9kZVtdIG5vZGVzOwoKICAgICAgICBwdWJsaWMgU2VxdWVuY2UocGFyYW1zIE5vZGVbXSBub2RlcykKICAgICAgICB7CiAgICAgICAgICAgIHRoaXMubm9kZXMgPSBub2RlczsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBvdmVycmlkZSBOb2RlU3RhdGUgRXZhbHVhdGUoKQogICAgICAgIHsKICAgICAgICAgICAgZm9yZWFjaCAoTm9kZSBub2RlIGluIG5vZGVzKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBOb2RlU3RhdGUgcmVzdWx0ID0gbm9kZS5FdmFsdWF0ZSgpOwogICAgICAgICAgICAgICAgaWYgKHJlc3VsdCA9PSBOb2RlU3RhdGUuRmFpbHVyZSkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gTm9kZVN0YXRlLkZhaWx1cmU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09IE5vZGVTdGF0ZS5SdW5uaW5nKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBOb2RlU3RhdGUuUnVubmluZzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gTm9kZVN0YXRlLlN1Y2Nlc3M7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgY2xhc3MgU2VsZWN0b3IgOiBOb2RlCiAgICB7CiAgICAgICAgcHJpdmF0ZSBOb2RlW10gbm9kZXM7CgogICAgICAgIHB1YmxpYyBTZWxlY3RvcihwYXJhbXMgTm9kZVtdIG5vZGVzKQogICAgICAgIHsKICAgICAgICAgICAgdGhpcy5ub2RlcyA9IG5vZGVzOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIG92ZXJyaWRlIE5vZGVTdGF0ZSBFdmFsdWF0ZSgpCiAgICAgICAgewogICAgICAgICAgICBmb3JlYWNoIChOb2RlIG5vZGUgaW4gbm9kZXMpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIE5vZGVTdGF0ZSByZXN1bHQgPSBub2RlLkV2YWx1YXRlKCk7CiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09IE5vZGVTdGF0ZS5TdWNjZXNzKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBOb2RlU3RhdGUuU3VjY2VzczsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgPT0gTm9kZVN0YXRlLlJ1bm5pbmcpCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5vZGVTdGF0ZS5SdW5uaW5nOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBOb2RlU3RhdGUuRmFpbHVyZTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBjbGFzcyBQYXRyb2wgOiBOb2RlCiAgICB7CiAgICAgICAgcHVibGljIG92ZXJyaWRlIE5vZGVTdGF0ZSBFdmFsdWF0ZSgpCiAgICAgICAgewogICAgICAgICAgICAvLyBQYXRyb2wgbG9naWMKICAgICAgICAgICAgcmV0dXJuIE5vZGVTdGF0ZS5TdWNjZXNzOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIGNsYXNzIENoYXNlIDogTm9kZQogICAgewogICAgICAgIHB1YmxpYyBvdmVycmlkZSBOb2RlU3RhdGUgRXZhbHVhdGUoKQogICAgICAgIHsKICAgICAgICAgICAgLy8gQ2hhc2UgbG9naWMKICAgICAgICAgICAgcmV0dXJuIE5vZGVTdGF0ZS5TdWNjZXNzOwogICAgICAgIH0KICAgIH0KCiAgICBwcml2YXRlIGNsYXNzIEF0dGFjayA6IE5vZGUKICAgIHsKICAgICAgICBwdWJsaWMgb3ZlcnJpZGUgTm9kZVN0YXRlIEV2YWx1YXRlKCkKICAgICAgICB7CiAgICAgICAgICAgIC8vIEF0dGFjayBsb2dpYwogICAgICAgICAgICByZXR1cm4gTm9kZVN0YXRlLlN1Y2Nlc3M7CiAgICAgICAgfQogICAgfQoKICAgIHByaXZhdGUgY2xhc3MgQ2hlY2tQbGF5ZXJJblJhbmdlIDogTm9kZQogICAgewogICAgICAgIHB1YmxpYyBvdmVycmlkZSBOb2RlU3RhdGUgRXZhbHVhdGUoKQogICAgICAgIHsKICAgICAgICAgICAgLy8gTG9naWMgdG8gY2hlY2sgaWYgcGxheWVyIGlzIGluIHJhbmdlCiAgICAgICAgICAgIHJldHVybiBOb2RlU3RhdGUuU3VjY2VzczsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBOb2RlIHJvb3ROb2RlOwoKICAgIHZvaWQgU3RhcnQoKQogICAgewogICAgICAgIHJvb3ROb2RlID0gbmV3IFNlbGVjdG9yKAogICAgICAgICAgICBuZXcgU2VxdWVuY2UoCiAgICAgICAgICAgICAgICBuZXcgQ2hlY2tQbGF5ZXJJblJhbmdlKCksCiAgICAgICAgICAgICAgICBuZXcgQXR0YWNrKCkKICAgICAgICAgICAgKSwKICAgICAgICAgICAgbmV3IENoYXNlKCksCiAgICAgICAgICAgIG5ldyBQYXRyb2woKQogICAgICAgICk7CiAgICB9CgogICAgdm9pZCBVcGRhdGUoKQogICAgewogICAgICAgIHJvb3ROb2RlLkV2YWx1YXRlKCk7CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using UnityEngine;

public class PatrolChaseAttackBehaviorTree : MonoBehaviour
{
    private enum NodeState
    {
        Success,
        Failure,
        Running
    }

    private abstract class Node
    {
        public abstract NodeState Evaluate();
    }

    private class Sequence : Node
    {
        private Node[] nodes;

        public Sequence(params Node[] nodes)
        {
            this.nodes = nodes;
        }

        public override NodeState Evaluate()
        {
            foreach (Node node in nodes)
            {
                NodeState result = node.Evaluate();
                if (result == NodeState.Failure)
                {
                    return NodeState.Failure;
                }
                if (result == NodeState.Running)
                {
                    return NodeState.Running;
                }
            }
            return NodeState.Success;
        }
    }

    private class Selector : Node
    {
        private Node[] nodes;

        public Selector(params Node[] nodes)
        {
            this.nodes = nodes;
        }

        public override NodeState Evaluate()
        {
            foreach (Node node in nodes)
            {
                NodeState result = node.Evaluate();
                if (result == NodeState.Success)
                {
                    return NodeState.Success;
                }
                if (result == NodeState.Running)
                {
                    return NodeState.Running;
                }
            }
            return NodeState.Failure;
        }
    }

    private class Patrol : Node
    {
        public override NodeState Evaluate()
        {
            // Patrol logic
            return NodeState.Success;
        }
    }

    private class Chase : Node
    {
        public override NodeState Evaluate()
        {
            // Chase logic
            return NodeState.Success;
        }
    }

    private class Attack : Node
    {
        public override NodeState Evaluate()
        {
            // Attack logic
            return NodeState.Success;
        }
    }

    private class CheckPlayerInRange : Node
    {
        public override NodeState Evaluate()
        {
            // Logic to check if player is in range
            return NodeState.Success;
        }
    }

    private Node rootNode;

    void Start()
    {
        rootNode = new Selector(
            new Sequence(
                new CheckPlayerInRange(),
                new Attack()
            ),
            new Chase(),
            new Patrol()
        );
    }

    void Update()
    {
        rootNode.Evaluate();
    }
}</pre></div><div class='content'></div><h2>Conclusion</h2>
<div class='content'><p>In this module, we explored state machines and behavior trees, two powerful tools for creating complex AI behaviors in Unity. We covered the basic concepts, provided practical examples, and included an exercise to reinforce your understanding. By mastering these techniques, you can create more dynamic and responsive AI characters in your games.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='08-03-basic-ai-scripting' title="Basic AI Scripting" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='08-03-basic-ai-scripting' title="Basic AI Scripting" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='09-01-profiling-optimization-techniques' title="Profiling and Optimization Techniques" class="py-2 px-3 btn btn-primary"
				data-read-mod="unity" data-read-unit="8-4">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='09-01-profiling-optimization-techniques' title="Profiling and Optimization Techniques" class="py-2 px-3 btn btn-primary" 
				data-read-mod="unity" data-read-unit="8-4">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Unity Course</h1>
<h2>Module 1: Introduction to Unity</h2>
<ul>
<li><a href="01-01-introduction-unity-installation">Introduction to Unity and Installation</a></li>
<li><a href="01-02-unity-interface-overview">Unity Interface Overview</a></li>
<li><a href="01-03-creating-first-project">Creating Your First Project</a></li>
<li><a href="01-04-basic-game-objects-components">Basic Game Objects and Components</a></li>
</ul>
<h2>Module 2: Basic Scripting in Unity</h2>
<ul>
<li><a href="02-01-introduction-csharp-unity">Introduction to C# for Unity</a></li>
<li><a href="02-02-creating-attaching-scripts">Creating and Attaching Scripts</a></li>
<li><a href="02-03-understanding-monobehaviour">Understanding MonoBehaviour</a></li>
<li><a href="02-04-basic-input-handling">Basic Input Handling</a></li>
</ul>
<h2>Module 3: Working with Assets</h2>
<ul>
<li><a href="03-01-importing-managing-assets">Importing and Managing Assets</a></li>
<li><a href="03-02-using-asset-store">Using the Asset Store</a></li>
<li><a href="03-03-creating-using-prefabs">Creating and Using Prefabs</a></li>
<li><a href="03-04-basic-animation">Basic Animation</a></li>
</ul>
<h2>Module 4: Physics and Collisions</h2>
<ul>
<li><a href="04-01-introduction-unity-physics">Introduction to Unity Physics</a></li>
<li><a href="04-02-rigidbodies-colliders">Rigidbodies and Colliders</a></li>
<li><a href="04-03-basic-collision-detection">Basic Collision Detection</a></li>
<li><a href="04-04-using-physics-materials">Using Physics Materials</a></li>
</ul>
<h2>Module 5: User Interface (UI)</h2>
<ul>
<li><a href="05-01-introduction-unity-ui">Introduction to Unity UI</a></li>
<li><a href="05-02-creating-customizing-ui-elements">Creating and Customizing UI Elements</a></li>
<li><a href="05-03-handling-ui-events">Handling UI Events</a></li>
<li><a href="05-04-creating-menus-huds">Creating Menus and HUDs</a></li>
</ul>
<h2>Module 6: Audio in Unity</h2>
<ul>
<li><a href="06-01-introduction-audio-unity">Introduction to Audio in Unity</a></li>
<li><a href="06-02-importing-using-audio-clips">Importing and Using Audio Clips</a></li>
<li><a href="06-03-basic-audio-scripting">Basic Audio Scripting</a></li>
<li><a href="06-04-3d-audio-spatial-sound">3D Audio and Spatial Sound</a></li>
</ul>
<h2>Module 7: Advanced Scripting</h2>
<ul>
<li><a href="07-01-advanced-csharp-concepts-unity">Advanced C# Concepts for Unity</a></li>
<li><a href="07-02-coroutines-asynchronous-programming">Coroutines and Asynchronous Programming</a></li>
<li><a href="07-03-scriptable-objects">Scriptable Objects</a></li>
<li><a href="07-04-custom-editors-gizmos">Custom Editors and Gizmos</a></li>
</ul>
<h2>Module 8: Advanced Physics and AI</h2>
<ul>
<li><a href="08-01-advanced-physics-techniques">Advanced Physics Techniques</a></li>
<li><a href="08-02-pathfinding-navigation">Pathfinding and Navigation</a></li>
<li><a href="08-03-basic-ai-scripting">Basic AI Scripting</a></li>
<li><a href="08-04-state-machines-behavior-trees">State Machines and Behavior Trees</a></li>
</ul>
<h2>Module 9: Optimization and Performance</h2>
<ul>
<li><a href="09-01-profiling-optimization-techniques">Profiling and Optimization Techniques</a></li>
<li><a href="09-02-memory-management">Memory Management</a></li>
<li><a href="09-03-reducing-draw-calls">Reducing Draw Calls</a></li>
<li><a href="09-04-optimizing-physics-collisions">Optimizing Physics and Collisions</a></li>
</ul>
<h2>Module 10: Publishing and Beyond</h2>
<ul>
<li><a href="10-01-building-publishing-game">Building and Publishing Your Game</a></li>
<li><a href="10-02-cross-platform-development">Cross-Platform Development</a></li>
<li><a href="10-03-using-unity-services">Using Unity Services</a></li>
<li><a href="10-04-next-steps-resources">Next Steps and Resources</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
