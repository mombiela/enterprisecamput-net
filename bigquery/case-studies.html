<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case Studies</title>

    <link rel="alternate" href="https://campusempresa.com/bigquery/case-studies" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/bigquery/case-studies" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/bigquery/case-studies" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/bigquery/case-studies" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/bigquery/case-studies" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='real-time-analytics'>&#x25C4;Real-Time Analytics</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Case Studies</a>
	</div>
	<div class='col-4 text-end'>
					<a href='capstone-project'>Capstone Project &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this section, we will explore real-world case studies to understand how BigQuery can be applied to solve various data challenges. By examining these case studies, you will gain insights into practical applications, best practices, and advanced techniques.</p>
</div><h1>Case Study 1: E-commerce Data Analysis</h1>
<div class='content'></div><h2>Overview</h2>
<div class='content'><p>An e-commerce company wants to analyze its sales data to understand customer behavior, optimize inventory, and improve marketing strategies.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Data Ingestion</strong>: Loading sales data into BigQuery.</li>
<li><strong>Data Transformation</strong>: Cleaning and transforming data for analysis.</li>
<li><strong>Query Optimization</strong>: Writing efficient queries to handle large datasets.</li>
<li><strong>Visualization</strong>: Using tools like Google Data Studio to visualize the results.</li>
</ul>
</div><h2>Steps and Code Examples</h2>
<div class='content'><h4>Data Ingestion</h4>
<p>First, load the sales data into BigQuery. Assume the data is in a CSV file stored in Google Cloud Storage.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gTG9hZCBkYXRhIGZyb20gR29vZ2xlIENsb3VkIFN0b3JhZ2UgaW50byBCaWdRdWVyeQpMT0FEIERBVEEgSU5UTyBgcHJvamVjdC5kYXRhc2V0LnNhbGVzYApGUk9NICdnczovL2J1Y2tldF9uYW1lL3NhbGVzX2RhdGEuY3N2JwpXSVRICiAgRk9STUFUID0gQ1NWLAogIEZJRUxEX0RFTElNSVRFUiA9ICcsJywKICBTS0lQX0xFQURJTkdfUk9XUyA9IDE7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Load data from Google Cloud Storage into BigQuery
LOAD DATA INTO `project.dataset.sales`
FROM 'gs://bucket_name/sales_data.csv'
WITH
  FORMAT = CSV,
  FIELD_DELIMITER = ',',
  SKIP_LEADING_ROWS = 1;</pre></div><div class='content'><h4>Data Transformation</h4>
<p>Clean and transform the data to make it suitable for analysis.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ3JlYXRlIGEgbmV3IHRhYmxlIHdpdGggY2xlYW5lZCBkYXRhCkNSRUFURSBUQUJMRSBgcHJvamVjdC5kYXRhc2V0LmNsZWFuZWRfc2FsZXNgIEFTClNFTEVDVAogIG9yZGVyX2lkLAogIGN1c3RvbWVyX2lkLAogIHByb2R1Y3RfaWQsCiAgQ0FTVChvcmRlcl9kYXRlIEFTIERBVEUpIEFTIG9yZGVyX2RhdGUsCiAgQ0FTVChxdWFudGl0eSBBUyBJTlQ2NCkgQVMgcXVhbnRpdHksCiAgQ0FTVChwcmljZSBBUyBGTE9BVDY0KSBBUyBwcmljZSwKICBxdWFudGl0eSAqIHByaWNlIEFTIHRvdGFsX2Ftb3VudApGUk9NCiAgYHByb2plY3QuZGF0YXNldC5zYWxlc2AKV0hFUkUKICBvcmRlcl9kYXRlIElTIE5PVCBOVUxMCiAgQU5EIHF1YW50aXR5ID4gMAogIEFORCBwcmljZSA+IDA7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Create a new table with cleaned data
CREATE TABLE `project.dataset.cleaned_sales` AS
SELECT
  order_id,
  customer_id,
  product_id,
  CAST(order_date AS DATE) AS order_date,
  CAST(quantity AS INT64) AS quantity,
  CAST(price AS FLOAT64) AS price,
  quantity * price AS total_amount
FROM
  `project.dataset.sales`
WHERE
  order_date IS NOT NULL
  AND quantity &gt; 0
  AND price &gt; 0;</pre></div><div class='content'><h4>Query Optimization</h4>
<p>Write optimized queries to analyze the data.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ2FsY3VsYXRlIHRvdGFsIHNhbGVzIHBlciBwcm9kdWN0ClNFTEVDVAogIHByb2R1Y3RfaWQsCiAgU1VNKHRvdGFsX2Ftb3VudCkgQVMgdG90YWxfc2FsZXMKRlJPTQogIGBwcm9qZWN0LmRhdGFzZXQuY2xlYW5lZF9zYWxlc2AKR1JPVVAgQlkKICBwcm9kdWN0X2lkCk9SREVSIEJZCiAgdG90YWxfc2FsZXMgREVTQzs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Calculate total sales per product
SELECT
  product_id,
  SUM(total_amount) AS total_sales
FROM
  `project.dataset.cleaned_sales`
GROUP BY
  product_id
ORDER BY
  total_sales DESC;</pre></div><div class='content'><h4>Visualization</h4>
<p>Use Google Data Studio to create visualizations based on the query results.</p>
</div><h1>Case Study 2: Real-time Analytics for IoT Devices</h1>
<div class='content'></div><h2>Overview</h2>
<div class='content'><p>A company wants to perform real-time analytics on data generated by IoT devices to monitor performance and detect anomalies.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Streaming Data</strong>: Ingesting real-time data into BigQuery.</li>
<li><strong>Window Functions</strong>: Using window functions to analyze time-series data.</li>
<li><strong>Anomaly Detection</strong>: Identifying anomalies in the data.</li>
</ul>
</div><h2>Steps and Code Examples</h2>
<div class='content'><h4>Streaming Data</h4>
<p>Ingest real-time data from IoT devices using BigQuery's streaming API.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IGJpZ3F1ZXJ5CgpjbGllbnQgPSBiaWdxdWVyeS5DbGllbnQoKQp0YWJsZV9pZCA9ICJwcm9qZWN0LmRhdGFzZXQuaW90X2RhdGEiCgpyb3dzX3RvX2luc2VydCA9IFsKICAgIHsiZGV2aWNlX2lkIjogImRldmljZV8xIiwgInRpbWVzdGFtcCI6ICIyMDIzLTEwLTAxVDEyOjAwOjAwWiIsICJ0ZW1wZXJhdHVyZSI6IDIyLjV9LAogICAgeyJkZXZpY2VfaWQiOiAiZGV2aWNlXzIiLCAidGltZXN0YW1wIjogIjIwMjMtMTAtMDFUMTI6MDE6MDBaIiwgInRlbXBlcmF0dXJlIjogMjMuMH0sCl0KCmVycm9ycyA9IGNsaWVudC5pbnNlcnRfcm93c19qc29uKHRhYmxlX2lkLCByb3dzX3RvX2luc2VydCkKaWYgZXJyb3JzID09IFtdOgogICAgcHJpbnQoIk5ldyByb3dzIGhhdmUgYmVlbiBhZGRlZC4iKQplbHNlOgogICAgcHJpbnQoIkVuY291bnRlcmVkIGVycm9ycyB3aGlsZSBpbnNlcnRpbmcgcm93czoge30iLmZvcm1hdChlcnJvcnMpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import bigquery

client = bigquery.Client()
table_id = &quot;project.dataset.iot_data&quot;

rows_to_insert = [
    {&quot;device_id&quot;: &quot;device_1&quot;, &quot;timestamp&quot;: &quot;2023-10-01T12:00:00Z&quot;, &quot;temperature&quot;: 22.5},
    {&quot;device_id&quot;: &quot;device_2&quot;, &quot;timestamp&quot;: &quot;2023-10-01T12:01:00Z&quot;, &quot;temperature&quot;: 23.0},
]

errors = client.insert_rows_json(table_id, rows_to_insert)
if errors == []:
    print(&quot;New rows have been added.&quot;)
else:
    print(&quot;Encountered errors while inserting rows: {}&quot;.format(errors))</pre></div><div class='content'><h4>Window Functions</h4>
<p>Use window functions to analyze the time-series data.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ2FsY3VsYXRlIG1vdmluZyBhdmVyYWdlIHRlbXBlcmF0dXJlIGZvciBlYWNoIGRldmljZQpTRUxFQ1QKICBkZXZpY2VfaWQsCiAgdGltZXN0YW1wLAogIHRlbXBlcmF0dXJlLAogIEFWRyh0ZW1wZXJhdHVyZSkgT1ZFUiAoUEFSVElUSU9OIEJZIGRldmljZV9pZCBPUkRFUiBCWSB0aW1lc3RhbXAgUk9XUyBCRVRXRUVOIDIgUFJFQ0VESU5HIEFORCBDVVJSRU5UIFJPVykgQVMgbW92aW5nX2F2Z190ZW1wCkZST00KICBgcHJvamVjdC5kYXRhc2V0LmlvdF9kYXRhYDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Calculate moving average temperature for each device
SELECT
  device_id,
  timestamp,
  temperature,
  AVG(temperature) OVER (PARTITION BY device_id ORDER BY timestamp ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS moving_avg_temp
FROM
  `project.dataset.iot_data`;</pre></div><div class='content'><h4>Anomaly Detection</h4>
<p>Identify anomalies in the temperature data.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRGV0ZWN0IHRlbXBlcmF0dXJlIGFub21hbGllcwpXSVRIIHRlbXBfc3RhdHMgQVMgKAogIFNFTEVDVAogICAgZGV2aWNlX2lkLAogICAgQVZHKHRlbXBlcmF0dXJlKSBBUyBhdmdfdGVtcCwKICAgIFNURERFVih0ZW1wZXJhdHVyZSkgQVMgc3RkZGV2X3RlbXAKICBGUk9NCiAgICBgcHJvamVjdC5kYXRhc2V0LmlvdF9kYXRhYAogIEdST1VQIEJZCiAgICBkZXZpY2VfaWQKKQpTRUxFQ1QKICBpb3QuZGV2aWNlX2lkLAogIGlvdC50aW1lc3RhbXAsCiAgaW90LnRlbXBlcmF0dXJlLAogIENBU0UKICAgIFdIRU4gQUJTKGlvdC50ZW1wZXJhdHVyZSAtIHRzLmF2Z190ZW1wKSA+IDMgKiB0cy5zdGRkZXZfdGVtcCBUSEVOICdBbm9tYWx5JwogICAgRUxTRSAnTm9ybWFsJwogIEVORCBBUyBzdGF0dXMKRlJPTQogIGBwcm9qZWN0LmRhdGFzZXQuaW90X2RhdGFgIEFTIGlvdApKT0lOCiAgdGVtcF9zdGF0cyBBUyB0cwpPTgogIGlvdC5kZXZpY2VfaWQgPSB0cy5kZXZpY2VfaWQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Detect temperature anomalies
WITH temp_stats AS (
  SELECT
    device_id,
    AVG(temperature) AS avg_temp,
    STDDEV(temperature) AS stddev_temp
  FROM
    `project.dataset.iot_data`
  GROUP BY
    device_id
)
SELECT
  iot.device_id,
  iot.timestamp,
  iot.temperature,
  CASE
    WHEN ABS(iot.temperature - ts.avg_temp) &gt; 3 * ts.stddev_temp THEN 'Anomaly'
    ELSE 'Normal'
  END AS status
FROM
  `project.dataset.iot_data` AS iot
JOIN
  temp_stats AS ts
ON
  iot.device_id = ts.device_id;</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>By examining these case studies, you have learned how to apply BigQuery to real-world scenarios. You have seen how to ingest, transform, and analyze data, as well as how to optimize queries and visualize results. These examples should provide a solid foundation for tackling your own data challenges using BigQuery.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='real-time-analytics'>&#x25C4;Real-Time Analytics</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Case Studies</a>
	</div>
	<div class='col-4 text-end'>
					<a href='capstone-project'>Capstone Project &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
