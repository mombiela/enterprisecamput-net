<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unsafe Functions and Traits</title>

    <link rel="alternate" href="https://campusempresa.com/rust/unsafe-functions-and-traits" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/rust/unsafe-functions-and-traits" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/rust/unsafe-functions-and-traits" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/rust/unsafe-functions-and-traits" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/rust/unsafe-functions-and-traits" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='raw-pointers'>&#x25C4;Raw Pointers</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Unsafe Functions and Traits</a>
	</div>
	<div class='col-4 text-end'>
					<a href='writing-tests'>Writing Tests &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Unsafe Rust</h1>
<div class='content'><p>Rust is designed to be a safe systems programming language, but there are times when you need to perform operations that the Rust compiler cannot guarantee to be safe. This is where <code>unsafe</code> comes into play. The <code>unsafe</code> keyword in Rust allows you to bypass some of Rust's safety checks, giving you more control but also more responsibility.</p>
<ul>
<li><strong>Key Concepts:</strong>
<ul>
<li><code>unsafe</code> keyword</li>
<li>Unsafe functions</li>
<li>Unsafe traits</li>
<li>Unsafe blocks</li>
</ul>
</li>
</ul>
</div><h1>Unsafe Keyword</h1>
<div class='content'><p>The <code>unsafe</code> keyword in Rust is used to indicate that a block of code, a function, or a trait has operations that the Rust compiler cannot guarantee to be safe.</p>
<ul>
<li><strong>Unsafe Blocks:</strong> Allow you to perform unsafe operations within a safe function.</li>
<li><strong>Unsafe Functions:</strong> Functions that contain unsafe code and must be called within an unsafe block.</li>
<li><strong>Unsafe Traits:</strong> Traits that have methods which can only be implemented using unsafe code.</li>
</ul>
</div><h2>Unsafe Blocks</h2>
<div class='content'><p>An unsafe block allows you to perform operations that the Rust compiler cannot verify as safe. This includes dereferencing raw pointers, calling unsafe functions, and accessing mutable static variables.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Zm4gbWFpbigpIHsKICAgIGxldCBtdXQgbnVtID0gNTsKICAgIGxldCByMSA9ICZudW0gYXMgKmNvbnN0IGkzMjsKICAgIGxldCByMiA9ICZtdXQgbnVtIGFzICptdXQgaTMyOwoKICAgIHVuc2FmZSB7CiAgICAgICAgcHJpbnRsbiEoInIxIGlzOiB7fSIsICpyMSk7CiAgICAgICAgcHJpbnRsbiEoInIyIGlzOiB7fSIsICpyMik7CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>fn main() {
    let mut num = 5;
    let r1 = &amp;num as *const i32;
    let r2 = &amp;mut num as *mut i32;

    unsafe {
        println!(&quot;r1 is: {}&quot;, *r1);
        println!(&quot;r2 is: {}&quot;, *r2);
    }
}</pre></div><div class='content'><p>In this example, dereferencing raw pointers is an unsafe operation, so it must be done within an unsafe block.</p>
</div><h2>Unsafe Functions</h2>
<div class='content'><p>Unsafe functions are functions that contain unsafe code. They must be called within an unsafe block.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dW5zYWZlIGZuIGRhbmdlcm91cygpIHsKICAgIC8vIFVuc2FmZSBvcGVyYXRpb25zCn0KCmZuIG1haW4oKSB7CiAgICB1bnNhZmUgewogICAgICAgIGRhbmdlcm91cygpOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>unsafe fn dangerous() {
    // Unsafe operations
}

fn main() {
    unsafe {
        dangerous();
    }
}</pre></div><div class='content'><p>Here, the <code>dangerous</code> function is marked as unsafe, and it must be called within an unsafe block.</p>
</div><h2>Unsafe Traits</h2>
<div class='content'><p>Unsafe traits are traits that have methods which can only be implemented using unsafe code.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dW5zYWZlIHRyYWl0IFVuc2FmZVRyYWl0IHsKICAgIC8vIE1ldGhvZHMgdGhhdCByZXF1aXJlIHVuc2FmZSBpbXBsZW1lbnRhdGlvbgp9Cgp1bnNhZmUgaW1wbCBVbnNhZmVUcmFpdCBmb3IgU29tZVR5cGUgewogICAgLy8gVW5zYWZlIGltcGxlbWVudGF0aW9uCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>unsafe trait UnsafeTrait {
    // Methods that require unsafe implementation
}

unsafe impl UnsafeTrait for SomeType {
    // Unsafe implementation
}</pre></div><div class='content'><p>In this example, <code>UnsafeTrait</code> is an unsafe trait, and it is implemented for <code>SomeType</code> using unsafe code.</p>
</div><h1>When to Use Unsafe Rust</h1>
<div class='content'><p>Using <code>unsafe</code> in Rust should be done with caution. Here are some scenarios where <code>unsafe</code> might be necessary:</p>
<ul>
<li><strong>Interfacing with C:</strong> When calling C functions or using FFI (Foreign Function Interface).</li>
<li><strong>Performance Optimization:</strong> When you need to perform low-level optimizations that the Rust compiler cannot guarantee as safe.</li>
<li><strong>Implementing Unsafe Traits:</strong> When implementing traits that require unsafe code.</li>
</ul>
</div><h1>Examples and Exercises</h1>
<div class='content'></div><h2>Example 1: Dereferencing Raw Pointers</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Zm4gbWFpbigpIHsKICAgIGxldCBtdXQgbnVtID0gMTA7CiAgICBsZXQgcjEgPSAmbnVtIGFzICpjb25zdCBpMzI7CiAgICBsZXQgcjIgPSAmbXV0IG51bSBhcyAqbXV0IGkzMjsKCiAgICB1bnNhZmUgewogICAgICAgIHByaW50bG4hKCJyMSBwb2ludHMgdG86IHt9IiwgKnIxKTsKICAgICAgICBwcmludGxuISgicjIgcG9pbnRzIHRvOiB7fSIsICpyMik7CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>fn main() {
    let mut num = 10;
    let r1 = &amp;num as *const i32;
    let r2 = &amp;mut num as *mut i32;

    unsafe {
        println!(&quot;r1 points to: {}&quot;, *r1);
        println!(&quot;r2 points to: {}&quot;, *r2);
    }
}</pre></div><div class='content'><ul>
<li><strong>Explanation:</strong> This example demonstrates how to dereference raw pointers within an unsafe block.</li>
</ul>
</div><h2>Exercise 1: Create an Unsafe Function</h2>
<div class='content'><p>Create an unsafe function called <code>unsafe_add</code> that takes two raw pointers to integers and returns their sum.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dW5zYWZlIGZuIHVuc2FmZV9hZGQoYTogKmNvbnN0IGkzMiwgYjogKmNvbnN0IGkzMikgLT4gaTMyIHsKICAgICphICsgKmIKfQoKZm4gbWFpbigpIHsKICAgIGxldCB4ID0gNTsKICAgIGxldCB5ID0gMTA7CiAgICBsZXQgc3VtID0gdW5zYWZlIHsKICAgICAgICB1bnNhZmVfYWRkKCZ4LCAmeSkKICAgIH07CiAgICBwcmludGxuISgiU3VtOiB7fSIsIHN1bSk7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>unsafe fn unsafe_add(a: *const i32, b: *const i32) -&gt; i32 {
    *a + *b
}

fn main() {
    let x = 5;
    let y = 10;
    let sum = unsafe {
        unsafe_add(&amp;x, &amp;y)
    };
    println!(&quot;Sum: {}&quot;, sum);
}</pre></div><div class='content'></div><h2>Example 2: Implementing an Unsafe Trait</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dW5zYWZlIHRyYWl0IFVuc2FmZVRyYWl0IHsKICAgIGZuIHVuc2FmZV9tZXRob2QoJnNlbGYpOwp9CgpzdHJ1Y3QgTXlTdHJ1Y3Q7Cgp1bnNhZmUgaW1wbCBVbnNhZmVUcmFpdCBmb3IgTXlTdHJ1Y3QgewogICAgZm4gdW5zYWZlX21ldGhvZCgmc2VsZikgewogICAgICAgIHByaW50bG4hKCJVbnNhZmUgbWV0aG9kIGNhbGxlZCIpOwogICAgfQp9CgpmbiBtYWluKCkgewogICAgbGV0IGluc3RhbmNlID0gTXlTdHJ1Y3Q7CiAgICB1bnNhZmUgewogICAgICAgIGluc3RhbmNlLnVuc2FmZV9tZXRob2QoKTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>unsafe trait UnsafeTrait {
    fn unsafe_method(&amp;self);
}

struct MyStruct;

unsafe impl UnsafeTrait for MyStruct {
    fn unsafe_method(&amp;self) {
        println!(&quot;Unsafe method called&quot;);
    }
}

fn main() {
    let instance = MyStruct;
    unsafe {
        instance.unsafe_method();
    }
}</pre></div><div class='content'><ul>
<li><strong>Explanation:</strong> This example shows how to define and implement an unsafe trait.</li>
</ul>
</div><h2>Exercise 2: Implement an Unsafe Trait</h2>
<div class='content'><p>Define an unsafe trait called <code>UnsafeMath</code> with a method <code>unsafe_multiply</code> that multiplies two integers. Implement this trait for a struct called <code>Calculator</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dW5zYWZlIHRyYWl0IFVuc2FmZU1hdGggewogICAgZm4gdW5zYWZlX211bHRpcGx5KCZzZWxmLCBhOiBpMzIsIGI6IGkzMikgLT4gaTMyOwp9CgpzdHJ1Y3QgQ2FsY3VsYXRvcjsKCnVuc2FmZSBpbXBsIFVuc2FmZU1hdGggZm9yIENhbGN1bGF0b3IgewogICAgZm4gdW5zYWZlX211bHRpcGx5KCZzZWxmLCBhOiBpMzIsIGI6IGkzMikgLT4gaTMyIHsKICAgICAgICBhICogYgogICAgfQp9CgpmbiBtYWluKCkgewogICAgbGV0IGNhbGMgPSBDYWxjdWxhdG9yOwogICAgbGV0IHJlc3VsdCA9IHVuc2FmZSB7CiAgICAgICAgY2FsYy51bnNhZmVfbXVsdGlwbHkoMywgNCkKICAgIH07CiAgICBwcmludGxuISgiUmVzdWx0OiB7fSIsIHJlc3VsdCk7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>unsafe trait UnsafeMath {
    fn unsafe_multiply(&amp;self, a: i32, b: i32) -&gt; i32;
}

struct Calculator;

unsafe impl UnsafeMath for Calculator {
    fn unsafe_multiply(&amp;self, a: i32, b: i32) -&gt; i32 {
        a * b
    }
}

fn main() {
    let calc = Calculator;
    let result = unsafe {
        calc.unsafe_multiply(3, 4)
    };
    println!(&quot;Result: {}&quot;, result);
}</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Using <code>unsafe</code> in Rust allows you to perform operations that the compiler cannot guarantee to be safe. While it provides more control and flexibility, it also comes with greater responsibility. Always use <code>unsafe</code> with caution and ensure that you understand the implications of bypassing Rust's safety checks.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='raw-pointers'>&#x25C4;Raw Pointers</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Unsafe Functions and Traits</a>
	</div>
	<div class='col-4 text-end'>
					<a href='writing-tests'>Writing Tests &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
