<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mutexes and Synchronization in Go</title>

    <link rel="alternate" href="https://campusempresa.com/go/mutexes-and-synchronization" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/go/mutexes-and-synchronization" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/go/mutexes-and-synchronization" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/go/mutexes-and-synchronization" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/go/mutexes-and-synchronization" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='select-statement'>&#x25C4;Select Statement</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Mutexes and Synchronization in Go</a>
	</div>
	<div class='col-4 text-end'>
					<a href='interfaces'>Interfaces &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In concurrent programming, managing access to shared resources is crucial to avoid race conditions and ensure data consistency. Go provides several synchronization primitives, with mutexes being one of the most fundamental. This section will cover the basics of mutexes, how to use them in Go, and best practices for synchronization.</p>
</div><h1>What is a Mutex?</h1>
<div class='content'><p>A mutex, or mutual exclusion lock, is a synchronization primitive used to protect shared resources from concurrent access. When a goroutine locks a mutex, other goroutines that attempt to lock it are blocked until the mutex is unlocked.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Locking</strong>: Acquiring the mutex to gain exclusive access to a resource.</li>
<li><strong>Unlocking</strong>: Releasing the mutex to allow other goroutines to access the resource.</li>
<li><strong>Race Condition</strong>: A situation where the behavior of software depends on the relative timing of events, such as the order of execution of goroutines.</li>
</ul>
</div><h1>Using Mutexes in Go</h1>
<div class='content'><p>Go's <code>sync</code> package provides the <code>Mutex</code> type for mutual exclusion. Below are the steps to use a mutex in Go.</p>
</div><h2>Importing the sync Package</h2>
<div class='content'><p>First, you need to import the <code>sync</code> package:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0ICJzeW5jIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import &quot;sync&quot;</pre></div><div class='content'></div><h2>Declaring a Mutex</h2>
<div class='content'><p>You can declare a mutex as part of a struct or as a standalone variable:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyIG11IHN5bmMuTXV0ZXg="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var mu sync.Mutex</pre></div><div class='content'></div><h2>Locking and Unlocking a Mutex</h2>
<div class='content'><p>To protect a critical section, you lock the mutex before accessing the shared resource and unlock it afterward:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bXUuTG9jaygpCi8vIENyaXRpY2FsIHNlY3Rpb246IGFjY2VzcyBzaGFyZWQgcmVzb3VyY2UKbXUuVW5sb2NrKCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>mu.Lock()
// Critical section: access shared resource
mu.Unlock()</pre></div><div class='content'></div><h2>Example: Protecting a Counter</h2>
<div class='content'><p>Let's look at a simple example where multiple goroutines increment a shared counter.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGFja2FnZSBtYWluCgppbXBvcnQgKAogICAgImZtdCIKICAgICJzeW5jIgopCgp2YXIgKAogICAgY291bnRlciBpbnQKICAgIG11ICAgICAgc3luYy5NdXRleAopCgpmdW5jIGluY3JlbWVudCh3ZyAqc3luYy5XYWl0R3JvdXApIHsKICAgIGRlZmVyIHdnLkRvbmUoKQogICAgbXUuTG9jaygpCiAgICBjb3VudGVyKysKICAgIG11LlVubG9jaygpCn0KCmZ1bmMgbWFpbigpIHsKICAgIHZhciB3ZyBzeW5jLldhaXRHcm91cAoKICAgIGZvciBpIDo9IDA7IGkgPCAxMDAwOyBpKysgewogICAgICAgIHdnLkFkZCgxKQogICAgICAgIGdvIGluY3JlbWVudCgmd2cpCiAgICB9CgogICAgd2cuV2FpdCgpCiAgICBmbXQuUHJpbnRsbigiRmluYWwgQ291bnRlcjoiLCBjb3VudGVyKQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>package main

import (
    &quot;fmt&quot;
    &quot;sync&quot;
)

var (
    counter int
    mu      sync.Mutex
)

func increment(wg *sync.WaitGroup) {
    defer wg.Done()
    mu.Lock()
    counter++
    mu.Unlock()
}

func main() {
    var wg sync.WaitGroup

    for i := 0; i &lt; 1000; i++ {
        wg.Add(1)
        go increment(&amp;wg)
    }

    wg.Wait()
    fmt.Println(&quot;Final Counter:&quot;, counter)
}</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>sync.WaitGroup</strong>: Used to wait for all goroutines to finish.</li>
<li><strong>mu.Lock() and mu.Unlock()</strong>: Ensure that only one goroutine can increment the counter at a time.</li>
<li><strong>wg.Add(1) and wg.Done()</strong>: Manage the number of goroutines to wait for.</li>
</ul>
</div><h1>Best Practices for Using Mutexes</h1>
<div class='content'><ul>
<li><strong>Minimize Critical Sections</strong>: Keep the code within <code>mu.Lock()</code> and <code>mu.Unlock()</code> as short as possible to reduce contention.</li>
<li><strong>Avoid Deadlocks</strong>: Ensure that all code paths unlock the mutex, even in the case of errors or panics.</li>
<li><strong>Use defer for Unlocking</strong>: This ensures that the mutex is always unlocked, even if the function returns early.
<pre><code class="language-go">mu.Lock()
defer mu.Unlock()
</code></pre>
</li>
</ul>
</div><h1>Advanced Synchronization Techniques</h1>
<div class='content'><p>While mutexes are powerful, Go provides other synchronization primitives that might be more suitable for certain scenarios.</p>
</div><h2>sync.RWMutex</h2>
<div class='content'><p>A <code>RWMutex</code> allows multiple readers or a single writer, providing better performance for read-heavy workloads.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyIHJ3TXUgc3luYy5SV011dGV4CgovLyBSZWFkaW5nCnJ3TXUuUkxvY2soKQovLyBSZWFkIHNoYXJlZCByZXNvdXJjZQpyd011LlJVbmxvY2soKQoKLy8gV3JpdGluZwpyd011LkxvY2soKQovLyBXcml0ZSBzaGFyZWQgcmVzb3VyY2UKcndNdS5VbmxvY2soKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var rwMu sync.RWMutex

// Reading
rwMu.RLock()
// Read shared resource
rwMu.RUnlock()

// Writing
rwMu.Lock()
// Write shared resource
rwMu.Unlock()</pre></div><div class='content'></div><h2>sync.Cond</h2>
<div class='content'><p>A <code>Cond</code> (condition variable) allows goroutines to wait for or signal events.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyIGNvbmQgPSBzeW5jLk5ld0NvbmQoJnN5bmMuTXV0ZXh7fSkKCmZ1bmMgd2FpdEZvckNvbmRpdGlvbigpIHsKICAgIGNvbmQuTC5Mb2NrKCkKICAgIGNvbmQuV2FpdCgpCiAgICAvLyBDb25kaXRpb24gbWV0LCBwcm9jZWVkCiAgICBjb25kLkwuVW5sb2NrKCkKfQoKZnVuYyBzaWduYWxDb25kaXRpb24oKSB7CiAgICBjb25kLkwuTG9jaygpCiAgICBjb25kLlNpZ25hbCgpCiAgICBjb25kLkwuVW5sb2NrKCkKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var cond = sync.NewCond(&amp;sync.Mutex{})

func waitForCondition() {
    cond.L.Lock()
    cond.Wait()
    // Condition met, proceed
    cond.L.Unlock()
}

func signalCondition() {
    cond.L.Lock()
    cond.Signal()
    cond.L.Unlock()
}</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Mutexes are essential tools for managing concurrent access to shared resources in Go. By understanding how to use <code>sync.Mutex</code> and <code>sync.RWMutex</code>, you can write safe and efficient concurrent programs. Remember to follow best practices to avoid common pitfalls like deadlocks and race conditions. As you advance, explore other synchronization primitives like <code>sync.Cond</code> to handle more complex synchronization scenarios.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='select-statement'>&#x25C4;Select Statement</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Mutexes and Synchronization in Go</a>
	</div>
	<div class='col-4 text-end'>
					<a href='interfaces'>Interfaces &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
