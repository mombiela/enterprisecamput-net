<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Programs</title>

    <link rel="alternate" href="https://campusempresa.com/rpg/service-programs" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/rpg/service-programs" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/rpg/service-programs" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/rpg/service-programs" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/rpg/service-programs" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='creating-using-modules'>&#x25C4;Creating and Using Modules</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Service Programs</a>
	</div>
	<div class='col-4 text-end'>
					<a href='binding-directories'>Binding Directories &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Service Programs are a powerful feature in RPG that allow you to encapsulate and reuse code across multiple applications. This topic will guide you through understanding, creating, and using service programs from a beginner to an advanced level.</p>
</div><h1>Introduction to Service Programs</h1>
<div class='content'><p>Service Programs in RPG are similar to dynamic link libraries (DLLs) in other programming languages. They allow you to group related procedures and functions into a single module that can be used by multiple programs.</p>
<ul>
<li><strong>Encapsulation</strong>: Group related procedures together.</li>
<li><strong>Reusability</strong>: Use the same procedures across different programs without duplicating code.</li>
<li><strong>Maintainability</strong>: Update procedures in one place, and all programs using the service program will automatically use the updated code.</li>
</ul>
</div><h1>Creating a Service Program</h1>
<div class='content'></div><h2>Defining Procedures</h2>
<div class='content'><p>To create a service program, you first need to define the procedures you want to include. Here's a simple example of defining procedures in an RPG module:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("KipmcmVlCi8vIFByb2NlZHVyZSB0byBhZGQgdHdvIG51bWJlcnMKZGNsLXByb2MgQWRkTnVtYmVyczsKICBkY2wtcGkgKm4gaW50KDEwKTsKICAgIG51bTEgaW50KDEwKTsKICAgIG51bTIgaW50KDEwKTsKICBlbmQtcGk7CgogIHJldHVybiBudW0xICsgbnVtMjsKZW5kLXByb2M7CgovLyBQcm9jZWR1cmUgdG8gc3VidHJhY3QgdHdvIG51bWJlcnMKZGNsLXByb2MgU3VidHJhY3ROdW1iZXJzOwogIGRjbC1waSAqbiBpbnQoMTApOwogICAgbnVtMSBpbnQoMTApOwogICAgbnVtMiBpbnQoMTApOwogIGVuZC1waTsKCiAgcmV0dXJuIG51bTEgLSBudW0yOwplbmQtcHJvYzs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>**free
// Procedure to add two numbers
dcl-proc AddNumbers;
  dcl-pi *n int(10);
    num1 int(10);
    num2 int(10);
  end-pi;

  return num1 + num2;
end-proc;

// Procedure to subtract two numbers
dcl-proc SubtractNumbers;
  dcl-pi *n int(10);
    num1 int(10);
    num2 int(10);
  end-pi;

  return num1 - num2;
end-proc;</pre></div><div class='content'></div><h2>Creating the Module</h2>
<div class='content'><p>Compile the above code into a module. In IBM i, you can use the <code>CRTRPGMOD</code> command:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JUUlBHTU9EIE1PRFVMRShNWUxJQi9NWVNSVlBHTSkgU1JDRklMRShNWUxJQi9RUlBHTEVTUkMpIFNSQ01CUihNWVNSVlBHTSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CRTRPGMOD MODULE(MYLIB/MYSRVPGM) SRCFILE(MYLIB/QRPGLESRC) SRCMBR(MYSRVPGM)</pre></div><div class='content'></div><h2>Binding the Module into a Service Program</h2>
<div class='content'><p>Once you have your module, you need to create a service program using the <code>CRTSRVPGM</code> command:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JUU1JWUEdNIFNSVlBHTShNWUxJQi9NWVNSVlBHTSkgTU9EVUxFKE1ZTElCL01ZU1JWUEdNKSBFWFBPUlQoKkFMTCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CRTSRVPGM SRVPGM(MYLIB/MYSRVPGM) MODULE(MYLIB/MYSRVPGM) EXPORT(*ALL)</pre></div><div class='content'></div><h1>Using a Service Program</h1>
<div class='content'></div><h2>Binding a Service Program to a Program</h2>
<div class='content'><p>To use the procedures in a service program, you need to bind the service program to your RPG program. Here’s an example of how to call the procedures from a service program:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("KipmcmVlCi8vIFByb3RvdHlwZSBmb3IgdGhlIEFkZE51bWJlcnMgcHJvY2VkdXJlCmRjbC1wciBBZGROdW1iZXJzIGludCgxMCk7CiAgbnVtMSBpbnQoMTApOwogIG51bTIgaW50KDEwKTsKZW5kLXByOwoKLy8gUHJvdG90eXBlIGZvciB0aGUgU3VidHJhY3ROdW1iZXJzIHByb2NlZHVyZQpkY2wtcHIgU3VidHJhY3ROdW1iZXJzIGludCgxMCk7CiAgbnVtMSBpbnQoMTApOwogIG51bTIgaW50KDEwKTsKZW5kLXByOwoKZGNsLXMgcmVzdWx0IGludCgxMCk7CgpyZXN1bHQgPSBBZGROdW1iZXJzKDEwLCA1KTsKZHNwbHkgcmVzdWx0OyAvLyBEaXNwbGF5cyAxNQoKcmVzdWx0ID0gU3VidHJhY3ROdW1iZXJzKDEwLCA1KTsKZHNwbHkgcmVzdWx0OyAvLyBEaXNwbGF5cyA1CgoqaW5sciA9ICpvbjs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>**free
// Prototype for the AddNumbers procedure
dcl-pr AddNumbers int(10);
  num1 int(10);
  num2 int(10);
end-pr;

// Prototype for the SubtractNumbers procedure
dcl-pr SubtractNumbers int(10);
  num1 int(10);
  num2 int(10);
end-pr;

dcl-s result int(10);

result = AddNumbers(10, 5);
dsply result; // Displays 15

result = SubtractNumbers(10, 5);
dsply result; // Displays 5

*inlr = *on;</pre></div><div class='content'></div><h2>Binding Directory</h2>
<div class='content'><p>You need to specify the service program in the binding directory. Use the <code>CRTBNDCL</code> command:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JUQk5EQ0wgUEdNKE1ZTElCL01ZUEdNKSBTUkNGSUxFKE1ZTElCL1FDTExFU1JDKSBTUkNNQlIoTVlQR00pIEJORERJUihNWUxJQi9NWUJORERJUik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CRTBNDCL PGM(MYLIB/MYPGM) SRCFILE(MYLIB/QCLLESRC) SRCMBR(MYPGM) BNDDIR(MYLIB/MYBNDDIR)</pre></div><div class='content'><p>Ensure that the binding directory includes the service program:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QUREQk5ERElSRSBCTkRESVIoTVlMSUIvTVlCTkRESVIpIE9CSigoTVlMSUIvTVlTUlZQR00gKlNSVlBHTSkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ADDBNDDIRE BNDDIR(MYLIB/MYBNDDIR) OBJ((MYLIB/MYSRVPGM *SRVPGM))</pre></div><div class='content'></div><h1>Advanced Usage</h1>
<div class='content'></div><h2>Versioning Service Programs</h2>
<div class='content'><p>As your applications evolve, you may need to update your service programs. Versioning allows you to manage changes without breaking existing applications.</p>
<ul>
<li><strong>Backward Compatibility</strong>: Ensure new versions of procedures do not break existing functionality.</li>
<li><strong>Export Lists</strong>: Use export lists to control which procedures are available to calling programs.</li>
</ul>
</div><h2>Example of Export Lists</h2>
<div class='content'><p>Define an export list in your service program:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JUU1JWUEdNIFNSVlBHTShNWUxJQi9NWVNSVlBHTSkgTU9EVUxFKE1ZTElCL01ZU1JWUEdNKSBFWFBPUlQoKlNSQ0ZJTEUpIFNSQ0ZJTEUoTVlMSUIvUVNSVlNSQykgU1JDTUJSKEVYUE9SVFMp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CRTSRVPGM SRVPGM(MYLIB/MYSRVPGM) MODULE(MYLIB/MYSRVPGM) EXPORT(*SRCFILE) SRCFILE(MYLIB/QSRVSRC) SRCMBR(EXPORTS)</pre></div><div class='content'><p>In the <code>EXPORTS</code> source member:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QWRkTnVtYmVycwpTdWJ0cmFjdE51bWJlcnM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>AddNumbers
SubtractNumbers</pre></div><div class='content'></div><h2>Dynamic Binding</h2>
<div class='content'><p>Dynamic binding allows you to call procedures in a service program at runtime, providing flexibility in how you use service programs.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("KipmcmVlCmRjbC1wciBEeW5hbWljQWRkTnVtYmVycyBleHRwZ20oJ01ZU1JWUEdNJyk7CiAgbnVtMSBpbnQoMTApOwogIG51bTIgaW50KDEwKTsKZW5kLXByOwoKZGNsLXMgcmVzdWx0IGludCgxMCk7CgpyZXN1bHQgPSBEeW5hbWljQWRkTnVtYmVycygxMCwgNSk7CmRzcGx5IHJlc3VsdDsgLy8gRGlzcGxheXMgMTUKCippbmxyID0gKm9uOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>**free
dcl-pr DynamicAddNumbers extpgm('MYSRVPGM');
  num1 int(10);
  num2 int(10);
end-pr;

dcl-s result int(10);

result = DynamicAddNumbers(10, 5);
dsply result; // Displays 15

*inlr = *on;</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Service Programs in RPG provide a robust way to encapsulate and reuse code, making your applications more modular and maintainable. By understanding how to create, use, and manage service programs, you can significantly improve the efficiency and scalability of your RPG applications. As you advance, consider exploring more complex features like versioning and dynamic binding to fully leverage the power of service programs.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='creating-using-modules'>&#x25C4;Creating and Using Modules</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Service Programs</a>
	</div>
	<div class='col-4 text-end'>
					<a href='binding-directories'>Binding Directories &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
