<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embedded SQL in RPG</title>

    <link rel="alternate" href="https://campusempresa.com/rpg/embedded-sql" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/rpg/embedded-sql" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/rpg/embedded-sql" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/rpg/embedded-sql" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/rpg/embedded-sql" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='sql-in-rpg'>&#x25C4;Introduction to SQL in RPG</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Embedded SQL in RPG</a>
	</div>
	<div class='col-4 text-end'>
					<a href='dynamic-sql'>Dynamic SQL &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Embedded SQL allows RPG programs to execute SQL statements directly within the code. This integration provides powerful database manipulation capabilities, combining the strengths of SQL with the procedural logic of RPG.</p>
</div><h1>Introduction to Embedded SQL</h1>
<div class='content'><ul>
<li><strong>Definition</strong>: Embedded SQL refers to the inclusion of SQL statements within an RPG program.</li>
<li><strong>Purpose</strong>: To leverage SQL's data manipulation capabilities directly within RPG applications.</li>
<li><strong>Benefits</strong>:
<ul>
<li>Simplifies complex data retrieval and manipulation.</li>
<li>Enhances performance by reducing the need for multiple database calls.</li>
<li>Provides a more readable and maintainable codebase.</li>
</ul>
</li>
</ul>
</div><h1>Basic Concepts</h1>
<div class='content'></div><h2>SQL Precompiler</h2>
<div class='content'><ul>
<li><strong>Role</strong>: The SQL precompiler processes the embedded SQL statements before the RPG compiler.</li>
<li><strong>Function</strong>: Converts SQL statements into calls to the SQL runtime library.</li>
</ul>
</div><h2>SQLCA (SQL Communication Area)</h2>
<div class='content'><ul>
<li><strong>Purpose</strong>: A structure used to store information about the execution of SQL statements.</li>
<li><strong>Key Fields</strong>:
<ul>
<li><code>SQLCODE</code>: Indicates the success or failure of an SQL statement.</li>
<li><code>SQLSTATE</code>: Provides detailed error or status information.</li>
</ul>
</li>
</ul>
</div><h2>Declaring SQL in RPG</h2>
<div class='content'><ul>
<li><strong>Syntax</strong>: SQL statements are embedded within RPG using the <code>EXEC SQL</code> and <code>END-EXEC</code> keywords.</li>
<li><strong>Example</strong>:
<pre><code class="language-rpg">EXEC SQL
  SELECT COUNT(*) INTO :recordCount FROM myTable;
END-EXEC;
</code></pre>
</li>
</ul>
</div><h1>Basic Operations</h1>
<div class='content'></div><h2>Connecting to a Database</h2>
<div class='content'><ul>
<li><strong>Syntax</strong>:
<pre><code class="language-rpg">EXEC SQL
  CONNECT TO myDatabase USER myUser USING myPassword;
END-EXEC;
</code></pre>
</li>
<li><strong>Explanation</strong>: Establishes a connection to the specified database using the provided credentials.</li>
</ul>
</div><h2>Simple SELECT Statement</h2>
<div class='content'><ul>
<li><strong>Syntax</strong>:
<pre><code class="language-rpg">DCL-S recordCount INT(10);

EXEC SQL
  SELECT COUNT(*) INTO :recordCount FROM myTable;
END-EXEC;
</code></pre>
</li>
<li><strong>Explanation</strong>: Retrieves the count of records from <code>myTable</code> and stores it in the <code>recordCount</code> variable.</li>
</ul>
</div><h2>Inserting Data</h2>
<div class='content'><ul>
<li><strong>Syntax</strong>:
<pre><code class="language-rpg">DCL-S myValue CHAR(50);

myValue = 'Sample Data';

EXEC SQL
  INSERT INTO myTable (myColumn) VALUES (:myValue);
END-EXEC;
</code></pre>
</li>
<li><strong>Explanation</strong>: Inserts a new record into <code>myTable</code> with the value of <code>myValue</code>.</li>
</ul>
</div><h1>Advanced Operations</h1>
<div class='content'></div><h2>Using Cursors</h2>
<div class='content'><ul>
<li>
<p><strong>Definition</strong>: Cursors allow row-by-row processing of query results.</p>
</li>
<li>
<p><strong>Steps</strong>:</p>
<ol>
<li>Declare the cursor.</li>
<li>Open the cursor.</li>
<li>Fetch rows from the cursor.</li>
<li>Close the cursor.</li>
</ol>
</li>
<li>
<p><strong>Example</strong>:</p>
<pre><code class="language-rpg">DCL-S myColumn CHAR(50);

EXEC SQL
  DECLARE myCursor CURSOR FOR
  SELECT myColumn FROM myTable;
END-EXEC;

EXEC SQL
  OPEN myCursor;
END-EXEC;

DOU SQLCODE &lt;&gt; 0;
  EXEC SQL
    FETCH myCursor INTO :myColumn;
  END-EXEC;

  // Process the fetched row
ENDDO;

EXEC SQL
  CLOSE myCursor;
END-EXEC;
</code></pre>
</li>
</ul>
</div><h2>Error Handling</h2>
<div class='content'><ul>
<li>
<p><strong>Using SQLCODE</strong>:</p>
<pre><code class="language-rpg">EXEC SQL
  SELECT myColumn INTO :myValue FROM myTable WHERE myID = 1;
END-EXEC;

IF SQLCODE &lt;&gt; 0;
  // Handle error
ENDIF;
</code></pre>
</li>
<li>
<p><strong>Using SQLSTATE</strong>:</p>
<pre><code class="language-rpg">DCL-S sqlState CHAR(5);

EXEC SQL
  SELECT myColumn INTO :myValue FROM myTable WHERE myID = 1;
END-EXEC;

sqlState = SQLSTATE;

IF sqlState &lt;&gt; '00000';
  // Handle error
ENDIF;
</code></pre>
</li>
</ul>
</div><h1>Performance Considerations</h1>
<div class='content'><ul>
<li><strong>Index Usage</strong>: Ensure that queries use indexes to improve performance.</li>
<li><strong>Batch Processing</strong>: Use batch processing for large data manipulations to reduce overhead.</li>
<li><strong>Optimization</strong>: Regularly review and optimize SQL statements for better performance.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Embedded SQL in RPG provides a powerful way to interact with databases directly within your RPG programs. By understanding and utilizing embedded SQL, you can write more efficient, readable, and maintainable code. This topic covered the basics of embedded SQL, including connecting to a database, executing simple and advanced SQL operations, and handling errors. As you advance, consider exploring more complex SQL operations and performance optimization techniques to fully leverage the power of embedded SQL in RPG.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='sql-in-rpg'>&#x25C4;Introduction to SQL in RPG</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Embedded SQL in RPG</a>
	</div>
	<div class='col-4 text-end'>
					<a href='dynamic-sql'>Dynamic SQL &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
