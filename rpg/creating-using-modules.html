<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creating and Using Modules in RPG</title>

    <link rel="alternate" href="https://campusempresa.com/rpg/creating-using-modules" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/rpg/creating-using-modules" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/rpg/creating-using-modules" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/rpg/creating-using-modules" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/rpg/creating-using-modules" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='modular-design'>&#x25C4;Modular Design Principles</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Creating and Using Modules in RPG</a>
	</div>
	<div class='col-4 text-end'>
					<a href='service-programs'>Service Programs &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Modules in RPG (Report Program Generator) are a way to organize and reuse code. They help in breaking down complex programs into manageable pieces, improving readability, maintainability, and reusability. This section will guide you through the basics of creating and using modules in RPG, from beginner to advanced levels.</p>
</div><h1>What is a Module?</h1>
<div class='content'><ul>
<li>A module is a self-contained unit of code that performs a specific task.</li>
<li>Modules can be compiled separately and then linked together to form a complete program.</li>
<li>They promote code reuse and modular design.</li>
</ul>
</div><h1>Creating a Simple Module</h1>
<h2>Step-by-Step Guide</h2>
<div class='content'><ol>
<li>
<p><strong>Define the Module:</strong></p>
<ul>
<li>Use the <code>H</code> spec to define the module.</li>
<li>Use the <code>P</code> spec to define procedures within the module.</li>
</ul>
</li>
<li>
<p><strong>Write the Code:</strong></p>
<ul>
<li>Write the logic for the procedure within the module.</li>
</ul>
</li>
<li>
<p><strong>Compile the Module:</strong></p>
<ul>
<li>Use the appropriate compiler commands to compile the module.</li>
</ul>
</li>
</ol>
</div><h2>Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SCBOT01BSU4KClAgQWRkTnVtYmVycyAgICAgICBCICAgICAgICAgICAgICAgICAgIEVYUE9SVApEIEFkZE51bWJlcnMgICAgICAgUEkgICAgICAgICAgICAxMEkgMApEICAgbnVtMSAgICAgICAgICAgMTBJIDAgVkFMVUUKRCAgIG51bTIgICAgICAgICAgIDEwSSAwIFZBTFVFCgogL0ZSRUUKICAgICBSRVRVUk4gbnVtMSArIG51bTI7CiAvRU5ELUZSRUUKUCBBZGROdW1iZXJzICAgICAgIEU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>H NOMAIN

P AddNumbers       B                   EXPORT
D AddNumbers       PI            10I 0
D   num1           10I 0 VALUE
D   num2           10I 0 VALUE

 /FREE
     RETURN num1 + num2;
 /END-FREE
P AddNumbers       E</pre></div><div class='content'><ul>
<li><strong>Explanation:</strong>
<ul>
<li><code>H NOMAIN</code>: Indicates that this is a module and not a standalone program.</li>
<li><code>P AddNumbers B EXPORT</code>: Begins the definition of a procedure named <code>AddNumbers</code> and makes it available for other programs to use.</li>
<li><code>D AddNumbers PI 10I 0</code>: Defines the procedure interface with a return type of 10-digit integer.</li>
<li><code>D num1 10I 0 VALUE</code>: Defines the first parameter of the procedure.</li>
<li><code>D num2 10I 0 VALUE</code>: Defines the second parameter of the procedure.</li>
<li>The logic within <code>/FREE</code> and <code>/END-FREE</code> calculates the sum of <code>num1</code> and <code>num2</code> and returns the result.</li>
</ul>
</li>
</ul>
</div><h1>Using a Module</h1>
<h2>Step-by-Step Guide</h2>
<div class='content'><ol>
<li>
<p><strong>Import the Module:</strong></p>
<ul>
<li>Use the <code>H</code> spec to import the module.</li>
<li>Use the <code>D</code> spec to declare the procedure.</li>
</ul>
</li>
<li>
<p><strong>Call the Procedure:</strong></p>
<ul>
<li>Call the procedure from your main program.</li>
</ul>
</li>
</ol>
</div><h2>Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SCBERlRBQ1RHUlAoKk5PKSBBQ1RHUlAoKk5FVykKCkQgQWRkTnVtYmVycyAgICAgICBQUiAgICAgICAgICAgIDEwSSAwCkQgICBudW0xICAgICAgICAgICAxMEkgMCBWQUxVRQpEICAgbnVtMiAgICAgICAgICAgMTBJIDAgVkFMVUUKCiAvQ09QWSBRUlBHTEVTUkMsTVlNT0RVTEUKCkQgcmVzdWx0ICAgICAgICAgICBTICAgICAgICAgICAgIDEwSSAwCgogL0ZSRUUKICAgICByZXN1bHQgPSBBZGROdW1iZXJzKDU6IDEwKTsKICAgICBkc3BseSByZXN1bHQ7CiAgICAgKklOTFIgPSAqT047CiAvRU5ELUZSRUU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>H DFTACTGRP(*NO) ACTGRP(*NEW)

D AddNumbers       PR            10I 0
D   num1           10I 0 VALUE
D   num2           10I 0 VALUE

 /COPY QRPGLESRC,MYMODULE

D result           S             10I 0

 /FREE
     result = AddNumbers(5: 10);
     dsply result;
     *INLR = *ON;
 /END-FREE</pre></div><div class='content'><ul>
<li><strong>Explanation:</strong>
<ul>
<li><code>H DFTACTGRP(*NO) ACTGRP(*NEW)</code>: Defines the activation group for the program.</li>
<li><code>D AddNumbers PR 10I 0</code>: Declares the prototype for the <code>AddNumbers</code> procedure.</li>
<li><code>/COPY QRPGLESRC,MYMODULE</code>: Includes the module source code.</li>
<li><code>result = AddNumbers(5: 10)</code>: Calls the <code>AddNumbers</code> procedure with parameters <code>5</code> and <code>10</code>.</li>
<li><code>dsply result</code>: Displays the result.</li>
<li><code>*INLR = *ON</code>: Ends the program.</li>
</ul>
</li>
</ul>
</div><h1>Advanced Module Concepts</h1>
<h2>Modular Design</h2>
<div class='content'><ul>
<li>Break down complex tasks into smaller, reusable modules.</li>
<li>Use modules to encapsulate business logic, data access, and utility functions.</li>
</ul>
</div><h2>Error Handling in Modules</h2>
<div class='content'><ul>
<li>Implement error handling within modules to ensure robustness.</li>
<li>Use built-in functions like <code>MONITOR</code>, <code>ON-ERROR</code>, and <code>ENDMON</code> to handle exceptions.</li>
</ul>
</div><h2>Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UCBTYWZlRGl2aWRlICAgICAgIEIgICAgICAgICAgICAgICAgICAgRVhQT1JUCkQgU2FmZURpdmlkZSAgICAgICBQSSAgICAgICAgICAgIDEwSSAwCkQgICBudW0xICAgICAgICAgICAxMEkgMCBWQUxVRQpEICAgbnVtMiAgICAgICAgICAgMTBJIDAgVkFMVUUKCkQgcmVzdWx0ICAgICAgICAgICBTICAgICAgICAgICAgIDEwSSAwCgogL0ZSRUUKICAgICBNT05JVE9SOwogICAgICAgICByZXN1bHQgPSBudW0xIC8gbnVtMjsKICAgICBPTi1FUlJPUjsKICAgICAgICAgcmVzdWx0ID0gMDsKICAgICBFTkRNT047CiAgICAgUkVUVVJOIHJlc3VsdDsKIC9FTkQtRlJFRQpQIFNhZmVEaXZpZGUgICAgICAgRQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>P SafeDivide       B                   EXPORT
D SafeDivide       PI            10I 0
D   num1           10I 0 VALUE
D   num2           10I 0 VALUE

D result           S             10I 0

 /FREE
     MONITOR;
         result = num1 / num2;
     ON-ERROR;
         result = 0;
     ENDMON;
     RETURN result;
 /END-FREE
P SafeDivide       E</pre></div><div class='content'><ul>
<li><strong>Explanation:</strong>
<ul>
<li><code>MONITOR</code>: Begins the error handling block.</li>
<li><code>ON-ERROR</code>: Specifies the action to take if an error occurs.</li>
<li><code>ENDMON</code>: Ends the error handling block.</li>
</ul>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Modules in RPG are essential for creating organized, maintainable, and reusable code. By breaking down complex programs into smaller modules, you can improve the structure and readability of your code. This section covered the basics of creating and using modules, as well as some advanced concepts like modular design and error handling. Practice creating and using modules to become proficient in modular programming with RPG.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='modular-design'>&#x25C4;Modular Design Principles</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Creating and Using Modules in RPG</a>
	</div>
	<div class='col-4 text-end'>
					<a href='service-programs'>Service Programs &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
