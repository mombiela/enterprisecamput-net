<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consumer API Overview</title>

    <link rel="alternate" href="https://campusempresa.com/kafka/consumer-api-overview" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/kafka/consumer-api-overview" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/kafka/consumer-api-overview" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/kafka/consumer-api-overview" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/kafka/consumer-api-overview" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='error-handling-and-retries'>&#x25C4;Error Handling and Retries</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Consumer API Overview</a>
	</div>
	<div class='col-4 text-end'>
					<a href='consuming-messages'>Consuming Messages &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Apache Kafka is a distributed streaming platform that allows you to publish and subscribe to streams of records. The Consumer API is a crucial part of Kafka, enabling applications to read records from Kafka topics. This section will provide an overview of the Consumer API, its key concepts, and how to use it effectively.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Consumer Group</strong>: A group of consumers that work together to consume records from a set of topics. Each consumer in the group reads a subset of the partitions.</li>
<li><strong>Offset</strong>: A unique identifier for each record within a partition. Consumers use offsets to keep track of which records have been consumed.</li>
<li><strong>Rebalancing</strong>: The process of redistributing partitions among consumers in a group when the group membership changes.</li>
<li><strong>Commit</strong>: The action of saving the current offset of a consumer, ensuring that the consumer can resume from this point in case of a failure.</li>
</ul>
</div><h1>Setting Up a Kafka Consumer</h1>
<div class='content'><p>To create a Kafka consumer, you need to configure several properties and use the KafkaConsumer class. Below is a basic example in Java.</p>
</div><h2>Example: Basic Kafka Consumer in Java</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5Db25zdW1lclJlY29yZDsKaW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5Db25zdW1lclJlY29yZHM7CmltcG9ydCBvcmcuYXBhY2hlLmthZmthLmNsaWVudHMuY29uc3VtZXIuS2Fma2FDb25zdW1lcjsKCmltcG9ydCBqYXZhLnRpbWUuRHVyYXRpb247CmltcG9ydCBqYXZhLnV0aWwuQ29sbGVjdGlvbnM7CmltcG9ydCBqYXZhLnV0aWwuUHJvcGVydGllczsKCnB1YmxpYyBjbGFzcyBCYXNpY0thZmthQ29uc3VtZXIgewogICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykgewogICAgICAgIFByb3BlcnRpZXMgcHJvcHMgPSBuZXcgUHJvcGVydGllcygpOwogICAgICAgIHByb3BzLnB1dCgiYm9vdHN0cmFwLnNlcnZlcnMiLCAibG9jYWxob3N0OjkwOTIiKTsKICAgICAgICBwcm9wcy5wdXQoImdyb3VwLmlkIiwgInRlc3QtZ3JvdXAiKTsKICAgICAgICBwcm9wcy5wdXQoImtleS5kZXNlcmlhbGl6ZXIiLCAib3JnLmFwYWNoZS5rYWZrYS5jb21tb24uc2VyaWFsaXphdGlvbi5TdHJpbmdEZXNlcmlhbGl6ZXIiKTsKICAgICAgICBwcm9wcy5wdXQoInZhbHVlLmRlc2VyaWFsaXplciIsICJvcmcuYXBhY2hlLmthZmthLmNvbW1vbi5zZXJpYWxpemF0aW9uLlN0cmluZ0Rlc2VyaWFsaXplciIpOwoKICAgICAgICBLYWZrYUNvbnN1bWVyPFN0cmluZywgU3RyaW5nPiBjb25zdW1lciA9IG5ldyBLYWZrYUNvbnN1bWVyPD4ocHJvcHMpOwogICAgICAgIGNvbnN1bWVyLnN1YnNjcmliZShDb2xsZWN0aW9ucy5zaW5nbGV0b25MaXN0KCJ0ZXN0LXRvcGljIikpOwoKICAgICAgICB0cnkgewogICAgICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICAgICAgQ29uc3VtZXJSZWNvcmRzPFN0cmluZywgU3RyaW5nPiByZWNvcmRzID0gY29uc3VtZXIucG9sbChEdXJhdGlvbi5vZk1pbGxpcygxMDApKTsKICAgICAgICAgICAgICAgIGZvciAoQ29uc3VtZXJSZWNvcmQ8U3RyaW5nLCBTdHJpbmc+IHJlY29yZCA6IHJlY29yZHMpIHsKICAgICAgICAgICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50Zigib2Zmc2V0ID0gJWQsIGtleSA9ICVzLCB2YWx1ZSA9ICVzJW4iLCByZWNvcmQub2Zmc2V0KCksIHJlY29yZC5rZXkoKSwgcmVjb3JkLnZhbHVlKCkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgY29uc3VtZXIuY2xvc2UoKTsKICAgICAgICB9CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.consumer.ConsumerRecord;
import org.apache.kafka.clients.consumer.ConsumerRecords;
import org.apache.kafka.clients.consumer.KafkaConsumer;

import java.time.Duration;
import java.util.Collections;
import java.util.Properties;

public class BasicKafkaConsumer {
    public static void main(String[] args) {
        Properties props = new Properties();
        props.put(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
        props.put(&quot;group.id&quot;, &quot;test-group&quot;);
        props.put(&quot;key.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);
        props.put(&quot;value.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);

        KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props);
        consumer.subscribe(Collections.singletonList(&quot;test-topic&quot;));

        try {
            while (true) {
                ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMillis(100));
                for (ConsumerRecord&lt;String, String&gt; record : records) {
                    System.out.printf(&quot;offset = %d, key = %s, value = %s%n&quot;, record.offset(), record.key(), record.value());
                }
            }
        } finally {
            consumer.close();
        }
    }
}</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Properties Configuration</strong>: The <code>Properties</code> object is used to configure the consumer. Key properties include <code>bootstrap.servers</code>, <code>group.id</code>, <code>key.deserializer</code>, and <code>value.deserializer</code>.</li>
<li><strong>KafkaConsumer Initialization</strong>: The <code>KafkaConsumer</code> class is instantiated with the configured properties.</li>
<li><strong>Subscription</strong>: The consumer subscribes to a topic using the <code>subscribe</code> method.</li>
<li><strong>Polling</strong>: The <code>poll</code> method is used to fetch records from the topic. The <code>Duration.ofMillis(100)</code> argument specifies the timeout for the poll operation.</li>
<li><strong>Processing Records</strong>: The records are processed in a loop, printing the offset, key, and value of each record.</li>
<li><strong>Graceful Shutdown</strong>: The consumer is closed in the <code>finally</code> block to ensure resources are released properly.</li>
</ul>
</div><h1>Advanced Consumer Features</h1>
<h2>Manual Offset Control</h2>
<div class='content'><p>By default, Kafka commits offsets automatically. However, you can control offsets manually for more precise control over record processing.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3VtZXIuY29tbWl0U3luYygpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>consumer.commitSync();</pre></div><div class='content'></div><h2>Rebalancing Listeners</h2>
<div class='content'><p>You can implement a <code>ConsumerRebalanceListener</code> to handle partition reassignments during rebalancing.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3VtZXIuc3Vic2NyaWJlKENvbGxlY3Rpb25zLnNpbmdsZXRvbkxpc3QoInRlc3QtdG9waWMiKSwgbmV3IENvbnN1bWVyUmViYWxhbmNlTGlzdGVuZXIoKSB7CiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIG9uUGFydGl0aW9uc1Jldm9rZWQoQ29sbGVjdGlvbjxUb3BpY1BhcnRpdGlvbj4gcGFydGl0aW9ucykgewogICAgICAgIC8vIEhhbmRsZSBwYXJ0aXRpb24gcmV2b2NhdGlvbgogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgb25QYXJ0aXRpb25zQXNzaWduZWQoQ29sbGVjdGlvbjxUb3BpY1BhcnRpdGlvbj4gcGFydGl0aW9ucykgewogICAgICAgIC8vIEhhbmRsZSBwYXJ0aXRpb24gYXNzaWdubWVudAogICAgfQp9KTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>consumer.subscribe(Collections.singletonList(&quot;test-topic&quot;), new ConsumerRebalanceListener() {
    @Override
    public void onPartitionsRevoked(Collection&lt;TopicPartition&gt; partitions) {
        // Handle partition revocation
    }

    @Override
    public void onPartitionsAssigned(Collection&lt;TopicPartition&gt; partitions) {
        // Handle partition assignment
    }
});</pre></div><div class='content'></div><h2>Error Handling</h2>
<div class='content'><p>Proper error handling is crucial for robust consumer applications. Use try-catch blocks and handle specific exceptions like <code>WakeupException</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJ5IHsKICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgQ29uc3VtZXJSZWNvcmRzPFN0cmluZywgU3RyaW5nPiByZWNvcmRzID0gY29uc3VtZXIucG9sbChEdXJhdGlvbi5vZk1pbGxpcygxMDApKTsKICAgICAgICAvLyBQcm9jZXNzIHJlY29yZHMKICAgIH0KfSBjYXRjaCAoV2FrZXVwRXhjZXB0aW9uIGUpIHsKICAgIC8vIEhhbmRsZSBzaHV0ZG93bgp9IGZpbmFsbHkgewogICAgY29uc3VtZXIuY2xvc2UoKTsKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>try {
    while (true) {
        ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMillis(100));
        // Process records
    }
} catch (WakeupException e) {
    // Handle shutdown
} finally {
    consumer.close();
}</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>The Kafka Consumer API is a powerful tool for reading records from Kafka topics. Understanding its key concepts, such as consumer groups, offsets, and rebalancing, is essential for building efficient and reliable consumer applications. By mastering both basic and advanced features, you can ensure your Kafka consumers are robust and performant.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='error-handling-and-retries'>&#x25C4;Error Handling and Retries</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Consumer API Overview</a>
	</div>
	<div class='col-4 text-end'>
					<a href='consuming-messages'>Consuming Messages &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
