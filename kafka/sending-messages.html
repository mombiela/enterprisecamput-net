<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sending Messages</title>

    <link rel="alternate" href="https://campusempresa.com/kafka/sending-messages" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/kafka/sending-messages" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/kafka/sending-messages" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/kafka/sending-messages" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/kafka/sending-messages" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='producer-api-overview'>&#x25C4;Producer API Overview</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Sending Messages</a>
	</div>
	<div class='col-4 text-end'>
					<a href='producer-configuration'>Producer Configuration &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will cover how to send messages using Apache Kafka. We will start with the basics and gradually move to more advanced concepts. By the end of this section, you should be able to send messages to Kafka topics efficiently and understand the underlying mechanisms.</p>
</div><h1>Introduction to Kafka Producers</h1>
<div class='content'><p>A Kafka Producer is a client that sends records to a Kafka cluster. Producers are responsible for choosing which record to assign to which partition within a topic.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Producer</strong>: The client application that sends records to Kafka.</li>
<li><strong>Record</strong>: The data that is sent to Kafka, consisting of a key, value, and optional metadata.</li>
<li><strong>Topic</strong>: A category or feed name to which records are sent.</li>
<li><strong>Partition</strong>: A division of a topic, allowing for parallel processing.</li>
</ul>
</div><h1>Setting Up a Kafka Producer</h1>
<div class='content'><p>Before sending messages, you need to set up a Kafka producer. This involves configuring the producer properties and initializing the producer instance.</p>
</div><h2>Basic Configuration</h2>
<div class='content'><p>Here are some essential properties you need to configure:</p>
<ul>
<li><strong>bootstrap.servers</strong>: A list of host/port pairs to use for establishing the initial connection to the Kafka cluster.</li>
<li><strong>key.serializer</strong>: Serializer class for the key that implements the <code>org.apache.kafka.common.serialization.Serializer</code> interface.</li>
<li><strong>value.serializer</strong>: Serializer class for the value that implements the <code>org.apache.kafka.common.serialization.Serializer</code> interface.</li>
</ul>
</div><h2>Example Configuration</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5wcm9kdWNlci5LYWZrYVByb2R1Y2VyOwppbXBvcnQgb3JnLmFwYWNoZS5rYWZrYS5jbGllbnRzLnByb2R1Y2VyLlByb2R1Y2VyQ29uZmlnOwppbXBvcnQgb3JnLmFwYWNoZS5rYWZrYS5jb21tb24uc2VyaWFsaXphdGlvbi5TdHJpbmdTZXJpYWxpemVyOwoKaW1wb3J0IGphdmEudXRpbC5Qcm9wZXJ0aWVzOwoKcHVibGljIGNsYXNzIFByb2R1Y2VyQ29uZmlnRXhhbXBsZSB7CiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7CiAgICAgICAgUHJvcGVydGllcyBwcm9wZXJ0aWVzID0gbmV3IFByb3BlcnRpZXMoKTsKICAgICAgICBwcm9wZXJ0aWVzLnB1dChQcm9kdWNlckNvbmZpZy5CT09UU1RSQVBfU0VSVkVSU19DT05GSUcsICJsb2NhbGhvc3Q6OTA5MiIpOwogICAgICAgIHByb3BlcnRpZXMucHV0KFByb2R1Y2VyQ29uZmlnLktFWV9TRVJJQUxJWkVSX0NMQVNTX0NPTkZJRywgU3RyaW5nU2VyaWFsaXplci5jbGFzcy5nZXROYW1lKCkpOwogICAgICAgIHByb3BlcnRpZXMucHV0KFByb2R1Y2VyQ29uZmlnLlZBTFVFX1NFUklBTElaRVJfQ0xBU1NfQ09ORklHLCBTdHJpbmdTZXJpYWxpemVyLmNsYXNzLmdldE5hbWUoKSk7CgogICAgICAgIEthZmthUHJvZHVjZXI8U3RyaW5nLCBTdHJpbmc+IHByb2R1Y2VyID0gbmV3IEthZmthUHJvZHVjZXI8Pihwcm9wZXJ0aWVzKTsKICAgICAgICAvLyBVc2UgdGhlIHByb2R1Y2VyIHRvIHNlbmQgbWVzc2FnZXMKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.producer.KafkaProducer;
import org.apache.kafka.clients.producer.ProducerConfig;
import org.apache.kafka.common.serialization.StringSerializer;

import java.util.Properties;

public class ProducerConfigExample {
    public static void main(String[] args) {
        Properties properties = new Properties();
        properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, &quot;localhost:9092&quot;);
        properties.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());
        properties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());

        KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(properties);
        // Use the producer to send messages
    }
}</pre></div><div class='content'></div><h1>Sending Messages</h1>
<div class='content'><p>Once the producer is configured, you can start sending messages to Kafka topics.</p>
</div><h2>Sending a Simple Message</h2>
<div class='content'><p>To send a message, you need to create a <code>ProducerRecord</code> and use the <code>send</code> method of the producer.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5wcm9kdWNlci5Qcm9kdWNlclJlY29yZDsKCnB1YmxpYyBjbGFzcyBTaW1wbGVNZXNzYWdlUHJvZHVjZXIgewogICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykgewogICAgICAgIC8vIEFzc3VtaW5nIHByb2R1Y2VyIGlzIGFscmVhZHkgY29uZmlndXJlZCBhcyBzaG93biBhYm92ZQogICAgICAgIEthZmthUHJvZHVjZXI8U3RyaW5nLCBTdHJpbmc+IHByb2R1Y2VyID0gbmV3IEthZmthUHJvZHVjZXI8Pihwcm9wZXJ0aWVzKTsKCiAgICAgICAgU3RyaW5nIHRvcGljID0gIm15LXRvcGljIjsKICAgICAgICBTdHJpbmcga2V5ID0gIm15LWtleSI7CiAgICAgICAgU3RyaW5nIHZhbHVlID0gIkhlbGxvLCBLYWZrYSEiOwoKICAgICAgICBQcm9kdWNlclJlY29yZDxTdHJpbmcsIFN0cmluZz4gcmVjb3JkID0gbmV3IFByb2R1Y2VyUmVjb3JkPD4odG9waWMsIGtleSwgdmFsdWUpOwogICAgICAgIHByb2R1Y2VyLnNlbmQocmVjb3JkKTsKCiAgICAgICAgcHJvZHVjZXIuY2xvc2UoKTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.producer.ProducerRecord;

public class SimpleMessageProducer {
    public static void main(String[] args) {
        // Assuming producer is already configured as shown above
        KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(properties);

        String topic = &quot;my-topic&quot;;
        String key = &quot;my-key&quot;;
        String value = &quot;Hello, Kafka!&quot;;

        ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(topic, key, value);
        producer.send(record);

        producer.close();
    }
}</pre></div><div class='content'></div><h2>Handling Callbacks</h2>
<div class='content'><p>You can also handle callbacks to get notified when a message is successfully sent or if an error occurs.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5wcm9kdWNlci5DYWxsYmFjazsKaW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5wcm9kdWNlci5SZWNvcmRNZXRhZGF0YTsKaW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5wcm9kdWNlci5Qcm9kdWNlclJlY29yZDsKCnB1YmxpYyBjbGFzcyBDYWxsYmFja1Byb2R1Y2VyIHsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBLYWZrYVByb2R1Y2VyPFN0cmluZywgU3RyaW5nPiBwcm9kdWNlciA9IG5ldyBLYWZrYVByb2R1Y2VyPD4ocHJvcGVydGllcyk7CgogICAgICAgIFN0cmluZyB0b3BpYyA9ICJteS10b3BpYyI7CiAgICAgICAgU3RyaW5nIGtleSA9ICJteS1rZXkiOwogICAgICAgIFN0cmluZyB2YWx1ZSA9ICJIZWxsbywgS2Fma2Egd2l0aCBDYWxsYmFjayEiOwoKICAgICAgICBQcm9kdWNlclJlY29yZDxTdHJpbmcsIFN0cmluZz4gcmVjb3JkID0gbmV3IFByb2R1Y2VyUmVjb3JkPD4odG9waWMsIGtleSwgdmFsdWUpOwogICAgICAgIHByb2R1Y2VyLnNlbmQocmVjb3JkLCBuZXcgQ2FsbGJhY2soKSB7CiAgICAgICAgICAgIEBPdmVycmlkZQogICAgICAgICAgICBwdWJsaWMgdm9pZCBvbkNvbXBsZXRpb24oUmVjb3JkTWV0YWRhdGEgbWV0YWRhdGEsIEV4Y2VwdGlvbiBleGNlcHRpb24pIHsKICAgICAgICAgICAgICAgIGlmIChleGNlcHRpb24gPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiTWVzc2FnZSBzZW50IHN1Y2Nlc3NmdWxseSB0byAiICsgbWV0YWRhdGEudG9waWMoKSArICIgcGFydGl0aW9uICIgKyBtZXRhZGF0YS5wYXJ0aXRpb24oKSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGV4Y2VwdGlvbi5wcmludFN0YWNrVHJhY2UoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBwcm9kdWNlci5jbG9zZSgpOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.producer.Callback;
import org.apache.kafka.clients.producer.RecordMetadata;
import org.apache.kafka.clients.producer.ProducerRecord;

public class CallbackProducer {
    public static void main(String[] args) {
        KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(properties);

        String topic = &quot;my-topic&quot;;
        String key = &quot;my-key&quot;;
        String value = &quot;Hello, Kafka with Callback!&quot;;

        ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(topic, key, value);
        producer.send(record, new Callback() {
            @Override
            public void onCompletion(RecordMetadata metadata, Exception exception) {
                if (exception == null) {
                    System.out.println(&quot;Message sent successfully to &quot; + metadata.topic() + &quot; partition &quot; + metadata.partition());
                } else {
                    exception.printStackTrace();
                }
            }
        });

        producer.close();
    }
}</pre></div><div class='content'></div><h1>Advanced Configurations</h1>
<div class='content'></div><h2>Acknowledgment Settings</h2>
<div class='content'><p>Kafka allows you to configure the acknowledgment level to ensure message delivery reliability.</p>
<ul>
<li><strong>acks=0</strong>: No acknowledgment is required.</li>
<li><strong>acks=1</strong>: Leader acknowledgment is required.</li>
<li><strong>acks=all</strong>: All in-sync replicas must acknowledge.</li>
</ul>
</div><h2>Example with Acknowledgment</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJvcGVydGllcy5wdXQoUHJvZHVjZXJDb25maWcuQUNLU19DT05GSUcsICJhbGwiKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>properties.put(ProducerConfig.ACKS_CONFIG, &quot;all&quot;);</pre></div><div class='content'></div><h2>Batch Size and Linger Time</h2>
<div class='content'><p>You can configure the batch size and linger time to optimize performance.</p>
<ul>
<li><strong>batch.size</strong>: The size of the batch in bytes.</li>
<li><strong>linger.ms</strong>: The time to wait before sending a batch.</li>
</ul>
</div><h2>Example with Batch Size and Linger Time</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJvcGVydGllcy5wdXQoUHJvZHVjZXJDb25maWcuQkFUQ0hfU0laRV9DT05GSUcsIDE2Mzg0KTsgLy8gMTYgS0IKcHJvcGVydGllcy5wdXQoUHJvZHVjZXJDb25maWcuTElOR0VSX01TX0NPTkZJRywgMTApOyAvLyAxMCBtcw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>properties.put(ProducerConfig.BATCH_SIZE_CONFIG, 16384); // 16 KB
properties.put(ProducerConfig.LINGER_MS_CONFIG, 10); // 10 ms</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the basics of sending messages using Kafka. We started with setting up a Kafka producer, sending simple messages, handling callbacks, and explored some advanced configurations. Understanding these concepts is crucial for efficiently producing messages to Kafka topics and ensuring reliable message delivery.</p>
<p>By mastering these basics, you are now ready to dive deeper into more advanced Kafka features and optimizations.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='producer-api-overview'>&#x25C4;Producer API Overview</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Sending Messages</a>
	</div>
	<div class='col-4 text-end'>
					<a href='producer-configuration'>Producer Configuration &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
