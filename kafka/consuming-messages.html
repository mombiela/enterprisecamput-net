<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consuming Messages</title>

    <link rel="alternate" href="https://campusempresa.com/kafka/consuming-messages" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/kafka/consuming-messages" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/kafka/consuming-messages" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/kafka/consuming-messages" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/kafka/consuming-messages" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='consumer-api-overview'>&#x25C4;Consumer API Overview</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Consuming Messages</a>
	</div>
	<div class='col-4 text-end'>
					<a href='consumer-groups'>Consumer Groups &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Apache Kafka is a distributed streaming platform that allows you to publish and subscribe to streams of records. In this section, we will focus on consuming messages from Kafka topics. We will cover the basics of Kafka consumers, how to configure them, and advanced techniques for efficient message consumption.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Consumer</strong>: A client that reads records from a Kafka topic.</li>
<li><strong>Consumer Group</strong>: A group of consumers that work together to consume messages from a topic.</li>
<li><strong>Offset</strong>: A unique identifier for each record within a partition, used to track the position of the consumer.</li>
</ul>
</div><h1>Setting Up a Kafka Consumer</h1>
<div class='content'><p>To consume messages from Kafka, you need to set up a Kafka consumer. This involves configuring the consumer properties and writing code to read messages from a Kafka topic.</p>
</div><h2>Basic Consumer Configuration</h2>
<div class='content'><p>Here are the essential properties you need to configure for a Kafka consumer:</p>
<ul>
<li><code>bootstrap.servers</code>: A list of host/port pairs to use for establishing the initial connection to the Kafka cluster.</li>
<li><code>group.id</code>: A unique string that identifies the consumer group this consumer belongs to.</li>
<li><code>key.deserializer</code>: The class name of the deserializer for the key.</li>
<li><code>value.deserializer</code>: The class name of the deserializer for the value.</li>
</ul>
</div><h2>Example: Basic Consumer Configuration in Java</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5Db25zdW1lckNvbmZpZzsKaW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5LYWZrYUNvbnN1bWVyOwppbXBvcnQgb3JnLmFwYWNoZS5rYWZrYS5jbGllbnRzLmNvbnN1bWVyLkNvbnN1bWVyUmVjb3JkczsKaW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5Db25zdW1lclJlY29yZDsKCmltcG9ydCBqYXZhLnV0aWwuUHJvcGVydGllczsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsKCnB1YmxpYyBjbGFzcyBCYXNpY0NvbnN1bWVyIHsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBQcm9wZXJ0aWVzIHByb3BzID0gbmV3IFByb3BlcnRpZXMoKTsKICAgICAgICBwcm9wcy5wdXQoQ29uc3VtZXJDb25maWcuQk9PVFNUUkFQX1NFUlZFUlNfQ09ORklHLCAibG9jYWxob3N0OjkwOTIiKTsKICAgICAgICBwcm9wcy5wdXQoQ29uc3VtZXJDb25maWcuR1JPVVBfSURfQ09ORklHLCAidGVzdC1ncm91cCIpOwogICAgICAgIHByb3BzLnB1dChDb25zdW1lckNvbmZpZy5LRVlfREVTRVJJQUxJWkVSX0NMQVNTX0NPTkZJRywgIm9yZy5hcGFjaGUua2Fma2EuY29tbW9uLnNlcmlhbGl6YXRpb24uU3RyaW5nRGVzZXJpYWxpemVyIik7CiAgICAgICAgcHJvcHMucHV0KENvbnN1bWVyQ29uZmlnLlZBTFVFX0RFU0VSSUFMSVpFUl9DTEFTU19DT05GSUcsICJvcmcuYXBhY2hlLmthZmthLmNvbW1vbi5zZXJpYWxpemF0aW9uLlN0cmluZ0Rlc2VyaWFsaXplciIpOwoKICAgICAgICBLYWZrYUNvbnN1bWVyPFN0cmluZywgU3RyaW5nPiBjb25zdW1lciA9IG5ldyBLYWZrYUNvbnN1bWVyPD4ocHJvcHMpOwogICAgICAgIGNvbnN1bWVyLnN1YnNjcmliZShDb2xsZWN0aW9ucy5zaW5nbGV0b25MaXN0KCJ0ZXN0LXRvcGljIikpOwoKICAgICAgICB3aGlsZSAodHJ1ZSkgewogICAgICAgICAgICBDb25zdW1lclJlY29yZHM8U3RyaW5nLCBTdHJpbmc+IHJlY29yZHMgPSBjb25zdW1lci5wb2xsKDEwMCk7CiAgICAgICAgICAgIGZvciAoQ29uc3VtZXJSZWNvcmQ8U3RyaW5nLCBTdHJpbmc+IHJlY29yZCA6IHJlY29yZHMpIHsKICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRmKCJvZmZzZXQgPSAlZCwga2V5ID0gJXMsIHZhbHVlID0gJXMlbiIsIHJlY29yZC5vZmZzZXQoKSwgcmVjb3JkLmtleSgpLCByZWNvcmQudmFsdWUoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.consumer.ConsumerConfig;
import org.apache.kafka.clients.consumer.KafkaConsumer;
import org.apache.kafka.clients.consumer.ConsumerRecords;
import org.apache.kafka.clients.consumer.ConsumerRecord;

import java.util.Properties;
import java.util.Collections;

public class BasicConsumer {
    public static void main(String[] args) {
        Properties props = new Properties();
        props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, &quot;localhost:9092&quot;);
        props.put(ConsumerConfig.GROUP_ID_CONFIG, &quot;test-group&quot;);
        props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);
        props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);

        KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props);
        consumer.subscribe(Collections.singletonList(&quot;test-topic&quot;));

        while (true) {
            ConsumerRecords&lt;String, String&gt; records = consumer.poll(100);
            for (ConsumerRecord&lt;String, String&gt; record : records) {
                System.out.printf(&quot;offset = %d, key = %s, value = %s%n&quot;, record.offset(), record.key(), record.value());
            }
        }
    }
}</pre></div><div class='content'></div><h1>Advanced Consumer Features</h1>
<h2>Consumer Groups and Parallelism</h2>
<div class='content'><ul>
<li><strong>Consumer Groups</strong>: Multiple consumers can join a consumer group to read from a topic in parallel. Each partition in the topic is assigned to only one consumer within a group, ensuring that each message is processed only once.</li>
<li><strong>Rebalancing</strong>: When a new consumer joins or leaves the group, Kafka automatically redistributes the partitions among the consumers.</li>
</ul>
</div><h2>Example: Consumer Group in Action</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gU2ltaWxhciBzZXR1cCBhcyB0aGUgYmFzaWMgY29uc3VtZXIsIGJ1dCBydW4gbXVsdGlwbGUgaW5zdGFuY2VzIG9mIHRoaXMgY29uc3VtZXIgdG8gc2VlIHJlYmFsYW5jaW5nIGluIGFjdGlvbi4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Similar setup as the basic consumer, but run multiple instances of this consumer to see rebalancing in action.</pre></div><div class='content'></div><h2>Committing Offsets</h2>
<div class='content'><ul>
<li><strong>Automatic Offset Committing</strong>: Kafka can automatically commit offsets at regular intervals.</li>
<li><strong>Manual Offset Committing</strong>: You can manually commit offsets to have more control over message processing.</li>
</ul>
</div><h2>Example: Manual Offset Committing</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5Db21taXRGYWlsZWRFeGNlcHRpb247CgovLyBJbnNpZGUgdGhlIHdoaWxlIGxvb3AKdHJ5IHsKICAgIGNvbnN1bWVyLmNvbW1pdFN5bmMoKTsKfSBjYXRjaCAoQ29tbWl0RmFpbGVkRXhjZXB0aW9uIGUpIHsKICAgIFN5c3RlbS5lcnIucHJpbnRmKCJDb21taXQgZmFpbGVkOiAlcyVuIiwgZS5nZXRNZXNzYWdlKCkpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.consumer.CommitFailedException;

// Inside the while loop
try {
    consumer.commitSync();
} catch (CommitFailedException e) {
    System.err.printf(&quot;Commit failed: %s%n&quot;, e.getMessage());
}</pre></div><div class='content'></div><h1>Error Handling and Retries</h1>
<div class='content'><ul>
<li><strong>Handling Deserialization Errors</strong>: Implement custom deserializers to handle errors gracefully.</li>
<li><strong>Retries</strong>: Configure retry policies for transient errors.</li>
</ul>
</div><h2>Example: Custom Deserializer</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY29tbW9uLnNlcmlhbGl6YXRpb24uRGVzZXJpYWxpemVyOwoKcHVibGljIGNsYXNzIEN1c3RvbURlc2VyaWFsaXplciBpbXBsZW1lbnRzIERlc2VyaWFsaXplcjxNeU9iamVjdD4gewogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgTXlPYmplY3QgZGVzZXJpYWxpemUoU3RyaW5nIHRvcGljLCBieXRlW10gZGF0YSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vIEN1c3RvbSBkZXNlcmlhbGl6YXRpb24gbG9naWMKICAgICAgICB9IGNhdGNoIChFeGNlcHRpb24gZSkgewogICAgICAgICAgICAvLyBIYW5kbGUgZGVzZXJpYWxpemF0aW9uIGVycm9yCiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.common.serialization.Deserializer;

public class CustomDeserializer implements Deserializer&lt;MyObject&gt; {
    @Override
    public MyObject deserialize(String topic, byte[] data) {
        try {
            // Custom deserialization logic
        } catch (Exception e) {
            // Handle deserialization error
        }
        return null;
    }
}</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Consuming messages from Kafka is a fundamental aspect of working with this powerful streaming platform. By understanding the basics of Kafka consumers, configuring them correctly, and leveraging advanced features like consumer groups and manual offset committing, you can build robust and efficient message-consuming applications. Always consider error handling and retries to ensure your consumer applications are resilient and reliable.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='consumer-api-overview'>&#x25C4;Consumer API Overview</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Consuming Messages</a>
	</div>
	<div class='col-4 text-end'>
					<a href='consumer-groups'>Consumer Groups &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
