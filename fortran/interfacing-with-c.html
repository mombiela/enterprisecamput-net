<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interfacing with C</title>

    <link rel="alternate" href="https://campusempresa.com/fortran/interfacing-with-c" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/fortran/interfacing-with-c" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/fortran/interfacing-with-c" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/fortran/interfacing-with-c" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/fortran/interfacing-with-c" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='parallel-programming-coarrays'>&#x25C4;Parallel Programming with Coarrays</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Interfacing with C</a>
	</div>
	<div class='col-4 text-end'>
					<a href='optimization-techniques'>Optimization Techniques &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Interfacing Fortran with C can be a powerful way to leverage the strengths of both languages. This section will guide you through the process of calling C functions from Fortran and vice versa, covering key concepts, providing examples, and offering exercises to solidify your understanding.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Interoperability</strong>: The ability of Fortran and C to call each other’s functions and share data.</li>
<li><strong>ISO_C_BINDING Module</strong>: A Fortran module that provides the necessary tools for interoperability with C.</li>
<li><strong>C Binding Attributes</strong>: Attributes that specify how Fortran entities correspond to C entities.</li>
<li><strong>Data Type Mapping</strong>: Understanding how Fortran data types map to C data types.</li>
</ul>
</div><h1>ISO_C_BINDING Module</h1>
<div class='content'><p>The <code>ISO_C_BINDING</code> module is essential for interoperability between Fortran and C. It provides named constants and derived types that help in mapping Fortran data types to C data types.</p>
</div><h2>Example: Using ISO_C_BINDING</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJvZ3JhbSBjX2JpbmRpbmdfZXhhbXBsZQogIHVzZSBpc29fY19iaW5kaW5nCiAgaW1wbGljaXQgbm9uZQoKICBpbnRlZ2VyKGNfaW50KSA6OiBpCiAgcmVhbChjX2Zsb2F0KSA6OiB4CgogIGkgPSA0MgogIHggPSAzLjE0CgogIHByaW50ICosICdJbnRlZ2VyOicsIGkKICBwcmludCAqLCAnUmVhbDonLCB4CgplbmQgcHJvZ3JhbSBjX2JpbmRpbmdfZXhhbXBsZQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>program c_binding_example
  use iso_c_binding
  implicit none

  integer(c_int) :: i
  real(c_float) :: x

  i = 42
  x = 3.14

  print *, 'Integer:', i
  print *, 'Real:', x

end program c_binding_example</pre></div><div class='content'><p>In this example, <code>c_int</code> and <code>c_float</code> are constants from the <code>ISO_C_BINDING</code> module that map to the corresponding C data types.</p>
</div><h1>Calling C Functions from Fortran</h1>
<div class='content'><p>To call a C function from Fortran, you need to:</p>
<ol>
<li>Declare the C function in Fortran using the <code>BIND(C)</code> attribute.</li>
<li>Ensure that the data types match between Fortran and C.</li>
</ol>
</div><h2>Example: Calling a C Function</h2>
<div class='content'><h4>C Code (save as <code>c_function.c</code>)</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I2luY2x1ZGUgPHN0ZGlvLmg+Cgp2b2lkIHByaW50X21lc3NhZ2UoKSB7CiAgICBwcmludGYoIkhlbGxvIGZyb20gQyFcbiIpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#include &lt;stdio.h&gt;

void print_message() {
    printf(&quot;Hello from C!\n&quot;);
}</pre></div><div class='content'><h4>Fortran Code (save as <code>call_c_function.f90</code>)</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJvZ3JhbSBjYWxsX2NfZnVuY3Rpb24KICB1c2UgaXNvX2NfYmluZGluZwogIGltcGxpY2l0IG5vbmUKCiAgaW50ZXJmYWNlCiAgICBzdWJyb3V0aW5lIHByaW50X21lc3NhZ2UoKSBiaW5kKEMsIG5hbWU9InByaW50X21lc3NhZ2UiKQogICAgZW5kIHN1YnJvdXRpbmUgcHJpbnRfbWVzc2FnZQogIGVuZCBpbnRlcmZhY2UKCiAgY2FsbCBwcmludF9tZXNzYWdlKCkKCmVuZCBwcm9ncmFtIGNhbGxfY19mdW5jdGlvbg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>program call_c_function
  use iso_c_binding
  implicit none

  interface
    subroutine print_message() bind(C, name=&quot;print_message&quot;)
    end subroutine print_message
  end interface

  call print_message()

end program call_c_function</pre></div><div class='content'><p>To compile and run the above example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2NjIC1jIGNfZnVuY3Rpb24uYwpnZm9ydHJhbiBjYWxsX2NfZnVuY3Rpb24uZjkwIGNfZnVuY3Rpb24ubyAtbyBjYWxsX2NfZnVuY3Rpb24KLi9jYWxsX2NfZnVuY3Rpb24="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcc -c c_function.c
gfortran call_c_function.f90 c_function.o -o call_c_function
./call_c_function</pre></div><div class='content'></div><h1>Calling Fortran Functions from C</h1>
<div class='content'><p>To call a Fortran function from C, you need to:</p>
<ol>
<li>Declare the Fortran function with the <code>BIND(C)</code> attribute.</li>
<li>Ensure that the data types match between Fortran and C.</li>
</ol>
</div><h2>Example: Calling a Fortran Function</h2>
<div class='content'><h4>Fortran Code (save as <code>fortran_function.f90</code>)</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kdWxlIGZvcnRyYW5fbW9kdWxlCiAgdXNlIGlzb19jX2JpbmRpbmcKICBpbXBsaWNpdCBub25lCgpjb250YWlucwoKICBzdWJyb3V0aW5lIHByaW50X21lc3NhZ2UoKSBiaW5kKEMsIG5hbWU9InByaW50X21lc3NhZ2UiKQogICAgcHJpbnQgKiwgIkhlbGxvIGZyb20gRm9ydHJhbiEiCiAgZW5kIHN1YnJvdXRpbmUgcHJpbnRfbWVzc2FnZQoKZW5kIG1vZHVsZSBmb3J0cmFuX21vZHVsZQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>module fortran_module
  use iso_c_binding
  implicit none

contains

  subroutine print_message() bind(C, name=&quot;print_message&quot;)
    print *, &quot;Hello from Fortran!&quot;
  end subroutine print_message

end module fortran_module</pre></div><div class='content'><h4>C Code (save as <code>call_fortran_function.c</code>)</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I2luY2x1ZGUgPHN0ZGlvLmg+Cgp2b2lkIHByaW50X21lc3NhZ2UoKTsKCmludCBtYWluKCkgewogICAgcHJpbnRfbWVzc2FnZSgpOwogICAgcmV0dXJuIDA7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#include &lt;stdio.h&gt;

void print_message();

int main() {
    print_message();
    return 0;
}</pre></div><div class='content'><p>To compile and run the above example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2ZvcnRyYW4gLWMgZm9ydHJhbl9mdW5jdGlvbi5mOTAKZ2NjIGNhbGxfZm9ydHJhbl9mdW5jdGlvbi5jIGZvcnRyYW5fZnVuY3Rpb24ubyAtbyBjYWxsX2ZvcnRyYW5fZnVuY3Rpb24KLi9jYWxsX2ZvcnRyYW5fZnVuY3Rpb24="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gfortran -c fortran_function.f90
gcc call_fortran_function.c fortran_function.o -o call_fortran_function
./call_fortran_function</pre></div><div class='content'></div><h1>Data Type Mapping</h1>
<div class='content'><p>Understanding how Fortran data types map to C data types is crucial for interoperability. The following table summarizes common mappings:</p>
<p>| Fortran Data Type | C Data Type     | ISO_C_BINDING Constant |
|-------------------|-----------------|------------------------|
| INTEGER           | int             | <code>c_int</code>                |
| REAL              | float           | <code>c_float</code>              |
| DOUBLE PRECISION  | double          | <code>c_double</code>             |
| CHARACTER         | char            | <code>c_char</code>               |
| LOGICAL           | _Bool           | <code>c_bool</code>               |</p>
</div><h1>Exercises</h1>
<div class='content'><ol>
<li><strong>Simple Function Call</strong>: Write a Fortran program that calls a C function to add two integers and returns the result.</li>
<li><strong>Data Exchange</strong>: Create a Fortran program that passes an array to a C function, which modifies the array, and then prints the modified array in Fortran.</li>
<li><strong>Mixed Language Program</strong>: Develop a small application where Fortran handles numerical computations and C handles input/output operations.</li>
</ol>
</div><h1>Conclusion</h1>
<div class='content'><p>Interfacing Fortran with C allows you to combine the computational power of Fortran with the versatility of C. By understanding the <code>ISO_C_BINDING</code> module, data type mappings, and how to call functions between the two languages, you can create powerful, interoperable applications. Practice with the provided examples and exercises to solidify your understanding and enhance your programming skills.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='parallel-programming-coarrays'>&#x25C4;Parallel Programming with Coarrays</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Interfacing with C</a>
	</div>
	<div class='col-4 text-end'>
					<a href='optimization-techniques'>Optimization Techniques &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
