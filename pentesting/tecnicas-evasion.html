<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evasion Techniques</title>

    <link rel="alternate" href="https://campusempresa.com/pentesting/tecnicas-evasion" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/pentesting/tecnicas-evasion" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/pentesting/tecnicas-evasion" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/pentesting/tecnicas-evasion" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/pentesting/tecnicas-evasion" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In the context of pentesting, evasion techniques are methods used by pentesters to avoid detection by security systems such as firewalls, intrusion detection systems (IDS), and intrusion prevention systems (IPS). These techniques are crucial for assessing the effectiveness of an organization's defenses.</p>
</div><h1>Types of Evasion Techniques</h1>
<div class='content'></div><h2>Firewall Evasion</h2>
<div class='content'><ul>
<li><strong>Packet Fragmentation</strong>: Splitting a data packet into smaller fragments to avoid detection.</li>
<li><strong>Tunneling</strong>: Encapsulating malicious traffic in allowed protocols, such as HTTP or HTTPS.</li>
<li><strong>IP Spoofing</strong>: Altering the source IP address to make the traffic appear to come from a trusted source.</li>
</ul>
</div><h2>IDS/IPS Evasion</h2>
<div class='content'><ul>
<li><strong>Payload Obfuscation</strong>: Modifying the payload so that it does not match known signatures.</li>
<li><strong>Polymorphism</strong>: Changing the malicious code with each execution to avoid signature-based detection.</li>
<li><strong>Timing Attacks</strong>: Sending packets at irregular intervals to avoid detectable patterns.</li>
</ul>
</div><h2>Antivirus Evasion</h2>
<div class='content'><ul>
<li><strong>Packing</strong>: Using packing tools to modify the structure of the executable file.</li>
<li><strong>Encryption</strong>: Encrypting the malicious code and decrypting it at runtime.</li>
<li><strong>Using Social Engineering Techniques</strong>: Tricking the user into disabling the antivirus or allowing the execution of the malicious code.</li>
</ul>
</div><h1>Code Examples</h1>
<div class='content'></div><h2>Packet Fragmentation</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBzY2FweS5hbGwgaW1wb3J0ICoKCiMgQ3JlYXRlIGFuIElQIHBhY2tldCB3aXRoIGZyYWdtZW50YXRpb24KaXAgPSBJUChkc3Q9IjE5Mi4xNjguMS4xIiwgZmxhZ3M9Ik1GIikKdGNwID0gVENQKGRwb3J0PTgwLCBmbGFncz0iUyIpCnBrdCA9IGlwL3RjcAoKIyBTZW5kIHRoZSBmcmFnbWVudGVkIHBhY2tldApzZW5kKHBrdCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from scapy.all import *

# Create an IP packet with fragmentation
ip = IP(dst=&quot;192.168.1.1&quot;, flags=&quot;MF&quot;)
tcp = TCP(dport=80, flags=&quot;S&quot;)
pkt = ip/tcp

# Send the fragmented packet
send(pkt)</pre></div><div class='content'><p><em>Explanation</em>: This script uses the Scapy library to create and send a fragmented IP packet. The &quot;MF&quot; (More Fragments) flag indicates that the packet is part of a series of fragments.</p>
</div><h2>Payload Obfuscation</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGJhc2U2NAoKIyBPcmlnaW5hbCBwYXlsb2FkCnBheWxvYWQgPSAibWFsaWNpb3VzX2NvZGVfaGVyZSIKCiMgT2JmdXNjYXRpb24gdGhyb3VnaCBCYXNlNjQgZW5jb2RpbmcKb2JmdXNjYXRlZF9wYXlsb2FkID0gYmFzZTY0LmI2NGVuY29kZShwYXlsb2FkLmVuY29kZSgpKS5kZWNvZGUoKQoKcHJpbnQob2JmdXNjYXRlZF9wYXlsb2FkKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import base64

# Original payload
payload = &quot;malicious_code_here&quot;

# Obfuscation through Base64 encoding
obfuscated_payload = base64.b64encode(payload.encode()).decode()

print(obfuscated_payload)</pre></div><div class='content'><p><em>Explanation</em>: This script obfuscates a simple payload through Base64 encoding. Although basic, this method can bypass some signature-based detections.</p>
</div><h1>Comparison of Techniques</h1>
<div class='content'><p>| Technique                | Advantages                                      | Disadvantages                                  |
|--------------------------|-------------------------------------------------|------------------------------------------------|
| Packet Fragmentation     | Avoids detection by simple firewalls            | Can be detected by advanced IDS                |
| Tunneling                | Encapsulates malicious traffic in allowed protocols | Requires control over the destination server   |
| Polymorphism             | Changes the code with each execution            | Complexity in implementation                   |
| Packing                  | Modifies the structure of the executable file   | Can be detected by heuristic analysis          |</p>
</div><h1>Conclusion</h1>
<div class='content'><p>Evasion techniques are essential tools in a pentester's arsenal. Understanding and applying these techniques allows for assessing the robustness of an organization's defenses and improving its ability to detect and mitigate threats. It is important to remember that the use of these techniques must be ethical and authorized, always with the aim of improving the security of the evaluated systems.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
