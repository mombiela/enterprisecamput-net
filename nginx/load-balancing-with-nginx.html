<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Load Balancing with NGINX</title>

    <link rel="alternate" href="https://campusempresa.com/nginx/load-balancing-with-nginx" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/nginx/load-balancing-with-nginx" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/nginx/load-balancing-with-nginx" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/nginx/load-balancing-with-nginx" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/nginx/load-balancing-with-nginx" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='setting-up-reverse-proxy'>&#x25C4;Setting Up a Reverse Proxy</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Load Balancing with NGINX</a>
	</div>
	<div class='col-4 text-end'>
					<a href='caching-in-nginx'>Caching in NGINX &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Load Balancing</h1>
<div class='content'><p>Load balancing is a critical technique used to distribute network or application traffic across multiple servers. This ensures no single server bears too much demand, improving reliability and performance.</p>
<ul>
<li><strong>Definition</strong>: Load balancing distributes incoming network traffic across multiple servers.</li>
<li><strong>Benefits</strong>:
<ul>
<li>Improved reliability and availability.</li>
<li>Enhanced performance.</li>
<li>Scalability.</li>
</ul>
</li>
</ul>
</div><h1>Types of Load Balancing</h1>
<div class='content'><p>NGINX supports several load balancing methods:</p>
<ul>
<li><strong>Round Robin</strong>: Distributes requests sequentially.</li>
<li><strong>Least Connections</strong>: Sends requests to the server with the fewest active connections.</li>
<li><strong>IP Hash</strong>: Routes requests based on the client's IP address.</li>
</ul>
</div><h1>Setting Up NGINX for Load Balancing</h1>
<div class='content'></div><h2>Installing NGINX</h2>
<div class='content'><p>First, ensure NGINX is installed on your server. For most Linux distributions, you can use the package manager:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3VkbyBhcHQgdXBkYXRlCnN1ZG8gYXB0IGluc3RhbGwgbmdpbng="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sudo apt update
sudo apt install nginx</pre></div><div class='content'></div><h2>Basic Load Balancing Configuration</h2>
<div class='content'><p>To configure load balancing, you need to edit the NGINX configuration file, typically located at <code>/etc/nginx/nginx.conf</code> or <code>/etc/nginx/conf.d/default.conf</code>.</p>
<h4>Example: Round Robin Load Balancing</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICB1cHN0cmVhbSBiYWNrZW5kIHsKICAgICAgICBzZXJ2ZXIgYmFja2VuZDEuZXhhbXBsZS5jb207CiAgICAgICAgc2VydmVyIGJhY2tlbmQyLmV4YW1wbGUuY29tOwogICAgICAgIHNlcnZlciBiYWNrZW5kMy5leGFtcGxlLmNvbTsKICAgIH0KCiAgICBzZXJ2ZXIgewogICAgICAgIGxpc3RlbiA4MDsKCiAgICAgICAgbG9jYXRpb24gLyB7CiAgICAgICAgICAgIHByb3h5X3Bhc3MgaHR0cDovL2JhY2tlbmQ7CiAgICAgICAgfQogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    upstream backend {
        server backend1.example.com;
        server backend2.example.com;
        server backend3.example.com;
    }

    server {
        listen 80;

        location / {
            proxy_pass http://backend;
        }
    }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>upstream backend { ... }</code>: Defines a group of backend servers.</li>
<li><code>server backend1.example.com;</code>: Specifies each backend server.</li>
<li><code>proxy_pass http://backend;</code>: Forwards requests to the <code>backend</code> group.</li>
</ul>
</li>
</ul>
<h4>Example: Least Connections Load Balancing</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICB1cHN0cmVhbSBiYWNrZW5kIHsKICAgICAgICBsZWFzdF9jb25uOwogICAgICAgIHNlcnZlciBiYWNrZW5kMS5leGFtcGxlLmNvbTsKICAgICAgICBzZXJ2ZXIgYmFja2VuZDIuZXhhbXBsZS5jb207CiAgICAgICAgc2VydmVyIGJhY2tlbmQzLmV4YW1wbGUuY29tOwogICAgfQoKICAgIHNlcnZlciB7CiAgICAgICAgbGlzdGVuIDgwOwoKICAgICAgICBsb2NhdGlvbiAvIHsKICAgICAgICAgICAgcHJveHlfcGFzcyBodHRwOi8vYmFja2VuZDsKICAgICAgICB9CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    upstream backend {
        least_conn;
        server backend1.example.com;
        server backend2.example.com;
        server backend3.example.com;
    }

    server {
        listen 80;

        location / {
            proxy_pass http://backend;
        }
    }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>least_conn;</code>: Enables least connections load balancing.</li>
</ul>
</li>
</ul>
<h4>Example: IP Hash Load Balancing</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICB1cHN0cmVhbSBiYWNrZW5kIHsKICAgICAgICBpcF9oYXNoOwogICAgICAgIHNlcnZlciBiYWNrZW5kMS5leGFtcGxlLmNvbTsKICAgICAgICBzZXJ2ZXIgYmFja2VuZDIuZXhhbXBsZS5jb207CiAgICAgICAgc2VydmVyIGJhY2tlbmQzLmV4YW1wbGUuY29tOwogICAgfQoKICAgIHNlcnZlciB7CiAgICAgICAgbGlzdGVuIDgwOwoKICAgICAgICBsb2NhdGlvbiAvIHsKICAgICAgICAgICAgcHJveHlfcGFzcyBodHRwOi8vYmFja2VuZDsKICAgICAgICB9CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    upstream backend {
        ip_hash;
        server backend1.example.com;
        server backend2.example.com;
        server backend3.example.com;
    }

    server {
        listen 80;

        location / {
            proxy_pass http://backend;
        }
    }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>ip_hash;</code>: Enables IP hash load balancing.</li>
</ul>
</li>
</ul>
</div><h1>Advanced Load Balancing Techniques</h1>
<div class='content'></div><h2>Health Checks</h2>
<div class='content'><p>Health checks ensure that NGINX only sends requests to healthy backend servers.</p>
<h4>Example: Configuring Health Checks</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICB1cHN0cmVhbSBiYWNrZW5kIHsKICAgICAgICBzZXJ2ZXIgYmFja2VuZDEuZXhhbXBsZS5jb207CiAgICAgICAgc2VydmVyIGJhY2tlbmQyLmV4YW1wbGUuY29tOwogICAgICAgIHNlcnZlciBiYWNrZW5kMy5leGFtcGxlLmNvbTsKCiAgICAgICAgIyBIZWFsdGggY2hlY2sgY29uZmlndXJhdGlvbgogICAgICAgIHNlcnZlciBiYWNrZW5kMS5leGFtcGxlLmNvbSBtYXhfZmFpbHM9MyBmYWlsX3RpbWVvdXQ9MzBzOwogICAgICAgIHNlcnZlciBiYWNrZW5kMi5leGFtcGxlLmNvbSBtYXhfZmFpbHM9MyBmYWlsX3RpbWVvdXQ9MzBzOwogICAgICAgIHNlcnZlciBiYWNrZW5kMy5leGFtcGxlLmNvbSBtYXhfZmFpbHM9MyBmYWlsX3RpbWVvdXQ9MzBzOwogICAgfQoKICAgIHNlcnZlciB7CiAgICAgICAgbGlzdGVuIDgwOwoKICAgICAgICBsb2NhdGlvbiAvIHsKICAgICAgICAgICAgcHJveHlfcGFzcyBodHRwOi8vYmFja2VuZDsKICAgICAgICB9CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    upstream backend {
        server backend1.example.com;
        server backend2.example.com;
        server backend3.example.com;

        # Health check configuration
        server backend1.example.com max_fails=3 fail_timeout=30s;
        server backend2.example.com max_fails=3 fail_timeout=30s;
        server backend3.example.com max_fails=3 fail_timeout=30s;
    }

    server {
        listen 80;

        location / {
            proxy_pass http://backend;
        }
    }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>max_fails=3</code>: Marks a server as down after 3 failed attempts.</li>
<li><code>fail_timeout=30s</code>: The server will be considered down for 30 seconds after failing.</li>
</ul>
</li>
</ul>
</div><h2>Session Persistence</h2>
<div class='content'><p>Session persistence (or sticky sessions) ensures that a client is always directed to the same backend server.</p>
<h4>Example: Configuring Session Persistence</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICB1cHN0cmVhbSBiYWNrZW5kIHsKICAgICAgICBpcF9oYXNoOwogICAgICAgIHNlcnZlciBiYWNrZW5kMS5leGFtcGxlLmNvbTsKICAgICAgICBzZXJ2ZXIgYmFja2VuZDIuZXhhbXBsZS5jb207CiAgICAgICAgc2VydmVyIGJhY2tlbmQzLmV4YW1wbGUuY29tOwogICAgfQoKICAgIHNlcnZlciB7CiAgICAgICAgbGlzdGVuIDgwOwoKICAgICAgICBsb2NhdGlvbiAvIHsKICAgICAgICAgICAgcHJveHlfcGFzcyBodHRwOi8vYmFja2VuZDsKICAgICAgICB9CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    upstream backend {
        ip_hash;
        server backend1.example.com;
        server backend2.example.com;
        server backend3.example.com;
    }

    server {
        listen 80;

        location / {
            proxy_pass http://backend;
        }
    }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>ip_hash;</code>: Ensures requests from the same client IP are always sent to the same server.</li>
</ul>
</li>
</ul>
</div><h1>Monitoring and Logging</h1>
<div class='content'><p>Monitoring and logging are essential for maintaining a healthy load-balanced environment.</p>
<ul>
<li><strong>Access Logs</strong>: Track requests to your servers.</li>
<li><strong>Error Logs</strong>: Record issues and errors.</li>
</ul>
</div><h2>Example: Enabling Access Logs</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICBsb2dfZm9ybWF0IG1haW4gJyRyZW1vdGVfYWRkciAtICRyZW1vdGVfdXNlciBbJHRpbWVfbG9jYWxdICIkcmVxdWVzdCIgJwogICAgICAgICAgICAgICAgICAgICAgJyRzdGF0dXMgJGJvZHlfYnl0ZXNfc2VudCAiJGh0dHBfcmVmZXJlciIgJwogICAgICAgICAgICAgICAgICAgICAgJyIkaHR0cF91c2VyX2FnZW50IiAiJGh0dHBfeF9mb3J3YXJkZWRfZm9yIic7CgogICAgYWNjZXNzX2xvZyAvdmFyL2xvZy9uZ2lueC9hY2Nlc3MubG9nIG1haW47CgogICAgdXBzdHJlYW0gYmFja2VuZCB7CiAgICAgICAgc2VydmVyIGJhY2tlbmQxLmV4YW1wbGUuY29tOwogICAgICAgIHNlcnZlciBiYWNrZW5kMi5leGFtcGxlLmNvbTsKICAgICAgICBzZXJ2ZXIgYmFja2VuZDMuZXhhbXBsZS5jb207CiAgICB9CgogICAgc2VydmVyIHsKICAgICAgICBsaXN0ZW4gODA7CgogICAgICAgIGxvY2F0aW9uIC8gewogICAgICAgICAgICBwcm94eV9wYXNzIGh0dHA6Ly9iYWNrZW5kOwogICAgICAgIH0KICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    log_format main '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '
                      '$status $body_bytes_sent &quot;$http_referer&quot; '
                      '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;';

    access_log /var/log/nginx/access.log main;

    upstream backend {
        server backend1.example.com;
        server backend2.example.com;
        server backend3.example.com;
    }

    server {
        listen 80;

        location / {
            proxy_pass http://backend;
        }
    }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>log_format main ...</code>: Defines a custom log format.</li>
<li><code>access_log /var/log/nginx/access.log main;</code>: Specifies the log file and format.</li>
</ul>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Load balancing with NGINX is a powerful way to enhance the performance, reliability, and scalability of your web applications. By understanding and implementing different load balancing methods, health checks, session persistence, and monitoring, you can ensure your applications run smoothly and efficiently.</p>
<p>Remember to:</p>
<ul>
<li>Choose the right load balancing method based on your needs.</li>
<li>Implement health checks to maintain a healthy server pool.</li>
<li>Use session persistence if your application requires it.</li>
<li>Monitor and log traffic to keep track of your system's performance.</li>
</ul>
<p>By mastering these techniques, you'll be well-equipped to handle high-traffic scenarios and ensure a seamless experience for your users.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='setting-up-reverse-proxy'>&#x25C4;Setting Up a Reverse Proxy</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Load Balancing with NGINX</a>
	</div>
	<div class='col-4 text-end'>
					<a href='caching-in-nginx'>Caching in NGINX &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
