<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuring Sharded Clusters</title>

    <link rel="alternate" href="https://campusempresa.com/mongodb/configuring-sharded-clusters" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mongodb/configuring-sharded-clusters" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mongodb/configuring-sharded-clusters" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mongodb/configuring-sharded-clusters" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mongodb/configuring-sharded-clusters" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-sharding'>&#x25C4;Introduction to Sharding</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Configuring Sharded Clusters</a>
	</div>
	<div class='col-4 text-end'>
					<a href='managing-sharded-clusters'>Managing Sharded Clusters &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Sharding is a method for distributing data across multiple machines. MongoDB uses sharding to support deployments with very large data sets and high throughput operations. This section will guide you through the process of configuring sharded clusters in MongoDB, from the basics to advanced configurations.</p>
</div><h1>Introduction to Sharding</h1>
<div class='content'><ul>
<li><strong>Definition</strong>: Sharding is the process of storing data records across multiple machines and is MongoDB's approach to meeting the demands of data growth.</li>
<li><strong>Purpose</strong>: It helps in horizontal scaling by distributing data across multiple servers.</li>
<li><strong>Components</strong>:
<ul>
<li><strong>Shards</strong>: These are the data storage units. Each shard contains a subset of the sharded data.</li>
<li><strong>Config Servers</strong>: These store metadata and configuration settings for the cluster.</li>
<li><strong>Query Routers (mongos)</strong>: These are the interface between client applications and the sharded cluster.</li>
</ul>
</li>
</ul>
</div><h1>Setting Up a Sharded Cluster</h1>
<div class='content'></div><h2>Prerequisites</h2>
<div class='content'><ul>
<li><strong>MongoDB Installation</strong>: Ensure MongoDB is installed on all servers that will be part of the sharded cluster.</li>
<li><strong>Network Configuration</strong>: All servers should be able to communicate with each other.</li>
</ul>
</div><h2>Step-by-Step Configuration</h2>
<div class='content'><ol>
<li>
<p><strong>Start Config Servers</strong>:</p>
<ul>
<li>Config servers store metadata about the sharded cluster.</li>
<li>Start three config server instances for redundancy and reliability.</li>
</ul>
<pre><code class="language-bash">mongod --configsvr --replSet configReplSet --dbpath /data/configdb --port 27019
</code></pre>
</li>
<li>
<p><strong>Initiate the Config Server Replica Set</strong>:</p>
<ul>
<li>Connect to one of the config servers and initiate the replica set.</li>
</ul>
<pre><code class="language-javascript">mongo --port 27019
rs.initiate({
  _id: &quot;configReplSet&quot;,
  configsvr: true,
  members: [
    { _id: 0, host: &quot;configServer1:27019&quot; },
    { _id: 1, host: &quot;configServer2:27019&quot; },
    { _id: 2, host: &quot;configServer3:27019&quot; }
  ]
})
</code></pre>
</li>
<li>
<p><strong>Start Shard Servers</strong>:</p>
<ul>
<li>Each shard is a replica set. Start the mongod instances for each shard.</li>
</ul>
<pre><code class="language-bash">mongod --shardsvr --replSet shardReplSet1 --dbpath /data/shard1 --port 27018
</code></pre>
</li>
<li>
<p><strong>Initiate the Shard Replica Set</strong>:</p>
<ul>
<li>Connect to one of the shard servers and initiate the replica set.</li>
</ul>
<pre><code class="language-javascript">mongo --port 27018
rs.initiate({
  _id: &quot;shardReplSet1&quot;,
  members: [
    { _id: 0, host: &quot;shardServer1:27018&quot; },
    { _id: 1, host: &quot;shardServer2:27018&quot; },
    { _id: 2, host: &quot;shardServer3:27018&quot; }
  ]
})
</code></pre>
</li>
<li>
<p><strong>Start the mongos Instances</strong>:</p>
<ul>
<li>mongos instances route queries to the appropriate shard.</li>
</ul>
<pre><code class="language-bash">mongos --configdb configReplSet/configServer1:27019,configServer2:27019,configServer3:27019 --port 27017
</code></pre>
</li>
<li>
<p><strong>Add Shards to the Cluster</strong>:</p>
<ul>
<li>Connect to the mongos instance and add the shards.</li>
</ul>
<pre><code class="language-javascript">mongo --port 27017
sh.addShard(&quot;shardReplSet1/shardServer1:27018,shardServer2:27018,shardServer3:27018&quot;)
</code></pre>
</li>
</ol>
</div><h1>Sharding a Collection</h1>
<div class='content'><ol>
<li>
<p><strong>Enable Sharding for a Database</strong>:</p>
<pre><code class="language-javascript">sh.enableSharding(&quot;myDatabase&quot;)
</code></pre>
</li>
<li>
<p><strong>Shard a Collection</strong>:</p>
<ul>
<li>Choose a shard key that determines how the data is distributed.</li>
</ul>
<pre><code class="language-javascript">sh.shardCollection(&quot;myDatabase.myCollection&quot;, { shardKey: 1 })
</code></pre>
</li>
</ol>
</div><h1>Best Practices</h1>
<div class='content'><ul>
<li><strong>Shard Key Selection</strong>: Choose a shard key that ensures even distribution of data.</li>
<li><strong>Monitoring</strong>: Regularly monitor the cluster's performance and health.</li>
<li><strong>Backup</strong>: Implement a robust backup strategy.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Configuring a sharded cluster in MongoDB involves setting up config servers, shard servers, and mongos instances. Proper configuration and management of these components ensure efficient data distribution and high availability. By following the steps outlined in this guide, you can set up a sharded cluster that scales horizontally and handles large volumes of data effectively.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-sharding'>&#x25C4;Introduction to Sharding</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Configuring Sharded Clusters</a>
	</div>
	<div class='col-4 text-end'>
					<a href='managing-sharded-clusters'>Managing Sharded Clusters &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
