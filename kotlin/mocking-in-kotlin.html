<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mocking in Kotlin</title>

    <link rel="alternate" href="https://campusempresa.com/kotlin/mocking-in-kotlin" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/kotlin/mocking-in-kotlin" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/kotlin/mocking-in-kotlin" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/kotlin/mocking-in-kotlin" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/kotlin/mocking-in-kotlin" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='unit-testing-with-kotlin'>&#x25C4;Unit Testing with Kotlin</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Mocking in Kotlin</a>
	</div>
	<div class='col-4 text-end'>
					<a href='debugging-techniques'>Debugging Techniques &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Mocking is an essential concept in unit testing, allowing developers to simulate the behavior of complex objects and systems. This topic will guide you through the basics of mocking in Kotlin, using popular libraries like Mockito and MockK, and provide practical examples and exercises to solidify your understanding.</p>
</div><h1>Introduction to Mocking</h1>
<div class='content'><p>Mocking is the process of creating objects that simulate the behavior of real objects. This is particularly useful in unit testing, where you want to isolate the unit of code being tested and avoid dependencies on external systems or complex objects.</p>
<ul>
<li><strong>Why Mocking?</strong>
<ul>
<li>Isolate the unit of code under test.</li>
<li>Simulate complex objects and systems.</li>
<li>Control the behavior of dependencies.</li>
<li>Improve test reliability and performance.</li>
</ul>
</li>
</ul>
</div><h1>Mocking Libraries in Kotlin</h1>
<div class='content'><p>Kotlin supports several mocking libraries, with Mockito and MockK being the most popular.</p>
</div><h2>Mockito</h2>
<div class='content'><p>Mockito is a widely-used mocking framework for Java, and it can be used in Kotlin with some additional setup.</p>
<h4>Setting Up Mockito</h4>
<p>To use Mockito in your Kotlin project, add the following dependencies to your <code>build.gradle</code> file:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVwZW5kZW5jaWVzIHsKICAgIHRlc3RJbXBsZW1lbnRhdGlvbiAib3JnLm1vY2tpdG86bW9ja2l0by1jb3JlOjMuKyIgLy8gVXNlIHRoZSBsYXRlc3QgdmVyc2lvbgogICAgdGVzdEltcGxlbWVudGF0aW9uICJvcmcubW9ja2l0bzptb2NraXRvLWlubGluZTozLisiCiAgICB0ZXN0SW1wbGVtZW50YXRpb24gIm9yZy5qZXRicmFpbnMua290bGluOmtvdGxpbi10ZXN0OjEuKyIgLy8gVXNlIHRoZSBsYXRlc3QgdmVyc2lvbgp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>dependencies {
    testImplementation &quot;org.mockito:mockito-core:3.+&quot; // Use the latest version
    testImplementation &quot;org.mockito:mockito-inline:3.+&quot;
    testImplementation &quot;org.jetbrains.kotlin:kotlin-test:1.+&quot; // Use the latest version
}</pre></div><div class='content'><h4>Basic Mockito Example</h4>
<p>Here's a simple example of using Mockito to mock a dependency in Kotlin:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5qdW5pdC5UZXN0CmltcG9ydCBvcmcubW9ja2l0by5Nb2NraXRvLioKCmNsYXNzIFVzZXJTZXJ2aWNlVGVzdCB7CgogICAgQFRlc3QKICAgIGZ1biBgc2hvdWxkIHJldHVybiB1c2VyIGRldGFpbHNgKCkgewogICAgICAgIC8vIEFycmFuZ2UKICAgICAgICB2YWwgdXNlclJlcG9zaXRvcnkgPSBtb2NrKFVzZXJSZXBvc2l0b3J5OjpjbGFzcy5qYXZhKQogICAgICAgIHZhbCB1c2VyU2VydmljZSA9IFVzZXJTZXJ2aWNlKHVzZXJSZXBvc2l0b3J5KQogICAgICAgIHZhbCB1c2VyID0gVXNlcigiSm9obiIsICJEb2UiKQogICAgICAgIAogICAgICAgIGB3aGVuYCh1c2VyUmVwb3NpdG9yeS5nZXRVc2VyRGV0YWlscygiSm9obiIpKS50aGVuUmV0dXJuKHVzZXIpCgogICAgICAgIC8vIEFjdAogICAgICAgIHZhbCByZXN1bHQgPSB1c2VyU2VydmljZS5nZXRVc2VyRGV0YWlscygiSm9obiIpCgogICAgICAgIC8vIEFzc2VydAogICAgICAgIGFzc2VydChyZXN1bHQgPT0gdXNlcikKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.junit.Test
import org.mockito.Mockito.*

class UserServiceTest {

    @Test
    fun `should return user details`() {
        // Arrange
        val userRepository = mock(UserRepository::class.java)
        val userService = UserService(userRepository)
        val user = User(&quot;John&quot;, &quot;Doe&quot;)
        
        `when`(userRepository.getUserDetails(&quot;John&quot;)).thenReturn(user)

        // Act
        val result = userService.getUserDetails(&quot;John&quot;)

        // Assert
        assert(result == user)
    }
}</pre></div><div class='content'><p>In this example:</p>
<ul>
<li>We mock the <code>UserRepository</code> dependency.</li>
<li>We define the behavior of the mock using <code>when</code> and <code>thenReturn</code>.</li>
<li>We verify the result using assertions.</li>
</ul>
</div><h2>MockK</h2>
<div class='content'><p>MockK is a Kotlin-specific mocking library that provides a more idiomatic Kotlin experience.</p>
<h4>Setting Up MockK</h4>
<p>To use MockK in your Kotlin project, add the following dependencies to your <code>build.gradle</code> file:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVwZW5kZW5jaWVzIHsKICAgIHRlc3RJbXBsZW1lbnRhdGlvbiAiaW8ubW9ja2s6bW9ja2s6MS4rIiAvLyBVc2UgdGhlIGxhdGVzdCB2ZXJzaW9uCiAgICB0ZXN0SW1wbGVtZW50YXRpb24gIm9yZy5qZXRicmFpbnMua290bGluOmtvdGxpbi10ZXN0OjEuKyIgLy8gVXNlIHRoZSBsYXRlc3QgdmVyc2lvbgp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>dependencies {
    testImplementation &quot;io.mockk:mockk:1.+&quot; // Use the latest version
    testImplementation &quot;org.jetbrains.kotlin:kotlin-test:1.+&quot; // Use the latest version
}</pre></div><div class='content'><h4>Basic MockK Example</h4>
<p>Here's a simple example of using MockK to mock a dependency in Kotlin:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGlvLm1vY2trLmV2ZXJ5CmltcG9ydCBpby5tb2Nray5tb2NrawppbXBvcnQgaW8ubW9ja2sudmVyaWZ5CmltcG9ydCBvcmcuanVuaXQuVGVzdAoKY2xhc3MgVXNlclNlcnZpY2VUZXN0IHsKCiAgICBAVGVzdAogICAgZnVuIGBzaG91bGQgcmV0dXJuIHVzZXIgZGV0YWlsc2AoKSB7CiAgICAgICAgLy8gQXJyYW5nZQogICAgICAgIHZhbCB1c2VyUmVwb3NpdG9yeSA9IG1vY2trPFVzZXJSZXBvc2l0b3J5PigpCiAgICAgICAgdmFsIHVzZXJTZXJ2aWNlID0gVXNlclNlcnZpY2UodXNlclJlcG9zaXRvcnkpCiAgICAgICAgdmFsIHVzZXIgPSBVc2VyKCJKb2huIiwgIkRvZSIpCiAgICAgICAgCiAgICAgICAgZXZlcnkgeyB1c2VyUmVwb3NpdG9yeS5nZXRVc2VyRGV0YWlscygiSm9obiIpIH0gcmV0dXJucyB1c2VyCgogICAgICAgIC8vIEFjdAogICAgICAgIHZhbCByZXN1bHQgPSB1c2VyU2VydmljZS5nZXRVc2VyRGV0YWlscygiSm9obiIpCgogICAgICAgIC8vIEFzc2VydAogICAgICAgIGFzc2VydChyZXN1bHQgPT0gdXNlcikKICAgICAgICB2ZXJpZnkgeyB1c2VyUmVwb3NpdG9yeS5nZXRVc2VyRGV0YWlscygiSm9obiIpIH0KICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import io.mockk.every
import io.mockk.mockk
import io.mockk.verify
import org.junit.Test

class UserServiceTest {

    @Test
    fun `should return user details`() {
        // Arrange
        val userRepository = mockk&lt;UserRepository&gt;()
        val userService = UserService(userRepository)
        val user = User(&quot;John&quot;, &quot;Doe&quot;)
        
        every { userRepository.getUserDetails(&quot;John&quot;) } returns user

        // Act
        val result = userService.getUserDetails(&quot;John&quot;)

        // Assert
        assert(result == user)
        verify { userRepository.getUserDetails(&quot;John&quot;) }
    }
}</pre></div><div class='content'><p>In this example:</p>
<ul>
<li>We mock the <code>UserRepository</code> dependency using <code>mockk</code>.</li>
<li>We define the behavior of the mock using <code>every</code> and <code>returns</code>.</li>
<li>We verify the interaction with the mock using <code>verify</code>.</li>
</ul>
</div><h1>Advanced Mocking Techniques</h1>
<div class='content'></div><h2>Argument Matching</h2>
<div class='content'><p>Both Mockito and MockK support argument matching, allowing you to specify conditions for method arguments.</p>
<h4>Mockito Argument Matching</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YHdoZW5gKHVzZXJSZXBvc2l0b3J5LmdldFVzZXJEZXRhaWxzKGFueVN0cmluZygpKSkudGhlblJldHVybih1c2VyKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>`when`(userRepository.getUserDetails(anyString())).thenReturn(user)</pre></div><div class='content'><h4>MockK Argument Matching</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZXZlcnkgeyB1c2VyUmVwb3NpdG9yeS5nZXRVc2VyRGV0YWlscyhhbnkoKSkgfSByZXR1cm5zIHVzZXI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>every { userRepository.getUserDetails(any()) } returns user</pre></div><div class='content'></div><h2>Verifying Interactions</h2>
<div class='content'><p>You can verify that certain interactions with mocks occurred.</p>
<h4>Mockito Verification</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmVyaWZ5KHVzZXJSZXBvc2l0b3J5KS5nZXRVc2VyRGV0YWlscygiSm9obiIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>verify(userRepository).getUserDetails(&quot;John&quot;)</pre></div><div class='content'><h4>MockK Verification</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmVyaWZ5IHsgdXNlclJlcG9zaXRvcnkuZ2V0VXNlckRldGFpbHMoIkpvaG4iKSB9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>verify { userRepository.getUserDetails(&quot;John&quot;) }</pre></div><div class='content'></div><h2>Capturing Arguments</h2>
<div class='content'><p>Sometimes, you need to capture arguments passed to mocked methods.</p>
<h4>Mockito Argument Captor</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIGNhcHRvciA9IEFyZ3VtZW50Q2FwdG9yLmZvckNsYXNzKFN0cmluZzo6Y2xhc3MuamF2YSkKdmVyaWZ5KHVzZXJSZXBvc2l0b3J5KS5nZXRVc2VyRGV0YWlscyhjYXB0b3IuY2FwdHVyZSgpKQphc3NlcnQoY2FwdG9yLnZhbHVlID09ICJKb2huIik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val captor = ArgumentCaptor.forClass(String::class.java)
verify(userRepository).getUserDetails(captor.capture())
assert(captor.value == &quot;John&quot;)</pre></div><div class='content'><h4>MockK Argument Captor</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIHNsb3QgPSBzbG90PFN0cmluZz4oKQp2ZXJpZnkgeyB1c2VyUmVwb3NpdG9yeS5nZXRVc2VyRGV0YWlscyhjYXB0dXJlKHNsb3QpKSB9CmFzc2VydChzbG90LmNhcHR1cmVkID09ICJKb2huIik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val slot = slot&lt;String&gt;()
verify { userRepository.getUserDetails(capture(slot)) }
assert(slot.captured == &quot;John&quot;)</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Mocking is a powerful technique in unit testing that allows you to isolate the unit of code under test and simulate complex dependencies. Kotlin supports several mocking libraries, with Mockito and MockK being the most popular. By understanding the basics and advanced techniques of mocking, you can write more reliable and maintainable tests for your Kotlin applications.</p>
</div><h2>Key Takeaways</h2>
<div class='content'><ul>
<li>Mocking helps isolate the unit of code under test.</li>
<li>Mockito and MockK are popular mocking libraries in Kotlin.</li>
<li>Basic mocking involves creating mocks, defining behavior, and verifying interactions.</li>
<li>Advanced techniques include argument matching, interaction verification, and argument capturing.</li>
</ul>
<p>Practice using these techniques in your projects to gain a deeper understanding and improve your testing skills.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='unit-testing-with-kotlin'>&#x25C4;Unit Testing with Kotlin</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Mocking in Kotlin</a>
	</div>
	<div class='col-4 text-end'>
					<a href='debugging-techniques'>Debugging Techniques &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
