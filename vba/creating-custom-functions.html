<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creating Custom Functions</title>

    <link rel="alternate" href="https://campusempresa.com/vba/creating-custom-functions" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/vba/creating-custom-functions" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/vba/creating-custom-functions" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/vba/creating-custom-functions" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/vba/creating-custom-functions" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='automating-tasks-with-vba'>&#x25C4;Automating Tasks with VBA</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Creating Custom Functions</a>
	</div>
	<div class='col-4 text-end'>
					<a href='interacting-with-other-office-applications'>Interacting with Other Office Applications &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Creating custom functions in VBA allows you to extend the capabilities of Excel and other Office applications by writing your own reusable code. This topic will guide you from the basics to advanced techniques in creating custom functions.</p>
</div><h1>Introduction to Custom Functions</h1>
<div class='content'><p>Custom functions, also known as User-Defined Functions (UDFs), are functions that you create to perform specific calculations or tasks that are not available in Excel's built-in functions.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Function Definition</strong>: The structure and syntax of a function.</li>
<li><strong>Function Arguments</strong>: Parameters that you pass to the function.</li>
<li><strong>Return Value</strong>: The result that the function returns.</li>
</ul>
</div><h1>Writing Your First Custom Function</h1>
<div class='content'><p>Let's start by writing a simple custom function in VBA.</p>
</div><h2>Example: A Simple Addition Function</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnVuY3Rpb24gQWRkTnVtYmVycyhhIEFzIERvdWJsZSwgYiBBcyBEb3VibGUpIEFzIERvdWJsZQogICAgQWRkTnVtYmVycyA9IGEgKyBiCkVuZCBGdW5jdGlvbg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Function AddNumbers(a As Double, b As Double) As Double
    AddNumbers = a + b
End Function</pre></div><div class='content'><h4>Explanation</h4>
<ul>
<li><strong>Function AddNumbers</strong>: This defines a new function named <code>AddNumbers</code>.</li>
<li><strong>Parameters (a As Double, b As Double)</strong>: The function takes two arguments, <code>a</code> and <code>b</code>, both of type <code>Double</code>.</li>
<li><strong>Return Value (As Double)</strong>: The function returns a value of type <code>Double</code>.</li>
<li><strong>Function Body (AddNumbers = a + b)</strong>: The function adds the two arguments and returns the result.</li>
</ul>
</div><h2>Using the Custom Function in Excel</h2>
<div class='content'><ol>
<li>Open Excel and press <code>Alt + F11</code> to open the VBA editor.</li>
<li>Insert a new module by clicking <code>Insert &gt; Module</code>.</li>
<li>Copy and paste the <code>AddNumbers</code> function into the module.</li>
<li>Return to Excel and use the function like any other Excel function:
<pre><code class="language-excel">=AddNumbers(5, 10)
</code></pre>
</li>
</ol>
</div><h1>Adding Error Handling</h1>
<div class='content'><p>It's important to handle errors in your functions to make them robust.</p>
</div><h2>Example: Division with Error Handling</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnVuY3Rpb24gU2FmZURpdmlkZShhIEFzIERvdWJsZSwgYiBBcyBEb3VibGUpIEFzIFZhcmlhbnQKICAgIElmIGIgPSAwIFRoZW4KICAgICAgICBTYWZlRGl2aWRlID0gIkVycm9yOiBEaXZpc2lvbiBieSB6ZXJvIgogICAgRWxzZQogICAgICAgIFNhZmVEaXZpZGUgPSBhIC8gYgogICAgRW5kIElmCkVuZCBGdW5jdGlvbg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Function SafeDivide(a As Double, b As Double) As Variant
    If b = 0 Then
        SafeDivide = &quot;Error: Division by zero&quot;
    Else
        SafeDivide = a / b
    End If
End Function</pre></div><div class='content'><h4>Explanation</h4>
<ul>
<li><strong>Return Type (As Variant)</strong>: Using <code>Variant</code> allows the function to return either a number or an error message.</li>
<li><strong>Error Check (If b = 0)</strong>: Checks if the denominator is zero.</li>
<li><strong>Error Message (SafeDivide = &quot;Error: Division by zero&quot;)</strong>: Returns an error message if the denominator is zero.</li>
<li><strong>Division (SafeDivide = a / b)</strong>: Performs the division if the denominator is not zero.</li>
</ul>
</div><h1>Advanced Custom Functions</h1>
<div class='content'><p>Advanced custom functions can include more complex logic, multiple steps, and interaction with Excel objects.</p>
</div><h2>Example: Calculating the Average of a Range</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnVuY3Rpb24gQXZlcmFnZVJhbmdlKHJuZyBBcyBSYW5nZSkgQXMgRG91YmxlCiAgICBEaW0gY2VsbCBBcyBSYW5nZQogICAgRGltIHRvdGFsIEFzIERvdWJsZQogICAgRGltIGNvdW50IEFzIEludGVnZXIKICAgIAogICAgdG90YWwgPSAwCiAgICBjb3VudCA9IDAKICAgIAogICAgRm9yIEVhY2ggY2VsbCBJbiBybmcKICAgICAgICBJZiBJc051bWVyaWMoY2VsbC5WYWx1ZSkgVGhlbgogICAgICAgICAgICB0b3RhbCA9IHRvdGFsICsgY2VsbC5WYWx1ZQogICAgICAgICAgICBjb3VudCA9IGNvdW50ICsgMQogICAgICAgIEVuZCBJZgogICAgTmV4dCBjZWxsCiAgICAKICAgIElmIGNvdW50ID4gMCBUaGVuCiAgICAgICAgQXZlcmFnZVJhbmdlID0gdG90YWwgLyBjb3VudAogICAgRWxzZQogICAgICAgIEF2ZXJhZ2VSYW5nZSA9IDAKICAgIEVuZCBJZgpFbmQgRnVuY3Rpb24="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Function AverageRange(rng As Range) As Double
    Dim cell As Range
    Dim total As Double
    Dim count As Integer
    
    total = 0
    count = 0
    
    For Each cell In rng
        If IsNumeric(cell.Value) Then
            total = total + cell.Value
            count = count + 1
        End If
    Next cell
    
    If count &gt; 0 Then
        AverageRange = total / count
    Else
        AverageRange = 0
    End If
End Function</pre></div><div class='content'><h4>Explanation</h4>
<ul>
<li><strong>Parameter (rng As Range)</strong>: The function takes a range of cells as an argument.</li>
<li><strong>Variables (Dim total As Double, count As Integer)</strong>: Initializes variables to store the total sum and count of numeric cells.</li>
<li><strong>Loop (For Each cell In rng)</strong>: Iterates through each cell in the range.</li>
<li><strong>Check (If IsNumeric(cell.Value))</strong>: Checks if the cell contains a numeric value.</li>
<li><strong>Sum and Count (total = total + cell.Value, count = count + 1)</strong>: Adds the cell value to the total and increments the count.</li>
<li><strong>Average Calculation (AverageRange = total / count)</strong>: Calculates the average if there are numeric cells, otherwise returns 0.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Creating custom functions in VBA allows you to tailor Excel to your specific needs, making your work more efficient and effective. By understanding the basics of function definition, handling errors, and implementing advanced logic, you can create powerful and reusable functions.</p>
</div><h2>Summary</h2>
<div class='content'><ul>
<li>Custom functions extend Excel's capabilities.</li>
<li>Start with simple functions and gradually add complexity.</li>
<li>Handle errors to make your functions robust.</li>
<li>Use loops and conditions to create advanced functions.</li>
</ul>
<p>By mastering these techniques, you'll be able to create custom functions that save time and enhance your productivity in Excel.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='automating-tasks-with-vba'>&#x25C4;Automating Tasks with VBA</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Creating Custom Functions</a>
	</div>
	<div class='col-4 text-end'>
					<a href='interacting-with-other-office-applications'>Interacting with Other Office Applications &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
