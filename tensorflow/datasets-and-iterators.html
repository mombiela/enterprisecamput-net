<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Datasets and Iterators in TensorFlow</title>

    <link rel="alternate" href="https://campusempresa.com/tensorflow/datasets-and-iterators" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/tensorflow/datasets-and-iterators" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/tensorflow/datasets-and-iterators" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/tensorflow/datasets-and-iterators" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/tensorflow/datasets-and-iterators" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='loading-and-preprocessing-data'>&#x25C4;Loading and Preprocessing Data</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Datasets and Iterators in TensorFlow</a>
	</div>
	<div class='col-4 text-end'>
					<a href='data-augmentation'>Data Augmentation &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this section, we will explore how to efficiently handle data using Datasets and Iterators in TensorFlow. This is crucial for building scalable and efficient machine learning models. We will cover the basics of creating datasets, transforming them, and iterating through them.</p>
</div><h1>Creating Datasets</h1>
<div class='content'><p>TensorFlow provides the <code>tf.data</code> API to build complex input pipelines from simple, reusable pieces.</p>
</div><h2>From Tensors</h2>
<div class='content'><p>You can create a dataset directly from tensors using <code>tf.data.Dataset.from_tensor_slices</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgQ3JlYXRlIGEgZGF0YXNldCBmcm9tIHRlbnNvcnMKZGF0YSA9IHRmLmRhdGEuRGF0YXNldC5mcm9tX3RlbnNvcl9zbGljZXMoWzEsIDIsIDMsIDQsIDVdKQpmb3IgZWxlbWVudCBpbiBkYXRhOgogICAgcHJpbnQoZWxlbWVudC5udW1weSgpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Create a dataset from tensors
data = tf.data.Dataset.from_tensor_slices([1, 2, 3, 4, 5])
for element in data:
    print(element.numpy())</pre></div><div class='content'></div><h2>From Files</h2>
<div class='content'><p>You can also create datasets from files, such as CSV files or TFRecord files.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBkYXRhc2V0IGZyb20gYSBDU1YgZmlsZQpmaWxlX3BhdGggPSAncGF0aC90by95b3VyL2NzdmZpbGUuY3N2JwpkYXRhc2V0ID0gdGYuZGF0YS5leHBlcmltZW50YWwubWFrZV9jc3ZfZGF0YXNldCgKICAgIGZpbGVfcGF0aCwKICAgIGJhdGNoX3NpemU9NSwKICAgIGxhYmVsX25hbWU9J2xhYmVsX2NvbHVtbl9uYW1lJywKICAgIG5hX3ZhbHVlPSI/IiwKICAgIG51bV9lcG9jaHM9MSwKICAgIGlnbm9yZV9lcnJvcnM9VHJ1ZQop"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a dataset from a CSV file
file_path = 'path/to/your/csvfile.csv'
dataset = tf.data.experimental.make_csv_dataset(
    file_path,
    batch_size=5,
    label_name='label_column_name',
    na_value=&quot;?&quot;,
    num_epochs=1,
    ignore_errors=True
)</pre></div><div class='content'></div><h1>Transforming Datasets</h1>
<div class='content'><p>Transformations allow you to map, batch, shuffle, and prefetch data to optimize the input pipeline.</p>
</div><h2>Mapping</h2>
<div class='content'><p>Use the <code>map</code> method to apply a function to each element in the dataset.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIGFkZF9vbmUoeCk6CiAgICByZXR1cm4geCArIDEKCm1hcHBlZF9kYXRhID0gZGF0YS5tYXAoYWRkX29uZSkKZm9yIGVsZW1lbnQgaW4gbWFwcGVkX2RhdGE6CiAgICBwcmludChlbGVtZW50Lm51bXB5KCkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def add_one(x):
    return x + 1

mapped_data = data.map(add_one)
for element in mapped_data:
    print(element.numpy())</pre></div><div class='content'></div><h2>Batching</h2>
<div class='content'><p>Batching combines consecutive elements of the dataset into a single element.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YmF0Y2hlZF9kYXRhID0gZGF0YS5iYXRjaCgyKQpmb3IgYmF0Y2ggaW4gYmF0Y2hlZF9kYXRhOgogICAgcHJpbnQoYmF0Y2gubnVtcHkoKSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>batched_data = data.batch(2)
for batch in batched_data:
    print(batch.numpy())</pre></div><div class='content'></div><h2>Shuffling</h2>
<div class='content'><p>Shuffling randomizes the order of elements in the dataset.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2h1ZmZsZWRfZGF0YSA9IGRhdGEuc2h1ZmZsZShidWZmZXJfc2l6ZT01KQpmb3IgZWxlbWVudCBpbiBzaHVmZmxlZF9kYXRhOgogICAgcHJpbnQoZWxlbWVudC5udW1weSgpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>shuffled_data = data.shuffle(buffer_size=5)
for element in shuffled_data:
    print(element.numpy())</pre></div><div class='content'></div><h2>Prefetching</h2>
<div class='content'><p>Prefetching overlaps the preprocessing and model execution of data.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJlZmV0Y2hlZF9kYXRhID0gZGF0YS5wcmVmZXRjaChidWZmZXJfc2l6ZT10Zi5kYXRhLmV4cGVyaW1lbnRhbC5BVVRPVFVORSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>prefetched_data = data.prefetch(buffer_size=tf.data.experimental.AUTOTUNE)</pre></div><div class='content'></div><h1>Iterating Through Datasets</h1>
<div class='content'><p>Iterators provide a way to access elements of the dataset.</p>
</div><h2>One-shot Iterator</h2>
<div class='content'><p>A one-shot iterator is the simplest form of iterator.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aXRlcmF0b3IgPSBpdGVyKGRhdGEpCnByaW50KG5leHQoaXRlcmF0b3IpLm51bXB5KCkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>iterator = iter(data)
print(next(iterator).numpy())</pre></div><div class='content'></div><h2>Initializable Iterator</h2>
<div class='content'><p>An initializable iterator requires explicit initialization.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aXRlcmF0b3IgPSBpdGVyKGRhdGEpCnByaW50KG5leHQoaXRlcmF0b3IpLm51bXB5KCkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>iterator = iter(data)
print(next(iterator).numpy())</pre></div><div class='content'></div><h1>Advanced Techniques</h1>
<div class='content'><p>For more complex input pipelines, you can use features like <code>tf.data.Dataset.zip</code>, <code>tf.data.Dataset.concatenate</code>, and <code>tf.data.Dataset.interleave</code>.</p>
</div><h2>Zipping Datasets</h2>
<div class='content'><p>Combines elements of two datasets into a single dataset.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGF0YXNldDEgPSB0Zi5kYXRhLkRhdGFzZXQuZnJvbV90ZW5zb3Jfc2xpY2VzKFsxLCAyLCAzXSkKZGF0YXNldDIgPSB0Zi5kYXRhLkRhdGFzZXQuZnJvbV90ZW5zb3Jfc2xpY2VzKFsnYScsICdiJywgJ2MnXSkKemlwcGVkX2RhdGEgPSB0Zi5kYXRhLkRhdGFzZXQuemlwKChkYXRhc2V0MSwgZGF0YXNldDIpKQoKZm9yIGVsZW1lbnQgaW4gemlwcGVkX2RhdGE6CiAgICBwcmludChlbGVtZW50KQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>dataset1 = tf.data.Dataset.from_tensor_slices([1, 2, 3])
dataset2 = tf.data.Dataset.from_tensor_slices(['a', 'b', 'c'])
zipped_data = tf.data.Dataset.zip((dataset1, dataset2))

for element in zipped_data:
    print(element)</pre></div><div class='content'></div><h2>Concatenating Datasets</h2>
<div class='content'><p>Concatenates two datasets.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGF0YXNldDMgPSB0Zi5kYXRhLkRhdGFzZXQuZnJvbV90ZW5zb3Jfc2xpY2VzKFs0LCA1LCA2XSkKY29uY2F0ZW5hdGVkX2RhdGEgPSBkYXRhc2V0MS5jb25jYXRlbmF0ZShkYXRhc2V0MykKCmZvciBlbGVtZW50IGluIGNvbmNhdGVuYXRlZF9kYXRhOgogICAgcHJpbnQoZWxlbWVudC5udW1weSgpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>dataset3 = tf.data.Dataset.from_tensor_slices([4, 5, 6])
concatenated_data = dataset1.concatenate(dataset3)

for element in concatenated_data:
    print(element.numpy())</pre></div><div class='content'></div><h2>Interleaving Datasets</h2>
<div class='content'><p>Interleaves elements from multiple datasets.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW50ZXJsZWF2ZWRfZGF0YSA9IHRmLmRhdGEuRGF0YXNldC5mcm9tX3RlbnNvcl9zbGljZXMoWzEsIDIsIDNdKS5pbnRlcmxlYXZlKAogICAgbGFtYmRhIHg6IHRmLmRhdGEuRGF0YXNldC5mcm9tX3RlbnNvcnMoeCkucmVwZWF0KDIpLAogICAgY3ljbGVfbGVuZ3RoPTIKKQoKZm9yIGVsZW1lbnQgaW4gaW50ZXJsZWF2ZWRfZGF0YToKICAgIHByaW50KGVsZW1lbnQubnVtcHkoKSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>interleaved_data = tf.data.Dataset.from_tensor_slices([1, 2, 3]).interleave(
    lambda x: tf.data.Dataset.from_tensors(x).repeat(2),
    cycle_length=2
)

for element in interleaved_data:
    print(element.numpy())</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the basics and some advanced techniques for handling datasets and iterators in TensorFlow. Efficient data handling is crucial for building scalable machine learning models. By mastering these techniques, you can ensure that your models are both efficient and effective.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='loading-and-preprocessing-data'>&#x25C4;Loading and Preprocessing Data</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Datasets and Iterators in TensorFlow</a>
	</div>
	<div class='col-4 text-end'>
					<a href='data-augmentation'>Data Augmentation &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
