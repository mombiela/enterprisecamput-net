<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Overfitting and Underfitting in TensorFlow</title>

    <link rel="alternate" href="https://campusempresa.com/tensorflow/overfitting-and-underfitting" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/tensorflow/overfitting-and-underfitting" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/tensorflow/overfitting-and-underfitting" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/tensorflow/overfitting-and-underfitting" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/tensorflow/overfitting-and-underfitting" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='evaluating-a-model'>&#x25C4;Evaluating a Model</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Overfitting and Underfitting in TensorFlow</a>
	</div>
	<div class='col-4 text-end'>
					<a href='saving-and-loading-models'>Saving and Loading Models &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this section, we will explore the concepts of overfitting and underfitting, which are crucial in the field of machine learning. Understanding these concepts will help you build more accurate and generalizable models using TensorFlow.</p>
</div><h1>Key Concepts</h1>
<div class='content'></div><h2>Overfitting</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: Overfitting occurs when a model learns the training data too well, capturing noise and details that do not generalize to new data.</li>
<li><strong>Symptoms</strong>: High accuracy on training data but poor performance on validation/test data.</li>
<li><strong>Causes</strong>:
<ul>
<li>Too complex model (e.g., too many layers or neurons).</li>
<li>Insufficient training data.</li>
<li>Too many training epochs.</li>
</ul>
</li>
</ul>
</div><h2>Underfitting</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: Underfitting happens when a model is too simple to capture the underlying patterns in the data.</li>
<li><strong>Symptoms</strong>: Poor performance on both training and validation/test data.</li>
<li><strong>Causes</strong>:
<ul>
<li>Too simple model (e.g., too few layers or neurons).</li>
<li>Insufficient training epochs.</li>
<li>Poor feature selection.</li>
</ul>
</li>
</ul>
</div><h1>Strategies to Mitigate Overfitting and Underfitting</h1>
<div class='content'></div><h2>Techniques to Prevent Overfitting</h2>
<div class='content'><ul>
<li><strong>Regularization</strong>: Adding a penalty to the loss function to discourage complex models.
<ul>
<li>L1 Regularization (Lasso)</li>
<li>L2 Regularization (Ridge)</li>
</ul>
</li>
<li><strong>Dropout</strong>: Randomly dropping units (along with their connections) during training to prevent co-adaptation.</li>
<li><strong>Early Stopping</strong>: Monitoring the validation loss and stopping training when it starts to increase.</li>
<li><strong>Data Augmentation</strong>: Increasing the diversity of the training data by applying random transformations.</li>
</ul>
</div><h2>Techniques to Prevent Underfitting</h2>
<div class='content'><ul>
<li><strong>Increase Model Complexity</strong>: Adding more layers or neurons to the model.</li>
<li><strong>Train Longer</strong>: Increasing the number of training epochs.</li>
<li><strong>Feature Engineering</strong>: Creating more relevant features from the existing data.</li>
</ul>
</div><h1>Practical Examples</h1>
<div class='content'></div><h2>Example of Overfitting</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzIGltcG9ydCBsYXllcnMsIG1vZGVscwpmcm9tIHRlbnNvcmZsb3cua2VyYXMuZGF0YXNldHMgaW1wb3J0IG1uaXN0CgojIExvYWQgZGF0YQoodHJhaW5faW1hZ2VzLCB0cmFpbl9sYWJlbHMpLCAodGVzdF9pbWFnZXMsIHRlc3RfbGFiZWxzKSA9IG1uaXN0LmxvYWRfZGF0YSgpCnRyYWluX2ltYWdlcyA9IHRyYWluX2ltYWdlcy5yZXNoYXBlKCg2MDAwMCwgMjgsIDI4LCAxKSkuYXN0eXBlKCdmbG9hdDMyJykgLyAyNTUKdGVzdF9pbWFnZXMgPSB0ZXN0X2ltYWdlcy5yZXNoYXBlKCgxMDAwMCwgMjgsIDI4LCAxKSkuYXN0eXBlKCdmbG9hdDMyJykgLyAyNTUKCiMgQnVpbGQgYSBjb21wbGV4IG1vZGVsCm1vZGVsID0gbW9kZWxzLlNlcXVlbnRpYWwoWwogICAgbGF5ZXJzLkNvbnYyRCg2NCwgKDMsIDMpLCBhY3RpdmF0aW9uPSdyZWx1JywgaW5wdXRfc2hhcGU9KDI4LCAyOCwgMSkpLAogICAgbGF5ZXJzLk1heFBvb2xpbmcyRCgoMiwgMikpLAogICAgbGF5ZXJzLkNvbnYyRCgxMjgsICgzLCAzKSwgYWN0aXZhdGlvbj0ncmVsdScpLAogICAgbGF5ZXJzLk1heFBvb2xpbmcyRCgoMiwgMikpLAogICAgbGF5ZXJzLkNvbnYyRCgxMjgsICgzLCAzKSwgYWN0aXZhdGlvbj0ncmVsdScpLAogICAgbGF5ZXJzLkZsYXR0ZW4oKSwKICAgIGxheWVycy5EZW5zZSg1MTIsIGFjdGl2YXRpb249J3JlbHUnKSwKICAgIGxheWVycy5EZW5zZSgxMCwgYWN0aXZhdGlvbj0nc29mdG1heCcpCl0pCgptb2RlbC5jb21waWxlKG9wdGltaXplcj0nYWRhbScsIGxvc3M9J3NwYXJzZV9jYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLCBtZXRyaWNzPVsnYWNjdXJhY3knXSkKCiMgVHJhaW4gdGhlIG1vZGVsCmhpc3RvcnkgPSBtb2RlbC5maXQodHJhaW5faW1hZ2VzLCB0cmFpbl9sYWJlbHMsIGVwb2Nocz0yMCwgdmFsaWRhdGlvbl9kYXRhPSh0ZXN0X2ltYWdlcywgdGVzdF9sYWJlbHMpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras import layers, models
from tensorflow.keras.datasets import mnist

# Load data
(train_images, train_labels), (test_images, test_labels) = mnist.load_data()
train_images = train_images.reshape((60000, 28, 28, 1)).astype('float32') / 255
test_images = test_images.reshape((10000, 28, 28, 1)).astype('float32') / 255

# Build a complex model
model = models.Sequential([
    layers.Conv2D(64, (3, 3), activation='relu', input_shape=(28, 28, 1)),
    layers.MaxPooling2D((2, 2)),
    layers.Conv2D(128, (3, 3), activation='relu'),
    layers.MaxPooling2D((2, 2)),
    layers.Conv2D(128, (3, 3), activation='relu'),
    layers.Flatten(),
    layers.Dense(512, activation='relu'),
    layers.Dense(10, activation='softmax')
])

model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])

# Train the model
history = model.fit(train_images, train_labels, epochs=20, validation_data=(test_images, test_labels))</pre></div><div class='content'></div><h2>Example of Underfitting</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBCdWlsZCBhIHNpbXBsZSBtb2RlbAptb2RlbCA9IG1vZGVscy5TZXF1ZW50aWFsKFsKICAgIGxheWVycy5GbGF0dGVuKGlucHV0X3NoYXBlPSgyOCwgMjgsIDEpKSwKICAgIGxheWVycy5EZW5zZSg2NCwgYWN0aXZhdGlvbj0ncmVsdScpLAogICAgbGF5ZXJzLkRlbnNlKDEwLCBhY3RpdmF0aW9uPSdzb2Z0bWF4JykKXSkKCm1vZGVsLmNvbXBpbGUob3B0aW1pemVyPSdhZGFtJywgbG9zcz0nc3BhcnNlX2NhdGVnb3JpY2FsX2Nyb3NzZW50cm9weScsIG1ldHJpY3M9WydhY2N1cmFjeSddKQoKIyBUcmFpbiB0aGUgbW9kZWwKaGlzdG9yeSA9IG1vZGVsLmZpdCh0cmFpbl9pbWFnZXMsIHRyYWluX2xhYmVscywgZXBvY2hzPTUsIHZhbGlkYXRpb25fZGF0YT0odGVzdF9pbWFnZXMsIHRlc3RfbGFiZWxzKSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Build a simple model
model = models.Sequential([
    layers.Flatten(input_shape=(28, 28, 1)),
    layers.Dense(64, activation='relu'),
    layers.Dense(10, activation='softmax')
])

model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])

# Train the model
history = model.fit(train_images, train_labels, epochs=5, validation_data=(test_images, test_labels))</pre></div><div class='content'></div><h2>Applying Regularization to Prevent Overfitting</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBCdWlsZCBhIG1vZGVsIHdpdGggTDIgcmVndWxhcml6YXRpb24KbW9kZWwgPSBtb2RlbHMuU2VxdWVudGlhbChbCiAgICBsYXllcnMuQ29udjJEKDY0LCAoMywgMyksIGFjdGl2YXRpb249J3JlbHUnLCBpbnB1dF9zaGFwZT0oMjgsIDI4LCAxKSwga2VybmVsX3JlZ3VsYXJpemVyPXRmLmtlcmFzLnJlZ3VsYXJpemVycy5sMigwLjAwMSkpLAogICAgbGF5ZXJzLk1heFBvb2xpbmcyRCgoMiwgMikpLAogICAgbGF5ZXJzLkNvbnYyRCgxMjgsICgzLCAzKSwgYWN0aXZhdGlvbj0ncmVsdScsIGtlcm5lbF9yZWd1bGFyaXplcj10Zi5rZXJhcy5yZWd1bGFyaXplcnMubDIoMC4wMDEpKSwKICAgIGxheWVycy5NYXhQb29saW5nMkQoKDIsIDIpKSwKICAgIGxheWVycy5Db252MkQoMTI4LCAoMywgMyksIGFjdGl2YXRpb249J3JlbHUnLCBrZXJuZWxfcmVndWxhcml6ZXI9dGYua2VyYXMucmVndWxhcml6ZXJzLmwyKDAuMDAxKSksCiAgICBsYXllcnMuRmxhdHRlbigpLAogICAgbGF5ZXJzLkRlbnNlKDUxMiwgYWN0aXZhdGlvbj0ncmVsdScsIGtlcm5lbF9yZWd1bGFyaXplcj10Zi5rZXJhcy5yZWd1bGFyaXplcnMubDIoMC4wMDEpKSwKICAgIGxheWVycy5EZW5zZSgxMCwgYWN0aXZhdGlvbj0nc29mdG1heCcpCl0pCgptb2RlbC5jb21waWxlKG9wdGltaXplcj0nYWRhbScsIGxvc3M9J3NwYXJzZV9jYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLCBtZXRyaWNzPVsnYWNjdXJhY3knXSkKCiMgVHJhaW4gdGhlIG1vZGVsCmhpc3RvcnkgPSBtb2RlbC5maXQodHJhaW5faW1hZ2VzLCB0cmFpbl9sYWJlbHMsIGVwb2Nocz0yMCwgdmFsaWRhdGlvbl9kYXRhPSh0ZXN0X2ltYWdlcywgdGVzdF9sYWJlbHMpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Build a model with L2 regularization
model = models.Sequential([
    layers.Conv2D(64, (3, 3), activation='relu', input_shape=(28, 28, 1), kernel_regularizer=tf.keras.regularizers.l2(0.001)),
    layers.MaxPooling2D((2, 2)),
    layers.Conv2D(128, (3, 3), activation='relu', kernel_regularizer=tf.keras.regularizers.l2(0.001)),
    layers.MaxPooling2D((2, 2)),
    layers.Conv2D(128, (3, 3), activation='relu', kernel_regularizer=tf.keras.regularizers.l2(0.001)),
    layers.Flatten(),
    layers.Dense(512, activation='relu', kernel_regularizer=tf.keras.regularizers.l2(0.001)),
    layers.Dense(10, activation='softmax')
])

model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])

# Train the model
history = model.fit(train_images, train_labels, epochs=20, validation_data=(test_images, test_labels))</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Understanding and addressing overfitting and underfitting are essential for building effective machine learning models. By using techniques such as regularization, dropout, and early stopping, you can improve your model's generalization capabilities. Conversely, increasing model complexity and training duration can help mitigate underfitting. With these strategies, you can create more robust models using TensorFlow.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='evaluating-a-model'>&#x25C4;Evaluating a Model</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Overfitting and Underfitting in TensorFlow</a>
	</div>
	<div class='col-4 text-end'>
					<a href='saving-and-loading-models'>Saving and Loading Models &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
