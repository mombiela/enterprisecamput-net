<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Testing GraphQL APIs</title>

    <link rel="alternate" href="https://campusempresa.com/graphql/testing-graphql-apis" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/graphql/testing-graphql-apis" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/graphql/testing-graphql-apis" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/graphql/testing-graphql-apis" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/graphql/testing-graphql-apis" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='graphql-subscriptions'>&#x25C4;GraphQL Subscriptions</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Testing GraphQL APIs</a>
	</div>
	<div class='col-4 text-end'>
					<a href='building-fullstack-application'>Building a Full-stack Application &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Testing is a crucial part of developing robust and reliable GraphQL APIs. This section will guide you through the process of testing GraphQL APIs, from basic concepts to advanced techniques.</p>
</div><h1>Introduction to Testing GraphQL APIs</h1>
<div class='content'><p>Testing ensures that your GraphQL API behaves as expected and helps catch bugs early in the development process. There are several types of tests you can perform on a GraphQL API:</p>
<ul>
<li><strong>Unit Tests</strong>: Test individual resolvers and other small units of code.</li>
<li><strong>Integration Tests</strong>: Test how different parts of your application work together.</li>
<li><strong>End-to-End (E2E) Tests</strong>: Test the entire application flow from the client to the server and back.</li>
</ul>
</div><h1>Tools for Testing GraphQL APIs</h1>
<div class='content'><p>Several tools can help you test GraphQL APIs effectively:</p>
<ul>
<li><strong>Jest</strong>: A JavaScript testing framework that works well with GraphQL.</li>
<li><strong>Apollo Server Testing Utilities</strong>: Tools provided by Apollo Server to facilitate testing.</li>
<li><strong>GraphQL Playground</strong>: An interactive, in-browser GraphQL IDE that can be used for manual testing.</li>
</ul>
</div><h1>Writing Unit Tests for GraphQL Resolvers</h1>
<div class='content'><p>Unit tests focus on individual resolvers to ensure they return the expected results. Here’s how you can write unit tests using Jest.</p>
</div><h2>Example: Testing a Resolver with Jest</h2>
<div class='content'><p>Assume you have the following resolver:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgcmVzb2x2ZXJzID0gewogIFF1ZXJ5OiB7CiAgICB1c2VyOiAocGFyZW50LCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7CiAgICAgIHJldHVybiBjb250ZXh0LmRhdGFTb3VyY2VzLnVzZXJBUEkuZ2V0VXNlckJ5SWQoYXJncy5pZCk7CiAgICB9LAogIH0sCn07"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const resolvers = {
  Query: {
    user: (parent, args, context, info) =&gt; {
      return context.dataSources.userAPI.getUserById(args.id);
    },
  },
};</pre></div><div class='content'><p>You can write a unit test for this resolver as follows:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgeyBBcG9sbG9TZXJ2ZXIgfSA9IHJlcXVpcmUoJ2Fwb2xsby1zZXJ2ZXInKTsKY29uc3QgeyBjcmVhdGVUZXN0Q2xpZW50IH0gPSByZXF1aXJlKCdhcG9sbG8tc2VydmVyLXRlc3RpbmcnKTsKY29uc3QgZ3FsID0gcmVxdWlyZSgnZ3JhcGhxbC10YWcnKTsKCi8vIE1vY2sgZGF0YSBzb3VyY2UKY29uc3QgbW9ja1VzZXJBUEkgPSB7CiAgZ2V0VXNlckJ5SWQ6IGplc3QuZm4oKSwKfTsKCi8vIENyZWF0ZSBhIHRlc3Qgc2VydmVyCmNvbnN0IHNlcnZlciA9IG5ldyBBcG9sbG9TZXJ2ZXIoewogIHR5cGVEZWZzLAogIHJlc29sdmVycywKICBkYXRhU291cmNlczogKCkgPT4gKHsKICAgIHVzZXJBUEk6IG1vY2tVc2VyQVBJLAogIH0pLAp9KTsKCmNvbnN0IHsgcXVlcnkgfSA9IGNyZWF0ZVRlc3RDbGllbnQoc2VydmVyKTsKCmRlc2NyaWJlKCdRdWVyeS51c2VyJywgKCkgPT4gewogIGl0KCdmZXRjaGVzIGEgdXNlciBieSBJRCcsIGFzeW5jICgpID0+IHsKICAgIC8vIEFycmFuZ2UKICAgIGNvbnN0IHVzZXIgPSB7IGlkOiAnMScsIG5hbWU6ICdKb2huIERvZScgfTsKICAgIG1vY2tVc2VyQVBJLmdldFVzZXJCeUlkLm1vY2tSZXNvbHZlZFZhbHVlKHVzZXIpOwoKICAgIC8vIEFjdAogICAgY29uc3QgcmVzID0gYXdhaXQgcXVlcnkoewogICAgICBxdWVyeTogZ3FsYAogICAgICAgIHF1ZXJ5IGdldFVzZXIoJGlkOiBJRCEpIHsKICAgICAgICAgIHVzZXIoaWQ6ICRpZCkgewogICAgICAgICAgICBpZAogICAgICAgICAgICBuYW1lCiAgICAgICAgICB9CiAgICAgICAgfQogICAgICBgLAogICAgICB2YXJpYWJsZXM6IHsgaWQ6ICcxJyB9LAogICAgfSk7CgogICAgLy8gQXNzZXJ0CiAgICBleHBlY3QocmVzLmRhdGEudXNlcikudG9FcXVhbCh1c2VyKTsKICB9KTsKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const { ApolloServer } = require('apollo-server');
const { createTestClient } = require('apollo-server-testing');
const gql = require('graphql-tag');

// Mock data source
const mockUserAPI = {
  getUserById: jest.fn(),
};

// Create a test server
const server = new ApolloServer({
  typeDefs,
  resolvers,
  dataSources: () =&gt; ({
    userAPI: mockUserAPI,
  }),
});

const { query } = createTestClient(server);

describe('Query.user', () =&gt; {
  it('fetches a user by ID', async () =&gt; {
    // Arrange
    const user = { id: '1', name: 'John Doe' };
    mockUserAPI.getUserById.mockResolvedValue(user);

    // Act
    const res = await query({
      query: gql`
        query getUser($id: ID!) {
          user(id: $id) {
            id
            name
          }
        }
      `,
      variables: { id: '1' },
    });

    // Assert
    expect(res.data.user).toEqual(user);
  });
});</pre></div><div class='content'></div><h1>Writing Integration Tests</h1>
<div class='content'><p>Integration tests ensure that different parts of your application work together correctly. These tests typically involve setting up a test server and making requests to it.</p>
</div><h2>Example: Integration Test with Apollo Server</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgeyBBcG9sbG9TZXJ2ZXIgfSA9IHJlcXVpcmUoJ2Fwb2xsby1zZXJ2ZXInKTsKY29uc3QgeyBjcmVhdGVUZXN0Q2xpZW50IH0gPSByZXF1aXJlKCdhcG9sbG8tc2VydmVyLXRlc3RpbmcnKTsKY29uc3QgZ3FsID0gcmVxdWlyZSgnZ3JhcGhxbC10YWcnKTsKCi8vIERlZmluZSB5b3VyIHNjaGVtYSBhbmQgcmVzb2x2ZXJzCmNvbnN0IHR5cGVEZWZzID0gZ3FsYAogIHR5cGUgVXNlciB7CiAgICBpZDogSUQhCiAgICBuYW1lOiBTdHJpbmchCiAgfQoKICB0eXBlIFF1ZXJ5IHsKICAgIHVzZXIoaWQ6IElEISk6IFVzZXIKICB9CmA7Cgpjb25zdCByZXNvbHZlcnMgPSB7CiAgUXVlcnk6IHsKICAgIHVzZXI6IChwYXJlbnQsIGFyZ3MsIGNvbnRleHQsIGluZm8pID0+IHsKICAgICAgcmV0dXJuIHsgaWQ6IGFyZ3MuaWQsIG5hbWU6ICdKb2huIERvZScgfTsKICAgIH0sCiAgfSwKfTsKCi8vIENyZWF0ZSBhIHRlc3Qgc2VydmVyCmNvbnN0IHNlcnZlciA9IG5ldyBBcG9sbG9TZXJ2ZXIoewogIHR5cGVEZWZzLAogIHJlc29sdmVycywKfSk7Cgpjb25zdCB7IHF1ZXJ5IH0gPSBjcmVhdGVUZXN0Q2xpZW50KHNlcnZlcik7CgpkZXNjcmliZSgnSW50ZWdyYXRpb24gVGVzdCcsICgpID0+IHsKICBpdCgnZmV0Y2hlcyBhIHVzZXIgYnkgSUQnLCBhc3luYyAoKSA9PiB7CiAgICBjb25zdCByZXMgPSBhd2FpdCBxdWVyeSh7CiAgICAgIHF1ZXJ5OiBncWxgCiAgICAgICAgcXVlcnkgZ2V0VXNlcigkaWQ6IElEISkgewogICAgICAgICAgdXNlcihpZDogJGlkKSB7CiAgICAgICAgICAgIGlkCiAgICAgICAgICAgIG5hbWUKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIGAsCiAgICAgIHZhcmlhYmxlczogeyBpZDogJzEnIH0sCiAgICB9KTsKCiAgICBleHBlY3QocmVzLmRhdGEudXNlcikudG9FcXVhbCh7IGlkOiAnMScsIG5hbWU6ICdKb2huIERvZScgfSk7CiAgfSk7Cn0pOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const { ApolloServer } = require('apollo-server');
const { createTestClient } = require('apollo-server-testing');
const gql = require('graphql-tag');

// Define your schema and resolvers
const typeDefs = gql`
  type User {
    id: ID!
    name: String!
  }

  type Query {
    user(id: ID!): User
  }
`;

const resolvers = {
  Query: {
    user: (parent, args, context, info) =&gt; {
      return { id: args.id, name: 'John Doe' };
    },
  },
};

// Create a test server
const server = new ApolloServer({
  typeDefs,
  resolvers,
});

const { query } = createTestClient(server);

describe('Integration Test', () =&gt; {
  it('fetches a user by ID', async () =&gt; {
    const res = await query({
      query: gql`
        query getUser($id: ID!) {
          user(id: $id) {
            id
            name
          }
        }
      `,
      variables: { id: '1' },
    });

    expect(res.data.user).toEqual({ id: '1', name: 'John Doe' });
  });
});</pre></div><div class='content'></div><h1>Writing End-to-End (E2E) Tests</h1>
<div class='content'><p>End-to-end tests simulate real user interactions with your application. These tests are typically more complex and involve setting up the entire application stack.</p>
</div><h2>Example: E2E Test with Cypress</h2>
<div class='content'><p>Cypress is a popular tool for E2E testing. Here’s a basic example of how you might use Cypress to test a GraphQL API.</p>
<ol>
<li>
<p><strong>Install Cypress</strong>:</p>
<pre><code class="language-bash">npm install cypress --save-dev
</code></pre>
</li>
<li>
<p><strong>Write a Cypress Test</strong>:</p>
<pre><code class="language-javascript">// cypress/integration/graphql_spec.js
describe('GraphQL API', () =&gt; {
  it('fetches a user by ID', () =&gt; {
    cy.request({
      method: 'POST',
      url: 'http://localhost:4000/graphql',
      body: {
        query: `
          query getUser($id: ID!) {
            user(id: $id) {
              id
              name
            }
          }
        `,
        variables: { id: '1' },
      },
    }).then((response) =&gt; {
      expect(response.body.data.user).to.have.property('id', '1');
      expect(response.body.data.user).to.have.property('name', 'John Doe');
    });
  });
});
</code></pre>
</li>
</ol>
</div><h1>Conclusion</h1>
<div class='content'><p>Testing GraphQL APIs is essential for ensuring the reliability and correctness of your application. By writing unit tests, integration tests, and end-to-end tests, you can catch bugs early and ensure that your API behaves as expected. Using tools like Jest, Apollo Server Testing Utilities, and Cypress can make the testing process more efficient and effective.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='graphql-subscriptions'>&#x25C4;GraphQL Subscriptions</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Testing GraphQL APIs</a>
	</div>
	<div class='col-4 text-end'>
					<a href='building-fullstack-application'>Building a Full-stack Application &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
