<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GraphQL in Production</title>

    <link rel="alternate" href="https://campusempresa.com/graphql/graphql-in-production" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/graphql/graphql-in-production" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/graphql/graphql-in-production" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/graphql/graphql-in-production" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/graphql/graphql-in-production" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='microservices-with-graphql'>&#x25C4;Microservices with GraphQL</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">GraphQL in Production</a>
	</div>
	<div class='col-4 text-end'>
					<a href='case-studies'>Case Studies &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>GraphQL is a powerful query language for APIs and a runtime for executing those queries by using a type system you define for your data. Moving from development to production with GraphQL involves several considerations to ensure performance, security, and maintainability.</p>
</div><h1>Key Considerations for GraphQL in Production</h1>
<div class='content'></div><h2>Performance Optimization</h2>
<div class='content'><ul>
<li><strong>Query Complexity Analysis</strong>: Prevent overly complex queries that can degrade performance.</li>
<li><strong>Batching and Caching</strong>: Use tools like DataLoader to batch and cache database requests.</li>
<li><strong>Persisted Queries</strong>: Store pre-defined queries on the server to reduce parsing and validation overhead.</li>
</ul>
</div><h2>Security</h2>
<div class='content'><ul>
<li><strong>Rate Limiting</strong>: Implement rate limiting to prevent abuse.</li>
<li><strong>Depth Limiting</strong>: Restrict the depth of queries to avoid excessively nested queries.</li>
<li><strong>Authorization and Authentication</strong>: Ensure proper authentication and authorization mechanisms are in place.</li>
</ul>
</div><h2>Monitoring and Logging</h2>
<div class='content'><ul>
<li><strong>Error Tracking</strong>: Use tools like Sentry to track and log errors.</li>
<li><strong>Performance Monitoring</strong>: Implement monitoring tools like Apollo Engine to track performance metrics.</li>
<li><strong>Logging</strong>: Maintain logs for all GraphQL operations to audit and debug issues.</li>
</ul>
</div><h2>Schema Management</h2>
<div class='content'><ul>
<li><strong>Schema Versioning</strong>: Manage different versions of your schema to ensure backward compatibility.</li>
<li><strong>Schema Documentation</strong>: Use tools like GraphiQL or Apollo Studio to document your schema.</li>
<li><strong>Deprecation</strong>: Mark fields as deprecated before removing them to give clients time to migrate.</li>
</ul>
</div><h1>Example: Implementing DataLoader for Batching and Caching</h1>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgRGF0YUxvYWRlciA9IHJlcXVpcmUoJ2RhdGFsb2FkZXInKTsKY29uc3QgdXNlckxvYWRlciA9IG5ldyBEYXRhTG9hZGVyKGtleXMgPT4gbXlCYXRjaEdldFVzZXJzKGtleXMpKTsKCi8vIFJlc29sdmVyCmNvbnN0IHJlc29sdmVycyA9IHsKICBRdWVyeTogewogICAgdXNlcjogKHBhcmVudCwgYXJncywgY29udGV4dCwgaW5mbykgPT4gewogICAgICByZXR1cm4gdXNlckxvYWRlci5sb2FkKGFyZ3MuaWQpOwogICAgfSwKICB9LAp9OwoKLy8gQmF0Y2ggZnVuY3Rpb24KYXN5bmMgZnVuY3Rpb24gbXlCYXRjaEdldFVzZXJzKGtleXMpIHsKICBjb25zdCB1c2VycyA9IGF3YWl0IGdldFVzZXJzRnJvbURhdGFiYXNlKGtleXMpOwogIHJldHVybiBrZXlzLm1hcChrZXkgPT4gdXNlcnMuZmluZCh1c2VyID0+IHVzZXIuaWQgPT09IGtleSkpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const DataLoader = require('dataloader');
const userLoader = new DataLoader(keys =&gt; myBatchGetUsers(keys));

// Resolver
const resolvers = {
  Query: {
    user: (parent, args, context, info) =&gt; {
      return userLoader.load(args.id);
    },
  },
};

// Batch function
async function myBatchGetUsers(keys) {
  const users = await getUsersFromDatabase(keys);
  return keys.map(key =&gt; users.find(user =&gt; user.id === key));
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>DataLoader</code> batches and caches database requests.</li>
<li><code>myBatchGetUsers</code> function fetches users in a single database call.</li>
<li><code>userLoader.load(args.id)</code> ensures that multiple requests for the same user are batched together.</li>
</ul>
</li>
</ul>
</div><h1>Example: Rate Limiting with Express Middleware</h1>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgcmF0ZUxpbWl0ID0gcmVxdWlyZSgnZXhwcmVzcy1yYXRlLWxpbWl0Jyk7Cgpjb25zdCBsaW1pdGVyID0gcmF0ZUxpbWl0KHsKICB3aW5kb3dNczogMTUgKiA2MCAqIDEwMDAsIC8vIDE1IG1pbnV0ZXMKICBtYXg6IDEwMCwgLy8gbGltaXQgZWFjaCBJUCB0byAxMDAgcmVxdWVzdHMgcGVyIHdpbmRvd01zCn0pOwoKYXBwLnVzZSgnL2dyYXBocWwnLCBsaW1pdGVyKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const rateLimit = require('express-rate-limit');

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutes
  max: 100, // limit each IP to 100 requests per windowMs
});

app.use('/graphql', limiter);</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>express-rate-limit</code> middleware limits the number of requests per IP.</li>
<li>This helps prevent abuse and ensures fair usage of the API.</li>
</ul>
</li>
</ul>
</div><h1>Example: Depth Limiting</h1>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgeyBjcmVhdGVDb21wbGV4aXR5TGltaXRSdWxlIH0gPSByZXF1aXJlKCdncmFwaHFsLXZhbGlkYXRpb24tY29tcGxleGl0eScpOwoKY29uc3QgY29tcGxleGl0eUxpbWl0UnVsZSA9IGNyZWF0ZUNvbXBsZXhpdHlMaW1pdFJ1bGUoMTAwMCwgewogIG9uQ29zdDogKGNvc3QpID0+IGNvbnNvbGUubG9nKCdxdWVyeSBjb3N0OicsIGNvc3QpLAp9KTsKCmNvbnN0IHNlcnZlciA9IG5ldyBBcG9sbG9TZXJ2ZXIoewogIHNjaGVtYSwKICB2YWxpZGF0aW9uUnVsZXM6IFtjb21wbGV4aXR5TGltaXRSdWxlXSwKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const { createComplexityLimitRule } = require('graphql-validation-complexity');

const complexityLimitRule = createComplexityLimitRule(1000, {
  onCost: (cost) =&gt; console.log('query cost:', cost),
});

const server = new ApolloServer({
  schema,
  validationRules: [complexityLimitRule],
});</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>createComplexityLimitRule</code> sets a complexity limit for queries.</li>
<li>This prevents clients from executing overly complex queries that could degrade performance.</li>
</ul>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Deploying GraphQL in production requires careful consideration of performance, security, monitoring, and schema management. By implementing best practices such as query complexity analysis, rate limiting, and using tools like DataLoader, you can ensure that your GraphQL API is robust, secure, and efficient. Monitoring and logging are also crucial for maintaining the health of your API and quickly resolving any issues that arise. With these strategies in place, you can confidently move your GraphQL API from development to production.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='microservices-with-graphql'>&#x25C4;Microservices with GraphQL</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">GraphQL in Production</a>
	</div>
	<div class='col-4 text-end'>
					<a href='case-studies'>Case Studies &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
