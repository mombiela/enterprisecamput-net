<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Persistence Configuration</title>

    <link rel="alternate" href="https://campusempresa.com/redis/persistence-configuration" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/redis/persistence-configuration" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/redis/persistence-configuration" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/redis/persistence-configuration" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/redis/persistence-configuration" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='append-only-files-aof'>&#x25C4;Append-Only Files (AOF)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Persistence Configuration</a>
	</div>
	<div class='col-4 text-end'>
					<a href='backup-and-restore'>Backup and Restore &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Persistence in Redis</h1>
<div class='content'><p>Redis is an in-memory data structure store, which means it primarily stores data in RAM. However, to ensure data durability and recovery in case of failures, Redis provides various persistence mechanisms. Understanding and configuring these mechanisms is crucial for maintaining data integrity and availability.</p>
</div><h1>Types of Persistence in Redis</h1>
<div class='content'><p>Redis offers two main types of persistence:</p>
<ul>
<li><strong>RDB (Redis Database) Snapshots</strong></li>
<li><strong>AOF (Append-Only File)</strong></li>
</ul>
</div><h2>RDB Snapshots</h2>
<div class='content'><p>RDB snapshots create point-in-time snapshots of your dataset at specified intervals.</p>
<h4>Key Concepts:</h4>
<ul>
<li><strong>Snapshot Frequency</strong>: Configurable to determine how often snapshots are taken.</li>
<li><strong>Storage</strong>: Snapshots are stored as binary files on disk.</li>
<li><strong>Performance</strong>: Minimal impact on Redis performance during snapshot creation.</li>
</ul>
<h4>Configuration:</h4>
<p>To configure RDB snapshots, you need to modify the <code>redis.conf</code> file.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTYXZlIHRoZSBEQiBldmVyeSA5MDAgc2Vjb25kcyAoMTUgbWludXRlcykgaWYgYXQgbGVhc3QgMSBrZXkgY2hhbmdlZApzYXZlIDkwMCAxCgojIFNhdmUgdGhlIERCIGV2ZXJ5IDMwMCBzZWNvbmRzICg1IG1pbnV0ZXMpIGlmIGF0IGxlYXN0IDEwIGtleXMgY2hhbmdlZApzYXZlIDMwMCAxMAoKIyBTYXZlIHRoZSBEQiBldmVyeSA2MCBzZWNvbmRzIGlmIGF0IGxlYXN0IDEwMDAwIGtleXMgY2hhbmdlZApzYXZlIDYwIDEwMDAwCgojIExvY2F0aW9uIG9mIHRoZSBSREIgZmlsZQpkYmZpbGVuYW1lIGR1bXAucmRiCgojIERpcmVjdG9yeSB3aGVyZSB0byBzYXZlIHRoZSBSREIgZmlsZQpkaXIgL3Zhci9saWIvcmVkaXM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Save the DB every 900 seconds (15 minutes) if at least 1 key changed
save 900 1

# Save the DB every 300 seconds (5 minutes) if at least 10 keys changed
save 300 10

# Save the DB every 60 seconds if at least 10000 keys changed
save 60 10000

# Location of the RDB file
dbfilename dump.rdb

# Directory where to save the RDB file
dir /var/lib/redis</pre></div><div class='content'></div><h2>AOF (Append-Only File)</h2>
<div class='content'><p>AOF logs every write operation received by the server, which can be replayed to reconstruct the dataset.</p>
<h4>Key Concepts:</h4>
<ul>
<li><strong>Write Durability</strong>: Ensures that every change is logged.</li>
<li><strong>File Size</strong>: AOF files can grow large over time.</li>
<li><strong>Rewrite Mechanism</strong>: Periodically rewrites the AOF file to reduce its size.</li>
</ul>
<h4>Configuration:</h4>
<p>To enable and configure AOF, you need to modify the <code>redis.conf</code> file.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFbmFibGUgQU9GCmFwcGVuZG9ubHkgeWVzCgojIEFPRiBmaWxlIG5hbWUKYXBwZW5kZmlsZW5hbWUgImFwcGVuZG9ubHkuYW9mIgoKIyBBT0YgZnN5bmMgcG9saWN5IChhbHdheXMsIGV2ZXJ5c2VjLCBubykKIyBhbHdheXM6IGZzeW5jIGFmdGVyIGV2ZXJ5IHdyaXRlIChzbG93LCBzYWZlKQojIGV2ZXJ5c2VjOiBmc3luYyBldmVyeSBzZWNvbmQgKGJhbGFuY2VkKQojIG5vOiBsZXQgdGhlIE9TIG1hbmFnZSAoZmFzdCwgbGVzcyBzYWZlKQphcHBlbmRmc3luYyBldmVyeXNlYwoKIyBBdXRvbWF0aWMgQU9GIHJld3JpdGUgY29uZmlndXJhdGlvbgphdXRvLWFvZi1yZXdyaXRlLXBlcmNlbnRhZ2UgMTAwCmF1dG8tYW9mLXJld3JpdGUtbWluLXNpemUgNjRtYg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Enable AOF
appendonly yes

# AOF file name
appendfilename &quot;appendonly.aof&quot;

# AOF fsync policy (always, everysec, no)
# always: fsync after every write (slow, safe)
# everysec: fsync every second (balanced)
# no: let the OS manage (fast, less safe)
appendfsync everysec

# Automatic AOF rewrite configuration
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb</pre></div><div class='content'></div><h1>Choosing Between RDB and AOF</h1>
<div class='content'><p>Each persistence method has its pros and cons. The choice depends on your specific use case.</p>
<p>| Feature               | RDB Snapshots                  | AOF                              |
|-----------------------|--------------------------------|----------------------------------|
| Durability            | Less durable                   | More durable                     |
| Performance Impact    | Lower during normal operation  | Higher due to logging every write|
| Recovery Speed        | Faster                         | Slower                           |
| File Size             | Smaller                        | Larger                           |
| Use Case              | Suitable for backups           | Suitable for high durability needs|</p>
</div><h1>Best Practices for Persistence Configuration</h1>
<div class='content'><ul>
<li><strong>Combine RDB and AOF</strong>: Use both to balance between performance and durability.</li>
<li><strong>Regular Backups</strong>: Schedule regular backups of your RDB files.</li>
<li><strong>Monitor Disk Space</strong>: Ensure sufficient disk space for AOF files.</li>
<li><strong>Tune fsync Policy</strong>: Adjust the <code>appendfsync</code> policy based on your performance and durability requirements.</li>
</ul>
</div><h1>Example Configuration</h1>
<div class='content'><p>Here is an example of a combined RDB and AOF configuration in <code>redis.conf</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSREIgY29uZmlndXJhdGlvbgpzYXZlIDkwMCAxCnNhdmUgMzAwIDEwCnNhdmUgNjAgMTAwMDAKZGJmaWxlbmFtZSBkdW1wLnJkYgpkaXIgL3Zhci9saWIvcmVkaXMKCiMgQU9GIGNvbmZpZ3VyYXRpb24KYXBwZW5kb25seSB5ZXMKYXBwZW5kZmlsZW5hbWUgImFwcGVuZG9ubHkuYW9mIgphcHBlbmRmc3luYyBldmVyeXNlYwphdXRvLWFvZi1yZXdyaXRlLXBlcmNlbnRhZ2UgMTAwCmF1dG8tYW9mLXJld3JpdGUtbWluLXNpemUgNjRtYg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># RDB configuration
save 900 1
save 300 10
save 60 10000
dbfilename dump.rdb
dir /var/lib/redis

# AOF configuration
appendonly yes
appendfilename &quot;appendonly.aof&quot;
appendfsync everysec
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Understanding and configuring Redis persistence is essential for ensuring data durability and availability. By leveraging RDB snapshots and AOF, you can achieve a balance between performance and data safety. Regularly review and adjust your persistence settings to align with your application's requirements and workload patterns.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='append-only-files-aof'>&#x25C4;Append-Only Files (AOF)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Persistence Configuration</a>
	</div>
	<div class='col-4 text-end'>
					<a href='backup-and-restore'>Backup and Restore &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
