<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interfacing with Databases</title>

    <link rel="alternate" href="https://campusempresa.com/rexx/interfacing-with-databases" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/rexx/interfacing-with-databases" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/rexx/interfacing-with-databases" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/rexx/interfacing-with-databases" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/rexx/interfacing-with-databases" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='calling-external-programs'>&#x25C4;Calling External Programs</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Interfacing with Databases</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-rexx-with-other-languages'>Using REXX with Other Languages &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Interfacing with databases is a crucial skill for any programmer. This topic will guide you through the basics of connecting to and interacting with databases using REXX, progressing to more advanced techniques and best practices.</p>
</div><h1>Introduction to Databases</h1>
<div class='content'><p>Before diving into REXX-specific database interactions, let's briefly cover what databases are and why they are important.</p>
<ul>
<li><strong>Database</strong>: A structured collection of data that can be easily accessed, managed, and updated.</li>
<li><strong>DBMS (Database Management System)</strong>: Software that interacts with end-users, applications, and the database itself to capture and analyze data.</li>
</ul>
<p>Common DBMS examples include:</p>
<ul>
<li>MySQL</li>
<li>PostgreSQL</li>
<li>SQLite</li>
<li>IBM Db2</li>
</ul>
</div><h1>Setting Up the Environment</h1>
<div class='content'><p>To interface with a database using REXX, you need:</p>
<ol>
<li>A REXX interpreter.</li>
<li>A database to connect to.</li>
<li>Appropriate database drivers or APIs.</li>
</ol>
</div><h2>Example: Setting Up a MySQL Database</h2>
<div class='content'><ol>
<li><strong>Install MySQL</strong>: Follow the instructions on the MySQL website to download and install MySQL.</li>
<li><strong>Create a Database</strong>: Use the MySQL command line or a GUI tool like MySQL Workbench to create a database.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIERBVEFCQVNFIGV4YW1wbGVfZGI7ClVTRSBleGFtcGxlX2RiOwpDUkVBVEUgVEFCTEUgdXNlcnMgKAogICAgaWQgSU5UIEFVVE9fSU5DUkVNRU5UIFBSSU1BUlkgS0VZLAogICAgbmFtZSBWQVJDSEFSKDEwMCksCiAgICBlbWFpbCBWQVJDSEFSKDEwMCkKKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE DATABASE example_db;
USE example_db;
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100),
    email VARCHAR(100)
);</pre></div><div class='content'></div><h1>Connecting to a Database</h1>
<div class='content'><p>To connect to a database from REXX, you typically use an API or a library that provides the necessary functions.</p>
</div><h2>Example: Using ODBC with REXX</h2>
<div class='content'><p>ODBC (Open Database Connectivity) is a standard API for accessing database management systems.</p>
<ol>
<li><strong>Install ODBC Driver</strong>: Ensure you have the ODBC driver for your database installed.</li>
<li><strong>Configure ODBC Data Source</strong>: Set up a DSN (Data Source Name) for your database.</li>
</ol>
</div><h2>REXX Code Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogUkVYWCBzY3JpcHQgdG8gY29ubmVjdCB0byBhIE15U1FMIGRhdGFiYXNlIHVzaW5nIE9EQkMgKi8KZHNuID0gImV4YW1wbGVfZGIiCnVzZXIgPSAieW91cl91c2VybmFtZSIKcGFzc3dvcmQgPSAieW91cl9wYXNzd29yZCIKCmNhbGwgUnhGdW5jQWRkICdTUUxMb2FkRnVuY3MnLCAncmV4eHNxbCcsICdTUUxMb2FkRnVuY3MnCmNhbGwgU1FMTG9hZEZ1bmNzCgpjYWxsIFNRTENvbm5lY3QgZHNuLCB1c2VyLCBwYXNzd29yZAppZiBTUUxDT0RFIDw+IDAgdGhlbiBkbwogICAgc2F5ICJDb25uZWN0aW9uIGZhaWxlZDogIiBTUUxFUlJNU0cKICAgIGV4aXQKZW5kCgpzYXkgIkNvbm5lY3RlZCB0byB0aGUgZGF0YWJhc2Ugc3VjY2Vzc2Z1bGx5ISIKY2FsbCBTUUxEaXNjb25uZWN0"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* REXX script to connect to a MySQL database using ODBC */
dsn = &quot;example_db&quot;
user = &quot;your_username&quot;
password = &quot;your_password&quot;

call RxFuncAdd 'SQLLoadFuncs', 'rexxsql', 'SQLLoadFuncs'
call SQLLoadFuncs

call SQLConnect dsn, user, password
if SQLCODE &lt;&gt; 0 then do
    say &quot;Connection failed: &quot; SQLERRMSG
    exit
end

say &quot;Connected to the database successfully!&quot;
call SQLDisconnect</pre></div><div class='content'><ul>
<li><strong>RxFuncAdd</strong>: Registers an external function.</li>
<li><strong>SQLLoadFuncs</strong>: Loads the SQL functions.</li>
<li><strong>SQLConnect</strong>: Connects to the database using the DSN, username, and password.</li>
<li><strong>SQLDisconnect</strong>: Disconnects from the database.</li>
</ul>
</div><h1>Executing SQL Queries</h1>
<div class='content'><p>Once connected, you can execute SQL queries to interact with the database.</p>
</div><h2>Example: Inserting Data</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cXVlcnkgPSAiSU5TRVJUIElOVE8gdXNlcnMgKG5hbWUsIGVtYWlsKSBWQUxVRVMgKCdKb2huIERvZScsICdqb2huLmRvZUBleGFtcGxlLmNvbScpIgpjYWxsIFNRTEV4ZWNEaXJlY3QgcXVlcnkKaWYgU1FMQ09ERSA8PiAwIHRoZW4gZG8KICAgIHNheSAiSW5zZXJ0IGZhaWxlZDogIiBTUUxFUlJNU0cKICAgIGV4aXQKZW5kCgpzYXkgIkRhdGEgaW5zZXJ0ZWQgc3VjY2Vzc2Z1bGx5ISI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>query = &quot;INSERT INTO users (name, email) VALUES ('John Doe', 'john.doe@example.com')&quot;
call SQLExecDirect query
if SQLCODE &lt;&gt; 0 then do
    say &quot;Insert failed: &quot; SQLERRMSG
    exit
end

say &quot;Data inserted successfully!&quot;</pre></div><div class='content'></div><h2>Example: Retrieving Data</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cXVlcnkgPSAiU0VMRUNUICogRlJPTSB1c2VycyIKY2FsbCBTUUxFeGVjRGlyZWN0IHF1ZXJ5CmlmIFNRTENPREUgPD4gMCB0aGVuIGRvCiAgICBzYXkgIlF1ZXJ5IGZhaWxlZDogIiBTUUxFUlJNU0cKICAgIGV4aXQKZW5kCgpkbyB3aGlsZSBTUUxGZXRjaCgpID0gMAogICAgc2F5ICJJRDoiIFNRTERhdGEoMSkgIk5hbWU6IiBTUUxEYXRhKDIpICJFbWFpbDoiIFNRTERhdGEoMykKZW5k"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>query = &quot;SELECT * FROM users&quot;
call SQLExecDirect query
if SQLCODE &lt;&gt; 0 then do
    say &quot;Query failed: &quot; SQLERRMSG
    exit
end

do while SQLFetch() = 0
    say &quot;ID:&quot; SQLData(1) &quot;Name:&quot; SQLData(2) &quot;Email:&quot; SQLData(3)
end</pre></div><div class='content'><ul>
<li><strong>SQLExecDirect</strong>: Executes an SQL statement directly.</li>
<li><strong>SQLFetch</strong>: Fetches the next row of a query result.</li>
<li><strong>SQLData</strong>: Retrieves data from the current row.</li>
</ul>
</div><h1>Error Handling</h1>
<div class='content'><p>Proper error handling is essential for robust database interactions.</p>
</div><h2>Example: Error Handling in REXX</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cXVlcnkgPSAiU0VMRUNUICogRlJPTSBub25fZXhpc3RpbmdfdGFibGUiCmNhbGwgU1FMRXhlY0RpcmVjdCBxdWVyeQppZiBTUUxDT0RFIDw+IDAgdGhlbiBkbwogICAgc2F5ICJFcnJvcjogIiBTUUxFUlJNU0cKICAgIGV4aXQKZW5k"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>query = &quot;SELECT * FROM non_existing_table&quot;
call SQLExecDirect query
if SQLCODE &lt;&gt; 0 then do
    say &quot;Error: &quot; SQLERRMSG
    exit
end</pre></div><div class='content'><ul>
<li><strong>SQLCODE</strong>: Contains the return code of the last SQL operation.</li>
<li><strong>SQLERRMSG</strong>: Contains the error message if an error occurs.</li>
</ul>
</div><h1>Advanced Techniques</h1>
<div class='content'></div><h2>Using Prepared Statements</h2>
<div class='content'><p>Prepared statements can improve performance and security.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cXVlcnkgPSAiSU5TRVJUIElOVE8gdXNlcnMgKG5hbWUsIGVtYWlsKSBWQUxVRVMgKD8sID8pIgpjYWxsIFNRTFByZXBhcmUgcXVlcnkKY2FsbCBTUUxCaW5kUGFyYW1ldGVyIDEsICdKb2huIERvZScKY2FsbCBTUUxCaW5kUGFyYW1ldGVyIDIsICdqb2huLmRvZUBleGFtcGxlLmNvbScKY2FsbCBTUUxFeGVjdXRlCmlmIFNRTENPREUgPD4gMCB0aGVuIGRvCiAgICBzYXkgIkluc2VydCBmYWlsZWQ6ICIgU1FMRVJSTVNHCiAgICBleGl0CmVuZAoKc2F5ICJEYXRhIGluc2VydGVkIHN1Y2Nlc3NmdWxseSB3aXRoIHByZXBhcmVkIHN0YXRlbWVudCEi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>query = &quot;INSERT INTO users (name, email) VALUES (?, ?)&quot;
call SQLPrepare query
call SQLBindParameter 1, 'John Doe'
call SQLBindParameter 2, 'john.doe@example.com'
call SQLExecute
if SQLCODE &lt;&gt; 0 then do
    say &quot;Insert failed: &quot; SQLERRMSG
    exit
end

say &quot;Data inserted successfully with prepared statement!&quot;</pre></div><div class='content'></div><h2>Transactions</h2>
<div class='content'><p>Transactions ensure data integrity by grouping multiple operations into a single unit of work.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2FsbCBTUUxCZWdpblRyYW5zYWN0aW9uCnF1ZXJ5MSA9ICJVUERBVEUgdXNlcnMgU0VUIGVtYWlsID0gJ25ldy5lbWFpbEBleGFtcGxlLmNvbScgV0hFUkUgaWQgPSAxIgpxdWVyeTIgPSAiREVMRVRFIEZST00gdXNlcnMgV0hFUkUgaWQgPSAyIgoKY2FsbCBTUUxFeGVjRGlyZWN0IHF1ZXJ5MQppZiBTUUxDT0RFIDw+IDAgdGhlbiBkbwogICAgY2FsbCBTUUxSb2xsYmFjawogICAgc2F5ICJUcmFuc2FjdGlvbiBmYWlsZWQ6ICIgU1FMRVJSTVNHCiAgICBleGl0CmVuZAoKY2FsbCBTUUxFeGVjRGlyZWN0IHF1ZXJ5MgppZiBTUUxDT0RFIDw+IDAgdGhlbiBkbwogICAgY2FsbCBTUUxSb2xsYmFjawogICAgc2F5ICJUcmFuc2FjdGlvbiBmYWlsZWQ6ICIgU1FMRVJSTVNHCiAgICBleGl0CmVuZAoKY2FsbCBTUUxDb21taXQKc2F5ICJUcmFuc2FjdGlvbiBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5ISI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>call SQLBeginTransaction
query1 = &quot;UPDATE users SET email = 'new.email@example.com' WHERE id = 1&quot;
query2 = &quot;DELETE FROM users WHERE id = 2&quot;

call SQLExecDirect query1
if SQLCODE &lt;&gt; 0 then do
    call SQLRollback
    say &quot;Transaction failed: &quot; SQLERRMSG
    exit
end

call SQLExecDirect query2
if SQLCODE &lt;&gt; 0 then do
    call SQLRollback
    say &quot;Transaction failed: &quot; SQLERRMSG
    exit
end

call SQLCommit
say &quot;Transaction completed successfully!&quot;</pre></div><div class='content'><ul>
<li><strong>SQLBeginTransaction</strong>: Begins a new transaction.</li>
<li><strong>SQLCommit</strong>: Commits the current transaction.</li>
<li><strong>SQLRollback</strong>: Rolls back the current transaction.</li>
</ul>
</div><h1>Summary</h1>
<div class='content'><p>Interfacing with databases in REXX involves:</p>
<ul>
<li>Setting up the environment.</li>
<li>Connecting to the database.</li>
<li>Executing SQL queries.</li>
<li>Handling errors.</li>
<li>Using advanced techniques like prepared statements and transactions.</li>
</ul>
<p>By mastering these skills, you can efficiently manage and manipulate data within your REXX programs, making your applications more powerful and versatile.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='calling-external-programs'>&#x25C4;Calling External Programs</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Interfacing with Databases</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-rexx-with-other-languages'>Using REXX with Other Languages &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
