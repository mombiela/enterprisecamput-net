<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project 4: Image Creation with GAN</title>

    <link rel="alternate" href="https://campusempresa.com/deep_learning/proyecto-creacion-imagenes-gan" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/deep_learning/proyecto-creacion-imagenes-gan" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/deep_learning/proyecto-creacion-imagenes-gan" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/deep_learning/proyecto-creacion-imagenes-gan" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/deep_learning/proyecto-creacion-imagenes-gan" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introduction to Generative Adversarial Networks (GAN)</h1>
<div class='content'><p>Generative Adversarial Networks (GAN) are a type of deep learning model that can generate new and realistic data from a training dataset. They were introduced by Ian Goodfellow in 2014 and have revolutionized the generation of images, videos, and other types of data.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Generator</strong>: A neural network that generates fake data from random noise.</li>
<li><strong>Discriminator</strong>: A neural network that tries to distinguish between real and fake data.</li>
<li><strong>Minimax Game</strong>: The generator and discriminator compete against each other in a zero-sum game.</li>
<li><strong>Loss Function</strong>: Measures how well the generator and discriminator are performing.</li>
</ul>
</div><h1>GAN Architecture</h1>
<div class='content'><p>A GAN consists of two main components:</p>
<ol>
<li>
<p><strong>Generator (G)</strong>:</p>
<ul>
<li>Takes a noise vector as input.</li>
<li>Produces a fake image that tries to resemble the real images from the dataset.</li>
</ul>
</li>
<li>
<p><strong>Discriminator (D)</strong>:</p>
<ul>
<li>Takes an image as input.</li>
<li>Classifies the image as real (from the dataset) or fake (generated by the generator).</li>
</ul>
</li>
</ol>
</div><h2>Code Example</h2>
<div class='content'><p>Below is a basic example of how to implement a GAN using TensorFlow and Keras.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzIGltcG9ydCBsYXllcnMKCiMgRGVmaW5lIHRoZSBnZW5lcmF0b3IKZGVmIGJ1aWxkX2dlbmVyYXRvcigpOgogICAgbW9kZWwgPSB0Zi5rZXJhcy5TZXF1ZW50aWFsKCkKICAgIG1vZGVsLmFkZChsYXllcnMuRGVuc2UoMjU2LCBpbnB1dF9kaW09MTAwLCBhY3RpdmF0aW9uPSdyZWx1JykpCiAgICBtb2RlbC5hZGQobGF5ZXJzLkJhdGNoTm9ybWFsaXphdGlvbigpKQogICAgbW9kZWwuYWRkKGxheWVycy5EZW5zZSg1MTIsIGFjdGl2YXRpb249J3JlbHUnKSkKICAgIG1vZGVsLmFkZChsYXllcnMuQmF0Y2hOb3JtYWxpemF0aW9uKCkpCiAgICBtb2RlbC5hZGQobGF5ZXJzLkRlbnNlKDEwMjQsIGFjdGl2YXRpb249J3JlbHUnKSkKICAgIG1vZGVsLmFkZChsYXllcnMuQmF0Y2hOb3JtYWxpemF0aW9uKCkpCiAgICBtb2RlbC5hZGQobGF5ZXJzLkRlbnNlKDI4ICogMjggKiAxLCBhY3RpdmF0aW9uPSd0YW5oJykpCiAgICBtb2RlbC5hZGQobGF5ZXJzLlJlc2hhcGUoKDI4LCAyOCwgMSkpKQogICAgcmV0dXJuIG1vZGVsCgojIERlZmluZSB0aGUgZGlzY3JpbWluYXRvcgpkZWYgYnVpbGRfZGlzY3JpbWluYXRvcigpOgogICAgbW9kZWwgPSB0Zi5rZXJhcy5TZXF1ZW50aWFsKCkKICAgIG1vZGVsLmFkZChsYXllcnMuRmxhdHRlbihpbnB1dF9zaGFwZT0oMjgsIDI4LCAxKSkpCiAgICBtb2RlbC5hZGQobGF5ZXJzLkRlbnNlKDUxMiwgYWN0aXZhdGlvbj0ncmVsdScpKQogICAgbW9kZWwuYWRkKGxheWVycy5EZW5zZSgyNTYsIGFjdGl2YXRpb249J3JlbHUnKSkKICAgIG1vZGVsLmFkZChsYXllcnMuRGVuc2UoMSwgYWN0aXZhdGlvbj0nc2lnbW9pZCcpKQogICAgcmV0dXJuIG1vZGVsCgojIENyZWF0ZSB0aGUgZ2VuZXJhdG9yIGFuZCBkaXNjcmltaW5hdG9yCmdlbmVyYXRvciA9IGJ1aWxkX2dlbmVyYXRvcigpCmRpc2NyaW1pbmF0b3IgPSBidWlsZF9kaXNjcmltaW5hdG9yKCkKCiMgQ29tcGlsZSB0aGUgZGlzY3JpbWluYXRvcgpkaXNjcmltaW5hdG9yLmNvbXBpbGUob3B0aW1pemVyPSdhZGFtJywgbG9zcz0nYmluYXJ5X2Nyb3NzZW50cm9weScsIG1ldHJpY3M9WydhY2N1cmFjeSddKQoKIyBDcmVhdGUgdGhlIGNvbWJpbmVkIEdBTgpkaXNjcmltaW5hdG9yLnRyYWluYWJsZSA9IEZhbHNlCmdhbl9pbnB1dCA9IGxheWVycy5JbnB1dChzaGFwZT0oMTAwLCkpCmdlbmVyYXRlZF9pbWFnZSA9IGdlbmVyYXRvcihnYW5faW5wdXQpCmdhbl9vdXRwdXQgPSBkaXNjcmltaW5hdG9yKGdlbmVyYXRlZF9pbWFnZSkKZ2FuID0gdGYua2VyYXMuTW9kZWwoZ2FuX2lucHV0LCBnYW5fb3V0cHV0KQoKIyBDb21waWxlIHRoZSBHQU4KZ2FuLmNvbXBpbGUob3B0aW1pemVyPSdhZGFtJywgbG9zcz0nYmluYXJ5X2Nyb3NzZW50cm9weScp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras import layers

# Define the generator
def build_generator():
    model = tf.keras.Sequential()
    model.add(layers.Dense(256, input_dim=100, activation='relu'))
    model.add(layers.BatchNormalization())
    model.add(layers.Dense(512, activation='relu'))
    model.add(layers.BatchNormalization())
    model.add(layers.Dense(1024, activation='relu'))
    model.add(layers.BatchNormalization())
    model.add(layers.Dense(28 * 28 * 1, activation='tanh'))
    model.add(layers.Reshape((28, 28, 1)))
    return model

# Define the discriminator
def build_discriminator():
    model = tf.keras.Sequential()
    model.add(layers.Flatten(input_shape=(28, 28, 1)))
    model.add(layers.Dense(512, activation='relu'))
    model.add(layers.Dense(256, activation='relu'))
    model.add(layers.Dense(1, activation='sigmoid'))
    return model

# Create the generator and discriminator
generator = build_generator()
discriminator = build_discriminator()

# Compile the discriminator
discriminator.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

# Create the combined GAN
discriminator.trainable = False
gan_input = layers.Input(shape=(100,))
generated_image = generator(gan_input)
gan_output = discriminator(generated_image)
gan = tf.keras.Model(gan_input, gan_output)

# Compile the GAN
gan.compile(optimizer='adam', loss='binary_crossentropy')</pre></div><div class='content'></div><h1>Training the GAN</h1>
<div class='content'><p>Training a GAN involves training both the generator and the discriminator in an alternating loop.</p>
</div><h2>Training Steps</h2>
<div class='content'><ol>
<li>
<p><strong>Train the Discriminator</strong>:</p>
<ul>
<li>Use a batch of real images and a batch of generated images.</li>
<li>Calculate the loss and update the discriminator's weights.</li>
</ul>
</li>
<li>
<p><strong>Train the Generator</strong>:</p>
<ul>
<li>Generate a batch of fake images.</li>
<li>Pass these images to the discriminator.</li>
<li>Calculate the loss based on the discriminator's ability to distinguish the fake images.</li>
<li>Update the generator's weights to better fool the discriminator.</li>
</ul>
</li>
</ol>
</div><h2>Training Code Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCgojIFRyYWluaW5nIHBhcmFtZXRlcnMKZXBvY2hzID0gMTAwMDAKYmF0Y2hfc2l6ZSA9IDY0CnNhbXBsZV9pbnRlcnZhbCA9IDEwMDAKCiMgTG9hZCBhbmQgcHJlcHJvY2VzcyB0aGUgTU5JU1QgZGF0YXNldAooWF90cmFpbiwgXyksIChfLCBfKSA9IHRmLmtlcmFzLmRhdGFzZXRzLm1uaXN0LmxvYWRfZGF0YSgpClhfdHJhaW4gPSBYX3RyYWluIC8gMTI3LjUgLSAxLjAKWF90cmFpbiA9IG5wLmV4cGFuZF9kaW1zKFhfdHJhaW4sIGF4aXM9MykKCiMgTGFiZWxzIGZvciByZWFsIGFuZCBmYWtlIGltYWdlcwpyZWFsID0gbnAub25lcygoYmF0Y2hfc2l6ZSwgMSkpCmZha2UgPSBucC56ZXJvcygoYmF0Y2hfc2l6ZSwgMSkpCgpmb3IgZXBvY2ggaW4gcmFuZ2UoZXBvY2hzKToKICAgICMgVHJhaW4gdGhlIGRpc2NyaW1pbmF0b3IKICAgIGlkeCA9IG5wLnJhbmRvbS5yYW5kaW50KDAsIFhfdHJhaW4uc2hhcGVbMF0sIGJhdGNoX3NpemUpCiAgICByZWFsX2ltYWdlcyA9IFhfdHJhaW5baWR4XQoKICAgIG5vaXNlID0gbnAucmFuZG9tLm5vcm1hbCgwLCAxLCAoYmF0Y2hfc2l6ZSwgMTAwKSkKICAgIGdlbmVyYXRlZF9pbWFnZXMgPSBnZW5lcmF0b3IucHJlZGljdChub2lzZSkKCiAgICBkX2xvc3NfcmVhbCA9IGRpc2NyaW1pbmF0b3IudHJhaW5fb25fYmF0Y2gocmVhbF9pbWFnZXMsIHJlYWwpCiAgICBkX2xvc3NfZmFrZSA9IGRpc2NyaW1pbmF0b3IudHJhaW5fb25fYmF0Y2goZ2VuZXJhdGVkX2ltYWdlcywgZmFrZSkKICAgIGRfbG9zcyA9IDAuNSAqIG5wLmFkZChkX2xvc3NfcmVhbCwgZF9sb3NzX2Zha2UpCgogICAgIyBUcmFpbiB0aGUgZ2VuZXJhdG9yCiAgICBub2lzZSA9IG5wLnJhbmRvbS5ub3JtYWwoMCwgMSwgKGJhdGNoX3NpemUsIDEwMCkpCiAgICBnX2xvc3MgPSBnYW4udHJhaW5fb25fYmF0Y2gobm9pc2UsIHJlYWwpCgogICAgIyBQcmludCB0aGUgcHJvZ3Jlc3MKICAgIGlmIGVwb2NoICUgc2FtcGxlX2ludGVydmFsID09IDA6CiAgICAgICAgcHJpbnQoZiJ7ZXBvY2h9IFtEIGxvc3M6IHtkX2xvc3NbMF19LCBhY2MuOiB7MTAwKmRfbG9zc1sxXX0lXSBbRyBsb3NzOiB7Z19sb3NzfV0iKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np

# Training parameters
epochs = 10000
batch_size = 64
sample_interval = 1000

# Load and preprocess the MNIST dataset
(X_train, _), (_, _) = tf.keras.datasets.mnist.load_data()
X_train = X_train / 127.5 - 1.0
X_train = np.expand_dims(X_train, axis=3)

# Labels for real and fake images
real = np.ones((batch_size, 1))
fake = np.zeros((batch_size, 1))

for epoch in range(epochs):
    # Train the discriminator
    idx = np.random.randint(0, X_train.shape[0], batch_size)
    real_images = X_train[idx]

    noise = np.random.normal(0, 1, (batch_size, 100))
    generated_images = generator.predict(noise)

    d_loss_real = discriminator.train_on_batch(real_images, real)
    d_loss_fake = discriminator.train_on_batch(generated_images, fake)
    d_loss = 0.5 * np.add(d_loss_real, d_loss_fake)

    # Train the generator
    noise = np.random.normal(0, 1, (batch_size, 100))
    g_loss = gan.train_on_batch(noise, real)

    # Print the progress
    if epoch % sample_interval == 0:
        print(f&quot;{epoch} [D loss: {d_loss[0]}, acc.: {100*d_loss[1]}%] [G loss: {g_loss}]&quot;)</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this project, we have explored how to create and train a GAN for image generation. GANs are a powerful tool in the field of deep learning, with applications ranging from image and video generation to the creation of synthetic data for training other models. As you advance in your understanding of GANs, you will be able to experiment with more complex architectures and innovative applications.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
