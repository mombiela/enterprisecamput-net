<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Management and ARC</title>

    <link rel="alternate" href="https://campusempresa.com/swift/memory-management-and-arc" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/swift/memory-management-and-arc" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/swift/memory-management-and-arc" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/swift/memory-management-and-arc" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/swift/memory-management-and-arc" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='error-handling'>&#x25C4;Error Handling</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Memory Management and ARC</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-ios-development'>Introduction to iOS Development &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Memory management is a crucial aspect of programming in Swift, ensuring that your application uses memory efficiently and avoids leaks. Swift uses Automatic Reference Counting (ARC) to manage memory automatically. This section will guide you from the basics to advanced concepts of memory management and ARC in Swift.</p>
</div><h1>Introduction to Memory Management</h1>
<div class='content'><p>Memory management involves tracking and controlling the allocation and deallocation of memory in your application. Proper memory management ensures that your app runs efficiently and prevents memory leaks, which can lead to crashes or slow performance.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Memory Allocation</strong>: Reserving a portion of memory for use by your application.</li>
<li><strong>Memory Deallocation</strong>: Releasing the reserved memory when it is no longer needed.</li>
<li><strong>Memory Leak</strong>: Occurs when memory that is no longer needed is not released, causing a gradual increase in memory usage.</li>
</ul>
</div><h1>Automatic Reference Counting (ARC)</h1>
<div class='content'><p>Swift uses ARC to manage memory usage by keeping track of the number of references to each class instance. When there are no more references to an instance, ARC automatically deallocates it to free up memory.</p>
</div><h2>How ARC Works</h2>
<div class='content'><ul>
<li><strong>Strong References</strong>: By default, every reference to a class instance is a strong reference, meaning it keeps the instance in memory as long as the reference exists.</li>
<li><strong>Weak References</strong>: A weak reference does not keep a strong hold on the instance, allowing it to be deallocated if there are no other strong references.</li>
<li><strong>Unowned References</strong>: Similar to weak references but used when the reference is expected to always have a value during its lifetime.</li>
</ul>
</div><h2>Code Example: Strong References</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgUGVyc29uIHsKICAgIGxldCBuYW1lOiBTdHJpbmcKICAgIGluaXQobmFtZTogU3RyaW5nKSB7CiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQogICAgICAgIHByaW50KCJcKG5hbWUpIGlzIGJlaW5nIGluaXRpYWxpemVkIikKICAgIH0KICAgIGRlaW5pdCB7CiAgICAgICAgcHJpbnQoIlwobmFtZSkgaXMgYmVpbmcgZGVpbml0aWFsaXplZCIpCiAgICB9Cn0KCnZhciByZWZlcmVuY2UxOiBQZXJzb24/ID0gUGVyc29uKG5hbWU6ICJKb2huIikKdmFyIHJlZmVyZW5jZTIgPSByZWZlcmVuY2UxCnZhciByZWZlcmVuY2UzID0gcmVmZXJlbmNlMQoKcmVmZXJlbmNlMSA9IG5pbApyZWZlcmVuY2UyID0gbmlsCnJlZmVyZW5jZTMgPSBuaWwKLy8gT3V0cHV0OiBKb2huIGlzIGJlaW5nIGRlaW5pdGlhbGl6ZWQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Person {
    let name: String
    init(name: String) {
        self.name = name
        print(&quot;\(name) is being initialized&quot;)
    }
    deinit {
        print(&quot;\(name) is being deinitialized&quot;)
    }
}

var reference1: Person? = Person(name: &quot;John&quot;)
var reference2 = reference1
var reference3 = reference1

reference1 = nil
reference2 = nil
reference3 = nil
// Output: John is being deinitialized</pre></div><div class='content'><p>In this example:</p>
<ul>
<li><code>reference1</code>, <code>reference2</code>, and <code>reference3</code> are strong references to the <code>Person</code> instance.</li>
<li>The instance is deallocated only when all references are set to <code>nil</code>.</li>
</ul>
</div><h2>Code Example: Weak References</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgUGVyc29uIHsKICAgIGxldCBuYW1lOiBTdHJpbmcKICAgIGluaXQobmFtZTogU3RyaW5nKSB7CiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQogICAgICAgIHByaW50KCJcKG5hbWUpIGlzIGJlaW5nIGluaXRpYWxpemVkIikKICAgIH0KICAgIGRlaW5pdCB7CiAgICAgICAgcHJpbnQoIlwobmFtZSkgaXMgYmVpbmcgZGVpbml0aWFsaXplZCIpCiAgICB9Cn0KCmNsYXNzIEFwYXJ0bWVudCB7CiAgICBsZXQgdW5pdDogU3RyaW5nCiAgICB3ZWFrIHZhciB0ZW5hbnQ6IFBlcnNvbj8KICAgIGluaXQodW5pdDogU3RyaW5nKSB7CiAgICAgICAgc2VsZi51bml0ID0gdW5pdAogICAgfQp9Cgp2YXIgam9objogUGVyc29uPyA9IFBlcnNvbihuYW1lOiAiSm9obiIpCnZhciB1bml0NEE6IEFwYXJ0bWVudD8gPSBBcGFydG1lbnQodW5pdDogIjRBIikKCnVuaXQ0QT8udGVuYW50ID0gam9obgpqb2huID0gbmlsCi8vIE91dHB1dDogSm9obiBpcyBiZWluZyBkZWluaXRpYWxpemVk"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Person {
    let name: String
    init(name: String) {
        self.name = name
        print(&quot;\(name) is being initialized&quot;)
    }
    deinit {
        print(&quot;\(name) is being deinitialized&quot;)
    }
}

class Apartment {
    let unit: String
    weak var tenant: Person?
    init(unit: String) {
        self.unit = unit
    }
}

var john: Person? = Person(name: &quot;John&quot;)
var unit4A: Apartment? = Apartment(unit: &quot;4A&quot;)

unit4A?.tenant = john
john = nil
// Output: John is being deinitialized</pre></div><div class='content'><p>In this example:</p>
<ul>
<li><code>tenant</code> is a weak reference to the <code>Person</code> instance.</li>
<li>The <code>Person</code> instance is deallocated when <code>john</code> is set to <code>nil</code>, even though <code>tenant</code> still holds a reference.</li>
</ul>
</div><h2>Code Example: Unowned References</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgQ3VzdG9tZXIgewogICAgbGV0IG5hbWU6IFN0cmluZwogICAgdmFyIGNhcmQ6IENyZWRpdENhcmQ/CiAgICBpbml0KG5hbWU6IFN0cmluZykgewogICAgICAgIHNlbGYubmFtZSA9IG5hbWUKICAgIH0KICAgIGRlaW5pdCB7CiAgICAgICAgcHJpbnQoIlwobmFtZSkgaXMgYmVpbmcgZGVpbml0aWFsaXplZCIpCiAgICB9Cn0KCmNsYXNzIENyZWRpdENhcmQgewogICAgbGV0IG51bWJlcjogVUludDY0CiAgICB1bm93bmVkIGxldCBjdXN0b21lcjogQ3VzdG9tZXIKICAgIGluaXQobnVtYmVyOiBVSW50NjQsIGN1c3RvbWVyOiBDdXN0b21lcikgewogICAgICAgIHNlbGYubnVtYmVyID0gbnVtYmVyCiAgICAgICAgc2VsZi5jdXN0b21lciA9IGN1c3RvbWVyCiAgICB9CiAgICBkZWluaXQgewogICAgICAgIHByaW50KCJDYXJkICNcKG51bWJlcikgaXMgYmVpbmcgZGVpbml0aWFsaXplZCIpCiAgICB9Cn0KCnZhciBqb2huOiBDdXN0b21lcj8gPSBDdXN0b21lcihuYW1lOiAiSm9obiIpCmpvaG4/LmNhcmQgPSBDcmVkaXRDYXJkKG51bWJlcjogMTIzNF81Njc4XzkwMTJfMzQ1NiwgY3VzdG9tZXI6IGpvaG4hKQoKam9obiA9IG5pbAovLyBPdXRwdXQ6IEpvaG4gaXMgYmVpbmcgZGVpbml0aWFsaXplZAovLyBPdXRwdXQ6IENhcmQgIzEyMzQ1Njc4OTAxMjM0NTYgaXMgYmVpbmcgZGVpbml0aWFsaXplZA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Customer {
    let name: String
    var card: CreditCard?
    init(name: String) {
        self.name = name
    }
    deinit {
        print(&quot;\(name) is being deinitialized&quot;)
    }
}

class CreditCard {
    let number: UInt64
    unowned let customer: Customer
    init(number: UInt64, customer: Customer) {
        self.number = number
        self.customer = customer
    }
    deinit {
        print(&quot;Card #\(number) is being deinitialized&quot;)
    }
}

var john: Customer? = Customer(name: &quot;John&quot;)
john?.card = CreditCard(number: 1234_5678_9012_3456, customer: john!)

john = nil
// Output: John is being deinitialized
// Output: Card #1234567890123456 is being deinitialized</pre></div><div class='content'><p>In this example:</p>
<ul>
<li><code>customer</code> is an unowned reference to the <code>Customer</code> instance.</li>
<li>Both <code>Customer</code> and <code>CreditCard</code> instances are deallocated when <code>john</code> is set to <code>nil</code>.</li>
</ul>
</div><h1>Retain Cycles</h1>
<div class='content'><p>A retain cycle occurs when two or more instances hold strong references to each other, preventing ARC from deallocating them. This can lead to memory leaks.</p>
</div><h2>Example of a Retain Cycle</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgUGVyc29uIHsKICAgIGxldCBuYW1lOiBTdHJpbmcKICAgIHZhciBhcGFydG1lbnQ6IEFwYXJ0bWVudD8KICAgIGluaXQobmFtZTogU3RyaW5nKSB7CiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQogICAgfQogICAgZGVpbml0IHsKICAgICAgICBwcmludCgiXChuYW1lKSBpcyBiZWluZyBkZWluaXRpYWxpemVkIikKICAgIH0KfQoKY2xhc3MgQXBhcnRtZW50IHsKICAgIGxldCB1bml0OiBTdHJpbmcKICAgIHZhciB0ZW5hbnQ6IFBlcnNvbj8KICAgIGluaXQodW5pdDogU3RyaW5nKSB7CiAgICAgICAgc2VsZi51bml0ID0gdW5pdAogICAgfQogICAgZGVpbml0IHsKICAgICAgICBwcmludCgiQXBhcnRtZW50IFwodW5pdCkgaXMgYmVpbmcgZGVpbml0aWFsaXplZCIpCiAgICB9Cn0KCnZhciBqb2huOiBQZXJzb24/ID0gUGVyc29uKG5hbWU6ICJKb2huIikKdmFyIHVuaXQ0QTogQXBhcnRtZW50PyA9IEFwYXJ0bWVudCh1bml0OiAiNEEiKQoKam9obj8uYXBhcnRtZW50ID0gdW5pdDRBCnVuaXQ0QT8udGVuYW50ID0gam9obgoKam9obiA9IG5pbAp1bml0NEEgPSBuaWwKLy8gTm8gZGVpbml0aWFsaXphdGlvbiBtZXNzYWdlcyBhcmUgcHJpbnRlZCwgaW5kaWNhdGluZyBhIHJldGFpbiBjeWNsZQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Person {
    let name: String
    var apartment: Apartment?
    init(name: String) {
        self.name = name
    }
    deinit {
        print(&quot;\(name) is being deinitialized&quot;)
    }
}

class Apartment {
    let unit: String
    var tenant: Person?
    init(unit: String) {
        self.unit = unit
    }
    deinit {
        print(&quot;Apartment \(unit) is being deinitialized&quot;)
    }
}

var john: Person? = Person(name: &quot;John&quot;)
var unit4A: Apartment? = Apartment(unit: &quot;4A&quot;)

john?.apartment = unit4A
unit4A?.tenant = john

john = nil
unit4A = nil
// No deinitialization messages are printed, indicating a retain cycle</pre></div><div class='content'></div><h2>Breaking Retain Cycles</h2>
<div class='content'><p>To break retain cycles, use weak or unowned references appropriately.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgUGVyc29uIHsKICAgIGxldCBuYW1lOiBTdHJpbmcKICAgIHZhciBhcGFydG1lbnQ6IEFwYXJ0bWVudD8KICAgIGluaXQobmFtZTogU3RyaW5nKSB7CiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQogICAgfQogICAgZGVpbml0IHsKICAgICAgICBwcmludCgiXChuYW1lKSBpcyBiZWluZyBkZWluaXRpYWxpemVkIikKICAgIH0KfQoKY2xhc3MgQXBhcnRtZW50IHsKICAgIGxldCB1bml0OiBTdHJpbmcKICAgIHdlYWsgdmFyIHRlbmFudDogUGVyc29uPwogICAgaW5pdCh1bml0OiBTdHJpbmcpIHsKICAgICAgICBzZWxmLnVuaXQgPSB1bml0CiAgICB9CiAgICBkZWluaXQgewogICAgICAgIHByaW50KCJBcGFydG1lbnQgXCh1bml0KSBpcyBiZWluZyBkZWluaXRpYWxpemVkIikKICAgIH0KfQoKdmFyIGpvaG46IFBlcnNvbj8gPSBQZXJzb24obmFtZTogIkpvaG4iKQp2YXIgdW5pdDRBOiBBcGFydG1lbnQ/ID0gQXBhcnRtZW50KHVuaXQ6ICI0QSIpCgpqb2huPy5hcGFydG1lbnQgPSB1bml0NEEKdW5pdDRBPy50ZW5hbnQgPSBqb2huCgpqb2huID0gbmlsCnVuaXQ0QSA9IG5pbAovLyBPdXRwdXQ6IEpvaG4gaXMgYmVpbmcgZGVpbml0aWFsaXplZAovLyBPdXRwdXQ6IEFwYXJ0bWVudCA0QSBpcyBiZWluZyBkZWluaXRpYWxpemVk"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Person {
    let name: String
    var apartment: Apartment?
    init(name: String) {
        self.name = name
    }
    deinit {
        print(&quot;\(name) is being deinitialized&quot;)
    }
}

class Apartment {
    let unit: String
    weak var tenant: Person?
    init(unit: String) {
        self.unit = unit
    }
    deinit {
        print(&quot;Apartment \(unit) is being deinitialized&quot;)
    }
}

var john: Person? = Person(name: &quot;John&quot;)
var unit4A: Apartment? = Apartment(unit: &quot;4A&quot;)

john?.apartment = unit4A
unit4A?.tenant = john

john = nil
unit4A = nil
// Output: John is being deinitialized
// Output: Apartment 4A is being deinitialized</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Memory management and ARC are essential for writing efficient and robust Swift applications. By understanding how ARC works and how to use strong, weak, and unowned references, you can prevent memory leaks and retain cycles. Practice these concepts with the provided examples to gain a deeper understanding and ensure your applications manage memory effectively.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='error-handling'>&#x25C4;Error Handling</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Memory Management and ARC</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-ios-development'>Introduction to iOS Development &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
