<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Handling Transactions</title>

    <link rel="alternate" href="https://campusempresa.com/cobol/handling-transactions" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cobol/handling-transactions" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/cobol/handling-transactions" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/cobol/handling-transactions" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/cobol/handling-transactions" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='database-access-techniques'>&#x25C4;Database Access Techniques</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Handling Transactions</a>
	</div>
	<div class='col-4 text-end'>
					<a href='cobol-and-mainframes'>COBOL and Mainframes &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Transactions in COBOL</h1>
<div class='content'><p>Handling transactions is a critical aspect of COBOL programming, especially in business applications where data integrity and consistency are paramount. This section will cover the basics of transactions, their importance, and how to manage them in COBOL.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Transaction</strong>: A sequence of operations performed as a single logical unit of work.</li>
<li><strong>ACID Properties</strong>: Transactions must be Atomic, Consistent, Isolated, and Durable.</li>
<li><strong>Commit</strong>: Finalize a transaction, making all changes permanent.</li>
<li><strong>Rollback</strong>: Undo all changes made during a transaction.</li>
</ul>
</div><h1>Basic Transaction Handling</h1>
<div class='content'><p>In COBOL, transactions are often managed through database management systems (DBMS) like DB2. Here, we will focus on the basic commands and structures used to handle transactions.</p>
</div><h2>Example: Basic Transaction Structure</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIFRyYW5zYWN0aW9uRXhhbXBsZS4KCkRBVEEgRElWSVNJT04uCldPUktJTkctU1RPUkFHRSBTRUNUSU9OLgowMSBXUy1UUkFOU0FDVElPTi1TVEFUVVMgUElDIFggVkFMVUUgJ04nLgoKUFJPQ0VEVVJFIERJVklTSU9OLgpCRUdJTi1UUkFOU0FDVElPTi4KICAgIEVYRUMgU1FMCiAgICAgICAgQkVHSU4gVFJBTlNBQ1RJT04KICAgIEVORC1FWEVDLgoKICAgIFBFUkZPUk0gQlVTSU5FU1MtTE9HSUMuCgogICAgSUYgV1MtVFJBTlNBQ1RJT04tU1RBVFVTID0gJ1knCiAgICAgICAgRVhFQyBTUUwKICAgICAgICAgICAgQ09NTUlUCiAgICAgICAgRU5ELUVYRUMKICAgIEVMU0UKICAgICAgICBFWEVDIFNRTAogICAgICAgICAgICBST0xMQkFDSwogICAgICAgIEVORC1FWEVDLgoKICAgIFNUT1AgUlVOLgoKQlVTSU5FU1MtTE9HSUMuCiAgICAqIFBlcmZvcm0gb3BlcmF0aW9ucyBoZXJlCiAgICAqIFNldCBXUy1UUkFOU0FDVElPTi1TVEFUVVMgdG8gJ1knIGlmIHN1Y2Nlc3NmdWwKICAgIE1PVkUgJ1knIFRPIFdTLVRSQU5TQUNUSU9OLVNUQVRVUy4KICAgIEVYSVQu"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. TransactionExample.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-TRANSACTION-STATUS PIC X VALUE 'N'.

PROCEDURE DIVISION.
BEGIN-TRANSACTION.
    EXEC SQL
        BEGIN TRANSACTION
    END-EXEC.

    PERFORM BUSINESS-LOGIC.

    IF WS-TRANSACTION-STATUS = 'Y'
        EXEC SQL
            COMMIT
        END-EXEC
    ELSE
        EXEC SQL
            ROLLBACK
        END-EXEC.

    STOP RUN.

BUSINESS-LOGIC.
    * Perform operations here
    * Set WS-TRANSACTION-STATUS to 'Y' if successful
    MOVE 'Y' TO WS-TRANSACTION-STATUS.
    EXIT.</pre></div><div class='content'><ul>
<li><strong>BEGIN TRANSACTION</strong>: Starts a new transaction.</li>
<li><strong>COMMIT</strong>: Commits the transaction if successful.</li>
<li><strong>ROLLBACK</strong>: Rolls back the transaction if there is an error.</li>
</ul>
</div><h1>Advanced Transaction Handling</h1>
<div class='content'><p>Advanced transaction handling involves more complex scenarios such as nested transactions, error handling, and ensuring data integrity across multiple operations.</p>
</div><h2>Nested Transactions</h2>
<div class='content'><p>Nested transactions allow you to manage multiple levels of transactions within a single program. However, not all DBMS support nested transactions directly.</p>
</div><h2>Example: Handling Nested Transactions</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIE5lc3RlZFRyYW5zYWN0aW9uRXhhbXBsZS4KCkRBVEEgRElWSVNJT04uCldPUktJTkctU1RPUkFHRSBTRUNUSU9OLgowMSBXUy1PVVRFUi1UUkFOU0FDVElPTi1TVEFUVVMgUElDIFggVkFMVUUgJ04nLgowMSBXUy1JTk5FUi1UUkFOU0FDVElPTi1TVEFUVVMgUElDIFggVkFMVUUgJ04nLgoKUFJPQ0VEVVJFIERJVklTSU9OLgpCRUdJTi1PVVRFUi1UUkFOU0FDVElPTi4KICAgIEVYRUMgU1FMCiAgICAgICAgQkVHSU4gVFJBTlNBQ1RJT04KICAgIEVORC1FWEVDLgoKICAgIFBFUkZPUk0gT1VURVItQlVTSU5FU1MtTE9HSUMuCgogICAgSUYgV1MtT1VURVItVFJBTlNBQ1RJT04tU1RBVFVTID0gJ1knCiAgICAgICAgRVhFQyBTUUwKICAgICAgICAgICAgQ09NTUlUCiAgICAgICAgRU5ELUVYRUMKICAgIEVMU0UKICAgICAgICBFWEVDIFNRTAogICAgICAgICAgICBST0xMQkFDSwogICAgICAgIEVORC1FWEVDLgoKICAgIFNUT1AgUlVOLgoKT1VURVItQlVTSU5FU1MtTE9HSUMuCiAgICAqIFBlcmZvcm0gb3V0ZXIgb3BlcmF0aW9ucyBoZXJlCiAgICAqIFN0YXJ0IGlubmVyIHRyYW5zYWN0aW9uCiAgICBFWEVDIFNRTAogICAgICAgIEJFR0lOIFRSQU5TQUNUSU9OCiAgICBFTkQtRVhFQy4KCiAgICBQRVJGT1JNIElOTkVSLUJVU0lORVNTLUxPR0lDLgoKICAgIElGIFdTLUlOTkVSLVRSQU5TQUNUSU9OLVNUQVRVUyA9ICdZJwogICAgICAgIEVYRUMgU1FMCiAgICAgICAgICAgIENPTU1JVAogICAgICAgIEVORC1FWEVDCiAgICBFTFNFCiAgICAgICAgRVhFQyBTUUwKICAgICAgICAgICAgUk9MTEJBQ0sKICAgICAgICBFTkQtRVhFQy4KCiAgICAqIFNldCBXUy1PVVRFUi1UUkFOU0FDVElPTi1TVEFUVVMgYmFzZWQgb24gaW5uZXIgdHJhbnNhY3Rpb24KICAgIE1PVkUgJ1knIFRPIFdTLU9VVEVSLVRSQU5TQUNUSU9OLVNUQVRVUy4KICAgIEVYSVQuCgpJTk5FUi1CVVNJTkVTUy1MT0dJQy4KICAgICogUGVyZm9ybSBpbm5lciBvcGVyYXRpb25zIGhlcmUKICAgICogU2V0IFdTLUlOTkVSLVRSQU5TQUNUSU9OLVNUQVRVUyB0byAnWScgaWYgc3VjY2Vzc2Z1bAogICAgTU9WRSAnWScgVE8gV1MtSU5ORVItVFJBTlNBQ1RJT04tU1RBVFVTLgogICAgRVhJVC4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. NestedTransactionExample.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-OUTER-TRANSACTION-STATUS PIC X VALUE 'N'.
01 WS-INNER-TRANSACTION-STATUS PIC X VALUE 'N'.

PROCEDURE DIVISION.
BEGIN-OUTER-TRANSACTION.
    EXEC SQL
        BEGIN TRANSACTION
    END-EXEC.

    PERFORM OUTER-BUSINESS-LOGIC.

    IF WS-OUTER-TRANSACTION-STATUS = 'Y'
        EXEC SQL
            COMMIT
        END-EXEC
    ELSE
        EXEC SQL
            ROLLBACK
        END-EXEC.

    STOP RUN.

OUTER-BUSINESS-LOGIC.
    * Perform outer operations here
    * Start inner transaction
    EXEC SQL
        BEGIN TRANSACTION
    END-EXEC.

    PERFORM INNER-BUSINESS-LOGIC.

    IF WS-INNER-TRANSACTION-STATUS = 'Y'
        EXEC SQL
            COMMIT
        END-EXEC
    ELSE
        EXEC SQL
            ROLLBACK
        END-EXEC.

    * Set WS-OUTER-TRANSACTION-STATUS based on inner transaction
    MOVE 'Y' TO WS-OUTER-TRANSACTION-STATUS.
    EXIT.

INNER-BUSINESS-LOGIC.
    * Perform inner operations here
    * Set WS-INNER-TRANSACTION-STATUS to 'Y' if successful
    MOVE 'Y' TO WS-INNER-TRANSACTION-STATUS.
    EXIT.</pre></div><div class='content'><ul>
<li><strong>BEGIN TRANSACTION</strong>: Used for both outer and inner transactions.</li>
<li><strong>COMMIT</strong> and <strong>ROLLBACK</strong>: Applied at both levels to ensure data integrity.</li>
</ul>
</div><h1>Error Handling in Transactions</h1>
<div class='content'><p>Proper error handling is crucial to ensure that transactions are correctly managed and that the system remains in a consistent state.</p>
</div><h2>Example: Error Handling</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEVycm9ySGFuZGxpbmdFeGFtcGxlLgoKREFUQSBESVZJU0lPTi4KV09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCjAxIFdTLVRSQU5TQUNUSU9OLVNUQVRVUyBQSUMgWCBWQUxVRSAnTicuCjAxIFdTLVNRTENPREUgUElDIFM5KDkpIENPTVAuCgpQUk9DRURVUkUgRElWSVNJT04uCkJFR0lOLVRSQU5TQUNUSU9OLgogICAgRVhFQyBTUUwKICAgICAgICBCRUdJTiBUUkFOU0FDVElPTgogICAgRU5ELUVYRUMuCgogICAgUEVSRk9STSBCVVNJTkVTUy1MT0dJQy4KCiAgICBJRiBXUy1UUkFOU0FDVElPTi1TVEFUVVMgPSAnWScKICAgICAgICBFWEVDIFNRTAogICAgICAgICAgICBDT01NSVQKICAgICAgICBFTkQtRVhFQwogICAgRUxTRQogICAgICAgIEVYRUMgU1FMCiAgICAgICAgICAgIFJPTExCQUNLCiAgICAgICAgRU5ELUVYRUMuCgogICAgU1RPUCBSVU4uCgpCVVNJTkVTUy1MT0dJQy4KICAgICogUGVyZm9ybSBvcGVyYXRpb25zIGhlcmUKICAgICogQ2hlY2sgZm9yIFNRTCBlcnJvcnMKICAgIEVYRUMgU1FMCiAgICAgICAgSU5TRVJUIElOVE8gTVlUQUJMRSAoQ09MMSkgVkFMVUVTICgnVkFMVUUnKQogICAgRU5ELUVYRUMKICAgIElGIFNRTENPREUgTk9UID0gMAogICAgICAgIE1PVkUgJ04nIFRPIFdTLVRSQU5TQUNUSU9OLVNUQVRVUwogICAgRUxTRQogICAgICAgIE1PVkUgJ1knIFRPIFdTLVRSQU5TQUNUSU9OLVNUQVRVUy4KICAgIEVYSVQu"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. ErrorHandlingExample.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-TRANSACTION-STATUS PIC X VALUE 'N'.
01 WS-SQLCODE PIC S9(9) COMP.

PROCEDURE DIVISION.
BEGIN-TRANSACTION.
    EXEC SQL
        BEGIN TRANSACTION
    END-EXEC.

    PERFORM BUSINESS-LOGIC.

    IF WS-TRANSACTION-STATUS = 'Y'
        EXEC SQL
            COMMIT
        END-EXEC
    ELSE
        EXEC SQL
            ROLLBACK
        END-EXEC.

    STOP RUN.

BUSINESS-LOGIC.
    * Perform operations here
    * Check for SQL errors
    EXEC SQL
        INSERT INTO MYTABLE (COL1) VALUES ('VALUE')
    END-EXEC
    IF SQLCODE NOT = 0
        MOVE 'N' TO WS-TRANSACTION-STATUS
    ELSE
        MOVE 'Y' TO WS-TRANSACTION-STATUS.
    EXIT.</pre></div><div class='content'><ul>
<li><strong>SQLCODE</strong>: Used to check for SQL errors.</li>
<li><strong>Error Handling</strong>: Ensures that the transaction is rolled back in case of errors.</li>
</ul>
</div><h1>Summary</h1>
<div class='content'><p>Handling transactions in COBOL involves understanding the basic concepts of transactions, using SQL commands to manage them, and implementing error handling to maintain data integrity. By mastering these techniques, you can ensure that your COBOL programs handle data consistently and reliably.</p>
<ul>
<li><strong>Key Takeaways</strong>:
<ul>
<li>Understand the importance of transactions and ACID properties.</li>
<li>Use <code>BEGIN TRANSACTION</code>, <code>COMMIT</code>, and <code>ROLLBACK</code> to manage transactions.</li>
<li>Implement error handling to ensure data integrity.</li>
<li>Practice with nested transactions for complex scenarios.</li>
</ul>
</li>
</ul>
<p>By following these guidelines, you will be able to effectively manage transactions in your COBOL applications, ensuring robust and reliable business processes.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='database-access-techniques'>&#x25C4;Database Access Techniques</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Handling Transactions</a>
	</div>
	<div class='col-4 text-end'>
					<a href='cobol-and-mainframes'>COBOL and Mainframes &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
