<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embedded SQL in COBOL</title>

    <link rel="alternate" href="https://campusempresa.com/cobol/embedded-sql-in-cobol" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cobol/embedded-sql-in-cobol" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/cobol/embedded-sql-in-cobol" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/cobol/embedded-sql-in-cobol" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/cobol/embedded-sql-in-cobol" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-cobol-and-databases'>&#x25C4;Introduction to COBOL and Databases</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Embedded SQL in COBOL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='database-access-techniques'>Database Access Techniques &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Embedded SQL</h1>
<div class='content'><p>Embedded SQL allows COBOL programs to execute SQL statements directly within the COBOL code. This integration enables COBOL applications to interact with relational databases seamlessly.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Embedded SQL</strong>: SQL statements embedded within a host language (COBOL) program.</li>
<li><strong>Host Variables</strong>: COBOL variables used to pass data between the COBOL program and the SQL statements.</li>
<li><strong>EXEC SQL</strong>: The keyword used to start an embedded SQL statement.</li>
<li><strong>END-EXEC</strong>: The keyword used to end an embedded SQL statement.</li>
</ul>
</div><h1>Setting Up Embedded SQL in COBOL</h1>
<div class='content'><p>To use embedded SQL in COBOL, you need to:</p>
<ol>
<li><strong>Include the SQLCA (SQL Communication Area)</strong>: This is a structure that provides feedback on the execution of SQL statements.</li>
<li><strong>Declare Host Variables</strong>: These are COBOL variables that will be used in SQL statements.</li>
<li><strong>Use EXEC SQL and END-EXEC</strong>: To embed SQL statements within the COBOL code.</li>
</ol>
</div><h2>Example: Basic Setup</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEVtYmVkZGVkU1FMRXhhbXBsZS4KCkRBVEEgRElWSVNJT04uCldPUktJTkctU1RPUkFHRSBTRUNUSU9OLgpFWEVDIFNRTCBJTkNMVURFIFNRTENBIEVORC1FWEVDLgoKMDEgRU1QLUlEIFBJQyA5KDQpLgowMSBFTVAtTkFNRSBQSUMgWCgyMCkuCgpQUk9DRURVUkUgRElWSVNJT04uCiAgICBFWEVDIFNRTAogICAgICAgIFNFTEVDVCBFTVBfTkFNRQogICAgICAgIElOVE8gOkVNUC1OQU1FCiAgICAgICAgRlJPTSBFTVBMT1lFRVMKICAgICAgICBXSEVSRSBFTVBfSUQgPSA6RU1QLUlECiAgICBFTkQtRVhFQy4KCiAgICBESVNQTEFZICdFbXBsb3llZSBOYW1lOiAnIEVNUC1OQU1FLgogICAgU1RPUCBSVU4u"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. EmbeddedSQLExample.

DATA DIVISION.
WORKING-STORAGE SECTION.
EXEC SQL INCLUDE SQLCA END-EXEC.

01 EMP-ID PIC 9(4).
01 EMP-NAME PIC X(20).

PROCEDURE DIVISION.
    EXEC SQL
        SELECT EMP_NAME
        INTO :EMP-NAME
        FROM EMPLOYEES
        WHERE EMP_ID = :EMP-ID
    END-EXEC.

    DISPLAY 'Employee Name: ' EMP-NAME.
    STOP RUN.</pre></div><div class='content'><ul>
<li><strong>SQLCA</strong>: Included to handle SQL execution feedback.</li>
<li><strong>Host Variables</strong>: <code>EMP-ID</code> and <code>EMP-NAME</code> are used to pass data between COBOL and SQL.</li>
</ul>
</div><h1>Common SQL Operations in COBOL</h1>
<div class='content'></div><h2>SELECT Statement</h2>
<div class='content'><p>The <code>SELECT</code> statement retrieves data from the database.</p>
<h4>Example: SELECT Statement</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIFNFTEVDVCBFTVBfTkFNRQogICAgSU5UTyA6RU1QLU5BTUUKICAgIEZST00gRU1QTE9ZRUVTCiAgICBXSEVSRSBFTVBfSUQgPSA6RU1QLUlECkVORC1FWEVDLg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    SELECT EMP_NAME
    INTO :EMP-NAME
    FROM EMPLOYEES
    WHERE EMP_ID = :EMP-ID
END-EXEC.</pre></div><div class='content'><ul>
<li><strong>INTO Clause</strong>: Specifies the host variable to store the result.</li>
<li><strong>WHERE Clause</strong>: Filters the data based on the condition.</li>
</ul>
</div><h2>INSERT Statement</h2>
<div class='content'><p>The <code>INSERT</code> statement adds new records to the database.</p>
<h4>Example: INSERT Statement</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIElOU0VSVCBJTlRPIEVNUExPWUVFUyAoRU1QX0lELCBFTVBfTkFNRSkKICAgIFZBTFVFUyAoOkVNUC1JRCwgOkVNUC1OQU1FKQpFTkQtRVhFQy4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    INSERT INTO EMPLOYEES (EMP_ID, EMP_NAME)
    VALUES (:EMP-ID, :EMP-NAME)
END-EXEC.</pre></div><div class='content'><ul>
<li><strong>VALUES Clause</strong>: Specifies the values to be inserted into the table.</li>
</ul>
</div><h2>UPDATE Statement</h2>
<div class='content'><p>The <code>UPDATE</code> statement modifies existing records in the database.</p>
<h4>Example: UPDATE Statement</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIFVQREFURSBFTVBMT1lFRVMKICAgIFNFVCBFTVBfTkFNRSA9IDpFTVAtTkFNRQogICAgV0hFUkUgRU1QX0lEID0gOkVNUC1JRApFTkQtRVhFQy4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    UPDATE EMPLOYEES
    SET EMP_NAME = :EMP-NAME
    WHERE EMP_ID = :EMP-ID
END-EXEC.</pre></div><div class='content'><ul>
<li><strong>SET Clause</strong>: Specifies the column to be updated and the new value.</li>
</ul>
</div><h2>DELETE Statement</h2>
<div class='content'><p>The <code>DELETE</code> statement removes records from the database.</p>
<h4>Example: DELETE Statement</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIERFTEVURSBGUk9NIEVNUExPWUVFUwogICAgV0hFUkUgRU1QX0lEID0gOkVNUC1JRApFTkQtRVhFQy4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    DELETE FROM EMPLOYEES
    WHERE EMP_ID = :EMP-ID
END-EXEC.</pre></div><div class='content'><ul>
<li><strong>WHERE Clause</strong>: Specifies the condition to identify which records to delete.</li>
</ul>
</div><h1>Handling SQL Errors</h1>
<div class='content'><p>SQL errors can be handled using the SQLCA structure. The <code>SQLCODE</code> field in SQLCA indicates the outcome of the SQL operation.</p>
</div><h2>Example: Error Handling</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIFNFTEVDVCBFTVBfTkFNRQogICAgSU5UTyA6RU1QLU5BTUUKICAgIEZST00gRU1QTE9ZRUVTCiAgICBXSEVSRSBFTVBfSUQgPSA6RU1QLUlECkVORC1FWEVDLgoKSUYgU1FMQ09ERSBOT1QgPSAwCiAgICBESVNQTEFZICdFcnJvcjogJyBTUUxDT0RFCkVMU0UKICAgIERJU1BMQVkgJ0VtcGxveWVlIE5hbWU6ICcgRU1QLU5BTUUu"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    SELECT EMP_NAME
    INTO :EMP-NAME
    FROM EMPLOYEES
    WHERE EMP_ID = :EMP-ID
END-EXEC.

IF SQLCODE NOT = 0
    DISPLAY 'Error: ' SQLCODE
ELSE
    DISPLAY 'Employee Name: ' EMP-NAME.</pre></div><div class='content'><ul>
<li><strong>SQLCODE</strong>: A field in SQLCA that contains the result of the SQL operation. A value of 0 indicates success, while other values indicate different types of errors.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Embedded SQL in COBOL allows for powerful database interactions directly within COBOL programs. By understanding the basic setup, common SQL operations, and error handling, you can effectively integrate SQL with COBOL to manage and manipulate data in relational databases. Practice these concepts with various SQL operations to become proficient in using embedded SQL in COBOL.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-cobol-and-databases'>&#x25C4;Introduction to COBOL and Databases</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Embedded SQL in COBOL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='database-access-techniques'>Database Access Techniques &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
