<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optimizing Code</title>

    <link rel="alternate" href="https://campusempresa.com/lua/optimizing-code" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/lua/optimizing-code" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/lua/optimizing-code" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/lua/optimizing-code" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/lua/optimizing-code" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='memory-management'>&#x25C4;Memory Management</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Optimizing Code</a>
	</div>
	<div class='col-4 text-end'>
					<a href='embedding-lua-in-c'>Embedding Lua in C &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Code Optimization</h1>
<div class='content'><p>Code optimization is the process of modifying code to make it more efficient. This can involve reducing the execution time, minimizing memory usage, or improving other performance metrics. In Lua, optimization can be particularly important due to its use in embedded systems and game development, where performance is critical.</p>
</div><h1>Basic Optimization Techniques</h1>
<div class='content'></div><h2>Avoiding Global Variables</h2>
<div class='content'><p>Global variables are slower to access than local variables because Lua has to look them up in the global table. Use local variables whenever possible.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gSW5lZmZpY2llbnQ6IHVzaW5nIGdsb2JhbCB2YXJpYWJsZXMKZnVuY3Rpb24gYWRkKGEsIGIpCiAgICByZXR1cm4gYSArIGIKZW5kCgotLSBFZmZpY2llbnQ6IHVzaW5nIGxvY2FsIHZhcmlhYmxlcwpsb2NhbCBmdW5jdGlvbiBhZGQoYSwgYikKICAgIHJldHVybiBhICsgYgplbmQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Inefficient: using global variables
function add(a, b)
    return a + b
end

-- Efficient: using local variables
local function add(a, b)
    return a + b
end</pre></div><div class='content'></div><h2>Using Local Functions</h2>
<div class='content'><p>Similar to variables, local functions are faster to call than global functions.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gSW5lZmZpY2llbnQ6IGdsb2JhbCBmdW5jdGlvbgpmdW5jdGlvbiBnbG9iYWxGdW5jdGlvbigpCiAgICAtLSBzb21lIGNvZGUKZW5kCgotLSBFZmZpY2llbnQ6IGxvY2FsIGZ1bmN0aW9uCmxvY2FsIGZ1bmN0aW9uIGxvY2FsRnVuY3Rpb24oKQogICAgLS0gc29tZSBjb2RlCmVuZA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Inefficient: global function
function globalFunction()
    -- some code
end

-- Efficient: local function
local function localFunction()
    -- some code
end</pre></div><div class='content'></div><h2>Loop Optimization</h2>
<div class='content'><p>Loops can be a significant source of inefficiency. Optimize loops by minimizing the work done inside them.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gSW5lZmZpY2llbnQ6IHJlY2FsY3VsYXRpbmcgbGVuZ3RoIGluIGVhY2ggaXRlcmF0aW9uCmZvciBpID0gMSwgI2FycmF5IGRvCiAgICAtLSBzb21lIGNvZGUKZW5kCgotLSBFZmZpY2llbnQ6IGNhbGN1bGF0ZSBsZW5ndGggb25jZQpsb2NhbCBsZW5ndGggPSAjYXJyYXkKZm9yIGkgPSAxLCBsZW5ndGggZG8KICAgIC0tIHNvbWUgY29kZQplbmQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Inefficient: recalculating length in each iteration
for i = 1, #array do
    -- some code
end

-- Efficient: calculate length once
local length = #array
for i = 1, length do
    -- some code
end</pre></div><div class='content'></div><h1>Intermediate Optimization Techniques</h1>
<div class='content'></div><h2>Table Optimization</h2>
<div class='content'><p>Tables are a fundamental data structure in Lua. Optimizing table usage can lead to significant performance gains.</p>
<ul>
<li><strong>Preallocate Table Size</strong>: If you know the size of the table in advance, preallocate it to avoid resizing.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gSW5lZmZpY2llbnQ6IGR5bmFtaWMgcmVzaXppbmcKbG9jYWwgdCA9IHt9CmZvciBpID0gMSwgMTAwMCBkbwogICAgdFtpXSA9IGkKZW5kCgotLSBFZmZpY2llbnQ6IHByZWFsbG9jYXRlIHNpemUKbG9jYWwgdCA9IHt9CmZvciBpID0gMSwgMTAwMCBkbwogICAgdFtpXSA9IGkKZW5k"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Inefficient: dynamic resizing
local t = {}
for i = 1, 1000 do
    t[i] = i
end

-- Efficient: preallocate size
local t = {}
for i = 1, 1000 do
    t[i] = i
end</pre></div><div class='content'><ul>
<li><strong>Use Numeric Indices</strong>: Numeric indices are faster to access than string keys.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gSW5lZmZpY2llbnQ6IHN0cmluZyBrZXlzCmxvY2FsIHQgPSB7YSA9IDEsIGIgPSAyLCBjID0gM30KCi0tIEVmZmljaWVudDogbnVtZXJpYyBpbmRpY2VzCmxvY2FsIHQgPSB7MSwgMiwgM30="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Inefficient: string keys
local t = {a = 1, b = 2, c = 3}

-- Efficient: numeric indices
local t = {1, 2, 3}</pre></div><div class='content'></div><h2>String Concatenation</h2>
<div class='content'><p>String concatenation can be slow if done repeatedly in a loop. Use table.concat for better performance.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gSW5lZmZpY2llbnQ6IGNvbmNhdGVuYXRpb24gaW4gYSBsb29wCmxvY2FsIHN0ciA9ICIiCmZvciBpID0gMSwgMTAwMCBkbwogICAgc3RyID0gc3RyIC4uICJhIgplbmQKCi0tIEVmZmljaWVudDogdXNlIHRhYmxlLmNvbmNhdApsb2NhbCB0ID0ge30KZm9yIGkgPSAxLCAxMDAwIGRvCiAgICB0W2ldID0gImEiCmVuZApsb2NhbCBzdHIgPSB0YWJsZS5jb25jYXQodCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Inefficient: concatenation in a loop
local str = &quot;&quot;
for i = 1, 1000 do
    str = str .. &quot;a&quot;
end

-- Efficient: use table.concat
local t = {}
for i = 1, 1000 do
    t[i] = &quot;a&quot;
end
local str = table.concat(t)</pre></div><div class='content'></div><h1>Advanced Optimization Techniques</h1>
<div class='content'></div><h2>Metatables and Metamethods</h2>
<div class='content'><p>Metatables and metamethods can be used to optimize object-oriented code by customizing the behavior of tables.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bG9jYWwgbXQgPSB7CiAgICBfX2luZGV4ID0gZnVuY3Rpb24odGFibGUsIGtleSkKICAgICAgICByZXR1cm4gImRlZmF1bHQiCiAgICBlbmQKfQoKbG9jYWwgdCA9IHNldG1ldGF0YWJsZSh7fSwgbXQpCnByaW50KHQuc29tZUtleSkgIC0tIE91dHB1dDogZGVmYXVsdA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>local mt = {
    __index = function(table, key)
        return &quot;default&quot;
    end
}

local t = setmetatable({}, mt)
print(t.someKey)  -- Output: default</pre></div><div class='content'></div><h2>JIT Compilation</h2>
<div class='content'><p>LuaJIT is a Just-In-Time Compiler for Lua that can significantly improve performance. Using LuaJIT can be an advanced optimization technique.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRXhhbXBsZSBvZiBMdWFKSVQgdXNhZ2UKbG9jYWwgZmZpID0gcmVxdWlyZSgiZmZpIikKZmZpLmNkZWZbWwogICAgZG91YmxlIHNpbihkb3VibGUgeCk7Cl1dCnByaW50KGZmaS5DLnNpbigzLjE0KSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Example of LuaJIT usage
local ffi = require(&quot;ffi&quot;)
ffi.cdef[[
    double sin(double x);
]]
print(ffi.C.sin(3.14))</pre></div><div class='content'></div><h2>Profiling and Benchmarking</h2>
<div class='content'><p>Profiling your code helps identify bottlenecks. Use Lua profilers to measure where your code spends the most time.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRXhhbXBsZSBvZiBzaW1wbGUgcHJvZmlsaW5nCmxvY2FsIHN0YXJ0VGltZSA9IG9zLmNsb2NrKCkKLS0gQ29kZSB0byBwcm9maWxlCmxvY2FsIGVuZFRpbWUgPSBvcy5jbG9jaygpCnByaW50KCJFbGFwc2VkIHRpbWU6ICIgLi4gKGVuZFRpbWUgLSBzdGFydFRpbWUpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Example of simple profiling
local startTime = os.clock()
-- Code to profile
local endTime = os.clock()
print(&quot;Elapsed time: &quot; .. (endTime - startTime))</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Optimizing Lua code involves a range of techniques from basic practices like avoiding global variables to advanced methods like using LuaJIT. By understanding and applying these techniques, you can write more efficient and performant Lua programs. Always remember to profile and benchmark your code to identify the most critical areas for optimization.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='memory-management'>&#x25C4;Memory Management</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Optimizing Code</a>
	</div>
	<div class='col-4 text-end'>
					<a href='embedding-lua-in-c'>Embedding Lua in C &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
