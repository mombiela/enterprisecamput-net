<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Provisioning with Ansible</title>

    <link rel="alternate" href="https://campusempresa.com/ansible/cloud-provisioning" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/ansible/cloud-provisioning" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/ansible/cloud-provisioning" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/ansible/cloud-provisioning" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/ansible/cloud-provisioning" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='network-automation'>&#x25C4;Network Automation</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Cloud Provisioning with Ansible</a>
	</div>
	<div class='col-4 text-end'>
					<a href='continuous-integration-and-continuous-deployment'>Continuous Integration and Continuous Deployment (CI/CD) &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Cloud Provisioning</h1>
<div class='content'><p>Cloud provisioning is the process of setting up and managing cloud resources. Ansible, a powerful automation tool, simplifies this process by allowing you to define your infrastructure as code. This section will guide you from the basics of cloud provisioning with Ansible to more advanced concepts.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Infrastructure as Code (IaC):</strong> Managing and provisioning computing infrastructure through machine-readable definition files.</li>
<li><strong>Playbooks:</strong> YAML files that define the tasks to be executed on remote machines.</li>
<li><strong>Modules:</strong> Reusable, standalone scripts that Ansible runs on your behalf.</li>
<li><strong>Inventory:</strong> A list of hosts or nodes that Ansible manages.</li>
<li><strong>Cloud Providers:</strong> Services like AWS, Azure, and Google Cloud that offer cloud computing resources.</li>
</ul>
</div><h1>Setting Up Ansible for Cloud Provisioning</h1>
<div class='content'><p>Before you start provisioning cloud resources, you need to set up Ansible and configure it to interact with your cloud provider.</p>
</div><h2>Installing Ansible</h2>
<div class='content'><p>To install Ansible, run the following command:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3VkbyBhcHQgdXBkYXRlCnN1ZG8gYXB0IGluc3RhbGwgYW5zaWJsZQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sudo apt update
sudo apt install ansible</pre></div><div class='content'></div><h2>Configuring Cloud Provider Credentials</h2>
<div class='content'><p>You need to configure your cloud provider credentials so that Ansible can interact with your cloud resources. For example, to configure AWS credentials, you can use the AWS CLI:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXdzIGNvbmZpZ3VyZQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>aws configure</pre></div><div class='content'><p>This command will prompt you to enter your AWS Access Key ID, Secret Access Key, region, and output format.</p>
</div><h1>Writing Your First Playbook for Cloud Provisioning</h1>
<div class='content'><p>A playbook is a YAML file that describes the tasks to be executed. Here’s a simple example of a playbook that provisions an EC2 instance on AWS.</p>
</div><h2>Example Playbook</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogUHJvdmlzaW9uIGFuIEVDMiBpbnN0YW5jZQogIGhvc3RzOiBsb2NhbGhvc3QKICBnYXRoZXJfZmFjdHM6IG5vCiAgdGFza3M6CiAgICAtIG5hbWU6IExhdW5jaCBFQzIgaW5zdGFuY2UKICAgICAgZWMyOgogICAgICAgIGtleV9uYW1lOiBteV9rZXkKICAgICAgICBpbnN0YW5jZV90eXBlOiB0Mi5taWNybwogICAgICAgIGltYWdlOiBhbWktMGM1NWIxNTljYmZhZmUxZjAKICAgICAgICB3YWl0OiB5ZXMKICAgICAgICByZWdpb246IHVzLXdlc3QtMgogICAgICAgIGNvdW50OiAxCiAgICAgIHJlZ2lzdGVyOiBlYzIKICAgIC0gbmFtZTogQWRkIG5ldyBpbnN0YW5jZSB0byBob3N0IGdyb3VwCiAgICAgIGFkZF9ob3N0OgogICAgICAgIGhvc3RuYW1lOiAie3sgaXRlbS5wdWJsaWNfaXAgfX0iCiAgICAgICAgZ3JvdXBuYW1lOiBsYXVuY2hlZAogICAgICB3aXRoX2l0ZW1zOiAie3sgZWMyLmluc3RhbmNlcyB9fSIKICAgIC0gbmFtZTogV2FpdCBmb3IgU1NIIHRvIGNvbWUgdXAKICAgICAgd2FpdF9mb3I6CiAgICAgICAgaG9zdDogInt7IGl0ZW0ucHVibGljX2lwIH19IgogICAgICAgIHBvcnQ6IDIyCiAgICAgICAgZGVsYXk6IDYwCiAgICAgICAgdGltZW91dDogMzIwCiAgICAgICAgc3RhdGU6IHN0YXJ0ZWQKICAgICAgd2l0aF9pdGVtczogInt7IGVjMi5pbnN0YW5jZXMgfX0i"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Provision an EC2 instance
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Launch EC2 instance
      ec2:
        key_name: my_key
        instance_type: t2.micro
        image: ami-0c55b159cbfafe1f0
        wait: yes
        region: us-west-2
        count: 1
      register: ec2
    - name: Add new instance to host group
      add_host:
        hostname: &quot;{{ item.public_ip }}&quot;
        groupname: launched
      with_items: &quot;{{ ec2.instances }}&quot;
    - name: Wait for SSH to come up
      wait_for:
        host: &quot;{{ item.public_ip }}&quot;
        port: 22
        delay: 60
        timeout: 320
        state: started
      with_items: &quot;{{ ec2.instances }}&quot;</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>hosts:</strong> Specifies the target hosts. Here, <code>localhost</code> is used because the provisioning is done from the local machine.</li>
<li><strong>gather_facts:</strong> Set to <code>no</code> to skip gathering facts about the localhost.</li>
<li><strong>tasks:</strong> A list of tasks to be executed.
<ul>
<li><strong>ec2:</strong> Launches an EC2 instance with the specified parameters.</li>
<li><strong>register:</strong> Stores the output of the EC2 module in a variable named <code>ec2</code>.</li>
<li><strong>add_host:</strong> Adds the new instance to a host group named <code>launched</code>.</li>
<li><strong>wait_for:</strong> Waits for SSH to be available on the new instance.</li>
</ul>
</li>
</ul>
</div><h1>Advanced Cloud Provisioning Techniques</h1>
<div class='content'><p>As you become more comfortable with Ansible, you can explore more advanced techniques for cloud provisioning.</p>
</div><h2>Dynamic Inventory</h2>
<div class='content'><p>Dynamic inventory allows Ansible to query cloud providers for the current state of resources. This is useful for managing environments where the infrastructure changes frequently.</p>
<h4>Example: AWS Dynamic Inventory</h4>
<p>To use dynamic inventory with AWS, you need to install the <code>boto3</code> and <code>botocore</code> Python libraries:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgYm90bzMgYm90b2NvcmU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install boto3 botocore</pre></div><div class='content'><p>Then, configure the <code>aws_ec2</code> plugin in your <code>ansible.cfg</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("W2RlZmF1bHRzXQppbnZlbnRvcnkgPSAuL2F3c19lYzIueW1s"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>[defaults]
inventory = ./aws_ec2.yml</pre></div><div class='content'><p>Create an <code>aws_ec2.yml</code> file:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGx1Z2luOiBhd3NfZWMyCnJlZ2lvbnM6CiAgLSB1cy13ZXN0LTIKZmlsdGVyczoKICBpbnN0YW5jZS1zdGF0ZS1uYW1lOiBydW5uaW5nCmtleWVkX2dyb3VwczoKICAtIGtleTogdGFncy5OYW1lCiAgICBwcmVmaXg6IHRhZw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>plugin: aws_ec2
regions:
  - us-west-2
filters:
  instance-state-name: running
keyed_groups:
  - key: tags.Name
    prefix: tag</pre></div><div class='content'></div><h2>Using Roles for Reusability</h2>
<div class='content'><p>Roles allow you to organize playbooks into reusable components. A role typically contains tasks, handlers, variables, files, and templates.</p>
<h4>Example Role Structure</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bXlfcm9sZS8K4pSc4pSA4pSAIHRhc2tzLwrilIIgICDilJTilIDilIAgbWFpbi55bWwK4pSc4pSA4pSAIGhhbmRsZXJzLwrilIIgICDilJTilIDilIAgbWFpbi55bWwK4pSc4pSA4pSAIHRlbXBsYXRlcy8K4pSCICAg4pSU4pSA4pSAIG15X3RlbXBsYXRlLmoyCuKUnOKUgOKUgCBmaWxlcy8K4pSCICAg4pSU4pSA4pSAIG15X2ZpbGUK4pSc4pSA4pSAIHZhcnMvCuKUgiAgIOKUlOKUgOKUgCBtYWluLnltbArilJzilIDilIAgZGVmYXVsdHMvCuKUgiAgIOKUlOKUgOKUgCBtYWluLnltbArilJzilIDilIAgbWV0YS8K4pSCICAg4pSU4pSA4pSAIG1haW4ueW1s"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>my_role/
├── tasks/
│   └── main.yml
├── handlers/
│   └── main.yml
├── templates/
│   └── my_template.j2
├── files/
│   └── my_file
├── vars/
│   └── main.yml
├── defaults/
│   └── main.yml
├── meta/
│   └── main.yml</pre></div><div class='content'></div><h2>Example Role Usage</h2>
<div class='content'><p>In your playbook, you can include a role as follows:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gaG9zdHM6IGxhdW5jaGVkCiAgcm9sZXM6CiAgICAtIG15X3JvbGU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- hosts: launched
  roles:
    - my_role</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Cloud provisioning with Ansible allows you to automate the setup and management of cloud resources efficiently. Starting from basic playbooks to advanced techniques like dynamic inventory and roles, Ansible provides powerful tools to manage your infrastructure as code. By mastering these concepts, you can streamline your cloud operations and ensure consistency across your environments.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='network-automation'>&#x25C4;Network Automation</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Cloud Provisioning with Ansible</a>
	</div>
	<div class='col-4 text-end'>
					<a href='continuous-integration-and-continuous-deployment'>Continuous Integration and Continuous Deployment (CI/CD) &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
