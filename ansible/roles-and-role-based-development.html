<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roles and Role-Based Development</title>

    <link rel="alternate" href="https://campusempresa.com/ansible/roles-and-role-based-development" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/ansible/roles-and-role-based-development" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/ansible/roles-and-role-based-development" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/ansible/roles-and-role-based-development" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/ansible/roles-and-role-based-development" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='templates-with-jinja2'>&#x25C4;Templates with Jinja2</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Roles and Role-Based Development</a>
	</div>
	<div class='col-4 text-end'>
					<a href='ansible-galaxy'>Ansible Galaxy &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Roles in Ansible</h1>
<div class='content'><p>Roles in Ansible are a way to group related tasks, variables, files, templates, and handlers into reusable units. They help in organizing playbooks and making them more maintainable and scalable.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Role Directory Structure</strong>: A standard layout for organizing files within a role.</li>
<li><strong>Reusability</strong>: Roles can be reused across different playbooks and projects.</li>
<li><strong>Modularity</strong>: Breaking down complex playbooks into smaller, manageable roles.</li>
</ul>
</div><h1>Creating and Using Roles</h1>
<h2>Role Directory Structure</h2>
<div class='content'><p>An Ansible role has a specific directory structure. Here’s an example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bXlfcm9sZS8K4pSc4pSA4pSAIGRlZmF1bHRzLwrilIIgICDilJTilIDilIAgbWFpbi55bWwK4pSc4pSA4pSAIGZpbGVzLwrilJzilIDilIAgaGFuZGxlcnMvCuKUgiAgIOKUlOKUgOKUgCBtYWluLnltbArilJzilIDilIAgbWV0YS8K4pSCICAg4pSU4pSA4pSAIG1haW4ueW1sCuKUnOKUgOKUgCB0YXNrcy8K4pSCICAg4pSU4pSA4pSAIG1haW4ueW1sCuKUnOKUgOKUgCB0ZW1wbGF0ZXMvCuKUnOKUgOKUgCB0ZXN0cy8K4pSCICAg4pSc4pSA4pSAIGludmVudG9yeQrilIIgICDilJTilIDilIAgdGVzdC55bWwK4pSU4pSA4pSAIHZhcnMvCiAgICDilJTilIDilIAgbWFpbi55bWw="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>my_role/
├── defaults/
│   └── main.yml
├── files/
├── handlers/
│   └── main.yml
├── meta/
│   └── main.yml
├── tasks/
│   └── main.yml
├── templates/
├── tests/
│   ├── inventory
│   └── test.yml
└── vars/
    └── main.yml</pre></div><div class='content'><ul>
<li><strong>defaults/main.yml</strong>: Default variables for the role.</li>
<li><strong>files/</strong>: Static files to be used in tasks.</li>
<li><strong>handlers/main.yml</strong>: Handlers triggered by tasks.</li>
<li><strong>meta/main.yml</strong>: Role metadata, including dependencies.</li>
<li><strong>tasks/main.yml</strong>: Main list of tasks to be executed by the role.</li>
<li><strong>templates/</strong>: Jinja2 templates to be used in tasks.</li>
<li><strong>tests/</strong>: Test playbooks and inventory for the role.</li>
<li><strong>vars/main.yml</strong>: Variables specific to the role.</li>
</ul>
</div><h2>Creating a Simple Role</h2>
<div class='content'><p>Let's create a simple role to install and configure Nginx.</p>
<ol>
<li>
<p><strong>Create the Role Directory Structure</strong>:</p>
<pre><code class="language-bash">ansible-galaxy init nginx_role
</code></pre>
</li>
<li>
<p><strong>Define Tasks in <code>tasks/main.yml</code></strong>:</p>
<pre><code class="language-yaml">---
- name: Install Nginx
  apt:
    name: nginx
    state: present

- name: Start Nginx service
  service:
    name: nginx
    state: started
    enabled: true
</code></pre>
</li>
<li>
<p><strong>Define Handlers in <code>handlers/main.yml</code></strong>:</p>
<pre><code class="language-yaml">---
- name: Restart Nginx
  service:
    name: nginx
    state: restarted
</code></pre>
</li>
<li>
<p><strong>Use the Role in a Playbook</strong>:</p>
<pre><code class="language-yaml">---
- hosts: webservers
  roles:
    - nginx_role
</code></pre>
</li>
</ol>
</div><h2>Using Variables in Roles</h2>
<div class='content'><p>Variables can be defined in <code>defaults/main.yml</code> or <code>vars/main.yml</code>. Here’s an example of using variables in a role:</p>
<ol>
<li>
<p><strong>Define Variables in <code>defaults/main.yml</code></strong>:</p>
<pre><code class="language-yaml">---
nginx_port: 80
</code></pre>
</li>
<li>
<p><strong>Use Variables in <code>tasks/main.yml</code></strong>:</p>
<pre><code class="language-yaml">---
- name: Install Nginx
  apt:
    name: nginx
    state: present

- name: Configure Nginx
  template:
    src: nginx.conf.j2
    dest: /etc/nginx/nginx.conf
  notify: Restart Nginx

- name: Start Nginx service
  service:
    name: nginx
    state: started
    enabled: true
</code></pre>
</li>
<li>
<p><strong>Create a Template in <code>templates/nginx.conf.j2</code></strong>:</p>
<pre><code class="language-nginx">server {
    listen {{ nginx_port }};
    server_name localhost;

    location / {
        root /var/www/html;
        index index.html index.htm;
    }
}
</code></pre>
</li>
</ol>
</div><h1>Advanced Role Features</h1>
<h2>Role Dependencies</h2>
<div class='content'><p>Roles can depend on other roles. Dependencies are defined in <code>meta/main.yml</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCmRlcGVuZGVuY2llczoKICAtIHsgcm9sZTogY29tbW9uLCBzb21lX3ZhcjogNDIgfQogIC0geyByb2xlOiBhcGFjaGUsIGFwYWNoZV9wb3J0OiA4MDgwIH0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
dependencies:
  - { role: common, some_var: 42 }
  - { role: apache, apache_port: 8080 }</pre></div><div class='content'></div><h2>Role Testing</h2>
<div class='content'><p>Testing roles ensures they work as expected. Use the <code>tests/</code> directory to create test playbooks and inventory files.</p>
<ol>
<li>
<p><strong>Create a Test Playbook in <code>tests/test.yml</code></strong>:</p>
<pre><code class="language-yaml">---
- hosts: localhost
  roles:
    - nginx_role
</code></pre>
</li>
<li>
<p><strong>Run the Test Playbook</strong>:</p>
<pre><code class="language-bash">ansible-playbook tests/test.yml
</code></pre>
</li>
</ol>
</div><h1>Conclusion</h1>
<div class='content'><p>Roles in Ansible provide a powerful way to organize and reuse code, making playbooks more modular and maintainable. By understanding the structure and usage of roles, you can create scalable and efficient automation scripts. Remember to leverage variables, handlers, and dependencies to maximize the flexibility and functionality of your roles.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='templates-with-jinja2'>&#x25C4;Templates with Jinja2</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Roles and Role-Based Development</a>
	</div>
	<div class='col-4 text-end'>
					<a href='ansible-galaxy'>Ansible Galaxy &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
