<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DStreams (Discretized Streams)</title>

    <link rel="alternate" href="https://campusempresa.com/apachespark/dstreams" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/apachespark/dstreams" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/apachespark/dstreams" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/apachespark/dstreams" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/apachespark/dstreams" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-spark-streaming'>&#x25C4;Introduction to Spark Streaming</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">DStreams (Discretized Streams)</a>
	</div>
	<div class='col-4 text-end'>
					<a href='window-operations'>Window Operations &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to DStreams</h1>
<div class='content'><p>DStreams, or Discretized Streams, are a fundamental concept in Apache Spark's streaming library, Spark Streaming. They represent a continuous stream of data divided into small, discrete batches.</p>
<ul>
<li><strong>Definition</strong>: DStreams are a sequence of RDDs (Resilient Distributed Datasets) representing a continuous stream of data.</li>
<li><strong>Purpose</strong>: They enable real-time data processing by breaking down the stream into manageable chunks.</li>
</ul>
</div><h1>Creating DStreams</h1>
<div class='content'><p>To create a DStream, you typically need a Spark Streaming context and a data source such as Kafka, TCP sockets, or files.</p>
</div><h2>Example: Creating a DStream from a TCP Socket</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrIGltcG9ydCBTcGFya0NvbnRleHQKZnJvbSBweXNwYXJrLnN0cmVhbWluZyBpbXBvcnQgU3RyZWFtaW5nQ29udGV4dAoKIyBDcmVhdGUgYSBsb2NhbCBTdHJlYW1pbmdDb250ZXh0IHdpdGggdHdvIHdvcmtpbmcgdGhyZWFkcyBhbmQgYmF0Y2ggaW50ZXJ2YWwgb2YgMSBzZWNvbmQKc2MgPSBTcGFya0NvbnRleHQoImxvY2FsWzJdIiwgIk5ldHdvcmtXb3JkQ291bnQiKQpzc2MgPSBTdHJlYW1pbmdDb250ZXh0KHNjLCAxKQoKIyBDcmVhdGUgYSBEU3RyZWFtIHRoYXQgd2lsbCBjb25uZWN0IHRvIGhvc3RuYW1lOnBvcnQsIGxpa2UgbG9jYWxob3N0Ojk5OTkKbGluZXMgPSBzc2Muc29ja2V0VGV4dFN0cmVhbSgibG9jYWxob3N0IiwgOTk5OSkKCiMgU3BsaXQgZWFjaCBsaW5lIGludG8gd29yZHMKd29yZHMgPSBsaW5lcy5mbGF0TWFwKGxhbWJkYSBsaW5lOiBsaW5lLnNwbGl0KCIgIikpCgojIENvdW50IGVhY2ggd29yZCBpbiBlYWNoIGJhdGNoCnBhaXJzID0gd29yZHMubWFwKGxhbWJkYSB3b3JkOiAod29yZCwgMSkpCndvcmRDb3VudHMgPSBwYWlycy5yZWR1Y2VCeUtleShsYW1iZGEgeCwgeTogeCArIHkpCgojIFByaW50IHRoZSBmaXJzdCB0ZW4gZWxlbWVudHMgb2YgZWFjaCBSREQgZ2VuZXJhdGVkIGluIHRoaXMgRFN0cmVhbSB0byB0aGUgY29uc29sZQp3b3JkQ291bnRzLnBwcmludCgpCgojIFN0YXJ0IHRoZSBjb21wdXRhdGlvbgpzc2Muc3RhcnQoKQoKIyBXYWl0IGZvciB0aGUgY29tcHV0YXRpb24gdG8gdGVybWluYXRlCnNzYy5hd2FpdFRlcm1pbmF0aW9uKCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark import SparkContext
from pyspark.streaming import StreamingContext

# Create a local StreamingContext with two working threads and batch interval of 1 second
sc = SparkContext(&quot;local[2]&quot;, &quot;NetworkWordCount&quot;)
ssc = StreamingContext(sc, 1)

# Create a DStream that will connect to hostname:port, like localhost:9999
lines = ssc.socketTextStream(&quot;localhost&quot;, 9999)

# Split each line into words
words = lines.flatMap(lambda line: line.split(&quot; &quot;))

# Count each word in each batch
pairs = words.map(lambda word: (word, 1))
wordCounts = pairs.reduceByKey(lambda x, y: x + y)

# Print the first ten elements of each RDD generated in this DStream to the console
wordCounts.pprint()

# Start the computation
ssc.start()

# Wait for the computation to terminate
ssc.awaitTermination()</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>SparkContext</code> and <code>StreamingContext</code> are initialized.</li>
<li>A DStream is created from a TCP socket.</li>
<li>The stream is processed to count words in each batch.</li>
<li>The results are printed to the console.</li>
</ul>
</li>
</ul>
</div><h1>Transformations on DStreams</h1>
<div class='content'><p>DStreams support various transformations similar to RDDs, such as <code>map</code>, <code>flatMap</code>, <code>filter</code>, <code>reduceByKey</code>, and <code>window</code>.</p>
</div><h2>Example: Applying Transformations</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBGaWx0ZXIgbGluZXMgdGhhdCBjb250YWluIHRoZSB3b3JkICJlcnJvciIKZXJyb3JzID0gbGluZXMuZmlsdGVyKGxhbWJkYSBsaW5lOiAiZXJyb3IiIGluIGxpbmUpCgojIENvdW50IHRoZSBudW1iZXIgb2YgZXJyb3JzIGluIGVhY2ggYmF0Y2gKZXJyb3JDb3VudHMgPSBlcnJvcnMuY291bnQoKQoKIyBQcmludCB0aGUgY291bnQgb2YgZXJyb3JzCmVycm9yQ291bnRzLnBwcmludCgp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Filter lines that contain the word &quot;error&quot;
errors = lines.filter(lambda line: &quot;error&quot; in line)

# Count the number of errors in each batch
errorCounts = errors.count()

# Print the count of errors
errorCounts.pprint()</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li>The <code>filter</code> transformation filters lines containing the word &quot;error&quot;.</li>
<li>The <code>count</code> transformation counts the number of such lines in each batch.</li>
</ul>
</li>
</ul>
</div><h1>Window Operations</h1>
<div class='content'><p>Window operations allow you to apply transformations over a sliding window of data.</p>
</div><h2>Example: Windowed Word Count</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDb3VudCB3b3JkcyBvdmVyIGEgMzAtc2Vjb25kIHdpbmRvdyBzbGlkaW5nIGV2ZXJ5IDEwIHNlY29uZHMKd2luZG93ZWRXb3JkQ291bnRzID0gcGFpcnMucmVkdWNlQnlLZXlBbmRXaW5kb3cobGFtYmRhIHgsIHk6IHggKyB5LCAzMCwgMTApCgojIFByaW50IHRoZSB3b3JkIGNvdW50cwp3aW5kb3dlZFdvcmRDb3VudHMucHByaW50KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Count words over a 30-second window sliding every 10 seconds
windowedWordCounts = pairs.reduceByKeyAndWindow(lambda x, y: x + y, 30, 10)

# Print the word counts
windowedWordCounts.pprint()</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>reduceByKeyAndWindow</code> applies the word count over a 30-second window, sliding every 10 seconds.</li>
</ul>
</li>
</ul>
</div><h1>Output Operations</h1>
<div class='content'><p>Output operations allow you to push the processed data to external systems like databases, dashboards, or files.</p>
</div><h2>Example: Saving DStream Output to Text Files</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTYXZlIGVhY2ggUkREIGluIHRoZSBEU3RyZWFtIHRvIGEgdGV4dCBmaWxlCndvcmRDb3VudHMuc2F2ZUFzVGV4dEZpbGVzKCJvdXRwdXQvd29yZENvdW50cyIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Save each RDD in the DStream to a text file
wordCounts.saveAsTextFiles(&quot;output/wordCounts&quot;)</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>saveAsTextFiles</code> saves each RDD in the DStream to text files in the specified directory.</li>
</ul>
</li>
</ul>
</div><h1>Advanced Concepts</h1>
<h2>Checkpointing</h2>
<div class='content'><p>Checkpointing is crucial for fault tolerance in streaming applications. It saves the state of the DStream to a reliable storage.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3NjLmNoZWNrcG9pbnQoImNoZWNrcG9pbnQtZGlyZWN0b3J5Iik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ssc.checkpoint(&quot;checkpoint-directory&quot;)</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>checkpoint</code> sets the directory where the state will be saved.</li>
</ul>
</li>
</ul>
</div><h2>Stateful Transformations</h2>
<div class='content'><p>Stateful transformations allow you to maintain state across batches.</p>
</div><h2>Example: Stateful Word Count</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIHVwZGF0ZUZ1bmN0aW9uKG5ld1ZhbHVlcywgcnVubmluZ0NvdW50KToKICAgIHJldHVybiBzdW0obmV3VmFsdWVzKSArIChydW5uaW5nQ291bnQgb3IgMCkKCnJ1bm5pbmdDb3VudHMgPSBwYWlycy51cGRhdGVTdGF0ZUJ5S2V5KHVwZGF0ZUZ1bmN0aW9uKQoKIyBQcmludCB0aGUgcnVubmluZyBjb3VudHMKcnVubmluZ0NvdW50cy5wcHJpbnQoKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def updateFunction(newValues, runningCount):
    return sum(newValues) + (runningCount or 0)

runningCounts = pairs.updateStateByKey(updateFunction)

# Print the running counts
runningCounts.pprint()</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>updateStateByKey</code> maintains a running count of words across batches using the provided update function.</li>
</ul>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>DStreams are a powerful abstraction in Spark Streaming for real-time data processing. By understanding how to create, transform, and output DStreams, you can build robust streaming applications. Advanced features like window operations, checkpointing, and stateful transformations further enhance the capabilities of DStreams, making them suitable for a wide range of real-time analytics tasks.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-spark-streaming'>&#x25C4;Introduction to Spark Streaming</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">DStreams (Discretized Streams)</a>
	</div>
	<div class='col-4 text-end'>
					<a href='window-operations'>Window Operations &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
