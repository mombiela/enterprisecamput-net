<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction to Spark MLlib</title>

    <link rel="alternate" href="https://campusempresa.com/apachespark/introduction-to-spark-mllib" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/apachespark/introduction-to-spark-mllib" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/apachespark/introduction-to-spark-mllib" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/apachespark/introduction-to-spark-mllib" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/apachespark/introduction-to-spark-mllib" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='structured-streaming'>&#x25C4;Structured Streaming</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Introduction to Spark MLlib</a>
	</div>
	<div class='col-4 text-end'>
					<a href='basic-statistics'>Basic Statistics &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Apache Spark MLlib is a scalable machine learning library that provides various algorithms and utilities for machine learning tasks. This section will introduce you to the basics of Spark MLlib, its key components, and how to use it for building machine learning models.</p>
</div><h1>What is Spark MLlib?</h1>
<div class='content'><p>Spark MLlib is a library within Apache Spark that provides:</p>
<ul>
<li><strong>Scalable machine learning algorithms</strong>: Including classification, regression, clustering, and collaborative filtering.</li>
<li><strong>Tools for feature extraction, transformation, and selection</strong>.</li>
<li><strong>Pipelines</strong>: For building and tuning machine learning workflows.</li>
<li><strong>Utilities</strong>: For saving and loading models, evaluating models, and working with data.</li>
</ul>
</div><h1>Key Concepts in Spark MLlib</h1>
<div class='content'><ul>
<li><strong>DataFrames</strong>: The primary data structure used in Spark MLlib for handling data.</li>
<li><strong>Transformers</strong>: Objects that transform DataFrames into other DataFrames.</li>
<li><strong>Estimators</strong>: Algorithms that can be fit on DataFrames to produce Transformers.</li>
<li><strong>Pipelines</strong>: Sequences of Transformers and Estimators to streamline the machine learning workflow.</li>
</ul>
</div><h1>Setting Up Spark MLlib</h1>
<div class='content'><p>Before diving into Spark MLlib, ensure you have Apache Spark installed. You can install it using the following command:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgcHlzcGFyaw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install pyspark</pre></div><div class='content'></div><h1>Basic Workflow in Spark MLlib</h1>
<div class='content'><ol>
<li><strong>Load and Prepare Data</strong>: Load data into a DataFrame and prepare it for analysis.</li>
<li><strong>Feature Engineering</strong>: Transform raw data into features suitable for machine learning.</li>
<li><strong>Model Training</strong>: Train a machine learning model using an Estimator.</li>
<li><strong>Model Evaluation</strong>: Evaluate the model's performance.</li>
<li><strong>Model Tuning</strong>: Optimize the model parameters.</li>
<li><strong>Model Deployment</strong>: Save and load the model for future use.</li>
</ol>
</div><h1>Example: Linear Regression with Spark MLlib</h1>
<div class='content'></div><h2>Step 1: Load and Prepare Data</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaXRpYWxpemUgU3Bhcmsgc2Vzc2lvbgpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIkxpbmVhclJlZ3Jlc3Npb25FeGFtcGxlIikuZ2V0T3JDcmVhdGUoKQoKIyBMb2FkIGRhdGEKZGF0YSA9IHNwYXJrLnJlYWQuY3N2KCJkYXRhLmNzdiIsIGhlYWRlcj1UcnVlLCBpbmZlclNjaGVtYT1UcnVlKQoKIyBEaXNwbGF5IHRoZSBmaXJzdCBmZXcgcm93cyBvZiB0aGUgRGF0YUZyYW1lCmRhdGEuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Initialize Spark session
spark = SparkSession.builder.appName(&quot;LinearRegressionExample&quot;).getOrCreate()

# Load data
data = spark.read.csv(&quot;data.csv&quot;, header=True, inferSchema=True)

# Display the first few rows of the DataFrame
data.show()</pre></div><div class='content'></div><h2>Step 2: Feature Engineering</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmZlYXR1cmUgaW1wb3J0IFZlY3RvckFzc2VtYmxlcgoKIyBBc3NlbWJsZSBmZWF0dXJlcyBpbnRvIGEgc2luZ2xlIHZlY3Rvcgphc3NlbWJsZXIgPSBWZWN0b3JBc3NlbWJsZXIoaW5wdXRDb2xzPVsiZmVhdHVyZTEiLCAiZmVhdHVyZTIiXSwgb3V0cHV0Q29sPSJmZWF0dXJlcyIpCmRhdGEgPSBhc3NlbWJsZXIudHJhbnNmb3JtKGRhdGEpCgojIERpc3BsYXkgdGhlIHRyYW5zZm9ybWVkIERhdGFGcmFtZQpkYXRhLnNob3coKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.feature import VectorAssembler

# Assemble features into a single vector
assembler = VectorAssembler(inputCols=[&quot;feature1&quot;, &quot;feature2&quot;], outputCol=&quot;features&quot;)
data = assembler.transform(data)

# Display the transformed DataFrame
data.show()</pre></div><div class='content'></div><h2>Step 3: Model Training</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLnJlZ3Jlc3Npb24gaW1wb3J0IExpbmVhclJlZ3Jlc3Npb24KCiMgSW5pdGlhbGl6ZSB0aGUgTGluZWFyIFJlZ3Jlc3Npb24gbW9kZWwKbHIgPSBMaW5lYXJSZWdyZXNzaW9uKGZlYXR1cmVzQ29sPSJmZWF0dXJlcyIsIGxhYmVsQ29sPSJsYWJlbCIpCgojIEZpdCB0aGUgbW9kZWwKbHJfbW9kZWwgPSBsci5maXQoZGF0YSkKCiMgRGlzcGxheSBtb2RlbCBjb2VmZmljaWVudHMgYW5kIGludGVyY2VwdApwcmludChmIkNvZWZmaWNpZW50czoge2xyX21vZGVsLmNvZWZmaWNpZW50c30iKQpwcmludChmIkludGVyY2VwdDoge2xyX21vZGVsLmludGVyY2VwdH0iKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.regression import LinearRegression

# Initialize the Linear Regression model
lr = LinearRegression(featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;)

# Fit the model
lr_model = lr.fit(data)

# Display model coefficients and intercept
print(f&quot;Coefficients: {lr_model.coefficients}&quot;)
print(f&quot;Intercept: {lr_model.intercept}&quot;)</pre></div><div class='content'></div><h2>Step 4: Model Evaluation</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmV2YWx1YXRpb24gaW1wb3J0IFJlZ3Jlc3Npb25FdmFsdWF0b3IKCiMgTWFrZSBwcmVkaWN0aW9ucwpwcmVkaWN0aW9ucyA9IGxyX21vZGVsLnRyYW5zZm9ybShkYXRhKQoKIyBJbml0aWFsaXplIGV2YWx1YXRvcgpldmFsdWF0b3IgPSBSZWdyZXNzaW9uRXZhbHVhdG9yKHByZWRpY3Rpb25Db2w9InByZWRpY3Rpb24iLCBsYWJlbENvbD0ibGFiZWwiLCBtZXRyaWNOYW1lPSJybXNlIikKCiMgRXZhbHVhdGUgdGhlIG1vZGVsCnJtc2UgPSBldmFsdWF0b3IuZXZhbHVhdGUocHJlZGljdGlvbnMpCnByaW50KGYiUm9vdCBNZWFuIFNxdWFyZWQgRXJyb3IgKFJNU0UpOiB7cm1zZX0iKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.evaluation import RegressionEvaluator

# Make predictions
predictions = lr_model.transform(data)

# Initialize evaluator
evaluator = RegressionEvaluator(predictionCol=&quot;prediction&quot;, labelCol=&quot;label&quot;, metricName=&quot;rmse&quot;)

# Evaluate the model
rmse = evaluator.evaluate(predictions)
print(f&quot;Root Mean Squared Error (RMSE): {rmse}&quot;)</pre></div><div class='content'></div><h2>Step 5: Model Tuning (Optional)</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLnR1bmluZyBpbXBvcnQgUGFyYW1HcmlkQnVpbGRlciwgQ3Jvc3NWYWxpZGF0b3IKCiMgQ3JlYXRlIHBhcmFtZXRlciBncmlkCnBhcmFtR3JpZCA9IFBhcmFtR3JpZEJ1aWxkZXIoKS5hZGRHcmlkKGxyLnJlZ1BhcmFtLCBbMC4xLCAwLjAxXSkuYnVpbGQoKQoKIyBJbml0aWFsaXplIENyb3NzVmFsaWRhdG9yCmNyb3NzdmFsID0gQ3Jvc3NWYWxpZGF0b3IoZXN0aW1hdG9yPWxyLCBlc3RpbWF0b3JQYXJhbU1hcHM9cGFyYW1HcmlkLCBldmFsdWF0b3I9ZXZhbHVhdG9yLCBudW1Gb2xkcz0zKQoKIyBSdW4gY3Jvc3MtdmFsaWRhdGlvbgpjdl9tb2RlbCA9IGNyb3NzdmFsLmZpdChkYXRhKQoKIyBHZXQgdGhlIGJlc3QgbW9kZWwKYmVzdF9tb2RlbCA9IGN2X21vZGVsLmJlc3RNb2RlbApwcmludChmIkJlc3QgTW9kZWwgQ29lZmZpY2llbnRzOiB7YmVzdF9tb2RlbC5jb2VmZmljaWVudHN9IikKcHJpbnQoZiJCZXN0IE1vZGVsIEludGVyY2VwdDoge2Jlc3RfbW9kZWwuaW50ZXJjZXB0fSIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.tuning import ParamGridBuilder, CrossValidator

# Create parameter grid
paramGrid = ParamGridBuilder().addGrid(lr.regParam, [0.1, 0.01]).build()

# Initialize CrossValidator
crossval = CrossValidator(estimator=lr, estimatorParamMaps=paramGrid, evaluator=evaluator, numFolds=3)

# Run cross-validation
cv_model = crossval.fit(data)

# Get the best model
best_model = cv_model.bestModel
print(f&quot;Best Model Coefficients: {best_model.coefficients}&quot;)
print(f&quot;Best Model Intercept: {best_model.intercept}&quot;)</pre></div><div class='content'></div><h2>Step 6: Model Deployment</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTYXZlIHRoZSBtb2RlbApiZXN0X21vZGVsLnNhdmUoImxpbmVhcl9yZWdyZXNzaW9uX21vZGVsIikKCiMgTG9hZCB0aGUgbW9kZWwKZnJvbSBweXNwYXJrLm1sLnJlZ3Jlc3Npb24gaW1wb3J0IExpbmVhclJlZ3Jlc3Npb25Nb2RlbApsb2FkZWRfbW9kZWwgPSBMaW5lYXJSZWdyZXNzaW9uTW9kZWwubG9hZCgibGluZWFyX3JlZ3Jlc3Npb25fbW9kZWwiKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Save the model
best_model.save(&quot;linear_regression_model&quot;)

# Load the model
from pyspark.ml.regression import LinearRegressionModel
loaded_model = LinearRegressionModel.load(&quot;linear_regression_model&quot;)</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we introduced Spark MLlib and its key components. We walked through a basic workflow for building a machine learning model using Spark MLlib, including loading data, feature engineering, model training, evaluation, tuning, and deployment. With this foundation, you can start exploring more advanced features and algorithms provided by Spark MLlib to build scalable machine learning applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='structured-streaming'>&#x25C4;Structured Streaming</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Introduction to Spark MLlib</a>
	</div>
	<div class='col-4 text-end'>
					<a href='basic-statistics'>Basic Statistics &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
