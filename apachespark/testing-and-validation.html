<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Testing and Validation</title>

    <link rel="alternate" href="https://campusempresa.com/apachespark/testing-and-validation" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/apachespark/testing-and-validation" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/apachespark/testing-and-validation" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/apachespark/testing-and-validation" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/apachespark/testing-and-validation" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='implementation-and-development'>&#x25C4;Implementation and Development</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Testing and Validation</a>
	</div>
	<div class='col-4 text-end'>
					<a href='final-presentation-and-submission'>Final Presentation and Submission &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Testing and validation are crucial aspects of developing robust and reliable applications using Apache Spark. This topic will guide you through the essentials of testing and validating Spark applications, from basic concepts to advanced techniques.</p>
</div><h1>Introduction to Testing in Apache Spark</h1>
<div class='content'><p>Testing ensures that your Spark applications work as expected and helps catch bugs early in the development process.</p>
<ul>
<li><strong>Unit Testing</strong>: Testing individual components or functions.</li>
<li><strong>Integration Testing</strong>: Testing the interaction between different components.</li>
<li><strong>End-to-End Testing</strong>: Testing the entire application workflow.</li>
</ul>
</div><h1>Setting Up the Testing Environment</h1>
<div class='content'><p>Before diving into testing, you need to set up your environment.</p>
<ul>
<li><strong>Dependencies</strong>: Ensure you have the necessary libraries.
<ul>
<li><code>spark-core</code></li>
<li><code>spark-sql</code></li>
<li><code>spark-mllib</code> (if using machine learning)</li>
<li>Testing libraries like <code>ScalaTest</code> or <code>JUnit</code></li>
</ul>
</li>
</ul>
</div><h2>Example: Adding Dependencies in `build.sbt`</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bGlicmFyeURlcGVuZGVuY2llcyArKz0gU2VxKAogICJvcmcuYXBhY2hlLnNwYXJrIiAlJSAic3BhcmstY29yZSIgJSAiMy4xLjIiICUgInByb3ZpZGVkIiwKICAib3JnLmFwYWNoZS5zcGFyayIgJSUgInNwYXJrLXNxbCIgJSAiMy4xLjIiICUgInByb3ZpZGVkIiwKICAib3JnLnNjYWxhdGVzdCIgJSUgInNjYWxhdGVzdCIgJSAiMy4yLjkiICUgInRlc3QiCik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>libraryDependencies ++= Seq(
  &quot;org.apache.spark&quot; %% &quot;spark-core&quot; % &quot;3.1.2&quot; % &quot;provided&quot;,
  &quot;org.apache.spark&quot; %% &quot;spark-sql&quot; % &quot;3.1.2&quot; % &quot;provided&quot;,
  &quot;org.scalatest&quot; %% &quot;scalatest&quot; % &quot;3.2.9&quot; % &quot;test&quot;
)</pre></div><div class='content'></div><h1>Unit Testing</h1>
<div class='content'><p>Unit testing focuses on testing individual components of your Spark application.</p>
<ul>
<li><strong>SparkSession</strong>: Create a local SparkSession for testing.</li>
<li><strong>DataFrame/Dataset Operations</strong>: Test transformations and actions.</li>
</ul>
</div><h2>Example: Unit Testing a DataFrame Transformation</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuc3Bhcmsuc3FsLlNwYXJrU2Vzc2lvbgppbXBvcnQgb3JnLnNjYWxhdGVzdC5mdW5zdWl0ZS5BbnlGdW5TdWl0ZQoKY2xhc3MgRGF0YUZyYW1lVGVzdCBleHRlbmRzIEFueUZ1blN1aXRlIHsKICB2YWwgc3BhcmsgPSBTcGFya1Nlc3Npb24uYnVpbGRlcigpCiAgICAuYXBwTmFtZSgiRGF0YUZyYW1lIFRlc3QiKQogICAgLm1hc3RlcigibG9jYWwiKQogICAgLmdldE9yQ3JlYXRlKCkKCiAgaW1wb3J0IHNwYXJrLmltcGxpY2l0cy5fCgogIHRlc3QoImZpbHRlcmluZyBEYXRhRnJhbWUiKSB7CiAgICB2YWwgZGYgPSBTZXEoKDEsICJBbGljZSIpLCAoMiwgIkJvYiIpLCAoMywgIkNoYXJsaWUiKSkudG9ERigiaWQiLCAibmFtZSIpCiAgICB2YWwgZmlsdGVyZWRERiA9IGRmLmZpbHRlcigkImlkIiA+IDEpCiAgICAKICAgIHZhbCBleHBlY3RlZERGID0gU2VxKCgyLCAiQm9iIiksICgzLCAiQ2hhcmxpZSIpKS50b0RGKCJpZCIsICJuYW1lIikKICAgIAogICAgYXNzZXJ0KGZpbHRlcmVkREYuY29sbGVjdCgpIHNhbWVFbGVtZW50cyBleHBlY3RlZERGLmNvbGxlY3QoKSkKICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.spark.sql.SparkSession
import org.scalatest.funsuite.AnyFunSuite

class DataFrameTest extends AnyFunSuite {
  val spark = SparkSession.builder()
    .appName(&quot;DataFrame Test&quot;)
    .master(&quot;local&quot;)
    .getOrCreate()

  import spark.implicits._

  test(&quot;filtering DataFrame&quot;) {
    val df = Seq((1, &quot;Alice&quot;), (2, &quot;Bob&quot;), (3, &quot;Charlie&quot;)).toDF(&quot;id&quot;, &quot;name&quot;)
    val filteredDF = df.filter($&quot;id&quot; &gt; 1)
    
    val expectedDF = Seq((2, &quot;Bob&quot;), (3, &quot;Charlie&quot;)).toDF(&quot;id&quot;, &quot;name&quot;)
    
    assert(filteredDF.collect() sameElements expectedDF.collect())
  }
}</pre></div><div class='content'></div><h1>Integration Testing</h1>
<div class='content'><p>Integration testing ensures that different components of your Spark application work together as expected.</p>
<ul>
<li><strong>Testing Data Pipelines</strong>: Validate the flow of data through multiple transformations.</li>
<li><strong>External Systems</strong>: Test interactions with databases, file systems, etc.</li>
</ul>
</div><h2>Example: Integration Testing a Data Pipeline</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuc3Bhcmsuc3FsLlNwYXJrU2Vzc2lvbgppbXBvcnQgb3JnLnNjYWxhdGVzdC5mdW5zdWl0ZS5BbnlGdW5TdWl0ZQoKY2xhc3MgRGF0YVBpcGVsaW5lVGVzdCBleHRlbmRzIEFueUZ1blN1aXRlIHsKICB2YWwgc3BhcmsgPSBTcGFya1Nlc3Npb24uYnVpbGRlcigpCiAgICAuYXBwTmFtZSgiRGF0YSBQaXBlbGluZSBUZXN0IikKICAgIC5tYXN0ZXIoImxvY2FsIikKICAgIC5nZXRPckNyZWF0ZSgpCgogIGltcG9ydCBzcGFyay5pbXBsaWNpdHMuXwoKICB0ZXN0KCJkYXRhIHBpcGVsaW5lIikgewogICAgdmFsIGlucHV0REYgPSBTZXEoKDEsICJBbGljZSIpLCAoMiwgIkJvYiIpLCAoMywgIkNoYXJsaWUiKSkudG9ERigiaWQiLCAibmFtZSIpCiAgICB2YWwgdHJhbnNmb3JtZWRERiA9IGlucHV0REYuZmlsdGVyKCQiaWQiID4gMSkud2l0aENvbHVtbigibmFtZV9sZW5ndGgiLCBsZW5ndGgoJCJuYW1lIikpCiAgICAKICAgIHZhbCBleHBlY3RlZERGID0gU2VxKCgyLCAiQm9iIiwgMyksICgzLCAiQ2hhcmxpZSIsIDcpKS50b0RGKCJpZCIsICJuYW1lIiwgIm5hbWVfbGVuZ3RoIikKICAgIAogICAgYXNzZXJ0KHRyYW5zZm9ybWVkREYuY29sbGVjdCgpIHNhbWVFbGVtZW50cyBleHBlY3RlZERGLmNvbGxlY3QoKSkKICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.spark.sql.SparkSession
import org.scalatest.funsuite.AnyFunSuite

class DataPipelineTest extends AnyFunSuite {
  val spark = SparkSession.builder()
    .appName(&quot;Data Pipeline Test&quot;)
    .master(&quot;local&quot;)
    .getOrCreate()

  import spark.implicits._

  test(&quot;data pipeline&quot;) {
    val inputDF = Seq((1, &quot;Alice&quot;), (2, &quot;Bob&quot;), (3, &quot;Charlie&quot;)).toDF(&quot;id&quot;, &quot;name&quot;)
    val transformedDF = inputDF.filter($&quot;id&quot; &gt; 1).withColumn(&quot;name_length&quot;, length($&quot;name&quot;))
    
    val expectedDF = Seq((2, &quot;Bob&quot;, 3), (3, &quot;Charlie&quot;, 7)).toDF(&quot;id&quot;, &quot;name&quot;, &quot;name_length&quot;)
    
    assert(transformedDF.collect() sameElements expectedDF.collect())
  }
}</pre></div><div class='content'></div><h1>End-to-End Testing</h1>
<div class='content'><p>End-to-end testing validates the entire application workflow, from data ingestion to final output.</p>
<ul>
<li><strong>Simulating Real Scenarios</strong>: Use realistic data and scenarios.</li>
<li><strong>Performance Testing</strong>: Ensure the application performs well under load.</li>
</ul>
</div><h2>Example: End-to-End Testing</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuc3Bhcmsuc3FsLlNwYXJrU2Vzc2lvbgppbXBvcnQgb3JnLnNjYWxhdGVzdC5mdW5zdWl0ZS5BbnlGdW5TdWl0ZQoKY2xhc3MgRW5kVG9FbmRUZXN0IGV4dGVuZHMgQW55RnVuU3VpdGUgewogIHZhbCBzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyKCkKICAgIC5hcHBOYW1lKCJFbmQtdG8tRW5kIFRlc3QiKQogICAgLm1hc3RlcigibG9jYWwiKQogICAgLmdldE9yQ3JlYXRlKCkKCiAgaW1wb3J0IHNwYXJrLmltcGxpY2l0cy5fCgogIHRlc3QoImVuZC10by1lbmQgd29ya2Zsb3ciKSB7CiAgICAvLyBTdGVwIDE6IERhdGEgSW5nZXN0aW9uCiAgICB2YWwgaW5wdXRERiA9IHNwYXJrLnJlYWQub3B0aW9uKCJoZWFkZXIiLCAidHJ1ZSIpLmNzdigicGF0aC90by9pbnB1dC5jc3YiKQogICAgCiAgICAvLyBTdGVwIDI6IERhdGEgVHJhbnNmb3JtYXRpb24KICAgIHZhbCB0cmFuc2Zvcm1lZERGID0gaW5wdXRERi5maWx0ZXIoJCJhZ2UiID4gMTgpLndpdGhDb2x1bW4oImFnZV9ncm91cCIsIHdoZW4oJCJhZ2UiIDwgMzAsICJZb3VuZyIpLm90aGVyd2lzZSgiQWR1bHQiKSkKICAgIAogICAgLy8gU3RlcCAzOiBEYXRhIE91dHB1dAogICAgdHJhbnNmb3JtZWRERi53cml0ZS5tb2RlKCJvdmVyd3JpdGUiKS5jc3YoInBhdGgvdG8vb3V0cHV0LmNzdiIpCiAgICAKICAgIC8vIFZhbGlkYXRlIHRoZSBvdXRwdXQKICAgIHZhbCBvdXRwdXRERiA9IHNwYXJrLnJlYWQub3B0aW9uKCJoZWFkZXIiLCAidHJ1ZSIpLmNzdigicGF0aC90by9vdXRwdXQuY3N2IikKICAgIHZhbCBleHBlY3RlZERGID0gU2VxKCgiQWxpY2UiLCAyNSwgIllvdW5nIiksICgiQm9iIiwgMzUsICJBZHVsdCIpKS50b0RGKCJuYW1lIiwgImFnZSIsICJhZ2VfZ3JvdXAiKQogICAgCiAgICBhc3NlcnQob3V0cHV0REYuY29sbGVjdCgpIHNhbWVFbGVtZW50cyBleHBlY3RlZERGLmNvbGxlY3QoKSkKICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.spark.sql.SparkSession
import org.scalatest.funsuite.AnyFunSuite

class EndToEndTest extends AnyFunSuite {
  val spark = SparkSession.builder()
    .appName(&quot;End-to-End Test&quot;)
    .master(&quot;local&quot;)
    .getOrCreate()

  import spark.implicits._

  test(&quot;end-to-end workflow&quot;) {
    // Step 1: Data Ingestion
    val inputDF = spark.read.option(&quot;header&quot;, &quot;true&quot;).csv(&quot;path/to/input.csv&quot;)
    
    // Step 2: Data Transformation
    val transformedDF = inputDF.filter($&quot;age&quot; &gt; 18).withColumn(&quot;age_group&quot;, when($&quot;age&quot; &lt; 30, &quot;Young&quot;).otherwise(&quot;Adult&quot;))
    
    // Step 3: Data Output
    transformedDF.write.mode(&quot;overwrite&quot;).csv(&quot;path/to/output.csv&quot;)
    
    // Validate the output
    val outputDF = spark.read.option(&quot;header&quot;, &quot;true&quot;).csv(&quot;path/to/output.csv&quot;)
    val expectedDF = Seq((&quot;Alice&quot;, 25, &quot;Young&quot;), (&quot;Bob&quot;, 35, &quot;Adult&quot;)).toDF(&quot;name&quot;, &quot;age&quot;, &quot;age_group&quot;)
    
    assert(outputDF.collect() sameElements expectedDF.collect())
  }
}</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Testing and validation are essential for building reliable Spark applications. By incorporating unit, integration, and end-to-end testing into your development process, you can ensure that your applications are robust and perform well in production environments. Remember to:</p>
<ul>
<li>Set up a proper testing environment.</li>
<li>Write comprehensive unit tests for individual components.</li>
<li>Validate the integration of different components.</li>
<li>Perform end-to-end testing to simulate real-world scenarios.</li>
</ul>
<p>By following these practices, you'll be well-equipped to develop high-quality Spark applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='implementation-and-development'>&#x25C4;Implementation and Development</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Testing and Validation</a>
	</div>
	<div class='col-4 text-end'>
					<a href='final-presentation-and-submission'>Final Presentation and Submission &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
