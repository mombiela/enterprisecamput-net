<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case Study: Machine Learning Pipeline</title>

    <link rel="alternate" href="https://campusempresa.com/apachespark/case-study-machine-learning-pipeline" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/apachespark/case-study-machine-learning-pipeline" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/apachespark/case-study-machine-learning-pipeline" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/apachespark/case-study-machine-learning-pipeline" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/apachespark/case-study-machine-learning-pipeline" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='case-study-real-time-data-processing'>&#x25C4;Case Study: Real-Time Data Processing</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Case Study: Machine Learning Pipeline</a>
	</div>
	<div class='col-4 text-end'>
					<a href='case-study-graph-processing'>Case Study: Graph Processing &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this section, we will explore how to build a machine learning pipeline using Apache Spark. This case study will guide you through the process from data ingestion to model deployment, covering key concepts and providing practical examples.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Data Ingestion</strong>: Loading data into Spark.</li>
<li><strong>Data Preprocessing</strong>: Cleaning and transforming data.</li>
<li><strong>Feature Engineering</strong>: Creating features that improve model performance.</li>
<li><strong>Model Training</strong>: Training a machine learning model.</li>
<li><strong>Model Evaluation</strong>: Assessing the performance of the model.</li>
<li><strong>Model Deployment</strong>: Making the model available for predictions.</li>
</ul>
</div><h1>Data Ingestion</h1>
<div class='content'><p>Data ingestion is the first step in any machine learning pipeline. Apache Spark provides various methods to load data from different sources.</p>
</div><h2>Example: Loading Data from a CSV File</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaXRpYWxpemUgU3Bhcmsgc2Vzc2lvbgpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIk1MUGlwZWxpbmUiKS5nZXRPckNyZWF0ZSgpCgojIExvYWQgZGF0YQpkYXRhID0gc3BhcmsucmVhZC5jc3YoImRhdGEvc2FtcGxlX2RhdGEuY3N2IiwgaGVhZGVyPVRydWUsIGluZmVyU2NoZW1hPVRydWUpCmRhdGEuc2hvdyg1KQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Initialize Spark session
spark = SparkSession.builder.appName(&quot;MLPipeline&quot;).getOrCreate()

# Load data
data = spark.read.csv(&quot;data/sample_data.csv&quot;, header=True, inferSchema=True)
data.show(5)</pre></div><div class='content'><p>Explanation:</p>
<ul>
<li>We start by initializing a Spark session.</li>
<li>We then load data from a CSV file using <code>spark.read.csv</code>.</li>
<li>The <code>header=True</code> option indicates that the first row contains column names.</li>
<li>The <code>inferSchema=True</code> option automatically infers the data types of the columns.</li>
</ul>
</div><h1>Data Preprocessing</h1>
<div class='content'><p>Data preprocessing involves cleaning and transforming the data to make it suitable for machine learning.</p>
</div><h2>Example: Handling Missing Values</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEcm9wIHJvd3Mgd2l0aCBhbnkgbWlzc2luZyB2YWx1ZXMKY2xlYW5lZF9kYXRhID0gZGF0YS5kcm9wbmEoKQpjbGVhbmVkX2RhdGEuc2hvdyg1KQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Drop rows with any missing values
cleaned_data = data.dropna()
cleaned_data.show(5)</pre></div><div class='content'><p>Explanation:</p>
<ul>
<li>We use the <code>dropna()</code> method to remove rows with any missing values.</li>
</ul>
</div><h1>Feature Engineering</h1>
<div class='content'><p>Feature engineering is the process of creating new features or transforming existing ones to improve model performance.</p>
</div><h2>Example: One-Hot Encoding Categorical Variables</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmZlYXR1cmUgaW1wb3J0IE9uZUhvdEVuY29kZXIsIFN0cmluZ0luZGV4ZXIKCiMgSW5kZXggY2F0ZWdvcmljYWwgY29sdW1uCmluZGV4ZXIgPSBTdHJpbmdJbmRleGVyKGlucHV0Q29sPSJjYXRlZ29yeSIsIG91dHB1dENvbD0iY2F0ZWdvcnlJbmRleCIpCmluZGV4ZWRfZGF0YSA9IGluZGV4ZXIuZml0KGNsZWFuZWRfZGF0YSkudHJhbnNmb3JtKGNsZWFuZWRfZGF0YSkKCiMgT25lLWhvdCBlbmNvZGUgdGhlIGluZGV4ZWQgY29sdW1uCmVuY29kZXIgPSBPbmVIb3RFbmNvZGVyKGlucHV0Q29sPSJjYXRlZ29yeUluZGV4Iiwgb3V0cHV0Q29sPSJjYXRlZ29yeVZlYyIpCmVuY29kZWRfZGF0YSA9IGVuY29kZXIuZml0KGluZGV4ZWRfZGF0YSkudHJhbnNmb3JtKGluZGV4ZWRfZGF0YSkKZW5jb2RlZF9kYXRhLnNob3coNSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.feature import OneHotEncoder, StringIndexer

# Index categorical column
indexer = StringIndexer(inputCol=&quot;category&quot;, outputCol=&quot;categoryIndex&quot;)
indexed_data = indexer.fit(cleaned_data).transform(cleaned_data)

# One-hot encode the indexed column
encoder = OneHotEncoder(inputCol=&quot;categoryIndex&quot;, outputCol=&quot;categoryVec&quot;)
encoded_data = encoder.fit(indexed_data).transform(indexed_data)
encoded_data.show(5)</pre></div><div class='content'><p>Explanation:</p>
<ul>
<li>We use <code>StringIndexer</code> to convert categorical values into numerical indices.</li>
<li>We then use <code>OneHotEncoder</code> to convert these indices into one-hot encoded vectors.</li>
</ul>
</div><h1>Model Training</h1>
<div class='content'><p>Model training involves using the preprocessed data to train a machine learning model.</p>
</div><h2>Example: Training a Logistic Regression Model</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmNsYXNzaWZpY2F0aW9uIGltcG9ydCBMb2dpc3RpY1JlZ3Jlc3Npb24KZnJvbSBweXNwYXJrLm1sLmZlYXR1cmUgaW1wb3J0IFZlY3RvckFzc2VtYmxlcgoKIyBBc3NlbWJsZSBmZWF0dXJlcyBpbnRvIGEgc2luZ2xlIHZlY3Rvcgphc3NlbWJsZXIgPSBWZWN0b3JBc3NlbWJsZXIoaW5wdXRDb2xzPVsiZmVhdHVyZTEiLCAiZmVhdHVyZTIiLCAiY2F0ZWdvcnlWZWMiXSwgb3V0cHV0Q29sPSJmZWF0dXJlcyIpCmFzc2VtYmxlZF9kYXRhID0gYXNzZW1ibGVyLnRyYW5zZm9ybShlbmNvZGVkX2RhdGEpCgojIEluaXRpYWxpemUgYW5kIHRyYWluIHRoZSBsb2dpc3RpYyByZWdyZXNzaW9uIG1vZGVsCmxyID0gTG9naXN0aWNSZWdyZXNzaW9uKGZlYXR1cmVzQ29sPSJmZWF0dXJlcyIsIGxhYmVsQ29sPSJsYWJlbCIpCm1vZGVsID0gbHIuZml0KGFzc2VtYmxlZF9kYXRhKQoKIyBQcmludCBtb2RlbCBjb2VmZmljaWVudHMKcHJpbnQoIkNvZWZmaWNpZW50czogIiArIHN0cihtb2RlbC5jb2VmZmljaWVudHMpKQpwcmludCgiSW50ZXJjZXB0OiAiICsgc3RyKG1vZGVsLmludGVyY2VwdCkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.classification import LogisticRegression
from pyspark.ml.feature import VectorAssembler

# Assemble features into a single vector
assembler = VectorAssembler(inputCols=[&quot;feature1&quot;, &quot;feature2&quot;, &quot;categoryVec&quot;], outputCol=&quot;features&quot;)
assembled_data = assembler.transform(encoded_data)

# Initialize and train the logistic regression model
lr = LogisticRegression(featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;)
model = lr.fit(assembled_data)

# Print model coefficients
print(&quot;Coefficients: &quot; + str(model.coefficients))
print(&quot;Intercept: &quot; + str(model.intercept))</pre></div><div class='content'><p>Explanation:</p>
<ul>
<li>We use <code>VectorAssembler</code> to combine multiple feature columns into a single vector.</li>
<li>We initialize a <code>LogisticRegression</code> model and train it using the assembled data.</li>
<li>We print the model coefficients and intercept.</li>
</ul>
</div><h1>Model Evaluation</h1>
<div class='content'><p>Model evaluation involves assessing the performance of the trained model.</p>
</div><h2>Example: Evaluating Model Performance</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmV2YWx1YXRpb24gaW1wb3J0IEJpbmFyeUNsYXNzaWZpY2F0aW9uRXZhbHVhdG9yCgojIE1ha2UgcHJlZGljdGlvbnMKcHJlZGljdGlvbnMgPSBtb2RlbC50cmFuc2Zvcm0oYXNzZW1ibGVkX2RhdGEpCgojIEV2YWx1YXRlIHRoZSBtb2RlbApldmFsdWF0b3IgPSBCaW5hcnlDbGFzc2lmaWNhdGlvbkV2YWx1YXRvcihsYWJlbENvbD0ibGFiZWwiLCByYXdQcmVkaWN0aW9uQ29sPSJyYXdQcmVkaWN0aW9uIikKYWNjdXJhY3kgPSBldmFsdWF0b3IuZXZhbHVhdGUocHJlZGljdGlvbnMpCnByaW50KCJNb2RlbCBBY2N1cmFjeTogIiArIHN0cihhY2N1cmFjeSkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.evaluation import BinaryClassificationEvaluator

# Make predictions
predictions = model.transform(assembled_data)

# Evaluate the model
evaluator = BinaryClassificationEvaluator(labelCol=&quot;label&quot;, rawPredictionCol=&quot;rawPrediction&quot;)
accuracy = evaluator.evaluate(predictions)
print(&quot;Model Accuracy: &quot; + str(accuracy))</pre></div><div class='content'><p>Explanation:</p>
<ul>
<li>We use the trained model to make predictions on the data.</li>
<li>We use <code>BinaryClassificationEvaluator</code> to evaluate the model's accuracy.</li>
</ul>
</div><h1>Model Deployment</h1>
<div class='content'><p>Model deployment involves making the trained model available for making predictions on new data.</p>
</div><h2>Example: Saving and Loading the Model</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTYXZlIHRoZSBtb2RlbAptb2RlbC5zYXZlKCJtb2RlbHMvbG9naXN0aWNfcmVncmVzc2lvbl9tb2RlbCIpCgojIExvYWQgdGhlIG1vZGVsCmZyb20gcHlzcGFyay5tbC5jbGFzc2lmaWNhdGlvbiBpbXBvcnQgTG9naXN0aWNSZWdyZXNzaW9uTW9kZWwKbG9hZGVkX21vZGVsID0gTG9naXN0aWNSZWdyZXNzaW9uTW9kZWwubG9hZCgibW9kZWxzL2xvZ2lzdGljX3JlZ3Jlc3Npb25fbW9kZWwiKQoKIyBVc2UgdGhlIGxvYWRlZCBtb2RlbCBmb3IgcHJlZGljdGlvbnMKbmV3X3ByZWRpY3Rpb25zID0gbG9hZGVkX21vZGVsLnRyYW5zZm9ybShhc3NlbWJsZWRfZGF0YSkKbmV3X3ByZWRpY3Rpb25zLnNob3coNSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Save the model
model.save(&quot;models/logistic_regression_model&quot;)

# Load the model
from pyspark.ml.classification import LogisticRegressionModel
loaded_model = LogisticRegressionModel.load(&quot;models/logistic_regression_model&quot;)

# Use the loaded model for predictions
new_predictions = loaded_model.transform(assembled_data)
new_predictions.show(5)</pre></div><div class='content'><p>Explanation:</p>
<ul>
<li>We save the trained model to disk using the <code>save</code> method.</li>
<li>We load the model from disk using <code>LogisticRegressionModel.load</code>.</li>
<li>We use the loaded model to make predictions on the data.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this case study, we have walked through the process of building a machine learning pipeline using Apache Spark. We covered data ingestion, preprocessing, feature engineering, model training, evaluation, and deployment. By following these steps, you can build robust and scalable machine learning pipelines for various applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='case-study-real-time-data-processing'>&#x25C4;Case Study: Real-Time Data Processing</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Case Study: Machine Learning Pipeline</a>
	</div>
	<div class='col-4 text-end'>
					<a href='case-study-graph-processing'>Case Study: Graph Processing &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
