<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Use Cases of GraphX</title>

    <link rel="alternate" href="https://campusempresa.com/apachespark/use-cases-of-graphx" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/apachespark/use-cases-of-graphx" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/apachespark/use-cases-of-graphx" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/apachespark/use-cases-of-graphx" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/apachespark/use-cases-of-graphx" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='graph-algorithms'>&#x25C4;Graph Algorithms</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Use Cases of GraphX</a>
	</div>
	<div class='col-4 text-end'>
					<a href='understanding-spark-performance'>Understanding Spark Performance &#x25BA;</a>
			</div>
</div>
<div class='content'><p>GraphX is a component of Apache Spark for graph processing. It allows users to create, manipulate, and analyze graphs at scale. This section will cover various use cases of GraphX, providing clear explanations, examples, and exercises to help you understand how to leverage GraphX in real-world scenarios.</p>
</div><h1>Social Network Analysis</h1>
<div class='content'><p>Social networks are a common use case for graph processing. GraphX can be used to analyze relationships and interactions within a network.</p>
<ul>
<li><strong>Friend Recommendations</strong>: By analyzing the graph of user connections, you can recommend new friends to users.</li>
<li><strong>Community Detection</strong>: Identify clusters or communities within the network.</li>
<li><strong>Influence Analysis</strong>: Determine the most influential users in the network.</li>
</ul>
</div><h2>Example: Friend Recommendations</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuc3BhcmsuZ3JhcGh4Ll8KaW1wb3J0IG9yZy5hcGFjaGUuc3BhcmsucmRkLlJERAoKLy8gQ3JlYXRlIGFuIFJERCBmb3IgdmVydGljZXMKdmFsIHVzZXJzOiBSRERbKFZlcnRleElkLCAoU3RyaW5nLCBTdHJpbmcpKV0gPSBzYy5wYXJhbGxlbGl6ZShBcnJheSgKICAoMUwsICgiQWxpY2UiLCAiU3R1ZGVudCIpKSwgCiAgKDJMLCAoIkJvYiIsICJEZXZlbG9wZXIiKSksIAogICgzTCwgKCJDaGFybGllIiwgIlRlYWNoZXIiKSkKKSkKCi8vIENyZWF0ZSBhbiBSREQgZm9yIGVkZ2VzCnZhbCByZWxhdGlvbnNoaXBzOiBSRERbRWRnZVtJbnRdXSA9IHNjLnBhcmFsbGVsaXplKEFycmF5KAogIEVkZ2UoMUwsIDJMLCAxKSwgCiAgRWRnZSgyTCwgM0wsIDEpCikpCgovLyBCdWlsZCB0aGUgaW5pdGlhbCBHcmFwaAp2YWwgZ3JhcGggPSBHcmFwaCh1c2VycywgcmVsYXRpb25zaGlwcykKCi8vIFJ1biBQYWdlUmFuayB0byBpZGVudGlmeSBpbmZsdWVudGlhbCB1c2Vycwp2YWwgcmFua3MgPSBncmFwaC5wYWdlUmFuaygwLjAwMDEpLnZlcnRpY2VzCgovLyBKb2luIHRoZSByYW5rcyB3aXRoIHRoZSB1c2VybmFtZXMKdmFsIHJhbmtzQnlVc2VybmFtZSA9IHJhbmtzLmpvaW4odXNlcnMpLm1hcCB7CiAgY2FzZSAoaWQsIChyYW5rLCAobmFtZSwgXykpKSA9PiAobmFtZSwgcmFuaykKfQoKLy8gUHJpbnQgdGhlIHJlc3VsdApyYW5rc0J5VXNlcm5hbWUuY29sbGVjdCgpLmZvcmVhY2ggewogIGNhc2UgKG5hbWUsIHJhbmspID0+IHByaW50bG4ocyIkbmFtZSBoYXMgcmFuazogJHJhbmsiKQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.spark.graphx._
import org.apache.spark.rdd.RDD

// Create an RDD for vertices
val users: RDD[(VertexId, (String, String))] = sc.parallelize(Array(
  (1L, (&quot;Alice&quot;, &quot;Student&quot;)), 
  (2L, (&quot;Bob&quot;, &quot;Developer&quot;)), 
  (3L, (&quot;Charlie&quot;, &quot;Teacher&quot;))
))

// Create an RDD for edges
val relationships: RDD[Edge[Int]] = sc.parallelize(Array(
  Edge(1L, 2L, 1), 
  Edge(2L, 3L, 1)
))

// Build the initial Graph
val graph = Graph(users, relationships)

// Run PageRank to identify influential users
val ranks = graph.pageRank(0.0001).vertices

// Join the ranks with the usernames
val ranksByUsername = ranks.join(users).map {
  case (id, (rank, (name, _))) =&gt; (name, rank)
}

// Print the result
ranksByUsername.collect().foreach {
  case (name, rank) =&gt; println(s&quot;$name has rank: $rank&quot;)
}</pre></div><div class='content'></div><h1>Fraud Detection</h1>
<div class='content'><p>GraphX can be used to detect fraudulent activities by analyzing transaction networks.</p>
<ul>
<li><strong>Anomaly Detection</strong>: Identify unusual patterns that may indicate fraud.</li>
<li><strong>Transaction Networks</strong>: Analyze the flow of transactions to detect suspicious activities.</li>
</ul>
</div><h2>Example: Anomaly Detection in Transaction Networks</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuc3BhcmsuZ3JhcGh4Ll8KaW1wb3J0IG9yZy5hcGFjaGUuc3BhcmsucmRkLlJERAoKLy8gQ3JlYXRlIGFuIFJERCBmb3IgdmVydGljZXMgKHVzZXJzKQp2YWwgdXNlcnM6IFJERFsoVmVydGV4SWQsIFN0cmluZyldID0gc2MucGFyYWxsZWxpemUoQXJyYXkoCiAgKDFMLCAiVXNlcjEiKSwgCiAgKDJMLCAiVXNlcjIiKSwgCiAgKDNMLCAiVXNlcjMiKQopKQoKLy8gQ3JlYXRlIGFuIFJERCBmb3IgZWRnZXMgKHRyYW5zYWN0aW9ucykKdmFsIHRyYW5zYWN0aW9uczogUkREW0VkZ2VbRG91YmxlXV0gPSBzYy5wYXJhbGxlbGl6ZShBcnJheSgKICBFZGdlKDFMLCAyTCwgMTAwLjApLCAKICBFZGdlKDJMLCAzTCwgMjAwLjApLCAKICBFZGdlKDNMLCAxTCwgMzAwLjApCikpCgovLyBCdWlsZCB0aGUgaW5pdGlhbCBHcmFwaAp2YWwgZ3JhcGggPSBHcmFwaCh1c2VycywgdHJhbnNhY3Rpb25zKQoKLy8gSWRlbnRpZnkgdmVydGljZXMgd2l0aCBoaWdoIHRyYW5zYWN0aW9uIGFtb3VudHMKdmFsIGhpZ2hWYWx1ZVRyYW5zYWN0aW9ucyA9IGdyYXBoLnRyaXBsZXRzLmZpbHRlcih0cmlwbGV0ID0+IHRyaXBsZXQuYXR0ciA+IDE1MC4wKQoKLy8gUHJpbnQgdGhlIHJlc3VsdApoaWdoVmFsdWVUcmFuc2FjdGlvbnMuY29sbGVjdCgpLmZvcmVhY2godHJpcGxldCA9PiAKICBwcmludGxuKHMiJHt0cmlwbGV0LnNyY0F0dHJ9IHNlbnQgJHt0cmlwbGV0LmF0dHJ9IHRvICR7dHJpcGxldC5kc3RBdHRyfSIpCik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.spark.graphx._
import org.apache.spark.rdd.RDD

// Create an RDD for vertices (users)
val users: RDD[(VertexId, String)] = sc.parallelize(Array(
  (1L, &quot;User1&quot;), 
  (2L, &quot;User2&quot;), 
  (3L, &quot;User3&quot;)
))

// Create an RDD for edges (transactions)
val transactions: RDD[Edge[Double]] = sc.parallelize(Array(
  Edge(1L, 2L, 100.0), 
  Edge(2L, 3L, 200.0), 
  Edge(3L, 1L, 300.0)
))

// Build the initial Graph
val graph = Graph(users, transactions)

// Identify vertices with high transaction amounts
val highValueTransactions = graph.triplets.filter(triplet =&gt; triplet.attr &gt; 150.0)

// Print the result
highValueTransactions.collect().foreach(triplet =&gt; 
  println(s&quot;${triplet.srcAttr} sent ${triplet.attr} to ${triplet.dstAttr}&quot;)
)</pre></div><div class='content'></div><h1>Recommendation Systems</h1>
<div class='content'><p>GraphX can be used to build recommendation systems by analyzing user-item interactions.</p>
<ul>
<li><strong>Product Recommendations</strong>: Recommend products to users based on their purchase history.</li>
<li><strong>Content Recommendations</strong>: Suggest content to users based on their viewing history.</li>
</ul>
</div><h2>Example: Product Recommendations</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuc3BhcmsuZ3JhcGh4Ll8KaW1wb3J0IG9yZy5hcGFjaGUuc3BhcmsucmRkLlJERAoKLy8gQ3JlYXRlIGFuIFJERCBmb3IgdmVydGljZXMgKHVzZXJzIGFuZCBwcm9kdWN0cykKdmFsIHZlcnRpY2VzOiBSRERbKFZlcnRleElkLCBTdHJpbmcpXSA9IHNjLnBhcmFsbGVsaXplKEFycmF5KAogICgxTCwgIlVzZXIxIiksIAogICgyTCwgIlVzZXIyIiksIAogICgzTCwgIlByb2R1Y3RBIiksIAogICg0TCwgIlByb2R1Y3RCIikKKSkKCi8vIENyZWF0ZSBhbiBSREQgZm9yIGVkZ2VzIChpbnRlcmFjdGlvbnMpCnZhbCBpbnRlcmFjdGlvbnM6IFJERFtFZGdlW0ludF1dID0gc2MucGFyYWxsZWxpemUoQXJyYXkoCiAgRWRnZSgxTCwgM0wsIDEpLCAKICBFZGdlKDJMLCA0TCwgMSksIAogIEVkZ2UoMUwsIDRMLCAxKQopKQoKLy8gQnVpbGQgdGhlIGluaXRpYWwgR3JhcGgKdmFsIGdyYXBoID0gR3JhcGgodmVydGljZXMsIGludGVyYWN0aW9ucykKCi8vIFJ1biBjb25uZWN0ZWQgY29tcG9uZW50cyB0byBmaW5kIGNvbm5lY3RlZCB1c2VycyBhbmQgcHJvZHVjdHMKdmFsIGNjID0gZ3JhcGguY29ubmVjdGVkQ29tcG9uZW50cygpLnZlcnRpY2VzCgovLyBKb2luIHRoZSBjb25uZWN0ZWQgY29tcG9uZW50cyB3aXRoIHRoZSB2ZXJ0aWNlcwp2YWwgY2NCeVVzZXJuYW1lID0gY2Muam9pbih2ZXJ0aWNlcykubWFwIHsKICBjYXNlIChpZCwgKGNjLCBuYW1lKSkgPT4gKG5hbWUsIGNjKQp9CgovLyBQcmludCB0aGUgcmVzdWx0CmNjQnlVc2VybmFtZS5jb2xsZWN0KCkuZm9yZWFjaCB7CiAgY2FzZSAobmFtZSwgY2MpID0+IHByaW50bG4ocyIkbmFtZSBpcyBpbiBjb21wb25lbnQ6ICRjYyIpCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.spark.graphx._
import org.apache.spark.rdd.RDD

// Create an RDD for vertices (users and products)
val vertices: RDD[(VertexId, String)] = sc.parallelize(Array(
  (1L, &quot;User1&quot;), 
  (2L, &quot;User2&quot;), 
  (3L, &quot;ProductA&quot;), 
  (4L, &quot;ProductB&quot;)
))

// Create an RDD for edges (interactions)
val interactions: RDD[Edge[Int]] = sc.parallelize(Array(
  Edge(1L, 3L, 1), 
  Edge(2L, 4L, 1), 
  Edge(1L, 4L, 1)
))

// Build the initial Graph
val graph = Graph(vertices, interactions)

// Run connected components to find connected users and products
val cc = graph.connectedComponents().vertices

// Join the connected components with the vertices
val ccByUsername = cc.join(vertices).map {
  case (id, (cc, name)) =&gt; (name, cc)
}

// Print the result
ccByUsername.collect().foreach {
  case (name, cc) =&gt; println(s&quot;$name is in component: $cc&quot;)
}</pre></div><div class='content'></div><h1>Traffic Routing</h1>
<div class='content'><p>GraphX can be used to optimize traffic routing by analyzing road networks.</p>
<ul>
<li><strong>Shortest Path</strong>: Find the shortest path between two points.</li>
<li><strong>Traffic Flow Analysis</strong>: Analyze and optimize traffic flow in a network.</li>
</ul>
</div><h2>Example: Shortest Path Calculation</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuc3BhcmsuZ3JhcGh4Ll8KaW1wb3J0IG9yZy5hcGFjaGUuc3BhcmsucmRkLlJERAoKLy8gQ3JlYXRlIGFuIFJERCBmb3IgdmVydGljZXMgKGxvY2F0aW9ucykKdmFsIGxvY2F0aW9uczogUkREWyhWZXJ0ZXhJZCwgU3RyaW5nKV0gPSBzYy5wYXJhbGxlbGl6ZShBcnJheSgKICAoMUwsICJMb2NhdGlvbjEiKSwgCiAgKDJMLCAiTG9jYXRpb24yIiksIAogICgzTCwgIkxvY2F0aW9uMyIpCikpCgovLyBDcmVhdGUgYW4gUkREIGZvciBlZGdlcyAocm9hZHMgd2l0aCBkaXN0YW5jZXMpCnZhbCByb2FkczogUkREW0VkZ2VbRG91YmxlXV0gPSBzYy5wYXJhbGxlbGl6ZShBcnJheSgKICBFZGdlKDFMLCAyTCwgMTAuMCksIAogIEVkZ2UoMkwsIDNMLCAyMC4wKSwgCiAgRWRnZSgxTCwgM0wsIDMwLjApCikpCgovLyBCdWlsZCB0aGUgaW5pdGlhbCBHcmFwaAp2YWwgZ3JhcGggPSBHcmFwaChsb2NhdGlvbnMsIHJvYWRzKQoKLy8gUnVuIHNob3J0ZXN0IHBhdGhzIGFsZ29yaXRobQp2YWwgc291cmNlSWQ6IFZlcnRleElkID0gMUwKdmFsIHNob3J0ZXN0UGF0aHMgPSBncmFwaC5zaG9ydGVzdFBhdGhzKGxhbmRtYXJrcyA9IFNlcShzb3VyY2VJZCkpLnZlcnRpY2VzCgovLyBKb2luIHRoZSBzaG9ydGVzdCBwYXRocyB3aXRoIHRoZSBsb2NhdGlvbnMKdmFsIHNob3J0ZXN0UGF0aHNCeUxvY2F0aW9uID0gc2hvcnRlc3RQYXRocy5qb2luKGxvY2F0aW9ucykubWFwIHsKICBjYXNlIChpZCwgKGRpc3RhbmNlcywgbmFtZSkpID0+IChuYW1lLCBkaXN0YW5jZXMuZ2V0T3JFbHNlKHNvdXJjZUlkLCBEb3VibGUuUG9zaXRpdmVJbmZpbml0eSkpCn0KCi8vIFByaW50IHRoZSByZXN1bHQKc2hvcnRlc3RQYXRoc0J5TG9jYXRpb24uY29sbGVjdCgpLmZvcmVhY2ggewogIGNhc2UgKG5hbWUsIGRpc3RhbmNlKSA9PiBwcmludGxuKHMiRGlzdGFuY2UgZnJvbSBMb2NhdGlvbjEgdG8gJG5hbWU6ICRkaXN0YW5jZSIpCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.spark.graphx._
import org.apache.spark.rdd.RDD

// Create an RDD for vertices (locations)
val locations: RDD[(VertexId, String)] = sc.parallelize(Array(
  (1L, &quot;Location1&quot;), 
  (2L, &quot;Location2&quot;), 
  (3L, &quot;Location3&quot;)
))

// Create an RDD for edges (roads with distances)
val roads: RDD[Edge[Double]] = sc.parallelize(Array(
  Edge(1L, 2L, 10.0), 
  Edge(2L, 3L, 20.0), 
  Edge(1L, 3L, 30.0)
))

// Build the initial Graph
val graph = Graph(locations, roads)

// Run shortest paths algorithm
val sourceId: VertexId = 1L
val shortestPaths = graph.shortestPaths(landmarks = Seq(sourceId)).vertices

// Join the shortest paths with the locations
val shortestPathsByLocation = shortestPaths.join(locations).map {
  case (id, (distances, name)) =&gt; (name, distances.getOrElse(sourceId, Double.PositiveInfinity))
}

// Print the result
shortestPathsByLocation.collect().foreach {
  case (name, distance) =&gt; println(s&quot;Distance from Location1 to $name: $distance&quot;)
}</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>GraphX is a powerful tool for graph processing in Apache Spark, enabling a wide range of applications from social network analysis to traffic routing. By understanding and applying these use cases, you can leverage GraphX to solve complex problems involving large-scale graph data. Through the examples provided, you should now have a foundational understanding of how to use GraphX for various real-world scenarios. Continue practicing with different datasets and scenarios to deepen your understanding and proficiency with GraphX.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='graph-algorithms'>&#x25C4;Graph Algorithms</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Use Cases of GraphX</a>
	</div>
	<div class='col-4 text-end'>
					<a href='understanding-spark-performance'>Understanding Spark Performance &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
