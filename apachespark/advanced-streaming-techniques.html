<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Streaming Techniques</title>

    <link rel="alternate" href="https://campusempresa.com/apachespark/advanced-streaming-techniques" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/apachespark/advanced-streaming-techniques" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/apachespark/advanced-streaming-techniques" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/apachespark/advanced-streaming-techniques" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/apachespark/advanced-streaming-techniques" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='advanced-spark-sql'>&#x25C4;Advanced Spark SQL</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Advanced Streaming Techniques</a>
	</div>
	<div class='col-4 text-end'>
					<a href='integrating-spark-with-other-big-data-tools'>Integrating Spark with Other Big Data Tools &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this section, we will delve into advanced streaming techniques in Apache Spark. This will build on the foundational knowledge of Spark Streaming and Structured Streaming, and introduce more complex concepts and optimizations.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Stateful Stream Processing</strong>: Managing state information across streaming batches.</li>
<li><strong>Window Operations</strong>: Aggregating data over sliding or tumbling windows.</li>
<li><strong>Watermarking</strong>: Handling late data arrivals.</li>
<li><strong>Join Operations</strong>: Joining streaming data with static or other streaming data.</li>
<li><strong>Fault Tolerance</strong>: Ensuring data consistency and recovery in case of failures.</li>
<li><strong>Performance Tuning</strong>: Optimizing streaming applications for better performance.</li>
</ul>
</div><h1>Stateful Stream Processing</h1>
<div class='content'><p>Stateful stream processing allows you to maintain and update state information across batches of streaming data.</p>
</div><h2>Example: Word Count with Stateful Processing</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCmZyb20gcHlzcGFyay5zcWwuZnVuY3Rpb25zIGltcG9ydCBleHBsb2RlLCBzcGxpdAoKc3BhcmsgPSBTcGFya1Nlc3Npb24uYnVpbGRlci5hcHBOYW1lKCJTdGF0ZWZ1bFdvcmRDb3VudCIpLmdldE9yQ3JlYXRlKCkKCiMgRGVmaW5lIHRoZSBzY2hlbWEgb2YgdGhlIGlucHV0IGRhdGEKc2NoZW1hID0gInZhbHVlIFNUUklORyIKCiMgUmVhZCBzdHJlYW1pbmcgZGF0YSBmcm9tIGEgc29ja2V0CmxpbmVzID0gc3BhcmsucmVhZFN0cmVhbS5mb3JtYXQoInNvY2tldCIpLm9wdGlvbigiaG9zdCIsICJsb2NhbGhvc3QiKS5vcHRpb24oInBvcnQiLCA5OTk5KS5sb2FkKCkKCiMgU3BsaXQgdGhlIGxpbmVzIGludG8gd29yZHMKd29yZHMgPSBsaW5lcy5zZWxlY3QoZXhwbG9kZShzcGxpdChsaW5lcy52YWx1ZSwgIiAiKSkuYWxpYXMoIndvcmQiKSkKCiMgR2VuZXJhdGUgcnVubmluZyB3b3JkIGNvdW50CndvcmRDb3VudHMgPSB3b3Jkcy5ncm91cEJ5KCJ3b3JkIikuY291bnQoKQoKIyBTdGFydCBydW5uaW5nIHRoZSBxdWVyeSB0aGF0IHByaW50cyB0aGUgcnVubmluZyBjb3VudHMgdG8gdGhlIGNvbnNvbGUKcXVlcnkgPSB3b3JkQ291bnRzLndyaXRlU3RyZWFtLm91dHB1dE1vZGUoImNvbXBsZXRlIikuZm9ybWF0KCJjb25zb2xlIikuc3RhcnQoKQoKcXVlcnkuYXdhaXRUZXJtaW5hdGlvbigp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession
from pyspark.sql.functions import explode, split

spark = SparkSession.builder.appName(&quot;StatefulWordCount&quot;).getOrCreate()

# Define the schema of the input data
schema = &quot;value STRING&quot;

# Read streaming data from a socket
lines = spark.readStream.format(&quot;socket&quot;).option(&quot;host&quot;, &quot;localhost&quot;).option(&quot;port&quot;, 9999).load()

# Split the lines into words
words = lines.select(explode(split(lines.value, &quot; &quot;)).alias(&quot;word&quot;))

# Generate running word count
wordCounts = words.groupBy(&quot;word&quot;).count()

# Start running the query that prints the running counts to the console
query = wordCounts.writeStream.outputMode(&quot;complete&quot;).format(&quot;console&quot;).start()

query.awaitTermination()</pre></div><div class='content'><p>In this example, the word count is maintained across batches, demonstrating stateful processing.</p>
</div><h1>Window Operations</h1>
<div class='content'><p>Window operations allow you to perform aggregations over a specified time window.</p>
</div><h2>Example: Windowed Word Count</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbC5mdW5jdGlvbnMgaW1wb3J0IHdpbmRvdwoKd2luZG93ZWRDb3VudHMgPSB3b3Jkcy5ncm91cEJ5KHdpbmRvdyh3b3Jkcy50aW1lc3RhbXAsICIxMCBtaW51dGVzIiksIHdvcmRzLndvcmQpLmNvdW50KCkKCnF1ZXJ5ID0gd2luZG93ZWRDb3VudHMud3JpdGVTdHJlYW0ub3V0cHV0TW9kZSgiY29tcGxldGUiKS5mb3JtYXQoImNvbnNvbGUiKS5zdGFydCgpCgpxdWVyeS5hd2FpdFRlcm1pbmF0aW9uKCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql.functions import window

windowedCounts = words.groupBy(window(words.timestamp, &quot;10 minutes&quot;), words.word).count()

query = windowedCounts.writeStream.outputMode(&quot;complete&quot;).format(&quot;console&quot;).start()

query.awaitTermination()</pre></div><div class='content'><p>This example shows how to count words over a 10-minute sliding window.</p>
</div><h1>Watermarking</h1>
<div class='content'><p>Watermarking helps manage late data by specifying how late data can be before it is ignored.</p>
</div><h2>Example: Using Watermarks</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("d2luZG93ZWRDb3VudHNXaXRoV2F0ZXJtYXJrID0gd29yZHMud2l0aFdhdGVybWFyaygidGltZXN0YW1wIiwgIjEwIG1pbnV0ZXMiKSBcCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdyb3VwQnkod2luZG93KHdvcmRzLnRpbWVzdGFtcCwgIjEwIG1pbnV0ZXMiKSwgd29yZHMud29yZCkgXAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jb3VudCgpCgpxdWVyeSA9IHdpbmRvd2VkQ291bnRzV2l0aFdhdGVybWFyay53cml0ZVN0cmVhbS5vdXRwdXRNb2RlKCJhcHBlbmQiKS5mb3JtYXQoImNvbnNvbGUiKS5zdGFydCgpCgpxdWVyeS5hd2FpdFRlcm1pbmF0aW9uKCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>windowedCountsWithWatermark = words.withWatermark(&quot;timestamp&quot;, &quot;10 minutes&quot;) \
                                   .groupBy(window(words.timestamp, &quot;10 minutes&quot;), words.word) \
                                   .count()

query = windowedCountsWithWatermark.writeStream.outputMode(&quot;append&quot;).format(&quot;console&quot;).start()

query.awaitTermination()</pre></div><div class='content'><p>Here, data older than 10 minutes will be ignored, ensuring timely processing.</p>
</div><h1>Join Operations</h1>
<div class='content'><p>Joining streaming data with static or other streaming data can be complex but powerful.</p>
</div><h2>Example: Stream-Static Join</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTdGF0aWMgRGF0YUZyYW1lCnN0YXRpY0RhdGEgPSBzcGFyay5yZWFkLmZvcm1hdCgiY3N2Iikub3B0aW9uKCJoZWFkZXIiLCAidHJ1ZSIpLmxvYWQoInBhdGgvdG8vc3RhdGljL2RhdGEuY3N2IikKCiMgU3RyZWFtLVN0YXRpYyBKb2luCmpvaW5lZERhdGEgPSB3b3Jkcy5qb2luKHN0YXRpY0RhdGEsIHdvcmRzLndvcmQgPT0gc3RhdGljRGF0YS53b3JkKQoKcXVlcnkgPSBqb2luZWREYXRhLndyaXRlU3RyZWFtLm91dHB1dE1vZGUoImFwcGVuZCIpLmZvcm1hdCgiY29uc29sZSIpLnN0YXJ0KCkKCnF1ZXJ5LmF3YWl0VGVybWluYXRpb24oKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Static DataFrame
staticData = spark.read.format(&quot;csv&quot;).option(&quot;header&quot;, &quot;true&quot;).load(&quot;path/to/static/data.csv&quot;)

# Stream-Static Join
joinedData = words.join(staticData, words.word == staticData.word)

query = joinedData.writeStream.outputMode(&quot;append&quot;).format(&quot;console&quot;).start()

query.awaitTermination()</pre></div><div class='content'><p>This example demonstrates joining a stream with a static dataset.</p>
</div><h1>Fault Tolerance</h1>
<div class='content'><p>Ensuring fault tolerance is crucial for reliable streaming applications.</p>
</div><h2>Techniques:</h2>
<div class='content'><ul>
<li><strong>Checkpointing</strong>: Save the state of the stream to recover from failures.</li>
<li><strong>Write-Ahead Logs (WAL)</strong>: Log data before processing to ensure no data loss.</li>
</ul>
</div><h1>Performance Tuning</h1>
<div class='content'><p>Optimizing streaming applications can significantly improve performance.</p>
</div><h2>Techniques:</h2>
<div class='content'><ul>
<li><strong>Batch Size Tuning</strong>: Adjust the size of each batch for optimal processing.</li>
<li><strong>Resource Allocation</strong>: Allocate sufficient resources (CPU, memory) to the streaming application.</li>
<li><strong>Data Partitioning</strong>: Ensure data is evenly partitioned to avoid bottlenecks.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Advanced streaming techniques in Apache Spark allow for robust, efficient, and scalable stream processing. By mastering stateful processing, window operations, watermarking, join operations, fault tolerance, and performance tuning, you can build sophisticated streaming applications that handle real-time data effectively.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='advanced-spark-sql'>&#x25C4;Advanced Spark SQL</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Advanced Streaming Techniques</a>
	</div>
	<div class='col-4 text-end'>
					<a href='integrating-spark-with-other-big-data-tools'>Integrating Spark with Other Big Data Tools &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
