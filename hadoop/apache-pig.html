<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apache Pig</title>

    <link rel="alternate" href="https://campusempresa.com/hadoop/apache-pig" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/hadoop/apache-pig" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/hadoop/apache-pig" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/hadoop/apache-pig" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/hadoop/apache-pig" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='yarn-schedulers'>&#x25C4;YARN Schedulers</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Apache Pig</a>
	</div>
	<div class='col-4 text-end'>
					<a href='apache-hive'>Apache Hive &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Apache Pig</h1>
<div class='content'><p>Apache Pig is a high-level platform for creating programs that run on Apache Hadoop. The language for this platform is called Pig Latin, which abstracts the complexity of writing MapReduce programs.</p>
<ul>
<li><strong>Purpose</strong>: Simplifies the process of writing complex data transformations.</li>
<li><strong>Components</strong>: Pig Latin (scripting language) and Pig Runtime (execution environment).</li>
</ul>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Pig Latin</strong>: A high-level scripting language used with Apache Pig.</li>
<li><strong>Pig Engine</strong>: Executes Pig Latin scripts and translates them into MapReduce jobs.</li>
<li><strong>Data Model</strong>: Pig uses a nested data model, which includes:
<ul>
<li><strong>Atom</strong>: A simple atomic value.</li>
<li><strong>Tuple</strong>: A sequence of fields.</li>
<li><strong>Bag</strong>: A collection of tuples.</li>
<li><strong>Map</strong>: A collection of key-value pairs.</li>
</ul>
</li>
</ul>
</div><h1>Installing and Setting Up Apache Pig</h1>
<div class='content'><ol>
<li><strong>Prerequisites</strong>: Ensure Hadoop is installed and running.</li>
<li><strong>Download Pig</strong>: Obtain the latest version from the Apache Pig website.</li>
<li><strong>Extract and Configure</strong>:
<pre><code class="language-bash">tar -xzvf pig-x.y.z.tar.gz
export PIG_HOME=/path/to/pig
export PATH=$PATH:$PIG_HOME/bin
</code></pre>
</li>
<li><strong>Verify Installation</strong>:
<pre><code class="language-bash">pig -version
</code></pre>
</li>
</ol>
</div><h1>Basic Pig Latin Syntax</h1>
<h2>Loading Data</h2>
<div class='content'><ul>
<li><strong>Command</strong>: <code>LOAD</code></li>
<li><strong>Example</strong>:
<pre><code class="language-pig">data = LOAD 'input_data.txt' USING PigStorage(',') AS (field1:chararray, field2:int);
</code></pre>
</li>
</ul>
</div><h2>Storing Data</h2>
<div class='content'><ul>
<li><strong>Command</strong>: <code>STORE</code></li>
<li><strong>Example</strong>:
<pre><code class="language-pig">STORE data INTO 'output_data' USING PigStorage(',');
</code></pre>
</li>
</ul>
</div><h2>Filtering Data</h2>
<div class='content'><ul>
<li><strong>Command</strong>: <code>FILTER</code></li>
<li><strong>Example</strong>:
<pre><code class="language-pig">filtered_data = FILTER data BY field2 &gt; 10;
</code></pre>
</li>
</ul>
</div><h2>Grouping and Aggregating Data</h2>
<div class='content'><ul>
<li><strong>Command</strong>: <code>GROUP</code>, <code>FOREACH</code>, <code>GENERATE</code></li>
<li><strong>Example</strong>:
<pre><code class="language-pig">grouped_data = GROUP data BY field1;
aggregated_data = FOREACH grouped_data GENERATE group, COUNT(data);
</code></pre>
</li>
</ul>
</div><h2>Joining Data</h2>
<div class='content'><ul>
<li><strong>Command</strong>: <code>JOIN</code></li>
<li><strong>Example</strong>:
<pre><code class="language-pig">joined_data = JOIN data1 BY field1, data2 BY field2;
</code></pre>
</li>
</ul>
</div><h1>Advanced Pig Latin Features</h1>
<h2>User-Defined Functions (UDFs)</h2>
<div class='content'><ul>
<li><strong>Purpose</strong>: Extend Pig Latin with custom processing logic.</li>
<li><strong>Example</strong>:
<pre><code class="language-java">public class MyUDF extends EvalFunc&lt;String&gt; {
    public String exec(Tuple input) throws IOException {
        // Custom logic here
    }
}
</code></pre>
<pre><code class="language-pig">REGISTER 'myudf.jar';
DEFINE MyUDF my.package.MyUDF();
result = FOREACH data GENERATE MyUDF(field1);
</code></pre>
</li>
</ul>
</div><h2>Parameter Substitution</h2>
<div class='content'><ul>
<li><strong>Purpose</strong>: Make scripts more flexible and reusable.</li>
<li><strong>Example</strong>:
<pre><code class="language-pig">%declare input 'input_data.txt'
data = LOAD '$input' USING PigStorage(',') AS (field1:chararray, field2:int);
</code></pre>
</li>
</ul>
</div><h2>Macros</h2>
<div class='content'><ul>
<li><strong>Purpose</strong>: Reuse code blocks within Pig scripts.</li>
<li><strong>Example</strong>:
<pre><code class="language-pig">DEFINE process_data() RETURNS processed_data {
    filtered_data = FILTER data BY field2 &gt; 10;
    grouped_data = GROUP filtered_data BY field1;
    processed_data = FOREACH grouped_data GENERATE group, COUNT(filtered_data);
}
data = LOAD 'input_data.txt' USING PigStorage(',') AS (field1:chararray, field2:int);
processed_data = process_data();
</code></pre>
</li>
</ul>
</div><h1>Performance Optimization</h1>
<div class='content'><ul>
<li><strong>Combining Operations</strong>: Minimize the number of MapReduce jobs.</li>
<li><strong>Using <code>LIMIT</code></strong>: Reduce the amount of data processed.</li>
<li><strong>Parallelism</strong>: Increase the number of reducers.
<pre><code class="language-pig">data = LOAD 'input_data.txt' USING PigStorage(',') AS (field1:chararray, field2:int);
grouped_data = GROUP data BY field1 PARALLEL 10;
</code></pre>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Apache Pig provides a powerful and flexible platform for processing large datasets on Hadoop. By using Pig Latin, developers can write complex data transformations more easily compared to traditional MapReduce programs. Understanding the basics of Pig Latin, advanced features, and performance optimization techniques can significantly enhance your ability to work with big data efficiently.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='yarn-schedulers'>&#x25C4;YARN Schedulers</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Apache Pig</a>
	</div>
	<div class='col-4 text-end'>
					<a href='apache-hive'>Apache Hive &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
