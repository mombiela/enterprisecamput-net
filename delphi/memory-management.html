<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Management in Delphi/Object Pascal</title>

    <link rel="alternate" href="https://campusempresa.com/delphi/memory-management" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/delphi/memory-management" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/delphi/memory-management" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/delphi/memory-management" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/delphi/memory-management" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='performance-optimization'>&#x25C4;Performance Optimization</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Memory Management in Delphi/Object Pascal</a>
	</div>
	<div class='col-4 text-end'>
					<a href='version-control-and-collaboration'>Version Control and Collaboration &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Memory management is a critical aspect of programming, ensuring that applications run efficiently and without errors related to memory allocation and deallocation. In Delphi/Object Pascal, understanding how memory is managed can help you write more robust and efficient code.</p>
</div><h1>Introduction to Memory Management</h1>
<div class='content'><p>Memory management involves the allocation, use, and release of memory during the execution of a program. In Delphi/Object Pascal, this is handled through various mechanisms, including manual memory management and automatic memory management.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Heap and Stack</strong>: Memory in Delphi is divided into the stack and the heap.
<ul>
<li><strong>Stack</strong>: Used for static memory allocation, such as local variables.</li>
<li><strong>Heap</strong>: Used for dynamic memory allocation, such as objects and dynamic arrays.</li>
</ul>
</li>
<li><strong>Pointers</strong>: Variables that hold memory addresses, allowing for dynamic memory management.</li>
<li><strong>Garbage Collection</strong>: Delphi does not have automatic garbage collection like some other languages (e.g., Java). Instead, it relies on manual memory management.</li>
<li><strong>Reference Counting</strong>: Used for managing the lifetime of certain types of objects, such as strings and interfaces.</li>
</ul>
</div><h1>Manual Memory Management</h1>
<div class='content'><p>In Delphi, manual memory management involves explicitly allocating and freeing memory. This is typically done using pointers and the <code>New</code>, <code>Dispose</code>, <code>GetMem</code>, and <code>FreeMem</code> procedures.</p>
</div><h2>Allocating and Freeing Memory</h2>
<div class='content'><h4>Using Pointers</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyCiAgUDogXkludGVnZXI7CmJlZ2luCiAgTmV3KFApOyAgICAgIC8vIEFsbG9jYXRlIG1lbW9yeSBmb3IgYW4gaW50ZWdlcgogIFBeIDo9IDEwOyAgICAvLyBBc3NpZ24gYSB2YWx1ZSB0byB0aGUgYWxsb2NhdGVkIG1lbW9yeQogIERpc3Bvc2UoUCk7ICAvLyBGcmVlIHRoZSBhbGxvY2F0ZWQgbWVtb3J5CmVuZDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var
  P: ^Integer;
begin
  New(P);      // Allocate memory for an integer
  P^ := 10;    // Assign a value to the allocated memory
  Dispose(P);  // Free the allocated memory
end;</pre></div><div class='content'><h4>Using <code>GetMem</code> and <code>FreeMem</code></h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyCiAgUDogUG9pbnRlcjsKYmVnaW4KICBHZXRNZW0oUCwgU2l6ZU9mKEludGVnZXIpKTsgIC8vIEFsbG9jYXRlIG1lbW9yeSBmb3IgYW4gaW50ZWdlcgogIEludGVnZXIoUF4pIDo9IDEwOyAgICAgICAgICAgLy8gQXNzaWduIGEgdmFsdWUgdG8gdGhlIGFsbG9jYXRlZCBtZW1vcnkKICBGcmVlTWVtKFApOyAgICAgICAgICAgICAgICAgIC8vIEZyZWUgdGhlIGFsbG9jYXRlZCBtZW1vcnkKZW5kOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var
  P: Pointer;
begin
  GetMem(P, SizeOf(Integer));  // Allocate memory for an integer
  Integer(P^) := 10;           // Assign a value to the allocated memory
  FreeMem(P);                  // Free the allocated memory
end;</pre></div><div class='content'></div><h1>Automatic Memory Management</h1>
<div class='content'><p>While Delphi does not have a garbage collector, it does provide some automatic memory management features, particularly through reference counting for certain types of objects.</p>
</div><h2>Reference Counting</h2>
<div class='content'><p>Reference counting is used for managing the lifetime of strings, dynamic arrays, and interfaces. When the reference count drops to zero, the memory is automatically freed.</p>
<h4>Example with Strings</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyCiAgUzEsIFMyOiBzdHJpbmc7CmJlZ2luCiAgUzEgOj0gJ0hlbGxvJzsKICBTMiA6PSBTMTsgIC8vIFMyIG5vdyByZWZlcmVuY2VzIHRoZSBzYW1lIHN0cmluZyBhcyBTMQogIC8vIFdoZW4gUzEgYW5kIFMyIGdvIG91dCBvZiBzY29wZSwgdGhlIHN0cmluZyBtZW1vcnkgaXMgZnJlZWQKZW5kOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var
  S1, S2: string;
begin
  S1 := 'Hello';
  S2 := S1;  // S2 now references the same string as S1
  // When S1 and S2 go out of scope, the string memory is freed
end;</pre></div><div class='content'><h4>Example with Interfaces</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHlwZQogIElNeUludGVyZmFjZSA9IGludGVyZmFjZQogICAgcHJvY2VkdXJlIERvU29tZXRoaW5nOwogIGVuZDsKCiAgVE15T2JqZWN0ID0gY2xhc3MoVEludGVyZmFjZWRPYmplY3QsIElNeUludGVyZmFjZSkKICAgIHByb2NlZHVyZSBEb1NvbWV0aGluZzsKICBlbmQ7Cgpwcm9jZWR1cmUgVE15T2JqZWN0LkRvU29tZXRoaW5nOwpiZWdpbgogIC8vIEltcGxlbWVudGF0aW9uCmVuZDsKCnZhcgogIEludGY6IElNeUludGVyZmFjZTsKYmVnaW4KICBJbnRmIDo9IFRNeU9iamVjdC5DcmVhdGU7ICAvLyBSZWZlcmVuY2UgY291bnQgaXMgMQogIEludGYuRG9Tb21ldGhpbmc7CiAgLy8gV2hlbiBJbnRmIGdvZXMgb3V0IG9mIHNjb3BlLCB0aGUgcmVmZXJlbmNlIGNvdW50IGRyb3BzIHRvIDAgYW5kIHRoZSBvYmplY3QgaXMgZnJlZWQKZW5kOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>type
  IMyInterface = interface
    procedure DoSomething;
  end;

  TMyObject = class(TInterfacedObject, IMyInterface)
    procedure DoSomething;
  end;

procedure TMyObject.DoSomething;
begin
  // Implementation
end;

var
  Intf: IMyInterface;
begin
  Intf := TMyObject.Create;  // Reference count is 1
  Intf.DoSomething;
  // When Intf goes out of scope, the reference count drops to 0 and the object is freed
end;</pre></div><div class='content'></div><h1>Best Practices</h1>
<div class='content'><ul>
<li><strong>Always free dynamically allocated memory</strong>: Ensure that every <code>New</code> or <code>GetMem</code> call has a corresponding <code>Dispose</code> or <code>FreeMem</code> call.</li>
<li><strong>Use <code>try...finally</code> blocks</strong>: To ensure that memory is freed even if an exception occurs.</li>
<li><strong>Prefer automatic memory management</strong>: When possible, use strings, dynamic arrays, and interfaces to take advantage of reference counting.</li>
</ul>
</div><h2>Example of `try...finally`</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyCiAgUDogXkludGVnZXI7CmJlZ2luCiAgTmV3KFApOwogIHRyeQogICAgUF4gOj0gMTA7CiAgICAvLyBQZXJmb3JtIG9wZXJhdGlvbnMgd2l0aCBQCiAgZmluYWxseQogICAgRGlzcG9zZShQKTsgIC8vIEVuc3VyZSBtZW1vcnkgaXMgZnJlZWQgZXZlbiBpZiBhbiBleGNlcHRpb24gb2NjdXJzCiAgZW5kOwplbmQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var
  P: ^Integer;
begin
  New(P);
  try
    P^ := 10;
    // Perform operations with P
  finally
    Dispose(P);  // Ensure memory is freed even if an exception occurs
  end;
end;</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Memory management in Delphi/Object Pascal requires a good understanding of both manual and automatic techniques. By mastering pointers, memory allocation functions, and reference counting, you can write efficient and error-free applications. Always remember to free allocated memory and use <code>try...finally</code> blocks to handle exceptions properly. With these practices, you can ensure that your applications manage memory effectively.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='performance-optimization'>&#x25C4;Performance Optimization</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Memory Management in Delphi/Object Pascal</a>
	</div>
	<div class='col-4 text-end'>
					<a href='version-control-and-collaboration'>Version Control and Collaboration &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
