<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Operators in Kubernetes</title>

    <link rel="alternate" href="https://campusempresa.com/kubernetes/operators" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/kubernetes/operators" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/kubernetes/operators" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/kubernetes/operators" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/kubernetes/operators" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='custom-resource-definitions'>&#x25C4;Custom Resource Definitions (CRDs)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Operators in Kubernetes</a>
	</div>
	<div class='col-4 text-end'>
					<a href='helm-and-package-management'>Helm and Package Management &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Operators</h1>
<div class='content'><p>Operators are a powerful concept in Kubernetes that extend the capabilities of the Kubernetes API to manage complex applications and their components. They are essentially custom controllers that use custom resources to manage applications and their components.</p>
<ul>
<li><strong>Definition</strong>: Operators are software extensions to Kubernetes that make use of custom resources to manage applications and their components.</li>
<li><strong>Purpose</strong>: Automate the management of complex, stateful applications.</li>
<li><strong>Components</strong>:
<ul>
<li><strong>Custom Resource Definitions (CRDs)</strong>: Define the schema for the custom resource.</li>
<li><strong>Controller</strong>: Watches the custom resources and takes actions to reconcile the current state with the desired state.</li>
</ul>
</li>
</ul>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Custom Resource Definitions (CRDs)</strong>: Extend Kubernetes API to include custom objects.</li>
<li><strong>Controller</strong>: A loop that watches the state of your cluster and makes changes to move the current state towards the desired state.</li>
<li><strong>Reconciliation Loop</strong>: The process by which the controller ensures the actual state matches the desired state.</li>
</ul>
</div><h1>Creating a Simple Operator</h1>
<h2>Step 1: Define a Custom Resource</h2>
<div class='content'><p>A Custom Resource (CR) is an extension of the Kubernetes API that allows you to store and retrieve structured data.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBteWFwcC1jcmQueWFtbAphcGlWZXJzaW9uOiBhcGlleHRlbnNpb25zLms4cy5pby92MQpraW5kOiBDdXN0b21SZXNvdXJjZURlZmluaXRpb24KbWV0YWRhdGE6CiAgbmFtZTogbXlhcHBzLmV4YW1wbGUuY29tCnNwZWM6CiAgZ3JvdXA6IGV4YW1wbGUuY29tCiAgdmVyc2lvbnM6CiAgICAtIG5hbWU6IHYxCiAgICAgIHNlcnZlZDogdHJ1ZQogICAgICBzdG9yYWdlOiB0cnVlCiAgc2NvcGU6IE5hbWVzcGFjZWQKICBuYW1lczoKICAgIHBsdXJhbDogbXlhcHBzCiAgICBzaW5ndWxhcjogbXlhcHAKICAgIGtpbmQ6IE15QXBwCiAgICBzaG9ydE5hbWVzOgogICAgLSBtYQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># myapp-crd.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: myapps.example.com
spec:
  group: example.com
  versions:
    - name: v1
      served: true
      storage: true
  scope: Namespaced
  names:
    plural: myapps
    singular: myapp
    kind: MyApp
    shortNames:
    - ma</pre></div><div class='content'></div><h2>Step 2: Create the Custom Resource</h2>
<div class='content'><p>Once the CRD is defined, you can create instances of the custom resource.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBteWFwcC1pbnN0YW5jZS55YW1sCmFwaVZlcnNpb246IGV4YW1wbGUuY29tL3YxCmtpbmQ6IE15QXBwCm1ldGFkYXRhOgogIG5hbWU6IG15YXBwLXNhbXBsZQpzcGVjOgogIHNpemU6IDM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># myapp-instance.yaml
apiVersion: example.com/v1
kind: MyApp
metadata:
  name: myapp-sample
spec:
  size: 3</pre></div><div class='content'></div><h2>Step 3: Implement the Controller</h2>
<div class='content'><p>The controller watches the custom resources and ensures the desired state is maintained.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBteWFwcC1jb250cm9sbGVyLnB5CmZyb20ga3ViZXJuZXRlcyBpbXBvcnQgY2xpZW50LCBjb25maWcsIHdhdGNoCgpkZWYgbWFpbigpOgogICAgY29uZmlnLmxvYWRfa3ViZV9jb25maWcoKQogICAgdjEgPSBjbGllbnQuQ3VzdG9tT2JqZWN0c0FwaSgpCiAgICB3ID0gd2F0Y2guV2F0Y2goKQoKICAgIGZvciBldmVudCBpbiB3LnN0cmVhbSh2MS5saXN0X25hbWVzcGFjZWRfY3VzdG9tX29iamVjdCwgZ3JvdXA9ImV4YW1wbGUuY29tIiwgdmVyc2lvbj0idjEiLCBuYW1lc3BhY2U9ImRlZmF1bHQiLCBwbHVyYWw9Im15YXBwcyIpOgogICAgICAgIHByaW50KCJFdmVudDogJXMgJXMiICUgKGV2ZW50Wyd0eXBlJ10sIGV2ZW50WydvYmplY3QnXVsnbWV0YWRhdGEnXVsnbmFtZSddKSkKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBtYWluKCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># myapp-controller.py
from kubernetes import client, config, watch

def main():
    config.load_kube_config()
    v1 = client.CustomObjectsApi()
    w = watch.Watch()

    for event in w.stream(v1.list_namespaced_custom_object, group=&quot;example.com&quot;, version=&quot;v1&quot;, namespace=&quot;default&quot;, plural=&quot;myapps&quot;):
        print(&quot;Event: %s %s&quot; % (event['type'], event['object']['metadata']['name']))

if __name__ == '__main__':
    main()</pre></div><div class='content'></div><h1>Advanced Operator Patterns</h1>
<div class='content'><ul>
<li><strong>Stateful Applications</strong>: Operators can manage stateful applications like databases, ensuring data consistency and availability.</li>
<li><strong>Backup and Restore</strong>: Operators can automate backup and restore processes for applications.</li>
<li><strong>Scaling</strong>: Operators can manage the scaling of applications based on custom metrics.</li>
</ul>
</div><h1>Operator Frameworks</h1>
<div class='content'><p>Several frameworks can help you build operators more efficiently:</p>
<ul>
<li><strong>Operator SDK</strong>: A framework that provides tools to build, test, and package operators.</li>
<li><strong>Kubebuilder</strong>: A framework for building Kubernetes APIs using CRDs.</li>
</ul>
</div><h1>Example: Using Operator SDK</h1>
<h2>Step 1: Install Operator SDK</h2>
<div class='content'><p>Follow the installation instructions from the <a href="https://sdk.operatorframework.io/docs/installation/">Operator SDK documentation</a>.</p>
</div><h2>Step 2: Create a New Operator Project</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("b3BlcmF0b3Itc2RrIGluaXQgLS1kb21haW4gZXhhbXBsZS5jb20gLS1yZXBvIGdpdGh1Yi5jb20vZXhhbXBsZS9teWFwcC1vcGVyYXRvcg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>operator-sdk init --domain example.com --repo github.com/example/myapp-operator</pre></div><div class='content'></div><h2>Step 3: Define the API</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("b3BlcmF0b3Itc2RrIGNyZWF0ZSBhcGkgLS1ncm91cCBleGFtcGxlIC0tdmVyc2lvbiB2MSAtLWtpbmQgTXlBcHAgLS1yZXNvdXJjZSAtLWNvbnRyb2xsZXI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>operator-sdk create api --group example --version v1 --kind MyApp --resource --controller</pre></div><div class='content'></div><h2>Step 4: Implement the Reconciliation Logic</h2>
<div class='content'><p>Edit the generated controller file to implement your reconciliation logic.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gY29udHJvbGxlcnMvbXlhcHBfY29udHJvbGxlci5nbwpmdW5jIChyICpNeUFwcFJlY29uY2lsZXIpIFJlY29uY2lsZShjdHggY29udGV4dC5Db250ZXh0LCByZXEgY3RybC5SZXF1ZXN0KSAoY3RybC5SZXN1bHQsIGVycm9yKSB7CiAgICAvLyBGZXRjaCB0aGUgTXlBcHAgaW5zdGFuY2UKICAgIG15YXBwIDo9ICZleGFtcGxldjEuTXlBcHB7fQogICAgZXJyIDo9IHIuR2V0KGN0eCwgcmVxLk5hbWVzcGFjZWROYW1lLCBteWFwcCkKICAgIGlmIGVyciAhPSBuaWwgewogICAgICAgIHJldHVybiBjdHJsLlJlc3VsdHt9LCBjbGllbnQuSWdub3JlTm90Rm91bmQoZXJyKQogICAgfQoKICAgIC8vIEltcGxlbWVudCB5b3VyIHJlY29uY2lsaWF0aW9uIGxvZ2ljIGhlcmUKCiAgICByZXR1cm4gY3RybC5SZXN1bHR7fSwgbmlsCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// controllers/myapp_controller.go
func (r *MyAppReconciler) Reconcile(ctx context.Context, req ctrl.Request) (ctrl.Result, error) {
    // Fetch the MyApp instance
    myapp := &amp;examplev1.MyApp{}
    err := r.Get(ctx, req.NamespacedName, myapp)
    if err != nil {
        return ctrl.Result{}, client.IgnoreNotFound(err)
    }

    // Implement your reconciliation logic here

    return ctrl.Result{}, nil
}</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Operators are a powerful way to extend Kubernetes capabilities to manage complex applications. By defining custom resources and implementing controllers, you can automate the management of stateful applications, backups, scaling, and more. Using frameworks like Operator SDK and Kubebuilder can simplify the development process, allowing you to focus on the business logic of your operator.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='custom-resource-definitions'>&#x25C4;Custom Resource Definitions (CRDs)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Operators in Kubernetes</a>
	</div>
	<div class='col-4 text-end'>
					<a href='helm-and-package-management'>Helm and Package Management &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
