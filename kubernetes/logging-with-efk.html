<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logging with Elasticsearch, Fluentd, and Kibana (EFK)</title>

    <link rel="alternate" href="https://campusempresa.com/kubernetes/logging-with-efk" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/kubernetes/logging-with-efk" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/kubernetes/logging-with-efk" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/kubernetes/logging-with-efk" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/kubernetes/logging-with-efk" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='monitoring-with-prometheus'>&#x25C4;Monitoring with Prometheus</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Logging with Elasticsearch, Fluentd, and Kibana (EFK)</a>
	</div>
	<div class='col-4 text-end'>
					<a href='tracing-with-jaeger'>Tracing with Jaeger &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to EFK Stack</h1>
<div class='content'><p>The EFK stack is a powerful set of tools used for logging and monitoring in Kubernetes environments. It consists of:</p>
<ul>
<li><strong>Elasticsearch</strong>: A search and analytics engine.</li>
<li><strong>Fluentd</strong>: A data collector for unified logging.</li>
<li><strong>Kibana</strong>: A visualization tool for Elasticsearch data.</li>
</ul>
</div><h1>Why Use EFK in Kubernetes?</h1>
<div class='content'><ul>
<li><strong>Centralized Logging</strong>: Collect logs from all pods and nodes in one place.</li>
<li><strong>Scalability</strong>: Handle large volumes of logs efficiently.</li>
<li><strong>Search and Analysis</strong>: Use Elasticsearch to search and analyze logs.</li>
<li><strong>Visualization</strong>: Use Kibana to create dashboards and visualize log data.</li>
</ul>
</div><h1>Setting Up EFK Stack in Kubernetes</h1>
<div class='content'></div><h2>Prerequisites</h2>
<div class='content'><ul>
<li>A running Kubernetes cluster.</li>
<li><code>kubectl</code> command-line tool configured to interact with your cluster.</li>
</ul>
</div><h2>Step 1: Deploy Elasticsearch</h2>
<div class='content'><p>Elasticsearch will store and index the logs collected from the Kubernetes cluster.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBpVmVyc2lvbjogYXBwcy92MQpraW5kOiBTdGF0ZWZ1bFNldAptZXRhZGF0YToKICBuYW1lOiBlbGFzdGljc2VhcmNoCnNwZWM6CiAgc2VydmljZU5hbWU6ICJlbGFzdGljc2VhcmNoIgogIHJlcGxpY2FzOiAxCiAgc2VsZWN0b3I6CiAgICBtYXRjaExhYmVsczoKICAgICAgYXBwOiBlbGFzdGljc2VhcmNoCiAgdGVtcGxhdGU6CiAgICBtZXRhZGF0YToKICAgICAgbGFiZWxzOgogICAgICAgIGFwcDogZWxhc3RpY3NlYXJjaAogICAgc3BlYzoKICAgICAgY29udGFpbmVyczoKICAgICAgLSBuYW1lOiBlbGFzdGljc2VhcmNoCiAgICAgICAgaW1hZ2U6IGRvY2tlci5lbGFzdGljLmNvL2VsYXN0aWNzZWFyY2gvZWxhc3RpY3NlYXJjaDo3LjEwLjEKICAgICAgICBwb3J0czoKICAgICAgICAtIGNvbnRhaW5lclBvcnQ6IDkyMDAKICAgICAgICAgIG5hbWU6IGh0dHAKICAgICAgICAtIGNvbnRhaW5lclBvcnQ6IDkzMDAKICAgICAgICAgIG5hbWU6IHRyYW5zcG9ydAogICAgICAgIGVudjoKICAgICAgICAtIG5hbWU6IGRpc2NvdmVyeS50eXBlCiAgICAgICAgICB2YWx1ZTogc2luZ2xlLW5vZGU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: elasticsearch
spec:
  serviceName: &quot;elasticsearch&quot;
  replicas: 1
  selector:
    matchLabels:
      app: elasticsearch
  template:
    metadata:
      labels:
        app: elasticsearch
    spec:
      containers:
      - name: elasticsearch
        image: docker.elastic.co/elasticsearch/elasticsearch:7.10.1
        ports:
        - containerPort: 9200
          name: http
        - containerPort: 9300
          name: transport
        env:
        - name: discovery.type
          value: single-node</pre></div><div class='content'></div><h2>Step 2: Deploy Fluentd</h2>
<div class='content'><p>Fluentd will collect logs from the Kubernetes nodes and forward them to Elasticsearch.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBpVmVyc2lvbjogYXBwcy92MQpraW5kOiBEYWVtb25TZXQKbWV0YWRhdGE6CiAgbmFtZTogZmx1ZW50ZAogIGxhYmVsczoKICAgIGs4cy1hcHA6IGZsdWVudGQtbG9nZ2luZwpzcGVjOgogIHNlbGVjdG9yOgogICAgbWF0Y2hMYWJlbHM6CiAgICAgIG5hbWU6IGZsdWVudGQKICB0ZW1wbGF0ZToKICAgIG1ldGFkYXRhOgogICAgICBsYWJlbHM6CiAgICAgICAgbmFtZTogZmx1ZW50ZAogICAgc3BlYzoKICAgICAgY29udGFpbmVyczoKICAgICAgLSBuYW1lOiBmbHVlbnRkCiAgICAgICAgaW1hZ2U6IGZsdWVudC9mbHVlbnRkOnYxLjExLjUtZGViaWFuLTEuMAogICAgICAgIGVudjoKICAgICAgICAtIG5hbWU6IEZMVUVOVF9FTEFTVElDU0VBUkNIX0hPU1QKICAgICAgICAgIHZhbHVlOiAiZWxhc3RpY3NlYXJjaCIKICAgICAgICAtIG5hbWU6IEZMVUVOVF9FTEFTVElDU0VBUkNIX1BPUlQKICAgICAgICAgIHZhbHVlOiAiOTIwMCIKICAgICAgICB2b2x1bWVNb3VudHM6CiAgICAgICAgLSBuYW1lOiB2YXJsb2cKICAgICAgICAgIG1vdW50UGF0aDogL3Zhci9sb2cKICAgICAgICAtIG5hbWU6IHZhcmxpYmRvY2tlcmNvbnRhaW5lcnMKICAgICAgICAgIG1vdW50UGF0aDogL3Zhci9saWIvZG9ja2VyL2NvbnRhaW5lcnMKICAgICAgICAgIHJlYWRPbmx5OiB0cnVlCiAgICAgIHZvbHVtZXM6CiAgICAgIC0gbmFtZTogdmFybG9nCiAgICAgICAgaG9zdFBhdGg6CiAgICAgICAgICBwYXRoOiAvdmFyL2xvZwogICAgICAtIG5hbWU6IHZhcmxpYmRvY2tlcmNvbnRhaW5lcnMKICAgICAgICBob3N0UGF0aDoKICAgICAgICAgIHBhdGg6IC92YXIvbGliL2RvY2tlci9jb250YWluZXJz"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: fluentd
  labels:
    k8s-app: fluentd-logging
spec:
  selector:
    matchLabels:
      name: fluentd
  template:
    metadata:
      labels:
        name: fluentd
    spec:
      containers:
      - name: fluentd
        image: fluent/fluentd:v1.11.5-debian-1.0
        env:
        - name: FLUENT_ELASTICSEARCH_HOST
          value: &quot;elasticsearch&quot;
        - name: FLUENT_ELASTICSEARCH_PORT
          value: &quot;9200&quot;
        volumeMounts:
        - name: varlog
          mountPath: /var/log
        - name: varlibdockercontainers
          mountPath: /var/lib/docker/containers
          readOnly: true
      volumes:
      - name: varlog
        hostPath:
          path: /var/log
      - name: varlibdockercontainers
        hostPath:
          path: /var/lib/docker/containers</pre></div><div class='content'></div><h2>Step 3: Deploy Kibana</h2>
<div class='content'><p>Kibana will provide a web interface to visualize the logs stored in Elasticsearch.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBpVmVyc2lvbjogYXBwcy92MQpraW5kOiBEZXBsb3ltZW50Cm1ldGFkYXRhOgogIG5hbWU6IGtpYmFuYQpzcGVjOgogIHJlcGxpY2FzOiAxCiAgc2VsZWN0b3I6CiAgICBtYXRjaExhYmVsczoKICAgICAgYXBwOiBraWJhbmEKICB0ZW1wbGF0ZToKICAgIG1ldGFkYXRhOgogICAgICBsYWJlbHM6CiAgICAgICAgYXBwOiBraWJhbmEKICAgIHNwZWM6CiAgICAgIGNvbnRhaW5lcnM6CiAgICAgIC0gbmFtZToga2liYW5hCiAgICAgICAgaW1hZ2U6IGRvY2tlci5lbGFzdGljLmNvL2tpYmFuYS9raWJhbmE6Ny4xMC4xCiAgICAgICAgcG9ydHM6CiAgICAgICAgLSBjb250YWluZXJQb3J0OiA1NjAxCiAgICAgICAgZW52OgogICAgICAgIC0gbmFtZTogRUxBU1RJQ1NFQVJDSF9IT1NUUwogICAgICAgICAgdmFsdWU6ICJodHRwOi8vZWxhc3RpY3NlYXJjaDo5MjAwIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>apiVersion: apps/v1
kind: Deployment
metadata:
  name: kibana
spec:
  replicas: 1
  selector:
    matchLabels:
      app: kibana
  template:
    metadata:
      labels:
        app: kibana
    spec:
      containers:
      - name: kibana
        image: docker.elastic.co/kibana/kibana:7.10.1
        ports:
        - containerPort: 5601
        env:
        - name: ELASTICSEARCH_HOSTS
          value: &quot;http://elasticsearch:9200&quot;</pre></div><div class='content'></div><h2>Step 4: Expose Kibana</h2>
<div class='content'><p>Create a service to expose Kibana so you can access it from your browser.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBpVmVyc2lvbjogdjEKa2luZDogU2VydmljZQptZXRhZGF0YToKICBuYW1lOiBraWJhbmEKc3BlYzoKICBzZWxlY3RvcjoKICAgIGFwcDoga2liYW5hCiAgcG9ydHM6CiAgLSBwcm90b2NvbDogVENQCiAgICBwb3J0OiA1NjAxCiAgICB0YXJnZXRQb3J0OiA1NjAxCiAgdHlwZTogTm9kZVBvcnQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>apiVersion: v1
kind: Service
metadata:
  name: kibana
spec:
  selector:
    app: kibana
  ports:
  - protocol: TCP
    port: 5601
    targetPort: 5601
  type: NodePort</pre></div><div class='content'></div><h1>Accessing Kibana</h1>
<div class='content'><ul>
<li>Get the NodePort assigned to the Kibana service:
<pre><code class="language-sh">kubectl get svc kibana
</code></pre>
</li>
<li>Access Kibana using the Node IP and NodePort in your browser:
<pre><code>http://&lt;NodeIP&gt;:&lt;NodePort&gt;
</code></pre>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>The EFK stack provides a robust solution for logging and monitoring in Kubernetes environments. By deploying Elasticsearch, Fluentd, and Kibana, you can centralize, search, and visualize logs from your entire Kubernetes cluster, making it easier to monitor and troubleshoot your applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='monitoring-with-prometheus'>&#x25C4;Monitoring with Prometheus</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Logging with Elasticsearch, Fluentd, and Kibana (EFK)</a>
	</div>
	<div class='col-4 text-end'>
					<a href='tracing-with-jaeger'>Tracing with Jaeger &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
