<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Data Analysis</title>

    <link rel="alternate" href="https://campusempresa.com/mod/bigquery/10-02-financial-data-analysis" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/bigquery/10-02-financial-data-analysis" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/bigquery/10-02-financial-data-analysis" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=2" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/bigquery/10-02-financial-data-analysis" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/bigquery/10-02-financial-data-analysis" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Programming Languages</a>
				 					<a href="/categ/frameworks">Frameworks and Libraries</a>
				 					<a href="/categ/tech-tools">Technical Tools</a>
				 					<a href="/categ/foundations">Theoretical Foundations</a>
				 					<a href="/categ/soft-skills">Social Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='10-01-analyzing-web-app-analytics' title="Analyzing Web and App Analytics">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Financial Data Analysis</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='10-03-iot-data-processing' title="IoT Data Processing">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this module, we will explore how to use BigQuery for financial data analysis. Financial data analysis involves examining financial data to understand the financial health of an organization, identify trends, and make informed business decisions. BigQuery's powerful querying capabilities make it an excellent tool for handling large volumes of financial data.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Financial Data Types</strong>:</p>
<ul>
<li><strong>Transactional Data</strong>: Records of individual transactions, such as sales, purchases, and payments.</li>
<li><strong>Market Data</strong>: Information about financial markets, including stock prices, exchange rates, and interest rates.</li>
<li><strong>Financial Statements</strong>: Summarized reports of financial performance, including balance sheets, income statements, and cash flow statements.</li>
</ul>
</li>
<li>
<p><strong>Common Financial Metrics</strong>:</p>
<ul>
<li><strong>Revenue</strong>: Total income generated from sales.</li>
<li><strong>Expenses</strong>: Costs incurred in the process of earning revenue.</li>
<li><strong>Profit</strong>: Revenue minus expenses.</li>
<li><strong>Cash Flow</strong>: Net amount of cash being transferred into and out of a business.</li>
<li><strong>Return on Investment (ROI)</strong>: Measure of the profitability of an investment.</li>
</ul>
</li>
</ol>
</div><h1><p>Practical Example: Analyzing Transactional Data</p>
</h1>
<div class='content'></div><h2><p>Step 1: Setting Up the Dataset</p>
</h2>
<div class='content'><p>First, let's assume we have a dataset named <code>financial_data</code> with a table <code>transactions</code> that contains the following fields:</p>
<ul>
<li><code>transaction_id</code>: Unique identifier for each transaction.</li>
<li><code>date</code>: Date of the transaction.</li>
<li><code>amount</code>: Amount of money involved in the transaction.</li>
<li><code>type</code>: Type of transaction (e.g., 'sale', 'purchase', 'refund').</li>
</ul>
</div><h2><p>Step 2: Basic SQL Queries</p>
</h2>
<div class='content'><h4>Query 1: Total Revenue</h4>
<p>To calculate the total revenue from sales, we can use the following query:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgU1VNKGFtb3VudCkgQVMgdG90YWxfcmV2ZW51ZQpGUk9NIAogICAgYHByb2plY3RfaWQuZGF0YXNldF9pZC50cmFuc2FjdGlvbnNgCldIRVJFIAogICAgdHlwZSA9ICdzYWxlJzs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    SUM(amount) AS total_revenue
FROM 
    `project_id.dataset_id.transactions`
WHERE 
    type = 'sale';</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>SUM(amount)</code>: Calculates the total amount of all transactions.</li>
<li><code>WHERE type = 'sale'</code>: Filters the transactions to include only sales.</li>
</ul>
<h4>Query 2: Monthly Revenue</h4>
<p>To calculate the monthly revenue, we can group the transactions by month:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgRVhUUkFDVChZRUFSIEZST00gZGF0ZSkgQVMgeWVhciwKICAgIEVYVFJBQ1QoTU9OVEggRlJPTSBkYXRlKSBBUyBtb250aCwKICAgIFNVTShhbW91bnQpIEFTIG1vbnRobHlfcmV2ZW51ZQpGUk9NIAogICAgYHByb2plY3RfaWQuZGF0YXNldF9pZC50cmFuc2FjdGlvbnNgCldIRVJFIAogICAgdHlwZSA9ICdzYWxlJwpHUk9VUCBCWSAKICAgIHllYXIsIG1vbnRoCk9SREVSIEJZIAogICAgeWVhciwgbW9udGg7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    EXTRACT(YEAR FROM date) AS year,
    EXTRACT(MONTH FROM date) AS month,
    SUM(amount) AS monthly_revenue
FROM 
    `project_id.dataset_id.transactions`
WHERE 
    type = 'sale'
GROUP BY 
    year, month
ORDER BY 
    year, month;</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>EXTRACT(YEAR FROM date)</code>, <code>EXTRACT(MONTH FROM date)</code>: Extracts the year and month from the transaction date.</li>
<li><code>GROUP BY year, month</code>: Groups the transactions by year and month.</li>
<li><code>ORDER BY year, month</code>: Orders the results by year and month.</li>
</ul>
</div><h2><p>Step 3: Advanced Analysis</p>
</h2>
<div class='content'><h4>Query 3: Profit Calculation</h4>
<p>To calculate the profit, we need to consider both sales and expenses:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgU1VNKENBU0UgV0hFTiB0eXBlID0gJ3NhbGUnIFRIRU4gYW1vdW50IEVMU0UgMCBFTkQpIEFTIHRvdGFsX3JldmVudWUsCiAgICBTVU0oQ0FTRSBXSEVOIHR5cGUgPSAncHVyY2hhc2UnIFRIRU4gYW1vdW50IEVMU0UgMCBFTkQpIEFTIHRvdGFsX2V4cGVuc2VzLAogICAgU1VNKENBU0UgV0hFTiB0eXBlID0gJ3NhbGUnIFRIRU4gYW1vdW50IEVMU0UgMCBFTkQpIC0gCiAgICBTVU0oQ0FTRSBXSEVOIHR5cGUgPSAncHVyY2hhc2UnIFRIRU4gYW1vdW50IEVMU0UgMCBFTkQpIEFTIHByb2ZpdApGUk9NIAogICAgYHByb2plY3RfaWQuZGF0YXNldF9pZC50cmFuc2FjdGlvbnNgOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    SUM(CASE WHEN type = 'sale' THEN amount ELSE 0 END) AS total_revenue,
    SUM(CASE WHEN type = 'purchase' THEN amount ELSE 0 END) AS total_expenses,
    SUM(CASE WHEN type = 'sale' THEN amount ELSE 0 END) - 
    SUM(CASE WHEN type = 'purchase' THEN amount ELSE 0 END) AS profit
FROM 
    `project_id.dataset_id.transactions`;</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>CASE WHEN type = 'sale' THEN amount ELSE 0 END</code>: Includes the amount only if the transaction is a sale.</li>
<li><code>CASE WHEN type = 'purchase' THEN amount ELSE 0 END</code>: Includes the amount only if the transaction is a purchase.</li>
<li><code>SUM(... - ...) AS profit</code>: Calculates the profit by subtracting total expenses from total revenue.</li>
</ul>
</div><h2><p>Step 4: Visualizing Data</p>
</h2>
<div class='content'><p>To visualize the financial data, you can use tools like Google Data Studio. Hereâ€™s a simple example of how to create a dashboard:</p>
<ol>
<li>
<p><strong>Connect BigQuery to Data Studio</strong>:</p>
<ul>
<li>Open Google Data Studio.</li>
<li>Create a new report and select BigQuery as the data source.</li>
<li>Choose the <code>financial_data.transactions</code> table.</li>
</ul>
</li>
<li>
<p><strong>Create Charts</strong>:</p>
<ul>
<li>Add a time series chart to visualize monthly revenue.</li>
<li>Add a bar chart to compare total revenue and total expenses.</li>
</ul>
</li>
</ol>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Calculate Quarterly Revenue</p>
</h2>
<div class='content'><p>Write a query to calculate the total revenue for each quarter.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgRVhUUkFDVChZRUFSIEZST00gZGF0ZSkgQVMgeWVhciwKICAgIEVYVFJBQ1QoUVVBUlRFUiBGUk9NIGRhdGUpIEFTIHF1YXJ0ZXIsCiAgICBTVU0oYW1vdW50KSBBUyBxdWFydGVybHlfcmV2ZW51ZQpGUk9NIAogICAgYHByb2plY3RfaWQuZGF0YXNldF9pZC50cmFuc2FjdGlvbnNgCldIRVJFIAogICAgdHlwZSA9ICdzYWxlJwpHUk9VUCBCWSAKICAgIHllYXIsIHF1YXJ0ZXIKT1JERVIgQlkgCiAgICB5ZWFyLCBxdWFydGVyOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    EXTRACT(YEAR FROM date) AS year,
    EXTRACT(QUARTER FROM date) AS quarter,
    SUM(amount) AS quarterly_revenue
FROM 
    `project_id.dataset_id.transactions`
WHERE 
    type = 'sale'
GROUP BY 
    year, quarter
ORDER BY 
    year, quarter;</pre></div><div class='content'></div><h2><p>Exercise 2: Identify Top 5 Transactions</p>
</h2>
<div class='content'><p>Write a query to identify the top 5 transactions by amount.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogICAgdHJhbnNhY3Rpb25faWQsCiAgICBkYXRlLAogICAgYW1vdW50CkZST00gCiAgICBgcHJvamVjdF9pZC5kYXRhc2V0X2lkLnRyYW5zYWN0aW9uc2AKT1JERVIgQlkgCiAgICBhbW91bnQgREVTQwpMSU1JVCA1Ow=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
    transaction_id,
    date,
    amount
FROM 
    `project_id.dataset_id.transactions`
ORDER BY 
    amount DESC
LIMIT 5;</pre></div><div class='content'></div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Incorrect Date Extraction</strong>: Ensure you use the correct functions to extract date parts (e.g., <code>EXTRACT(YEAR FROM date)</code>).</li>
<li><strong>Filtering Data</strong>: Always double-check your <code>WHERE</code> clauses to ensure you are filtering the data correctly.</li>
<li><strong>Grouping Data</strong>: When using <code>GROUP BY</code>, make sure all non-aggregated columns are included in the <code>GROUP BY</code> clause.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered the basics of financial data analysis using BigQuery. We explored how to set up a dataset, write basic and advanced SQL queries, and visualize the data. By mastering these techniques, you can effectively analyze financial data to gain valuable insights and make informed business decisions. In the next module, we will delve into real-world use cases and advanced features of BigQuery.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='10-01-analyzing-web-app-analytics' title="Analyzing Web and App Analytics">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='10-03-iot-data-processing' title="IoT Data Processing">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
