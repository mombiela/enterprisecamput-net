<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scheduling Queries</title>

    <link rel="alternate" href="https://campusempresa.com/mod/bigquery/scheduling-queries" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/bigquery/scheduling-queries" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/bigquery/scheduling-queries" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/bigquery/scheduling-queries" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/bigquery/scheduling-queries" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='automating-workflows-with-bigquery'>&#x25C4;Automating Workflows with BigQuery</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Scheduling Queries</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-apis-and-client-libraries'>Using APIs and Client Libraries &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Scheduling queries in BigQuery allows you to automate the execution of SQL queries at specified intervals. This is particularly useful for tasks such as generating regular reports, updating datasets, or performing routine data analysis.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Scheduled Queries</strong>: Queries that are set to run automatically at specified intervals.</li>
<li><strong>Cloud Scheduler</strong>: A fully managed cron job service that allows you to schedule virtually any job, including BigQuery queries.</li>
<li><strong>BigQuery Data Transfer Service</strong>: A service that automates data movement into BigQuery on a scheduled, managed basis.</li>
</ul>
</div><h1>Setting Up Scheduled Queries</h1>
<div class='content'></div><h2>Using the BigQuery UI</h2>
<div class='content'><ol>
<li><strong>Navigate to the BigQuery Console</strong>:
<ul>
<li>Go to the BigQuery web UI in the Google Cloud Console.</li>
</ul>
</li>
<li><strong>Create a New Scheduled Query</strong>:
<ul>
<li>Click on the &quot;Scheduled Queries&quot; tab.</li>
<li>Click on &quot;Create Scheduled Query&quot;.</li>
</ul>
</li>
<li><strong>Configure the Query</strong>:
<ul>
<li>Enter the SQL query you want to schedule.</li>
<li>Set the destination table where the results will be stored.</li>
</ul>
</li>
<li><strong>Set the Schedule</strong>:
<ul>
<li>Define the frequency (e.g., daily, weekly) and the specific time for the query to run.</li>
</ul>
</li>
<li><strong>Save and Activate</strong>:
<ul>
<li>Save the scheduled query and ensure it is activated.</li>
</ul>
</li>
</ol>
</div><h2>Using Cloud Scheduler</h2>
<div class='content'><ol>
<li><strong>Create a Cloud Scheduler Job</strong>:
<ul>
<li>Navigate to the Cloud Scheduler page in the Google Cloud Console.</li>
<li>Click on &quot;Create Job&quot;.</li>
</ul>
</li>
<li><strong>Configure the Job</strong>:
<ul>
<li>Set the frequency using cron syntax.</li>
<li>Choose the target type as &quot;HTTP&quot;.</li>
<li>Set the URL to trigger a Cloud Function or Cloud Run service that runs the BigQuery query.</li>
</ul>
</li>
<li><strong>Write the Cloud Function</strong>:
<ul>
<li>Create a Cloud Function that contains the BigQuery query logic.</li>
<li>Example:
<pre><code class="language-python">from google.cloud import bigquery

def run_query(request):
    client = bigquery.Client()
    query = &quot;&quot;&quot;
    SELECT name, COUNT(*) as name_count
    FROM `project.dataset.table`
    GROUP BY name
    &quot;&quot;&quot;
    query_job = client.query(query)
    results = query_job.result()
    return &quot;Query executed successfully&quot;
</code></pre>
</li>
</ul>
</li>
<li><strong>Deploy the Cloud Function</strong>:
<ul>
<li>Deploy the Cloud Function and note the URL.</li>
</ul>
</li>
<li><strong>Link Cloud Scheduler to Cloud Function</strong>:
<ul>
<li>Use the URL of the deployed Cloud Function in the Cloud Scheduler job.</li>
</ul>
</li>
</ol>
</div><h2>Using BigQuery Data Transfer Service</h2>
<div class='content'><ol>
<li><strong>Navigate to the BigQuery Data Transfer Service</strong>:
<ul>
<li>Go to the BigQuery Data Transfer Service page in the Google Cloud Console.</li>
</ul>
</li>
<li><strong>Create a Transfer</strong>:
<ul>
<li>Click on &quot;Create Transfer&quot;.</li>
</ul>
</li>
<li><strong>Select Data Source</strong>:
<ul>
<li>Choose &quot;Scheduled Query&quot; as the data source.</li>
</ul>
</li>
<li><strong>Configure the Query</strong>:
<ul>
<li>Enter the SQL query and set the destination table.</li>
</ul>
</li>
<li><strong>Set the Schedule</strong>:
<ul>
<li>Define the frequency and start time for the query.</li>
</ul>
</li>
<li><strong>Save and Activate</strong>:
<ul>
<li>Save the transfer configuration and ensure it is activated.</li>
</ul>
</li>
</ol>
</div><h1>Example: Scheduling a Daily Sales Report</h1>
<div class='content'></div><h2>SQL Query</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUCiAgREFURShvcmRlcl9kYXRlKSBhcyBkYXRlLAogIFNVTSh0b3RhbF9hbW91bnQpIGFzIHRvdGFsX3NhbGVzCkZST00KICBgcHJvamVjdC5kYXRhc2V0Lm9yZGVyc2AKR1JPVVAgQlkKICBkYXRlCk9SREVSIEJZCiAgZGF0ZTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT
  DATE(order_date) as date,
  SUM(total_amount) as total_sales
FROM
  `project.dataset.orders`
GROUP BY
  date
ORDER BY
  date;</pre></div><div class='content'></div><h2>Steps to Schedule</h2>
<div class='content'><ol>
<li>
<p><strong>Using BigQuery UI</strong>:</p>
<ul>
<li>Enter the above SQL query.</li>
<li>Set the destination table to <code>project.dataset.daily_sales_report</code>.</li>
<li>Schedule it to run daily at 2 AM.</li>
</ul>
</li>
<li>
<p><strong>Using Cloud Scheduler and Cloud Function</strong>:</p>
<ul>
<li>Write a Cloud Function with the above query.</li>
<li>Deploy the Cloud Function.</li>
<li>Create a Cloud Scheduler job to trigger the Cloud Function daily at 2 AM.</li>
</ul>
</li>
<li>
<p><strong>Using BigQuery Data Transfer Service</strong>:</p>
<ul>
<li>Create a transfer with the above SQL query.</li>
<li>Set the destination table to <code>project.dataset.daily_sales_report</code>.</li>
<li>Schedule it to run daily at 2 AM.</li>
</ul>
</li>
</ol>
</div><h1>Conclusion</h1>
<div class='content'><p>Scheduling queries in BigQuery is a powerful feature that can save time and ensure consistency in data analysis and reporting. Whether using the BigQuery UI, Cloud Scheduler, or the BigQuery Data Transfer Service, you can automate your data workflows efficiently. Understanding these methods allows you to choose the best approach for your specific needs and integrate automated data processing into your projects seamlessly.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='automating-workflows-with-bigquery'>&#x25C4;Automating Workflows with BigQuery</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Scheduling Queries</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-apis-and-client-libraries'>Using APIs and Client Libraries &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
