<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading Data into BigQuery</title>

    <link rel="alternate" href="https://campusempresa.com/mod/bigquery/05-01-loading-data" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/bigquery/05-01-loading-data" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/bigquery/05-01-loading-data" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/bigquery/05-01-loading-data" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/bigquery/05-01-loading-data" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-04-partitioning-clustering' title="Partitioning and Clustering">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Loading Data into BigQuery</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-02-exporting-data' title="Exporting Data from BigQuery">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Loading data into BigQuery is a fundamental skill that allows you to leverage the power of BigQuery for data analysis and processing. In this section, we will cover various methods to load data into BigQuery, including using the BigQuery web UI, the command-line tool, and programmatically using APIs.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Data Sources</strong>: Understand the different data sources you can load into BigQuery, such as CSV, JSON, Avro, Parquet, and ORC files.</li>
<li><strong>Loading Methods</strong>: Learn the different methods to load data, including the BigQuery web UI, the <code>bq</code> command-line tool, and the BigQuery API.</li>
<li><strong>Schema Definition</strong>: Understand how to define the schema for your data, either manually or automatically.</li>
<li><strong>Data Loading Options</strong>: Explore various options and configurations available during the data loading process, such as write disposition and field delimiter.</li>
</ol>
</div><h1><p>Data Sources</p>
</h1>
<div class='content'><p>BigQuery supports loading data from various sources, including:</p>
<ul>
<li><strong>Cloud Storage</strong>: Load data from Google Cloud Storage buckets.</li>
<li><strong>Local Files</strong>: Upload data directly from your local machine.</li>
<li><strong>Google Drive</strong>: Import data from Google Drive.</li>
<li><strong>Other BigQuery Tables</strong>: Copy data from existing BigQuery tables.</li>
</ul>
</div><h1><p>Loading Methods</p>
</h1>
<div class='content'></div><h2><p>Using the BigQuery Web UI</p>
</h2>
<div class='content'><ol>
<li><strong>Navigate to the BigQuery Console</strong>: Open the BigQuery console in your browser.</li>
<li><strong>Select Your Dataset</strong>: In the navigation pane, select the dataset where you want to load the data.</li>
<li><strong>Click on &quot;Create Table&quot;</strong>: Click the &quot;Create Table&quot; button.</li>
<li><strong>Specify the Source</strong>: Choose the source of your data (e.g., Google Cloud Storage, Upload, Google Drive).</li>
<li><strong>Configure the Table</strong>: Provide the necessary details such as table name, schema, and other options.</li>
<li><strong>Load the Data</strong>: Click the &quot;Create Table&quot; button to start loading the data.</li>
</ol>
</div><h2><p>Using the <code>bq</code> Command-Line Tool</p>
</h2>
<div class='content'><p>The <code>bq</code> command-line tool provides a powerful way to load data into BigQuery. Here is an example of loading a CSV file from Google Cloud Storage:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YnEgbG9hZCAtLXNvdXJjZV9mb3JtYXQ9Q1NWIG15X2RhdGFzZXQubXlfdGFibGUgZ3M6Ly9teV9idWNrZXQvbXlfZmlsZS5jc3Ygc2NoZW1hLmpzb24="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>bq load --source_format=CSV my_dataset.my_table gs://my_bucket/my_file.csv schema.json</pre></div><div class='content'><ul>
<li><code>my_dataset.my_table</code>: The target dataset and table.</li>
<li><code>gs://my_bucket/my_file.csv</code>: The path to the source file in Google Cloud Storage.</li>
<li><code>schema.json</code>: The schema definition file.</li>
</ul>
</div><h2><p>Using the BigQuery API</p>
</h2>
<div class='content'><p>You can also load data programmatically using the BigQuery API. Here is an example in Python:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IGJpZ3F1ZXJ5CgojIEluaXRpYWxpemUgYSBCaWdRdWVyeSBjbGllbnQKY2xpZW50ID0gYmlncXVlcnkuQ2xpZW50KCkKCiMgRGVmaW5lIHRoZSBkYXRhc2V0IGFuZCB0YWJsZQpkYXRhc2V0X2lkID0gJ215X2RhdGFzZXQnCnRhYmxlX2lkID0gJ215X3RhYmxlJwoKIyBEZWZpbmUgdGhlIHNvdXJjZSBVUkkKc291cmNlX3VyaSA9ICdnczovL215X2J1Y2tldC9teV9maWxlLmNzdicKCiMgRGVmaW5lIHRoZSBzY2hlbWEKc2NoZW1hID0gWwogICAgYmlncXVlcnkuU2NoZW1hRmllbGQoIm5hbWUiLCAiU1RSSU5HIiksCiAgICBiaWdxdWVyeS5TY2hlbWFGaWVsZCgiYWdlIiwgIklOVEVHRVIiKSwKICAgIGJpZ3F1ZXJ5LlNjaGVtYUZpZWxkKCJlbWFpbCIsICJTVFJJTkciKSwKXQoKIyBDb25maWd1cmUgdGhlIGxvYWQgam9iCmpvYl9jb25maWcgPSBiaWdxdWVyeS5Mb2FkSm9iQ29uZmlnKAogICAgc291cmNlX2Zvcm1hdD1iaWdxdWVyeS5Tb3VyY2VGb3JtYXQuQ1NWLAogICAgc2NoZW1hPXNjaGVtYSwKKQoKIyBMb2FkIHRoZSBkYXRhCmxvYWRfam9iID0gY2xpZW50LmxvYWRfdGFibGVfZnJvbV91cmkoCiAgICBzb3VyY2VfdXJpLAogICAgZiJ7ZGF0YXNldF9pZH0ue3RhYmxlX2lkfSIsCiAgICBqb2JfY29uZmlnPWpvYl9jb25maWcsCikKCiMgV2FpdCBmb3IgdGhlIGpvYiB0byBjb21wbGV0ZQpsb2FkX2pvYi5yZXN1bHQoKQoKcHJpbnQoIkRhdGEgbG9hZGVkIHN1Y2Nlc3NmdWxseS4iKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import bigquery

# Initialize a BigQuery client
client = bigquery.Client()

# Define the dataset and table
dataset_id = 'my_dataset'
table_id = 'my_table'

# Define the source URI
source_uri = 'gs://my_bucket/my_file.csv'

# Define the schema
schema = [
    bigquery.SchemaField(&quot;name&quot;, &quot;STRING&quot;),
    bigquery.SchemaField(&quot;age&quot;, &quot;INTEGER&quot;),
    bigquery.SchemaField(&quot;email&quot;, &quot;STRING&quot;),
]

# Configure the load job
job_config = bigquery.LoadJobConfig(
    source_format=bigquery.SourceFormat.CSV,
    schema=schema,
)

# Load the data
load_job = client.load_table_from_uri(
    source_uri,
    f&quot;{dataset_id}.{table_id}&quot;,
    job_config=job_config,
)

# Wait for the job to complete
load_job.result()

print(&quot;Data loaded successfully.&quot;)</pre></div><div class='content'></div><h1><p>Schema Definition</p>
</h1>
<div class='content'><p>When loading data into BigQuery, you need to define the schema of the table. The schema specifies the structure of the table, including the field names and data types. You can define the schema manually or let BigQuery auto-detect it.</p>
</div><h2><p>Manual Schema Definition</p>
</h2>
<div class='content'><p>You can define the schema using a JSON file. Here is an example schema definition:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("WwogICAgeyJuYW1lIjogIm5hbWUiLCAidHlwZSI6ICJTVFJJTkcifSwKICAgIHsibmFtZSI6ICJhZ2UiLCAidHlwZSI6ICJJTlRFR0VSIn0sCiAgICB7Im5hbWUiOiAiZW1haWwiLCAidHlwZSI6ICJTVFJJTkcifQpd"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>[
    {&quot;name&quot;: &quot;name&quot;, &quot;type&quot;: &quot;STRING&quot;},
    {&quot;name&quot;: &quot;age&quot;, &quot;type&quot;: &quot;INTEGER&quot;},
    {&quot;name&quot;: &quot;email&quot;, &quot;type&quot;: &quot;STRING&quot;}
]</pre></div><div class='content'></div><h2><p>Auto-Detect Schema</p>
</h2>
<div class='content'><p>BigQuery can automatically detect the schema based on the data. To enable auto-detect, set the <code>--autodetect</code> flag in the <code>bq</code> command-line tool or the <code>autodetect</code> property in the API.</p>
</div><h1><p>Data Loading Options</p>
</h1>
<div class='content'><p>When loading data, you can configure various options:</p>
<ul>
<li><strong>Write Disposition</strong>: Specifies whether to append to or overwrite the existing table. Options include <code>WRITE_TRUNCATE</code>, <code>WRITE_APPEND</code>, and <code>WRITE_EMPTY</code>.</li>
<li><strong>Field Delimiter</strong>: Specifies the delimiter used in the source file (e.g., comma for CSV files).</li>
<li><strong>Skip Leading Rows</strong>: Specifies the number of header rows to skip in the source file.</li>
</ul>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Load Data Using the Web UI</p>
</h2>
<div class='content'><ol>
<li>Create a dataset named <code>my_dataset</code>.</li>
<li>Download a sample CSV file from <a href="https://people.sc.fsu.edu/~jburkardt/data/csv/airtravel.csv">this link</a>.</li>
<li>Load the CSV file into a new table named <code>airtravel</code> in the <code>my_dataset</code> dataset using the BigQuery web UI.</li>
<li>Define the schema manually with the following fields:
<ul>
<li><code>Month</code> (STRING)</li>
<li><code>1958</code> (INTEGER)</li>
<li><code>1959</code> (INTEGER)</li>
<li><code>1960</code> (INTEGER)</li>
</ul>
</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'><ol>
<li>Navigate to the BigQuery console.</li>
<li>Select the <code>my_dataset</code> dataset.</li>
<li>Click on &quot;Create Table&quot;.</li>
<li>Choose &quot;Upload&quot; as the source and upload the <code>airtravel.csv</code> file.</li>
<li>Set the table name to <code>airtravel</code>.</li>
<li>Define the schema manually with the specified fields.</li>
<li>Click &quot;Create Table&quot; to load the data.</li>
</ol>
</div><h2><p>Exercise 2: Load Data Using the <code>bq</code> Command-Line Tool</p>
</h2>
<div class='content'><ol>
<li>Create a dataset named <code>my_dataset</code> if it doesn't exist.</li>
<li>Download the same sample CSV file.</li>
<li>Upload the CSV file to a Google Cloud Storage bucket.</li>
<li>Load the CSV file into a new table named <code>airtravel</code> in the <code>my_dataset</code> dataset using the <code>bq</code> command-line tool.</li>
<li>Define the schema using a JSON file.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'><ol>
<li>Upload the CSV file to a Google Cloud Storage bucket (e.g., <code>gs://my_bucket/airtravel.csv</code>).</li>
<li>Create a schema definition file named <code>schema.json</code> with the following content:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("WwogICAgeyJuYW1lIjogIk1vbnRoIiwgInR5cGUiOiAiU1RSSU5HIn0sCiAgICB7Im5hbWUiOiAiMTk1OCIsICJ0eXBlIjogIklOVEVHRVIifSwKICAgIHsibmFtZSI6ICIxOTU5IiwgInR5cGUiOiAiSU5URUdFUiJ9LAogICAgeyJuYW1lIjogIjE5NjAiLCAidHlwZSI6ICJJTlRFR0VSIn0KXQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>[
    {&quot;name&quot;: &quot;Month&quot;, &quot;type&quot;: &quot;STRING&quot;},
    {&quot;name&quot;: &quot;1958&quot;, &quot;type&quot;: &quot;INTEGER&quot;},
    {&quot;name&quot;: &quot;1959&quot;, &quot;type&quot;: &quot;INTEGER&quot;},
    {&quot;name&quot;: &quot;1960&quot;, &quot;type&quot;: &quot;INTEGER&quot;}
]</pre></div><div class='content'><ol start="3">
<li>Run the following command:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YnEgbG9hZCAtLXNvdXJjZV9mb3JtYXQ9Q1NWIG15X2RhdGFzZXQuYWlydHJhdmVsIGdzOi8vbXlfYnVja2V0L2FpcnRyYXZlbC5jc3Ygc2NoZW1hLmpzb24="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>bq load --source_format=CSV my_dataset.airtravel gs://my_bucket/airtravel.csv schema.json</pre></div><div class='content'></div><h1><p>Summary</p>
</h1>
<div class='content'><p>In this section, we covered the basics of loading data into BigQuery. We explored different data sources, loading methods, and schema definitions. We also provided practical exercises to reinforce the concepts. By mastering data loading, you can efficiently bring your data into BigQuery and start leveraging its powerful analytics capabilities.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-04-partitioning-clustering' title="Partitioning and Clustering">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-02-exporting-data' title="Exporting Data from BigQuery">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
