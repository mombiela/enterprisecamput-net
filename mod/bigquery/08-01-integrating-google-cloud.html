<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integrating with Google Cloud Services</title>

    <link rel="alternate" href="https://campusempresa.com/mod/bigquery/08-01-integrating-google-cloud" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/bigquery/08-01-integrating-google-cloud" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/bigquery/08-01-integrating-google-cloud" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/bigquery/08-01-integrating-google-cloud" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/bigquery/08-01-integrating-google-cloud" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-04-compliance-best-practices' title="Compliance and Best Practices">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Integrating with Google Cloud Services</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='08-02-using-dataflow' title="Using BigQuery with Dataflow">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this module, we will explore how to integrate BigQuery with various Google Cloud services. This integration allows you to leverage the full power of the Google Cloud ecosystem, enabling seamless data flow, enhanced analytics, and automated workflows.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Google Cloud Storage (GCS) Integration</strong></li>
<li><strong>Google Cloud Pub/Sub Integration</strong></li>
<li><strong>Google Cloud Dataflow Integration</strong></li>
<li><strong>Google Cloud Functions Integration</strong></li>
</ol>
</div><h1>1. Google Cloud Storage (GCS) Integration</h1>
<div class='content'><p>Google Cloud Storage is a scalable and secure object storage service. Integrating BigQuery with GCS allows you to load data from GCS into BigQuery and export data from BigQuery to GCS.</p>
</div><h2>Loading Data from GCS to BigQuery</h2>
<div class='content'><p>To load data from GCS into BigQuery, you can use the BigQuery Console, the <code>bq</code> command-line tool, or the BigQuery API.</p>
<h4>Example: Loading a CSV File from GCS</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gU1FMIFF1ZXJ5IHRvIGxvYWQgZGF0YSBmcm9tIEdDUyBpbnRvIEJpZ1F1ZXJ5CkxPQUQgREFUQSBJTlRPIG15X2RhdGFzZXQubXlfdGFibGUKRlJPTSAnZ3M6Ly9teV9idWNrZXQvbXlfZmlsZS5jc3YnCldJVEgKICBGT1JNQVQgPSAnQ1NWJywKICBGSUVMRF9ERUxJTUlURVIgPSAnLCcsCiAgU0tJUF9MRUFESU5HX1JPV1MgPSAxOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- SQL Query to load data from GCS into BigQuery
LOAD DATA INTO my_dataset.my_table
FROM 'gs://my_bucket/my_file.csv'
WITH
  FORMAT = 'CSV',
  FIELD_DELIMITER = ',',
  SKIP_LEADING_ROWS = 1;</pre></div><div class='content'></div><h2>Exporting Data from BigQuery to GCS</h2>
<div class='content'><p>You can export query results or entire tables from BigQuery to GCS in various formats such as CSV, JSON, or Avro.</p>
<h4>Example: Exporting a Table to GCS</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gU1FMIFF1ZXJ5IHRvIGV4cG9ydCBkYXRhIGZyb20gQmlnUXVlcnkgdG8gR0NTCkVYUE9SVCBEQVRBIE9QVElPTlMoCiAgdXJpPSdnczovL215X2J1Y2tldC9teV9leHBvcnRlZF9maWxlLmNzdicsCiAgZm9ybWF0PSdDU1YnLAogIG92ZXJ3cml0ZT10cnVlCikgQVMKU0VMRUNUICogRlJPTSBteV9kYXRhc2V0Lm15X3RhYmxlOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- SQL Query to export data from BigQuery to GCS
EXPORT DATA OPTIONS(
  uri='gs://my_bucket/my_exported_file.csv',
  format='CSV',
  overwrite=true
) AS
SELECT * FROM my_dataset.my_table;</pre></div><div class='content'></div><h1>2. Google Cloud Pub/Sub Integration</h1>
<div class='content'><p>Google Cloud Pub/Sub is a messaging service that allows you to send and receive messages between independent applications. Integrating BigQuery with Pub/Sub enables real-time data ingestion and processing.</p>
</div><h2>Streaming Data into BigQuery via Pub/Sub</h2>
<div class='content'><p>You can create a Pub/Sub topic and a BigQuery subscription to stream data directly into BigQuery.</p>
<h4>Example: Creating a Pub/Sub Subscription for BigQuery</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBQdWIvU3ViIHRvcGljCmdjbG91ZCBwdWJzdWIgdG9waWNzIGNyZWF0ZSBteV90b3BpYwoKIyBDcmVhdGUgYSBCaWdRdWVyeSBzdWJzY3JpcHRpb24KZ2Nsb3VkIHB1YnN1YiBzdWJzY3JpcHRpb25zIGNyZWF0ZSBteV9zdWJzY3JpcHRpb24gLS10b3BpYz1teV90b3BpYyAtLXB1c2gtZW5kcG9pbnQ9aHR0cHM6Ly9iaWdxdWVyeS5nb29nbGVhcGlzLmNvbS9iaWdxdWVyeS92Mi9wcm9qZWN0cy9teV9wcm9qZWN0L2RhdGFzZXRzL215X2RhdGFzZXQvdGFibGVzL215X3RhYmxlL2luc2VydEFsbA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a Pub/Sub topic
gcloud pubsub topics create my_topic

# Create a BigQuery subscription
gcloud pubsub subscriptions create my_subscription --topic=my_topic --push-endpoint=https://bigquery.googleapis.com/bigquery/v2/projects/my_project/datasets/my_dataset/tables/my_table/insertAll</pre></div><div class='content'></div><h1>3. Google Cloud Dataflow Integration</h1>
<div class='content'><p>Google Cloud Dataflow is a fully managed service for stream and batch data processing. Integrating BigQuery with Dataflow allows you to perform complex data transformations and load the results into BigQuery.</p>
</div><h2>Using Dataflow to Load Data into BigQuery</h2>
<div class='content'><p>You can create a Dataflow pipeline to read data from various sources, transform it, and write the results to BigQuery.</p>
<h4>Example: Dataflow Pipeline to Load Data into BigQuery</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGFwYWNoZV9iZWFtIGFzIGJlYW0KZnJvbSBhcGFjaGVfYmVhbS5vcHRpb25zLnBpcGVsaW5lX29wdGlvbnMgaW1wb3J0IFBpcGVsaW5lT3B0aW9ucwoKIyBEZWZpbmUgdGhlIHBpcGVsaW5lIG9wdGlvbnMKb3B0aW9ucyA9IFBpcGVsaW5lT3B0aW9ucygKICAgIHByb2plY3Q9J215X3Byb2plY3QnLAogICAgcnVubmVyPSdEYXRhZmxvd1J1bm5lcicsCiAgICB0ZW1wX2xvY2F0aW9uPSdnczovL215X2J1Y2tldC90ZW1wJwopCgojIERlZmluZSB0aGUgcGlwZWxpbmUKd2l0aCBiZWFtLlBpcGVsaW5lKG9wdGlvbnM9b3B0aW9ucykgYXMgcDoKICAgIChwCiAgICAgfCAnUmVhZCBmcm9tIEdDUycgPj4gYmVhbS5pby5SZWFkRnJvbVRleHQoJ2dzOi8vbXlfYnVja2V0L215X2ZpbGUuY3N2JykKICAgICB8ICdUcmFuc2Zvcm0gRGF0YScgPj4gYmVhbS5NYXAobGFtYmRhIHg6IHguc3BsaXQoJywnKSkKICAgICB8ICdXcml0ZSB0byBCaWdRdWVyeScgPj4gYmVhbS5pby5Xcml0ZVRvQmlnUXVlcnkoCiAgICAgICAgICdteV9wcm9qZWN0Om15X2RhdGFzZXQubXlfdGFibGUnLAogICAgICAgICBzY2hlbWE9J25hbWU6U1RSSU5HLCBhZ2U6SU5URUdFUiwgY2l0eTpTVFJJTkcnCiAgICAgKSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import apache_beam as beam
from apache_beam.options.pipeline_options import PipelineOptions

# Define the pipeline options
options = PipelineOptions(
    project='my_project',
    runner='DataflowRunner',
    temp_location='gs://my_bucket/temp'
)

# Define the pipeline
with beam.Pipeline(options=options) as p:
    (p
     | 'Read from GCS' &gt;&gt; beam.io.ReadFromText('gs://my_bucket/my_file.csv')
     | 'Transform Data' &gt;&gt; beam.Map(lambda x: x.split(','))
     | 'Write to BigQuery' &gt;&gt; beam.io.WriteToBigQuery(
         'my_project:my_dataset.my_table',
         schema='name:STRING, age:INTEGER, city:STRING'
     ))</pre></div><div class='content'></div><h1>4. Google Cloud Functions Integration</h1>
<div class='content'><p>Google Cloud Functions is a serverless execution environment for building and connecting cloud services. Integrating BigQuery with Cloud Functions allows you to automate tasks and trigger actions based on events.</p>
</div><h2>Using Cloud Functions to Trigger BigQuery Queries</h2>
<div class='content'><p>You can create a Cloud Function that triggers a BigQuery query based on an event, such as a file upload to GCS.</p>
<h4>Example: Cloud Function to Trigger a BigQuery Query</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IGJpZ3F1ZXJ5CgpkZWYgdHJpZ2dlcl9xdWVyeShldmVudCwgY29udGV4dCk6CiAgICBjbGllbnQgPSBiaWdxdWVyeS5DbGllbnQoKQogICAgcXVlcnkgPSAiIiIKICAgIFNFTEVDVCAqIEZST00gbXlfZGF0YXNldC5teV90YWJsZQogICAgV0hFUkUgdGltZXN0YW1wID49IFRJTUVTVEFNUF9TVUIoQ1VSUkVOVF9USU1FU1RBTVAoKSwgSU5URVJWQUwgMSBEQVkpCiAgICAiIiIKICAgIHF1ZXJ5X2pvYiA9IGNsaWVudC5xdWVyeShxdWVyeSkKICAgIHJlc3VsdHMgPSBxdWVyeV9qb2IucmVzdWx0KCkKICAgIGZvciByb3cgaW4gcmVzdWx0czoKICAgICAgICBwcmludChyb3cp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import bigquery

def trigger_query(event, context):
    client = bigquery.Client()
    query = &quot;&quot;&quot;
    SELECT * FROM my_dataset.my_table
    WHERE timestamp &gt;= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 1 DAY)
    &quot;&quot;&quot;
    query_job = client.query(query)
    results = query_job.result()
    for row in results:
        print(row)</pre></div><div class='content'></div><h1>Summary</h1>
<div class='content'><p>In this section, we covered how to integrate BigQuery with various Google Cloud services, including Google Cloud Storage, Google Cloud Pub/Sub, Google Cloud Dataflow, and Google Cloud Functions. These integrations enable seamless data flow, real-time processing, and automated workflows, enhancing the capabilities of your data analytics infrastructure.</p>
<p>Next, we will explore how to use BigQuery with Dataflow in more detail.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-04-compliance-best-practices' title="Compliance and Best Practices">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='08-02-using-dataflow' title="Using BigQuery with Dataflow">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
