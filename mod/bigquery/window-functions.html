<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Window Functions in BigQuery</title>

    <link rel="alternate" href="https://campusempresa.com/mod/bigquery/window-functions" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/bigquery/window-functions" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/bigquery/window-functions" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/bigquery/window-functions" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/bigquery/window-functions" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='common-table-expressions'>&#x25C4;Common Table Expressions (CTEs)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Window Functions in BigQuery</a>
	</div>
	<div class='col-4 text-end'>
					<a href='handling-nulls'>Handling NULLs &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Window functions are a powerful feature in SQL that allow you to perform calculations across a set of table rows that are related to the current row. This topic will guide you from the basics to advanced usage of window functions in BigQuery.</p>
</div><h1>Introduction to Window Functions</h1>
<div class='content'><p>Window functions perform calculations across a set of table rows that are somehow related to the current row. They are often used for running totals, moving averages, and ranking.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Window</strong>: The set of rows that the function operates on.</li>
<li><strong>Partition</strong>: Divides the result set into partitions to which the window function is applied.</li>
<li><strong>Order</strong>: Defines the order of rows within each partition.</li>
<li><strong>Frame</strong>: Specifies a subset of rows within the partition.</li>
</ul>
</div><h1>Basic Syntax</h1>
<div class='content'><p>The basic syntax for a window function in BigQuery is as follows:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogIGNvbHVtbjEsCiAgY29sdW1uMiwKICB3aW5kb3dfZnVuY3Rpb24oKSBPVkVSICgKICAgIFtQQVJUSVRJT04gQlkgcGFydGl0aW9uX2V4cHJlc3Npb25dCiAgICBbT1JERVIgQlkgb3JkZXJfZXhwcmVzc2lvbl0KICAgIFt3aW5kb3dfZnJhbWVdCiAgKSBBUyBhbGlhc19uYW1lCkZST00gCiAgdGFibGVfbmFtZTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
  column1,
  column2,
  window_function() OVER (
    [PARTITION BY partition_expression]
    [ORDER BY order_expression]
    [window_frame]
  ) AS alias_name
FROM 
  table_name;</pre></div><div class='content'></div><h2>Example: Using ROW_NUMBER()</h2>
<div class='content'><p>The <code>ROW_NUMBER()</code> function assigns a unique number to each row within the partition of a result set.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogIG5hbWUsCiAgZGVwYXJ0bWVudCwKICBST1dfTlVNQkVSKCkgT1ZFUiAoUEFSVElUSU9OIEJZIGRlcGFydG1lbnQgT1JERVIgQlkgbmFtZSkgQVMgcm93X251bQpGUk9NIAogIGVtcGxveWVlczs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
  name,
  department,
  ROW_NUMBER() OVER (PARTITION BY department ORDER BY name) AS row_num
FROM 
  employees;</pre></div><div class='content'><p>In this example:</p>
<ul>
<li><strong>PARTITION BY department</strong>: The rows are partitioned by the <code>department</code> column.</li>
<li><strong>ORDER BY name</strong>: The rows within each partition are ordered by the <code>name</code> column.</li>
<li><strong>ROW_NUMBER()</strong>: Assigns a unique number to each row within the partition.</li>
</ul>
</div><h1>Common Window Functions</h1>
<div class='content'></div><h2>RANK() and DENSE_RANK()</h2>
<div class='content'><ul>
<li><strong>RANK()</strong>: Assigns a rank to each row within the partition, with gaps in the ranking.</li>
<li><strong>DENSE_RANK()</strong>: Similar to <code>RANK()</code>, but without gaps in the ranking.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogIG5hbWUsCiAgZGVwYXJ0bWVudCwKICBSQU5LKCkgT1ZFUiAoUEFSVElUSU9OIEJZIGRlcGFydG1lbnQgT1JERVIgQlkgc2FsYXJ5IERFU0MpIEFTIHJhbmssCiAgREVOU0VfUkFOSygpIE9WRVIgKFBBUlRJVElPTiBCWSBkZXBhcnRtZW50IE9SREVSIEJZIHNhbGFyeSBERVNDKSBBUyBkZW5zZV9yYW5rCkZST00gCiAgZW1wbG95ZWVzOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
  name,
  department,
  RANK() OVER (PARTITION BY department ORDER BY salary DESC) AS rank,
  DENSE_RANK() OVER (PARTITION BY department ORDER BY salary DESC) AS dense_rank
FROM 
  employees;</pre></div><div class='content'></div><h2>SUM() and AVG()</h2>
<div class='content'><ul>
<li><strong>SUM()</strong>: Calculates the sum of a set of values.</li>
<li><strong>AVG()</strong>: Calculates the average of a set of values.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogIGRlcGFydG1lbnQsCiAgc2FsYXJ5LAogIFNVTShzYWxhcnkpIE9WRVIgKFBBUlRJVElPTiBCWSBkZXBhcnRtZW50KSBBUyB0b3RhbF9zYWxhcnksCiAgQVZHKHNhbGFyeSkgT1ZFUiAoUEFSVElUSU9OIEJZIGRlcGFydG1lbnQpIEFTIGF2Z19zYWxhcnkKRlJPTSAKICBlbXBsb3llZXM7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
  department,
  salary,
  SUM(salary) OVER (PARTITION BY department) AS total_salary,
  AVG(salary) OVER (PARTITION BY department) AS avg_salary
FROM 
  employees;</pre></div><div class='content'></div><h2>LAG() and LEAD()</h2>
<div class='content'><ul>
<li><strong>LAG()</strong>: Accesses data from a previous row in the same result set.</li>
<li><strong>LEAD()</strong>: Accesses data from a subsequent row in the same result set.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogIG5hbWUsCiAgc2FsYXJ5LAogIExBRyhzYWxhcnksIDEpIE9WRVIgKE9SREVSIEJZIHNhbGFyeSkgQVMgcHJldmlvdXNfc2FsYXJ5LAogIExFQUQoc2FsYXJ5LCAxKSBPVkVSIChPUkRFUiBCWSBzYWxhcnkpIEFTIG5leHRfc2FsYXJ5CkZST00gCiAgZW1wbG95ZWVzOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
  name,
  salary,
  LAG(salary, 1) OVER (ORDER BY salary) AS previous_salary,
  LEAD(salary, 1) OVER (ORDER BY salary) AS next_salary
FROM 
  employees;</pre></div><div class='content'></div><h1>Advanced Usage</h1>
<div class='content'></div><h2>Window Frames</h2>
<div class='content'><p>Window frames define a subset of rows within the partition. The default frame is <code>RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogIG5hbWUsCiAgc2FsYXJ5LAogIFNVTShzYWxhcnkpIE9WRVIgKAogICAgT1JERVIgQlkgc2FsYXJ5IAogICAgUk9XUyBCRVRXRUVOIDEgUFJFQ0VESU5HIEFORCAxIEZPTExPV0lORwogICkgQVMgbW92aW5nX3N1bQpGUk9NIAogIGVtcGxveWVlczs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
  name,
  salary,
  SUM(salary) OVER (
    ORDER BY salary 
    ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING
  ) AS moving_sum
FROM 
  employees;</pre></div><div class='content'></div><h2>Combining Multiple Window Functions</h2>
<div class='content'><p>You can use multiple window functions in a single query to perform complex calculations.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIAogIG5hbWUsCiAgZGVwYXJ0bWVudCwKICBzYWxhcnksCiAgUkFOSygpIE9WRVIgKFBBUlRJVElPTiBCWSBkZXBhcnRtZW50IE9SREVSIEJZIHNhbGFyeSBERVNDKSBBUyByYW5rLAogIFNVTShzYWxhcnkpIE9WRVIgKFBBUlRJVElPTiBCWSBkZXBhcnRtZW50KSBBUyB0b3RhbF9zYWxhcnksCiAgQVZHKHNhbGFyeSkgT1ZFUiAoUEFSVElUSU9OIEJZIGRlcGFydG1lbnQpIEFTIGF2Z19zYWxhcnkKRlJPTSAKICBlbXBsb3llZXM7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT 
  name,
  department,
  salary,
  RANK() OVER (PARTITION BY department ORDER BY salary DESC) AS rank,
  SUM(salary) OVER (PARTITION BY department) AS total_salary,
  AVG(salary) OVER (PARTITION BY department) AS avg_salary
FROM 
  employees;</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Window functions in BigQuery provide a powerful way to perform complex calculations over a set of rows related to the current row. By understanding and utilizing partitioning, ordering, and framing, you can leverage window functions to gain deeper insights from your data. Practice using these functions with different datasets to become proficient in their application.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='common-table-expressions'>&#x25C4;Common Table Expressions (CTEs)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Window Functions in BigQuery</a>
	</div>
	<div class='col-4 text-end'>
					<a href='handling-nulls'>Handling NULLs &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
