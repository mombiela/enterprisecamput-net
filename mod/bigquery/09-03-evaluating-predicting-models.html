<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Evaluating and Predicting with Models</title>

    <link rel="alternate" href="https://campusempresa.com/mod/bigquery/09-03-evaluating-predicting-models" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/bigquery/09-03-evaluating-predicting-models" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/bigquery/09-03-evaluating-predicting-models" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=3" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/bigquery/09-03-evaluating-predicting-models" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/bigquery/09-03-evaluating-predicting-models" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>Building today's and tomorrow's society</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Languages</a>
				 					<a href="/categ/frameworks">Frameworks</a>
				 					<a href="/categ/tech-tools">Tools</a>
				 					<a href="/categ/foundations">Foundations</a>
				 					<a href="/categ/soft-skills">Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='09-02-creating-training-models' title="Creating and Training Models">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Evaluating and Predicting with Models</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-04-advanced-bqml-features' title="Advanced BQML Features">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into the process of evaluating and predicting with models in BigQuery Machine Learning (BQML). This involves understanding how to assess the performance of your machine learning models and using them to make predictions on new data.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Model Evaluation Metrics</strong>:</p>
<ul>
<li><strong>Accuracy</strong>: The ratio of correctly predicted instances to the total instances.</li>
<li><strong>Precision</strong>: The ratio of correctly predicted positive observations to the total predicted positives.</li>
<li><strong>Recall</strong>: The ratio of correctly predicted positive observations to all observations in the actual class.</li>
<li><strong>F1 Score</strong>: The weighted average of Precision and Recall.</li>
<li><strong>ROC-AUC</strong>: The area under the receiver operating characteristic curve, which plots the true positive rate against the false positive rate.</li>
</ul>
</li>
<li>
<p><strong>Prediction</strong>:</p>
<ul>
<li>Using the trained model to predict outcomes on new, unseen data.</li>
</ul>
</li>
</ol>
</div><h1><p>Evaluating Models</p>
</h1>
<div class='content'></div><h2><p>Step 1: Evaluate the Model</p>
</h2>
<div class='content'><p>After training a model, it is crucial to evaluate its performance using various metrics. BQML provides built-in functions to evaluate models.</p>
<h4>Example: Evaluating a Classification Model</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRXZhbHVhdGUgdGhlIG1vZGVsClNFTEVDVAogICoKRlJPTQogIE1MLkVWQUxVQVRFKE1PREVMIGBteV9kYXRhc2V0Lm15X21vZGVsYCwgKAogICAgU0VMRUNUCiAgICAgICoKICAgIEZST00KICAgICAgYG15X2RhdGFzZXQubXlfZXZhbHVhdGlvbl9kYXRhYAogICkpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Evaluate the model
SELECT
  *
FROM
  ML.EVALUATE(MODEL `my_dataset.my_model`, (
    SELECT
      *
    FROM
      `my_dataset.my_evaluation_data`
  ));</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>ML.EVALUATE</code>: This function evaluates the performance of the model.</li>
<li><code>MODEL 'my_dataset.my_model'</code>: Specifies the model to be evaluated.</li>
<li><code>my_dataset.my_evaluation_data</code>: The dataset used for evaluation.</li>
</ul>
</div><h2><p>Step 2: Interpret the Evaluation Metrics</p>
</h2>
<div class='content'><p>The output of the <code>ML.EVALUATE</code> function will include various metrics such as accuracy, precision, recall, and F1 score. Here is a brief overview of how to interpret these metrics:</p>
<ul>
<li><strong>Accuracy</strong>: High accuracy indicates that the model is correctly predicting the majority of instances.</li>
<li><strong>Precision</strong>: High precision means that when the model predicts a positive instance, it is usually correct.</li>
<li><strong>Recall</strong>: High recall indicates that the model is identifying most of the positive instances.</li>
<li><strong>F1 Score</strong>: A balanced measure that considers both precision and recall.</li>
<li><strong>ROC-AUC</strong>: A higher value indicates better model performance in distinguishing between classes.</li>
</ul>
</div><h1><p>Predicting with Models</p>
</h1>
<div class='content'></div><h2><p>Step 1: Make Predictions</p>
</h2>
<div class='content'><p>Once the model is evaluated and deemed satisfactory, you can use it to make predictions on new data.</p>
<h4>Example: Making Predictions</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gTWFrZSBwcmVkaWN0aW9ucyB1c2luZyB0aGUgbW9kZWwKU0VMRUNUCiAgKgpGUk9NCiAgTUwuUFJFRElDVChNT0RFTCBgbXlfZGF0YXNldC5teV9tb2RlbGAsICgKICAgIFNFTEVDVAogICAgICAqCiAgICBGUk9NCiAgICAgIGBteV9kYXRhc2V0Lm5ld19kYXRhYAogICkpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Make predictions using the model
SELECT
  *
FROM
  ML.PREDICT(MODEL `my_dataset.my_model`, (
    SELECT
      *
    FROM
      `my_dataset.new_data`
  ));</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>ML.PREDICT</code>: This function uses the model to make predictions.</li>
<li><code>MODEL 'my_dataset.my_model'</code>: Specifies the model to be used for predictions.</li>
<li><code>my_dataset.new_data</code>: The new dataset on which predictions are to be made.</li>
</ul>
</div><h2><p>Step 2: Analyze Predictions</p>
</h2>
<div class='content'><p>The output of the <code>ML.PREDICT</code> function will include the predicted values along with the input data. You can analyze these predictions to gain insights and make data-driven decisions.</p>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Evaluate and Predict</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Evaluate the Model</strong>:</p>
<ul>
<li>Use the <code>ML.EVALUATE</code> function to evaluate a model named <code>sales_model</code> in the dataset <code>sales_data</code> using the evaluation data <code>sales_evaluation_data</code>.</li>
</ul>
</li>
<li>
<p><strong>Make Predictions</strong>:</p>
<ul>
<li>Use the <code>ML.PREDICT</code> function to make predictions using the <code>sales_model</code> on new data <code>sales_new_data</code>.</li>
</ul>
</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gU3RlcCAxOiBFdmFsdWF0ZSB0aGUgbW9kZWwKU0VMRUNUCiAgKgpGUk9NCiAgTUwuRVZBTFVBVEUoTU9ERUwgYHNhbGVzX2RhdGEuc2FsZXNfbW9kZWxgLCAoCiAgICBTRUxFQ1QKICAgICAgKgogICAgRlJPTQogICAgICBgc2FsZXNfZGF0YS5zYWxlc19ldmFsdWF0aW9uX2RhdGFgCiAgKSk7CgotLSBTdGVwIDI6IE1ha2UgcHJlZGljdGlvbnMKU0VMRUNUCiAgKgpGUk9NCiAgTUwuUFJFRElDVChNT0RFTCBgc2FsZXNfZGF0YS5zYWxlc19tb2RlbGAsICgKICAgIFNFTEVDVAogICAgICAqCiAgICBGUk9NCiAgICAgIGBzYWxlc19kYXRhLnNhbGVzX25ld19kYXRhYAogICkpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Step 1: Evaluate the model
SELECT
  *
FROM
  ML.EVALUATE(MODEL `sales_data.sales_model`, (
    SELECT
      *
    FROM
      `sales_data.sales_evaluation_data`
  ));

-- Step 2: Make predictions
SELECT
  *
FROM
  ML.PREDICT(MODEL `sales_data.sales_model`, (
    SELECT
      *
    FROM
      `sales_data.sales_new_data`
  ));</pre></div><div class='content'></div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Using the Wrong Dataset</strong>: Ensure that the dataset used for evaluation or prediction matches the schema expected by the model.</li>
<li><strong>Ignoring Evaluation Metrics</strong>: Always review the evaluation metrics to understand the model's performance before using it for predictions.</li>
<li><strong>Overfitting</strong>: Be cautious of overfitting, where the model performs well on training data but poorly on new data. Regularly evaluate the model on different datasets.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered the essential steps for evaluating and predicting with models in BigQuery ML. By understanding and applying these concepts, you can effectively assess the performance of your models and use them to make accurate predictions on new data. This knowledge prepares you for more advanced topics in BigQuery ML and real-world applications.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='09-02-creating-training-models' title="Creating and Training Models">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-04-advanced-bqml-features' title="Advanced BQML Features">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
