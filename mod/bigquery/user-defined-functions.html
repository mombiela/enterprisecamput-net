<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User-Defined Functions (UDFs) in BigQuery</title>

    <link rel="alternate" href="https://campusempresa.com/mod/bigquery/user-defined-functions" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/bigquery/user-defined-functions" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/bigquery/user-defined-functions" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/bigquery/user-defined-functions" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/bigquery/user-defined-functions" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='using-bigquery-ml'>&#x25C4;Using BigQuery ML for Machine Learning</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">User-Defined Functions (UDFs) in BigQuery</a>
	</div>
	<div class='col-4 text-end'>
					<a href='bigquery-best-practices'>BigQuery Best Practices &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to User-Defined Functions (UDFs)</h1>
<div class='content'><p>User-Defined Functions (UDFs) in BigQuery allow you to extend the capabilities of SQL by writing custom functions using JavaScript or SQL. UDFs can be used to encapsulate complex logic, perform custom calculations, and reuse code across multiple queries.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>UDF Types</strong>: BigQuery supports two types of UDFs:
<ul>
<li><strong>SQL UDFs</strong>: Written in SQL.</li>
<li><strong>JavaScript UDFs</strong>: Written in JavaScript.</li>
</ul>
</li>
<li><strong>Syntax</strong>: The syntax for creating UDFs varies slightly between SQL and JavaScript.</li>
<li><strong>Reusability</strong>: UDFs can be reused across multiple queries, making your code more modular and maintainable.</li>
</ul>
</div><h1>Creating SQL UDFs</h1>
<div class='content'><p>SQL UDFs are written using standard SQL syntax and can be used to encapsulate SQL logic.</p>
</div><h2>Example: Simple SQL UDF</h2>
<div class='content'><p>Let's create a simple SQL UDF that calculates the square of a number.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgRlVOQ1RJT04gbXlfZGF0YXNldC5zcXVhcmUoeCBGTE9BVDY0KSAKUkVUVVJOUyBGTE9BVDY0IEFTICgKICB4ICogeAopOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE FUNCTION my_dataset.square(x FLOAT64) 
RETURNS FLOAT64 AS (
  x * x
);</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><code>CREATE OR REPLACE FUNCTION</code>: This statement creates a new function or replaces an existing one.</li>
<li><code>my_dataset.square</code>: The name of the function, where <code>my_dataset</code> is the dataset containing the function.</li>
<li><code>x FLOAT64</code>: The input parameter and its type.</li>
<li><code>RETURNS FLOAT64</code>: The return type of the function.</li>
<li><code>AS ( x * x )</code>: The function body, which contains the SQL expression to be executed.</li>
</ul>
</div><h2>Using the SQL UDF</h2>
<div class='content'><p>You can use the UDF in a query just like any other function.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIG15X2RhdGFzZXQuc3F1YXJlKDMpIEFTIHJlc3VsdDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT my_dataset.square(3) AS result;</pre></div><div class='content'></div><h2>Output</h2>
<div class='content'><p>| result |
|--------|
| 9      |</p>
</div><h1>Creating JavaScript UDFs</h1>
<div class='content'><p>JavaScript UDFs allow you to write custom functions using JavaScript, which can be useful for more complex logic that is difficult to express in SQL.</p>
</div><h2>Example: Simple JavaScript UDF</h2>
<div class='content'><p>Let's create a JavaScript UDF that reverses a string.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgRlVOQ1RJT04gbXlfZGF0YXNldC5yZXZlcnNlX3N0cmluZyhpbnB1dCBTVFJJTkcpIApSRVRVUk5TIFNUUklORyAKTEFOR1VBR0UganMgQVMgIiIiCiAgcmV0dXJuIGlucHV0LnNwbGl0KCcnKS5yZXZlcnNlKCkuam9pbignJyk7CiIiIjs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE FUNCTION my_dataset.reverse_string(input STRING) 
RETURNS STRING 
LANGUAGE js AS &quot;&quot;&quot;
  return input.split('').reverse().join('');
&quot;&quot;&quot;;</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><code>CREATE OR REPLACE FUNCTION</code>: This statement creates a new function or replaces an existing one.</li>
<li><code>my_dataset.reverse_string</code>: The name of the function.</li>
<li><code>input STRING</code>: The input parameter and its type.</li>
<li><code>RETURNS STRING</code>: The return type of the function.</li>
<li><code>LANGUAGE js</code>: Specifies that the function is written in JavaScript.</li>
<li><code>AS &quot;&quot;&quot; ... &quot;&quot;&quot;</code>: The function body, written in JavaScript.</li>
</ul>
</div><h2>Using the JavaScript UDF</h2>
<div class='content'><p>You can use the UDF in a query just like any other function.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIG15X2RhdGFzZXQucmV2ZXJzZV9zdHJpbmcoJ0JpZ1F1ZXJ5JykgQVMgcmV2ZXJzZWQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT my_dataset.reverse_string('BigQuery') AS reversed;</pre></div><div class='content'></div><h2>Output</h2>
<div class='content'><p>| reversed |
|----------|
| yreuQgiB |</p>
</div><h1>Advanced UDF Usage</h1>
<h2>Handling Multiple Parameters</h2>
<div class='content'><p>UDFs can accept multiple parameters. Here’s an example of a SQL UDF that concatenates two strings.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgRlVOQ1RJT04gbXlfZGF0YXNldC5jb25jYXRfc3RyaW5ncyhzdHIxIFNUUklORywgc3RyMiBTVFJJTkcpIApSRVRVUk5TIFNUUklORyBBUyAoCiAgQ09OQ0FUKHN0cjEsICcgJywgc3RyMikKKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE FUNCTION my_dataset.concat_strings(str1 STRING, str2 STRING) 
RETURNS STRING AS (
  CONCAT(str1, ' ', str2)
);</pre></div><div class='content'></div><h2>Using UDFs with Arrays</h2>
<div class='content'><p>You can also create UDFs that work with arrays. Here’s an example of a JavaScript UDF that sums the elements of an array.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgRlVOQ1RJT04gbXlfZGF0YXNldC5zdW1fYXJyYXkoYXJyIEFSUkFZPElOVDY0PikgClJFVFVSTlMgSU5UNjQgCkxBTkdVQUdFIGpzIEFTICIiIgogIHJldHVybiBhcnIucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7CiIiIjs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE FUNCTION my_dataset.sum_array(arr ARRAY&lt;INT64&gt;) 
RETURNS INT64 
LANGUAGE js AS &quot;&quot;&quot;
  return arr.reduce((a, b) =&gt; a + b, 0);
&quot;&quot;&quot;;</pre></div><div class='content'></div><h2>Performance Considerations</h2>
<div class='content'><ul>
<li><strong>Execution Time</strong>: UDFs can introduce additional execution time, especially if they contain complex logic.</li>
<li><strong>Resource Usage</strong>: Be mindful of the resources your UDFs consume, as they can impact the overall performance of your queries.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>User-Defined Functions (UDFs) in BigQuery provide a powerful way to extend SQL capabilities with custom logic. Whether you use SQL or JavaScript, UDFs can help you encapsulate complex logic, perform custom calculations, and make your queries more modular and maintainable. By understanding how to create and use UDFs effectively, you can leverage the full power of BigQuery for your data analysis tasks.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='using-bigquery-ml'>&#x25C4;Using BigQuery ML for Machine Learning</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">User-Defined Functions (UDFs) in BigQuery</a>
	</div>
	<div class='col-4 text-end'>
					<a href='bigquery-best-practices'>BigQuery Best Practices &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
