<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User-Defined Functions (UDFs)</title>

    <link rel="alternate" href="https://campusempresa.com/mod/bigquery/04-03-user-defined-functions" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/bigquery/04-03-user-defined-functions" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/bigquery/04-03-user-defined-functions" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/bigquery/04-03-user-defined-functions" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/bigquery/04-03-user-defined-functions" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-02-nested-repeated-fields' title="Nested and Repeated Fields">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">User-Defined Functions (UDFs)</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='04-04-partitioning-clustering' title="Partitioning and Clustering">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>User-Defined Functions (UDFs) in BigQuery allow you to extend the capabilities of SQL by writing custom functions using JavaScript or SQL. UDFs can be used to encapsulate complex logic, perform transformations, and reuse code across multiple queries.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li>
<p><strong>Types of UDFs</strong>:</p>
<ul>
<li><strong>SQL UDFs</strong>: Written in SQL, these functions allow you to encapsulate SQL logic.</li>
<li><strong>JavaScript UDFs</strong>: Written in JavaScript, these functions provide more flexibility and can handle more complex logic.</li>
</ul>
</li>
<li>
<p><strong>Creating UDFs</strong>:</p>
<ul>
<li><strong>SQL UDFs</strong>: Defined using the <code>CREATE FUNCTION</code> statement.</li>
<li><strong>JavaScript UDFs</strong>: Defined using the <code>CREATE FUNCTION</code> statement with JavaScript code embedded.</li>
</ul>
</li>
<li>
<p><strong>Using UDFs</strong>:</p>
<ul>
<li>UDFs can be called in SQL queries just like built-in functions.</li>
<li>They can accept parameters and return values.</li>
</ul>
</li>
</ol>
</div><h1>Creating SQL UDFs</h1>
<div class='content'></div><h2>Example: Simple SQL UDF</h2>
<div class='content'><p>Let's create a simple SQL UDF that calculates the square of a number.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIG15X3Byb2plY3QubXlfZGF0YXNldC5zcXVhcmUoeCBJTlQ2NCkgClJFVFVSTlMgSU5UNjQgCkFTICgKICB4ICogeAopOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION my_project.my_dataset.square(x INT64) 
RETURNS INT64 
AS (
  x * x
);</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><code>CREATE FUNCTION my_project.my_dataset.square(x INT64)</code>: Defines a new function named <code>square</code> in the specified project and dataset. The function takes an integer parameter <code>x</code>.</li>
<li><code>RETURNS INT64</code>: Specifies that the function returns an integer.</li>
<li><code>AS (x * x)</code>: The function body, which calculates the square of <code>x</code>.</li>
</ul>
</div><h2>Using the SQL UDF</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIG15X3Byb2plY3QubXlfZGF0YXNldC5zcXVhcmUoNCkgQVMgcmVzdWx0Ow=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT my_project.my_dataset.square(4) AS result;</pre></div><div class='content'></div><h2>Output</h2>
<div class='content'><table>
<thead>
<tr>
<th>result</th>
</tr>
</thead>
<tbody>
<tr>
<td>16</td>
</tr>
</tbody>
</table>
</div><h1>Creating JavaScript UDFs</h1>
<div class='content'></div><h2>Example: JavaScript UDF</h2>
<div class='content'><p>Let's create a JavaScript UDF that reverses a string.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIG15X3Byb2plY3QubXlfZGF0YXNldC5yZXZlcnNlX3N0cmluZyhpbnB1dCBTVFJJTkcpIApSRVRVUk5TIFNUUklORyAKTEFOR1VBR0UganMgCkFTICIiIgogIHJldHVybiBpbnB1dC5zcGxpdCgnJykucmV2ZXJzZSgpLmpvaW4oJycpOwoiIiI7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION my_project.my_dataset.reverse_string(input STRING) 
RETURNS STRING 
LANGUAGE js 
AS &quot;&quot;&quot;
  return input.split('').reverse().join('');
&quot;&quot;&quot;;</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><code>CREATE FUNCTION my_project.my_dataset.reverse_string(input STRING)</code>: Defines a new function named <code>reverse_string</code> in the specified project and dataset. The function takes a string parameter <code>input</code>.</li>
<li><code>RETURNS STRING</code>: Specifies that the function returns a string.</li>
<li><code>LANGUAGE js</code>: Indicates that the function is written in JavaScript.</li>
<li><code>AS &quot;&quot;&quot; ... &quot;&quot;&quot;</code>: The function body, which contains JavaScript code to reverse the input string.</li>
</ul>
</div><h2>Using the JavaScript UDF</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIG15X3Byb2plY3QubXlfZGF0YXNldC5yZXZlcnNlX3N0cmluZygnQmlnUXVlcnknKSBBUyByZXN1bHQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT my_project.my_dataset.reverse_string('BigQuery') AS result;</pre></div><div class='content'></div><h2>Output</h2>
<div class='content'><table>
<thead>
<tr>
<th>result</th>
</tr>
</thead>
<tbody>
<tr>
<td>yreuQgiB</td>
</tr>
</tbody>
</table>
</div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Create a SQL UDF</h2>
<div class='content'><p><strong>Task</strong>: Create a SQL UDF named <code>cube</code> that calculates the cube of a number.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIG15X3Byb2plY3QubXlfZGF0YXNldC5jdWJlKHggSU5UNjQpIApSRVRVUk5TIElOVDY0IApBUyAoCiAgeCAqIHggKiB4Cik7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION my_project.my_dataset.cube(x INT64) 
RETURNS INT64 
AS (
  x * x * x
);</pre></div><div class='content'><p><strong>Test the UDF</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIG15X3Byb2plY3QubXlfZGF0YXNldC5jdWJlKDMpIEFTIHJlc3VsdDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT my_project.my_dataset.cube(3) AS result;</pre></div><div class='content'><p><strong>Expected Output</strong>:</p>
<table>
<thead>
<tr>
<th>result</th>
</tr>
</thead>
<tbody>
<tr>
<td>27</td>
</tr>
</tbody>
</table>
</div><h2>Exercise 2: Create a JavaScript UDF</h2>
<div class='content'><p><strong>Task</strong>: Create a JavaScript UDF named <code>to_uppercase</code> that converts a string to uppercase.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIG15X3Byb2plY3QubXlfZGF0YXNldC50b191cHBlcmNhc2UoaW5wdXQgU1RSSU5HKSAKUkVUVVJOUyBTVFJJTkcgCkxBTkdVQUdFIGpzIApBUyAiIiIKICByZXR1cm4gaW5wdXQudG9VcHBlckNhc2UoKTsKIiIiOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION my_project.my_dataset.to_uppercase(input STRING) 
RETURNS STRING 
LANGUAGE js 
AS &quot;&quot;&quot;
  return input.toUpperCase();
&quot;&quot;&quot;;</pre></div><div class='content'><p><strong>Test the UDF</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIG15X3Byb2plY3QubXlfZGF0YXNldC50b191cHBlcmNhc2UoJ2JpZ3F1ZXJ5JykgQVMgcmVzdWx0Ow=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT my_project.my_dataset.to_uppercase('bigquery') AS result;</pre></div><div class='content'><p><strong>Expected Output</strong>:</p>
<table>
<thead>
<tr>
<th>result</th>
</tr>
</thead>
<tbody>
<tr>
<td>BIGQUERY</td>
</tr>
</tbody>
</table>
</div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Syntax Errors</strong>: Ensure that the SQL or JavaScript syntax is correct. Use the appropriate language keywords and structure.</li>
<li><strong>Parameter Types</strong>: Make sure the parameter types match the expected input types.</li>
<li><strong>Return Types</strong>: Ensure the return type of the UDF matches the expected output type.</li>
<li><strong>Testing</strong>: Always test your UDFs with various inputs to ensure they work as expected.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>User-Defined Functions (UDFs) in BigQuery provide a powerful way to extend SQL capabilities by encapsulating complex logic in reusable functions. By understanding how to create and use both SQL and JavaScript UDFs, you can enhance your data processing and analysis workflows in BigQuery. In the next section, we will explore partitioning and clustering to optimize query performance.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-02-nested-repeated-fields' title="Nested and Repeated Fields">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='04-04-partitioning-clustering' title="Partitioning and Clustering">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
