<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Creating and Training Models</title>

    <link rel="alternate" href="https://campusempresa.com/mod/bigquery/09-02-creating-training-models" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/bigquery/09-02-creating-training-models" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/bigquery/09-02-creating-training-models" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>var DEVELOP = window.location.href.indexOf("localhost")!=-1 && true;</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/bigquery/09-02-creating-training-models" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/bigquery/09-02-creating-training-models" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>
		<!-- <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

			</div>
		</div>
	</div>
</div>
 -->
 
<div class="top-bar container-fluid">
	<div class="container-xxl">
		<nav class="navbar navbar-expand-md p-0">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<div class="navbar-nav me-auto">
							<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

					</div>
				</div>			
							</div>
		</nav>
	</div>
</div>				<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='09-01-introduction-bqml' title="Introduction to BigQuery ML">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<h2 style="text-decoration:underline">Creating and Training Models</h2>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-03-evaluating-predicting-models' title="Evaluating and Predicting with Models">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into the process of creating and training machine learning models using BigQuery ML (BQML). BigQuery ML allows data analysts and data scientists to build and operationalize machine learning models directly within BigQuery using SQL. This module will cover the following key concepts:</p>
<ol>
<li><strong>Introduction to BigQuery ML Models</strong></li>
<li><strong>Creating a Model</strong></li>
<li><strong>Training a Model</strong></li>
<li><strong>Evaluating Model Performance</strong></li>
<li><strong>Practical Exercises</strong></li>
</ol>
</div><h1><ol>
<li>Introduction to BigQuery ML Models</li>
</ol></h1>
<div class='content'><p>BigQuery ML supports several types of models, including:</p>
<ul>
<li><strong>Linear Regression</strong>: For predicting continuous values.</li>
<li><strong>Logistic Regression</strong>: For binary classification tasks.</li>
<li><strong>K-means Clustering</strong>: For unsupervised learning tasks.</li>
<li><strong>Matrix Factorization</strong>: For recommendation systems.</li>
<li><strong>Time Series Models</strong>: For forecasting.</li>
</ul>
</div><h1><ol start="2">
<li>Creating a Model</li>
</ol></h1>
<div class='content'><p>To create a model in BigQuery ML, you use the <code>CREATE MODEL</code> statement. Here is a basic example of creating a linear regression model:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgTU9ERUwgYG15X2RhdGFzZXQubXlfbW9kZWxgCk9QVElPTlMobW9kZWxfdHlwZT0nbGluZWFyX3JlZycpIEFTClNFTEVDVAogIGZlYXR1cmUxLAogIGZlYXR1cmUyLAogIHRhcmdldApGUk9NCiAgYG15X2RhdGFzZXQubXlfdGFibGVgOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE MODEL `my_dataset.my_model`
OPTIONS(model_type='linear_reg') AS
SELECT
  feature1,
  feature2,
  target
FROM
  `my_dataset.my_table`;</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><code>CREATE OR REPLACE MODEL</code>: This statement creates a new model or replaces an existing one.</li>
<li><code>my_dataset.my_model</code>: The name of the model.</li>
<li><code>OPTIONS(model_type='linear_reg')</code>: Specifies the type of model. In this case, a linear regression model.</li>
<li><code>SELECT feature1, feature2, target FROM my_dataset.my_table</code>: The SQL query to select the training data.</li>
</ul>
</div><h1><ol start="3">
<li>Training a Model</li>
</ol></h1>
<div class='content'><p>Training a model in BigQuery ML is integrated into the <code>CREATE MODEL</code> statement. When you run the <code>CREATE MODEL</code> statement, BigQuery ML automatically splits the data into training and evaluation sets, trains the model, and evaluates its performance.</p>
</div><h2>Example:</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgTU9ERUwgYG15X2RhdGFzZXQubXlfbW9kZWxgCk9QVElPTlMobW9kZWxfdHlwZT0nbGluZWFyX3JlZycsIGlucHV0X2xhYmVsX2NvbHM9Wyd0YXJnZXQnXSkgQVMKU0VMRUNUCiAgZmVhdHVyZTEsCiAgZmVhdHVyZTIsCiAgdGFyZ2V0CkZST00KICBgbXlfZGF0YXNldC5teV90YWJsZWA7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE MODEL `my_dataset.my_model`
OPTIONS(model_type='linear_reg', input_label_cols=['target']) AS
SELECT
  feature1,
  feature2,
  target
FROM
  `my_dataset.my_table`;</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><code>input_label_cols=['target']</code>: Specifies the column that contains the target variable.</li>
</ul>
</div><h1><ol start="4">
<li>Evaluating Model Performance</li>
</ol></h1>
<div class='content'><p>After training the model, you can evaluate its performance using the <code>ML.EVALUATE</code> function. This function returns various metrics depending on the model type.</p>
</div><h2>Example:</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUCiAgKgpGUk9NCiAgTUwuRVZBTFVBVEUoTU9ERUwgYG15X2RhdGFzZXQubXlfbW9kZWxgLCAoCiAgICBTRUxFQ1QKICAgICAgZmVhdHVyZTEsCiAgICAgIGZlYXR1cmUyLAogICAgICB0YXJnZXQKICAgIEZST00KICAgICAgYG15X2RhdGFzZXQubXlfdGFibGVgCiAgKSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT
  *
FROM
  ML.EVALUATE(MODEL `my_dataset.my_model`, (
    SELECT
      feature1,
      feature2,
      target
    FROM
      `my_dataset.my_table`
  ));</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><code>ML.EVALUATE</code>: Evaluates the model's performance.</li>
<li><code>MODEL my_dataset.my_model</code>: The model to evaluate.</li>
<li>The subquery provides the evaluation data.</li>
</ul>
</div><h1><ol start="5">
<li>Practical Exercises</li>
</ol></h1>
<div class='content'></div><h2>Exercise 1: Create and Train a Linear Regression Model</h2>
<div class='content'><p><strong>Task</strong>: Create and train a linear regression model to predict house prices based on features such as the number of bedrooms, bathrooms, and square footage.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgTU9ERUwgYHJlYWxfZXN0YXRlLmhvdXNlX3ByaWNlX21vZGVsYApPUFRJT05TKG1vZGVsX3R5cGU9J2xpbmVhcl9yZWcnLCBpbnB1dF9sYWJlbF9jb2xzPVsncHJpY2UnXSkgQVMKU0VMRUNUCiAgYmVkcm9vbXMsCiAgYmF0aHJvb21zLAogIHNxZnQsCiAgcHJpY2UKRlJPTQogIGByZWFsX2VzdGF0ZS5saXN0aW5nc2A7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE MODEL `real_estate.house_price_model`
OPTIONS(model_type='linear_reg', input_label_cols=['price']) AS
SELECT
  bedrooms,
  bathrooms,
  sqft,
  price
FROM
  `real_estate.listings`;</pre></div><div class='content'></div><h2>Exercise 2: Evaluate the Model</h2>
<div class='content'><p><strong>Task</strong>: Evaluate the performance of the <code>house_price_model</code> created in Exercise 1.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUCiAgKgpGUk9NCiAgTUwuRVZBTFVBVEUoTU9ERUwgYHJlYWxfZXN0YXRlLmhvdXNlX3ByaWNlX21vZGVsYCwgKAogICAgU0VMRUNUCiAgICAgIGJlZHJvb21zLAogICAgICBiYXRocm9vbXMsCiAgICAgIHNxZnQsCiAgICAgIHByaWNlCiAgICBGUk9NCiAgICAgIGByZWFsX2VzdGF0ZS5saXN0aW5nc2AKICApKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT
  *
FROM
  ML.EVALUATE(MODEL `real_estate.house_price_model`, (
    SELECT
      bedrooms,
      bathrooms,
      sqft,
      price
    FROM
      `real_estate.listings`
  ));</pre></div><div class='content'></div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Incorrect Data Types</strong>: Ensure that the data types of the features and target variable are appropriate for the model type.</li>
<li><strong>Data Quality</strong>: Clean and preprocess your data to handle missing values, outliers, and other data quality issues.</li>
<li><strong>Feature Selection</strong>: Select relevant features that have a significant impact on the target variable.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the basics of creating and training machine learning models using BigQuery ML. We learned how to create a model, train it, and evaluate its performance using SQL. The practical exercises provided hands-on experience with these concepts. In the next section, we will explore how to evaluate and predict with models in BigQuery ML.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='09-01-introduction-bqml' title="Introduction to BigQuery ML">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-03-evaluating-predicting-models' title="Evaluating and Predicting with Models">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
	     crossorigin="anonymous"></script>
	<!-- enterprise_campus -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-0611338592562725"
	     data-ad-slot="6914733106"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
	     (adsbygoogle = window.adsbygoogle || []).push({});
	</script>
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>BigQuery Course</h1>
<h2>Module 1: Introduction to BigQuery</h2>
<ul>
<li><a href="01-01-what-is-bigquery">What is BigQuery?</a></li>
<li><a href="01-02-setting-up-environment">Setting Up Your BigQuery Environment</a></li>
<li><a href="01-03-understanding-architecture">Understanding BigQuery Architecture</a></li>
<li><a href="01-04-console-overview">BigQuery Console Overview</a></li>
</ul>
<h2>Module 2: Basic SQL in BigQuery</h2>
<ul>
<li><a href="02-01-introduction-to-sql">Introduction to SQL</a></li>
<li><a href="02-02-basic-sql-queries">Basic SQL Queries</a></li>
<li><a href="02-03-filtering-sorting-data">Filtering and Sorting Data</a></li>
<li><a href="02-04-aggregating-data">Aggregating Data</a></li>
</ul>
<h2>Module 3: Intermediate SQL in BigQuery</h2>
<ul>
<li><a href="03-01-joins-unions">Joins and Unions</a></li>
<li><a href="03-02-subqueries">Subqueries</a></li>
<li><a href="03-03-common-table-expressions">Common Table Expressions (CTEs)</a></li>
<li><a href="03-04-window-functions">Window Functions</a></li>
</ul>
<h2>Module 4: Advanced SQL in BigQuery</h2>
<ul>
<li><a href="04-01-advanced-joins">Advanced Joins</a></li>
<li><a href="04-02-nested-repeated-fields">Nested and Repeated Fields</a></li>
<li><a href="04-03-user-defined-functions">User-Defined Functions (UDFs)</a></li>
<li><a href="04-04-partitioning-clustering">Partitioning and Clustering</a></li>
</ul>
<h2>Module 5: BigQuery Data Management</h2>
<ul>
<li><a href="05-01-loading-data">Loading Data into BigQuery</a></li>
<li><a href="05-02-exporting-data">Exporting Data from BigQuery</a></li>
<li><a href="05-03-data-transformation-cleaning">Data Transformation and Cleaning</a></li>
<li><a href="05-04-managing-datasets-tables">Managing Datasets and Tables</a></li>
</ul>
<h2>Module 6: BigQuery Performance Optimization</h2>
<ul>
<li><a href="06-01-query-optimization-techniques">Query Optimization Techniques</a></li>
<li><a href="06-02-query-execution-plans">Understanding Query Execution Plans</a></li>
<li><a href="06-03-using-materialized-views">Using Materialized Views</a></li>
<li><a href="06-04-optimizing-storage">Optimizing Storage</a></li>
</ul>
<h2>Module 7: BigQuery Security and Compliance</h2>
<ul>
<li><a href="07-01-access-control-permissions">Access Control and Permissions</a></li>
<li><a href="07-02-data-encryption">Data Encryption</a></li>
<li><a href="07-03-auditing-monitoring">Auditing and Monitoring</a></li>
<li><a href="07-04-compliance-best-practices">Compliance and Best Practices</a></li>
</ul>
<h2>Module 8: BigQuery Integration and Automation</h2>
<ul>
<li><a href="08-01-integrating-google-cloud">Integrating with Google Cloud Services</a></li>
<li><a href="08-02-using-dataflow">Using BigQuery with Dataflow</a></li>
<li><a href="08-03-automating-workflows">Automating Workflows with Cloud Functions</a></li>
<li><a href="08-04-scheduling-queries">Scheduling Queries with Cloud Scheduler</a></li>
</ul>
<h2>Module 9: BigQuery Machine Learning (BQML)</h2>
<ul>
<li><a href="09-01-introduction-bqml">Introduction to BigQuery ML</a></li>
<li><a href="09-02-creating-training-models">Creating and Training Models</a></li>
<li><a href="09-03-evaluating-predicting-models">Evaluating and Predicting with Models</a></li>
<li><a href="09-04-advanced-bqml-features">Advanced BQML Features</a></li>
</ul>
<h2>Module 10: Real-World BigQuery Use Cases</h2>
<ul>
<li><a href="10-01-analyzing-web-app-analytics">Analyzing Web and App Analytics</a></li>
<li><a href="10-02-financial-data-analysis">Financial Data Analysis</a></li>
<li><a href="10-03-iot-data-processing">IoT Data Processing</a></li>
<li><a href="10-04-building-dashboards-data-studio">Building Dashboards with Data Studio</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
</body>
</html>
