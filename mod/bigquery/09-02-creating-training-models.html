<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creating and Training Models</title>

    <link rel="alternate" href="https://campusempresa.com/mod/bigquery/09-02-creating-training-models" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/bigquery/09-02-creating-training-models" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/bigquery/09-02-creating-training-models" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/bigquery/09-02-creating-training-models" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/bigquery/09-02-creating-training-models" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='09-01-introduction-bqml' title="Introduction to BigQuery ML">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Creating and Training Models</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='09-03-evaluating-predicting-models' title="Evaluating and Predicting with Models">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into the process of creating and training machine learning models using BigQuery ML (BQML). BigQuery ML allows data analysts and data scientists to build and operationalize machine learning models directly within BigQuery using SQL. This module will cover the following key concepts:</p>
<ol>
<li><strong>Introduction to BigQuery ML Models</strong></li>
<li><strong>Creating a Model</strong></li>
<li><strong>Training a Model</strong></li>
<li><strong>Evaluating Model Performance</strong></li>
<li><strong>Practical Exercises</strong></li>
</ol>
</div><h1>1. Introduction to BigQuery ML Models</h1>
<div class='content'><p>BigQuery ML supports several types of models, including:</p>
<ul>
<li><strong>Linear Regression</strong>: For predicting continuous values.</li>
<li><strong>Logistic Regression</strong>: For binary classification tasks.</li>
<li><strong>K-means Clustering</strong>: For unsupervised learning tasks.</li>
<li><strong>Matrix Factorization</strong>: For recommendation systems.</li>
<li><strong>Time Series Models</strong>: For forecasting.</li>
</ul>
</div><h1>2. Creating a Model</h1>
<div class='content'><p>To create a model in BigQuery ML, you use the <code>CREATE MODEL</code> statement. Here is a basic example of creating a linear regression model:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgTU9ERUwgYG15X2RhdGFzZXQubXlfbW9kZWxgCk9QVElPTlMobW9kZWxfdHlwZT0nbGluZWFyX3JlZycpIEFTClNFTEVDVAogIGZlYXR1cmUxLAogIGZlYXR1cmUyLAogIHRhcmdldApGUk9NCiAgYG15X2RhdGFzZXQubXlfdGFibGVgOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE MODEL `my_dataset.my_model`
OPTIONS(model_type='linear_reg') AS
SELECT
  feature1,
  feature2,
  target
FROM
  `my_dataset.my_table`;</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><code>CREATE OR REPLACE MODEL</code>: This statement creates a new model or replaces an existing one.</li>
<li><code>my_dataset.my_model</code>: The name of the model.</li>
<li><code>OPTIONS(model_type='linear_reg')</code>: Specifies the type of model. In this case, a linear regression model.</li>
<li><code>SELECT feature1, feature2, target FROM my_dataset.my_table</code>: The SQL query to select the training data.</li>
</ul>
</div><h1>3. Training a Model</h1>
<div class='content'><p>Training a model in BigQuery ML is integrated into the <code>CREATE MODEL</code> statement. When you run the <code>CREATE MODEL</code> statement, BigQuery ML automatically splits the data into training and evaluation sets, trains the model, and evaluates its performance.</p>
</div><h2>Example:</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgTU9ERUwgYG15X2RhdGFzZXQubXlfbW9kZWxgCk9QVElPTlMobW9kZWxfdHlwZT0nbGluZWFyX3JlZycsIGlucHV0X2xhYmVsX2NvbHM9Wyd0YXJnZXQnXSkgQVMKU0VMRUNUCiAgZmVhdHVyZTEsCiAgZmVhdHVyZTIsCiAgdGFyZ2V0CkZST00KICBgbXlfZGF0YXNldC5teV90YWJsZWA7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE MODEL `my_dataset.my_model`
OPTIONS(model_type='linear_reg', input_label_cols=['target']) AS
SELECT
  feature1,
  feature2,
  target
FROM
  `my_dataset.my_table`;</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><code>input_label_cols=['target']</code>: Specifies the column that contains the target variable.</li>
</ul>
</div><h1>4. Evaluating Model Performance</h1>
<div class='content'><p>After training the model, you can evaluate its performance using the <code>ML.EVALUATE</code> function. This function returns various metrics depending on the model type.</p>
</div><h2>Example:</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUCiAgKgpGUk9NCiAgTUwuRVZBTFVBVEUoTU9ERUwgYG15X2RhdGFzZXQubXlfbW9kZWxgLCAoCiAgICBTRUxFQ1QKICAgICAgZmVhdHVyZTEsCiAgICAgIGZlYXR1cmUyLAogICAgICB0YXJnZXQKICAgIEZST00KICAgICAgYG15X2RhdGFzZXQubXlfdGFibGVgCiAgKSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT
  *
FROM
  ML.EVALUATE(MODEL `my_dataset.my_model`, (
    SELECT
      feature1,
      feature2,
      target
    FROM
      `my_dataset.my_table`
  ));</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><code>ML.EVALUATE</code>: Evaluates the model's performance.</li>
<li><code>MODEL my_dataset.my_model</code>: The model to evaluate.</li>
<li>The subquery provides the evaluation data.</li>
</ul>
</div><h1>5. Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Create and Train a Linear Regression Model</h2>
<div class='content'><p><strong>Task</strong>: Create and train a linear regression model to predict house prices based on features such as the number of bedrooms, bathrooms, and square footage.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgTU9ERUwgYHJlYWxfZXN0YXRlLmhvdXNlX3ByaWNlX21vZGVsYApPUFRJT05TKG1vZGVsX3R5cGU9J2xpbmVhcl9yZWcnLCBpbnB1dF9sYWJlbF9jb2xzPVsncHJpY2UnXSkgQVMKU0VMRUNUCiAgYmVkcm9vbXMsCiAgYmF0aHJvb21zLAogIHNxZnQsCiAgcHJpY2UKRlJPTQogIGByZWFsX2VzdGF0ZS5saXN0aW5nc2A7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE MODEL `real_estate.house_price_model`
OPTIONS(model_type='linear_reg', input_label_cols=['price']) AS
SELECT
  bedrooms,
  bathrooms,
  sqft,
  price
FROM
  `real_estate.listings`;</pre></div><div class='content'></div><h2>Exercise 2: Evaluate the Model</h2>
<div class='content'><p><strong>Task</strong>: Evaluate the performance of the <code>house_price_model</code> created in Exercise 1.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUCiAgKgpGUk9NCiAgTUwuRVZBTFVBVEUoTU9ERUwgYHJlYWxfZXN0YXRlLmhvdXNlX3ByaWNlX21vZGVsYCwgKAogICAgU0VMRUNUCiAgICAgIGJlZHJvb21zLAogICAgICBiYXRocm9vbXMsCiAgICAgIHNxZnQsCiAgICAgIHByaWNlCiAgICBGUk9NCiAgICAgIGByZWFsX2VzdGF0ZS5saXN0aW5nc2AKICApKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT
  *
FROM
  ML.EVALUATE(MODEL `real_estate.house_price_model`, (
    SELECT
      bedrooms,
      bathrooms,
      sqft,
      price
    FROM
      `real_estate.listings`
  ));</pre></div><div class='content'></div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Incorrect Data Types</strong>: Ensure that the data types of the features and target variable are appropriate for the model type.</li>
<li><strong>Data Quality</strong>: Clean and preprocess your data to handle missing values, outliers, and other data quality issues.</li>
<li><strong>Feature Selection</strong>: Select relevant features that have a significant impact on the target variable.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the basics of creating and training machine learning models using BigQuery ML. We learned how to create a model, train it, and evaluate its performance using SQL. The practical exercises provided hands-on experience with these concepts. In the next section, we will explore how to evaluate and predict with models in BigQuery ML.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='09-01-introduction-bqml' title="Introduction to BigQuery ML">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='09-03-evaluating-predicting-models' title="Evaluating and Predicting with Models">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
