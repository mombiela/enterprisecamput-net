<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Data Transformation and Cleaning</title>

    <link rel="alternate" href="https://campusempresa.com/mod/bigquery/05-03-data-transformation-cleaning" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/bigquery/05-03-data-transformation-cleaning" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/bigquery/05-03-data-transformation-cleaning" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>var DEVELOP = window.location.href.indexOf("localhost")!=-1 && true;</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/bigquery/05-03-data-transformation-cleaning" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/bigquery/05-03-data-transformation-cleaning" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>
		<!-- <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

			</div>
		</div>
	</div>
</div>
 -->
 
<div class="top-bar container-fluid">
	<div class="container-xxl">
		<nav class="navbar navbar-expand-md p-0">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<div class="navbar-nav me-auto">
							<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

					</div>
				</div>			
							</div>
		</nav>
	</div>
</div>				<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-02-exporting-data' title="Exporting Data from BigQuery">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<h2 style="text-decoration:underline">Data Transformation and Cleaning</h2>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-04-managing-datasets-tables' title="Managing Datasets and Tables">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Data transformation and cleaning are crucial steps in preparing your data for analysis. In this section, we will cover the following topics:</p>
<ol>
<li><strong>Introduction to Data Transformation and Cleaning</strong></li>
<li><strong>Common Data Transformation Techniques</strong></li>
<li><strong>Data Cleaning Methods</strong></li>
<li><strong>Practical Examples</strong></li>
<li><strong>Exercises</strong></li>
</ol>
</div><h1><ol>
<li>Introduction to Data Transformation and Cleaning</li>
</ol></h1>
<div class='content'><p>Data transformation involves converting data from one format or structure into another. This process is essential for integrating data from different sources, improving data quality, and making data more suitable for analysis.</p>
<p>Data cleaning, on the other hand, involves identifying and correcting errors and inconsistencies in the data to improve its quality. This step ensures that the data is accurate, complete, and reliable.</p>
</div><h1><ol start="2">
<li>Common Data Transformation Techniques</li>
</ol></h1>
<div class='content'><p>Here are some common data transformation techniques:</p>
<ul>
<li><strong>Normalization</strong>: Adjusting values measured on different scales to a common scale.</li>
<li><strong>Aggregation</strong>: Summarizing data, such as calculating averages or totals.</li>
<li><strong>Discretization</strong>: Converting continuous data into discrete buckets or intervals.</li>
<li><strong>Pivoting/Unpivoting</strong>: Reshaping data from a long format to a wide format and vice versa.</li>
<li><strong>Data Type Conversion</strong>: Changing the data type of a column, such as converting strings to dates.</li>
</ul>
</div><h1><ol start="3">
<li>Data Cleaning Methods</li>
</ol></h1>
<div class='content'><p>Data cleaning methods include:</p>
<ul>
<li><strong>Removing Duplicates</strong>: Identifying and removing duplicate records.</li>
<li><strong>Handling Missing Values</strong>: Filling in or removing missing data.</li>
<li><strong>Correcting Inconsistencies</strong>: Standardizing data formats and correcting errors.</li>
<li><strong>Outlier Detection</strong>: Identifying and handling outliers that may skew analysis.</li>
</ul>
</div><h1><ol start="4">
<li>Practical Examples</li>
</ol></h1>
<div class='content'></div><h2>Example 1: Normalization</h2>
<div class='content'><p>Suppose you have a table with sales data, and you want to normalize the sales amount.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("V0lUSCBzYWxlc19kYXRhIEFTICgKICBTRUxFQ1QKICAgIHByb2R1Y3RfaWQsCiAgICBzYWxlc19hbW91bnQKICBGUk9NCiAgICBgcHJvamVjdC5kYXRhc2V0LnNhbGVzYAopClNFTEVDVAogIHByb2R1Y3RfaWQsCiAgc2FsZXNfYW1vdW50LAogIChzYWxlc19hbW91bnQgLSBNSU4oc2FsZXNfYW1vdW50KSBPVkVSKCkpIC8gKE1BWChzYWxlc19hbW91bnQpIE9WRVIoKSAtIE1JTihzYWxlc19hbW91bnQpIE9WRVIoKSkgQVMgbm9ybWFsaXplZF9zYWxlc19hbW91bnQKRlJPTQogIHNhbGVzX2RhdGE7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>WITH sales_data AS (
  SELECT
    product_id,
    sales_amount
  FROM
    `project.dataset.sales`
)
SELECT
  product_id,
  sales_amount,
  (sales_amount - MIN(sales_amount) OVER()) / (MAX(sales_amount) OVER() - MIN(sales_amount) OVER()) AS normalized_sales_amount
FROM
  sales_data;</pre></div><div class='content'></div><h2>Example 2: Removing Duplicates</h2>
<div class='content'><p>To remove duplicate records from a table:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("V0lUSCByYW5rZWRfZGF0YSBBUyAoCiAgU0VMRUNUCiAgICAqLAogICAgUk9XX05VTUJFUigpIE9WRVIoUEFSVElUSU9OIEJZIHByb2R1Y3RfaWQgT1JERVIgQlkgdGltZXN0YW1wIERFU0MpIEFTIHJvd19udW0KICBGUk9NCiAgICBgcHJvamVjdC5kYXRhc2V0LnNhbGVzYAopClNFTEVDVAogICoKRlJPTQogIHJhbmtlZF9kYXRhCldIRVJFCiAgcm93X251bSA9IDE7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>WITH ranked_data AS (
  SELECT
    *,
    ROW_NUMBER() OVER(PARTITION BY product_id ORDER BY timestamp DESC) AS row_num
  FROM
    `project.dataset.sales`
)
SELECT
  *
FROM
  ranked_data
WHERE
  row_num = 1;</pre></div><div class='content'></div><h2>Example 3: Handling Missing Values</h2>
<div class='content'><p>To fill missing values with a default value:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUCiAgcHJvZHVjdF9pZCwKICBJRk5VTEwoc2FsZXNfYW1vdW50LCAwKSBBUyBzYWxlc19hbW91bnQKRlJPTQogIGBwcm9qZWN0LmRhdGFzZXQuc2FsZXNgOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT
  product_id,
  IFNULL(sales_amount, 0) AS sales_amount
FROM
  `project.dataset.sales`;</pre></div><div class='content'></div><h2>Example 4: Correcting Inconsistencies</h2>
<div class='content'><p>To standardize date formats:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUCiAgcHJvZHVjdF9pZCwKICBQQVJTRV9EQVRFKCclWS0lbS0lZCcsIGRhdGVfc3RyaW5nKSBBUyBzdGFuZGFyZGl6ZWRfZGF0ZQpGUk9NCiAgYHByb2plY3QuZGF0YXNldC5zYWxlc2A7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT
  product_id,
  PARSE_DATE('%Y-%m-%d', date_string) AS standardized_date
FROM
  `project.dataset.sales`;</pre></div><div class='content'></div><h1><ol start="5">
<li>Exercises</li>
</ol></h1>
<div class='content'></div><h2>Exercise 1: Data Normalization</h2>
<div class='content'><p>Normalize the <code>price</code> column in the <code>products</code> table.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("V0lUSCBwcm9kdWN0X2RhdGEgQVMgKAogIFNFTEVDVAogICAgcHJvZHVjdF9pZCwKICAgIHByaWNlCiAgRlJPTQogICAgYHByb2plY3QuZGF0YXNldC5wcm9kdWN0c2AKKQpTRUxFQ1QKICBwcm9kdWN0X2lkLAogIHByaWNlLAogIChwcmljZSAtIE1JTihwcmljZSkgT1ZFUigpKSAvIChNQVgocHJpY2UpIE9WRVIoKSAtIE1JTihwcmljZSkgT1ZFUigpKSBBUyBub3JtYWxpemVkX3ByaWNlCkZST00KICBwcm9kdWN0X2RhdGE7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>WITH product_data AS (
  SELECT
    product_id,
    price
  FROM
    `project.dataset.products`
)
SELECT
  product_id,
  price,
  (price - MIN(price) OVER()) / (MAX(price) OVER() - MIN(price) OVER()) AS normalized_price
FROM
  product_data;</pre></div><div class='content'></div><h2>Exercise 2: Removing Duplicates</h2>
<div class='content'><p>Remove duplicate records from the <code>customers</code> table, keeping only the most recent record for each customer.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("V0lUSCByYW5rZWRfY3VzdG9tZXJzIEFTICgKICBTRUxFQ1QKICAgICosCiAgICBST1dfTlVNQkVSKCkgT1ZFUihQQVJUSVRJT04gQlkgY3VzdG9tZXJfaWQgT1JERVIgQlkgbGFzdF91cGRhdGUgREVTQykgQVMgcm93X251bQogIEZST00KICAgIGBwcm9qZWN0LmRhdGFzZXQuY3VzdG9tZXJzYAopClNFTEVDVAogICoKRlJPTQogIHJhbmtlZF9jdXN0b21lcnMKV0hFUkUKICByb3dfbnVtID0gMTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>WITH ranked_customers AS (
  SELECT
    *,
    ROW_NUMBER() OVER(PARTITION BY customer_id ORDER BY last_update DESC) AS row_num
  FROM
    `project.dataset.customers`
)
SELECT
  *
FROM
  ranked_customers
WHERE
  row_num = 1;</pre></div><div class='content'></div><h2>Exercise 3: Handling Missing Values</h2>
<div class='content'><p>Fill missing values in the <code>quantity</code> column of the <code>orders</code> table with the value <code>1</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUCiAgb3JkZXJfaWQsCiAgSUZOVUxMKHF1YW50aXR5LCAxKSBBUyBxdWFudGl0eQpGUk9NCiAgYHByb2plY3QuZGF0YXNldC5vcmRlcnNgOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT
  order_id,
  IFNULL(quantity, 1) AS quantity
FROM
  `project.dataset.orders`;</pre></div><div class='content'></div><h2>Exercise 4: Correcting Inconsistencies</h2>
<div class='content'><p>Standardize the <code>order_date</code> column in the <code>orders</code> table to the format <code>YYYY-MM-DD</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUCiAgb3JkZXJfaWQsCiAgUEFSU0VfREFURSgnJVktJW0tJWQnLCBvcmRlcl9kYXRlKSBBUyBzdGFuZGFyZGl6ZWRfb3JkZXJfZGF0ZQpGUk9NCiAgYHByb2plY3QuZGF0YXNldC5vcmRlcnNgOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT
  order_id,
  PARSE_DATE('%Y-%m-%d', order_date) AS standardized_order_date
FROM
  `project.dataset.orders`;</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the essential techniques for data transformation and cleaning in BigQuery. These steps are crucial for ensuring that your data is accurate, consistent, and ready for analysis. By mastering these techniques, you can significantly improve the quality of your data and the reliability of your analysis.</p>
<p>Next, we will move on to managing datasets and tables in BigQuery, where you will learn how to organize and maintain your data effectively.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-02-exporting-data' title="Exporting Data from BigQuery">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-04-managing-datasets-tables' title="Managing Datasets and Tables">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
	     crossorigin="anonymous"></script>
	<!-- enterprise_campus -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-0611338592562725"
	     data-ad-slot="6914733106"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
	     (adsbygoogle = window.adsbygoogle || []).push({});
	</script>
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>BigQuery Course</h1>
<h2>Module 1: Introduction to BigQuery</h2>
<ul>
<li><a href="01-01-what-is-bigquery">What is BigQuery?</a></li>
<li><a href="01-02-setting-up-environment">Setting Up Your BigQuery Environment</a></li>
<li><a href="01-03-understanding-architecture">Understanding BigQuery Architecture</a></li>
<li><a href="01-04-console-overview">BigQuery Console Overview</a></li>
</ul>
<h2>Module 2: Basic SQL in BigQuery</h2>
<ul>
<li><a href="02-01-introduction-to-sql">Introduction to SQL</a></li>
<li><a href="02-02-basic-sql-queries">Basic SQL Queries</a></li>
<li><a href="02-03-filtering-sorting-data">Filtering and Sorting Data</a></li>
<li><a href="02-04-aggregating-data">Aggregating Data</a></li>
</ul>
<h2>Module 3: Intermediate SQL in BigQuery</h2>
<ul>
<li><a href="03-01-joins-unions">Joins and Unions</a></li>
<li><a href="03-02-subqueries">Subqueries</a></li>
<li><a href="03-03-common-table-expressions">Common Table Expressions (CTEs)</a></li>
<li><a href="03-04-window-functions">Window Functions</a></li>
</ul>
<h2>Module 4: Advanced SQL in BigQuery</h2>
<ul>
<li><a href="04-01-advanced-joins">Advanced Joins</a></li>
<li><a href="04-02-nested-repeated-fields">Nested and Repeated Fields</a></li>
<li><a href="04-03-user-defined-functions">User-Defined Functions (UDFs)</a></li>
<li><a href="04-04-partitioning-clustering">Partitioning and Clustering</a></li>
</ul>
<h2>Module 5: BigQuery Data Management</h2>
<ul>
<li><a href="05-01-loading-data">Loading Data into BigQuery</a></li>
<li><a href="05-02-exporting-data">Exporting Data from BigQuery</a></li>
<li><a href="05-03-data-transformation-cleaning">Data Transformation and Cleaning</a></li>
<li><a href="05-04-managing-datasets-tables">Managing Datasets and Tables</a></li>
</ul>
<h2>Module 6: BigQuery Performance Optimization</h2>
<ul>
<li><a href="06-01-query-optimization-techniques">Query Optimization Techniques</a></li>
<li><a href="06-02-query-execution-plans">Understanding Query Execution Plans</a></li>
<li><a href="06-03-using-materialized-views">Using Materialized Views</a></li>
<li><a href="06-04-optimizing-storage">Optimizing Storage</a></li>
</ul>
<h2>Module 7: BigQuery Security and Compliance</h2>
<ul>
<li><a href="07-01-access-control-permissions">Access Control and Permissions</a></li>
<li><a href="07-02-data-encryption">Data Encryption</a></li>
<li><a href="07-03-auditing-monitoring">Auditing and Monitoring</a></li>
<li><a href="07-04-compliance-best-practices">Compliance and Best Practices</a></li>
</ul>
<h2>Module 8: BigQuery Integration and Automation</h2>
<ul>
<li><a href="08-01-integrating-google-cloud">Integrating with Google Cloud Services</a></li>
<li><a href="08-02-using-dataflow">Using BigQuery with Dataflow</a></li>
<li><a href="08-03-automating-workflows">Automating Workflows with Cloud Functions</a></li>
<li><a href="08-04-scheduling-queries">Scheduling Queries with Cloud Scheduler</a></li>
</ul>
<h2>Module 9: BigQuery Machine Learning (BQML)</h2>
<ul>
<li><a href="09-01-introduction-bqml">Introduction to BigQuery ML</a></li>
<li><a href="09-02-creating-training-models">Creating and Training Models</a></li>
<li><a href="09-03-evaluating-predicting-models">Evaluating and Predicting with Models</a></li>
<li><a href="09-04-advanced-bqml-features">Advanced BQML Features</a></li>
</ul>
<h2>Module 10: Real-World BigQuery Use Cases</h2>
<ul>
<li><a href="10-01-analyzing-web-app-analytics">Analyzing Web and App Analytics</a></li>
<li><a href="10-02-financial-data-analysis">Financial Data Analysis</a></li>
<li><a href="10-03-iot-data-processing">IoT Data Processing</a></li>
<li><a href="10-04-building-dashboards-data-studio">Building Dashboards with Data Studio</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
</body>
</html>
