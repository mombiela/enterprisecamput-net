<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Transformation and Cleaning</title>

    <link rel="alternate" href="https://campusempresa.com/mod/bigquery/05-03-data-transformation-cleaning" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/bigquery/05-03-data-transformation-cleaning" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/bigquery/05-03-data-transformation-cleaning" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/bigquery/05-03-data-transformation-cleaning" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/bigquery/05-03-data-transformation-cleaning" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-exporting-data' title="Exporting Data from BigQuery">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Data Transformation and Cleaning</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-managing-datasets-tables' title="Managing Datasets and Tables">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Data transformation and cleaning are crucial steps in preparing your data for analysis. In this section, we will cover the following topics:</p>
<ol>
<li><strong>Introduction to Data Transformation and Cleaning</strong></li>
<li><strong>Common Data Transformation Techniques</strong></li>
<li><strong>Data Cleaning Methods</strong></li>
<li><strong>Practical Examples</strong></li>
<li><strong>Exercises</strong></li>
</ol>
</div><h1><ol>
<li>Introduction to Data Transformation and Cleaning</li>
</ol>
</h1>
<div class='content'><p>Data transformation involves converting data from one format or structure into another. This process is essential for integrating data from different sources, improving data quality, and making data more suitable for analysis.</p>
<p>Data cleaning, on the other hand, involves identifying and correcting errors and inconsistencies in the data to improve its quality. This step ensures that the data is accurate, complete, and reliable.</p>
</div><h1><ol start="2">
<li>Common Data Transformation Techniques</li>
</ol>
</h1>
<div class='content'><p>Here are some common data transformation techniques:</p>
<ul>
<li><strong>Normalization</strong>: Adjusting values measured on different scales to a common scale.</li>
<li><strong>Aggregation</strong>: Summarizing data, such as calculating averages or totals.</li>
<li><strong>Discretization</strong>: Converting continuous data into discrete buckets or intervals.</li>
<li><strong>Pivoting/Unpivoting</strong>: Reshaping data from a long format to a wide format and vice versa.</li>
<li><strong>Data Type Conversion</strong>: Changing the data type of a column, such as converting strings to dates.</li>
</ul>
</div><h1><ol start="3">
<li>Data Cleaning Methods</li>
</ol>
</h1>
<div class='content'><p>Data cleaning methods include:</p>
<ul>
<li><strong>Removing Duplicates</strong>: Identifying and removing duplicate records.</li>
<li><strong>Handling Missing Values</strong>: Filling in or removing missing data.</li>
<li><strong>Correcting Inconsistencies</strong>: Standardizing data formats and correcting errors.</li>
<li><strong>Outlier Detection</strong>: Identifying and handling outliers that may skew analysis.</li>
</ul>
</div><h1><ol start="4">
<li>Practical Examples</li>
</ol>
</h1>
<div class='content'></div><h2><p>Example 1: Normalization</p>
</h2>
<div class='content'><p>Suppose you have a table with sales data, and you want to normalize the sales amount.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("V0lUSCBzYWxlc19kYXRhIEFTICgKICBTRUxFQ1QKICAgIHByb2R1Y3RfaWQsCiAgICBzYWxlc19hbW91bnQKICBGUk9NCiAgICBgcHJvamVjdC5kYXRhc2V0LnNhbGVzYAopClNFTEVDVAogIHByb2R1Y3RfaWQsCiAgc2FsZXNfYW1vdW50LAogIChzYWxlc19hbW91bnQgLSBNSU4oc2FsZXNfYW1vdW50KSBPVkVSKCkpIC8gKE1BWChzYWxlc19hbW91bnQpIE9WRVIoKSAtIE1JTihzYWxlc19hbW91bnQpIE9WRVIoKSkgQVMgbm9ybWFsaXplZF9zYWxlc19hbW91bnQKRlJPTQogIHNhbGVzX2RhdGE7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>WITH sales_data AS (
  SELECT
    product_id,
    sales_amount
  FROM
    `project.dataset.sales`
)
SELECT
  product_id,
  sales_amount,
  (sales_amount - MIN(sales_amount) OVER()) / (MAX(sales_amount) OVER() - MIN(sales_amount) OVER()) AS normalized_sales_amount
FROM
  sales_data;</pre></div><div class='content'></div><h2><p>Example 2: Removing Duplicates</p>
</h2>
<div class='content'><p>To remove duplicate records from a table:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("V0lUSCByYW5rZWRfZGF0YSBBUyAoCiAgU0VMRUNUCiAgICAqLAogICAgUk9XX05VTUJFUigpIE9WRVIoUEFSVElUSU9OIEJZIHByb2R1Y3RfaWQgT1JERVIgQlkgdGltZXN0YW1wIERFU0MpIEFTIHJvd19udW0KICBGUk9NCiAgICBgcHJvamVjdC5kYXRhc2V0LnNhbGVzYAopClNFTEVDVAogICoKRlJPTQogIHJhbmtlZF9kYXRhCldIRVJFCiAgcm93X251bSA9IDE7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>WITH ranked_data AS (
  SELECT
    *,
    ROW_NUMBER() OVER(PARTITION BY product_id ORDER BY timestamp DESC) AS row_num
  FROM
    `project.dataset.sales`
)
SELECT
  *
FROM
  ranked_data
WHERE
  row_num = 1;</pre></div><div class='content'></div><h2><p>Example 3: Handling Missing Values</p>
</h2>
<div class='content'><p>To fill missing values with a default value:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUCiAgcHJvZHVjdF9pZCwKICBJRk5VTEwoc2FsZXNfYW1vdW50LCAwKSBBUyBzYWxlc19hbW91bnQKRlJPTQogIGBwcm9qZWN0LmRhdGFzZXQuc2FsZXNgOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT
  product_id,
  IFNULL(sales_amount, 0) AS sales_amount
FROM
  `project.dataset.sales`;</pre></div><div class='content'></div><h2><p>Example 4: Correcting Inconsistencies</p>
</h2>
<div class='content'><p>To standardize date formats:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUCiAgcHJvZHVjdF9pZCwKICBQQVJTRV9EQVRFKCclWS0lbS0lZCcsIGRhdGVfc3RyaW5nKSBBUyBzdGFuZGFyZGl6ZWRfZGF0ZQpGUk9NCiAgYHByb2plY3QuZGF0YXNldC5zYWxlc2A7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT
  product_id,
  PARSE_DATE('%Y-%m-%d', date_string) AS standardized_date
FROM
  `project.dataset.sales`;</pre></div><div class='content'></div><h1><ol start="5">
<li>Exercises</li>
</ol>
</h1>
<div class='content'></div><h2><p>Exercise 1: Data Normalization</p>
</h2>
<div class='content'><p>Normalize the <code>price</code> column in the <code>products</code> table.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("V0lUSCBwcm9kdWN0X2RhdGEgQVMgKAogIFNFTEVDVAogICAgcHJvZHVjdF9pZCwKICAgIHByaWNlCiAgRlJPTQogICAgYHByb2plY3QuZGF0YXNldC5wcm9kdWN0c2AKKQpTRUxFQ1QKICBwcm9kdWN0X2lkLAogIHByaWNlLAogIChwcmljZSAtIE1JTihwcmljZSkgT1ZFUigpKSAvIChNQVgocHJpY2UpIE9WRVIoKSAtIE1JTihwcmljZSkgT1ZFUigpKSBBUyBub3JtYWxpemVkX3ByaWNlCkZST00KICBwcm9kdWN0X2RhdGE7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>WITH product_data AS (
  SELECT
    product_id,
    price
  FROM
    `project.dataset.products`
)
SELECT
  product_id,
  price,
  (price - MIN(price) OVER()) / (MAX(price) OVER() - MIN(price) OVER()) AS normalized_price
FROM
  product_data;</pre></div><div class='content'></div><h2><p>Exercise 2: Removing Duplicates</p>
</h2>
<div class='content'><p>Remove duplicate records from the <code>customers</code> table, keeping only the most recent record for each customer.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("V0lUSCByYW5rZWRfY3VzdG9tZXJzIEFTICgKICBTRUxFQ1QKICAgICosCiAgICBST1dfTlVNQkVSKCkgT1ZFUihQQVJUSVRJT04gQlkgY3VzdG9tZXJfaWQgT1JERVIgQlkgbGFzdF91cGRhdGUgREVTQykgQVMgcm93X251bQogIEZST00KICAgIGBwcm9qZWN0LmRhdGFzZXQuY3VzdG9tZXJzYAopClNFTEVDVAogICoKRlJPTQogIHJhbmtlZF9jdXN0b21lcnMKV0hFUkUKICByb3dfbnVtID0gMTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>WITH ranked_customers AS (
  SELECT
    *,
    ROW_NUMBER() OVER(PARTITION BY customer_id ORDER BY last_update DESC) AS row_num
  FROM
    `project.dataset.customers`
)
SELECT
  *
FROM
  ranked_customers
WHERE
  row_num = 1;</pre></div><div class='content'></div><h2><p>Exercise 3: Handling Missing Values</p>
</h2>
<div class='content'><p>Fill missing values in the <code>quantity</code> column of the <code>orders</code> table with the value <code>1</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUCiAgb3JkZXJfaWQsCiAgSUZOVUxMKHF1YW50aXR5LCAxKSBBUyBxdWFudGl0eQpGUk9NCiAgYHByb2plY3QuZGF0YXNldC5vcmRlcnNgOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT
  order_id,
  IFNULL(quantity, 1) AS quantity
FROM
  `project.dataset.orders`;</pre></div><div class='content'></div><h2><p>Exercise 4: Correcting Inconsistencies</p>
</h2>
<div class='content'><p>Standardize the <code>order_date</code> column in the <code>orders</code> table to the format <code>YYYY-MM-DD</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUCiAgb3JkZXJfaWQsCiAgUEFSU0VfREFURSgnJVktJW0tJWQnLCBvcmRlcl9kYXRlKSBBUyBzdGFuZGFyZGl6ZWRfb3JkZXJfZGF0ZQpGUk9NCiAgYHByb2plY3QuZGF0YXNldC5vcmRlcnNgOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT
  order_id,
  PARSE_DATE('%Y-%m-%d', order_date) AS standardized_order_date
FROM
  `project.dataset.orders`;</pre></div><div class='content'></div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered the essential techniques for data transformation and cleaning in BigQuery. These steps are crucial for ensuring that your data is accurate, consistent, and ready for analysis. By mastering these techniques, you can significantly improve the quality of your data and the reliability of your analysis.</p>
<p>Next, we will move on to managing datasets and tables in BigQuery, where you will learn how to organize and maintain your data effectively.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-exporting-data' title="Exporting Data from BigQuery">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-managing-datasets-tables' title="Managing Datasets and Tables">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
