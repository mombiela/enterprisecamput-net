<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Error Handling</title>

    <link rel="alternate" href="https://campusempresa.com/mod/rest_api/03-05-manejo-errores" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/rest_api/03-05-manejo-errores" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/rest_api/03-05-error-handling" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/rest_api/03-05-manejo-errores" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/rest_api/03-05-manejo-errores" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-04-authentication-authorization' title="Authentication and Authorization">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Error Handling</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='03-06-testing-validation' title="Testing and Validation">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Error handling is a critical aspect of developing robust and user-friendly RESTful APIs. Proper error handling ensures that clients receive meaningful feedback when something goes wrong, which can help them understand and resolve issues more efficiently. In this section, we will cover the principles of error handling in RESTful APIs, common HTTP status codes for errors, and how to implement error handling in your API.</p>
</div><h1><p>Principles of Error Handling</p>
</h1>
<div class='content'><ol>
<li><strong>Consistency</strong>: Ensure that error responses are consistent across your API. This helps clients to handle errors more predictably.</li>
<li><strong>Clarity</strong>: Provide clear and concise error messages that help clients understand what went wrong and how to fix it.</li>
<li><strong>Use Standard HTTP Status Codes</strong>: Utilize standard HTTP status codes to indicate the type of error.</li>
<li><strong>Detailed Error Information</strong>: Include additional details in the error response body to provide more context about the error.</li>
<li><strong>Avoid Leaking Sensitive Information</strong>: Be cautious not to expose sensitive information in error messages.</li>
</ol>
</div><h1><p>Common HTTP Status Codes for Errors</p>
</h1>
<div class='content'><p>Here is a table of common HTTP status codes used for error handling in RESTful APIs:</p>
<table>
<thead>
<tr>
<th>Status Code</th>
<th>Meaning</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>400</td>
<td>Bad Request</td>
<td>The request could not be understood or was missing required parameters.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized</td>
<td>Authentication failed or user does not have permissions for the requested operation.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden</td>
<td>Authentication succeeded but authenticated user does not have access to the requested resource.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found</td>
<td>The requested resource could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed</td>
<td>The HTTP method is not allowed for the requested resource.</td>
</tr>
<tr>
<td>409</td>
<td>Conflict</td>
<td>The request could not be completed due to a conflict with the current state of the resource.</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error</td>
<td>An error occurred on the server.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable</td>
<td>The server is currently unavailable (e.g., due to maintenance).</td>
</tr>
</tbody>
</table>
</div><h1><p>Implementing Error Handling</p>
</h1>
<div class='content'></div><h2><p>Example: Express.js Error Handling</p>
</h2>
<div class='content'><p>Let's look at how to implement error handling in a Node.js application using the Express framework.</p>
<ol>
<li><strong>Setting Up the Error Handler Middleware</strong></li>
</ol>
<p>First, we need to set up an error handler middleware in our Express application. This middleware will catch any errors that occur during the request processing and send an appropriate response to the client.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgYXBwID0gZXhwcmVzcygpOwoKLy8gTWlkZGxld2FyZSB0byBoYW5kbGUgZXJyb3JzCmFwcC51c2UoKGVyciwgcmVxLCByZXMsIG5leHQpID0+IHsKICAgIGNvbnNvbGUuZXJyb3IoZXJyLnN0YWNrKTsKICAgIHJlcy5zdGF0dXMoZXJyLnN0YXR1cyB8fCA1MDApLmpzb24oewogICAgICAgIHN0YXR1czogZXJyLnN0YXR1cyB8fCA1MDAsCiAgICAgICAgbWVzc2FnZTogZXJyLm1lc3NhZ2UgfHwgJ0ludGVybmFsIFNlcnZlciBFcnJvcicsCiAgICAgICAgZGV0YWlsczogZXJyLmRldGFpbHMgfHwgJ0FuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQnCiAgICB9KTsKfSk7CgovLyBFeGFtcGxlIHJvdXRlIHRoYXQgdHJpZ2dlcnMgYW4gZXJyb3IKYXBwLmdldCgnL2Vycm9yJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7CiAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignU29tZXRoaW5nIHdlbnQgd3JvbmchJyk7CiAgICBlcnJvci5zdGF0dXMgPSA0MDA7CiAgICBuZXh0KGVycm9yKTsKfSk7CgphcHAubGlzdGVuKDMwMDAsICgpID0+IHsKICAgIGNvbnNvbGUubG9nKCdTZXJ2ZXIgaXMgcnVubmluZyBvbiBwb3J0IDMwMDAnKTsKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const app = express();

// Middleware to handle errors
app.use((err, req, res, next) =&gt; {
    console.error(err.stack);
    res.status(err.status || 500).json({
        status: err.status || 500,
        message: err.message || 'Internal Server Error',
        details: err.details || 'An unexpected error occurred'
    });
});

// Example route that triggers an error
app.get('/error', (req, res, next) =&gt; {
    const error = new Error('Something went wrong!');
    error.status = 400;
    next(error);
});

app.listen(3000, () =&gt; {
    console.log('Server is running on port 3000');
});</pre></div><div class='content'><ol start="2">
<li><strong>Creating Custom Error Classes</strong></li>
</ol>
<p>To provide more detailed error information, we can create custom error classes. This allows us to add additional properties to our errors, such as a status code and detailed error messages.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgQXBwRXJyb3IgZXh0ZW5kcyBFcnJvciB7CiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlLCBzdGF0dXMsIGRldGFpbHMpIHsKICAgICAgICBzdXBlcihtZXNzYWdlKTsKICAgICAgICB0aGlzLnN0YXR1cyA9IHN0YXR1czsKICAgICAgICB0aGlzLmRldGFpbHMgPSBkZXRhaWxzOwogICAgfQp9CgovLyBFeGFtcGxlIHVzYWdlIG9mIGN1c3RvbSBlcnJvciBjbGFzcwphcHAuZ2V0KCcvY3VzdG9tLWVycm9yJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7CiAgICBjb25zdCBlcnJvciA9IG5ldyBBcHBFcnJvcignQ3VzdG9tIGVycm9yIG9jY3VycmVkJywgNDAwLCAnQWRkaXRpb25hbCBlcnJvciBkZXRhaWxzJyk7CiAgICBuZXh0KGVycm9yKTsKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class AppError extends Error {
    constructor(message, status, details) {
        super(message);
        this.status = status;
        this.details = details;
    }
}

// Example usage of custom error class
app.get('/custom-error', (req, res, next) =&gt; {
    const error = new AppError('Custom error occurred', 400, 'Additional error details');
    next(error);
});</pre></div><div class='content'></div><h2><p>Practical Exercise</p>
</h2>
<div class='content'><p><strong>Exercise</strong>: Implement error handling for a simple RESTful API that manages a list of users. The API should have the following endpoints:</p>
<ul>
<li><code>GET /users</code>: Retrieve a list of users.</li>
<li><code>POST /users</code>: Create a new user.</li>
<li><code>GET /users/:id</code>: Retrieve a user by ID.</li>
<li><code>PUT /users/:id</code>: Update a user by ID.</li>
<li><code>DELETE /users/:id</code>: Delete a user by ID.</li>
</ul>
<p>Ensure that appropriate error handling is implemented for scenarios such as missing parameters, invalid user IDs, and server errors.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgYXBwID0gZXhwcmVzcygpOwphcHAudXNlKGV4cHJlc3MuanNvbigpKTsKCmxldCB1c2VycyA9IFtdOwoKLy8gTWlkZGxld2FyZSB0byBoYW5kbGUgZXJyb3JzCmFwcC51c2UoKGVyciwgcmVxLCByZXMsIG5leHQpID0+IHsKICAgIGNvbnNvbGUuZXJyb3IoZXJyLnN0YWNrKTsKICAgIHJlcy5zdGF0dXMoZXJyLnN0YXR1cyB8fCA1MDApLmpzb24oewogICAgICAgIHN0YXR1czogZXJyLnN0YXR1cyB8fCA1MDAsCiAgICAgICAgbWVzc2FnZTogZXJyLm1lc3NhZ2UgfHwgJ0ludGVybmFsIFNlcnZlciBFcnJvcicsCiAgICAgICAgZGV0YWlsczogZXJyLmRldGFpbHMgfHwgJ0FuIHVuZXhwZWN0ZWQgZXJyb3Igb2NjdXJyZWQnCiAgICB9KTsKfSk7CgovLyBHRVQgL3VzZXJzCmFwcC5nZXQoJy91c2VycycsIChyZXEsIHJlcykgPT4gewogICAgcmVzLmpzb24odXNlcnMpOwp9KTsKCi8vIFBPU1QgL3VzZXJzCmFwcC5wb3N0KCcvdXNlcnMnLCAocmVxLCByZXMsIG5leHQpID0+IHsKICAgIGNvbnN0IHsgbmFtZSwgZW1haWwgfSA9IHJlcS5ib2R5OwogICAgaWYgKCFuYW1lIHx8ICFlbWFpbCkgewogICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEFwcEVycm9yKCdOYW1lIGFuZCBlbWFpbCBhcmUgcmVxdWlyZWQnLCA0MDAsICdNaXNzaW5nIHBhcmFtZXRlcnMnKTsKICAgICAgICByZXR1cm4gbmV4dChlcnJvcik7CiAgICB9CiAgICBjb25zdCBuZXdVc2VyID0geyBpZDogdXNlcnMubGVuZ3RoICsgMSwgbmFtZSwgZW1haWwgfTsKICAgIHVzZXJzLnB1c2gobmV3VXNlcik7CiAgICByZXMuc3RhdHVzKDIwMSkuanNvbihuZXdVc2VyKTsKfSk7CgovLyBHRVQgL3VzZXJzLzppZAphcHAuZ2V0KCcvdXNlcnMvOmlkJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7CiAgICBjb25zdCB1c2VyID0gdXNlcnMuZmluZCh1ID0+IHUuaWQgPT09IHBhcnNlSW50KHJlcS5wYXJhbXMuaWQpKTsKICAgIGlmICghdXNlcikgewogICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEFwcEVycm9yKCdVc2VyIG5vdCBmb3VuZCcsIDQwNCwgJ0ludmFsaWQgdXNlciBJRCcpOwogICAgICAgIHJldHVybiBuZXh0KGVycm9yKTsKICAgIH0KICAgIHJlcy5qc29uKHVzZXIpOwp9KTsKCi8vIFBVVCAvdXNlcnMvOmlkCmFwcC5wdXQoJy91c2Vycy86aWQnLCAocmVxLCByZXMsIG5leHQpID0+IHsKICAgIGNvbnN0IHVzZXIgPSB1c2Vycy5maW5kKHUgPT4gdS5pZCA9PT0gcGFyc2VJbnQocmVxLnBhcmFtcy5pZCkpOwogICAgaWYgKCF1c2VyKSB7CiAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgQXBwRXJyb3IoJ1VzZXIgbm90IGZvdW5kJywgNDA0LCAnSW52YWxpZCB1c2VyIElEJyk7CiAgICAgICAgcmV0dXJuIG5leHQoZXJyb3IpOwogICAgfQogICAgY29uc3QgeyBuYW1lLCBlbWFpbCB9ID0gcmVxLmJvZHk7CiAgICBpZiAoIW5hbWUgfHwgIWVtYWlsKSB7CiAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgQXBwRXJyb3IoJ05hbWUgYW5kIGVtYWlsIGFyZSByZXF1aXJlZCcsIDQwMCwgJ01pc3NpbmcgcGFyYW1ldGVycycpOwogICAgICAgIHJldHVybiBuZXh0KGVycm9yKTsKICAgIH0KICAgIHVzZXIubmFtZSA9IG5hbWU7CiAgICB1c2VyLmVtYWlsID0gZW1haWw7CiAgICByZXMuanNvbih1c2VyKTsKfSk7CgovLyBERUxFVEUgL3VzZXJzLzppZAphcHAuZGVsZXRlKCcvdXNlcnMvOmlkJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7CiAgICBjb25zdCB1c2VySW5kZXggPSB1c2Vycy5maW5kSW5kZXgodSA9PiB1LmlkID09PSBwYXJzZUludChyZXEucGFyYW1zLmlkKSk7CiAgICBpZiAodXNlckluZGV4ID09PSAtMSkgewogICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEFwcEVycm9yKCdVc2VyIG5vdCBmb3VuZCcsIDQwNCwgJ0ludmFsaWQgdXNlciBJRCcpOwogICAgICAgIHJldHVybiBuZXh0KGVycm9yKTsKICAgIH0KICAgIHVzZXJzLnNwbGljZSh1c2VySW5kZXgsIDEpOwogICAgcmVzLnN0YXR1cygyMDQpLnNlbmQoKTsKfSk7CgpjbGFzcyBBcHBFcnJvciBleHRlbmRzIEVycm9yIHsKICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIHN0YXR1cywgZGV0YWlscykgewogICAgICAgIHN1cGVyKG1lc3NhZ2UpOwogICAgICAgIHRoaXMuc3RhdHVzID0gc3RhdHVzOwogICAgICAgIHRoaXMuZGV0YWlscyA9IGRldGFpbHM7CiAgICB9Cn0KCmFwcC5saXN0ZW4oMzAwMCwgKCkgPT4gewogICAgY29uc29sZS5sb2coJ1NlcnZlciBpcyBydW5uaW5nIG9uIHBvcnQgMzAwMCcpOwp9KTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const app = express();
app.use(express.json());

let users = [];

// Middleware to handle errors
app.use((err, req, res, next) =&gt; {
    console.error(err.stack);
    res.status(err.status || 500).json({
        status: err.status || 500,
        message: err.message || 'Internal Server Error',
        details: err.details || 'An unexpected error occurred'
    });
});

// GET /users
app.get('/users', (req, res) =&gt; {
    res.json(users);
});

// POST /users
app.post('/users', (req, res, next) =&gt; {
    const { name, email } = req.body;
    if (!name || !email) {
        const error = new AppError('Name and email are required', 400, 'Missing parameters');
        return next(error);
    }
    const newUser = { id: users.length + 1, name, email };
    users.push(newUser);
    res.status(201).json(newUser);
});

// GET /users/:id
app.get('/users/:id', (req, res, next) =&gt; {
    const user = users.find(u =&gt; u.id === parseInt(req.params.id));
    if (!user) {
        const error = new AppError('User not found', 404, 'Invalid user ID');
        return next(error);
    }
    res.json(user);
});

// PUT /users/:id
app.put('/users/:id', (req, res, next) =&gt; {
    const user = users.find(u =&gt; u.id === parseInt(req.params.id));
    if (!user) {
        const error = new AppError('User not found', 404, 'Invalid user ID');
        return next(error);
    }
    const { name, email } = req.body;
    if (!name || !email) {
        const error = new AppError('Name and email are required', 400, 'Missing parameters');
        return next(error);
    }
    user.name = name;
    user.email = email;
    res.json(user);
});

// DELETE /users/:id
app.delete('/users/:id', (req, res, next) =&gt; {
    const userIndex = users.findIndex(u =&gt; u.id === parseInt(req.params.id));
    if (userIndex === -1) {
        const error = new AppError('User not found', 404, 'Invalid user ID');
        return next(error);
    }
    users.splice(userIndex, 1);
    res.status(204).send();
});

class AppError extends Error {
    constructor(message, status, details) {
        super(message);
        this.status = status;
        this.details = details;
    }
}

app.listen(3000, () =&gt; {
    console.log('Server is running on port 3000');
});</pre></div><div class='content'></div><h2><p>Common Mistakes and Tips</p>
</h2>
<div class='content'><ul>
<li><strong>Not Using Standard HTTP Status Codes</strong>: Always use standard HTTP status codes to indicate the type of error. This helps clients understand the nature of the error.</li>
<li><strong>Inconsistent Error Responses</strong>: Ensure that error responses are consistent across your API. This makes it easier for clients to handle errors.</li>
<li><strong>Exposing Sensitive Information</strong>: Be careful not to expose sensitive information in error messages. This can be a security risk.</li>
<li><strong>Not Providing Enough Detail</strong>: While you should avoid exposing sensitive information, it's also important to provide enough detail in error messages to help clients understand and resolve issues.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered the principles of error handling in RESTful APIs, common HTTP status codes for errors, and how to implement error handling in an Express.js application. Proper error handling is essential for creating robust and user-friendly APIs. By following the principles and best practices outlined in this section, you can ensure that your API provides meaningful feedback to clients when something goes wrong.</p>
<p>Next, we will move on to the topic of <strong>Testing and Validation</strong>, where we will learn how to test and validate our API to ensure it works as expected.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-04-authentication-authorization' title="Authentication and Authorization">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='03-06-testing-validation' title="Testing and Validation">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
