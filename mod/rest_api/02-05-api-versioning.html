<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Versioning</title>

    <link rel="alternate" href="https://campusempresa.com/mod/rest_api/02-05-versionado-apis" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/rest_api/02-05-versionado-apis" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/rest_api/02-05-api-versioning" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/rest_api/02-05-versionado-apis" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/rest_api/02-05-versionado-apis" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-http-status-codes' title="HTTP Status Codes">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">API Versioning</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='02-06-api-documentation' title="API Documentation">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>API versioning is a crucial aspect of API design that ensures backward compatibility and smooth transitions when updates or changes are made to the API. This section will cover the principles, methods, and best practices for versioning RESTful APIs.</p>
</div><h1>Why Versioning is Important</h1>
<div class='content'><ol>
<li><strong>Backward Compatibility</strong>: Ensures that existing clients continue to function without modification even after the API is updated.</li>
<li><strong>Controlled Evolution</strong>: Allows the API to evolve and improve over time without disrupting existing services.</li>
<li><strong>Clear Communication</strong>: Provides a clear way to communicate changes and updates to API consumers.</li>
</ol>
</div><h1>Versioning Strategies</h1>
<div class='content'><p>There are several strategies for versioning APIs, each with its own advantages and disadvantages. The most common methods are:</p>
<ol>
<li><strong>URI Versioning</strong></li>
<li><strong>Query Parameter Versioning</strong></li>
<li><strong>Header Versioning</strong></li>
<li><strong>Content Negotiation</strong></li>
</ol>
</div><h2>1. URI Versioning</h2>
<div class='content'><p>In URI versioning, the version number is included in the URL path. This is one of the most straightforward and commonly used methods.</p>
<p><strong>Example:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R0VUIC9hcGkvdjEvdXNlcnMKR0VUIC9hcGkvdjIvdXNlcnM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>GET /api/v1/users
GET /api/v2/users</pre></div><div class='content'><p><strong>Advantages:</strong></p>
<ul>
<li>Easy to implement and understand.</li>
<li>Clear and explicit versioning.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Can lead to URL clutter.</li>
<li>May require significant changes to routing logic.</li>
</ul>
</div><h2>2. Query Parameter Versioning</h2>
<div class='content'><p>In this method, the version number is passed as a query parameter in the URL.</p>
<p><strong>Example:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R0VUIC9hcGkvdXNlcnM/dmVyc2lvbj0xCkdFVCAvYXBpL3VzZXJzP3ZlcnNpb249Mg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>GET /api/users?version=1
GET /api/users?version=2</pre></div><div class='content'><p><strong>Advantages:</strong></p>
<ul>
<li>Keeps the URL structure clean.</li>
<li>Easy to implement.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Less visible and explicit compared to URI versioning.</li>
<li>Can be overlooked by developers and consumers.</li>
</ul>
</div><h2>3. Header Versioning</h2>
<div class='content'><p>With header versioning, the version number is included in the HTTP headers of the request.</p>
<p><strong>Example:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R0VUIC9hcGkvdXNlcnMKSGVhZGVyczogCiAgQWNjZXB0OiBhcHBsaWNhdGlvbi92bmQubXlhcGkudjEranNvbg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>GET /api/users
Headers: 
  Accept: application/vnd.myapi.v1+json</pre></div><div class='content'><p><strong>Advantages:</strong></p>
<ul>
<li>Keeps the URL clean.</li>
<li>Allows for more flexible versioning strategies.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Less visible and explicit.</li>
<li>Requires clients to set headers correctly.</li>
</ul>
</div><h2>4. Content Negotiation</h2>
<div class='content'><p>Content negotiation involves using the <code>Accept</code> header to specify the version of the API.</p>
<p><strong>Example:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R0VUIC9hcGkvdXNlcnMKSGVhZGVyczogCiAgQWNjZXB0OiBhcHBsaWNhdGlvbi92bmQubXlhcGkudjEranNvbg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>GET /api/users
Headers: 
  Accept: application/vnd.myapi.v1+json</pre></div><div class='content'><p><strong>Advantages:</strong></p>
<ul>
<li>Clean URL structure.</li>
<li>Flexible and powerful.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>More complex to implement.</li>
<li>Less visible and explicit.</li>
</ul>
</div><h1>Best Practices for API Versioning</h1>
<div class='content'><ol>
<li><strong>Start with Versioning</strong>: Always version your API from the beginning to avoid complications later.</li>
<li><strong>Communicate Changes Clearly</strong>: Document changes and updates clearly for API consumers.</li>
<li><strong>Deprecate Gradually</strong>: Provide a deprecation period for old versions to give consumers time to transition.</li>
<li><strong>Use Semantic Versioning</strong>: Follow semantic versioning principles (e.g., MAJOR.MINOR.PATCH) to communicate the nature of changes.</li>
</ol>
</div><h1>Practical Example</h1>
<div class='content'><p>Let's create a simple example using URI versioning with a Node.js and Express server.</p>
<p><strong>Step 1: Set Up the Project</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWtkaXIgYXBpLXZlcnNpb25pbmctZXhhbXBsZQpjZCBhcGktdmVyc2lvbmluZy1leGFtcGxlCm5wbSBpbml0IC15Cm5wbSBpbnN0YWxsIGV4cHJlc3M="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>mkdir api-versioning-example
cd api-versioning-example
npm init -y
npm install express</pre></div><div class='content'><p><strong>Step 2: Create the Server</strong></p>
<p>Create a file named <code>server.js</code> and add the following code:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgYXBwID0gZXhwcmVzcygpOwpjb25zdCBwb3J0ID0gMzAwMDsKCi8vIFZlcnNpb24gMSBvZiB0aGUgQVBJCmFwcC5nZXQoJy9hcGkvdjEvdXNlcnMnLCAocmVxLCByZXMpID0+IHsKICByZXMuanNvbih7IHZlcnNpb246ICd2MScsIHVzZXJzOiBbJ0FsaWNlJywgJ0JvYiddIH0pOwp9KTsKCi8vIFZlcnNpb24gMiBvZiB0aGUgQVBJCmFwcC5nZXQoJy9hcGkvdjIvdXNlcnMnLCAocmVxLCByZXMpID0+IHsKICByZXMuanNvbih7IHZlcnNpb246ICd2MicsIHVzZXJzOiBbJ0FsaWNlJywgJ0JvYicsICdDaGFybGllJ10gfSk7Cn0pOwoKYXBwLmxpc3Rlbihwb3J0LCAoKSA9PiB7CiAgY29uc29sZS5sb2coYEFQSSB2ZXJzaW9uaW5nIGV4YW1wbGUgYXBwIGxpc3RlbmluZyBhdCBodHRwOi8vbG9jYWxob3N0OiR7cG9ydH1gKTsKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const app = express();
const port = 3000;

// Version 1 of the API
app.get('/api/v1/users', (req, res) =&gt; {
  res.json({ version: 'v1', users: ['Alice', 'Bob'] });
});

// Version 2 of the API
app.get('/api/v2/users', (req, res) =&gt; {
  res.json({ version: 'v2', users: ['Alice', 'Bob', 'Charlie'] });
});

app.listen(port, () =&gt; {
  console.log(`API versioning example app listening at http://localhost:${port}`);
});</pre></div><div class='content'><p><strong>Step 3: Run the Server</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bm9kZSBzZXJ2ZXIuanM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>node server.js</pre></div><div class='content'><p><strong>Step 4: Test the API</strong></p>
<p>Use a tool like Postman or curl to test the endpoints:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y3VybCBodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL3YxL3VzZXJzCmN1cmwgaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS92Mi91c2Vycw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>curl http://localhost:3000/api/v1/users
curl http://localhost:3000/api/v2/users</pre></div><div class='content'></div><h1>Exercises</h1>
<div class='content'></div><h2>Exercise 1: Implement Query Parameter Versioning</h2>
<div class='content'><p>Modify the above example to use query parameter versioning instead of URI versioning.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgYXBwID0gZXhwcmVzcygpOwpjb25zdCBwb3J0ID0gMzAwMDsKCmFwcC5nZXQoJy9hcGkvdXNlcnMnLCAocmVxLCByZXMpID0+IHsKICBjb25zdCB2ZXJzaW9uID0gcmVxLnF1ZXJ5LnZlcnNpb247CiAgaWYgKHZlcnNpb24gPT09ICcxJykgewogICAgcmVzLmpzb24oeyB2ZXJzaW9uOiAndjEnLCB1c2VyczogWydBbGljZScsICdCb2InXSB9KTsKICB9IGVsc2UgaWYgKHZlcnNpb24gPT09ICcyJykgewogICAgcmVzLmpzb24oeyB2ZXJzaW9uOiAndjInLCB1c2VyczogWydBbGljZScsICdCb2InLCAnQ2hhcmxpZSddIH0pOwogIH0gZWxzZSB7CiAgICByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnSW52YWxpZCB2ZXJzaW9uJyB9KTsKICB9Cn0pOwoKYXBwLmxpc3Rlbihwb3J0LCAoKSA9PiB7CiAgY29uc29sZS5sb2coYEFQSSB2ZXJzaW9uaW5nIGV4YW1wbGUgYXBwIGxpc3RlbmluZyBhdCBodHRwOi8vbG9jYWxob3N0OiR7cG9ydH1gKTsKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const app = express();
const port = 3000;

app.get('/api/users', (req, res) =&gt; {
  const version = req.query.version;
  if (version === '1') {
    res.json({ version: 'v1', users: ['Alice', 'Bob'] });
  } else if (version === '2') {
    res.json({ version: 'v2', users: ['Alice', 'Bob', 'Charlie'] });
  } else {
    res.status(400).json({ error: 'Invalid version' });
  }
});

app.listen(port, () =&gt; {
  console.log(`API versioning example app listening at http://localhost:${port}`);
});</pre></div><div class='content'></div><h2>Exercise 2: Implement Header Versioning</h2>
<div class='content'><p>Modify the above example to use header versioning instead of URI or query parameter versioning.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgYXBwID0gZXhwcmVzcygpOwpjb25zdCBwb3J0ID0gMzAwMDsKCmFwcC5nZXQoJy9hcGkvdXNlcnMnLCAocmVxLCByZXMpID0+IHsKICBjb25zdCB2ZXJzaW9uID0gcmVxLmhlYWRlcnNbJ2FjY2VwdCddOwogIGlmICh2ZXJzaW9uID09PSAnYXBwbGljYXRpb24vdm5kLm15YXBpLnYxK2pzb24nKSB7CiAgICByZXMuanNvbih7IHZlcnNpb246ICd2MScsIHVzZXJzOiBbJ0FsaWNlJywgJ0JvYiddIH0pOwogIH0gZWxzZSBpZiAodmVyc2lvbiA9PT0gJ2FwcGxpY2F0aW9uL3ZuZC5teWFwaS52Mitqc29uJykgewogICAgcmVzLmpzb24oeyB2ZXJzaW9uOiAndjInLCB1c2VyczogWydBbGljZScsICdCb2InLCAnQ2hhcmxpZSddIH0pOwogIH0gZWxzZSB7CiAgICByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnSW52YWxpZCB2ZXJzaW9uJyB9KTsKICB9Cn0pOwoKYXBwLmxpc3Rlbihwb3J0LCAoKSA9PiB7CiAgY29uc29sZS5sb2coYEFQSSB2ZXJzaW9uaW5nIGV4YW1wbGUgYXBwIGxpc3RlbmluZyBhdCBodHRwOi8vbG9jYWxob3N0OiR7cG9ydH1gKTsKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const app = express();
const port = 3000;

app.get('/api/users', (req, res) =&gt; {
  const version = req.headers['accept'];
  if (version === 'application/vnd.myapi.v1+json') {
    res.json({ version: 'v1', users: ['Alice', 'Bob'] });
  } else if (version === 'application/vnd.myapi.v2+json') {
    res.json({ version: 'v2', users: ['Alice', 'Bob', 'Charlie'] });
  } else {
    res.status(400).json({ error: 'Invalid version' });
  }
});

app.listen(port, () =&gt; {
  console.log(`API versioning example app listening at http://localhost:${port}`);
});</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>API versioning is a fundamental practice in API design that ensures backward compatibility and smooth transitions for API consumers. By understanding and implementing different versioning strategies, you can maintain a robust and flexible API that can evolve over time without disrupting existing services.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-http-status-codes' title="HTTP Status Codes">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='02-06-api-documentation' title="API Documentation">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
