<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Series Forecasting Project</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/time-series-forecasting-project" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/time-series-forecasting-project" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/time-series-forecasting-project" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/tensorflow/time-series-forecasting-project" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/tensorflow/time-series-forecasting-project" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='natural-language-processing-project'>&#x25C4;Natural Language Processing Project</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Time Series Forecasting Project</a>
	</div>
	<div class='col-4 text-end'>
					<a href='custom-project'>Custom Project &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Time series forecasting is a crucial aspect of many real-world applications, such as stock market prediction, weather forecasting, and demand planning. In this section, we will explore how to use TensorFlow to build and train models for time series forecasting. This topic will guide you from the basics to advanced techniques, ensuring a comprehensive understanding of the subject.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Time Series Data</strong>: A sequence of data points collected or recorded at specific time intervals.</li>
<li><strong>Forecasting</strong>: The process of making predictions about future data points based on historical data.</li>
<li><strong>TensorFlow</strong>: An open-source machine learning framework developed by Google.</li>
</ul>
</div><h1>Setting Up the Environment</h1>
<div class='content'><p>Before we start, ensure you have TensorFlow installed. You can install it using pip:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgdGVuc29yZmxvdw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install tensorflow</pre></div><div class='content'></div><h1>Data Preparation</h1>
<h2>Loading the Dataset</h2>
<div class='content'><p>For this project, we will use a sample dataset containing daily temperature readings.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHBhbmRhcyBhcyBwZAoKIyBMb2FkIHRoZSBkYXRhc2V0CnVybCA9ICdodHRwczovL2V4YW1wbGUuY29tL2RhaWx5LXRlbXBlcmF0dXJlLmNzdicKZGF0YSA9IHBkLnJlYWRfY3N2KHVybCwgcGFyc2VfZGF0ZXM9WydkYXRlJ10sIGluZGV4X2NvbD0nZGF0ZScpCgojIERpc3BsYXkgdGhlIGZpcnN0IGZldyByb3dzCnByaW50KGRhdGEuaGVhZCgpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import pandas as pd

# Load the dataset
url = 'https://example.com/daily-temperature.csv'
data = pd.read_csv(url, parse_dates=['date'], index_col='date')

# Display the first few rows
print(data.head())</pre></div><div class='content'></div><h2>Data Preprocessing</h2>
<div class='content'><ul>
<li><strong>Normalization</strong>: Scale the data to a range suitable for neural networks.</li>
<li><strong>Train-Test Split</strong>: Divide the data into training and testing sets.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLnByZXByb2Nlc3NpbmcgaW1wb3J0IE1pbk1heFNjYWxlcgoKIyBOb3JtYWxpemUgdGhlIGRhdGEKc2NhbGVyID0gTWluTWF4U2NhbGVyKCkKZGF0YVsndGVtcGVyYXR1cmUnXSA9IHNjYWxlci5maXRfdHJhbnNmb3JtKGRhdGFbWyd0ZW1wZXJhdHVyZSddXSkKCiMgU3BsaXQgdGhlIGRhdGEKdHJhaW5fc2l6ZSA9IGludChsZW4oZGF0YSkgKiAwLjgpCnRyYWluX2RhdGEgPSBkYXRhWzp0cmFpbl9zaXplXQp0ZXN0X2RhdGEgPSBkYXRhW3RyYWluX3NpemU6XQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.preprocessing import MinMaxScaler

# Normalize the data
scaler = MinMaxScaler()
data['temperature'] = scaler.fit_transform(data[['temperature']])

# Split the data
train_size = int(len(data) * 0.8)
train_data = data[:train_size]
test_data = data[train_size:]</pre></div><div class='content'></div><h1>Building the Model</h1>
<h2>Creating the Time Series Dataset</h2>
<div class='content'><p>We need to create sequences of data for the model to learn from.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCgpkZWYgY3JlYXRlX2RhdGFzZXQoZGF0YSwgdGltZV9zdGVwPTEpOgogICAgWCwgeSA9IFtdLCBbXQogICAgZm9yIGkgaW4gcmFuZ2UobGVuKGRhdGEpIC0gdGltZV9zdGVwIC0gMSk6CiAgICAgICAgWC5hcHBlbmQoZGF0YVtpOihpICsgdGltZV9zdGVwKSwgMF0pCiAgICAgICAgeS5hcHBlbmQoZGF0YVtpICsgdGltZV9zdGVwLCAwXSkKICAgIHJldHVybiBucC5hcnJheShYKSwgbnAuYXJyYXkoeSkKCnRpbWVfc3RlcCA9IDEwClhfdHJhaW4sIHlfdHJhaW4gPSBjcmVhdGVfZGF0YXNldCh0cmFpbl9kYXRhLnZhbHVlcywgdGltZV9zdGVwKQpYX3Rlc3QsIHlfdGVzdCA9IGNyZWF0ZV9kYXRhc2V0KHRlc3RfZGF0YS52YWx1ZXMsIHRpbWVfc3RlcCkKCiMgUmVzaGFwZSBpbnB1dCB0byBiZSBbc2FtcGxlcywgdGltZSBzdGVwcywgZmVhdHVyZXNdClhfdHJhaW4gPSBYX3RyYWluLnJlc2hhcGUoWF90cmFpbi5zaGFwZVswXSwgdGltZV9zdGVwLCAxKQpYX3Rlc3QgPSBYX3Rlc3QucmVzaGFwZShYX3Rlc3Quc2hhcGVbMF0sIHRpbWVfc3RlcCwgMSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np

def create_dataset(data, time_step=1):
    X, y = [], []
    for i in range(len(data) - time_step - 1):
        X.append(data[i:(i + time_step), 0])
        y.append(data[i + time_step, 0])
    return np.array(X), np.array(y)

time_step = 10
X_train, y_train = create_dataset(train_data.values, time_step)
X_test, y_test = create_dataset(test_data.values, time_step)

# Reshape input to be [samples, time steps, features]
X_train = X_train.reshape(X_train.shape[0], time_step, 1)
X_test = X_test.reshape(X_test.shape[0], time_step, 1)</pre></div><div class='content'></div><h2>Defining the Model</h2>
<div class='content'><p>We will use a simple LSTM (Long Short-Term Memory) network for this task.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLm1vZGVscyBpbXBvcnQgU2VxdWVudGlhbApmcm9tIHRlbnNvcmZsb3cua2VyYXMubGF5ZXJzIGltcG9ydCBMU1RNLCBEZW5zZQoKbW9kZWwgPSBTZXF1ZW50aWFsKCkKbW9kZWwuYWRkKExTVE0oNTAsIHJldHVybl9zZXF1ZW5jZXM9VHJ1ZSwgaW5wdXRfc2hhcGU9KHRpbWVfc3RlcCwgMSkpKQptb2RlbC5hZGQoTFNUTSg1MCwgcmV0dXJuX3NlcXVlbmNlcz1GYWxzZSkpCm1vZGVsLmFkZChEZW5zZSgxKSkKbW9kZWwuY29tcGlsZShvcHRpbWl6ZXI9J2FkYW0nLCBsb3NzPSdtZWFuX3NxdWFyZWRfZXJyb3InKQoKbW9kZWwuc3VtbWFyeSgp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import LSTM, Dense

model = Sequential()
model.add(LSTM(50, return_sequences=True, input_shape=(time_step, 1)))
model.add(LSTM(50, return_sequences=False))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mean_squared_error')

model.summary()</pre></div><div class='content'></div><h2>Training the Model</h2>
<div class='content'><p>Train the model using the training data.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aGlzdG9yeSA9IG1vZGVsLmZpdChYX3RyYWluLCB5X3RyYWluLCB2YWxpZGF0aW9uX2RhdGE9KFhfdGVzdCwgeV90ZXN0KSwgZXBvY2hzPTUwLCBiYXRjaF9zaXplPTMyLCB2ZXJib3NlPTEp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>history = model.fit(X_train, y_train, validation_data=(X_test, y_test), epochs=50, batch_size=32, verbose=1)</pre></div><div class='content'></div><h1>Model Evaluation</h1>
<h2>Visualizing the Loss</h2>
<div class='content'><p>Plot the training and validation loss to check for overfitting.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG1hdHBsb3RsaWIucHlwbG90IGFzIHBsdAoKcGx0LnBsb3QoaGlzdG9yeS5oaXN0b3J5Wydsb3NzJ10sIGxhYmVsPSdUcmFpbiBMb3NzJykKcGx0LnBsb3QoaGlzdG9yeS5oaXN0b3J5Wyd2YWxfbG9zcyddLCBsYWJlbD0nVmFsaWRhdGlvbiBMb3NzJykKcGx0LmxlZ2VuZCgpCnBsdC5zaG93KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import matplotlib.pyplot as plt

plt.plot(history.history['loss'], label='Train Loss')
plt.plot(history.history['val_loss'], label='Validation Loss')
plt.legend()
plt.show()</pre></div><div class='content'></div><h2>Making Predictions</h2>
<div class='content'><p>Use the trained model to make predictions on the test data.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJhaW5fcHJlZGljdCA9IG1vZGVsLnByZWRpY3QoWF90cmFpbikKdGVzdF9wcmVkaWN0ID0gbW9kZWwucHJlZGljdChYX3Rlc3QpCgojIEludmVyc2UgdHJhbnNmb3JtIHRvIGdldCBhY3R1YWwgdmFsdWVzCnRyYWluX3ByZWRpY3QgPSBzY2FsZXIuaW52ZXJzZV90cmFuc2Zvcm0odHJhaW5fcHJlZGljdCkKdGVzdF9wcmVkaWN0ID0gc2NhbGVyLmludmVyc2VfdHJhbnNmb3JtKHRlc3RfcHJlZGljdCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>train_predict = model.predict(X_train)
test_predict = model.predict(X_test)

# Inverse transform to get actual values
train_predict = scaler.inverse_transform(train_predict)
test_predict = scaler.inverse_transform(test_predict)</pre></div><div class='content'></div><h2>Plotting the Results</h2>
<div class='content'><p>Compare the predicted values with the actual values.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTaGlmdCB0cmFpbiBwcmVkaWN0aW9ucyBmb3IgcGxvdHRpbmcKdHJhaW5fcHJlZGljdF9wbG90ID0gbnAuZW1wdHlfbGlrZShkYXRhLnZhbHVlcykKdHJhaW5fcHJlZGljdF9wbG90WzosIDpdID0gbnAubmFuCnRyYWluX3ByZWRpY3RfcGxvdFt0aW1lX3N0ZXA6bGVuKHRyYWluX3ByZWRpY3QpICsgdGltZV9zdGVwLCA6XSA9IHRyYWluX3ByZWRpY3QKCiMgU2hpZnQgdGVzdCBwcmVkaWN0aW9ucyBmb3IgcGxvdHRpbmcKdGVzdF9wcmVkaWN0X3Bsb3QgPSBucC5lbXB0eV9saWtlKGRhdGEudmFsdWVzKQp0ZXN0X3ByZWRpY3RfcGxvdFs6LCA6XSA9IG5wLm5hbgp0ZXN0X3ByZWRpY3RfcGxvdFtsZW4odHJhaW5fcHJlZGljdCkgKyAodGltZV9zdGVwICogMikgKyAxOmxlbihkYXRhKSAtIDEsIDpdID0gdGVzdF9wcmVkaWN0CgojIFBsb3QgYmFzZWxpbmUgYW5kIHByZWRpY3Rpb25zCnBsdC5wbG90KHNjYWxlci5pbnZlcnNlX3RyYW5zZm9ybShkYXRhLnZhbHVlcyksIGxhYmVsPSdBY3R1YWwgRGF0YScpCnBsdC5wbG90KHRyYWluX3ByZWRpY3RfcGxvdCwgbGFiZWw9J1RyYWluIFByZWRpY3Rpb24nKQpwbHQucGxvdCh0ZXN0X3ByZWRpY3RfcGxvdCwgbGFiZWw9J1Rlc3QgUHJlZGljdGlvbicpCnBsdC5sZWdlbmQoKQpwbHQuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Shift train predictions for plotting
train_predict_plot = np.empty_like(data.values)
train_predict_plot[:, :] = np.nan
train_predict_plot[time_step:len(train_predict) + time_step, :] = train_predict

# Shift test predictions for plotting
test_predict_plot = np.empty_like(data.values)
test_predict_plot[:, :] = np.nan
test_predict_plot[len(train_predict) + (time_step * 2) + 1:len(data) - 1, :] = test_predict

# Plot baseline and predictions
plt.plot(scaler.inverse_transform(data.values), label='Actual Data')
plt.plot(train_predict_plot, label='Train Prediction')
plt.plot(test_predict_plot, label='Test Prediction')
plt.legend()
plt.show()</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this topic, we covered the essentials of time series forecasting using TensorFlow. We started with data preparation, moved on to building and training an LSTM model, and finally evaluated the model's performance. By following these steps, you should now have a solid foundation for tackling more complex time series forecasting projects.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='natural-language-processing-project'>&#x25C4;Natural Language Processing Project</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Time Series Forecasting Project</a>
	</div>
	<div class='col-4 text-end'>
					<a href='custom-project'>Custom Project &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
