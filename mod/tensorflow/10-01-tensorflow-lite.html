<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>TensorFlow Lite</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/10-01-tensorflow-lite" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/10-01-tensorflow-lite" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/10-01-tensorflow-lite" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=3" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/tensorflow/10-01-tensorflow-lite" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/tensorflow/10-01-tensorflow-lite" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>Building today's and tomorrow's society</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Languages</a>
				 					<a href="/categ/frameworks">Frameworks</a>
				 					<a href="/categ/tech-tools">Tools</a>
				 					<a href="/categ/foundations">Foundations</a>
				 					<a href="/categ/soft-skills">Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='09-04-model-analysis' title="Model Analysis">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">TensorFlow Lite</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='10-02-tensorflow-js' title="TensorFlow.js">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1><p>Introduction to TensorFlow Lite</p>
</h1>
<div class='content'><p>TensorFlow Lite is a lightweight version of TensorFlow designed for mobile and embedded devices. It enables on-device machine learning inference with low latency and a small binary size, making it ideal for applications on smartphones, IoT devices, and other edge devices.</p>
</div><h2><p>Key Concepts</p>
</h2>
<div class='content'><ol>
<li><strong>Model Conversion</strong>: Converting a TensorFlow model to TensorFlow Lite format.</li>
<li><strong>Interpreter</strong>: Running the TensorFlow Lite model on a device.</li>
<li><strong>Optimization</strong>: Techniques to reduce model size and improve performance.</li>
<li><strong>Deployment</strong>: Integrating TensorFlow Lite models into mobile and embedded applications.</li>
</ol>
</div><h1><p>Setting Up TensorFlow Lite</p>
</h1>
<div class='content'></div><h2><p>Installation</p>
</h2>
<div class='content'><p>To use TensorFlow Lite, you need to install the TensorFlow Lite package. You can do this using pip:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgdGVuc29yZmxvdw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install tensorflow</pre></div><div class='content'><p>For mobile development, you will also need the TensorFlow Lite libraries for Android or iOS.</p>
</div><h2><p>Converting a TensorFlow Model to TensorFlow Lite</p>
</h2>
<div class='content'><p>To convert a TensorFlow model to TensorFlow Lite, you use the TensorFlow Lite Converter. Here is a basic example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgTG9hZCB0aGUgVGVuc29yRmxvdyBtb2RlbAptb2RlbCA9IHRmLmtlcmFzLm1vZGVscy5sb2FkX21vZGVsKCdwYXRoL3RvL3lvdXIvbW9kZWwuaDUnKQoKIyBDb252ZXJ0IHRoZSBtb2RlbCB0byBUZW5zb3JGbG93IExpdGUgZm9ybWF0CmNvbnZlcnRlciA9IHRmLmxpdGUuVEZMaXRlQ29udmVydGVyLmZyb21fa2VyYXNfbW9kZWwobW9kZWwpCnRmbGl0ZV9tb2RlbCA9IGNvbnZlcnRlci5jb252ZXJ0KCkKCiMgU2F2ZSB0aGUgY29udmVydGVkIG1vZGVsCndpdGggb3BlbignbW9kZWwudGZsaXRlJywgJ3diJykgYXMgZjoKICAgIGYud3JpdGUodGZsaXRlX21vZGVsKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Load the TensorFlow model
model = tf.keras.models.load_model('path/to/your/model.h5')

# Convert the model to TensorFlow Lite format
converter = tf.lite.TFLiteConverter.from_keras_model(model)
tflite_model = converter.convert()

# Save the converted model
with open('model.tflite', 'wb') as f:
    f.write(tflite_model)</pre></div><div class='content'></div><h2><p>Practical Example: Converting a Simple Model</p>
</h2>
<div class='content'><p>Let's convert a simple Keras model to TensorFlow Lite:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLm1vZGVscyBpbXBvcnQgU2VxdWVudGlhbApmcm9tIHRlbnNvcmZsb3cua2VyYXMubGF5ZXJzIGltcG9ydCBEZW5zZQoKIyBEZWZpbmUgYSBzaW1wbGUgbW9kZWwKbW9kZWwgPSBTZXF1ZW50aWFsKFsKICAgIERlbnNlKDEwLCBhY3RpdmF0aW9uPSdyZWx1JywgaW5wdXRfc2hhcGU9KDQsKSksCiAgICBEZW5zZSgxLCBhY3RpdmF0aW9uPSdzaWdtb2lkJykKXSkKCiMgQ29tcGlsZSB0aGUgbW9kZWwKbW9kZWwuY29tcGlsZShvcHRpbWl6ZXI9J2FkYW0nLCBsb3NzPSdiaW5hcnlfY3Jvc3NlbnRyb3B5JywgbWV0cmljcz1bJ2FjY3VyYWN5J10pCgojIFNhdmUgdGhlIG1vZGVsCm1vZGVsLnNhdmUoJ3NpbXBsZV9tb2RlbC5oNScpCgojIENvbnZlcnQgdGhlIG1vZGVsIHRvIFRlbnNvckZsb3cgTGl0ZSBmb3JtYXQKY29udmVydGVyID0gdGYubGl0ZS5URkxpdGVDb252ZXJ0ZXIuZnJvbV9rZXJhc19tb2RlbChtb2RlbCkKdGZsaXRlX21vZGVsID0gY29udmVydGVyLmNvbnZlcnQoKQoKIyBTYXZlIHRoZSBjb252ZXJ0ZWQgbW9kZWwKd2l0aCBvcGVuKCdzaW1wbGVfbW9kZWwudGZsaXRlJywgJ3diJykgYXMgZjoKICAgIGYud3JpdGUodGZsaXRlX21vZGVsKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense

# Define a simple model
model = Sequential([
    Dense(10, activation='relu', input_shape=(4,)),
    Dense(1, activation='sigmoid')
])

# Compile the model
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

# Save the model
model.save('simple_model.h5')

# Convert the model to TensorFlow Lite format
converter = tf.lite.TFLiteConverter.from_keras_model(model)
tflite_model = converter.convert()

# Save the converted model
with open('simple_model.tflite', 'wb') as f:
    f.write(tflite_model)</pre></div><div class='content'></div><h1><p>Running TensorFlow Lite Models</p>
</h1>
<div class='content'><p>To run a TensorFlow Lite model, you use the TensorFlow Lite Interpreter. Here is an example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCB0ZW5zb3JmbG93IGFzIHRmCgojIExvYWQgdGhlIFRlbnNvckZsb3cgTGl0ZSBtb2RlbAppbnRlcnByZXRlciA9IHRmLmxpdGUuSW50ZXJwcmV0ZXIobW9kZWxfcGF0aD0nc2ltcGxlX21vZGVsLnRmbGl0ZScpCmludGVycHJldGVyLmFsbG9jYXRlX3RlbnNvcnMoKQoKIyBHZXQgaW5wdXQgYW5kIG91dHB1dCB0ZW5zb3JzCmlucHV0X2RldGFpbHMgPSBpbnRlcnByZXRlci5nZXRfaW5wdXRfZGV0YWlscygpCm91dHB1dF9kZXRhaWxzID0gaW50ZXJwcmV0ZXIuZ2V0X291dHB1dF9kZXRhaWxzKCkKCiMgUHJlcGFyZSBpbnB1dCBkYXRhCmlucHV0X2RhdGEgPSBucC5hcnJheShbWzEuMCwgMi4wLCAzLjAsIDQuMF1dLCBkdHlwZT1ucC5mbG9hdDMyKQoKIyBTZXQgdGhlIGlucHV0IHRlbnNvcgppbnRlcnByZXRlci5zZXRfdGVuc29yKGlucHV0X2RldGFpbHNbMF1bJ2luZGV4J10sIGlucHV0X2RhdGEpCgojIFJ1biB0aGUgbW9kZWwKaW50ZXJwcmV0ZXIuaW52b2tlKCkKCiMgR2V0IHRoZSBvdXRwdXQgdGVuc29yCm91dHB1dF9kYXRhID0gaW50ZXJwcmV0ZXIuZ2V0X3RlbnNvcihvdXRwdXRfZGV0YWlsc1swXVsnaW5kZXgnXSkKcHJpbnQob3V0cHV0X2RhdGEp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np
import tensorflow as tf

# Load the TensorFlow Lite model
interpreter = tf.lite.Interpreter(model_path='simple_model.tflite')
interpreter.allocate_tensors()

# Get input and output tensors
input_details = interpreter.get_input_details()
output_details = interpreter.get_output_details()

# Prepare input data
input_data = np.array([[1.0, 2.0, 3.0, 4.0]], dtype=np.float32)

# Set the input tensor
interpreter.set_tensor(input_details[0]['index'], input_data)

# Run the model
interpreter.invoke()

# Get the output tensor
output_data = interpreter.get_tensor(output_details[0]['index'])
print(output_data)</pre></div><div class='content'></div><h1><p>Optimization Techniques</p>
</h1>
<div class='content'></div><h2><p>Quantization</p>
</h2>
<div class='content'><p>Quantization reduces the model size and improves inference speed by converting 32-bit floating-point numbers to 8-bit integers. Here is how you can apply quantization during conversion:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29udmVydGVyID0gdGYubGl0ZS5URkxpdGVDb252ZXJ0ZXIuZnJvbV9rZXJhc19tb2RlbChtb2RlbCkKY29udmVydGVyLm9wdGltaXphdGlvbnMgPSBbdGYubGl0ZS5PcHRpbWl6ZS5ERUZBVUxUXQp0ZmxpdGVfbW9kZWwgPSBjb252ZXJ0ZXIuY29udmVydCgpCgp3aXRoIG9wZW4oJ3F1YW50aXplZF9tb2RlbC50ZmxpdGUnLCAnd2InKSBhcyBmOgogICAgZi53cml0ZSh0ZmxpdGVfbW9kZWwp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>converter = tf.lite.TFLiteConverter.from_keras_model(model)
converter.optimizations = [tf.lite.Optimize.DEFAULT]
tflite_model = converter.convert()

with open('quantized_model.tflite', 'wb') as f:
    f.write(tflite_model)</pre></div><div class='content'></div><h2><p>Pruning</p>
</h2>
<div class='content'><p>Pruning removes weights that are close to zero, reducing the model size. TensorFlow Model Optimization Toolkit provides tools for pruning.</p>
</div><h2><p>Practical Exercise</p>
</h2>
<div class='content'><p><strong>Exercise</strong>: Convert a pre-trained TensorFlow model to TensorFlow Lite and run inference on a sample input.</p>
<ol>
<li>Load a pre-trained TensorFlow model (e.g., MobileNetV2).</li>
<li>Convert the model to TensorFlow Lite format.</li>
<li>Run inference on a sample input using the TensorFlow Lite Interpreter.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKaW1wb3J0IG51bXB5IGFzIG5wCgojIExvYWQgYSBwcmUtdHJhaW5lZCBtb2RlbAptb2RlbCA9IHRmLmtlcmFzLmFwcGxpY2F0aW9ucy5Nb2JpbGVOZXRWMih3ZWlnaHRzPSdpbWFnZW5ldCcsIGlucHV0X3NoYXBlPSgyMjQsIDIyNCwgMykpCgojIENvbnZlcnQgdGhlIG1vZGVsIHRvIFRlbnNvckZsb3cgTGl0ZSBmb3JtYXQKY29udmVydGVyID0gdGYubGl0ZS5URkxpdGVDb252ZXJ0ZXIuZnJvbV9rZXJhc19tb2RlbChtb2RlbCkKdGZsaXRlX21vZGVsID0gY29udmVydGVyLmNvbnZlcnQoKQoKIyBTYXZlIHRoZSBjb252ZXJ0ZWQgbW9kZWwKd2l0aCBvcGVuKCdtb2JpbGVuZXRfdjIudGZsaXRlJywgJ3diJykgYXMgZjoKICAgIGYud3JpdGUodGZsaXRlX21vZGVsKQoKIyBMb2FkIHRoZSBUZW5zb3JGbG93IExpdGUgbW9kZWwKaW50ZXJwcmV0ZXIgPSB0Zi5saXRlLkludGVycHJldGVyKG1vZGVsX3BhdGg9J21vYmlsZW5ldF92Mi50ZmxpdGUnKQppbnRlcnByZXRlci5hbGxvY2F0ZV90ZW5zb3JzKCkKCiMgR2V0IGlucHV0IGFuZCBvdXRwdXQgdGVuc29ycwppbnB1dF9kZXRhaWxzID0gaW50ZXJwcmV0ZXIuZ2V0X2lucHV0X2RldGFpbHMoKQpvdXRwdXRfZGV0YWlscyA9IGludGVycHJldGVyLmdldF9vdXRwdXRfZGV0YWlscygpCgojIFByZXBhcmUgaW5wdXQgZGF0YQppbnB1dF9kYXRhID0gbnAucmFuZG9tLnJhbmQoMSwgMjI0LCAyMjQsIDMpLmFzdHlwZShucC5mbG9hdDMyKQoKIyBTZXQgdGhlIGlucHV0IHRlbnNvcgppbnRlcnByZXRlci5zZXRfdGVuc29yKGlucHV0X2RldGFpbHNbMF1bJ2luZGV4J10sIGlucHV0X2RhdGEpCgojIFJ1biB0aGUgbW9kZWwKaW50ZXJwcmV0ZXIuaW52b2tlKCkKCiMgR2V0IHRoZSBvdXRwdXQgdGVuc29yCm91dHB1dF9kYXRhID0gaW50ZXJwcmV0ZXIuZ2V0X3RlbnNvcihvdXRwdXRfZGV0YWlsc1swXVsnaW5kZXgnXSkKcHJpbnQob3V0cHV0X2RhdGEp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
import numpy as np

# Load a pre-trained model
model = tf.keras.applications.MobileNetV2(weights='imagenet', input_shape=(224, 224, 3))

# Convert the model to TensorFlow Lite format
converter = tf.lite.TFLiteConverter.from_keras_model(model)
tflite_model = converter.convert()

# Save the converted model
with open('mobilenet_v2.tflite', 'wb') as f:
    f.write(tflite_model)

# Load the TensorFlow Lite model
interpreter = tf.lite.Interpreter(model_path='mobilenet_v2.tflite')
interpreter.allocate_tensors()

# Get input and output tensors
input_details = interpreter.get_input_details()
output_details = interpreter.get_output_details()

# Prepare input data
input_data = np.random.rand(1, 224, 224, 3).astype(np.float32)

# Set the input tensor
interpreter.set_tensor(input_details[0]['index'], input_data)

# Run the model
interpreter.invoke()

# Get the output tensor
output_data = interpreter.get_tensor(output_details[0]['index'])
print(output_data)</pre></div><div class='content'></div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, you learned about TensorFlow Lite, how to convert TensorFlow models to TensorFlow Lite format, and how to run these models on mobile and embedded devices. You also explored optimization techniques like quantization to improve model performance. This knowledge is crucial for deploying machine learning models in resource-constrained environments, enabling real-time inference on edge devices.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='09-04-model-analysis' title="Model Analysis">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='10-02-tensorflow-js' title="TensorFlow.js">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
