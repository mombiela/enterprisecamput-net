<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>TensorFlow Federated</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/10-03-tensorflow-federated" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/10-03-tensorflow-federated" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/10-03-tensorflow-federated" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>var DEVELOP = window.location.href.indexOf("localhost")!=-1 && true;</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/tensorflow/10-03-tensorflow-federated" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/tensorflow/10-03-tensorflow-federated" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>
		<!-- <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

			</div>
		</div>
	</div>
</div>
 -->
 
<div class="top-bar container-fluid">
	<div class="container-xxl">
		<nav class="navbar navbar-expand-md p-0">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<div class="navbar-nav me-auto">
							<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

					</div>
				</div>			
							</div>
		</nav>
	</div>
</div>				<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='10-02-tensorflow-js' title="TensorFlow.js">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<h2 style="text-decoration:underline">TensorFlow Federated</h2>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='10-04-tensorflow-quantum' title="TensorFlow Quantum">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to TensorFlow Federated</h1>
<div class='content'><p>TensorFlow Federated (TFF) is an open-source framework for machine learning and other computations on decentralized data. It enables developers to simulate and implement federated learning algorithms, which allow models to be trained across multiple devices or servers holding local data samples, without exchanging them.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ol>
<li><strong>Federated Learning</strong>: A machine learning setting where the goal is to train a high-quality centralized model while keeping all the training data decentralized.</li>
<li><strong>Federated Computation</strong>: Computations that are distributed across multiple devices or servers.</li>
<li><strong>Federated Data</strong>: Data that is distributed across multiple devices or servers, often in a non-IID (Independent and Identically Distributed) manner.</li>
</ol>
</div><h1>Setting Up TensorFlow Federated</h1>
<div class='content'><p>To get started with TensorFlow Federated, you need to install the TFF package. You can do this using pip:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgdGVuc29yZmxvdy1mZWRlcmF0ZWQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install tensorflow-federated</pre></div><div class='content'></div><h1>Basic TensorFlow Federated Concepts</h1>
<div class='content'></div><h2>Federated Learning Process</h2>
<div class='content'><ol>
<li><strong>Initialization</strong>: Initialize the global model.</li>
<li><strong>Client Update</strong>: Each client computes an update to the model using its local data.</li>
<li><strong>Aggregation</strong>: The server aggregates the updates from all clients.</li>
<li><strong>Model Update</strong>: The server updates the global model based on the aggregated updates.</li>
<li><strong>Iteration</strong>: Repeat the process for a number of rounds.</li>
</ol>
</div><h2>Example: Federated Averaging</h2>
<div class='content'><p>Federated Averaging is a common algorithm used in federated learning. It involves averaging the model updates from multiple clients to update the global model.</p>
</div><h1>Practical Example: Federated Averaging</h1>
<div class='content'></div><h2>Step 1: Import Libraries</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKaW1wb3J0IHRlbnNvcmZsb3dfZmVkZXJhdGVkIGFzIHRmZg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
import tensorflow_federated as tff</pre></div><div class='content'></div><h2>Step 2: Define the Model</h2>
<div class='content'><p>Define a simple model using Keras:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIGNyZWF0ZV9rZXJhc19tb2RlbCgpOgogICAgcmV0dXJuIHRmLmtlcmFzLm1vZGVscy5TZXF1ZW50aWFsKFsKICAgICAgICB0Zi5rZXJhcy5sYXllcnMuSW5wdXRMYXllcihpbnB1dF9zaGFwZT0oNzg0LCkpLAogICAgICAgIHRmLmtlcmFzLmxheWVycy5EZW5zZSgxMCwgYWN0aXZhdGlvbj0nc29mdG1heCcpCiAgICBdKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def create_keras_model():
    return tf.keras.models.Sequential([
        tf.keras.layers.InputLayer(input_shape=(784,)),
        tf.keras.layers.Dense(10, activation='softmax')
    ])</pre></div><div class='content'></div><h2>Step 3: Convert Keras Model to TFF Model</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIG1vZGVsX2ZuKCk6CiAgICBrZXJhc19tb2RlbCA9IGNyZWF0ZV9rZXJhc19tb2RlbCgpCiAgICByZXR1cm4gdGZmLmxlYXJuaW5nLmZyb21fa2VyYXNfbW9kZWwoCiAgICAgICAga2VyYXNfbW9kZWwsCiAgICAgICAgaW5wdXRfc3BlYz0oCiAgICAgICAgICAgIHRmLlRlbnNvclNwZWMoc2hhcGU9W05vbmUsIDc4NF0sIGR0eXBlPXRmLmZsb2F0MzIpLAogICAgICAgICAgICB0Zi5UZW5zb3JTcGVjKHNoYXBlPVtOb25lLCAxMF0sIGR0eXBlPXRmLmZsb2F0MzIpCiAgICAgICAgKSwKICAgICAgICBsb3NzPXRmLmtlcmFzLmxvc3Nlcy5TcGFyc2VDYXRlZ29yaWNhbENyb3NzZW50cm9weSgpLAogICAgICAgIG1ldHJpY3M9W3RmLmtlcmFzLm1ldHJpY3MuU3BhcnNlQ2F0ZWdvcmljYWxBY2N1cmFjeSgpXQogICAgKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def model_fn():
    keras_model = create_keras_model()
    return tff.learning.from_keras_model(
        keras_model,
        input_spec=(
            tf.TensorSpec(shape=[None, 784], dtype=tf.float32),
            tf.TensorSpec(shape=[None, 10], dtype=tf.float32)
        ),
        loss=tf.keras.losses.SparseCategoricalCrossentropy(),
        metrics=[tf.keras.metrics.SparseCategoricalAccuracy()]
    )</pre></div><div class='content'></div><h2>Step 4: Load and Preprocess Data</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIHByZXByb2Nlc3MoZGF0YXNldCk6CiAgICBkZWYgYmF0Y2hfZm9ybWF0X2ZuKGVsZW1lbnQpOgogICAgICAgIHJldHVybiAodGYucmVzaGFwZShlbGVtZW50WydwaXhlbHMnXSwgWy0xLCA3ODRdKSwgZWxlbWVudFsnbGFiZWwnXSkKICAgIHJldHVybiBkYXRhc2V0LnJlcGVhdCgpLnNodWZmbGUoMTAwKS5iYXRjaCgyMCkubWFwKGJhdGNoX2Zvcm1hdF9mbikucHJlZmV0Y2goMTApCgplbW5pc3RfdHJhaW4sIGVtbmlzdF90ZXN0ID0gdGZmLnNpbXVsYXRpb24uZGF0YXNldHMuZW1uaXN0LmxvYWRfZGF0YSgpCmNsaWVudF9kYXRhID0gZW1uaXN0X3RyYWluLmNyZWF0ZV90Zl9kYXRhc2V0X2Zvcl9jbGllbnQoZW1uaXN0X3RyYWluLmNsaWVudF9pZHNbMF0pCnByZXByb2Nlc3NlZF9kYXRhID0gcHJlcHJvY2VzcyhjbGllbnRfZGF0YSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def preprocess(dataset):
    def batch_format_fn(element):
        return (tf.reshape(element['pixels'], [-1, 784]), element['label'])
    return dataset.repeat().shuffle(100).batch(20).map(batch_format_fn).prefetch(10)

emnist_train, emnist_test = tff.simulation.datasets.emnist.load_data()
client_data = emnist_train.create_tf_dataset_for_client(emnist_train.client_ids[0])
preprocessed_data = preprocess(client_data)</pre></div><div class='content'></div><h2>Step 5: Federated Data</h2>
<div class='content'><p>Create federated data by sampling from multiple clients:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIG1ha2VfZmVkZXJhdGVkX2RhdGEoY2xpZW50X2RhdGEsIGNsaWVudF9pZHMpOgogICAgcmV0dXJuIFtwcmVwcm9jZXNzKGNsaWVudF9kYXRhLmNyZWF0ZV90Zl9kYXRhc2V0X2Zvcl9jbGllbnQoeCkpIGZvciB4IGluIGNsaWVudF9pZHNdCgpmZWRlcmF0ZWRfdHJhaW5fZGF0YSA9IG1ha2VfZmVkZXJhdGVkX2RhdGEoZW1uaXN0X3RyYWluLCBlbW5pc3RfdHJhaW4uY2xpZW50X2lkc1s6MTBdKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def make_federated_data(client_data, client_ids):
    return [preprocess(client_data.create_tf_dataset_for_client(x)) for x in client_ids]

federated_train_data = make_federated_data(emnist_train, emnist_train.client_ids[:10])</pre></div><div class='content'></div><h2>Step 6: Federated Averaging Process</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aXRlcmF0aXZlX3Byb2Nlc3MgPSB0ZmYubGVhcm5pbmcuYnVpbGRfZmVkZXJhdGVkX2F2ZXJhZ2luZ19wcm9jZXNzKG1vZGVsX2ZuKQpzdGF0ZSA9IGl0ZXJhdGl2ZV9wcm9jZXNzLmluaXRpYWxpemUoKQoKZm9yIHJvdW5kX251bSBpbiByYW5nZSgxLCAxMSk6CiAgICBzdGF0ZSwgbWV0cmljcyA9IGl0ZXJhdGl2ZV9wcm9jZXNzLm5leHQoc3RhdGUsIGZlZGVyYXRlZF90cmFpbl9kYXRhKQogICAgcHJpbnQoZidSb3VuZCB7cm91bmRfbnVtfSwgTWV0cmljcz17bWV0cmljc30nKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>iterative_process = tff.learning.build_federated_averaging_process(model_fn)
state = iterative_process.initialize()

for round_num in range(1, 11):
    state, metrics = iterative_process.next(state, federated_train_data)
    print(f'Round {round_num}, Metrics={metrics}')</pre></div><div class='content'></div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Implement Federated Learning for a Custom Dataset</h2>
<div class='content'><ol>
<li><strong>Dataset</strong>: Use a custom dataset of your choice.</li>
<li><strong>Model</strong>: Define a simple neural network model.</li>
<li><strong>Federated Data</strong>: Create federated data from your dataset.</li>
<li><strong>Federated Averaging</strong>: Implement the federated averaging process.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><ol>
<li><strong>Dataset</strong>: Load your custom dataset.</li>
<li><strong>Model</strong>: Define the model using Keras.</li>
<li><strong>Federated Data</strong>: Preprocess and create federated data.</li>
<li><strong>Federated Averaging</strong>: Implement the federated averaging process similar to the example above.</li>
</ol>
</div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Data Preprocessing</strong>: Ensure that data preprocessing is consistent across all clients.</li>
<li><strong>Model Compatibility</strong>: Ensure that the model is compatible with TFF by using <code>tff.learning.from_keras_model</code>.</li>
<li><strong>Client Sampling</strong>: Properly sample clients to ensure a representative federated dataset.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we introduced TensorFlow Federated and explored its key concepts. We walked through a practical example of implementing federated averaging using a simple neural network model. By understanding these basics, you are now equipped to explore more advanced federated learning techniques and apply them to your own datasets.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='10-02-tensorflow-js' title="TensorFlow.js">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='10-04-tensorflow-quantum' title="TensorFlow Quantum">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
	     crossorigin="anonymous"></script>
	<!-- enterprise_campus -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-0611338592562725"
	     data-ad-slot="6914733106"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
	     (adsbygoogle = window.adsbygoogle || []).push({});
	</script>
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>TensorFlow Course</h1>
<h2>Module 1: Introduction to TensorFlow</h2>
<ul>
<li><a href="01-01-what-is-tensorflow">What is TensorFlow?</a></li>
<li><a href="01-02-setting-up-tensorflow">Setting Up TensorFlow</a></li>
<li><a href="01-03-basic-tensorflow-concepts">Basic TensorFlow Concepts</a></li>
<li><a href="01-04-tensorflow-hello-world">TensorFlow Hello World</a></li>
</ul>
<h2>Module 2: TensorFlow Basics</h2>
<ul>
<li><a href="02-01-tensors-and-operations">Tensors and Operations</a></li>
<li><a href="02-02-variables-and-constants">Variables and Constants</a></li>
<li><a href="02-03-tensorflow-graphs">TensorFlow Graphs</a></li>
<li><a href="02-04-eager-execution">Eager Execution</a></li>
</ul>
<h2>Module 3: Data Handling in TensorFlow</h2>
<ul>
<li><a href="03-01-loading-data">Loading Data</a></li>
<li><a href="03-02-data-pipelines-with-tf-data">Data Pipelines with tf.data</a></li>
<li><a href="03-03-data-augmentation">Data Augmentation</a></li>
<li><a href="03-04-working-with-datasets">Working with Datasets</a></li>
</ul>
<h2>Module 4: Building Neural Networks</h2>
<ul>
<li><a href="04-01-introduction-to-neural-networks">Introduction to Neural Networks</a></li>
<li><a href="04-02-creating-a-simple-neural-network">Creating a Simple Neural Network</a></li>
<li><a href="04-03-activation-functions">Activation Functions</a></li>
<li><a href="04-04-loss-functions-and-optimizers">Loss Functions and Optimizers</a></li>
</ul>
<h2>Module 5: Convolutional Neural Networks (CNNs)</h2>
<ul>
<li><a href="05-01-introduction-to-cnns">Introduction to CNNs</a></li>
<li><a href="05-02-building-a-cnn">Building a CNN</a></li>
<li><a href="05-03-pooling-layers">Pooling Layers</a></li>
<li><a href="05-04-advanced-cnn-architectures">Advanced CNN Architectures</a></li>
</ul>
<h2>Module 6: Recurrent Neural Networks (RNNs)</h2>
<ul>
<li><a href="06-01-introduction-to-rnns">Introduction to RNNs</a></li>
<li><a href="06-02-building-an-rnn">Building an RNN</a></li>
<li><a href="06-03-long-short-term-memory">Long Short-Term Memory (LSTM)</a></li>
<li><a href="06-04-gated-recurrent-units">Gated Recurrent Units (GRUs)</a></li>
</ul>
<h2>Module 7: Advanced TensorFlow Techniques</h2>
<ul>
<li><a href="07-01-custom-layers-and-models">Custom Layers and Models</a></li>
<li><a href="07-02-tensorflow-hub">TensorFlow Hub</a></li>
<li><a href="07-03-transfer-learning">Transfer Learning</a></li>
<li><a href="07-04-hyperparameter-tuning">Hyperparameter Tuning</a></li>
</ul>
<h2>Module 8: TensorFlow for Production</h2>
<ul>
<li><a href="08-01-model-saving-and-loading">Model Saving and Loading</a></li>
<li><a href="08-02-tensorflow-serving">TensorFlow Serving</a></li>
<li><a href="08-03-deploying-models">Deploying Models</a></li>
<li><a href="08-04-monitoring-and-maintenance">Monitoring and Maintenance</a></li>
</ul>
<h2>Module 9: TensorFlow Extended (TFX)</h2>
<ul>
<li><a href="09-01-introduction-to-tfx">Introduction to TFX</a></li>
<li><a href="09-02-data-validation">Data Validation</a></li>
<li><a href="09-03-transforming-data">Transforming Data</a></li>
<li><a href="09-04-model-analysis">Model Analysis</a></li>
</ul>
<h2>Module 10: Special Topics</h2>
<ul>
<li><a href="10-01-tensorflow-lite">TensorFlow Lite</a></li>
<li><a href="10-02-tensorflow-js">TensorFlow.js</a></li>
<li><a href="10-03-tensorflow-federated">TensorFlow Federated</a></li>
<li><a href="10-04-tensorflow-quantum">TensorFlow Quantum</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
</body>
</html>
