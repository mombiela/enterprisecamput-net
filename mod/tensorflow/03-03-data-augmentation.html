<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Augmentation</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/03-03-data-augmentation" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/03-03-data-augmentation" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/03-03-data-augmentation" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/tensorflow/03-03-data-augmentation" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/tensorflow/03-03-data-augmentation" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='03-02-data-pipelines-with-tf-data' title="Data Pipelines with tf.data">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Data Augmentation</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-04-working-with-datasets' title="Working with Datasets">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Data augmentation is a technique used to increase the diversity of your training data without actually collecting new data. This is particularly useful in machine learning and deep learning, where having a large and varied dataset can significantly improve the performance of your models. In this section, we will explore the concept of data augmentation, its benefits, and how to implement it using TensorFlow.</p>
</div><h1>What is Data Augmentation?</h1>
<div class='content'><p>Data augmentation involves creating new training examples by applying various transformations to the existing data. These transformations can include:</p>
<ul>
<li><strong>Rotation</strong>: Rotating the image by a certain angle.</li>
<li><strong>Translation</strong>: Shifting the image along the x or y axis.</li>
<li><strong>Scaling</strong>: Zooming in or out of the image.</li>
<li><strong>Flipping</strong>: Flipping the image horizontally or vertically.</li>
<li><strong>Color Jittering</strong>: Changing the brightness, contrast, saturation, or hue of the image.</li>
<li><strong>Noise Addition</strong>: Adding random noise to the image.</li>
</ul>
</div><h1>Benefits of Data Augmentation</h1>
<div class='content'><ol>
<li><strong>Increased Data Diversity</strong>: By generating new variations of the existing data, you can create a more diverse dataset, which helps in training more robust models.</li>
<li><strong>Reduced Overfitting</strong>: Data augmentation helps in reducing overfitting by providing more varied training examples, making it harder for the model to memorize the training data.</li>
<li><strong>Improved Generalization</strong>: Models trained with augmented data tend to generalize better to unseen data, leading to improved performance on the test set.</li>
</ol>
</div><h1>Implementing Data Augmentation in TensorFlow</h1>
<div class='content'><p>TensorFlow provides several utilities to perform data augmentation. The <code>tf.image</code> module contains functions for common image transformations. Additionally, the <code>tf.keras.preprocessing.image.ImageDataGenerator</code> class offers a convenient way to perform data augmentation.</p>
</div><h2>Using `tf.image` for Data Augmentation</h2>
<div class='content'><p>Here are some examples of how to use the <code>tf.image</code> module for data augmentation:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgTG9hZCBhbiBleGFtcGxlIGltYWdlCmltYWdlID0gdGYuaW8ucmVhZF9maWxlKCdwYXRoL3RvL2ltYWdlLmpwZycpCmltYWdlID0gdGYuaW1hZ2UuZGVjb2RlX2pwZWcoaW1hZ2UpCgojIFJvdGF0ZSB0aGUgaW1hZ2UKcm90YXRlZF9pbWFnZSA9IHRmLmltYWdlLnJvdDkwKGltYWdlKQoKIyBGbGlwIHRoZSBpbWFnZSBob3Jpem9udGFsbHkKZmxpcHBlZF9pbWFnZSA9IHRmLmltYWdlLmZsaXBfbGVmdF9yaWdodChpbWFnZSkKCiMgQWRqdXN0IHRoZSBicmlnaHRuZXNzCmJyaWdodF9pbWFnZSA9IHRmLmltYWdlLmFkanVzdF9icmlnaHRuZXNzKGltYWdlLCBkZWx0YT0wLjEpCgojIEFkZCByYW5kb20gbm9pc2UKbm9pc2UgPSB0Zi5yYW5kb20ubm9ybWFsKHNoYXBlPXRmLnNoYXBlKGltYWdlKSwgbWVhbj0wLjAsIHN0ZGRldj0wLjEsIGR0eXBlPXRmLmZsb2F0MzIpCm5vaXN5X2ltYWdlID0gdGYuYWRkKGltYWdlLCBub2lzZSkKCiMgRGlzcGxheSB0aGUgYXVnbWVudGVkIGltYWdlcwppbXBvcnQgbWF0cGxvdGxpYi5weXBsb3QgYXMgcGx0CgpwbHQuZmlndXJlKGZpZ3NpemU9KDEwLCAxMCkpCnBsdC5zdWJwbG90KDEsIDQsIDEpCnBsdC50aXRsZSgnT3JpZ2luYWwnKQpwbHQuaW1zaG93KGltYWdlLm51bXB5KCkuYXN0eXBlKCJ1aW50OCIpKQoKcGx0LnN1YnBsb3QoMSwgNCwgMikKcGx0LnRpdGxlKCdSb3RhdGVkJykKcGx0Lmltc2hvdyhyb3RhdGVkX2ltYWdlLm51bXB5KCkuYXN0eXBlKCJ1aW50OCIpKQoKcGx0LnN1YnBsb3QoMSwgNCwgMykKcGx0LnRpdGxlKCdGbGlwcGVkJykKcGx0Lmltc2hvdyhmbGlwcGVkX2ltYWdlLm51bXB5KCkuYXN0eXBlKCJ1aW50OCIpKQoKcGx0LnN1YnBsb3QoMSwgNCwgNCkKcGx0LnRpdGxlKCdCcmlnaHRlbmVkJykKcGx0Lmltc2hvdyhicmlnaHRfaW1hZ2UubnVtcHkoKS5hc3R5cGUoInVpbnQ4IikpCgpwbHQuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Load an example image
image = tf.io.read_file('path/to/image.jpg')
image = tf.image.decode_jpeg(image)

# Rotate the image
rotated_image = tf.image.rot90(image)

# Flip the image horizontally
flipped_image = tf.image.flip_left_right(image)

# Adjust the brightness
bright_image = tf.image.adjust_brightness(image, delta=0.1)

# Add random noise
noise = tf.random.normal(shape=tf.shape(image), mean=0.0, stddev=0.1, dtype=tf.float32)
noisy_image = tf.add(image, noise)

# Display the augmented images
import matplotlib.pyplot as plt

plt.figure(figsize=(10, 10))
plt.subplot(1, 4, 1)
plt.title('Original')
plt.imshow(image.numpy().astype(&quot;uint8&quot;))

plt.subplot(1, 4, 2)
plt.title('Rotated')
plt.imshow(rotated_image.numpy().astype(&quot;uint8&quot;))

plt.subplot(1, 4, 3)
plt.title('Flipped')
plt.imshow(flipped_image.numpy().astype(&quot;uint8&quot;))

plt.subplot(1, 4, 4)
plt.title('Brightened')
plt.imshow(bright_image.numpy().astype(&quot;uint8&quot;))

plt.show()</pre></div><div class='content'></div><h2>Using `ImageDataGenerator` for Data Augmentation</h2>
<div class='content'><p>The <code>ImageDataGenerator</code> class in <code>tf.keras.preprocessing.image</code> provides a more high-level and convenient way to perform data augmentation:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSB0ZW5zb3JmbG93LmtlcmFzLnByZXByb2Nlc3NpbmcuaW1hZ2UgaW1wb3J0IEltYWdlRGF0YUdlbmVyYXRvcgoKIyBDcmVhdGUgYW4gaW5zdGFuY2Ugb2YgSW1hZ2VEYXRhR2VuZXJhdG9yIHdpdGggYXVnbWVudGF0aW9uIHBhcmFtZXRlcnMKZGF0YWdlbiA9IEltYWdlRGF0YUdlbmVyYXRvcigKICAgIHJvdGF0aW9uX3JhbmdlPTQwLAogICAgd2lkdGhfc2hpZnRfcmFuZ2U9MC4yLAogICAgaGVpZ2h0X3NoaWZ0X3JhbmdlPTAuMiwKICAgIHNoZWFyX3JhbmdlPTAuMiwKICAgIHpvb21fcmFuZ2U9MC4yLAogICAgaG9yaXpvbnRhbF9mbGlwPVRydWUsCiAgICBmaWxsX21vZGU9J25lYXJlc3QnCikKCiMgTG9hZCBhbiBleGFtcGxlIGltYWdlCmltYWdlID0gdGYua2VyYXMucHJlcHJvY2Vzc2luZy5pbWFnZS5sb2FkX2ltZygncGF0aC90by9pbWFnZS5qcGcnKQp4ID0gdGYua2VyYXMucHJlcHJvY2Vzc2luZy5pbWFnZS5pbWdfdG9fYXJyYXkoaW1hZ2UpCnggPSB4LnJlc2hhcGUoKDEsKSArIHguc2hhcGUpCgojIEdlbmVyYXRlIGF1Z21lbnRlZCBpbWFnZXMKaSA9IDAKZm9yIGJhdGNoIGluIGRhdGFnZW4uZmxvdyh4LCBiYXRjaF9zaXplPTEpOgogICAgcGx0LmZpZ3VyZShpKQogICAgaW1ncGxvdCA9IHBsdC5pbXNob3codGYua2VyYXMucHJlcHJvY2Vzc2luZy5pbWFnZS5hcnJheV90b19pbWcoYmF0Y2hbMF0pKQogICAgaSArPSAxCiAgICBpZiBpICUgNCA9PSAwOgogICAgICAgIGJyZWFrCgpwbHQuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from tensorflow.keras.preprocessing.image import ImageDataGenerator

# Create an instance of ImageDataGenerator with augmentation parameters
datagen = ImageDataGenerator(
    rotation_range=40,
    width_shift_range=0.2,
    height_shift_range=0.2,
    shear_range=0.2,
    zoom_range=0.2,
    horizontal_flip=True,
    fill_mode='nearest'
)

# Load an example image
image = tf.keras.preprocessing.image.load_img('path/to/image.jpg')
x = tf.keras.preprocessing.image.img_to_array(image)
x = x.reshape((1,) + x.shape)

# Generate augmented images
i = 0
for batch in datagen.flow(x, batch_size=1):
    plt.figure(i)
    imgplot = plt.imshow(tf.keras.preprocessing.image.array_to_img(batch[0]))
    i += 1
    if i % 4 == 0:
        break

plt.show()</pre></div><div class='content'></div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Apply Data Augmentation</h2>
<div class='content'><ol>
<li>Load an image from your local directory.</li>
<li>Apply the following augmentations using <code>tf.image</code>:
<ul>
<li>Rotate the image by 90 degrees.</li>
<li>Flip the image horizontally.</li>
<li>Adjust the brightness by a factor of 0.2.</li>
</ul>
</li>
<li>Display the original and augmented images using <code>matplotlib</code>.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKaW1wb3J0IG1hdHBsb3RsaWIucHlwbG90IGFzIHBsdAoKIyBMb2FkIGFuIGV4YW1wbGUgaW1hZ2UKaW1hZ2VfcGF0aCA9ICdwYXRoL3RvL3lvdXIvaW1hZ2UuanBnJwppbWFnZSA9IHRmLmlvLnJlYWRfZmlsZShpbWFnZV9wYXRoKQppbWFnZSA9IHRmLmltYWdlLmRlY29kZV9qcGVnKGltYWdlKQoKIyBBcHBseSBhdWdtZW50YXRpb25zCnJvdGF0ZWRfaW1hZ2UgPSB0Zi5pbWFnZS5yb3Q5MChpbWFnZSkKZmxpcHBlZF9pbWFnZSA9IHRmLmltYWdlLmZsaXBfbGVmdF9yaWdodChpbWFnZSkKYnJpZ2h0X2ltYWdlID0gdGYuaW1hZ2UuYWRqdXN0X2JyaWdodG5lc3MoaW1hZ2UsIGRlbHRhPTAuMikKCiMgRGlzcGxheSB0aGUgaW1hZ2VzCnBsdC5maWd1cmUoZmlnc2l6ZT0oMTAsIDEwKSkKcGx0LnN1YnBsb3QoMSwgNCwgMSkKcGx0LnRpdGxlKCdPcmlnaW5hbCcpCnBsdC5pbXNob3coaW1hZ2UubnVtcHkoKS5hc3R5cGUoInVpbnQ4IikpCgpwbHQuc3VicGxvdCgxLCA0LCAyKQpwbHQudGl0bGUoJ1JvdGF0ZWQnKQpwbHQuaW1zaG93KHJvdGF0ZWRfaW1hZ2UubnVtcHkoKS5hc3R5cGUoInVpbnQ4IikpCgpwbHQuc3VicGxvdCgxLCA0LCAzKQpwbHQudGl0bGUoJ0ZsaXBwZWQnKQpwbHQuaW1zaG93KGZsaXBwZWRfaW1hZ2UubnVtcHkoKS5hc3R5cGUoInVpbnQ4IikpCgpwbHQuc3VicGxvdCgxLCA0LCA0KQpwbHQudGl0bGUoJ0JyaWdodGVuZWQnKQpwbHQuaW1zaG93KGJyaWdodF9pbWFnZS5udW1weSgpLmFzdHlwZSgidWludDgiKSkKCnBsdC5zaG93KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
import matplotlib.pyplot as plt

# Load an example image
image_path = 'path/to/your/image.jpg'
image = tf.io.read_file(image_path)
image = tf.image.decode_jpeg(image)

# Apply augmentations
rotated_image = tf.image.rot90(image)
flipped_image = tf.image.flip_left_right(image)
bright_image = tf.image.adjust_brightness(image, delta=0.2)

# Display the images
plt.figure(figsize=(10, 10))
plt.subplot(1, 4, 1)
plt.title('Original')
plt.imshow(image.numpy().astype(&quot;uint8&quot;))

plt.subplot(1, 4, 2)
plt.title('Rotated')
plt.imshow(rotated_image.numpy().astype(&quot;uint8&quot;))

plt.subplot(1, 4, 3)
plt.title('Flipped')
plt.imshow(flipped_image.numpy().astype(&quot;uint8&quot;))

plt.subplot(1, 4, 4)
plt.title('Brightened')
plt.imshow(bright_image.numpy().astype(&quot;uint8&quot;))

plt.show()</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we explored the concept of data augmentation and its benefits in machine learning. We learned how to implement data augmentation using TensorFlow's <code>tf.image</code> module and the <code>ImageDataGenerator</code> class. By applying various transformations to the existing data, we can create a more diverse and robust dataset, leading to improved model performance and generalization. In the next section, we will delve into working with datasets in TensorFlow, where we will learn how to efficiently load and preprocess data for training.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='03-02-data-pipelines-with-tf-data' title="Data Pipelines with tf.data">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-04-working-with-datasets' title="Working with Datasets">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
