<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TensorFlow Graphs</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/02-03-tensorflow-graphs" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/02-03-tensorflow-graphs" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/02-03-tensorflow-graphs" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/tensorflow/02-03-tensorflow-graphs" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/tensorflow/02-03-tensorflow-graphs" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='02-02-variables-and-constants' title="Variables and Constants">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">TensorFlow Graphs</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='02-04-eager-execution' title="Eager Execution">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore TensorFlow graphs, a fundamental concept that allows TensorFlow to optimize and execute computations efficiently. Understanding TensorFlow graphs is crucial for building complex machine learning models and deploying them in production.</p>
</div><h1>What is a TensorFlow Graph?</h1>
<div class='content'><p>A TensorFlow graph is a data structure that represents the computations you want to perform. It consists of nodes (operations) and edges (tensors) that define the flow of data. The graph allows TensorFlow to optimize and execute the computations efficiently.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Nodes</strong>: Represent operations (e.g., addition, multiplication).</li>
<li><strong>Edges</strong>: Represent the data (tensors) flowing between operations.</li>
<li><strong>Graph</strong>: A collection of nodes and edges that define the computation.</li>
</ul>
</div><h1>Creating a TensorFlow Graph</h1>
<div class='content'><p>In TensorFlow 2.x, eager execution is enabled by default, which means operations are executed immediately as they are called. However, you can still create and use graphs for more complex scenarios.</p>
</div><h2>Example: Creating a Simple Graph</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgRGlzYWJsZSBlYWdlciBleGVjdXRpb24gdG8gdXNlIGdyYXBocwp0Zi5jb21wYXQudjEuZGlzYWJsZV9lYWdlcl9leGVjdXRpb24oKQoKIyBDcmVhdGUgYSBuZXcgZ3JhcGgKZ3JhcGggPSB0Zi5HcmFwaCgpCgp3aXRoIGdyYXBoLmFzX2RlZmF1bHQoKToKICAgICMgRGVmaW5lIHRoZSBvcGVyYXRpb25zCiAgICBhID0gdGYuY29uc3RhbnQoNSwgbmFtZT0iYSIpCiAgICBiID0gdGYuY29uc3RhbnQoMywgbmFtZT0iYiIpCiAgICBjID0gdGYuYWRkKGEsIGIsIG5hbWU9ImMiKQoKIyBDcmVhdGUgYSBzZXNzaW9uIHRvIHJ1biB0aGUgZ3JhcGgKd2l0aCB0Zi5jb21wYXQudjEuU2Vzc2lvbihncmFwaD1ncmFwaCkgYXMgc2VzczoKICAgIHJlc3VsdCA9IHNlc3MucnVuKGMpCiAgICBwcmludCgiUmVzdWx0IG9mIGEgKyBiOiIsIHJlc3VsdCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Disable eager execution to use graphs
tf.compat.v1.disable_eager_execution()

# Create a new graph
graph = tf.Graph()

with graph.as_default():
    # Define the operations
    a = tf.constant(5, name=&quot;a&quot;)
    b = tf.constant(3, name=&quot;b&quot;)
    c = tf.add(a, b, name=&quot;c&quot;)

# Create a session to run the graph
with tf.compat.v1.Session(graph=graph) as sess:
    result = sess.run(c)
    print(&quot;Result of a + b:&quot;, result)</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ol>
<li><strong>Disable Eager Execution</strong>: We disable eager execution to use the graph mode.</li>
<li><strong>Create a Graph</strong>: We create a new graph using <code>tf.Graph()</code>.</li>
<li><strong>Define Operations</strong>: Inside the graph context, we define constants <code>a</code> and <code>b</code>, and an addition operation <code>c</code>.</li>
<li><strong>Create a Session</strong>: We create a session to run the graph and fetch the result of the addition operation.</li>
</ol>
</div><h1>Benefits of Using Graphs</h1>
<div class='content'><ul>
<li><strong>Performance Optimization</strong>: TensorFlow can optimize the graph for better performance.</li>
<li><strong>Portability</strong>: Graphs can be saved, loaded, and run on different devices.</li>
<li><strong>Deployment</strong>: Graphs are essential for deploying models in production environments.</li>
</ul>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Create and Run a TensorFlow Graph</h2>
<div class='content'><ol>
<li>Create a TensorFlow graph that multiplies two constants and adds a third constant to the result.</li>
<li>Print the final result.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgRGlzYWJsZSBlYWdlciBleGVjdXRpb24gdG8gdXNlIGdyYXBocwp0Zi5jb21wYXQudjEuZGlzYWJsZV9lYWdlcl9leGVjdXRpb24oKQoKIyBDcmVhdGUgYSBuZXcgZ3JhcGgKZ3JhcGggPSB0Zi5HcmFwaCgpCgp3aXRoIGdyYXBoLmFzX2RlZmF1bHQoKToKICAgICMgRGVmaW5lIHRoZSBvcGVyYXRpb25zCiAgICB4ID0gdGYuY29uc3RhbnQoNCwgbmFtZT0ieCIpCiAgICB5ID0gdGYuY29uc3RhbnQoMiwgbmFtZT0ieSIpCiAgICB6ID0gdGYuY29uc3RhbnQoMywgbmFtZT0ieiIpCiAgICBtdWwgPSB0Zi5tdWx0aXBseSh4LCB5LCBuYW1lPSJtdWwiKQogICAgYWRkID0gdGYuYWRkKG11bCwgeiwgbmFtZT0iYWRkIikKCiMgQ3JlYXRlIGEgc2Vzc2lvbiB0byBydW4gdGhlIGdyYXBoCndpdGggdGYuY29tcGF0LnYxLlNlc3Npb24oZ3JhcGg9Z3JhcGgpIGFzIHNlc3M6CiAgICByZXN1bHQgPSBzZXNzLnJ1bihhZGQpCiAgICBwcmludCgiUmVzdWx0IG9mICh4ICogeSkgKyB6OiIsIHJlc3VsdCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Disable eager execution to use graphs
tf.compat.v1.disable_eager_execution()

# Create a new graph
graph = tf.Graph()

with graph.as_default():
    # Define the operations
    x = tf.constant(4, name=&quot;x&quot;)
    y = tf.constant(2, name=&quot;y&quot;)
    z = tf.constant(3, name=&quot;z&quot;)
    mul = tf.multiply(x, y, name=&quot;mul&quot;)
    add = tf.add(mul, z, name=&quot;add&quot;)

# Create a session to run the graph
with tf.compat.v1.Session(graph=graph) as sess:
    result = sess.run(add)
    print(&quot;Result of (x * y) + z:&quot;, result)</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ol>
<li><strong>Define Constants</strong>: We define constants <code>x</code>, <code>y</code>, and <code>z</code>.</li>
<li><strong>Multiply and Add</strong>: We multiply <code>x</code> and <code>y</code>, then add <code>z</code> to the result.</li>
<li><strong>Run the Graph</strong>: We create a session to run the graph and print the final result.</li>
</ol>
</div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Forgetting to Disable Eager Execution</strong>: Ensure eager execution is disabled when working with graphs in TensorFlow 2.x.</li>
<li><strong>Not Using <code>as_default()</code></strong>: Always use the graph context (<code>with graph.as_default()</code>) to define operations within a specific graph.</li>
<li><strong>Session Management</strong>: Remember to create and manage sessions properly to run the graph.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we learned about TensorFlow graphs, their benefits, and how to create and run them. Understanding graphs is essential for optimizing and deploying TensorFlow models. In the next module, we will dive into data handling in TensorFlow, starting with loading data efficiently.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='02-02-variables-and-constants' title="Variables and Constants">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='02-04-eager-execution' title="Eager Execution">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
