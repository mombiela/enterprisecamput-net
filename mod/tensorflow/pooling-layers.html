<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pooling Layers</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/pooling-layers" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/pooling-layers" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/pooling-layers" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/tensorflow/pooling-layers" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/tensorflow/pooling-layers" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='building-a-cnn'>&#x25C4;Building a CNN</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Pooling Layers</a>
	</div>
	<div class='col-4 text-end'>
					<a href='advanced-cnn-architectures'>Advanced CNN Architectures &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Pooling layers are a crucial component in Convolutional Neural Networks (CNNs). They help reduce the spatial dimensions of the input, which decreases the computational load and helps in extracting dominant features that are invariant to small translations. In this section, we will explore the concept of pooling layers, their types, and how to implement them using TensorFlow.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Pooling Operation</strong>: A technique to reduce the spatial dimensions (width and height) of the input volume.</li>
<li><strong>Types of Pooling</strong>:
<ul>
<li><strong>Max Pooling</strong>: Selects the maximum value from each patch of the feature map.</li>
<li><strong>Average Pooling</strong>: Computes the average value from each patch of the feature map.</li>
</ul>
</li>
<li><strong>Stride</strong>: The number of pixels by which we slide the pooling window across the input matrix.</li>
<li><strong>Padding</strong>: Adding extra pixels around the input matrix to control the spatial dimensions of the output.</li>
</ul>
</div><h1>Max Pooling</h1>
<div class='content'><p>Max pooling is the most common type of pooling. It works by sliding a window (usually 2x2) over the input feature map and taking the maximum value in each window.</p>
</div><h2>Example</h2>
<div class='content'><p>Consider a 4x4 input matrix:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW5wdXQgTWF0cml4OgpbWzEsIDMsIDIsIDRdLAogWzUsIDYsIDEsIDJdLAogWzcsIDgsIDMsIDBdLAogWzIsIDQsIDYsIDhdXQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Input Matrix:
[[1, 3, 2, 4],
 [5, 6, 1, 2],
 [7, 8, 3, 0],
 [2, 4, 6, 8]]</pre></div><div class='content'><p>Applying a 2x2 max pooling with a stride of 2:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("TWF4IFBvb2xlZCBNYXRyaXg6CltbNiwgNF0sCiBbOCwgOF1d"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Max Pooled Matrix:
[[6, 4],
 [8, 8]]</pre></div><div class='content'></div><h2>TensorFlow Implementation</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgQ3JlYXRlIGEgNHg0IGlucHV0IG1hdHJpeAppbnB1dF9tYXRyaXggPSB0Zi5jb25zdGFudChbWzEsIDMsIDIsIDRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzUsIDYsIDEsIDJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzcsIDgsIDMsIDBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIsIDQsIDYsIDhdXSwgZHR5cGU9dGYuZmxvYXQzMikKCiMgUmVzaGFwZSB0byA0RCB0ZW5zb3I6IFtiYXRjaF9zaXplLCBoZWlnaHQsIHdpZHRoLCBjaGFubmVsc10KaW5wdXRfdGVuc29yID0gdGYucmVzaGFwZShpbnB1dF9tYXRyaXgsIFsxLCA0LCA0LCAxXSkKCiMgQXBwbHkgbWF4IHBvb2xpbmcKbWF4X3Bvb2xpbmcgPSB0Zi5ubi5tYXhfcG9vbDJkKGlucHV0X3RlbnNvciwga3NpemU9Miwgc3RyaWRlcz0yLCBwYWRkaW5nPSdWQUxJRCcpCgpwcmludCgiTWF4IFBvb2xlZCBPdXRwdXQ6XG4iLCB0Zi5zcXVlZXplKG1heF9wb29saW5nKS5udW1weSgpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Create a 4x4 input matrix
input_matrix = tf.constant([[1, 3, 2, 4],
                            [5, 6, 1, 2],
                            [7, 8, 3, 0],
                            [2, 4, 6, 8]], dtype=tf.float32)

# Reshape to 4D tensor: [batch_size, height, width, channels]
input_tensor = tf.reshape(input_matrix, [1, 4, 4, 1])

# Apply max pooling
max_pooling = tf.nn.max_pool2d(input_tensor, ksize=2, strides=2, padding='VALID')

print(&quot;Max Pooled Output:\n&quot;, tf.squeeze(max_pooling).numpy())</pre></div><div class='content'></div><h1>Average Pooling</h1>
<div class='content'><p>Average pooling works similarly to max pooling but instead of taking the maximum value, it computes the average of all the values in the window.</p>
</div><h2>Example</h2>
<div class='content'><p>Consider the same 4x4 input matrix:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW5wdXQgTWF0cml4OgpbWzEsIDMsIDIsIDRdLAogWzUsIDYsIDEsIDJdLAogWzcsIDgsIDMsIDBdLAogWzIsIDQsIDYsIDhdXQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Input Matrix:
[[1, 3, 2, 4],
 [5, 6, 1, 2],
 [7, 8, 3, 0],
 [2, 4, 6, 8]]</pre></div><div class='content'><p>Applying a 2x2 average pooling with a stride of 2:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QXZlcmFnZSBQb29sZWQgTWF0cml4OgpbWzMuNzUsIDIuMjVdLAogWzUuMjUsIDQuMjVdXQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Average Pooled Matrix:
[[3.75, 2.25],
 [5.25, 4.25]]</pre></div><div class='content'></div><h2>TensorFlow Implementation</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgQ3JlYXRlIGEgNHg0IGlucHV0IG1hdHJpeAppbnB1dF9tYXRyaXggPSB0Zi5jb25zdGFudChbWzEsIDMsIDIsIDRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzUsIDYsIDEsIDJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzcsIDgsIDMsIDBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIsIDQsIDYsIDhdXSwgZHR5cGU9dGYuZmxvYXQzMikKCiMgUmVzaGFwZSB0byA0RCB0ZW5zb3I6IFtiYXRjaF9zaXplLCBoZWlnaHQsIHdpZHRoLCBjaGFubmVsc10KaW5wdXRfdGVuc29yID0gdGYucmVzaGFwZShpbnB1dF9tYXRyaXgsIFsxLCA0LCA0LCAxXSkKCiMgQXBwbHkgYXZlcmFnZSBwb29saW5nCmF2Z19wb29saW5nID0gdGYubm4uYXZnX3Bvb2wyZChpbnB1dF90ZW5zb3IsIGtzaXplPTIsIHN0cmlkZXM9MiwgcGFkZGluZz0nVkFMSUQnKQoKcHJpbnQoIkF2ZXJhZ2UgUG9vbGVkIE91dHB1dDpcbiIsIHRmLnNxdWVlemUoYXZnX3Bvb2xpbmcpLm51bXB5KCkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Create a 4x4 input matrix
input_matrix = tf.constant([[1, 3, 2, 4],
                            [5, 6, 1, 2],
                            [7, 8, 3, 0],
                            [2, 4, 6, 8]], dtype=tf.float32)

# Reshape to 4D tensor: [batch_size, height, width, channels]
input_tensor = tf.reshape(input_matrix, [1, 4, 4, 1])

# Apply average pooling
avg_pooling = tf.nn.avg_pool2d(input_tensor, ksize=2, strides=2, padding='VALID')

print(&quot;Average Pooled Output:\n&quot;, tf.squeeze(avg_pooling).numpy())</pre></div><div class='content'></div><h1>Padding and Stride</h1>
<div class='content'><ul>
<li><strong>Padding</strong>: Determines whether the pooling operation should pad the input matrix to maintain the spatial dimensions.
<ul>
<li><strong>VALID</strong>: No padding. The output size is reduced.</li>
<li><strong>SAME</strong>: Padding is added to ensure the output size is the same as the input size.</li>
</ul>
</li>
<li><strong>Stride</strong>: Determines the step size of the pooling window. A stride of 2 means the window moves 2 pixels at a time.</li>
</ul>
</div><h2>Example with Padding and Stride</h2>
<div class='content'><p>Consider a 4x4 input matrix and a 2x2 pooling window with a stride of 1 and SAME padding:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW5wdXQgTWF0cml4OgpbWzEsIDMsIDIsIDRdLAogWzUsIDYsIDEsIDJdLAogWzcsIDgsIDMsIDBdLAogWzIsIDQsIDYsIDhdXQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Input Matrix:
[[1, 3, 2, 4],
 [5, 6, 1, 2],
 [7, 8, 3, 0],
 [2, 4, 6, 8]]</pre></div><div class='content'><p>Applying max pooling:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("TWF4IFBvb2xlZCBNYXRyaXg6CltbNiwgNiwgNCwgNF0sCiBbOCwgOCwgMywgMl0sCiBbOCwgOCwgNiwgOF0sCiBbNCwgNiwgNiwgOF1d"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Max Pooled Matrix:
[[6, 6, 4, 4],
 [8, 8, 3, 2],
 [8, 8, 6, 8],
 [4, 6, 6, 8]]</pre></div><div class='content'></div><h2>TensorFlow Implementation</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgQ3JlYXRlIGEgNHg0IGlucHV0IG1hdHJpeAppbnB1dF9tYXRyaXggPSB0Zi5jb25zdGFudChbWzEsIDMsIDIsIDRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzUsIDYsIDEsIDJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzcsIDgsIDMsIDBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgWzIsIDQsIDYsIDhdXSwgZHR5cGU9dGYuZmxvYXQzMikKCiMgUmVzaGFwZSB0byA0RCB0ZW5zb3I6IFtiYXRjaF9zaXplLCBoZWlnaHQsIHdpZHRoLCBjaGFubmVsc10KaW5wdXRfdGVuc29yID0gdGYucmVzaGFwZShpbnB1dF9tYXRyaXgsIFsxLCA0LCA0LCAxXSkKCiMgQXBwbHkgbWF4IHBvb2xpbmcgd2l0aCBzdHJpZGUgMSBhbmQgU0FNRSBwYWRkaW5nCm1heF9wb29saW5nX3NhbWUgPSB0Zi5ubi5tYXhfcG9vbDJkKGlucHV0X3RlbnNvciwga3NpemU9Miwgc3RyaWRlcz0xLCBwYWRkaW5nPSdTQU1FJykKCnByaW50KCJNYXggUG9vbGVkIE91dHB1dCB3aXRoIFNBTUUgUGFkZGluZzpcbiIsIHRmLnNxdWVlemUobWF4X3Bvb2xpbmdfc2FtZSkubnVtcHkoKSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Create a 4x4 input matrix
input_matrix = tf.constant([[1, 3, 2, 4],
                            [5, 6, 1, 2],
                            [7, 8, 3, 0],
                            [2, 4, 6, 8]], dtype=tf.float32)

# Reshape to 4D tensor: [batch_size, height, width, channels]
input_tensor = tf.reshape(input_matrix, [1, 4, 4, 1])

# Apply max pooling with stride 1 and SAME padding
max_pooling_same = tf.nn.max_pool2d(input_tensor, ksize=2, strides=1, padding='SAME')

print(&quot;Max Pooled Output with SAME Padding:\n&quot;, tf.squeeze(max_pooling_same).numpy())</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Pooling layers play a vital role in reducing the spatial dimensions of feature maps, which helps in decreasing the computational load and extracting dominant features. Max pooling and average pooling are the two most common types of pooling operations. Understanding how to implement these in TensorFlow, along with the concepts of padding and stride, is essential for building efficient CNNs. By mastering these concepts, you can create more effective and computationally efficient neural networks.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='building-a-cnn'>&#x25C4;Building a CNN</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Pooling Layers</a>
	</div>
	<div class='col-4 text-end'>
					<a href='advanced-cnn-architectures'>Advanced CNN Architectures &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
