<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pooling Layers</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/05-03-pooling-layers" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/05-03-pooling-layers" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/05-03-pooling-layers" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/tensorflow/05-03-pooling-layers" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/tensorflow/05-03-pooling-layers" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-building-a-cnn' title="Building a CNN">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Pooling Layers</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-advanced-cnn-architectures' title="Advanced CNN Architectures">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Pooling layers are a crucial component in Convolutional Neural Networks (CNNs). They are used to reduce the spatial dimensions (width and height) of the input volume, which helps in reducing the computational cost and controlling overfitting. This section will cover the following topics:</p>
<ol>
<li><strong>What is Pooling?</strong></li>
<li><strong>Types of Pooling</strong></li>
<li><strong>Max Pooling</strong></li>
<li><strong>Average Pooling</strong></li>
<li><strong>Global Pooling</strong></li>
<li><strong>Practical Example with TensorFlow</strong></li>
<li><strong>Exercises</strong></li>
</ol>
</div><h1>1. What is Pooling?</h1>
<div class='content'><p>Pooling is a down-sampling operation that reduces the dimensionality of feature maps while retaining important information. It operates independently on each depth slice of the input and resizes it spatially.</p>
</div><h2>Key Benefits of Pooling:</h2>
<div class='content'><ul>
<li><strong>Dimensionality Reduction:</strong> Reduces the number of parameters and computations in the network.</li>
<li><strong>Translation Invariance:</strong> Helps the network become more robust to variations and distortions in the input.</li>
</ul>
</div><h1>2. Types of Pooling</h1>
<div class='content'><p>There are several types of pooling operations, but the most commonly used are:</p>
<ul>
<li><strong>Max Pooling</strong></li>
<li><strong>Average Pooling</strong></li>
<li><strong>Global Pooling</strong></li>
</ul>
</div><h1>3. Max Pooling</h1>
<div class='content'><p>Max pooling selects the maximum value from each patch of the feature map. It is the most commonly used pooling operation.</p>
</div><h2>Example:</h2>
<div class='content'><p>Consider a 4x4 feature map and a 2x2 max pooling operation with a stride of 2.</p>
<table>
<thead>
<tr>
<th>Input Feature Map</th>
<th>Max Pooled Feature Map</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>5</td>
<td>6</td>
</tr>
<tr>
<td>9</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>The max pooled feature map is obtained by taking the maximum value from each 2x2 patch.</p>
</div><h1>4. Average Pooling</h1>
<div class='content'><p>Average pooling computes the average value of each patch of the feature map. It is less commonly used than max pooling but can be useful in certain scenarios.</p>
</div><h2>Example:</h2>
<div class='content'><p>Consider a 4x4 feature map and a 2x2 average pooling operation with a stride of 2.</p>
<table>
<thead>
<tr>
<th>Input Feature Map</th>
<th>Average Pooled Feature Map</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>5</td>
<td>6</td>
</tr>
<tr>
<td>9</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>The average pooled feature map is obtained by taking the average value from each 2x2 patch.</p>
</div><h1>5. Global Pooling</h1>
<div class='content'><p>Global pooling reduces each feature map to a single value by taking the maximum or average value of the entire feature map. It is often used in the final layers of a CNN.</p>
</div><h2>Example:</h2>
<div class='content'><p>Consider a 4x4 feature map and global max pooling.</p>
<table>
<thead>
<tr>
<th>Input Feature Map</th>
<th>Global Max Pooled Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>5</td>
<td>6</td>
</tr>
<tr>
<td>9</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>The global max pooled value is 9, which is the maximum value in the entire feature map.</p>
</div><h1>6. Practical Example with TensorFlow</h1>
<div class='content'><p>Let's implement max pooling and average pooling using TensorFlow.</p>
</div><h2>Max Pooling Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgQ3JlYXRlIGEgNHg0IGZlYXR1cmUgbWFwCmlucHV0X2RhdGEgPSB0Zi5jb25zdGFudChbWzEsIDMsIDIsIDRdLAogICAgICAgICAgICAgICAgICAgICAgICAgIFs1LCA2LCA3LCA4XSwKICAgICAgICAgICAgICAgICAgICAgICAgICBbOSwgMiwgMSwgM10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzQsIDUsIDYsIDddXSwgZHR5cGU9dGYuZmxvYXQzMikKCiMgUmVzaGFwZSB0byA0RCB0ZW5zb3IgKGJhdGNoX3NpemUsIGhlaWdodCwgd2lkdGgsIGNoYW5uZWxzKQppbnB1dF9kYXRhID0gdGYucmVzaGFwZShpbnB1dF9kYXRhLCBbMSwgNCwgNCwgMV0pCgojIEFwcGx5IG1heCBwb29saW5nCm1heF9wb29sID0gdGYubm4ubWF4X3Bvb2wyZChpbnB1dF9kYXRhLCBrc2l6ZT0yLCBzdHJpZGVzPTIsIHBhZGRpbmc9J1ZBTElEJykKCnByaW50KCJNYXggUG9vbGluZyBSZXN1bHQ6IikKcHJpbnQobWF4X3Bvb2wubnVtcHkoKS5yZXNoYXBlKDIsIDIpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Create a 4x4 feature map
input_data = tf.constant([[1, 3, 2, 4],
                          [5, 6, 7, 8],
                          [9, 2, 1, 3],
                          [4, 5, 6, 7]], dtype=tf.float32)

# Reshape to 4D tensor (batch_size, height, width, channels)
input_data = tf.reshape(input_data, [1, 4, 4, 1])

# Apply max pooling
max_pool = tf.nn.max_pool2d(input_data, ksize=2, strides=2, padding='VALID')

print(&quot;Max Pooling Result:&quot;)
print(max_pool.numpy().reshape(2, 2))</pre></div><div class='content'></div><h2>Average Pooling Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgQ3JlYXRlIGEgNHg0IGZlYXR1cmUgbWFwCmlucHV0X2RhdGEgPSB0Zi5jb25zdGFudChbWzEsIDMsIDIsIDRdLAogICAgICAgICAgICAgICAgICAgICAgICAgIFs1LCA2LCA3LCA4XSwKICAgICAgICAgICAgICAgICAgICAgICAgICBbOSwgMiwgMSwgM10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgWzQsIDUsIDYsIDddXSwgZHR5cGU9dGYuZmxvYXQzMikKCiMgUmVzaGFwZSB0byA0RCB0ZW5zb3IgKGJhdGNoX3NpemUsIGhlaWdodCwgd2lkdGgsIGNoYW5uZWxzKQppbnB1dF9kYXRhID0gdGYucmVzaGFwZShpbnB1dF9kYXRhLCBbMSwgNCwgNCwgMV0pCgojIEFwcGx5IGF2ZXJhZ2UgcG9vbGluZwphdmdfcG9vbCA9IHRmLm5uLmF2Z19wb29sMmQoaW5wdXRfZGF0YSwga3NpemU9Miwgc3RyaWRlcz0yLCBwYWRkaW5nPSdWQUxJRCcpCgpwcmludCgiQXZlcmFnZSBQb29saW5nIFJlc3VsdDoiKQpwcmludChhdmdfcG9vbC5udW1weSgpLnJlc2hhcGUoMiwgMikp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Create a 4x4 feature map
input_data = tf.constant([[1, 3, 2, 4],
                          [5, 6, 7, 8],
                          [9, 2, 1, 3],
                          [4, 5, 6, 7]], dtype=tf.float32)

# Reshape to 4D tensor (batch_size, height, width, channels)
input_data = tf.reshape(input_data, [1, 4, 4, 1])

# Apply average pooling
avg_pool = tf.nn.avg_pool2d(input_data, ksize=2, strides=2, padding='VALID')

print(&quot;Average Pooling Result:&quot;)
print(avg_pool.numpy().reshape(2, 2))</pre></div><div class='content'></div><h1>7. Exercises</h1>
<div class='content'></div><h2>Exercise 1: Max Pooling</h2>
<div class='content'><p>Given the following 4x4 feature map, apply a 2x2 max pooling operation with a stride of 2.</p>
<table>
<thead>
<tr>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
</tr>
<tr>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr>
<td>13</td>
<td>14</td>
<td>15</td>
<td>16</td>
</tr>
</tbody>
</table>
<p><strong>Solution:</strong></p>
<table>
<thead>
<tr>
<th>6</th>
<th>8</th>
</tr>
</thead>
<tbody>
<tr>
<td>14</td>
<td>16</td>
</tr>
</tbody>
</table>
</div><h2>Exercise 2: Average Pooling</h2>
<div class='content'><p>Given the following 4x4 feature map, apply a 2x2 average pooling operation with a stride of 2.</p>
<table>
<thead>
<tr>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
</tr>
<tr>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
</tr>
<tr>
<td>13</td>
<td>14</td>
<td>15</td>
<td>16</td>
</tr>
</tbody>
</table>
<p><strong>Solution:</strong></p>
<table>
<thead>
<tr>
<th>3.5</th>
<th>5.5</th>
</tr>
</thead>
<tbody>
<tr>
<td>11.5</td>
<td>13.5</td>
</tr>
</tbody>
</table>
</div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Incorrect Stride:</strong> Ensure the stride is set correctly to avoid overlapping or skipping regions.</li>
<li><strong>Padding Issues:</strong> Be mindful of padding settings (<code>VALID</code> vs <code>SAME</code>) as they affect the output dimensions.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Pooling layers are essential for reducing the spatial dimensions of feature maps, which helps in reducing computational cost and controlling overfitting. Max pooling and average pooling are the most commonly used techniques, each with its own advantages. Understanding and implementing these pooling operations in TensorFlow is crucial for building efficient and effective CNNs.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-building-a-cnn' title="Building a CNN">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-advanced-cnn-architectures' title="Advanced CNN Architectures">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
