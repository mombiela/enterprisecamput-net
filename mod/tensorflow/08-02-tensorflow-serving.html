<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TensorFlow Serving</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/08-02-tensorflow-serving" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/08-02-tensorflow-serving" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/08-02-tensorflow-serving" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/tensorflow/08-02-tensorflow-serving" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/tensorflow/08-02-tensorflow-serving" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='08-01-model-saving-and-loading' title="Model Saving and Loading">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">TensorFlow Serving</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='08-03-deploying-models' title="Deploying Models">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>TensorFlow Serving is a flexible, high-performance serving system for machine learning models, designed for production environments. It allows you to deploy new algorithms and experiments while keeping the same server architecture and APIs. TensorFlow Serving provides out-of-the-box integration with TensorFlow models, but it can be extended to serve other types of models as well.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Model Server</strong>: The core component that loads and serves models.</li>
<li><strong>Model Versioning</strong>: Supports multiple versions of a model, allowing for seamless updates.</li>
<li><strong>Batching</strong>: Combines multiple requests into a single batch to improve throughput.</li>
<li><strong>Monitoring</strong>: Provides metrics and logging to monitor the performance and health of the model server.</li>
</ol>
</div><h1>Setting Up TensorFlow Serving</h1>
<div class='content'></div><h2>Prerequisites</h2>
<div class='content'><ul>
<li>Docker (recommended for easy setup)</li>
<li>TensorFlow installed</li>
<li>A trained TensorFlow model</li>
</ul>
</div><h2>Installation</h2>
<div class='content'><p>You can install TensorFlow Serving using Docker. Here’s how:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZG9ja2VyIHB1bGwgdGVuc29yZmxvdy9zZXJ2aW5n"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>docker pull tensorflow/serving</pre></div><div class='content'></div><h1>Serving a TensorFlow Model</h1>
<div class='content'></div><h2>Step 1: Export the Model</h2>
<div class='content'><p>First, you need to export your trained TensorFlow model in the SavedModel format. Here’s an example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgQXNzdW1lIHlvdSBoYXZlIGEgdHJhaW5lZCBtb2RlbAptb2RlbCA9IHRmLmtlcmFzLm1vZGVscy5sb2FkX21vZGVsKCdwYXRoX3RvX3lvdXJfbW9kZWwnKQoKIyBFeHBvcnQgdGhlIG1vZGVsCmV4cG9ydF9wYXRoID0gJ2V4cG9ydGVkX21vZGVsLzEnCm1vZGVsLnNhdmUoZXhwb3J0X3BhdGgsIHNhdmVfZm9ybWF0PSd0Zicp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Assume you have a trained model
model = tf.keras.models.load_model('path_to_your_model')

# Export the model
export_path = 'exported_model/1'
model.save(export_path, save_format='tf')</pre></div><div class='content'></div><h2>Step 2: Start TensorFlow Serving</h2>
<div class='content'><p>Run the TensorFlow Serving container and mount the exported model directory:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZG9ja2VyIHJ1biAtcCA4NTAxOjg1MDEgLS1uYW1lPXRmX3NlcnZpbmcgXAogIC0tbW91bnQgdHlwZT1iaW5kLHNvdXJjZT0kKHB3ZCkvZXhwb3J0ZWRfbW9kZWwsdGFyZ2V0PS9tb2RlbHMvbXlfbW9kZWwgXAogIC1lIE1PREVMX05BTUU9bXlfbW9kZWwgLXQgdGVuc29yZmxvdy9zZXJ2aW5n"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>docker run -p 8501:8501 --name=tf_serving \
  --mount type=bind,source=$(pwd)/exported_model,target=/models/my_model \
  -e MODEL_NAME=my_model -t tensorflow/serving</pre></div><div class='content'></div><h2>Step 3: Make Predictions</h2>
<div class='content'><p>You can now make predictions by sending HTTP POST requests to the TensorFlow Serving API. Here’s an example using <code>curl</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y3VybCAtZCAneyJpbnN0YW5jZXMiOiBbWzEuMCwgMi4wLCA1LjBdXX0nIFwKICAtWCBQT1NUIGh0dHA6Ly9sb2NhbGhvc3Q6ODUwMS92MS9tb2RlbHMvbXlfbW9kZWw6cHJlZGljdA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>curl -d '{&quot;instances&quot;: [[1.0, 2.0, 5.0]]}' \
  -X POST http://localhost:8501/v1/models/my_model:predict</pre></div><div class='content'></div><h1>Practical Example</h1>
<div class='content'></div><h2>Exporting a Simple Model</h2>
<div class='content'><p>Let’s create and export a simple model for demonstration:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKaW1wb3J0IG51bXB5IGFzIG5wCgojIENyZWF0ZSBhIHNpbXBsZSBtb2RlbAptb2RlbCA9IHRmLmtlcmFzLlNlcXVlbnRpYWwoWwogICAgdGYua2VyYXMubGF5ZXJzLkRlbnNlKDEwLCBhY3RpdmF0aW9uPSdyZWx1JywgaW5wdXRfc2hhcGU9KDMsKSksCiAgICB0Zi5rZXJhcy5sYXllcnMuRGVuc2UoMSkKXSkKCiMgQ29tcGlsZSB0aGUgbW9kZWwKbW9kZWwuY29tcGlsZShvcHRpbWl6ZXI9J2FkYW0nLCBsb3NzPSdtZWFuX3NxdWFyZWRfZXJyb3InKQoKIyBHZW5lcmF0ZSBzb21lIGR1bW15IGRhdGEKZGF0YSA9IG5wLnJhbmRvbS5yYW5kKDEwMCwgMykKbGFiZWxzID0gbnAucmFuZG9tLnJhbmQoMTAwLCAxKQoKIyBUcmFpbiB0aGUgbW9kZWwKbW9kZWwuZml0KGRhdGEsIGxhYmVscywgZXBvY2hzPTUpCgojIEV4cG9ydCB0aGUgbW9kZWwKZXhwb3J0X3BhdGggPSAnZXhwb3J0ZWRfbW9kZWwvMScKbW9kZWwuc2F2ZShleHBvcnRfcGF0aCwgc2F2ZV9mb3JtYXQ9J3RmJyk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
import numpy as np

# Create a simple model
model = tf.keras.Sequential([
    tf.keras.layers.Dense(10, activation='relu', input_shape=(3,)),
    tf.keras.layers.Dense(1)
])

# Compile the model
model.compile(optimizer='adam', loss='mean_squared_error')

# Generate some dummy data
data = np.random.rand(100, 3)
labels = np.random.rand(100, 1)

# Train the model
model.fit(data, labels, epochs=5)

# Export the model
export_path = 'exported_model/1'
model.save(export_path, save_format='tf')</pre></div><div class='content'></div><h2>Serving the Model</h2>
<div class='content'><p>Run the TensorFlow Serving container:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZG9ja2VyIHJ1biAtcCA4NTAxOjg1MDEgLS1uYW1lPXRmX3NlcnZpbmcgXAogIC0tbW91bnQgdHlwZT1iaW5kLHNvdXJjZT0kKHB3ZCkvZXhwb3J0ZWRfbW9kZWwsdGFyZ2V0PS9tb2RlbHMvbXlfbW9kZWwgXAogIC1lIE1PREVMX05BTUU9bXlfbW9kZWwgLXQgdGVuc29yZmxvdy9zZXJ2aW5n"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>docker run -p 8501:8501 --name=tf_serving \
  --mount type=bind,source=$(pwd)/exported_model,target=/models/my_model \
  -e MODEL_NAME=my_model -t tensorflow/serving</pre></div><div class='content'></div><h2>Making Predictions</h2>
<div class='content'><p>Use <code>curl</code> to make a prediction:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y3VybCAtZCAneyJpbnN0YW5jZXMiOiBbWzAuMSwgMC4yLCAwLjNdXX0nIFwKICAtWCBQT1NUIGh0dHA6Ly9sb2NhbGhvc3Q6ODUwMS92MS9tb2RlbHMvbXlfbW9kZWw6cHJlZGljdA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>curl -d '{&quot;instances&quot;: [[0.1, 0.2, 0.3]]}' \
  -X POST http://localhost:8501/v1/models/my_model:predict</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Model Path</strong>: Ensure the model path is correctly specified when mounting the directory in Docker.</li>
<li><strong>Model Name</strong>: The <code>MODEL_NAME</code> environment variable should match the name used in the prediction request.</li>
<li><strong>Data Format</strong>: The input data format should match the model’s expected input shape.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, you learned how to set up TensorFlow Serving to deploy a TensorFlow model. You exported a trained model, started the TensorFlow Serving container, and made predictions using HTTP requests. TensorFlow Serving is a powerful tool for deploying machine learning models in production, providing features like model versioning, batching, and monitoring to ensure your models perform well in real-world scenarios.</p>
<p>Next, we will explore how to deploy models in various environments and monitor their performance.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='08-01-model-saving-and-loading' title="Model Saving and Loading">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='08-03-deploying-models' title="Deploying Models">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
