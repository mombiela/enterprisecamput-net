<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading Data</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/03-01-loading-data" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/03-01-loading-data" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/03-01-loading-data" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/tensorflow/03-01-loading-data" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/tensorflow/03-01-loading-data" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-eager-execution' title="Eager Execution">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Loading Data</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-02-data-pipelines-with-tf-data' title="Data Pipelines with tf.data">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to load data into TensorFlow. Proper data handling is crucial for training machine learning models effectively. We will cover various methods to load data, including loading from files, using TensorFlow Datasets, and handling different data formats.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Data Sources</strong>: Understanding where your data is coming from (e.g., CSV files, images, text).</li>
<li><strong>TensorFlow Datasets</strong>: Using <code>tf.data</code> API to create efficient data pipelines.</li>
<li><strong>Data Preprocessing</strong>: Preparing data for training (e.g., normalization, augmentation).</li>
</ol>
</div><h1>Loading Data from Files</h1>
<div class='content'></div><h2>Loading CSV Data</h2>
<div class='content'><p>CSV (Comma-Separated Values) files are a common format for storing tabular data. TensorFlow provides utilities to load and preprocess CSV data.</p>
<h4>Example: Loading CSV Data</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgRGVmaW5lIHRoZSBmaWxlIHBhdGgKZmlsZV9wYXRoID0gJ3BhdGgvdG8veW91ci9kYXRhLmNzdicKCiMgRGVmaW5lIHRoZSBjb2x1bW4gbmFtZXMgYW5kIHR5cGVzCmNvbHVtbl9uYW1lcyA9IFsnZmVhdHVyZTEnLCAnZmVhdHVyZTInLCAnbGFiZWwnXQpmZWF0dXJlX2NvbHVtbnMgPSBbJ2ZlYXR1cmUxJywgJ2ZlYXR1cmUyJ10KbGFiZWxfY29sdW1uID0gJ2xhYmVsJwoKIyBDcmVhdGUgYSBmdW5jdGlvbiB0byBwYXJzZSB0aGUgQ1NWIGZpbGUKZGVmIHBhcnNlX2NzdihsaW5lKToKICAgICMgRGVmaW5lIHRoZSBkZWZhdWx0IHZhbHVlcyBmb3IgZWFjaCBjb2x1bW4KICAgIGRlZmF1bHRzID0gW1swLjBdLCBbMC4wXSwgWzBdXQogICAgcGFyc2VkX2xpbmUgPSB0Zi5pby5kZWNvZGVfY3N2KGxpbmUsIGRlZmF1bHRzKQogICAgZmVhdHVyZXMgPSBkaWN0KHppcChjb2x1bW5fbmFtZXMsIHBhcnNlZF9saW5lKSkKICAgIGxhYmVsID0gZmVhdHVyZXMucG9wKGxhYmVsX2NvbHVtbikKICAgIHJldHVybiBmZWF0dXJlcywgbGFiZWwKCiMgQ3JlYXRlIGEgZGF0YXNldCBmcm9tIHRoZSBDU1YgZmlsZQpkYXRhc2V0ID0gdGYuZGF0YS5UZXh0TGluZURhdGFzZXQoZmlsZV9wYXRoKS5za2lwKDEpICAjIFNraXAgdGhlIGhlYWRlciByb3cKZGF0YXNldCA9IGRhdGFzZXQubWFwKHBhcnNlX2NzdikKCiMgSXRlcmF0ZSB0aHJvdWdoIHRoZSBkYXRhc2V0CmZvciBmZWF0dXJlcywgbGFiZWwgaW4gZGF0YXNldC50YWtlKDUpOgogICAgcHJpbnQoZidGZWF0dXJlczoge2ZlYXR1cmVzfSwgTGFiZWw6IHtsYWJlbH0nKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Define the file path
file_path = 'path/to/your/data.csv'

# Define the column names and types
column_names = ['feature1', 'feature2', 'label']
feature_columns = ['feature1', 'feature2']
label_column = 'label'

# Create a function to parse the CSV file
def parse_csv(line):
    # Define the default values for each column
    defaults = [[0.0], [0.0], [0]]
    parsed_line = tf.io.decode_csv(line, defaults)
    features = dict(zip(column_names, parsed_line))
    label = features.pop(label_column)
    return features, label

# Create a dataset from the CSV file
dataset = tf.data.TextLineDataset(file_path).skip(1)  # Skip the header row
dataset = dataset.map(parse_csv)

# Iterate through the dataset
for features, label in dataset.take(5):
    print(f'Features: {features}, Label: {label}')</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong><code>tf.data.TextLineDataset</code></strong>: Reads the CSV file line by line.</li>
<li><strong><code>skip(1)</code></strong>: Skips the header row.</li>
<li><strong><code>tf.io.decode_csv</code></strong>: Parses each line into a list of tensors.</li>
<li><strong><code>map(parse_csv)</code></strong>: Applies the <code>parse_csv</code> function to each line.</li>
</ul>
</div><h2>Loading Image Data</h2>
<div class='content'><p>Loading image data involves reading image files and converting them into tensors.</p>
<h4>Example: Loading Image Data</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgRGVmaW5lIHRoZSBmaWxlIHBhdGgKaW1hZ2VfZm9sZGVyX3BhdGggPSAncGF0aC90by95b3VyL2ltYWdlcy8nCgojIENyZWF0ZSBhIGZ1bmN0aW9uIHRvIGxvYWQgYW5kIHByZXByb2Nlc3MgaW1hZ2VzCmRlZiBsb2FkX2ltYWdlKGltYWdlX3BhdGgpOgogICAgaW1hZ2UgPSB0Zi5pby5yZWFkX2ZpbGUoaW1hZ2VfcGF0aCkKICAgIGltYWdlID0gdGYuaW1hZ2UuZGVjb2RlX2pwZWcoaW1hZ2UsIGNoYW5uZWxzPTMpCiAgICBpbWFnZSA9IHRmLmltYWdlLnJlc2l6ZShpbWFnZSwgWzEyOCwgMTI4XSkKICAgIGltYWdlID0gaW1hZ2UgLyAyNTUuMCAgIyBOb3JtYWxpemUgdG8gWzAsIDFdCiAgICByZXR1cm4gaW1hZ2UKCiMgQ3JlYXRlIGEgZGF0YXNldCBmcm9tIHRoZSBpbWFnZSBmaWxlIHBhdGhzCmltYWdlX3BhdGhzID0gdGYuZGF0YS5EYXRhc2V0Lmxpc3RfZmlsZXMoaW1hZ2VfZm9sZGVyX3BhdGggKyAnKi5qcGcnKQpkYXRhc2V0ID0gaW1hZ2VfcGF0aHMubWFwKGxvYWRfaW1hZ2UpCgojIEl0ZXJhdGUgdGhyb3VnaCB0aGUgZGF0YXNldApmb3IgaW1hZ2UgaW4gZGF0YXNldC50YWtlKDUpOgogICAgcHJpbnQoZidJbWFnZSBzaGFwZToge2ltYWdlLnNoYXBlfScp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Define the file path
image_folder_path = 'path/to/your/images/'

# Create a function to load and preprocess images
def load_image(image_path):
    image = tf.io.read_file(image_path)
    image = tf.image.decode_jpeg(image, channels=3)
    image = tf.image.resize(image, [128, 128])
    image = image / 255.0  # Normalize to [0, 1]
    return image

# Create a dataset from the image file paths
image_paths = tf.data.Dataset.list_files(image_folder_path + '*.jpg')
dataset = image_paths.map(load_image)

# Iterate through the dataset
for image in dataset.take(5):
    print(f'Image shape: {image.shape}')</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong><code>tf.io.read_file</code></strong>: Reads the image file.</li>
<li><strong><code>tf.image.decode_jpeg</code></strong>: Decodes the JPEG image.</li>
<li><strong><code>tf.image.resize</code></strong>: Resizes the image to the desired dimensions.</li>
<li><strong><code>tf.data.Dataset.list_files</code></strong>: Lists all image files in the specified folder.</li>
</ul>
</div><h1>Using TensorFlow Datasets</h1>
<div class='content'><p>TensorFlow Datasets (TFDS) is a collection of ready-to-use datasets for machine learning.</p>
</div><h2>Example: Using TensorFlow Datasets</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKaW1wb3J0IHRlbnNvcmZsb3dfZGF0YXNldHMgYXMgdGZkcwoKIyBMb2FkIHRoZSBNTklTVCBkYXRhc2V0CmRhdGFzZXQsIGluZm8gPSB0ZmRzLmxvYWQoJ21uaXN0Jywgd2l0aF9pbmZvPVRydWUsIGFzX3N1cGVydmlzZWQ9VHJ1ZSkKCiMgU3BsaXQgdGhlIGRhdGFzZXQgaW50byB0cmFpbmluZyBhbmQgdGVzdGluZyBzZXRzCnRyYWluX2RhdGFzZXQsIHRlc3RfZGF0YXNldCA9IGRhdGFzZXRbJ3RyYWluJ10sIGRhdGFzZXRbJ3Rlc3QnXQoKIyBQcmVwcm9jZXNzIHRoZSBkYXRhCmRlZiBwcmVwcm9jZXNzKGltYWdlLCBsYWJlbCk6CiAgICBpbWFnZSA9IHRmLmNhc3QoaW1hZ2UsIHRmLmZsb2F0MzIpIC8gMjU1LjAgICMgTm9ybWFsaXplIHRvIFswLCAxXQogICAgcmV0dXJuIGltYWdlLCBsYWJlbAoKdHJhaW5fZGF0YXNldCA9IHRyYWluX2RhdGFzZXQubWFwKHByZXByb2Nlc3MpLmJhdGNoKDMyKQp0ZXN0X2RhdGFzZXQgPSB0ZXN0X2RhdGFzZXQubWFwKHByZXByb2Nlc3MpLmJhdGNoKDMyKQoKIyBJdGVyYXRlIHRocm91Z2ggdGhlIGRhdGFzZXQKZm9yIGltYWdlcywgbGFiZWxzIGluIHRyYWluX2RhdGFzZXQudGFrZSgxKToKICAgIHByaW50KGYnSW1hZ2UgYmF0Y2ggc2hhcGU6IHtpbWFnZXMuc2hhcGV9JykKICAgIHByaW50KGYnTGFiZWwgYmF0Y2ggc2hhcGU6IHtsYWJlbHMuc2hhcGV9Jyk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
import tensorflow_datasets as tfds

# Load the MNIST dataset
dataset, info = tfds.load('mnist', with_info=True, as_supervised=True)

# Split the dataset into training and testing sets
train_dataset, test_dataset = dataset['train'], dataset['test']

# Preprocess the data
def preprocess(image, label):
    image = tf.cast(image, tf.float32) / 255.0  # Normalize to [0, 1]
    return image, label

train_dataset = train_dataset.map(preprocess).batch(32)
test_dataset = test_dataset.map(preprocess).batch(32)

# Iterate through the dataset
for images, labels in train_dataset.take(1):
    print(f'Image batch shape: {images.shape}')
    print(f'Label batch shape: {labels.shape}')</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong><code>tfds.load</code></strong>: Loads the specified dataset.</li>
<li><strong><code>with_info=True</code></strong>: Returns additional information about the dataset.</li>
<li><strong><code>as_supervised=True</code></strong>: Returns the dataset in a (image, label) format.</li>
<li><strong><code>map(preprocess)</code></strong>: Applies the <code>preprocess</code> function to each element.</li>
<li><strong><code>batch(32)</code></strong>: Batches the data into groups of 32.</li>
</ul>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Load and Preprocess CIFAR-10 Dataset</h2>
<div class='content'><ol>
<li>Load the CIFAR-10 dataset using TensorFlow Datasets.</li>
<li>Preprocess the images by normalizing them to the range [0, 1].</li>
<li>Batch the dataset with a batch size of 64.</li>
<li>Iterate through the dataset and print the shape of the image and label batches.</li>
</ol>
<h4>Solution</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKaW1wb3J0IHRlbnNvcmZsb3dfZGF0YXNldHMgYXMgdGZkcwoKIyBMb2FkIHRoZSBDSUZBUi0xMCBkYXRhc2V0CmRhdGFzZXQsIGluZm8gPSB0ZmRzLmxvYWQoJ2NpZmFyMTAnLCB3aXRoX2luZm89VHJ1ZSwgYXNfc3VwZXJ2aXNlZD1UcnVlKQoKIyBTcGxpdCB0aGUgZGF0YXNldCBpbnRvIHRyYWluaW5nIGFuZCB0ZXN0aW5nIHNldHMKdHJhaW5fZGF0YXNldCwgdGVzdF9kYXRhc2V0ID0gZGF0YXNldFsndHJhaW4nXSwgZGF0YXNldFsndGVzdCddCgojIFByZXByb2Nlc3MgdGhlIGRhdGEKZGVmIHByZXByb2Nlc3MoaW1hZ2UsIGxhYmVsKToKICAgIGltYWdlID0gdGYuY2FzdChpbWFnZSwgdGYuZmxvYXQzMikgLyAyNTUuMCAgIyBOb3JtYWxpemUgdG8gWzAsIDFdCiAgICByZXR1cm4gaW1hZ2UsIGxhYmVsCgp0cmFpbl9kYXRhc2V0ID0gdHJhaW5fZGF0YXNldC5tYXAocHJlcHJvY2VzcykuYmF0Y2goNjQpCnRlc3RfZGF0YXNldCA9IHRlc3RfZGF0YXNldC5tYXAocHJlcHJvY2VzcykuYmF0Y2goNjQpCgojIEl0ZXJhdGUgdGhyb3VnaCB0aGUgZGF0YXNldApmb3IgaW1hZ2VzLCBsYWJlbHMgaW4gdHJhaW5fZGF0YXNldC50YWtlKDEpOgogICAgcHJpbnQoZidJbWFnZSBiYXRjaCBzaGFwZToge2ltYWdlcy5zaGFwZX0nKQogICAgcHJpbnQoZidMYWJlbCBiYXRjaCBzaGFwZToge2xhYmVscy5zaGFwZX0nKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
import tensorflow_datasets as tfds

# Load the CIFAR-10 dataset
dataset, info = tfds.load('cifar10', with_info=True, as_supervised=True)

# Split the dataset into training and testing sets
train_dataset, test_dataset = dataset['train'], dataset['test']

# Preprocess the data
def preprocess(image, label):
    image = tf.cast(image, tf.float32) / 255.0  # Normalize to [0, 1]
    return image, label

train_dataset = train_dataset.map(preprocess).batch(64)
test_dataset = test_dataset.map(preprocess).batch(64)

# Iterate through the dataset
for images, labels in train_dataset.take(1):
    print(f'Image batch shape: {images.shape}')
    print(f'Label batch shape: {labels.shape}')</pre></div><div class='content'></div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>File Paths</strong>: Ensure the file paths are correct and accessible.</li>
<li><strong>Data Types</strong>: Be mindful of data types when preprocessing (e.g., converting to <code>tf.float32</code>).</li>
<li><strong>Batching</strong>: Always batch your data to improve training efficiency.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered various methods to load data into TensorFlow, including loading from CSV files, image files, and using TensorFlow Datasets. Proper data handling and preprocessing are essential steps in building effective machine learning models. In the next section, we will explore how to create efficient data pipelines using the <code>tf.data</code> API.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-eager-execution' title="Eager Execution">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-02-data-pipelines-with-tf-data' title="Data Pipelines with tf.data">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
