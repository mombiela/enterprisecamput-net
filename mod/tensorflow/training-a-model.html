<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Training a Model</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/training-a-model" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/training-a-model" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/training-a-model" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/tensorflow/training-a-model" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/tensorflow/training-a-model" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='loss-functions-and-optimizers'>&#x25C4;Loss Functions and Optimizers</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Training a Model</a>
	</div>
	<div class='col-4 text-end'>
					<a href='evaluating-a-model'>Evaluating a Model &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Training a model is a fundamental step in machine learning where the model learns from data. In TensorFlow, this involves defining a model, specifying a loss function, and using an optimizer to adjust the model's parameters to minimize the loss. This section will guide you through the process of training a model in TensorFlow, from basic concepts to advanced techniques.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Model</strong>: A mathematical representation of a real-world process. In TensorFlow, models are typically built using the <code>tf.keras</code> API.</li>
<li><strong>Loss Function</strong>: A function that measures how well the model's predictions match the actual data. Common loss functions include Mean Squared Error (MSE) for regression and Categorical Cross-Entropy for classification.</li>
<li><strong>Optimizer</strong>: An algorithm that adjusts the model's parameters to minimize the loss function. Popular optimizers include Stochastic Gradient Descent (SGD) and Adam.</li>
<li><strong>Epochs</strong>: The number of times the entire dataset is passed through the model during training.</li>
<li><strong>Batch Size</strong>: The number of samples processed before the model's parameters are updated.</li>
</ul>
</div><h1>Building a Simple Model</h1>
<div class='content'></div><h2>Step 1: Import Libraries</h2>
<div class='content'><p>First, import the necessary libraries.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLm1vZGVscyBpbXBvcnQgU2VxdWVudGlhbApmcm9tIHRlbnNvcmZsb3cua2VyYXMubGF5ZXJzIGltcG9ydCBEZW5zZQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense</pre></div><div class='content'></div><h2>Step 2: Define the Model</h2>
<div class='content'><p>Create a simple feedforward neural network using the <code>Sequential</code> API.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwgPSBTZXF1ZW50aWFsKFsKICAgIERlbnNlKDY0LCBhY3RpdmF0aW9uPSdyZWx1JywgaW5wdXRfc2hhcGU9KDc4NCwpKSwKICAgIERlbnNlKDY0LCBhY3RpdmF0aW9uPSdyZWx1JyksCiAgICBEZW5zZSgxMCwgYWN0aXZhdGlvbj0nc29mdG1heCcpCl0p"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model = Sequential([
    Dense(64, activation='relu', input_shape=(784,)),
    Dense(64, activation='relu'),
    Dense(10, activation='softmax')
])</pre></div><div class='content'><ul>
<li><strong>Dense Layer</strong>: A fully connected layer where each neuron is connected to every neuron in the previous layer.</li>
<li><strong>Activation Function</strong>: A function applied to the output of each neuron. Common choices include <code>relu</code> (Rectified Linear Unit) and <code>softmax</code>.</li>
</ul>
</div><h2>Step 3: Compile the Model</h2>
<div class='content'><p>Specify the loss function, optimizer, and metrics.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwuY29tcGlsZSgKICAgIG9wdGltaXplcj0nYWRhbScsCiAgICBsb3NzPSdzcGFyc2VfY2F0ZWdvcmljYWxfY3Jvc3NlbnRyb3B5JywKICAgIG1ldHJpY3M9WydhY2N1cmFjeSddCik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model.compile(
    optimizer='adam',
    loss='sparse_categorical_crossentropy',
    metrics=['accuracy']
)</pre></div><div class='content'><ul>
<li><strong>Optimizer</strong>: Adam is a popular choice for its efficiency and performance.</li>
<li><strong>Loss Function</strong>: <code>sparse_categorical_crossentropy</code> is used for multi-class classification problems.</li>
<li><strong>Metrics</strong>: Accuracy is a common metric for classification tasks.</li>
</ul>
</div><h2>Step 4: Train the Model</h2>
<div class='content'><p>Use the <code>fit</code> method to train the model.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aGlzdG9yeSA9IG1vZGVsLmZpdCgKICAgIHhfdHJhaW4sIHlfdHJhaW4sCiAgICBlcG9jaHM9MTAsCiAgICBiYXRjaF9zaXplPTMyLAogICAgdmFsaWRhdGlvbl9zcGxpdD0wLjIKKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>history = model.fit(
    x_train, y_train,
    epochs=10,
    batch_size=32,
    validation_split=0.2
)</pre></div><div class='content'><ul>
<li><strong>x_train</strong> and <strong>y_train</strong>: Training data and labels.</li>
<li><strong>epochs</strong>: Number of times the model will iterate over the entire dataset.</li>
<li><strong>batch_size</strong>: Number of samples per gradient update.</li>
<li><strong>validation_split</strong>: Fraction of the training data to be used as validation data.</li>
</ul>
</div><h1>Advanced Techniques</h1>
<div class='content'></div><h2>Early Stopping</h2>
<div class='content'><p>Prevent overfitting by stopping training when the validation loss stops improving.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmNhbGxiYWNrcyBpbXBvcnQgRWFybHlTdG9wcGluZwoKZWFybHlfc3RvcHBpbmcgPSBFYXJseVN0b3BwaW5nKAogICAgbW9uaXRvcj0ndmFsX2xvc3MnLAogICAgcGF0aWVuY2U9MywKICAgIHJlc3RvcmVfYmVzdF93ZWlnaHRzPVRydWUKKQoKaGlzdG9yeSA9IG1vZGVsLmZpdCgKICAgIHhfdHJhaW4sIHlfdHJhaW4sCiAgICBlcG9jaHM9NTAsCiAgICBiYXRjaF9zaXplPTMyLAogICAgdmFsaWRhdGlvbl9zcGxpdD0wLjIsCiAgICBjYWxsYmFja3M9W2Vhcmx5X3N0b3BwaW5nXQop"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from tensorflow.keras.callbacks import EarlyStopping

early_stopping = EarlyStopping(
    monitor='val_loss',
    patience=3,
    restore_best_weights=True
)

history = model.fit(
    x_train, y_train,
    epochs=50,
    batch_size=32,
    validation_split=0.2,
    callbacks=[early_stopping]
)</pre></div><div class='content'></div><h2>Learning Rate Schedules</h2>
<div class='content'><p>Adjust the learning rate during training to improve convergence.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmNhbGxiYWNrcyBpbXBvcnQgTGVhcm5pbmdSYXRlU2NoZWR1bGVyCgpkZWYgc2NoZWR1bGVyKGVwb2NoLCBscik6CiAgICBpZiBlcG9jaCA8IDEwOgogICAgICAgIHJldHVybiBscgogICAgZWxzZToKICAgICAgICByZXR1cm4gbHIgKiB0Zi5tYXRoLmV4cCgtMC4xKQoKbHJfc2NoZWR1bGVyID0gTGVhcm5pbmdSYXRlU2NoZWR1bGVyKHNjaGVkdWxlcikKCmhpc3RvcnkgPSBtb2RlbC5maXQoCiAgICB4X3RyYWluLCB5X3RyYWluLAogICAgZXBvY2hzPTUwLAogICAgYmF0Y2hfc2l6ZT0zMiwKICAgIHZhbGlkYXRpb25fc3BsaXQ9MC4yLAogICAgY2FsbGJhY2tzPVtscl9zY2hlZHVsZXJdCik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from tensorflow.keras.callbacks import LearningRateScheduler

def scheduler(epoch, lr):
    if epoch &lt; 10:
        return lr
    else:
        return lr * tf.math.exp(-0.1)

lr_scheduler = LearningRateScheduler(scheduler)

history = model.fit(
    x_train, y_train,
    epochs=50,
    batch_size=32,
    validation_split=0.2,
    callbacks=[lr_scheduler]
)</pre></div><div class='content'></div><h2>Model Checkpointing</h2>
<div class='content'><p>Save the model at various stages during training.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmNhbGxiYWNrcyBpbXBvcnQgTW9kZWxDaGVja3BvaW50CgpjaGVja3BvaW50ID0gTW9kZWxDaGVja3BvaW50KAogICAgJ2Jlc3RfbW9kZWwuaDUnLAogICAgbW9uaXRvcj0ndmFsX2xvc3MnLAogICAgc2F2ZV9iZXN0X29ubHk9VHJ1ZQopCgpoaXN0b3J5ID0gbW9kZWwuZml0KAogICAgeF90cmFpbiwgeV90cmFpbiwKICAgIGVwb2Nocz01MCwKICAgIGJhdGNoX3NpemU9MzIsCiAgICB2YWxpZGF0aW9uX3NwbGl0PTAuMiwKICAgIGNhbGxiYWNrcz1bY2hlY2twb2ludF0KKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from tensorflow.keras.callbacks import ModelCheckpoint

checkpoint = ModelCheckpoint(
    'best_model.h5',
    monitor='val_loss',
    save_best_only=True
)

history = model.fit(
    x_train, y_train,
    epochs=50,
    batch_size=32,
    validation_split=0.2,
    callbacks=[checkpoint]
)</pre></div><div class='content'></div><h1>Summary</h1>
<div class='content'><p>Training a model in TensorFlow involves defining the model architecture, compiling it with a loss function and optimizer, and then fitting it to the data. Advanced techniques like early stopping, learning rate schedules, and model checkpointing can help improve performance and prevent overfitting. By mastering these concepts, you can build and train robust machine learning models using TensorFlow.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='loss-functions-and-optimizers'>&#x25C4;Loss Functions and Optimizers</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Training a Model</a>
	</div>
	<div class='col-4 text-end'>
					<a href='evaluating-a-model'>Evaluating a Model &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
