<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction to CNNs</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/05-01-introduction-to-cnns" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/05-01-introduction-to-cnns" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/05-01-introduction-to-cnns" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/tensorflow/05-01-introduction-to-cnns" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/tensorflow/05-01-introduction-to-cnns" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-04-loss-functions-and-optimizers' title="Loss Functions and Optimizers">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Introduction to CNNs</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-02-building-a-cnn' title="Building a CNN">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Convolutional Neural Networks (CNNs) are a class of deep neural networks that have proven highly effective for tasks involving image and video recognition, classification, and processing. CNNs are designed to automatically and adaptively learn spatial hierarchies of features from input images.</p>
</div><h1>Key Concepts</h1>
<div class='content'></div><h2>1. Convolutional Layers</h2>
<div class='content'><ul>
<li><strong>Convolution Operation</strong>: The core building block of a CNN. It involves a filter (or kernel) sliding over the input data to produce a feature map.</li>
<li><strong>Filters/Kernels</strong>: Small matrices that slide over the input data to detect specific features such as edges, textures, or patterns.</li>
<li><strong>Stride</strong>: The number of pixels by which the filter moves over the input matrix.</li>
<li><strong>Padding</strong>: Adding extra pixels around the input matrix to control the spatial size of the output feature map.</li>
</ul>
</div><h2>2. Pooling Layers</h2>
<div class='content'><ul>
<li><strong>Purpose</strong>: To reduce the spatial dimensions (width and height) of the input volume, which helps in reducing the computational load and controlling overfitting.</li>
<li><strong>Types</strong>: Max pooling and average pooling are the most common types.</li>
</ul>
</div><h2>3. Fully Connected Layers</h2>
<div class='content'><ul>
<li><strong>Function</strong>: These layers are used at the end of the network to combine the features learned by convolutional and pooling layers to make final predictions.</li>
</ul>
</div><h2>4. Activation Functions</h2>
<div class='content'><ul>
<li><strong>ReLU (Rectified Linear Unit)</strong>: The most commonly used activation function in CNNs, which introduces non-linearity into the model.</li>
</ul>
</div><h1>Practical Example: Building a Simple CNN</h1>
<div class='content'><p>Let's build a simple CNN using TensorFlow and Keras to classify images from the CIFAR-10 dataset.</p>
</div><h2>Step-by-Step Code Example</h2>
<div class='content'><ol>
<li><strong>Import Libraries</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzIGltcG9ydCBsYXllcnMsIG1vZGVscwppbXBvcnQgbWF0cGxvdGxpYi5weXBsb3QgYXMgcGx0"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras import layers, models
import matplotlib.pyplot as plt</pre></div><div class='content'><ol start="2">
<li><strong>Load and Preprocess Data</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMb2FkIENJRkFSLTEwIGRhdGFzZXQKKHRyYWluX2ltYWdlcywgdHJhaW5fbGFiZWxzKSwgKHRlc3RfaW1hZ2VzLCB0ZXN0X2xhYmVscykgPSB0Zi5rZXJhcy5kYXRhc2V0cy5jaWZhcjEwLmxvYWRfZGF0YSgpCgojIE5vcm1hbGl6ZSBwaXhlbCB2YWx1ZXMgdG8gYmUgYmV0d2VlbiAwIGFuZCAxCnRyYWluX2ltYWdlcywgdGVzdF9pbWFnZXMgPSB0cmFpbl9pbWFnZXMgLyAyNTUuMCwgdGVzdF9pbWFnZXMgLyAyNTUuMA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Load CIFAR-10 dataset
(train_images, train_labels), (test_images, test_labels) = tf.keras.datasets.cifar10.load_data()

# Normalize pixel values to be between 0 and 1
train_images, test_images = train_images / 255.0, test_images / 255.0</pre></div><div class='content'><ol start="3">
<li><strong>Define the CNN Model</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwgPSBtb2RlbHMuU2VxdWVudGlhbChbCiAgICBsYXllcnMuQ29udjJEKDMyLCAoMywgMyksIGFjdGl2YXRpb249J3JlbHUnLCBpbnB1dF9zaGFwZT0oMzIsIDMyLCAzKSksCiAgICBsYXllcnMuTWF4UG9vbGluZzJEKCgyLCAyKSksCiAgICBsYXllcnMuQ29udjJEKDY0LCAoMywgMyksIGFjdGl2YXRpb249J3JlbHUnKSwKICAgIGxheWVycy5NYXhQb29saW5nMkQoKDIsIDIpKSwKICAgIGxheWVycy5Db252MkQoNjQsICgzLCAzKSwgYWN0aXZhdGlvbj0ncmVsdScpLAogICAgbGF5ZXJzLkZsYXR0ZW4oKSwKICAgIGxheWVycy5EZW5zZSg2NCwgYWN0aXZhdGlvbj0ncmVsdScpLAogICAgbGF5ZXJzLkRlbnNlKDEwKQpdKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model = models.Sequential([
    layers.Conv2D(32, (3, 3), activation='relu', input_shape=(32, 32, 3)),
    layers.MaxPooling2D((2, 2)),
    layers.Conv2D(64, (3, 3), activation='relu'),
    layers.MaxPooling2D((2, 2)),
    layers.Conv2D(64, (3, 3), activation='relu'),
    layers.Flatten(),
    layers.Dense(64, activation='relu'),
    layers.Dense(10)
])</pre></div><div class='content'><ol start="4">
<li><strong>Compile the Model</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwuY29tcGlsZShvcHRpbWl6ZXI9J2FkYW0nLAogICAgICAgICAgICAgIGxvc3M9dGYua2VyYXMubG9zc2VzLlNwYXJzZUNhdGVnb3JpY2FsQ3Jvc3NlbnRyb3B5KGZyb21fbG9naXRzPVRydWUpLAogICAgICAgICAgICAgIG1ldHJpY3M9WydhY2N1cmFjeSddKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model.compile(optimizer='adam',
              loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True),
              metrics=['accuracy'])</pre></div><div class='content'><ol start="5">
<li><strong>Train the Model</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aGlzdG9yeSA9IG1vZGVsLmZpdCh0cmFpbl9pbWFnZXMsIHRyYWluX2xhYmVscywgZXBvY2hzPTEwLCAKICAgICAgICAgICAgICAgICAgICB2YWxpZGF0aW9uX2RhdGE9KHRlc3RfaW1hZ2VzLCB0ZXN0X2xhYmVscykp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>history = model.fit(train_images, train_labels, epochs=10, 
                    validation_data=(test_images, test_labels))</pre></div><div class='content'><ol start="6">
<li><strong>Evaluate the Model</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dGVzdF9sb3NzLCB0ZXN0X2FjYyA9IG1vZGVsLmV2YWx1YXRlKHRlc3RfaW1hZ2VzLCB0ZXN0X2xhYmVscywgdmVyYm9zZT0yKQpwcmludChmJ1xuVGVzdCBhY2N1cmFjeToge3Rlc3RfYWNjfScp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>test_loss, test_acc = model.evaluate(test_images, test_labels, verbose=2)
print(f'\nTest accuracy: {test_acc}')</pre></div><div class='content'></div><h2>Explanation of the Code</h2>
<div class='content'><ul>
<li><strong>Convolutional Layers</strong>: The model starts with three convolutional layers with ReLU activation functions. The first layer has 32 filters, and the next two have 64 filters each.</li>
<li><strong>Pooling Layers</strong>: After each convolutional layer, a max pooling layer is used to reduce the spatial dimensions.</li>
<li><strong>Flatten Layer</strong>: This layer flattens the 3D output to 1D, making it suitable for the fully connected layers.</li>
<li><strong>Fully Connected Layers</strong>: The model ends with two dense layers, the first with 64 units and ReLU activation, and the second with 10 units (one for each class in CIFAR-10).</li>
</ul>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Modify the CNN</h2>
<div class='content'><p>Modify the above CNN to include an additional convolutional layer and observe the impact on the model's performance.</p>
<ol>
<li><strong>Add an Additional Convolutional Layer</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwgPSBtb2RlbHMuU2VxdWVudGlhbChbCiAgICBsYXllcnMuQ29udjJEKDMyLCAoMywgMyksIGFjdGl2YXRpb249J3JlbHUnLCBpbnB1dF9zaGFwZT0oMzIsIDMyLCAzKSksCiAgICBsYXllcnMuTWF4UG9vbGluZzJEKCgyLCAyKSksCiAgICBsYXllcnMuQ29udjJEKDY0LCAoMywgMyksIGFjdGl2YXRpb249J3JlbHUnKSwKICAgIGxheWVycy5NYXhQb29saW5nMkQoKDIsIDIpKSwKICAgIGxheWVycy5Db252MkQoNjQsICgzLCAzKSwgYWN0aXZhdGlvbj0ncmVsdScpLAogICAgbGF5ZXJzLk1heFBvb2xpbmcyRCgoMiwgMikpLCAgIyBOZXcgcG9vbGluZyBsYXllcgogICAgbGF5ZXJzLkNvbnYyRCgxMjgsICgzLCAzKSwgYWN0aXZhdGlvbj0ncmVsdScpLCAgIyBOZXcgY29udm9sdXRpb25hbCBsYXllcgogICAgbGF5ZXJzLkZsYXR0ZW4oKSwKICAgIGxheWVycy5EZW5zZSg2NCwgYWN0aXZhdGlvbj0ncmVsdScpLAogICAgbGF5ZXJzLkRlbnNlKDEwKQpdKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model = models.Sequential([
    layers.Conv2D(32, (3, 3), activation='relu', input_shape=(32, 32, 3)),
    layers.MaxPooling2D((2, 2)),
    layers.Conv2D(64, (3, 3), activation='relu'),
    layers.MaxPooling2D((2, 2)),
    layers.Conv2D(64, (3, 3), activation='relu'),
    layers.MaxPooling2D((2, 2)),  # New pooling layer
    layers.Conv2D(128, (3, 3), activation='relu'),  # New convolutional layer
    layers.Flatten(),
    layers.Dense(64, activation='relu'),
    layers.Dense(10)
])</pre></div><div class='content'><ol start="2">
<li><strong>Compile, Train, and Evaluate the Model</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwuY29tcGlsZShvcHRpbWl6ZXI9J2FkYW0nLAogICAgICAgICAgICAgIGxvc3M9dGYua2VyYXMubG9zc2VzLlNwYXJzZUNhdGVnb3JpY2FsQ3Jvc3NlbnRyb3B5KGZyb21fbG9naXRzPVRydWUpLAogICAgICAgICAgICAgIG1ldHJpY3M9WydhY2N1cmFjeSddKQoKaGlzdG9yeSA9IG1vZGVsLmZpdCh0cmFpbl9pbWFnZXMsIHRyYWluX2xhYmVscywgZXBvY2hzPTEwLCAKICAgICAgICAgICAgICAgICAgICB2YWxpZGF0aW9uX2RhdGE9KHRlc3RfaW1hZ2VzLCB0ZXN0X2xhYmVscykpCgp0ZXN0X2xvc3MsIHRlc3RfYWNjID0gbW9kZWwuZXZhbHVhdGUodGVzdF9pbWFnZXMsIHRlc3RfbGFiZWxzLCB2ZXJib3NlPTIpCnByaW50KGYnXG5UZXN0IGFjY3VyYWN5OiB7dGVzdF9hY2N9Jyk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model.compile(optimizer='adam',
              loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True),
              metrics=['accuracy'])

history = model.fit(train_images, train_labels, epochs=10, 
                    validation_data=(test_images, test_labels))

test_loss, test_acc = model.evaluate(test_images, test_labels, verbose=2)
print(f'\nTest accuracy: {test_acc}')</pre></div><div class='content'></div><h2>Solution Explanation</h2>
<div class='content'><p>By adding an additional convolutional layer, the model can learn more complex features from the input images. This might improve the model's accuracy, but it could also increase the risk of overfitting if not managed properly.</p>
</div><h1>Summary</h1>
<div class='content'><p>In this section, we introduced Convolutional Neural Networks (CNNs) and their key components, including convolutional layers, pooling layers, and fully connected layers. We also provided a practical example of building a simple CNN using TensorFlow and Keras, along with an exercise to modify the CNN for better understanding. This foundation prepares you for more advanced topics in CNNs, such as pooling layers and advanced architectures, which will be covered in the next sections.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-04-loss-functions-and-optimizers' title="Loss Functions and Optimizers">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-02-building-a-cnn' title="Building a CNN">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
