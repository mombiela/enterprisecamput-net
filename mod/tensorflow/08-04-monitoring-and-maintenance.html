<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitoring and Maintenance</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/08-04-monitoring-and-maintenance" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/08-04-monitoring-and-maintenance" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/08-04-monitoring-and-maintenance" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/tensorflow/08-04-monitoring-and-maintenance" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/tensorflow/08-04-monitoring-and-maintenance" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='08-03-deploying-models' title="Deploying Models">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Monitoring and Maintenance</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='09-01-introduction-to-tfx' title="Introduction to TFX">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will cover the essential practices and tools for monitoring and maintaining TensorFlow models in production. Ensuring that your models perform well over time and can be updated or retrained as needed is crucial for the success of any machine learning project.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Model Monitoring</strong>: Keeping track of the model's performance metrics in real-time to detect any degradation or anomalies.</li>
<li><strong>Model Maintenance</strong>: Regularly updating and retraining the model to ensure it remains accurate and relevant.</li>
<li><strong>Alerting Systems</strong>: Setting up alerts to notify you when the model's performance drops below a certain threshold.</li>
<li><strong>Logging</strong>: Recording detailed logs of model predictions, errors, and other relevant information for debugging and analysis.</li>
<li><strong>Versioning</strong>: Keeping track of different versions of the model to manage updates and rollbacks effectively.</li>
</ol>
</div><h1><p>Monitoring Model Performance</p>
</h1>
<div class='content'></div><h2><p>Metrics to Monitor</p>
</h2>
<div class='content'><ul>
<li><strong>Accuracy</strong>: The percentage of correct predictions.</li>
<li><strong>Precision and Recall</strong>: Metrics for evaluating classification models.</li>
<li><strong>F1 Score</strong>: The harmonic mean of precision and recall.</li>
<li><strong>AUC-ROC</strong>: Area Under the Receiver Operating Characteristic Curve.</li>
<li><strong>Latency</strong>: The time taken for the model to make a prediction.</li>
<li><strong>Throughput</strong>: The number of predictions made per unit time.</li>
</ul>
</div><h2><p>Tools for Monitoring</p>
</h2>
<div class='content'><ul>
<li><strong>TensorBoard</strong>: A suite of visualization tools for TensorFlow.</li>
<li><strong>Prometheus</strong>: An open-source monitoring and alerting toolkit.</li>
<li><strong>Grafana</strong>: An open-source platform for monitoring and observability.</li>
</ul>
</div><h2><p>Example: Setting Up TensorBoard</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmNhbGxiYWNrcyBpbXBvcnQgVGVuc29yQm9hcmQKCiMgRGVmaW5lIGEgc2ltcGxlIG1vZGVsCm1vZGVsID0gdGYua2VyYXMubW9kZWxzLlNlcXVlbnRpYWwoWwogICAgdGYua2VyYXMubGF5ZXJzLkRlbnNlKDEyOCwgYWN0aXZhdGlvbj0ncmVsdScsIGlucHV0X3NoYXBlPSg3ODQsKSksCiAgICB0Zi5rZXJhcy5sYXllcnMuRGVuc2UoMTAsIGFjdGl2YXRpb249J3NvZnRtYXgnKQpdKQoKbW9kZWwuY29tcGlsZShvcHRpbWl6ZXI9J2FkYW0nLAogICAgICAgICAgICAgIGxvc3M9J3NwYXJzZV9jYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLAogICAgICAgICAgICAgIG1ldHJpY3M9WydhY2N1cmFjeSddKQoKIyBTZXQgdXAgVGVuc29yQm9hcmQgY2FsbGJhY2sKdGVuc29yYm9hcmRfY2FsbGJhY2sgPSBUZW5zb3JCb2FyZChsb2dfZGlyPScuL2xvZ3MnLCBoaXN0b2dyYW1fZnJlcT0xKQoKIyBUcmFpbiB0aGUgbW9kZWwKbW9kZWwuZml0KHhfdHJhaW4sIHlfdHJhaW4sIGVwb2Nocz01LCB2YWxpZGF0aW9uX2RhdGE9KHhfdmFsLCB5X3ZhbCksIGNhbGxiYWNrcz1bdGVuc29yYm9hcmRfY2FsbGJhY2tdKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras.callbacks import TensorBoard

# Define a simple model
model = tf.keras.models.Sequential([
    tf.keras.layers.Dense(128, activation='relu', input_shape=(784,)),
    tf.keras.layers.Dense(10, activation='softmax')
])

model.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])

# Set up TensorBoard callback
tensorboard_callback = TensorBoard(log_dir='./logs', histogram_freq=1)

# Train the model
model.fit(x_train, y_train, epochs=5, validation_data=(x_val, y_val), callbacks=[tensorboard_callback])</pre></div><div class='content'></div><h2><p>Viewing TensorBoard</p>
</h2>
<div class='content'><ol>
<li>Run the following command in your terminal:
<pre><code class="language-bash">tensorboard --logdir=./logs
</code></pre>
</li>
<li>Open your web browser and go to <code>http://localhost:6006/</code>.</li>
</ol>
</div><h1><p>Setting Up Alerts</p>
</h1>
<div class='content'></div><h2><p>Example: Using Prometheus and Grafana</p>
</h2>
<div class='content'><ol>
<li><strong>Install Prometheus and Grafana</strong>: Follow the installation instructions on their respective websites.</li>
<li><strong>Configure Prometheus</strong>: Set up Prometheus to scrape metrics from your TensorFlow model.</li>
<li><strong>Create Grafana Dashboards</strong>: Use Grafana to visualize the metrics and set up alerts.</li>
</ol>
</div><h1><p>Logging</p>
</h1>
<div class='content'></div><h2><p>Example: Using Python's Logging Module</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGxvZ2dpbmcKCiMgQ29uZmlndXJlIGxvZ2dpbmcKbG9nZ2luZy5iYXNpY0NvbmZpZyhmaWxlbmFtZT0nbW9kZWxfbG9ncy5sb2cnLCBsZXZlbD1sb2dnaW5nLklORk8pCgojIExvZyBtb2RlbCBwcmVkaWN0aW9ucwpkZWYgbG9nX3ByZWRpY3Rpb25zKHByZWRpY3Rpb25zKToKICAgIGZvciBwcmVkaWN0aW9uIGluIHByZWRpY3Rpb25zOgogICAgICAgIGxvZ2dpbmcuaW5mbyhmJ1ByZWRpY3Rpb246IHtwcmVkaWN0aW9ufScpCgojIEV4YW1wbGUgdXNhZ2UKcHJlZGljdGlvbnMgPSBtb2RlbC5wcmVkaWN0KHhfdGVzdCkKbG9nX3ByZWRpY3Rpb25zKHByZWRpY3Rpb25zKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import logging

# Configure logging
logging.basicConfig(filename='model_logs.log', level=logging.INFO)

# Log model predictions
def log_predictions(predictions):
    for prediction in predictions:
        logging.info(f'Prediction: {prediction}')

# Example usage
predictions = model.predict(x_test)
log_predictions(predictions)</pre></div><div class='content'></div><h1><p>Model Versioning</p>
</h1>
<div class='content'></div><h2><p>Example: Using TensorFlow Serving</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Save the Model</strong>:</p>
<pre><code class="language-python">model.save('my_model/1/')
</code></pre>
</li>
<li>
<p><strong>Serve the Model</strong>:</p>
<pre><code class="language-bash">tensorflow_model_server --rest_api_port=8501 --model_name=my_model --model_base_path=&quot;/path/to/my_model&quot;
</code></pre>
</li>
<li>
<p><strong>Update the Model</strong>: Save the new version of the model in a new directory (e.g., <code>my_model/2/</code>) and TensorFlow Serving will automatically pick it up.</p>
</li>
</ol>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Monitor and Maintain a TensorFlow Model</p>
</h2>
<div class='content'><ol>
<li><strong>Train a Simple Model</strong>: Use the provided code to train a simple neural network.</li>
<li><strong>Set Up TensorBoard</strong>: Configure TensorBoard to monitor the training process.</li>
<li><strong>Log Predictions</strong>: Implement logging for model predictions.</li>
<li><strong>Set Up Alerts</strong>: Use Prometheus and Grafana to set up alerts for model performance.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Train a Simple Model</strong>:</p>
<pre><code class="language-python">import tensorflow as tf
from tensorflow.keras.callbacks import TensorBoard

model = tf.keras.models.Sequential([
    tf.keras.layers.Dense(128, activation='relu', input_shape=(784,)),
    tf.keras.layers.Dense(10, activation='softmax')
])

model.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])

tensorboard_callback = TensorBoard(log_dir='./logs', histogram_freq=1)
model.fit(x_train, y_train, epochs=5, validation_data=(x_val, y_val), callbacks=[tensorboard_callback])
</code></pre>
</li>
<li>
<p><strong>Set Up TensorBoard</strong>:</p>
<pre><code class="language-bash">tensorboard --logdir=./logs
</code></pre>
</li>
<li>
<p><strong>Log Predictions</strong>:</p>
<pre><code class="language-python">import logging

logging.basicConfig(filename='model_logs.log', level=logging.INFO)

def log_predictions(predictions):
    for prediction in predictions:
        logging.info(f'Prediction: {prediction}')

predictions = model.predict(x_test)
log_predictions(predictions)
</code></pre>
</li>
<li>
<p><strong>Set Up Alerts</strong>: Follow the Prometheus and Grafana setup instructions to create dashboards and alerts.</p>
</li>
</ol>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered the essential practices for monitoring and maintaining TensorFlow models in production. We discussed key metrics to monitor, tools for visualization and alerting, and best practices for logging and versioning. By implementing these practices, you can ensure that your models remain accurate and reliable over time.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='08-03-deploying-models' title="Deploying Models">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='09-01-introduction-to-tfx' title="Introduction to TFX">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
