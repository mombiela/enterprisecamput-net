<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Queue Storage in Azure</title>

    <link rel="alternate" href="https://campusempresa.com/mod/azure/queue-storage" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/azure/queue-storage" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/azure/queue-storage" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/azure/queue-storage" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/azure/queue-storage" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='table-storage'>&#x25C4;Table Storage</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Queue Storage in Azure</a>
	</div>
	<div class='col-4 text-end'>
					<a href='managing-and-securing-storage'>Managing and Securing Storage &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Azure Queue Storage is a service for storing large numbers of messages that can be accessed from anywhere in the world via authenticated calls using HTTP or HTTPS. This topic will guide you from the basics to advanced concepts of Azure Queue Storage.</p>
</div><h1>Introduction to Azure Queue Storage</h1>
<div class='content'><p>Azure Queue Storage is designed to enable communication between different components of a cloud application. It allows you to store and retrieve messages, ensuring that your application can scale and remain responsive.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Queue</strong>: A queue contains a set of messages. Each message can be up to 64 KB in size.</li>
<li><strong>Message</strong>: A message is the data that is stored in a queue. Messages are typically text but can be any type of data.</li>
<li><strong>Visibility Timeout</strong>: The time period during which a message is invisible to other consumers after being retrieved.</li>
<li><strong>Poison Messages</strong>: Messages that cannot be processed successfully after multiple attempts.</li>
</ul>
</div><h1>Setting Up Azure Queue Storage</h1>
<div class='content'></div><h2>Prerequisites</h2>
<div class='content'><ul>
<li>An Azure account. If you don't have one, you can create a free account at <a href="https://azure.microsoft.com/free/">Azure Free Account</a>.</li>
</ul>
</div><h2>Creating a Queue Storage Account</h2>
<div class='content'><ol>
<li>
<p><strong>Log in to the Azure Portal</strong>.</p>
</li>
<li>
<p><strong>Create a Storage Account</strong>:</p>
<ul>
<li>Navigate to &quot;Storage accounts&quot; and click &quot;Create&quot;.</li>
<li>Fill in the necessary details such as Subscription, Resource Group, Storage Account Name, and Location.</li>
<li>Choose the &quot;Standard&quot; performance tier and &quot;StorageV2 (general-purpose v2)&quot; for the account kind.</li>
<li>Click &quot;Review + create&quot; and then &quot;Create&quot;.</li>
</ul>
</li>
<li>
<p><strong>Create a Queue</strong>:</p>
<ul>
<li>Go to your newly created storage account.</li>
<li>Under &quot;Data storage&quot;, select &quot;Queues&quot;.</li>
<li>Click &quot;+ Queue&quot; and provide a name for your queue.</li>
<li>Click &quot;OK&quot; to create the queue.</li>
</ul>
</li>
</ol>
</div><h1>Working with Azure Queue Storage</h1>
<div class='content'></div><h2>Adding Messages to a Queue</h2>
<div class='content'><p>To add messages to a queue, you can use the Azure Storage SDKs or REST API. Below is an example using the Azure SDK for Python.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBhenVyZS5zdG9yYWdlLnF1ZXVlIGltcG9ydCBRdWV1ZVNlcnZpY2VDbGllbnQKCiMgQ3JlYXRlIGEgUXVldWVTZXJ2aWNlQ2xpZW50CnF1ZXVlX3NlcnZpY2VfY2xpZW50ID0gUXVldWVTZXJ2aWNlQ2xpZW50LmZyb21fY29ubmVjdGlvbl9zdHJpbmcoInlvdXJfY29ubmVjdGlvbl9zdHJpbmciKQoKIyBHZXQgYSBRdWV1ZUNsaWVudApxdWV1ZV9jbGllbnQgPSBxdWV1ZV9zZXJ2aWNlX2NsaWVudC5nZXRfcXVldWVfY2xpZW50KCJ5b3VyX3F1ZXVlX25hbWUiKQoKIyBBZGQgYSBtZXNzYWdlIHRvIHRoZSBxdWV1ZQpxdWV1ZV9jbGllbnQuc2VuZF9tZXNzYWdlKCJIZWxsbywgQXp1cmUgUXVldWUgU3RvcmFnZSEiKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from azure.storage.queue import QueueServiceClient

# Create a QueueServiceClient
queue_service_client = QueueServiceClient.from_connection_string(&quot;your_connection_string&quot;)

# Get a QueueClient
queue_client = queue_service_client.get_queue_client(&quot;your_queue_name&quot;)

# Add a message to the queue
queue_client.send_message(&quot;Hello, Azure Queue Storage!&quot;)</pre></div><div class='content'></div><h2>Retrieving Messages from a Queue</h2>
<div class='content'><p>To retrieve messages, you can use the <code>receive_messages</code> method. Here is an example in Python:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSZXRyaWV2ZSBtZXNzYWdlcyBmcm9tIHRoZSBxdWV1ZQptZXNzYWdlcyA9IHF1ZXVlX2NsaWVudC5yZWNlaXZlX21lc3NhZ2VzKCkKCmZvciBtZXNzYWdlIGluIG1lc3NhZ2VzOgogICAgcHJpbnQoZiJNZXNzYWdlOiB7bWVzc2FnZS5jb250ZW50fSIpCiAgICAjIERlbGV0ZSB0aGUgbWVzc2FnZSBhZnRlciBwcm9jZXNzaW5nCiAgICBxdWV1ZV9jbGllbnQuZGVsZXRlX21lc3NhZ2UobWVzc2FnZSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Retrieve messages from the queue
messages = queue_client.receive_messages()

for message in messages:
    print(f&quot;Message: {message.content}&quot;)
    # Delete the message after processing
    queue_client.delete_message(message)</pre></div><div class='content'></div><h2>Handling Visibility Timeout</h2>
<div class='content'><p>When a message is retrieved, it becomes invisible to other consumers for a specified period (visibility timeout). If the message is not deleted within this period, it becomes visible again.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSZXRyaWV2ZSBhIG1lc3NhZ2Ugd2l0aCBhIHZpc2liaWxpdHkgdGltZW91dCBvZiAzMCBzZWNvbmRzCm1lc3NhZ2VzID0gcXVldWVfY2xpZW50LnJlY2VpdmVfbWVzc2FnZXModmlzaWJpbGl0eV90aW1lb3V0PTMwKQoKZm9yIG1lc3NhZ2UgaW4gbWVzc2FnZXM6CiAgICBwcmludChmIk1lc3NhZ2U6IHttZXNzYWdlLmNvbnRlbnR9IikKICAgICMgUHJvY2VzcyB0aGUgbWVzc2FnZQogICAgIyAuLi4KICAgICMgRGVsZXRlIHRoZSBtZXNzYWdlIGFmdGVyIHByb2Nlc3NpbmcKICAgIHF1ZXVlX2NsaWVudC5kZWxldGVfbWVzc2FnZShtZXNzYWdlKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Retrieve a message with a visibility timeout of 30 seconds
messages = queue_client.receive_messages(visibility_timeout=30)

for message in messages:
    print(f&quot;Message: {message.content}&quot;)
    # Process the message
    # ...
    # Delete the message after processing
    queue_client.delete_message(message)</pre></div><div class='content'></div><h1>Advanced Concepts</h1>
<div class='content'></div><h2>Message TTL (Time-to-Live)</h2>
<div class='content'><p>Messages in a queue can have a TTL, which specifies how long the message should remain in the queue before it is automatically deleted.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTZW5kIGEgbWVzc2FnZSB3aXRoIGEgVFRMIG9mIDYwIHNlY29uZHMKcXVldWVfY2xpZW50LnNlbmRfbWVzc2FnZSgiVGhpcyBtZXNzYWdlIHdpbGwgZXhwaXJlIGluIDYwIHNlY29uZHMiLCB0aW1lX3RvX2xpdmU9NjAp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Send a message with a TTL of 60 seconds
queue_client.send_message(&quot;This message will expire in 60 seconds&quot;, time_to_live=60)</pre></div><div class='content'></div><h2>Poison Message Handling</h2>
<div class='content'><p>Messages that cannot be processed successfully after multiple attempts are known as poison messages. You can implement logic to move these messages to a separate queue for further analysis.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlIGxvZ2ljIHRvIGhhbmRsZSBwb2lzb24gbWVzc2FnZXMKbWF4X2F0dGVtcHRzID0gNQoKZm9yIG1lc3NhZ2UgaW4gbWVzc2FnZXM6CiAgICBpZiBtZXNzYWdlLmRlcXVldWVfY291bnQgPiBtYXhfYXR0ZW1wdHM6CiAgICAgICAgIyBNb3ZlIHRvIHBvaXNvbiBxdWV1ZQogICAgICAgIHBvaXNvbl9xdWV1ZV9jbGllbnQuc2VuZF9tZXNzYWdlKG1lc3NhZ2UuY29udGVudCkKICAgICAgICBxdWV1ZV9jbGllbnQuZGVsZXRlX21lc3NhZ2UobWVzc2FnZSkKICAgIGVsc2U6CiAgICAgICAgIyBQcm9jZXNzIHRoZSBtZXNzYWdlCiAgICAgICAgIyAuLi4KICAgICAgICBxdWV1ZV9jbGllbnQuZGVsZXRlX21lc3NhZ2UobWVzc2FnZSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example logic to handle poison messages
max_attempts = 5

for message in messages:
    if message.dequeue_count &gt; max_attempts:
        # Move to poison queue
        poison_queue_client.send_message(message.content)
        queue_client.delete_message(message)
    else:
        # Process the message
        # ...
        queue_client.delete_message(message)</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Azure Queue Storage is a powerful service for decoupling components of a cloud application and ensuring reliable message delivery. By understanding the basics and advanced features, you can effectively use Azure Queue Storage to build scalable and resilient applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='table-storage'>&#x25C4;Table Storage</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Queue Storage in Azure</a>
	</div>
	<div class='col-4 text-end'>
					<a href='managing-and-securing-storage'>Managing and Securing Storage &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
