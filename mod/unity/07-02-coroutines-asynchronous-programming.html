<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coroutines and Asynchronous Programming</title>

    <link rel="alternate" href="https://campusempresa.com/mod/unity/07-02-coroutines-asynchronous-programming" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/unity/07-02-coroutines-asynchronous-programming" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/unity/07-02-coroutines-asynchronous-programming" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/unity/07-02-coroutines-asynchronous-programming" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/unity/07-02-coroutines-asynchronous-programming" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-01-advanced-csharp-concepts-unity' title="Advanced C# Concepts for Unity">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Coroutines and Asynchronous Programming</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-03-scriptable-objects' title="Scriptable Objects">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this module, we will delve into the concepts of coroutines and asynchronous programming in Unity. These techniques are essential for handling tasks that need to run over multiple frames, such as animations, waiting for user input, or performing time-consuming operations without freezing the game.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'></div><h2><ol>
<li>What are Coroutines?</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: Coroutines are special methods in Unity that allow you to pause execution and resume it later.</li>
<li><strong>Use Cases</strong>: Ideal for tasks that need to be spread over several frames, such as animations, waiting for a condition, or handling asynchronous operations.</li>
</ul>
</div><h2><ol start="2">
<li>Coroutine Syntax</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Starting a Coroutine</strong>: Use <code>StartCoroutine</code> to begin a coroutine.</li>
<li><strong>Yield Statements</strong>: Use <code>yield return</code> to pause the coroutine.</li>
</ul>
</div><h2><ol start="3">
<li>Common Yield Instructions</li>
</ol>
</h2>
<div class='content'><ul>
<li><code>yield return null</code>: Waits until the next frame.</li>
<li><code>yield return new WaitForSeconds(float seconds)</code>: Waits for a specified amount of time.</li>
<li><code>yield return new WaitUntil(Func&lt;bool&gt; predicate)</code>: Waits until a condition is true.</li>
<li><code>yield return new WaitForEndOfFrame()</code>: Waits until the end of the frame.</li>
</ul>
</div><h2><ol start="4">
<li>Asynchronous Programming</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: Asynchronous programming allows you to run tasks in the background, freeing up the main thread to continue processing other tasks.</li>
<li><strong>Use Cases</strong>: Useful for tasks like loading resources, network operations, or any long-running process that should not block the main thread.</li>
</ul>
</div><h1><p>Practical Examples</p>
</h1>
<div class='content'></div><h2><p>Example 1: Basic Coroutine</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgVW5pdHlFbmdpbmU7CgpwdWJsaWMgY2xhc3MgQ29yb3V0aW5lRXhhbXBsZSA6IE1vbm9CZWhhdmlvdXIKewogICAgdm9pZCBTdGFydCgpCiAgICB7CiAgICAgICAgLy8gU3RhcnQgdGhlIGNvcm91dGluZQogICAgICAgIFN0YXJ0Q29yb3V0aW5lKFByaW50TWVzc2FnZXMoKSk7CiAgICB9CgogICAgSUVudW1lcmF0b3IgUHJpbnRNZXNzYWdlcygpCiAgICB7CiAgICAgICAgRGVidWcuTG9nKCJNZXNzYWdlIDEiKTsKICAgICAgICAvLyBXYWl0IGZvciAyIHNlY29uZHMKICAgICAgICB5aWVsZCByZXR1cm4gbmV3IFdhaXRGb3JTZWNvbmRzKDIpOwogICAgICAgIERlYnVnLkxvZygiTWVzc2FnZSAyIik7CiAgICAgICAgLy8gV2FpdCBmb3IgYW5vdGhlciAyIHNlY29uZHMKICAgICAgICB5aWVsZCByZXR1cm4gbmV3IFdhaXRGb3JTZWNvbmRzKDIpOwogICAgICAgIERlYnVnLkxvZygiTWVzc2FnZSAzIik7CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using UnityEngine;

public class CoroutineExample : MonoBehaviour
{
    void Start()
    {
        // Start the coroutine
        StartCoroutine(PrintMessages());
    }

    IEnumerator PrintMessages()
    {
        Debug.Log(&quot;Message 1&quot;);
        // Wait for 2 seconds
        yield return new WaitForSeconds(2);
        Debug.Log(&quot;Message 2&quot;);
        // Wait for another 2 seconds
        yield return new WaitForSeconds(2);
        Debug.Log(&quot;Message 3&quot;);
    }
}</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The <code>PrintMessages</code> coroutine prints a message, waits for 2 seconds, and then prints the next message. This process repeats until all messages are printed.</li>
</ul>
</div><h2><p>Example 2: Coroutine with Condition</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgVW5pdHlFbmdpbmU7CgpwdWJsaWMgY2xhc3MgQ29yb3V0aW5lV2l0aENvbmRpdGlvbiA6IE1vbm9CZWhhdmlvdXIKewogICAgcHJpdmF0ZSBib29sIGlzQ29uZGl0aW9uTWV0ID0gZmFsc2U7CgogICAgdm9pZCBTdGFydCgpCiAgICB7CiAgICAgICAgLy8gU3RhcnQgdGhlIGNvcm91dGluZQogICAgICAgIFN0YXJ0Q29yb3V0aW5lKFdhaXRGb3JDb25kaXRpb24oKSk7CiAgICB9CgogICAgSUVudW1lcmF0b3IgV2FpdEZvckNvbmRpdGlvbigpCiAgICB7CiAgICAgICAgRGVidWcuTG9nKCJXYWl0aW5nIGZvciBjb25kaXRpb24uLi4iKTsKICAgICAgICAvLyBXYWl0IHVudGlsIHRoZSBjb25kaXRpb24gaXMgbWV0CiAgICAgICAgeWllbGQgcmV0dXJuIG5ldyBXYWl0VW50aWwoKCkgPT4gaXNDb25kaXRpb25NZXQpOwogICAgICAgIERlYnVnLkxvZygiQ29uZGl0aW9uIG1ldCEiKTsKICAgIH0KCiAgICB2b2lkIFVwZGF0ZSgpCiAgICB7CiAgICAgICAgLy8gU2ltdWxhdGUgY29uZGl0aW9uIGJlaW5nIG1ldCBhZnRlciA1IHNlY29uZHMKICAgICAgICBpZiAoVGltZS50aW1lID4gNWYpCiAgICAgICAgewogICAgICAgICAgICBpc0NvbmRpdGlvbk1ldCA9IHRydWU7CiAgICAgICAgfQogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using UnityEngine;

public class CoroutineWithCondition : MonoBehaviour
{
    private bool isConditionMet = false;

    void Start()
    {
        // Start the coroutine
        StartCoroutine(WaitForCondition());
    }

    IEnumerator WaitForCondition()
    {
        Debug.Log(&quot;Waiting for condition...&quot;);
        // Wait until the condition is met
        yield return new WaitUntil(() =&gt; isConditionMet);
        Debug.Log(&quot;Condition met!&quot;);
    }

    void Update()
    {
        // Simulate condition being met after 5 seconds
        if (Time.time &gt; 5f)
        {
            isConditionMet = true;
        }
    }
}</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The <code>WaitForCondition</code> coroutine waits until the <code>isConditionMet</code> variable becomes true. The <code>Update</code> method simulates the condition being met after 5 seconds.</li>
</ul>
</div><h2><p>Example 3: Asynchronous Task</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgU3lzdGVtLlRocmVhZGluZy5UYXNrczsKdXNpbmcgVW5pdHlFbmdpbmU7CgpwdWJsaWMgY2xhc3MgQXN5bmNFeGFtcGxlIDogTW9ub0JlaGF2aW91cgp7CiAgICBhc3luYyB2b2lkIFN0YXJ0KCkKICAgIHsKICAgICAgICBEZWJ1Zy5Mb2coIlN0YXJ0aW5nIGFzeW5jIHRhc2suLi4iKTsKICAgICAgICBhd2FpdCBMb25nUnVubmluZ1Rhc2soKTsKICAgICAgICBEZWJ1Zy5Mb2coIkFzeW5jIHRhc2sgY29tcGxldGVkISIpOwogICAgfQoKICAgIGFzeW5jIFRhc2sgTG9uZ1J1bm5pbmdUYXNrKCkKICAgIHsKICAgICAgICAvLyBTaW11bGF0ZSBhIGxvbmctcnVubmluZyB0YXNrCiAgICAgICAgYXdhaXQgVGFzay5EZWxheSg1MDAwKTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using System.Threading.Tasks;
using UnityEngine;

public class AsyncExample : MonoBehaviour
{
    async void Start()
    {
        Debug.Log(&quot;Starting async task...&quot;);
        await LongRunningTask();
        Debug.Log(&quot;Async task completed!&quot;);
    }

    async Task LongRunningTask()
    {
        // Simulate a long-running task
        await Task.Delay(5000);
    }
}</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The <code>LongRunningTask</code> method simulates a long-running task by delaying for 5 seconds. The <code>Start</code> method awaits this task, allowing the main thread to remain responsive.</li>
</ul>
</div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Coroutine for Animation</p>
</h2>
<div class='content'><p><strong>Task</strong>: Create a coroutine that moves a GameObject from one position to another over 3 seconds.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgVW5pdHlFbmdpbmU7CgpwdWJsaWMgY2xhc3MgTW92ZU9iamVjdCA6IE1vbm9CZWhhdmlvdXIKewogICAgcHVibGljIFRyYW5zZm9ybSB0YXJnZXRQb3NpdGlvbjsKCiAgICB2b2lkIFN0YXJ0KCkKICAgIHsKICAgICAgICBTdGFydENvcm91dGluZShNb3ZlVG9Qb3NpdGlvbih0YXJnZXRQb3NpdGlvbi5wb3NpdGlvbiwgM2YpKTsKICAgIH0KCiAgICBJRW51bWVyYXRvciBNb3ZlVG9Qb3NpdGlvbihWZWN0b3IzIHRhcmdldCwgZmxvYXQgZHVyYXRpb24pCiAgICB7CiAgICAgICAgVmVjdG9yMyBzdGFydFBvc2l0aW9uID0gdHJhbnNmb3JtLnBvc2l0aW9uOwogICAgICAgIGZsb2F0IGVsYXBzZWRUaW1lID0gMDsKCiAgICAgICAgd2hpbGUgKGVsYXBzZWRUaW1lIDwgZHVyYXRpb24pCiAgICAgICAgewogICAgICAgICAgICB0cmFuc2Zvcm0ucG9zaXRpb24gPSBWZWN0b3IzLkxlcnAoc3RhcnRQb3NpdGlvbiwgdGFyZ2V0LCBlbGFwc2VkVGltZSAvIGR1cmF0aW9uKTsKICAgICAgICAgICAgZWxhcHNlZFRpbWUgKz0gVGltZS5kZWx0YVRpbWU7CiAgICAgICAgICAgIHlpZWxkIHJldHVybiBudWxsOwogICAgICAgIH0KCiAgICAgICAgdHJhbnNmb3JtLnBvc2l0aW9uID0gdGFyZ2V0OwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using UnityEngine;

public class MoveObject : MonoBehaviour
{
    public Transform targetPosition;

    void Start()
    {
        StartCoroutine(MoveToPosition(targetPosition.position, 3f));
    }

    IEnumerator MoveToPosition(Vector3 target, float duration)
    {
        Vector3 startPosition = transform.position;
        float elapsedTime = 0;

        while (elapsedTime &lt; duration)
        {
            transform.position = Vector3.Lerp(startPosition, target, elapsedTime / duration);
            elapsedTime += Time.deltaTime;
            yield return null;
        }

        transform.position = target;
    }
}</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The <code>MoveToPosition</code> coroutine smoothly moves the GameObject from its current position to the target position over the specified duration using linear interpolation (<code>Vector3.Lerp</code>).</li>
</ul>
</div><h2><p>Exercise 2: Asynchronous Data Loading</p>
</h2>
<div class='content'><p><strong>Task</strong>: Implement an asynchronous method to load data from a file without blocking the main thread.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgU3lzdGVtLklPOwp1c2luZyBTeXN0ZW0uVGhyZWFkaW5nLlRhc2tzOwp1c2luZyBVbml0eUVuZ2luZTsKCnB1YmxpYyBjbGFzcyBBc3luY0RhdGFMb2FkZXIgOiBNb25vQmVoYXZpb3VyCnsKICAgIGFzeW5jIHZvaWQgU3RhcnQoKQogICAgewogICAgICAgIHN0cmluZyBkYXRhID0gYXdhaXQgTG9hZERhdGFBc3luYygicGF0aC90by95b3VyL2ZpbGUudHh0Iik7CiAgICAgICAgRGVidWcuTG9nKGRhdGEpOwogICAgfQoKICAgIGFzeW5jIFRhc2s8c3RyaW5nPiBMb2FkRGF0YUFzeW5jKHN0cmluZyBmaWxlUGF0aCkKICAgIHsKICAgICAgICB1c2luZyAoU3RyZWFtUmVhZGVyIHJlYWRlciA9IG5ldyBTdHJlYW1SZWFkZXIoZmlsZVBhdGgpKQogICAgICAgIHsKICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHJlYWRlci5SZWFkVG9FbmRBc3luYygpOwogICAgICAgIH0KICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using System.IO;
using System.Threading.Tasks;
using UnityEngine;

public class AsyncDataLoader : MonoBehaviour
{
    async void Start()
    {
        string data = await LoadDataAsync(&quot;path/to/your/file.txt&quot;);
        Debug.Log(data);
    }

    async Task&lt;string&gt; LoadDataAsync(string filePath)
    {
        using (StreamReader reader = new StreamReader(filePath))
        {
            return await reader.ReadToEndAsync();
        }
    }
}</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The <code>LoadDataAsync</code> method reads the contents of a file asynchronously. The <code>Start</code> method awaits this task and logs the data once it is loaded.</li>
</ul>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Forgetting to Start Coroutine</strong>: Ensure you use <code>StartCoroutine</code> to initiate a coroutine.</li>
<li><strong>Blocking Main Thread</strong>: Avoid using blocking operations in coroutines; use <code>yield</code> statements to pause execution.</li>
<li><strong>Misusing <code>yield return null</code></strong>: Remember that <code>yield return null</code> waits for the next frame, not for a specific condition or time.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this module, we covered the basics of coroutines and asynchronous programming in Unity. You learned how to create and manage coroutines, use various yield instructions, and implement asynchronous tasks. These techniques are crucial for creating smooth and responsive games. In the next module, we will explore advanced scripting concepts to further enhance your Unity development skills.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-01-advanced-csharp-concepts-unity' title="Advanced C# Concepts for Unity">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-03-scriptable-objects' title="Scriptable Objects">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
