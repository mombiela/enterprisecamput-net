<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Middleware in Node.js</title>

    <link rel="alternate" href="https://campusempresa.com/mod/nodejs/middleware" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/nodejs/middleware" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/nodejs/middleware" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/nodejs/middleware" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/nodejs/middleware" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='setup-express-app'>&#x25C4;Setting Up an Express Application</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Middleware in Node.js</a>
	</div>
	<div class='col-4 text-end'>
					<a href='routing-express'>Routing in Express &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Middleware is a fundamental concept in Node.js, especially when working with frameworks like Express.js. Middleware functions are functions that have access to the request object (<code>req</code>), the response object (<code>res</code>), and the next middleware function in the application’s request-response cycle. Middleware can execute code, modify the request and response objects, end the request-response cycle, and call the next middleware function in the stack.</p>
</div><h1>What is Middleware?</h1>
<div class='content'><ul>
<li>Middleware functions are functions that have access to the request object (<code>req</code>), the response object (<code>res</code>), and the next middleware function in the application’s request-response cycle.</li>
<li>Middleware can perform the following tasks:
<ul>
<li>Execute any code.</li>
<li>Make changes to the request and response objects.</li>
<li>End the request-response cycle.</li>
<li>Call the next middleware function in the stack.</li>
</ul>
</li>
</ul>
</div><h1>Types of Middleware</h1>
<div class='content'><ol>
<li><strong>Application-level Middleware</strong></li>
<li><strong>Router-level Middleware</strong></li>
<li><strong>Error-handling Middleware</strong></li>
<li><strong>Built-in Middleware</strong></li>
<li><strong>Third-party Middleware</strong></li>
</ol>
</div><h2>Application-level Middleware</h2>
<div class='content'><p>Application-level middleware is bound to an instance of the app object using <code>app.use()</code> and <code>app.METHOD()</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgYXBwID0gZXhwcmVzcygpOwoKLy8gQXBwbGljYXRpb24tbGV2ZWwgbWlkZGxld2FyZQphcHAudXNlKChyZXEsIHJlcywgbmV4dCkgPT4gewogIGNvbnNvbGUubG9nKCdUaW1lOicsIERhdGUubm93KCkpOwogIG5leHQoKTsKfSk7CgphcHAuZ2V0KCcvJywgKHJlcSwgcmVzKSA9PiB7CiAgcmVzLnNlbmQoJ0hlbGxvIFdvcmxkIScpOwp9KTsKCmFwcC5saXN0ZW4oMzAwMCwgKCkgPT4gewogIGNvbnNvbGUubG9nKCdTZXJ2ZXIgaXMgcnVubmluZyBvbiBwb3J0IDMwMDAnKTsKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const app = express();

// Application-level middleware
app.use((req, res, next) =&gt; {
  console.log('Time:', Date.now());
  next();
});

app.get('/', (req, res) =&gt; {
  res.send('Hello World!');
});

app.listen(3000, () =&gt; {
  console.log('Server is running on port 3000');
});</pre></div><div class='content'></div><h2>Router-level Middleware</h2>
<div class='content'><p>Router-level middleware works in the same way as application-level middleware, except it is bound to an instance of <code>express.Router()</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgYXBwID0gZXhwcmVzcygpOwpjb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpOwoKLy8gUm91dGVyLWxldmVsIG1pZGRsZXdhcmUKcm91dGVyLnVzZSgocmVxLCByZXMsIG5leHQpID0+IHsKICBjb25zb2xlLmxvZygnUmVxdWVzdCBVUkw6JywgcmVxLm9yaWdpbmFsVXJsKTsKICBuZXh0KCk7Cn0pOwoKcm91dGVyLmdldCgnLycsIChyZXEsIHJlcykgPT4gewogIHJlcy5zZW5kKCdIZWxsbyBmcm9tIFJvdXRlciEnKTsKfSk7CgphcHAudXNlKCcvcm91dGVyJywgcm91dGVyKTsKCmFwcC5saXN0ZW4oMzAwMCwgKCkgPT4gewogIGNvbnNvbGUubG9nKCdTZXJ2ZXIgaXMgcnVubmluZyBvbiBwb3J0IDMwMDAnKTsKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const app = express();
const router = express.Router();

// Router-level middleware
router.use((req, res, next) =&gt; {
  console.log('Request URL:', req.originalUrl);
  next();
});

router.get('/', (req, res) =&gt; {
  res.send('Hello from Router!');
});

app.use('/router', router);

app.listen(3000, () =&gt; {
  console.log('Server is running on port 3000');
});</pre></div><div class='content'></div><h2>Error-handling Middleware</h2>
<div class='content'><p>Error-handling middleware is defined in the same way as other middleware functions, except it has four arguments instead of three: <code>(err, req, res, next)</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgYXBwID0gZXhwcmVzcygpOwoKLy8gRXJyb3ItaGFuZGxpbmcgbWlkZGxld2FyZQphcHAudXNlKChlcnIsIHJlcSwgcmVzLCBuZXh0KSA9PiB7CiAgY29uc29sZS5lcnJvcihlcnIuc3RhY2spOwogIHJlcy5zdGF0dXMoNTAwKS5zZW5kKCdTb21ldGhpbmcgYnJva2UhJyk7Cn0pOwoKYXBwLmdldCgnLycsIChyZXEsIHJlcykgPT4gewogIHRocm93IG5ldyBFcnJvcignQlJPS0VOJyk7IC8vIEV4cHJlc3Mgd2lsbCBjYXRjaCB0aGlzIG9uIGl0cyBvd24uCn0pOwoKYXBwLmxpc3RlbigzMDAwLCAoKSA9PiB7CiAgY29uc29sZS5sb2coJ1NlcnZlciBpcyBydW5uaW5nIG9uIHBvcnQgMzAwMCcpOwp9KTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const app = express();

// Error-handling middleware
app.use((err, req, res, next) =&gt; {
  console.error(err.stack);
  res.status(500).send('Something broke!');
});

app.get('/', (req, res) =&gt; {
  throw new Error('BROKEN'); // Express will catch this on its own.
});

app.listen(3000, () =&gt; {
  console.log('Server is running on port 3000');
});</pre></div><div class='content'></div><h2>Built-in Middleware</h2>
<div class='content'><p>Express comes with a few built-in middleware functions, such as <code>express.static</code>, <code>express.json</code>, and <code>express.urlencoded</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgYXBwID0gZXhwcmVzcygpOwoKLy8gQnVpbHQtaW4gbWlkZGxld2FyZQphcHAudXNlKGV4cHJlc3MuanNvbigpKTsgLy8gRm9yIHBhcnNpbmcgYXBwbGljYXRpb24vanNvbgphcHAudXNlKGV4cHJlc3MudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiB0cnVlIH0pKTsgLy8gRm9yIHBhcnNpbmcgYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkCgphcHAucG9zdCgnL2RhdGEnLCAocmVxLCByZXMpID0+IHsKICByZXMuc2VuZChyZXEuYm9keSk7Cn0pOwoKYXBwLmxpc3RlbigzMDAwLCAoKSA9PiB7CiAgY29uc29sZS5sb2coJ1NlcnZlciBpcyBydW5uaW5nIG9uIHBvcnQgMzAwMCcpOwp9KTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const app = express();

// Built-in middleware
app.use(express.json()); // For parsing application/json
app.use(express.urlencoded({ extended: true })); // For parsing application/x-www-form-urlencoded

app.post('/data', (req, res) =&gt; {
  res.send(req.body);
});

app.listen(3000, () =&gt; {
  console.log('Server is running on port 3000');
});</pre></div><div class='content'></div><h2>Third-party Middleware</h2>
<div class='content'><p>Third-party middleware can be installed via npm and then require in your application. Popular third-party middleware includes <code>morgan</code>, <code>body-parser</code>, and <code>cookie-parser</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgbW9yZ2FuID0gcmVxdWlyZSgnbW9yZ2FuJyk7CmNvbnN0IGFwcCA9IGV4cHJlc3MoKTsKCi8vIFRoaXJkLXBhcnR5IG1pZGRsZXdhcmUKYXBwLnVzZShtb3JnYW4oJ3RpbnknKSk7CgphcHAuZ2V0KCcvJywgKHJlcSwgcmVzKSA9PiB7CiAgcmVzLnNlbmQoJ0hlbGxvIFdvcmxkIScpOwp9KTsKCmFwcC5saXN0ZW4oMzAwMCwgKCkgPT4gewogIGNvbnNvbGUubG9nKCdTZXJ2ZXIgaXMgcnVubmluZyBvbiBwb3J0IDMwMDAnKTsKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const morgan = require('morgan');
const app = express();

// Third-party middleware
app.use(morgan('tiny'));

app.get('/', (req, res) =&gt; {
  res.send('Hello World!');
});

app.listen(3000, () =&gt; {
  console.log('Server is running on port 3000');
});</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Middleware is a powerful and flexible feature in Node.js that allows you to handle various aspects of request and response processing. Understanding how to use different types of middleware effectively can greatly enhance the functionality and maintainability of your Node.js applications. Whether you are logging requests, parsing incoming data, handling errors, or serving static files, middleware provides a structured way to manage these tasks.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='setup-express-app'>&#x25C4;Setting Up an Express Application</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Middleware in Node.js</a>
	</div>
	<div class='col-4 text-end'>
					<a href='routing-express'>Routing in Express &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
