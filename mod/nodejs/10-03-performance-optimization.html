<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Optimization</title>

    <link rel="alternate" href="https://campusempresa.com/mod/nodejs/10-03-performance-optimization" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/nodejs/10-03-performance-optimization" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/nodejs/10-03-performance-optimization" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/nodejs/10-03-performance-optimization" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/nodejs/10-03-performance-optimization" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='10-02-worker-threads' title="Worker Threads">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Performance Optimization</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='10-04-building-restful-apis' title="Building RESTful APIs">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this module, we will explore various techniques and best practices to optimize the performance of Node.js applications. Performance optimization is crucial for ensuring that your application runs efficiently, scales well, and provides a good user experience.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Profiling and Monitoring</strong></li>
<li><strong>Efficient Use of Asynchronous Code</strong></li>
<li><strong>Memory Management</strong></li>
<li><strong>Optimizing I/O Operations</strong></li>
<li><strong>Caching Strategies</strong></li>
<li><strong>Load Balancing and Clustering</strong></li>
</ol>
</div><h1><p>Profiling and Monitoring</p>
</h1>
<div class='content'></div><h2><p>Profiling</p>
</h2>
<div class='content'><p>Profiling helps you understand where your application spends most of its time and resources. Tools like <code>node --prof</code> and <code>clinic.js</code> can be used for profiling Node.js applications.</p>
<h4>Example: Using <code>node --prof</code></h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bm9kZSAtLXByb2YgYXBwLmpz"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>node --prof app.js</pre></div><div class='content'><p>This command generates a V8 log file that can be analyzed using <code>node --prof-process</code>.</p>
</div><h2><p>Monitoring</p>
</h2>
<div class='content'><p>Monitoring tools like PM2, New Relic, and Datadog can help you keep track of your application's performance in real-time.</p>
<h4>Example: Using PM2</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cG0yIHN0YXJ0IGFwcC5qcyAtLW5hbWUgIm15LWFwcCIKcG0yIG1vbml0"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pm2 start app.js --name &quot;my-app&quot;
pm2 monit</pre></div><div class='content'></div><h1><p>Efficient Use of Asynchronous Code</p>
</h1>
<div class='content'></div><h2><p>Avoid Blocking the Event Loop</p>
</h2>
<div class='content'><p>Blocking the event loop can severely degrade performance. Use asynchronous methods to avoid blocking.</p>
<h4>Example: Blocking vs Non-Blocking Code</h4>
<p><strong>Blocking Code:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwoKY29uc3QgZGF0YSA9IGZzLnJlYWRGaWxlU3luYygnL2ZpbGUvcGF0aCcpOyAvLyBTeW5jaHJvbm91cwpjb25zb2xlLmxvZyhkYXRhKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const fs = require('fs');

const data = fs.readFileSync('/file/path'); // Synchronous
console.log(data);</pre></div><div class='content'><p><strong>Non-Blocking Code:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwoKZnMucmVhZEZpbGUoJy9maWxlL3BhdGgnLCAoZXJyLCBkYXRhKSA9PiB7IC8vIEFzeW5jaHJvbm91cwogIGlmIChlcnIpIHRocm93IGVycjsKICBjb25zb2xlLmxvZyhkYXRhKTsKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const fs = require('fs');

fs.readFile('/file/path', (err, data) =&gt; { // Asynchronous
  if (err) throw err;
  console.log(data);
});</pre></div><div class='content'></div><h2><p>Use Promises and Async/Await</p>
</h2>
<div class='content'><p>Promises and <code>async/await</code> make it easier to write non-blocking code.</p>
<h4>Example: Using Async/Await</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZnMgPSByZXF1aXJlKCdmcycpLnByb21pc2VzOwoKYXN5bmMgZnVuY3Rpb24gcmVhZEZpbGUoKSB7CiAgdHJ5IHsKICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBmcy5yZWFkRmlsZSgnL2ZpbGUvcGF0aCcpOwogICAgY29uc29sZS5sb2coZGF0YSk7CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBjb25zb2xlLmVycm9yKGVycik7CiAgfQp9CgpyZWFkRmlsZSgpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const fs = require('fs').promises;

async function readFile() {
  try {
    const data = await fs.readFile('/file/path');
    console.log(data);
  } catch (err) {
    console.error(err);
  }
}

readFile();</pre></div><div class='content'></div><h1><p>Memory Management</p>
</h1>
<div class='content'></div><h2><p>Garbage Collection</p>
</h2>
<div class='content'><p>Node.js uses V8's garbage collector, but you can optimize memory usage by managing object lifetimes and avoiding memory leaks.</p>
<h4>Example: Avoiding Memory Leaks</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bGV0IGNhY2hlID0ge307CgpmdW5jdGlvbiBhZGRUb0NhY2hlKGtleSwgdmFsdWUpIHsKICBjYWNoZVtrZXldID0gdmFsdWU7Cn0KCmZ1bmN0aW9uIGNsZWFyQ2FjaGUoKSB7CiAgY2FjaGUgPSB7fTsKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>let cache = {};

function addToCache(key, value) {
  cache[key] = value;
}

function clearCache() {
  cache = {};
}</pre></div><div class='content'></div><h2><p>Using Buffers Efficiently</p>
</h2>
<div class='content'><p>Buffers are used for handling binary data. Use them efficiently to manage memory.</p>
<h4>Example: Using Buffers</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgYnVmZmVyID0gQnVmZmVyLmFsbG9jKDEwMjQpOyAvLyBBbGxvY2F0ZSAxS0IgYnVmZmVy"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const buffer = Buffer.alloc(1024); // Allocate 1KB buffer</pre></div><div class='content'></div><h1><p>Optimizing I/O Operations</p>
</h1>
<div class='content'></div><h2><p>Use Streams for Large Data</p>
</h2>
<div class='content'><p>Streams allow you to process large data efficiently.</p>
<h4>Example: Reading a File Using Streams</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwoKY29uc3QgcmVhZFN0cmVhbSA9IGZzLmNyZWF0ZVJlYWRTdHJlYW0oJy9sYXJnZS9maWxlL3BhdGgnKTsKcmVhZFN0cmVhbS5vbignZGF0YScsIChjaHVuaykgPT4gewogIGNvbnNvbGUubG9nKGNodW5rKTsKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const fs = require('fs');

const readStream = fs.createReadStream('/large/file/path');
readStream.on('data', (chunk) =&gt; {
  console.log(chunk);
});</pre></div><div class='content'></div><h2><p>Use Compression</p>
</h2>
<div class='content'><p>Compressing data can reduce I/O time.</p>
<h4>Example: Using zlib for Compression</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgemxpYiA9IHJlcXVpcmUoJ3psaWInKTsKY29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwoKY29uc3QgcmVhZFN0cmVhbSA9IGZzLmNyZWF0ZVJlYWRTdHJlYW0oJy9maWxlL3BhdGgnKTsKY29uc3Qgd3JpdGVTdHJlYW0gPSBmcy5jcmVhdGVXcml0ZVN0cmVhbSgnL2ZpbGUvcGF0aC5neicpOwpjb25zdCBnemlwID0gemxpYi5jcmVhdGVHemlwKCk7CgpyZWFkU3RyZWFtLnBpcGUoZ3ppcCkucGlwZSh3cml0ZVN0cmVhbSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const zlib = require('zlib');
const fs = require('fs');

const readStream = fs.createReadStream('/file/path');
const writeStream = fs.createWriteStream('/file/path.gz');
const gzip = zlib.createGzip();

readStream.pipe(gzip).pipe(writeStream);</pre></div><div class='content'></div><h1><p>Caching Strategies</p>
</h1>
<div class='content'></div><h2><p>In-Memory Caching</p>
</h2>
<div class='content'><p>Use in-memory caching for frequently accessed data.</p>
<h4>Example: Using Node-Cache</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgTm9kZUNhY2hlID0gcmVxdWlyZSgnbm9kZS1jYWNoZScpOwpjb25zdCBteUNhY2hlID0gbmV3IE5vZGVDYWNoZSgpOwoKbXlDYWNoZS5zZXQoJ2tleScsICd2YWx1ZScsIDEwMDAwKTsgLy8gQ2FjaGUgZm9yIDEwIHNlY29uZHMKY29uc3QgdmFsdWUgPSBteUNhY2hlLmdldCgna2V5Jyk7CmNvbnNvbGUubG9nKHZhbHVlKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const NodeCache = require('node-cache');
const myCache = new NodeCache();

myCache.set('key', 'value', 10000); // Cache for 10 seconds
const value = myCache.get('key');
console.log(value);</pre></div><div class='content'></div><h2><p>Distributed Caching</p>
</h2>
<div class='content'><p>For larger applications, use distributed caching solutions like Redis.</p>
<h4>Example: Using Redis</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgcmVkaXMgPSByZXF1aXJlKCdyZWRpcycpOwpjb25zdCBjbGllbnQgPSByZWRpcy5jcmVhdGVDbGllbnQoKTsKCmNsaWVudC5zZXQoJ2tleScsICd2YWx1ZScsICdFWCcsIDEwKTsgLy8gQ2FjaGUgZm9yIDEwIHNlY29uZHMKY2xpZW50LmdldCgna2V5JywgKGVyciwgdmFsdWUpID0+IHsKICBpZiAoZXJyKSB0aHJvdyBlcnI7CiAgY29uc29sZS5sb2codmFsdWUpOwp9KTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const redis = require('redis');
const client = redis.createClient();

client.set('key', 'value', 'EX', 10); // Cache for 10 seconds
client.get('key', (err, value) =&gt; {
  if (err) throw err;
  console.log(value);
});</pre></div><div class='content'></div><h1><p>Load Balancing and Clustering</p>
</h1>
<div class='content'></div><h2><p>Load Balancing</p>
</h2>
<div class='content'><p>Distribute incoming requests across multiple servers to balance the load.</p>
<h4>Example: Using Nginx for Load Balancing</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgdXBzdHJlYW0gbXlhcHAgewogICAgc2VydmVyIDEyNy4wLjAuMTozMDAwOwogICAgc2VydmVyIDEyNy4wLjAuMTozMDAxOwogIH0KCiAgc2VydmVyIHsKICAgIGxpc3RlbiA4MDsKCiAgICBsb2NhdGlvbiAvIHsKICAgICAgcHJveHlfcGFzcyBodHRwOi8vbXlhcHA7CiAgICB9CiAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
  upstream myapp {
    server 127.0.0.1:3000;
    server 127.0.0.1:3001;
  }

  server {
    listen 80;

    location / {
      proxy_pass http://myapp;
    }
  }
}</pre></div><div class='content'></div><h2><p>Clustering</p>
</h2>
<div class='content'><p>Use Node.js's cluster module to take advantage of multi-core systems.</p>
<h4>Example: Using Cluster Module</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgY2x1c3RlciA9IHJlcXVpcmUoJ2NsdXN0ZXInKTsKY29uc3QgaHR0cCA9IHJlcXVpcmUoJ2h0dHAnKTsKY29uc3QgbnVtQ1BVcyA9IHJlcXVpcmUoJ29zJykuY3B1cygpLmxlbmd0aDsKCmlmIChjbHVzdGVyLmlzTWFzdGVyKSB7CiAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1DUFVzOyBpKyspIHsKICAgIGNsdXN0ZXIuZm9yaygpOwogIH0KCiAgY2x1c3Rlci5vbignZXhpdCcsICh3b3JrZXIsIGNvZGUsIHNpZ25hbCkgPT4gewogICAgY29uc29sZS5sb2coYFdvcmtlciAke3dvcmtlci5wcm9jZXNzLnBpZH0gZGllZGApOwogIH0pOwp9IGVsc2UgewogIGh0dHAuY3JlYXRlU2VydmVyKChyZXEsIHJlcykgPT4gewogICAgcmVzLndyaXRlSGVhZCgyMDApOwogICAgcmVzLmVuZCgnSGVsbG8sIHdvcmxkIVxuJyk7CiAgfSkubGlzdGVuKDgwMDApOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const cluster = require('cluster');
const http = require('http');
const numCPUs = require('os').cpus().length;

if (cluster.isMaster) {
  for (let i = 0; i &lt; numCPUs; i++) {
    cluster.fork();
  }

  cluster.on('exit', (worker, code, signal) =&gt; {
    console.log(`Worker ${worker.process.pid} died`);
  });
} else {
  http.createServer((req, res) =&gt; {
    res.writeHead(200);
    res.end('Hello, world!\n');
  }).listen(8000);
}</pre></div><div class='content'></div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Profile and Optimize a Node.js Application</p>
</h2>
<div class='content'><ol>
<li>Create a simple Node.js application that reads a large file synchronously.</li>
<li>Profile the application using <code>node --prof</code>.</li>
<li>Optimize the application by using asynchronous file reading and measure the performance improvement.</li>
</ol>
</div><h2><p>Exercise 2: Implement Caching</p>
</h2>
<div class='content'><ol>
<li>Create a Node.js application that fetches data from an external API.</li>
<li>Implement in-memory caching using Node-Cache.</li>
<li>Implement distributed caching using Redis.</li>
</ol>
</div><h1><p>Summary</p>
</h1>
<div class='content'><p>In this module, we covered various techniques to optimize the performance of Node.js applications, including profiling and monitoring, efficient use of asynchronous code, memory management, optimizing I/O operations, caching strategies, and load balancing and clustering. By applying these techniques, you can ensure that your Node.js applications run efficiently and scale well.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='10-02-worker-threads' title="Worker Threads">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='10-04-building-restful-apis' title="Building RESTful APIs">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
