<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compute Shaders</title>

    <link rel="alternate" href="https://campusempresa.com/mod/open_gl/07-01-compute-shaders" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/open_gl/07-01-compute-shaders" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/open_gl/07-01-compute-shaders" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/open_gl/07-01-compute-shaders" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/open_gl/07-01-compute-shaders" class="px-2">CA</a>
					</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-04-environment-mapping' title="Environment Mapping">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Compute Shaders</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-02-geometry-shaders' title="Geometry Shaders">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1><p>Introduction</p>
</h1>
<div class='content'><p>Compute shaders are a powerful feature in OpenGL that allow you to perform general-purpose computing tasks on the GPU. Unlike traditional vertex and fragment shaders, compute shaders are not directly tied to the graphics pipeline and can be used for a wide range of tasks, such as physics simulations, image processing, and more.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'></div><h2><p>What are Compute Shaders?</p>
</h2>
<div class='content'><ul>
<li><strong>General-Purpose Computing</strong>: Compute shaders allow you to perform arbitrary computations on the GPU.</li>
<li><strong>Shader Stage</strong>: They are a separate shader stage in the OpenGL pipeline.</li>
<li><strong>Parallel Processing</strong>: Leverage the parallel processing power of the GPU.</li>
</ul>
</div><h2><p>Setting Up Compute Shaders</p>
</h2>
<div class='content'><ul>
<li><strong>Shader Language</strong>: Written in GLSL (OpenGL Shading Language).</li>
<li><strong>Shader Compilation</strong>: Similar to other shaders, compute shaders need to be compiled and linked into a program.</li>
</ul>
</div><h2><p>Dispatching Compute Shaders</p>
</h2>
<div class='content'><ul>
<li><strong>glDispatchCompute</strong>: Function used to execute compute shaders.</li>
<li><strong>Work Groups</strong>: Compute shaders operate on work groups, which are collections of threads.</li>
</ul>
</div><h1><p>Practical Example</p>
</h1>
<div class='content'></div><h2><p>Step 1: Writing a Compute Shader</p>
</h2>
<div class='content'><p>Create a file named <code>compute_shader.glsl</code> with the following content:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I3ZlcnNpb24gNDMwCgpsYXlvdXQgKGxvY2FsX3NpemVfeCA9IDE2LCBsb2NhbF9zaXplX3kgPSAxNikgaW47CgpsYXlvdXQgKHJnYmEzMmYsIGJpbmRpbmcgPSAwKSB1bmlmb3JtIGltYWdlMkQgaW1nX291dHB1dDsKCnZvaWQgbWFpbigpIHsKICAgIGl2ZWMyIHBpeGVsX2Nvb3JkcyA9IGl2ZWMyKGdsX0dsb2JhbEludm9jYXRpb25JRC54eSk7CiAgICB2ZWM0IHBpeGVsX2NvbG9yID0gdmVjNChmbG9hdChwaXhlbF9jb29yZHMueCkgLyA1MTIuMCwgZmxvYXQocGl4ZWxfY29vcmRzLnkpIC8gNTEyLjAsIDAuMCwgMS4wKTsKICAgIGltYWdlU3RvcmUoaW1nX291dHB1dCwgcGl4ZWxfY29vcmRzLCBwaXhlbF9jb2xvcik7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#version 430

layout (local_size_x = 16, local_size_y = 16) in;

layout (rgba32f, binding = 0) uniform image2D img_output;

void main() {
    ivec2 pixel_coords = ivec2(gl_GlobalInvocationID.xy);
    vec4 pixel_color = vec4(float(pixel_coords.x) / 512.0, float(pixel_coords.y) / 512.0, 0.0, 1.0);
    imageStore(img_output, pixel_coords, pixel_color);
}</pre></div><div class='content'></div><h2><p>Step 2: Compiling and Linking the Compute Shader</p>
</h2>
<div class='content'><p>In your OpenGL application, compile and link the compute shader:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R0x1aW50IGNvbXB1dGVTaGFkZXIgPSBnbENyZWF0ZVNoYWRlcihHTF9DT01QVVRFX1NIQURFUik7CmNvbnN0IGNoYXIqIGNvbXB1dGVTaGFkZXJTb3VyY2UgPSAvKiBMb2FkIHlvdXIgY29tcHV0ZV9zaGFkZXIuZ2xzbCBzb3VyY2UgY29kZSBoZXJlICovOwpnbFNoYWRlclNvdXJjZShjb21wdXRlU2hhZGVyLCAxLCAmY29tcHV0ZVNoYWRlclNvdXJjZSwgbnVsbHB0cik7CmdsQ29tcGlsZVNoYWRlcihjb21wdXRlU2hhZGVyKTsKCi8vIENoZWNrIGZvciBjb21waWxhdGlvbiBlcnJvcnMKR0xpbnQgc3VjY2VzczsKZ2xHZXRTaGFkZXJpdihjb21wdXRlU2hhZGVyLCBHTF9DT01QSUxFX1NUQVRVUywgJnN1Y2Nlc3MpOwppZiAoIXN1Y2Nlc3MpIHsKICAgIGNoYXIgaW5mb0xvZ1s1MTJdOwogICAgZ2xHZXRTaGFkZXJJbmZvTG9nKGNvbXB1dGVTaGFkZXIsIDUxMiwgbnVsbHB0ciwgaW5mb0xvZyk7CiAgICBzdGQ6OmNlcnIgPDwgIkVSUk9SOjpTSEFERVI6OkNPTVBVVEU6OkNPTVBJTEFUSU9OX0ZBSUxFRFxuIiA8PCBpbmZvTG9nIDw8IHN0ZDo6ZW5kbDsKfQoKR0x1aW50IHNoYWRlclByb2dyYW0gPSBnbENyZWF0ZVByb2dyYW0oKTsKZ2xBdHRhY2hTaGFkZXIoc2hhZGVyUHJvZ3JhbSwgY29tcHV0ZVNoYWRlcik7CmdsTGlua1Byb2dyYW0oc2hhZGVyUHJvZ3JhbSk7CgovLyBDaGVjayBmb3IgbGlua2luZyBlcnJvcnMKZ2xHZXRQcm9ncmFtaXYoc2hhZGVyUHJvZ3JhbSwgR0xfTElOS19TVEFUVVMsICZzdWNjZXNzKTsKaWYgKCFzdWNjZXNzKSB7CiAgICBjaGFyIGluZm9Mb2dbNTEyXTsKICAgIGdsR2V0UHJvZ3JhbUluZm9Mb2coc2hhZGVyUHJvZ3JhbSwgNTEyLCBudWxscHRyLCBpbmZvTG9nKTsKICAgIHN0ZDo6Y2VyciA8PCAiRVJST1I6OlBST0dSQU06OkxJTktJTkdfRkFJTEVEXG4iIDw8IGluZm9Mb2cgPDwgc3RkOjplbmRsOwp9CgpnbERlbGV0ZVNoYWRlcihjb21wdXRlU2hhZGVyKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>GLuint computeShader = glCreateShader(GL_COMPUTE_SHADER);
const char* computeShaderSource = /* Load your compute_shader.glsl source code here */;
glShaderSource(computeShader, 1, &amp;computeShaderSource, nullptr);
glCompileShader(computeShader);

// Check for compilation errors
GLint success;
glGetShaderiv(computeShader, GL_COMPILE_STATUS, &amp;success);
if (!success) {
    char infoLog[512];
    glGetShaderInfoLog(computeShader, 512, nullptr, infoLog);
    std::cerr &lt;&lt; &quot;ERROR::SHADER::COMPUTE::COMPILATION_FAILED\n&quot; &lt;&lt; infoLog &lt;&lt; std::endl;
}

GLuint shaderProgram = glCreateProgram();
glAttachShader(shaderProgram, computeShader);
glLinkProgram(shaderProgram);

// Check for linking errors
glGetProgramiv(shaderProgram, GL_LINK_STATUS, &amp;success);
if (!success) {
    char infoLog[512];
    glGetProgramInfoLog(shaderProgram, 512, nullptr, infoLog);
    std::cerr &lt;&lt; &quot;ERROR::PROGRAM::LINKING_FAILED\n&quot; &lt;&lt; infoLog &lt;&lt; std::endl;
}

glDeleteShader(computeShader);</pre></div><div class='content'></div><h2><p>Step 3: Creating a Texture for Output</p>
</h2>
<div class='content'><p>Create a texture to store the output of the compute shader:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R0x1aW50IHRleHR1cmU7CmdsR2VuVGV4dHVyZXMoMSwgJnRleHR1cmUpOwpnbEJpbmRUZXh0dXJlKEdMX1RFWFRVUkVfMkQsIHRleHR1cmUpOwpnbFRleEltYWdlMkQoR0xfVEVYVFVSRV8yRCwgMCwgR0xfUkdCQTMyRiwgNTEyLCA1MTIsIDAsIEdMX1JHQkEsIEdMX0ZMT0FULCBudWxscHRyKTsKZ2xCaW5kSW1hZ2VUZXh0dXJlKDAsIHRleHR1cmUsIDAsIEdMX0ZBTFNFLCAwLCBHTF9XUklURV9PTkxZLCBHTF9SR0JBMzJGKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>GLuint texture;
glGenTextures(1, &amp;texture);
glBindTexture(GL_TEXTURE_2D, texture);
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA32F, 512, 512, 0, GL_RGBA, GL_FLOAT, nullptr);
glBindImageTexture(0, texture, 0, GL_FALSE, 0, GL_WRITE_ONLY, GL_RGBA32F);</pre></div><div class='content'></div><h2><p>Step 4: Dispatching the Compute Shader</p>
</h2>
<div class='content'><p>Execute the compute shader:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2xVc2VQcm9ncmFtKHNoYWRlclByb2dyYW0pOwpnbERpc3BhdGNoQ29tcHV0ZSgzMiwgMzIsIDEpOyAvLyA1MTIgLyAxNiA9IDMyCmdsTWVtb3J5QmFycmllcihHTF9TSEFERVJfSU1BR0VfQUNDRVNTX0JBUlJJRVJfQklUKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>glUseProgram(shaderProgram);
glDispatchCompute(32, 32, 1); // 512 / 16 = 32
glMemoryBarrier(GL_SHADER_IMAGE_ACCESS_BARRIER_BIT);</pre></div><div class='content'></div><h2><p>Step 5: Displaying the Result</p>
</h2>
<div class='content'><p>Render the texture to a quad to display the result:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQmluZCB0aGUgdGV4dHVyZSBhbmQgcmVuZGVyIGl0IHRvIGEgcXVhZApnbEJpbmRUZXh0dXJlKEdMX1RFWFRVUkVfMkQsIHRleHR1cmUpOwovLyBSZW5kZXIgcXVhZCBjb2RlIGhlcmUuLi4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Bind the texture and render it to a quad
glBindTexture(GL_TEXTURE_2D, texture);
// Render quad code here...</pre></div><div class='content'></div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Modify the Compute Shader</p>
</h2>
<div class='content'><p>Modify the compute shader to create a gradient that changes color based on both the x and y coordinates.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I3ZlcnNpb24gNDMwCgpsYXlvdXQgKGxvY2FsX3NpemVfeCA9IDE2LCBsb2NhbF9zaXplX3kgPSAxNikgaW47CgpsYXlvdXQgKHJnYmEzMmYsIGJpbmRpbmcgPSAwKSB1bmlmb3JtIGltYWdlMkQgaW1nX291dHB1dDsKCnZvaWQgbWFpbigpIHsKICAgIGl2ZWMyIHBpeGVsX2Nvb3JkcyA9IGl2ZWMyKGdsX0dsb2JhbEludm9jYXRpb25JRC54eSk7CiAgICB2ZWM0IHBpeGVsX2NvbG9yID0gdmVjNChmbG9hdChwaXhlbF9jb29yZHMueCkgLyA1MTIuMCwgZmxvYXQocGl4ZWxfY29vcmRzLnkpIC8gNTEyLjAsIDAuNSwgMS4wKTsKICAgIGltYWdlU3RvcmUoaW1nX291dHB1dCwgcGl4ZWxfY29vcmRzLCBwaXhlbF9jb2xvcik7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#version 430

layout (local_size_x = 16, local_size_y = 16) in;

layout (rgba32f, binding = 0) uniform image2D img_output;

void main() {
    ivec2 pixel_coords = ivec2(gl_GlobalInvocationID.xy);
    vec4 pixel_color = vec4(float(pixel_coords.x) / 512.0, float(pixel_coords.y) / 512.0, 0.5, 1.0);
    imageStore(img_output, pixel_coords, pixel_color);
}</pre></div><div class='content'></div><h2><p>Exercise 2: Implement Image Processing</p>
</h2>
<div class='content'><p>Write a compute shader that inverts the colors of an input image.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I3ZlcnNpb24gNDMwCgpsYXlvdXQgKGxvY2FsX3NpemVfeCA9IDE2LCBsb2NhbF9zaXplX3kgPSAxNikgaW47CgpsYXlvdXQgKHJnYmEzMmYsIGJpbmRpbmcgPSAwKSB1bmlmb3JtIGltYWdlMkQgaW1nX2lucHV0OwpsYXlvdXQgKHJnYmEzMmYsIGJpbmRpbmcgPSAxKSB1bmlmb3JtIGltYWdlMkQgaW1nX291dHB1dDsKCnZvaWQgbWFpbigpIHsKICAgIGl2ZWMyIHBpeGVsX2Nvb3JkcyA9IGl2ZWMyKGdsX0dsb2JhbEludm9jYXRpb25JRC54eSk7CiAgICB2ZWM0IHBpeGVsX2NvbG9yID0gaW1hZ2VMb2FkKGltZ19pbnB1dCwgcGl4ZWxfY29vcmRzKTsKICAgIHZlYzQgaW52ZXJ0ZWRfY29sb3IgPSB2ZWM0KDEuMCAtIHBpeGVsX2NvbG9yLnJnYiwgcGl4ZWxfY29sb3IuYSk7CiAgICBpbWFnZVN0b3JlKGltZ19vdXRwdXQsIHBpeGVsX2Nvb3JkcywgaW52ZXJ0ZWRfY29sb3IpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#version 430

layout (local_size_x = 16, local_size_y = 16) in;

layout (rgba32f, binding = 0) uniform image2D img_input;
layout (rgba32f, binding = 1) uniform image2D img_output;

void main() {
    ivec2 pixel_coords = ivec2(gl_GlobalInvocationID.xy);
    vec4 pixel_color = imageLoad(img_input, pixel_coords);
    vec4 inverted_color = vec4(1.0 - pixel_color.rgb, pixel_color.a);
    imageStore(img_output, pixel_coords, inverted_color);
}</pre></div><div class='content'></div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Work Group Size</strong>: Ensure the local size (e.g., <code>local_size_x</code>, <code>local_size_y</code>) matches the dimensions of your data.</li>
<li><strong>Memory Barriers</strong>: Use <code>glMemoryBarrier</code> to ensure proper synchronization between compute shader writes and subsequent reads.</li>
<li><strong>Debugging</strong>: Check for shader compilation and linking errors to avoid runtime issues.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Compute shaders provide a flexible and powerful way to leverage the GPU for general-purpose computing tasks. By understanding how to write, compile, and dispatch compute shaders, you can unlock new possibilities for performance optimization and advanced rendering techniques in your OpenGL applications. In the next topic, we will explore geometry shaders and their applications in rendering complex scenes.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-04-environment-mapping' title="Environment Mapping">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-02-geometry-shaders' title="Geometry Shaders">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
