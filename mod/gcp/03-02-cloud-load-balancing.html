<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Load Balancing</title>

    <link rel="alternate" href="https://campusempresa.com/mod/gcp/03-02-cloud-load-balancing" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/gcp/03-02-cloud-load-balancing" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/gcp/03-02-cloud-load-balancing" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/gcp/03-02-cloud-load-balancing" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/gcp/03-02-cloud-load-balancing" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='03-01-vpc-networks' title="VPC Networks">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Cloud Load Balancing</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-03-cloud-cdn' title="Cloud CDN">Next &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Cloud Load Balancing is a fully distributed, software-defined managed service for all your traffic. It provides load balancing for HTTP(S), TCP/SSL, and UDP traffic, and it can be used to distribute traffic across multiple backend instances, regions, and even hybrid environments.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li>
<p><strong>Load Balancer Types</strong>:</p>
<ul>
<li><strong>HTTP(S) Load Balancing</strong>: Distributes HTTP and HTTPS traffic.</li>
<li><strong>TCP/SSL Proxy Load Balancing</strong>: Distributes TCP and SSL traffic.</li>
<li><strong>UDP Load Balancing</strong>: Distributes UDP traffic.</li>
</ul>
</li>
<li>
<p><strong>Backend Services</strong>:</p>
<ul>
<li><strong>Instance Groups</strong>: Collections of VM instances that serve as the backend for the load balancer.</li>
<li><strong>Backend Buckets</strong>: Cloud Storage buckets that serve static content.</li>
</ul>
</li>
<li>
<p><strong>Health Checks</strong>:</p>
<ul>
<li>Regularly check the health of backend instances to ensure traffic is only sent to healthy instances.</li>
</ul>
</li>
<li>
<p><strong>URL Maps</strong>:</p>
<ul>
<li>Define how incoming requests are routed to backend services based on URL patterns.</li>
</ul>
</li>
<li>
<p><strong>SSL Certificates</strong>:</p>
<ul>
<li>Secure your load balancer with SSL certificates for HTTPS traffic.</li>
</ul>
</li>
</ol>
</div><h1>Setting Up a Load Balancer</h1>
<div class='content'></div><h2>Step 1: Create a Managed Instance Group</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2Nsb3VkIGNvbXB1dGUgaW5zdGFuY2UtZ3JvdXBzIG1hbmFnZWQgY3JlYXRlIG15LWluc3RhbmNlLWdyb3VwIFwKICAgIC0tYmFzZS1pbnN0YW5jZS1uYW1lIG15LWluc3RhbmNlIFwKICAgIC0tdGVtcGxhdGUgbXktaW5zdGFuY2UtdGVtcGxhdGUgXAogICAgLS1zaXplIDMgXAogICAgLS16b25lIHVzLWNlbnRyYWwxLWE="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcloud compute instance-groups managed create my-instance-group \
    --base-instance-name my-instance \
    --template my-instance-template \
    --size 3 \
    --zone us-central1-a</pre></div><div class='content'></div><h2>Step 2: Configure a Backend Service</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2Nsb3VkIGNvbXB1dGUgYmFja2VuZC1zZXJ2aWNlcyBjcmVhdGUgbXktYmFja2VuZC1zZXJ2aWNlIFwKICAgIC0tcHJvdG9jb2wgSFRUUCBcCiAgICAtLXBvcnQtbmFtZSBodHRwIFwKICAgIC0taGVhbHRoLWNoZWNrcyBteS1oZWFsdGgtY2hlY2sgXAogICAgLS1nbG9iYWw="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcloud compute backend-services create my-backend-service \
    --protocol HTTP \
    --port-name http \
    --health-checks my-health-check \
    --global</pre></div><div class='content'></div><h2>Step 3: Add the Instance Group to the Backend Service</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2Nsb3VkIGNvbXB1dGUgYmFja2VuZC1zZXJ2aWNlcyBhZGQtYmFja2VuZCBteS1iYWNrZW5kLXNlcnZpY2UgXAogICAgLS1pbnN0YW5jZS1ncm91cCBteS1pbnN0YW5jZS1ncm91cCBcCiAgICAtLWluc3RhbmNlLWdyb3VwLXpvbmUgdXMtY2VudHJhbDEtYSBcCiAgICAtLWdsb2JhbA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcloud compute backend-services add-backend my-backend-service \
    --instance-group my-instance-group \
    --instance-group-zone us-central1-a \
    --global</pre></div><div class='content'></div><h2>Step 4: Create a URL Map</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2Nsb3VkIGNvbXB1dGUgdXJsLW1hcHMgY3JlYXRlIG15LXVybC1tYXAgXAogICAgLS1kZWZhdWx0LXNlcnZpY2UgbXktYmFja2VuZC1zZXJ2aWNl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcloud compute url-maps create my-url-map \
    --default-service my-backend-service</pre></div><div class='content'></div><h2>Step 5: Create a Target HTTP Proxy</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2Nsb3VkIGNvbXB1dGUgdGFyZ2V0LWh0dHAtcHJveGllcyBjcmVhdGUgbXktaHR0cC1wcm94eSBcCiAgICAtLXVybC1tYXAgbXktdXJsLW1hcA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcloud compute target-http-proxies create my-http-proxy \
    --url-map my-url-map</pre></div><div class='content'></div><h2>Step 6: Create a Global Forwarding Rule</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2Nsb3VkIGNvbXB1dGUgZm9yd2FyZGluZy1ydWxlcyBjcmVhdGUgbXktaHR0cC1ydWxlIFwKICAgIC0tZ2xvYmFsIFwKICAgIC0tdGFyZ2V0LWh0dHAtcHJveHkgbXktaHR0cC1wcm94eSBcCiAgICAtLXBvcnRzIDgw"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcloud compute forwarding-rules create my-http-rule \
    --global \
    --target-http-proxy my-http-proxy \
    --ports 80</pre></div><div class='content'></div><h1>Practical Example</h1>
<div class='content'></div><h2>Example: Setting Up an HTTP Load Balancer</h2>
<div class='content'><ol>
<li>
<p><strong>Create a Health Check</strong>:</p>
<pre><code class="language-bash">gcloud compute health-checks create http my-health-check <br>        --port 80 <br>        --request-path /
</code></pre>
</li>
<li>
<p><strong>Create a Managed Instance Group</strong>:</p>
<pre><code class="language-bash">gcloud compute instance-templates create my-template <br>        --machine-type n1-standard-1 <br>        --image-family debian-9 <br>        --image-project debian-cloud <br>        --metadata startup-script='#! /bin/bash
    sudo apt-get update
    sudo apt-get install -y apache2
    sudo service apache2 restart'
</code></pre>
<pre><code class="language-bash">gcloud compute instance-groups managed create my-instance-group <br>        --base-instance-name my-instance <br>        --template my-template <br>        --size 2 <br>        --zone us-central1-a
</code></pre>
</li>
<li>
<p><strong>Create a Backend Service</strong>:</p>
<pre><code class="language-bash">gcloud compute backend-services create my-backend-service <br>        --protocol HTTP <br>        --port-name http <br>        --health-checks my-health-check <br>        --global
</code></pre>
</li>
<li>
<p><strong>Add the Instance Group to the Backend Service</strong>:</p>
<pre><code class="language-bash">gcloud compute backend-services add-backend my-backend-service <br>        --instance-group my-instance-group <br>        --instance-group-zone us-central1-a <br>        --global
</code></pre>
</li>
<li>
<p><strong>Create a URL Map</strong>:</p>
<pre><code class="language-bash">gcloud compute url-maps create my-url-map <br>        --default-service my-backend-service
</code></pre>
</li>
<li>
<p><strong>Create a Target HTTP Proxy</strong>:</p>
<pre><code class="language-bash">gcloud compute target-http-proxies create my-http-proxy <br>        --url-map my-url-map
</code></pre>
</li>
<li>
<p><strong>Create a Global Forwarding Rule</strong>:</p>
<pre><code class="language-bash">gcloud compute forwarding-rules create my-http-rule <br>        --global <br>        --target-http-proxy my-http-proxy <br>        --ports 80
</code></pre>
</li>
</ol>
</div><h1>Exercises</h1>
<div class='content'></div><h2>Exercise 1: Create a Load Balancer for HTTPS Traffic</h2>
<div class='content'><ol>
<li>
<p><strong>Create an SSL Certificate</strong>:</p>
<pre><code class="language-bash">gcloud compute ssl-certificates create my-ssl-cert <br>        --certificate /path/to/cert.pem <br>        --private-key /path/to/key.pem
</code></pre>
</li>
<li>
<p><strong>Create a Target HTTPS Proxy</strong>:</p>
<pre><code class="language-bash">gcloud compute target-https-proxies create my-https-proxy <br>        --url-map my-url-map <br>        --ssl-certificates my-ssl-cert
</code></pre>
</li>
<li>
<p><strong>Create a Global Forwarding Rule for HTTPS</strong>:</p>
<pre><code class="language-bash">gcloud compute forwarding-rules create my-https-rule <br>        --global <br>        --target-https-proxy my-https-proxy <br>        --ports 443
</code></pre>
</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><ol>
<li>
<p><strong>Create an SSL Certificate</strong>:</p>
<pre><code class="language-bash">gcloud compute ssl-certificates create my-ssl-cert <br>        --certificate /path/to/cert.pem <br>        --private-key /path/to/key.pem
</code></pre>
</li>
<li>
<p><strong>Create a Target HTTPS Proxy</strong>:</p>
<pre><code class="language-bash">gcloud compute target-https-proxies create my-https-proxy <br>        --url-map my-url-map <br>        --ssl-certificates my-ssl-cert
</code></pre>
</li>
<li>
<p><strong>Create a Global Forwarding Rule for HTTPS</strong>:</p>
<pre><code class="language-bash">gcloud compute forwarding-rules create my-https-rule <br>        --global <br>        --target-https-proxy my-https-proxy <br>        --ports 443
</code></pre>
</li>
</ol>
</div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Health Check Configuration</strong>: Ensure that your health checks are correctly configured to match the expected response from your backend instances.</li>
<li><strong>Instance Group Location</strong>: Make sure your instance groups are in the same region as your backend services.</li>
<li><strong>SSL Certificates</strong>: Use managed SSL certificates for easier management and automatic renewal.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, you learned about the different types of load balancers available in GCP and how to set up an HTTP load balancer. You also practiced creating an HTTPS load balancer. Understanding and implementing load balancing is crucial for distributing traffic efficiently and ensuring high availability and reliability of your applications. In the next section, we will dive into Cloud CDN to further optimize your content delivery.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='03-01-vpc-networks' title="VPC Networks">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-03-cloud-cdn' title="Cloud CDN">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
