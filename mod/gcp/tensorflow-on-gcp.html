<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TensorFlow on GCP</title>

    <link rel="alternate" href="https://campusempresa.com/mod/gcp/tensorflow-on-gcp" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/gcp/tensorflow-on-gcp" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/gcp/tensorflow-on-gcp" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/gcp/tensorflow-on-gcp" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/gcp/tensorflow-on-gcp" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='automl'>&#x25C4;AutoML</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">TensorFlow on GCP</a>
	</div>
	<div class='col-4 text-end'>
					<a href='cloud-build'>Cloud Build &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to TensorFlow and GCP</h1>
<div class='content'><p>TensorFlow is an open-source machine learning framework developed by Google, and GCP (Google Cloud Platform) provides a suite of cloud computing services that run on the same infrastructure that Google uses internally. Combining TensorFlow with GCP allows for scalable, efficient, and powerful machine learning workflows.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>TensorFlow</strong>: A comprehensive, flexible ecosystem of tools, libraries, and community resources that lets researchers push the state-of-the-art in ML, and developers easily build and deploy ML-powered applications.</li>
<li><strong>GCP</strong>: A suite of cloud computing services that includes computing, data storage, data analytics, and machine learning.</li>
</ul>
</div><h1>Setting Up TensorFlow on GCP</h1>
<div class='content'><p>Before diving into TensorFlow on GCP, you need to set up your environment.</p>
</div><h2>Creating a GCP Account</h2>
<div class='content'><ol>
<li>Go to the <a href="https://console.cloud.google.com/">Google Cloud Console</a>.</li>
<li>Sign up for a new account or log in with your existing Google account.</li>
<li>Set up billing information to access free tier services.</li>
</ol>
</div><h2>Setting Up a Virtual Machine</h2>
<div class='content'><ol>
<li>Navigate to the Compute Engine section.</li>
<li>Create a new VM instance.</li>
<li>Choose a machine type suitable for your workload (e.g., n1-standard-4).</li>
<li>Select a TensorFlow image from the Google Cloud Marketplace.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2Nsb3VkIGNvbXB1dGUgaW5zdGFuY2VzIGNyZWF0ZSB0ZW5zb3JmbG93LWluc3RhbmNlIFwKICAgIC0taW1hZ2UtZmFtaWx5PXRmLWxhdGVzdC1ncHUgXAogICAgLS1pbWFnZS1wcm9qZWN0PWRlZXBsZWFybmluZy1wbGF0Zm9ybS1yZWxlYXNlIFwKICAgIC0tbWFjaGluZS10eXBlPW4xLXN0YW5kYXJkLTQgXAogICAgLS16b25lPXVzLWNlbnRyYWwxLWE="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcloud compute instances create tensorflow-instance \
    --image-family=tf-latest-gpu \
    --image-project=deeplearning-platform-release \
    --machine-type=n1-standard-4 \
    --zone=us-central1-a</pre></div><div class='content'></div><h2>Installing TensorFlow</h2>
<div class='content'><p>If you prefer to install TensorFlow manually, you can SSH into your VM and run:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3VkbyBhcHQtZ2V0IHVwZGF0ZQpzdWRvIGFwdC1nZXQgaW5zdGFsbCBweXRob24zLXBpcApwaXAzIGluc3RhbGwgdGVuc29yZmxvdw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sudo apt-get update
sudo apt-get install python3-pip
pip3 install tensorflow</pre></div><div class='content'></div><h1>Building and Training Models</h1>
<div class='content'><p>Once your environment is set up, you can start building and training models.</p>
</div><h2>Example: Linear Regression with TensorFlow</h2>
<div class='content'><p>Here’s a simple example of linear regression using TensorFlow.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKaW1wb3J0IG51bXB5IGFzIG5wCgojIEdlbmVyYXRlIHN5bnRoZXRpYyBkYXRhClggPSBucC5hcnJheShbMS4wLCAyLjAsIDMuMCwgNC4wXSwgZHR5cGU9bnAuZmxvYXQzMikKWSA9IG5wLmFycmF5KFsyLjAsIDQuMCwgNi4wLCA4LjBdLCBkdHlwZT1ucC5mbG9hdDMyKQoKIyBEZWZpbmUgdGhlIG1vZGVsCm1vZGVsID0gdGYua2VyYXMuU2VxdWVudGlhbChbdGYua2VyYXMubGF5ZXJzLkRlbnNlKHVuaXRzPTEsIGlucHV0X3NoYXBlPVsxXSldKQoKIyBDb21waWxlIHRoZSBtb2RlbAptb2RlbC5jb21waWxlKG9wdGltaXplcj0nc2dkJywgbG9zcz0nbWVhbl9zcXVhcmVkX2Vycm9yJykKCiMgVHJhaW4gdGhlIG1vZGVsCm1vZGVsLmZpdChYLCBZLCBlcG9jaHM9NTAwKQoKIyBQcmVkaWN0CnByaW50KG1vZGVsLnByZWRpY3QoWzUuMF0pKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
import numpy as np

# Generate synthetic data
X = np.array([1.0, 2.0, 3.0, 4.0], dtype=np.float32)
Y = np.array([2.0, 4.0, 6.0, 8.0], dtype=np.float32)

# Define the model
model = tf.keras.Sequential([tf.keras.layers.Dense(units=1, input_shape=[1])])

# Compile the model
model.compile(optimizer='sgd', loss='mean_squared_error')

# Train the model
model.fit(X, Y, epochs=500)

# Predict
print(model.predict([5.0]))</pre></div><div class='content'></div><h2>Using GCP AI Platform for Training</h2>
<div class='content'><p>GCP AI Platform provides managed services for training and deploying ML models.</p>
<ol>
<li><strong>Prepare your training application</strong>: Package your TensorFlow code.</li>
<li><strong>Submit a training job</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2Nsb3VkIGFpLXBsYXRmb3JtIGpvYnMgc3VibWl0IHRyYWluaW5nIG15X2pvYiBcCiAgICAtLW1vZHVsZS1uYW1lIHRyYWluZXIudGFzayBcCiAgICAtLXBhY2thZ2UtcGF0aCAuL3RyYWluZXIgXAogICAgLS1yZWdpb24gdXMtY2VudHJhbDEgXAogICAgLS1weXRob24tdmVyc2lvbiAzLjcgXAogICAgLS1ydW50aW1lLXZlcnNpb24gMi4x"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcloud ai-platform jobs submit training my_job \
    --module-name trainer.task \
    --package-path ./trainer \
    --region us-central1 \
    --python-version 3.7 \
    --runtime-version 2.1</pre></div><div class='content'></div><h1>Deploying Models on GCP</h1>
<div class='content'><p>After training your model, you can deploy it on GCP for serving predictions.</p>
</div><h2>Using AI Platform for Model Deployment</h2>
<div class='content'><ol>
<li><strong>Save your model</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwuc2F2ZSgnbXlfbW9kZWwuaDUnKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model.save('my_model.h5')</pre></div><div class='content'><ol start="2">
<li><strong>Upload the model to Google Cloud Storage</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z3N1dGlsIGNwIG15X21vZGVsLmg1IGdzOi8vbXktYnVja2V0L21vZGVscy9teV9tb2RlbC5oNQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gsutil cp my_model.h5 gs://my-bucket/models/my_model.h5</pre></div><div class='content'><ol start="3">
<li><strong>Create a model on AI Platform</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2Nsb3VkIGFpLXBsYXRmb3JtIG1vZGVscyBjcmVhdGUgbXlfbW9kZWw="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcloud ai-platform models create my_model</pre></div><div class='content'><ol start="4">
<li><strong>Create a model version</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2Nsb3VkIGFpLXBsYXRmb3JtIHZlcnNpb25zIGNyZWF0ZSB2MSBcCiAgICAtLW1vZGVsIG15X21vZGVsIFwKICAgIC0tb3JpZ2luIGdzOi8vbXktYnVja2V0L21vZGVscy9teV9tb2RlbC5oNSBcCiAgICAtLXJ1bnRpbWUtdmVyc2lvbiAyLjEgXAogICAgLS1weXRob24tdmVyc2lvbiAzLjc="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcloud ai-platform versions create v1 \
    --model my_model \
    --origin gs://my-bucket/models/my_model.h5 \
    --runtime-version 2.1 \
    --python-version 3.7</pre></div><div class='content'><ol start="5">
<li><strong>Make predictions</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IGFpcGxhdGZvcm0KCmNsaWVudCA9IGFpcGxhdGZvcm0uZ2FwaWMuUHJlZGljdGlvblNlcnZpY2VDbGllbnQoKQpuYW1lID0gY2xpZW50Lm1vZGVsX3BhdGgoJ215X3Byb2plY3QnLCAnbXlfbW9kZWwnLCAndjEnKQpyZXNwb25zZSA9IGNsaWVudC5wcmVkaWN0KG5hbWU9bmFtZSwgaW5zdGFuY2VzPVtbNS4wXV0pCnByaW50KHJlc3BvbnNlKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import aiplatform

client = aiplatform.gapic.PredictionServiceClient()
name = client.model_path('my_project', 'my_model', 'v1')
response = client.predict(name=name, instances=[[5.0]])
print(response)</pre></div><div class='content'></div><h1>Monitoring and Optimization</h1>
<div class='content'><p>Monitoring and optimizing your TensorFlow models on GCP is crucial for maintaining performance and cost-efficiency.</p>
</div><h2>Monitoring with Stackdriver</h2>
<div class='content'><ul>
<li><strong>Set up Stackdriver</strong>: Use Stackdriver to monitor your VM instances and TensorFlow jobs.</li>
<li><strong>Log metrics</strong>: Integrate logging in your TensorFlow code to track performance metrics.</li>
</ul>
</div><h2>Optimization Tips</h2>
<div class='content'><ul>
<li><strong>Use Preemptible VMs</strong>: Reduce costs by using preemptible VMs for non-critical workloads.</li>
<li><strong>Optimize Data Pipelines</strong>: Use GCP services like Dataflow and BigQuery to optimize data processing.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>TensorFlow on GCP offers a powerful combination for building, training, and deploying machine learning models at scale. By leveraging GCP's infrastructure and TensorFlow's capabilities, you can create efficient and scalable ML workflows. This course has covered the basics of setting up your environment, building and training models, deploying them, and monitoring their performance. With these skills, you are well-equipped to tackle more advanced machine learning projects on GCP.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='automl'>&#x25C4;AutoML</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">TensorFlow on GCP</a>
	</div>
	<div class='col-4 text-end'>
					<a href='cloud-build'>Cloud Build &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
