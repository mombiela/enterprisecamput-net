<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Pub/Sub</title>

    <link rel="alternate" href="https://campusempresa.com/mod/gcp/04-04-cloud-pubsub" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/gcp/04-04-cloud-pubsub" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/gcp/04-04-cloud-pubsub" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/gcp/04-04-cloud-pubsub" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/gcp/04-04-cloud-pubsub" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-03-cloud-dataproc' title="Cloud Dataproc">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Cloud Pub/Sub</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-05-cloud-data-fusion' title="Cloud Data Fusion">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1><p>Introduction</p>
</h1>
<div class='content'><p>Cloud Pub/Sub is a fully-managed real-time messaging service that allows you to send and receive messages between independent applications. It decouples services that produce events from services that process events, enabling you to build scalable and reliable systems.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Topics</strong>: Named resources to which messages are sent by publishers.</li>
<li><strong>Subscriptions</strong>: Named resources representing the stream of messages from a single, specific topic, to be delivered to the subscribing application.</li>
<li><strong>Messages</strong>: Data that is sent to a topic by a publisher and received from a subscription by a subscriber.</li>
<li><strong>Publisher</strong>: An application that creates and sends messages to a topic.</li>
<li><strong>Subscriber</strong>: An application that receives messages from a subscription.</li>
</ol>
</div><h1><p>How Cloud Pub/Sub Works</p>
</h1>
<div class='content'><ol>
<li><strong>Publish/Subscribe Model</strong>: Publishers send messages to topics. Subscribers create subscriptions to these topics to receive messages.</li>
<li><strong>Message Delivery</strong>: Messages are delivered at least once to each subscription. Pub/Sub ensures that messages are delivered in the order they were published.</li>
<li><strong>Acknowledgements</strong>: Subscribers must acknowledge each message they receive. If a message is not acknowledged within a certain period, it is redelivered.</li>
</ol>
</div><h1><p>Setting Up Cloud Pub/Sub</p>
</h1>
<div class='content'></div><h2><p>Step 1: Create a Topic</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IHB1YnN1Yl92MQoKIyBJbml0aWFsaXplIGEgUHVibGlzaGVyIGNsaWVudApwdWJsaXNoZXIgPSBwdWJzdWJfdjEuUHVibGlzaGVyQ2xpZW50KCkKIyBEZWZpbmUgdGhlIHRvcGljIHBhdGgKdG9waWNfcGF0aCA9IHB1Ymxpc2hlci50b3BpY19wYXRoKCd5b3VyLXByb2plY3QtaWQnLCAneW91ci10b3BpYy1uYW1lJykKCiMgQ3JlYXRlIHRoZSB0b3BpYwp0b3BpYyA9IHB1Ymxpc2hlci5jcmVhdGVfdG9waWMocmVxdWVzdD17Im5hbWUiOiB0b3BpY19wYXRofSkKcHJpbnQoZiJUb3BpYyBjcmVhdGVkOiB7dG9waWMubmFtZX0iKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import pubsub_v1

# Initialize a Publisher client
publisher = pubsub_v1.PublisherClient()
# Define the topic path
topic_path = publisher.topic_path('your-project-id', 'your-topic-name')

# Create the topic
topic = publisher.create_topic(request={&quot;name&quot;: topic_path})
print(f&quot;Topic created: {topic.name}&quot;)</pre></div><div class='content'></div><h2><p>Step 2: Create a Subscription</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IHB1YnN1Yl92MQoKIyBJbml0aWFsaXplIGEgU3Vic2NyaWJlciBjbGllbnQKc3Vic2NyaWJlciA9IHB1YnN1Yl92MS5TdWJzY3JpYmVyQ2xpZW50KCkKIyBEZWZpbmUgdGhlIHN1YnNjcmlwdGlvbiBwYXRoCnN1YnNjcmlwdGlvbl9wYXRoID0gc3Vic2NyaWJlci5zdWJzY3JpcHRpb25fcGF0aCgneW91ci1wcm9qZWN0LWlkJywgJ3lvdXItc3Vic2NyaXB0aW9uLW5hbWUnKQoKIyBDcmVhdGUgdGhlIHN1YnNjcmlwdGlvbgpzdWJzY3JpcHRpb24gPSBzdWJzY3JpYmVyLmNyZWF0ZV9zdWJzY3JpcHRpb24oCiAgICByZXF1ZXN0PXsibmFtZSI6IHN1YnNjcmlwdGlvbl9wYXRoLCAidG9waWMiOiB0b3BpY19wYXRofQopCnByaW50KGYiU3Vic2NyaXB0aW9uIGNyZWF0ZWQ6IHtzdWJzY3JpcHRpb24ubmFtZX0iKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import pubsub_v1

# Initialize a Subscriber client
subscriber = pubsub_v1.SubscriberClient()
# Define the subscription path
subscription_path = subscriber.subscription_path('your-project-id', 'your-subscription-name')

# Create the subscription
subscription = subscriber.create_subscription(
    request={&quot;name&quot;: subscription_path, &quot;topic&quot;: topic_path}
)
print(f&quot;Subscription created: {subscription.name}&quot;)</pre></div><div class='content'></div><h2><p>Step 3: Publish Messages</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IHB1YnN1Yl92MQoKIyBJbml0aWFsaXplIGEgUHVibGlzaGVyIGNsaWVudApwdWJsaXNoZXIgPSBwdWJzdWJfdjEuUHVibGlzaGVyQ2xpZW50KCkKIyBEZWZpbmUgdGhlIHRvcGljIHBhdGgKdG9waWNfcGF0aCA9IHB1Ymxpc2hlci50b3BpY19wYXRoKCd5b3VyLXByb2plY3QtaWQnLCAneW91ci10b3BpYy1uYW1lJykKCiMgUHVibGlzaCBhIG1lc3NhZ2UKbWVzc2FnZV9kYXRhID0gIkhlbGxvLCBXb3JsZCEiCmZ1dHVyZSA9IHB1Ymxpc2hlci5wdWJsaXNoKHRvcGljX3BhdGgsIG1lc3NhZ2VfZGF0YS5lbmNvZGUoInV0Zi04IikpCnByaW50KGYiUHVibGlzaGVkIG1lc3NhZ2UgSUQ6IHtmdXR1cmUucmVzdWx0KCl9Iik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import pubsub_v1

# Initialize a Publisher client
publisher = pubsub_v1.PublisherClient()
# Define the topic path
topic_path = publisher.topic_path('your-project-id', 'your-topic-name')

# Publish a message
message_data = &quot;Hello, World!&quot;
future = publisher.publish(topic_path, message_data.encode(&quot;utf-8&quot;))
print(f&quot;Published message ID: {future.result()}&quot;)</pre></div><div class='content'></div><h2><p>Step 4: Receive Messages</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IHB1YnN1Yl92MQoKIyBJbml0aWFsaXplIGEgU3Vic2NyaWJlciBjbGllbnQKc3Vic2NyaWJlciA9IHB1YnN1Yl92MS5TdWJzY3JpYmVyQ2xpZW50KCkKIyBEZWZpbmUgdGhlIHN1YnNjcmlwdGlvbiBwYXRoCnN1YnNjcmlwdGlvbl9wYXRoID0gc3Vic2NyaWJlci5zdWJzY3JpcHRpb25fcGF0aCgneW91ci1wcm9qZWN0LWlkJywgJ3lvdXItc3Vic2NyaXB0aW9uLW5hbWUnKQoKZGVmIGNhbGxiYWNrKG1lc3NhZ2UpOgogICAgcHJpbnQoZiJSZWNlaXZlZCBtZXNzYWdlOiB7bWVzc2FnZS5kYXRhfSIpCiAgICBtZXNzYWdlLmFjaygpCgojIFN1YnNjcmliZSB0byB0aGUgc3Vic2NyaXB0aW9uCnN0cmVhbWluZ19wdWxsX2Z1dHVyZSA9IHN1YnNjcmliZXIuc3Vic2NyaWJlKHN1YnNjcmlwdGlvbl9wYXRoLCBjYWxsYmFjaz1jYWxsYmFjaykKcHJpbnQoZiJMaXN0ZW5pbmcgZm9yIG1lc3NhZ2VzIG9uIHtzdWJzY3JpcHRpb25fcGF0aH0uLi4iKQoKIyBLZWVwIHRoZSBtYWluIHRocmVhZCBhbGl2ZSB0byBsaXN0ZW4gZm9yIG1lc3NhZ2VzCnRyeToKICAgIHN0cmVhbWluZ19wdWxsX2Z1dHVyZS5yZXN1bHQoKQpleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICBzdHJlYW1pbmdfcHVsbF9mdXR1cmUuY2FuY2VsKCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import pubsub_v1

# Initialize a Subscriber client
subscriber = pubsub_v1.SubscriberClient()
# Define the subscription path
subscription_path = subscriber.subscription_path('your-project-id', 'your-subscription-name')

def callback(message):
    print(f&quot;Received message: {message.data}&quot;)
    message.ack()

# Subscribe to the subscription
streaming_pull_future = subscriber.subscribe(subscription_path, callback=callback)
print(f&quot;Listening for messages on {subscription_path}...&quot;)

# Keep the main thread alive to listen for messages
try:
    streaming_pull_future.result()
except KeyboardInterrupt:
    streaming_pull_future.cancel()</pre></div><div class='content'></div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Implement a Simple Pub/Sub System</p>
</h2>
<div class='content'><ol>
<li><strong>Objective</strong>: Create a topic, a subscription, publish messages to the topic, and receive messages from the subscription.</li>
<li><strong>Steps</strong>:
<ul>
<li>Create a new topic named <code>test-topic</code>.</li>
<li>Create a subscription named <code>test-subscription</code> to the <code>test-topic</code>.</li>
<li>Publish a message &quot;Hello, Pub/Sub!&quot; to the <code>test-topic</code>.</li>
<li>Receive and print the message from <code>test-subscription</code>.</li>
</ul>
</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IHB1YnN1Yl92MQoKIyBJbml0aWFsaXplIGNsaWVudHMKcHVibGlzaGVyID0gcHVic3ViX3YxLlB1Ymxpc2hlckNsaWVudCgpCnN1YnNjcmliZXIgPSBwdWJzdWJfdjEuU3Vic2NyaWJlckNsaWVudCgpCgojIERlZmluZSBwYXRocwpwcm9qZWN0X2lkID0gJ3lvdXItcHJvamVjdC1pZCcKdG9waWNfbmFtZSA9ICd0ZXN0LXRvcGljJwpzdWJzY3JpcHRpb25fbmFtZSA9ICd0ZXN0LXN1YnNjcmlwdGlvbicKdG9waWNfcGF0aCA9IHB1Ymxpc2hlci50b3BpY19wYXRoKHByb2plY3RfaWQsIHRvcGljX25hbWUpCnN1YnNjcmlwdGlvbl9wYXRoID0gc3Vic2NyaWJlci5zdWJzY3JpcHRpb25fcGF0aChwcm9qZWN0X2lkLCBzdWJzY3JpcHRpb25fbmFtZSkKCiMgQ3JlYXRlIHRvcGljCnRvcGljID0gcHVibGlzaGVyLmNyZWF0ZV90b3BpYyhyZXF1ZXN0PXsibmFtZSI6IHRvcGljX3BhdGh9KQpwcmludChmIlRvcGljIGNyZWF0ZWQ6IHt0b3BpYy5uYW1lfSIpCgojIENyZWF0ZSBzdWJzY3JpcHRpb24Kc3Vic2NyaXB0aW9uID0gc3Vic2NyaWJlci5jcmVhdGVfc3Vic2NyaXB0aW9uKAogICAgcmVxdWVzdD17Im5hbWUiOiBzdWJzY3JpcHRpb25fcGF0aCwgInRvcGljIjogdG9waWNfcGF0aH0KKQpwcmludChmIlN1YnNjcmlwdGlvbiBjcmVhdGVkOiB7c3Vic2NyaXB0aW9uLm5hbWV9IikKCiMgUHVibGlzaCBtZXNzYWdlCm1lc3NhZ2VfZGF0YSA9ICJIZWxsbywgUHViL1N1YiEiCmZ1dHVyZSA9IHB1Ymxpc2hlci5wdWJsaXNoKHRvcGljX3BhdGgsIG1lc3NhZ2VfZGF0YS5lbmNvZGUoInV0Zi04IikpCnByaW50KGYiUHVibGlzaGVkIG1lc3NhZ2UgSUQ6IHtmdXR1cmUucmVzdWx0KCl9IikKCiMgUmVjZWl2ZSBtZXNzYWdlCmRlZiBjYWxsYmFjayhtZXNzYWdlKToKICAgIHByaW50KGYiUmVjZWl2ZWQgbWVzc2FnZToge21lc3NhZ2UuZGF0YX0iKQogICAgbWVzc2FnZS5hY2soKQoKc3RyZWFtaW5nX3B1bGxfZnV0dXJlID0gc3Vic2NyaWJlci5zdWJzY3JpYmUoc3Vic2NyaXB0aW9uX3BhdGgsIGNhbGxiYWNrPWNhbGxiYWNrKQpwcmludChmIkxpc3RlbmluZyBmb3IgbWVzc2FnZXMgb24ge3N1YnNjcmlwdGlvbl9wYXRofS4uLiIpCgp0cnk6CiAgICBzdHJlYW1pbmdfcHVsbF9mdXR1cmUucmVzdWx0KCkKZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgc3RyZWFtaW5nX3B1bGxfZnV0dXJlLmNhbmNlbCgp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import pubsub_v1

# Initialize clients
publisher = pubsub_v1.PublisherClient()
subscriber = pubsub_v1.SubscriberClient()

# Define paths
project_id = 'your-project-id'
topic_name = 'test-topic'
subscription_name = 'test-subscription'
topic_path = publisher.topic_path(project_id, topic_name)
subscription_path = subscriber.subscription_path(project_id, subscription_name)

# Create topic
topic = publisher.create_topic(request={&quot;name&quot;: topic_path})
print(f&quot;Topic created: {topic.name}&quot;)

# Create subscription
subscription = subscriber.create_subscription(
    request={&quot;name&quot;: subscription_path, &quot;topic&quot;: topic_path}
)
print(f&quot;Subscription created: {subscription.name}&quot;)

# Publish message
message_data = &quot;Hello, Pub/Sub!&quot;
future = publisher.publish(topic_path, message_data.encode(&quot;utf-8&quot;))
print(f&quot;Published message ID: {future.result()}&quot;)

# Receive message
def callback(message):
    print(f&quot;Received message: {message.data}&quot;)
    message.ack()

streaming_pull_future = subscriber.subscribe(subscription_path, callback=callback)
print(f&quot;Listening for messages on {subscription_path}...&quot;)

try:
    streaming_pull_future.result()
except KeyboardInterrupt:
    streaming_pull_future.cancel()</pre></div><div class='content'></div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Message Acknowledgement</strong>: Always acknowledge messages after processing them to prevent redelivery.</li>
<li><strong>Error Handling</strong>: Implement error handling in your callback function to manage exceptions and ensure the subscriber continues to receive messages.</li>
<li><strong>Resource Cleanup</strong>: Properly clean up resources (topics, subscriptions) when they are no longer needed to avoid unnecessary charges.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, you learned about Cloud Pub/Sub, its key concepts, and how to set up and use it for real-time messaging. You also implemented a simple Pub/Sub system to publish and receive messages. This knowledge is crucial for building scalable and decoupled systems on Google Cloud Platform. In the next module, we will explore more data and analytics services offered by GCP.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-03-cloud-dataproc' title="Cloud Dataproc">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-05-cloud-data-fusion' title="Cloud Data Fusion">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
