<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relay</title>

    <link rel="alternate" href="https://campusempresa.com/mod/graphql/relay" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/graphql/relay" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/graphql/relay" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/graphql/relay" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/graphql/relay" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='apollo-client'>&#x25C4;Apollo Client</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Relay</a>
	</div>
	<div class='col-4 text-end'>
					<a href='graphql-subscriptions'>GraphQL Subscriptions &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Relay is a powerful JavaScript framework for building data-driven React applications with GraphQL. It provides a set of conventions and tools to help you efficiently fetch and manage data in your React components.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Declarative Data Fetching</strong>: Relay allows you to declare the data requirements of your components using GraphQL queries.</li>
<li><strong>Colocation</strong>: Queries are colocated with the components that use the data, making it easier to understand the data dependencies.</li>
<li><strong>Fragments</strong>: Relay uses GraphQL fragments to allow components to specify their data requirements.</li>
<li><strong>Mutations</strong>: Relay provides a way to handle GraphQL mutations, ensuring that the UI stays in sync with the server state.</li>
<li><strong>Pagination and Refetching</strong>: Relay has built-in support for pagination and refetching data.</li>
</ul>
</div><h1>Getting Started with Relay</h1>
<div class='content'><p>To get started with Relay, you need to set up your project with the necessary dependencies and configurations.</p>
</div><h2>Installation</h2>
<div class='content'><p>First, install the required packages:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnBtIGluc3RhbGwgcmVhY3QtcmVsYXkgcmVsYXktcnVudGltZSBncmFwaHFs"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>npm install react-relay relay-runtime graphql</pre></div><div class='content'></div><h2>Setting Up Relay Environment</h2>
<div class='content'><p>Relay requires a network layer to fetch data from your GraphQL server. Here's how you can set up a basic environment:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHsKICBFbnZpcm9ubWVudCwKICBOZXR3b3JrLAogIFJlY29yZFNvdXJjZSwKICBTdG9yZSwKfSBmcm9tICdyZWxheS1ydW50aW1lJzsKCmZ1bmN0aW9uIGZldGNoUXVlcnkob3BlcmF0aW9uLCB2YXJpYWJsZXMpIHsKICByZXR1cm4gZmV0Y2goJy9ncmFwaHFsJywgewogICAgbWV0aG9kOiAnUE9TVCcsCiAgICBoZWFkZXJzOiB7CiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsCiAgICB9LAogICAgYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICBxdWVyeTogb3BlcmF0aW9uLnRleHQsCiAgICAgIHZhcmlhYmxlcywKICAgIH0pLAogIH0pLnRoZW4ocmVzcG9uc2UgPT4gcmVzcG9uc2UuanNvbigpKTsKfQoKY29uc3QgZW52aXJvbm1lbnQgPSBuZXcgRW52aXJvbm1lbnQoewogIG5ldHdvcms6IE5ldHdvcmsuY3JlYXRlKGZldGNoUXVlcnkpLAogIHN0b3JlOiBuZXcgU3RvcmUobmV3IFJlY29yZFNvdXJjZSgpKSwKfSk7CgpleHBvcnQgZGVmYXVsdCBlbnZpcm9ubWVudDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import {
  Environment,
  Network,
  RecordSource,
  Store,
} from 'relay-runtime';

function fetchQuery(operation, variables) {
  return fetch('/graphql', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      query: operation.text,
      variables,
    }),
  }).then(response =&gt; response.json());
}

const environment = new Environment({
  network: Network.create(fetchQuery),
  store: new Store(new RecordSource()),
});

export default environment;</pre></div><div class='content'></div><h1>Declarative Data Fetching</h1>
<div class='content'><p>Relay allows you to declare the data requirements of your components using GraphQL queries. This is done using the <code>graphql</code> tag.</p>
</div><h2>Example Component with Data Fetching</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JzsKaW1wb3J0IHsgZ3JhcGhxbCwgUXVlcnlSZW5kZXJlciB9IGZyb20gJ3JlYWN0LXJlbGF5JzsKaW1wb3J0IGVudmlyb25tZW50IGZyb20gJy4vZW52aXJvbm1lbnQnOwoKY29uc3QgVXNlclF1ZXJ5ID0gZ3JhcGhxbGAKICBxdWVyeSBBcHBVc2VyUXVlcnkoJGlkOiBJRCEpIHsKICAgIHVzZXIoaWQ6ICRpZCkgewogICAgICBuYW1lCiAgICAgIGVtYWlsCiAgICB9CiAgfQpgOwoKZnVuY3Rpb24gQXBwKHsgdXNlcklkIH0pIHsKICByZXR1cm4gKAogICAgPFF1ZXJ5UmVuZGVyZXIKICAgICAgZW52aXJvbm1lbnQ9e2Vudmlyb25tZW50fQogICAgICBxdWVyeT17VXNlclF1ZXJ5fQogICAgICB2YXJpYWJsZXM9e3sgaWQ6IHVzZXJJZCB9fQogICAgICByZW5kZXI9eyh7IGVycm9yLCBwcm9wcyB9KSA9PiB7CiAgICAgICAgaWYgKGVycm9yKSB7CiAgICAgICAgICByZXR1cm4gPGRpdj5FcnJvcjoge2Vycm9yLm1lc3NhZ2V9PC9kaXY+OwogICAgICAgIH0KICAgICAgICBpZiAoIXByb3BzKSB7CiAgICAgICAgICByZXR1cm4gPGRpdj5Mb2FkaW5nLi4uPC9kaXY+OwogICAgICAgIH0KICAgICAgICByZXR1cm4gKAogICAgICAgICAgPGRpdj4KICAgICAgICAgICAgPGgxPntwcm9wcy51c2VyLm5hbWV9PC9oMT4KICAgICAgICAgICAgPHA+e3Byb3BzLnVzZXIuZW1haWx9PC9wPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgKTsKICAgICAgfX0KICAgIC8+CiAgKTsKfQoKZXhwb3J0IGRlZmF1bHQgQXBwOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import React from 'react';
import { graphql, QueryRenderer } from 'react-relay';
import environment from './environment';

const UserQuery = graphql`
  query AppUserQuery($id: ID!) {
    user(id: $id) {
      name
      email
    }
  }
`;

function App({ userId }) {
  return (
    &lt;QueryRenderer
      environment={environment}
      query={UserQuery}
      variables={{ id: userId }}
      render={({ error, props }) =&gt; {
        if (error) {
          return &lt;div&gt;Error: {error.message}&lt;/div&gt;;
        }
        if (!props) {
          return &lt;div&gt;Loading...&lt;/div&gt;;
        }
        return (
          &lt;div&gt;
            &lt;h1&gt;{props.user.name}&lt;/h1&gt;
            &lt;p&gt;{props.user.email}&lt;/p&gt;
          &lt;/div&gt;
        );
      }}
    /&gt;
  );
}

export default App;</pre></div><div class='content'></div><h1>Fragments</h1>
<div class='content'><p>Fragments allow components to specify their data requirements. This promotes reusability and modularity.</p>
</div><h2>Example of Using Fragments</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JzsKaW1wb3J0IHsgY3JlYXRlRnJhZ21lbnRDb250YWluZXIsIGdyYXBocWwgfSBmcm9tICdyZWFjdC1yZWxheSc7CgpmdW5jdGlvbiBVc2VyUHJvZmlsZSh7IHVzZXIgfSkgewogIHJldHVybiAoCiAgICA8ZGl2PgogICAgICA8aDE+e3VzZXIubmFtZX08L2gxPgogICAgICA8cD57dXNlci5lbWFpbH08L3A+CiAgICA8L2Rpdj4KICApOwp9CgpleHBvcnQgZGVmYXVsdCBjcmVhdGVGcmFnbWVudENvbnRhaW5lcihVc2VyUHJvZmlsZSwgewogIHVzZXI6IGdyYXBocWxgCiAgICBmcmFnbWVudCBVc2VyUHJvZmlsZV91c2VyIG9uIFVzZXIgewogICAgICBuYW1lCiAgICAgIGVtYWlsCiAgICB9CiAgYCwKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import React from 'react';
import { createFragmentContainer, graphql } from 'react-relay';

function UserProfile({ user }) {
  return (
    &lt;div&gt;
      &lt;h1&gt;{user.name}&lt;/h1&gt;
      &lt;p&gt;{user.email}&lt;/p&gt;
    &lt;/div&gt;
  );
}

export default createFragmentContainer(UserProfile, {
  user: graphql`
    fragment UserProfile_user on User {
      name
      email
    }
  `,
});</pre></div><div class='content'></div><h1>Mutations</h1>
<div class='content'><p>Relay provides a way to handle GraphQL mutations, ensuring that the UI stays in sync with the server state.</p>
</div><h2>Example of a Mutation</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHsgY29tbWl0TXV0YXRpb24sIGdyYXBocWwgfSBmcm9tICdyZWFjdC1yZWxheSc7CmltcG9ydCBlbnZpcm9ubWVudCBmcm9tICcuL2Vudmlyb25tZW50JzsKCmNvbnN0IG11dGF0aW9uID0gZ3JhcGhxbGAKICBtdXRhdGlvbiBBZGRVc2VyTXV0YXRpb24oJGlucHV0OiBBZGRVc2VySW5wdXQhKSB7CiAgICBhZGRVc2VyKGlucHV0OiAkaW5wdXQpIHsKICAgICAgdXNlciB7CiAgICAgICAgaWQKICAgICAgICBuYW1lCiAgICAgICAgZW1haWwKICAgICAgfQogICAgfQogIH0KYDsKCmZ1bmN0aW9uIGFkZFVzZXIobmFtZSwgZW1haWwpIHsKICBjb25zdCB2YXJpYWJsZXMgPSB7CiAgICBpbnB1dDogewogICAgICBuYW1lLAogICAgICBlbWFpbCwKICAgIH0sCiAgfTsKCiAgY29tbWl0TXV0YXRpb24oZW52aXJvbm1lbnQsIHsKICAgIG11dGF0aW9uLAogICAgdmFyaWFibGVzLAogICAgb25Db21wbGV0ZWQ6IChyZXNwb25zZSwgZXJyb3JzKSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKCdSZXNwb25zZSByZWNlaXZlZCBmcm9tIHNlcnZlci4nKTsKICAgIH0sCiAgICBvbkVycm9yOiBlcnIgPT4gY29uc29sZS5lcnJvcihlcnIpLAogIH0pOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import { commitMutation, graphql } from 'react-relay';
import environment from './environment';

const mutation = graphql`
  mutation AddUserMutation($input: AddUserInput!) {
    addUser(input: $input) {
      user {
        id
        name
        email
      }
    }
  }
`;

function addUser(name, email) {
  const variables = {
    input: {
      name,
      email,
    },
  };

  commitMutation(environment, {
    mutation,
    variables,
    onCompleted: (response, errors) =&gt; {
      console.log('Response received from server.');
    },
    onError: err =&gt; console.error(err),
  });
}</pre></div><div class='content'></div><h1>Pagination and Refetching</h1>
<div class='content'><p>Relay has built-in support for pagination and refetching data. This is particularly useful for lists of data that need to be loaded incrementally.</p>
</div><h2>Example of Pagination</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JzsKaW1wb3J0IHsgY3JlYXRlUGFnaW5hdGlvbkNvbnRhaW5lciwgZ3JhcGhxbCB9IGZyb20gJ3JlYWN0LXJlbGF5JzsKCmZ1bmN0aW9uIFVzZXJMaXN0KHsgcmVsYXksIHVzZXJzIH0pIHsKICBjb25zdCBsb2FkTW9yZSA9ICgpID0+IHsKICAgIGlmICghcmVsYXkuaGFzTW9yZSgpIHx8IHJlbGF5LmlzTG9hZGluZygpKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIHJlbGF5LmxvYWRNb3JlKDEwKTsgLy8gTG9hZCB0aGUgbmV4dCAxMCBpdGVtcwogIH07CgogIHJldHVybiAoCiAgICA8ZGl2PgogICAgICA8dWw+CiAgICAgICAge3VzZXJzLmVkZ2VzLm1hcCgoeyBub2RlIH0pID0+ICgKICAgICAgICAgIDxsaSBrZXk9e25vZGUuaWR9Pntub2RlLm5hbWV9PC9saT4KICAgICAgICApKX0KICAgICAgPC91bD4KICAgICAgPGJ1dHRvbiBvbkNsaWNrPXtsb2FkTW9yZX0gZGlzYWJsZWQ9eyFyZWxheS5oYXNNb3JlKCkgfHwgcmVsYXkuaXNMb2FkaW5nKCl9PgogICAgICAgIExvYWQgTW9yZQogICAgICA8L2J1dHRvbj4KICAgIDwvZGl2PgogICk7Cn0KCmV4cG9ydCBkZWZhdWx0IGNyZWF0ZVBhZ2luYXRpb25Db250YWluZXIoCiAgVXNlckxpc3QsCiAgewogICAgdXNlcnM6IGdyYXBocWxgCiAgICAgIGZyYWdtZW50IFVzZXJMaXN0X3VzZXJzIG9uIFVzZXJDb25uZWN0aW9uIHsKICAgICAgICBlZGdlcyB7CiAgICAgICAgICBub2RlIHsKICAgICAgICAgICAgaWQKICAgICAgICAgICAgbmFtZQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgYCwKICB9LAogIHsKICAgIGRpcmVjdGlvbjogJ2ZvcndhcmQnLAogICAgZ2V0Q29ubmVjdGlvbkZyb21Qcm9wcyhwcm9wcykgewogICAgICByZXR1cm4gcHJvcHMudXNlcnM7CiAgICB9LAogICAgZ2V0VmFyaWFibGVzKHByb3BzLCB7IGNvdW50LCBjdXJzb3IgfSwgZnJhZ21lbnRWYXJpYWJsZXMpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBjb3VudCwKICAgICAgICBjdXJzb3IsCiAgICAgIH07CiAgICB9LAogICAgcXVlcnk6IGdyYXBocWxgCiAgICAgIHF1ZXJ5IFVzZXJMaXN0UGFnaW5hdGlvblF1ZXJ5KCRjb3VudDogSW50ISwgJGN1cnNvcjogU3RyaW5nKSB7CiAgICAgICAgdXNlcnMoZmlyc3Q6ICRjb3VudCwgYWZ0ZXI6ICRjdXJzb3IpIHsKICAgICAgICAgIC4uLlVzZXJMaXN0X3VzZXJzCiAgICAgICAgfQogICAgICB9CiAgICBgLAogIH0KKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import React from 'react';
import { createPaginationContainer, graphql } from 'react-relay';

function UserList({ relay, users }) {
  const loadMore = () =&gt; {
    if (!relay.hasMore() || relay.isLoading()) {
      return;
    }
    relay.loadMore(10); // Load the next 10 items
  };

  return (
    &lt;div&gt;
      &lt;ul&gt;
        {users.edges.map(({ node }) =&gt; (
          &lt;li key={node.id}&gt;{node.name}&lt;/li&gt;
        ))}
      &lt;/ul&gt;
      &lt;button onClick={loadMore} disabled={!relay.hasMore() || relay.isLoading()}&gt;
        Load More
      &lt;/button&gt;
    &lt;/div&gt;
  );
}

export default createPaginationContainer(
  UserList,
  {
    users: graphql`
      fragment UserList_users on UserConnection {
        edges {
          node {
            id
            name
          }
        }
      }
    `,
  },
  {
    direction: 'forward',
    getConnectionFromProps(props) {
      return props.users;
    },
    getVariables(props, { count, cursor }, fragmentVariables) {
      return {
        count,
        cursor,
      };
    },
    query: graphql`
      query UserListPaginationQuery($count: Int!, $cursor: String) {
        users(first: $count, after: $cursor) {
          ...UserList_users
        }
      }
    `,
  }
);</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Relay is a powerful tool for managing GraphQL data in React applications. By understanding its key concepts such as declarative data fetching, fragments, mutations, and pagination, you can build efficient and scalable applications. Relay's approach to colocating queries with components and its robust support for handling data changes make it an excellent choice for modern React development.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='apollo-client'>&#x25C4;Apollo Client</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Relay</a>
	</div>
	<div class='col-4 text-end'>
					<a href='graphql-subscriptions'>GraphQL Subscriptions &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
