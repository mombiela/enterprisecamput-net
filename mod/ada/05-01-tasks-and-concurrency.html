<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tasks and Concurrency</title>

    <link rel="alternate" href="https://campusempresa.com/mod/ada/05-01-tasks-and-concurrency" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/ada/05-01-tasks-and-concurrency" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/ada/05-01-tasks-and-concurrency" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/ada/05-01-tasks-and-concurrency" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/ada/05-01-tasks-and-concurrency" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-04-private-types-and-private-packages' title="Private Types and Private Packages">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Tasks and Concurrency</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-02-protected-objects' title="Protected Objects">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Concurrency is a fundamental concept in modern programming, allowing multiple tasks to be executed simultaneously. Ada provides robust support for concurrent programming through its tasking model. In this section, we will explore the basics of tasks and concurrency in Ada, including how to create and manage tasks, synchronization mechanisms, and practical examples.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Tasks</strong>: Independent units of execution that can run concurrently with other tasks.</li>
<li><strong>Task Types</strong>: Define a blueprint for creating multiple tasks with similar behavior.</li>
<li><strong>Synchronization</strong>: Mechanisms to coordinate the execution of tasks, ensuring correct interaction.</li>
<li><strong>Protected Objects</strong>: Special constructs to safely share data between tasks.</li>
</ol>
</div><h1>Creating Tasks</h1>
<div class='content'><p>In Ada, tasks are declared using the <code>task</code> keyword. Here is a simple example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dGFzayBNeV9UYXNrIGlzCmVuZCBNeV9UYXNrOwoKdGFzayBib2R5IE15X1Rhc2sgaXMKYmVnaW4KICAgLS0gVGFzayBjb2RlIGdvZXMgaGVyZQogICBBZGEuVGV4dF9JTy5QdXRfTGluZSgiSGVsbG8gZnJvbSBNeV9UYXNrISIpOwplbmQgTXlfVGFzazs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>task My_Task is
end My_Task;

task body My_Task is
begin
   -- Task code goes here
   Ada.Text_IO.Put_Line(&quot;Hello from My_Task!&quot;);
end My_Task;</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Task Declaration</strong>: The <code>task My_Task is</code> line declares a task named <code>My_Task</code>.</li>
<li><strong>Task Body</strong>: The <code>task body My_Task is</code> block contains the code that the task will execute.</li>
</ul>
</div><h1>Task Types</h1>
<div class='content'><p>Task types allow you to create multiple instances of a task with the same behavior. Here is an example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dGFzayB0eXBlIFdvcmtlciBpcwplbmQgV29ya2VyOwoKdGFzayBib2R5IFdvcmtlciBpcwpiZWdpbgogICAtLSBUYXNrIGNvZGUgZ29lcyBoZXJlCiAgIEFkYS5UZXh0X0lPLlB1dF9MaW5lKCJIZWxsbyBmcm9tIFdvcmtlciEiKTsKZW5kIFdvcmtlcjsKCi0tIENyZWF0aW5nIG11bHRpcGxlIGluc3RhbmNlcyBvZiBXb3JrZXIKV29ya2VyMSA6IFdvcmtlcjsKV29ya2VyMiA6IFdvcmtlcjs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>task type Worker is
end Worker;

task body Worker is
begin
   -- Task code goes here
   Ada.Text_IO.Put_Line(&quot;Hello from Worker!&quot;);
end Worker;

-- Creating multiple instances of Worker
Worker1 : Worker;
Worker2 : Worker;</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Task Type Declaration</strong>: The <code>task type Worker is</code> line declares a task type named <code>Worker</code>.</li>
<li><strong>Task Type Body</strong>: The <code>task body Worker is</code> block contains the code that each instance of the task will execute.</li>
<li><strong>Task Instances</strong>: <code>Worker1</code> and <code>Worker2</code> are instances of the <code>Worker</code> task type.</li>
</ul>
</div><h1>Synchronization</h1>
<div class='content'><p>Synchronization is crucial in concurrent programming to avoid race conditions and ensure data consistency. Ada provides several mechanisms for synchronization, including <code>rendezvous</code> and <code>protected objects</code>.</p>
</div><h2>Rendezvous</h2>
<div class='content'><p>A rendezvous is a synchronization mechanism where one task waits for another to reach a specific point. Here is an example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dGFzayBTZXJ2ZXIgaXMKICAgZW50cnkgU3RhcnQ7CmVuZCBTZXJ2ZXI7Cgp0YXNrIGJvZHkgU2VydmVyIGlzCmJlZ2luCiAgIGFjY2VwdCBTdGFydCBkbwogICAgICBBZGEuVGV4dF9JTy5QdXRfTGluZSgiU2VydmVyIHN0YXJ0ZWQhIik7CiAgIGVuZCBTdGFydDsKZW5kIFNlcnZlcjsKCnRhc2sgQ2xpZW50IGlzCmJlZ2luCiAgIFNlcnZlci5TdGFydDsKZW5kIENsaWVudDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>task Server is
   entry Start;
end Server;

task body Server is
begin
   accept Start do
      Ada.Text_IO.Put_Line(&quot;Server started!&quot;);
   end Start;
end Server;

task Client is
begin
   Server.Start;
end Client;</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Entry Declaration</strong>: The <code>entry Start;</code> line declares an entry point named <code>Start</code> in the <code>Server</code> task.</li>
<li><strong>Accept Statement</strong>: The <code>accept Start do</code> block in the <code>Server</code> task body waits for the <code>Client</code> task to call the <code>Start</code> entry.</li>
<li><strong>Client Task</strong>: The <code>Client</code> task calls the <code>Start</code> entry of the <code>Server</code> task, causing the <code>Server</code> to print &quot;Server started!&quot;.</li>
</ul>
</div><h2>Protected Objects</h2>
<div class='content'><p>Protected objects provide a safe way to share data between tasks. Here is an example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJvdGVjdGVkIFNoYXJlZF9EYXRhIGlzCiAgIHByb2NlZHVyZSBXcml0ZShWYWx1ZSA6IEludGVnZXIpOwogICBmdW5jdGlvbiBSZWFkIHJldHVybiBJbnRlZ2VyOwpwcml2YXRlCiAgIERhdGEgOiBJbnRlZ2VyIDo9IDA7CmVuZCBTaGFyZWRfRGF0YTsKCnByb3RlY3RlZCBib2R5IFNoYXJlZF9EYXRhIGlzCiAgIHByb2NlZHVyZSBXcml0ZShWYWx1ZSA6IEludGVnZXIpIGlzCiAgIGJlZ2luCiAgICAgIERhdGEgOj0gVmFsdWU7CiAgIGVuZCBXcml0ZTsKCiAgIGZ1bmN0aW9uIFJlYWQgcmV0dXJuIEludGVnZXIgaXMKICAgYmVnaW4KICAgICAgcmV0dXJuIERhdGE7CiAgIGVuZCBSZWFkOwplbmQgU2hhcmVkX0RhdGE7Cgp0YXNrIFdyaXRlciBpcwpiZWdpbgogICBTaGFyZWRfRGF0YS5Xcml0ZSg0Mik7CmVuZCBXcml0ZXI7Cgp0YXNrIFJlYWRlciBpcwpiZWdpbgogICBBZGEuVGV4dF9JTy5QdXRfTGluZSgiRGF0YTogIiAmIEludGVnZXInSW1hZ2UoU2hhcmVkX0RhdGEuUmVhZCkpOwplbmQgUmVhZGVyOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>protected Shared_Data is
   procedure Write(Value : Integer);
   function Read return Integer;
private
   Data : Integer := 0;
end Shared_Data;

protected body Shared_Data is
   procedure Write(Value : Integer) is
   begin
      Data := Value;
   end Write;

   function Read return Integer is
   begin
      return Data;
   end Read;
end Shared_Data;

task Writer is
begin
   Shared_Data.Write(42);
end Writer;

task Reader is
begin
   Ada.Text_IO.Put_Line(&quot;Data: &quot; &amp; Integer'Image(Shared_Data.Read));
end Reader;</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Protected Object Declaration</strong>: The <code>protected Shared_Data is</code> block declares a protected object with a procedure <code>Write</code> and a function <code>Read</code>.</li>
<li><strong>Protected Object Body</strong>: The <code>protected body Shared_Data is</code> block defines the implementation of the <code>Write</code> procedure and <code>Read</code> function.</li>
<li><strong>Writer Task</strong>: The <code>Writer</code> task writes the value <code>42</code> to the <code>Shared_Data</code> protected object.</li>
<li><strong>Reader Task</strong>: The <code>Reader</code> task reads the value from the <code>Shared_Data</code> protected object and prints it.</li>
</ul>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise</h2>
<div class='content'><p>Create a simple Ada program with two tasks: one task that increments a shared counter and another task that reads and prints the counter value.</p>
</div><h2>Solution</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("d2l0aCBBZGEuVGV4dF9JTzsgdXNlIEFkYS5UZXh0X0lPOwoKcHJvdGVjdGVkIENvdW50ZXIgaXMKICAgcHJvY2VkdXJlIEluY3JlbWVudDsKICAgZnVuY3Rpb24gR2V0IHJldHVybiBJbnRlZ2VyOwpwcml2YXRlCiAgIFZhbHVlIDogSW50ZWdlciA6PSAwOwplbmQgQ291bnRlcjsKCnByb3RlY3RlZCBib2R5IENvdW50ZXIgaXMKICAgcHJvY2VkdXJlIEluY3JlbWVudCBpcwogICBiZWdpbgogICAgICBWYWx1ZSA6PSBWYWx1ZSArIDE7CiAgIGVuZCBJbmNyZW1lbnQ7CgogICBmdW5jdGlvbiBHZXQgcmV0dXJuIEludGVnZXIgaXMKICAgYmVnaW4KICAgICAgcmV0dXJuIFZhbHVlOwogICBlbmQgR2V0OwplbmQgQ291bnRlcjsKCnRhc2sgSW5jcmVtZW50ZXIgaXMKYmVnaW4KICAgZm9yIEkgaW4gMSAuLiAxMCBsb29wCiAgICAgIENvdW50ZXIuSW5jcmVtZW50OwogICBlbmQgbG9vcDsKZW5kIEluY3JlbWVudGVyOwoKdGFzayBQcmludGVyIGlzCmJlZ2luCiAgIEFkYS5UZXh0X0lPLlB1dF9MaW5lKCJDb3VudGVyIHZhbHVlOiAiICYgSW50ZWdlcidJbWFnZShDb3VudGVyLkdldCkpOwplbmQgUHJpbnRlcjs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>with Ada.Text_IO; use Ada.Text_IO;

protected Counter is
   procedure Increment;
   function Get return Integer;
private
   Value : Integer := 0;
end Counter;

protected body Counter is
   procedure Increment is
   begin
      Value := Value + 1;
   end Increment;

   function Get return Integer is
   begin
      return Value;
   end Get;
end Counter;

task Incrementer is
begin
   for I in 1 .. 10 loop
      Counter.Increment;
   end loop;
end Incrementer;

task Printer is
begin
   Ada.Text_IO.Put_Line(&quot;Counter value: &quot; &amp; Integer'Image(Counter.Get));
end Printer;</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Protected Object <code>Counter</code></strong>: Manages a shared counter with an <code>Increment</code> procedure and a <code>Get</code> function.</li>
<li><strong>Incrementer Task</strong>: Increments the counter 10 times.</li>
<li><strong>Printer Task</strong>: Reads and prints the counter value.</li>
</ul>
</div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Race Conditions</strong>: Ensure proper synchronization to avoid race conditions.</li>
<li><strong>Deadlocks</strong>: Be cautious of deadlocks where tasks wait indefinitely for each other.</li>
<li><strong>Task Termination</strong>: Ensure tasks terminate properly to avoid resource leaks.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the basics of tasks and concurrency in Ada, including task creation, task types, synchronization mechanisms, and practical examples. Understanding these concepts is crucial for developing robust and efficient concurrent programs in Ada. In the next section, we will delve deeper into protected objects and their role in concurrent programming.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-04-private-types-and-private-packages' title="Private Types and Private Packages">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-02-protected-objects' title="Protected Objects">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
