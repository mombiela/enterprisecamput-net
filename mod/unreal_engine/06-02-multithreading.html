<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multithreading</title>

    <link rel="alternate" href="https://campusempresa.com/mod/unreal_engine/06-02-multithreading" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/unreal_engine/06-02-multithreading" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/unreal_engine/06-02-multithreading" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/unreal_engine/06-02-multithreading" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/unreal_engine/06-02-multithreading" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='06-01-memory-management' title="Memory Management">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Multithreading</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-03-networking-and-multiplayer' title="Networking and Multiplayer">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Multithreading is a powerful technique that allows a program to perform multiple tasks concurrently, improving performance and responsiveness. In Unreal Engine, multithreading can be used to handle complex computations, AI processing, and other tasks without blocking the main game thread. This section will cover the basics of multithreading in Unreal Engine, including practical examples and exercises to help you understand and implement multithreading in your projects.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Threads</strong>: The smallest unit of processing that can be scheduled by an operating system.</li>
<li><strong>Concurrency</strong>: The ability to run multiple tasks simultaneously.</li>
<li><strong>Parallelism</strong>: The actual simultaneous execution of multiple tasks.</li>
<li><strong>Thread Safety</strong>: Ensuring that shared data is accessed by only one thread at a time to prevent data corruption.</li>
</ol>
</div><h1>Setting Up Multithreading in Unreal Engine</h1>
<div class='content'></div><h2>Creating a Simple Thread</h2>
<div class='content'><p>To create a thread in Unreal Engine, you need to define a class that implements the <code>FRunnable</code> interface. This interface requires you to implement several methods, including <code>Init()</code>, <code>Run()</code>, and <code>Stop()</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gTXlSdW5uYWJsZS5oCiNwcmFnbWEgb25jZQoKI2luY2x1ZGUgIkNvcmVNaW5pbWFsLmgiCiNpbmNsdWRlICJIQUwvUnVubmFibGUuaCIKCmNsYXNzIE1ZUFJPSkVDVF9BUEkgRk15UnVubmFibGUgOiBwdWJsaWMgRlJ1bm5hYmxlCnsKcHVibGljOgogICAgRk15UnVubmFibGUoKTsKICAgIHZpcnR1YWwgfkZNeVJ1bm5hYmxlKCk7CgogICAgdmlydHVhbCBib29sIEluaXQoKSBvdmVycmlkZTsKICAgIHZpcnR1YWwgdWludDMyIFJ1bigpIG92ZXJyaWRlOwogICAgdmlydHVhbCB2b2lkIFN0b3AoKSBvdmVycmlkZTsKCnByaXZhdGU6CiAgICBGVGhyZWFkU2FmZUNvdW50ZXIgU3RvcFRhc2tDb3VudGVyOwp9OwoKLy8gTXlSdW5uYWJsZS5jcHAKI2luY2x1ZGUgIk15UnVubmFibGUuaCIKCkZNeVJ1bm5hYmxlOjpGTXlSdW5uYWJsZSgpIHt9CgpGTXlSdW5uYWJsZTo6fkZNeVJ1bm5hYmxlKCkge30KCmJvb2wgRk15UnVubmFibGU6OkluaXQoKQp7CiAgICAvLyBJbml0aWFsaXphdGlvbiBjb2RlIGhlcmUKICAgIHJldHVybiB0cnVlOwp9Cgp1aW50MzIgRk15UnVubmFibGU6OlJ1bigpCnsKICAgIHdoaWxlIChTdG9wVGFza0NvdW50ZXIuR2V0VmFsdWUoKSA9PSAwKQogICAgewogICAgICAgIC8vIFRhc2sgZXhlY3V0aW9uIGNvZGUgaGVyZQogICAgfQogICAgcmV0dXJuIDA7Cn0KCnZvaWQgRk15UnVubmFibGU6OlN0b3AoKQp7CiAgICBTdG9wVGFza0NvdW50ZXIuSW5jcmVtZW50KCk7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// MyRunnable.h
#pragma once

#include &quot;CoreMinimal.h&quot;
#include &quot;HAL/Runnable.h&quot;

class MYPROJECT_API FMyRunnable : public FRunnable
{
public:
    FMyRunnable();
    virtual ~FMyRunnable();

    virtual bool Init() override;
    virtual uint32 Run() override;
    virtual void Stop() override;

private:
    FThreadSafeCounter StopTaskCounter;
};

// MyRunnable.cpp
#include &quot;MyRunnable.h&quot;

FMyRunnable::FMyRunnable() {}

FMyRunnable::~FMyRunnable() {}

bool FMyRunnable::Init()
{
    // Initialization code here
    return true;
}

uint32 FMyRunnable::Run()
{
    while (StopTaskCounter.GetValue() == 0)
    {
        // Task execution code here
    }
    return 0;
}

void FMyRunnable::Stop()
{
    StopTaskCounter.Increment();
}</pre></div><div class='content'></div><h2>Starting and Stopping the Thread</h2>
<div class='content'><p>To start and stop the thread, you need to use the <code>FRunnableThread</code> class.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gTXlUaHJlYWRNYW5hZ2VyLmgKI3ByYWdtYSBvbmNlCgojaW5jbHVkZSAiQ29yZU1pbmltYWwuaCIKI2luY2x1ZGUgIk15UnVubmFibGUuaCIKCmNsYXNzIE1ZUFJPSkVDVF9BUEkgRk15VGhyZWFkTWFuYWdlcgp7CnB1YmxpYzoKICAgIEZNeVRocmVhZE1hbmFnZXIoKTsKICAgIH5GTXlUaHJlYWRNYW5hZ2VyKCk7CgogICAgdm9pZCBTdGFydFRocmVhZCgpOwogICAgdm9pZCBTdG9wVGhyZWFkKCk7Cgpwcml2YXRlOgogICAgRlJ1bm5hYmxlVGhyZWFkKiBUaHJlYWQ7CiAgICBGTXlSdW5uYWJsZSogUnVubmFibGU7Cn07CgovLyBNeVRocmVhZE1hbmFnZXIuY3BwCiNpbmNsdWRlICJNeVRocmVhZE1hbmFnZXIuaCIKCkZNeVRocmVhZE1hbmFnZXI6OkZNeVRocmVhZE1hbmFnZXIoKQogICAgOiBUaHJlYWQobnVsbHB0ciksIFJ1bm5hYmxlKG51bGxwdHIpCnsKfQoKRk15VGhyZWFkTWFuYWdlcjo6fkZNeVRocmVhZE1hbmFnZXIoKQp7CiAgICBTdG9wVGhyZWFkKCk7Cn0KCnZvaWQgRk15VGhyZWFkTWFuYWdlcjo6U3RhcnRUaHJlYWQoKQp7CiAgICBpZiAoIVJ1bm5hYmxlICYmICFUaHJlYWQpCiAgICB7CiAgICAgICAgUnVubmFibGUgPSBuZXcgRk15UnVubmFibGUoKTsKICAgICAgICBUaHJlYWQgPSBGUnVubmFibGVUaHJlYWQ6OkNyZWF0ZShSdW5uYWJsZSwgVEVYVCgiTXlUaHJlYWQiKSk7CiAgICB9Cn0KCnZvaWQgRk15VGhyZWFkTWFuYWdlcjo6U3RvcFRocmVhZCgpCnsKICAgIGlmIChSdW5uYWJsZSAmJiBUaHJlYWQpCiAgICB7CiAgICAgICAgUnVubmFibGUtPlN0b3AoKTsKICAgICAgICBUaHJlYWQtPldhaXRGb3JDb21wbGV0aW9uKCk7CiAgICAgICAgZGVsZXRlIFRocmVhZDsKICAgICAgICBkZWxldGUgUnVubmFibGU7CiAgICAgICAgVGhyZWFkID0gbnVsbHB0cjsKICAgICAgICBSdW5uYWJsZSA9IG51bGxwdHI7CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// MyThreadManager.h
#pragma once

#include &quot;CoreMinimal.h&quot;
#include &quot;MyRunnable.h&quot;

class MYPROJECT_API FMyThreadManager
{
public:
    FMyThreadManager();
    ~FMyThreadManager();

    void StartThread();
    void StopThread();

private:
    FRunnableThread* Thread;
    FMyRunnable* Runnable;
};

// MyThreadManager.cpp
#include &quot;MyThreadManager.h&quot;

FMyThreadManager::FMyThreadManager()
    : Thread(nullptr), Runnable(nullptr)
{
}

FMyThreadManager::~FMyThreadManager()
{
    StopThread();
}

void FMyThreadManager::StartThread()
{
    if (!Runnable &amp;&amp; !Thread)
    {
        Runnable = new FMyRunnable();
        Thread = FRunnableThread::Create(Runnable, TEXT(&quot;MyThread&quot;));
    }
}

void FMyThreadManager::StopThread()
{
    if (Runnable &amp;&amp; Thread)
    {
        Runnable-&gt;Stop();
        Thread-&gt;WaitForCompletion();
        delete Thread;
        delete Runnable;
        Thread = nullptr;
        Runnable = nullptr;
    }
}</pre></div><div class='content'></div><h2>Practical Example: Background Data Processing</h2>
<div class='content'><p>Let's create a practical example where we process some data in the background without blocking the main game thread.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRGF0YVByb2Nlc3Nvci5oCiNwcmFnbWEgb25jZQoKI2luY2x1ZGUgIkNvcmVNaW5pbWFsLmgiCiNpbmNsdWRlICJIQUwvUnVubmFibGUuaCIKCmNsYXNzIE1ZUFJPSkVDVF9BUEkgRkRhdGFQcm9jZXNzb3IgOiBwdWJsaWMgRlJ1bm5hYmxlCnsKcHVibGljOgogICAgRkRhdGFQcm9jZXNzb3IoVEFycmF5PGludDMyPiBJbkRhdGEpOwogICAgdmlydHVhbCB+RkRhdGFQcm9jZXNzb3IoKTsKCiAgICB2aXJ0dWFsIGJvb2wgSW5pdCgpIG92ZXJyaWRlOwogICAgdmlydHVhbCB1aW50MzIgUnVuKCkgb3ZlcnJpZGU7CiAgICB2aXJ0dWFsIHZvaWQgU3RvcCgpIG92ZXJyaWRlOwoKcHJpdmF0ZToKICAgIFRBcnJheTxpbnQzMj4gRGF0YTsKICAgIEZUaHJlYWRTYWZlQ291bnRlciBTdG9wVGFza0NvdW50ZXI7Cn07CgovLyBEYXRhUHJvY2Vzc29yLmNwcAojaW5jbHVkZSAiRGF0YVByb2Nlc3Nvci5oIgoKRkRhdGFQcm9jZXNzb3I6OkZEYXRhUHJvY2Vzc29yKFRBcnJheTxpbnQzMj4gSW5EYXRhKQogICAgOiBEYXRhKEluRGF0YSkKewp9CgpGRGF0YVByb2Nlc3Nvcjo6fkZEYXRhUHJvY2Vzc29yKCkge30KCmJvb2wgRkRhdGFQcm9jZXNzb3I6OkluaXQoKQp7CiAgICAvLyBJbml0aWFsaXphdGlvbiBjb2RlIGhlcmUKICAgIHJldHVybiB0cnVlOwp9Cgp1aW50MzIgRkRhdGFQcm9jZXNzb3I6OlJ1bigpCnsKICAgIHdoaWxlIChTdG9wVGFza0NvdW50ZXIuR2V0VmFsdWUoKSA9PSAwKQogICAgewogICAgICAgIGZvciAoaW50MzImIFZhbHVlIDogRGF0YSkKICAgICAgICB7CiAgICAgICAgICAgIFZhbHVlICo9IDI7IC8vIEV4YW1wbGUgcHJvY2Vzc2luZzogZG91YmxpbmcgZWFjaCB2YWx1ZQogICAgICAgIH0KICAgIH0KICAgIHJldHVybiAwOwp9Cgp2b2lkIEZEYXRhUHJvY2Vzc29yOjpTdG9wKCkKewogICAgU3RvcFRhc2tDb3VudGVyLkluY3JlbWVudCgpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// DataProcessor.h
#pragma once

#include &quot;CoreMinimal.h&quot;
#include &quot;HAL/Runnable.h&quot;

class MYPROJECT_API FDataProcessor : public FRunnable
{
public:
    FDataProcessor(TArray&lt;int32&gt; InData);
    virtual ~FDataProcessor();

    virtual bool Init() override;
    virtual uint32 Run() override;
    virtual void Stop() override;

private:
    TArray&lt;int32&gt; Data;
    FThreadSafeCounter StopTaskCounter;
};

// DataProcessor.cpp
#include &quot;DataProcessor.h&quot;

FDataProcessor::FDataProcessor(TArray&lt;int32&gt; InData)
    : Data(InData)
{
}

FDataProcessor::~FDataProcessor() {}

bool FDataProcessor::Init()
{
    // Initialization code here
    return true;
}

uint32 FDataProcessor::Run()
{
    while (StopTaskCounter.GetValue() == 0)
    {
        for (int32&amp; Value : Data)
        {
            Value *= 2; // Example processing: doubling each value
        }
    }
    return 0;
}

void FDataProcessor::Stop()
{
    StopTaskCounter.Increment();
}</pre></div><div class='content'></div><h2>Starting the Data Processor</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRGF0YVByb2Nlc3Nvck1hbmFnZXIuaAojcHJhZ21hIG9uY2UKCiNpbmNsdWRlICJDb3JlTWluaW1hbC5oIgojaW5jbHVkZSAiRGF0YVByb2Nlc3Nvci5oIgoKY2xhc3MgTVlQUk9KRUNUX0FQSSBGRGF0YVByb2Nlc3Nvck1hbmFnZXIKewpwdWJsaWM6CiAgICBGRGF0YVByb2Nlc3Nvck1hbmFnZXIoKTsKICAgIH5GRGF0YVByb2Nlc3Nvck1hbmFnZXIoKTsKCiAgICB2b2lkIFN0YXJ0UHJvY2Vzc2luZyhUQXJyYXk8aW50MzI+IERhdGEpOwogICAgdm9pZCBTdG9wUHJvY2Vzc2luZygpOwoKcHJpdmF0ZToKICAgIEZSdW5uYWJsZVRocmVhZCogVGhyZWFkOwogICAgRkRhdGFQcm9jZXNzb3IqIFByb2Nlc3NvcjsKfTsKCi8vIERhdGFQcm9jZXNzb3JNYW5hZ2VyLmNwcAojaW5jbHVkZSAiRGF0YVByb2Nlc3Nvck1hbmFnZXIuaCIKCkZEYXRhUHJvY2Vzc29yTWFuYWdlcjo6RkRhdGFQcm9jZXNzb3JNYW5hZ2VyKCkKICAgIDogVGhyZWFkKG51bGxwdHIpLCBQcm9jZXNzb3IobnVsbHB0cikKewp9CgpGRGF0YVByb2Nlc3Nvck1hbmFnZXI6On5GRGF0YVByb2Nlc3Nvck1hbmFnZXIoKQp7CiAgICBTdG9wUHJvY2Vzc2luZygpOwp9Cgp2b2lkIEZEYXRhUHJvY2Vzc29yTWFuYWdlcjo6U3RhcnRQcm9jZXNzaW5nKFRBcnJheTxpbnQzMj4gRGF0YSkKewogICAgaWYgKCFQcm9jZXNzb3IgJiYgIVRocmVhZCkKICAgIHsKICAgICAgICBQcm9jZXNzb3IgPSBuZXcgRkRhdGFQcm9jZXNzb3IoRGF0YSk7CiAgICAgICAgVGhyZWFkID0gRlJ1bm5hYmxlVGhyZWFkOjpDcmVhdGUoUHJvY2Vzc29yLCBURVhUKCJEYXRhUHJvY2Vzc29yVGhyZWFkIikpOwogICAgfQp9Cgp2b2lkIEZEYXRhUHJvY2Vzc29yTWFuYWdlcjo6U3RvcFByb2Nlc3NpbmcoKQp7CiAgICBpZiAoUHJvY2Vzc29yICYmIFRocmVhZCkKICAgIHsKICAgICAgICBQcm9jZXNzb3ItPlN0b3AoKTsKICAgICAgICBUaHJlYWQtPldhaXRGb3JDb21wbGV0aW9uKCk7CiAgICAgICAgZGVsZXRlIFRocmVhZDsKICAgICAgICBkZWxldGUgUHJvY2Vzc29yOwogICAgICAgIFRocmVhZCA9IG51bGxwdHI7CiAgICAgICAgUHJvY2Vzc29yID0gbnVsbHB0cjsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// DataProcessorManager.h
#pragma once

#include &quot;CoreMinimal.h&quot;
#include &quot;DataProcessor.h&quot;

class MYPROJECT_API FDataProcessorManager
{
public:
    FDataProcessorManager();
    ~FDataProcessorManager();

    void StartProcessing(TArray&lt;int32&gt; Data);
    void StopProcessing();

private:
    FRunnableThread* Thread;
    FDataProcessor* Processor;
};

// DataProcessorManager.cpp
#include &quot;DataProcessorManager.h&quot;

FDataProcessorManager::FDataProcessorManager()
    : Thread(nullptr), Processor(nullptr)
{
}

FDataProcessorManager::~FDataProcessorManager()
{
    StopProcessing();
}

void FDataProcessorManager::StartProcessing(TArray&lt;int32&gt; Data)
{
    if (!Processor &amp;&amp; !Thread)
    {
        Processor = new FDataProcessor(Data);
        Thread = FRunnableThread::Create(Processor, TEXT(&quot;DataProcessorThread&quot;));
    }
}

void FDataProcessorManager::StopProcessing()
{
    if (Processor &amp;&amp; Thread)
    {
        Processor-&gt;Stop();
        Thread-&gt;WaitForCompletion();
        delete Thread;
        delete Processor;
        Thread = nullptr;
        Processor = nullptr;
    }
}</pre></div><div class='content'></div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Implement a Simple Timer</h2>
<div class='content'><p>Create a thread that acts as a timer, counting seconds in the background and printing the elapsed time to the console.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gVGltZXJSdW5uYWJsZS5oCiNwcmFnbWEgb25jZQoKI2luY2x1ZGUgIkNvcmVNaW5pbWFsLmgiCiNpbmNsdWRlICJIQUwvUnVubmFibGUuaCIKCmNsYXNzIE1ZUFJPSkVDVF9BUEkgRlRpbWVyUnVubmFibGUgOiBwdWJsaWMgRlJ1bm5hYmxlCnsKcHVibGljOgogICAgRlRpbWVyUnVubmFibGUoKTsKICAgIHZpcnR1YWwgfkZUaW1lclJ1bm5hYmxlKCk7CgogICAgdmlydHVhbCBib29sIEluaXQoKSBvdmVycmlkZTsKICAgIHZpcnR1YWwgdWludDMyIFJ1bigpIG92ZXJyaWRlOwogICAgdmlydHVhbCB2b2lkIFN0b3AoKSBvdmVycmlkZTsKCnByaXZhdGU6CiAgICBGVGhyZWFkU2FmZUNvdW50ZXIgU3RvcFRhc2tDb3VudGVyOwp9OwoKLy8gVGltZXJSdW5uYWJsZS5jcHAKI2luY2x1ZGUgIlRpbWVyUnVubmFibGUuaCIKI2luY2x1ZGUgIkhBTC9QbGF0Zm9ybVByb2Nlc3MuaCIKCkZUaW1lclJ1bm5hYmxlOjpGVGltZXJSdW5uYWJsZSgpIHt9CgpGVGltZXJSdW5uYWJsZTo6fkZUaW1lclJ1bm5hYmxlKCkge30KCmJvb2wgRlRpbWVyUnVubmFibGU6OkluaXQoKQp7CiAgICAvLyBJbml0aWFsaXphdGlvbiBjb2RlIGhlcmUKICAgIHJldHVybiB0cnVlOwp9Cgp1aW50MzIgRlRpbWVyUnVubmFibGU6OlJ1bigpCnsKICAgIGludDMyIFNlY29uZHMgPSAwOwogICAgd2hpbGUgKFN0b3BUYXNrQ291bnRlci5HZXRWYWx1ZSgpID09IDApCiAgICB7CiAgICAgICAgRlBsYXRmb3JtUHJvY2Vzczo6U2xlZXAoMS4wZik7CiAgICAgICAgU2Vjb25kcysrOwogICAgICAgIFVFX0xPRyhMb2dUZW1wLCBMb2csIFRFWFQoIkVsYXBzZWQgVGltZTogJWQgc2Vjb25kcyIpLCBTZWNvbmRzKTsKICAgIH0KICAgIHJldHVybiAwOwp9Cgp2b2lkIEZUaW1lclJ1bm5hYmxlOjpTdG9wKCkKewogICAgU3RvcFRhc2tDb3VudGVyLkluY3JlbWVudCgpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// TimerRunnable.h
#pragma once

#include &quot;CoreMinimal.h&quot;
#include &quot;HAL/Runnable.h&quot;

class MYPROJECT_API FTimerRunnable : public FRunnable
{
public:
    FTimerRunnable();
    virtual ~FTimerRunnable();

    virtual bool Init() override;
    virtual uint32 Run() override;
    virtual void Stop() override;

private:
    FThreadSafeCounter StopTaskCounter;
};

// TimerRunnable.cpp
#include &quot;TimerRunnable.h&quot;
#include &quot;HAL/PlatformProcess.h&quot;

FTimerRunnable::FTimerRunnable() {}

FTimerRunnable::~FTimerRunnable() {}

bool FTimerRunnable::Init()
{
    // Initialization code here
    return true;
}

uint32 FTimerRunnable::Run()
{
    int32 Seconds = 0;
    while (StopTaskCounter.GetValue() == 0)
    {
        FPlatformProcess::Sleep(1.0f);
        Seconds++;
        UE_LOG(LogTemp, Log, TEXT(&quot;Elapsed Time: %d seconds&quot;), Seconds);
    }
    return 0;
}

void FTimerRunnable::Stop()
{
    StopTaskCounter.Increment();
}</pre></div><div class='content'></div><h2>Exercise 2: Data Processing with Progress Reporting</h2>
<div class='content'><p>Modify the <code>FDataProcessor</code> class to report progress to the main thread.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRGF0YVByb2Nlc3Nvci5oCiNwcmFnbWEgb25jZQoKI2luY2x1ZGUgIkNvcmVNaW5pbWFsLmgiCiNpbmNsdWRlICJIQUwvUnVubmFibGUuaCIKCkRFQ0xBUkVfREVMRUdBVEVfT25lUGFyYW0oRk9uUHJvZ3Jlc3NVcGRhdGVkLCBmbG9hdCk7CgpjbGFzcyBNWVBST0pFQ1RfQVBJIEZEYXRhUHJvY2Vzc29yIDogcHVibGljIEZSdW5uYWJsZQp7CnB1YmxpYzoKICAgIEZEYXRhUHJvY2Vzc29yKFRBcnJheTxpbnQzMj4gSW5EYXRhLCBGT25Qcm9ncmVzc1VwZGF0ZWQgSW5Qcm9ncmVzc0RlbGVnYXRlKTsKICAgIHZpcnR1YWwgfkZEYXRhUHJvY2Vzc29yKCk7CgogICAgdmlydHVhbCBib29sIEluaXQoKSBvdmVycmlkZTsKICAgIHZpcnR1YWwgdWludDMyIFJ1bigpIG92ZXJyaWRlOwogICAgdmlydHVhbCB2b2lkIFN0b3AoKSBvdmVycmlkZTsKCnByaXZhdGU6CiAgICBUQXJyYXk8aW50MzI+IERhdGE7CiAgICBGVGhyZWFkU2FmZUNvdW50ZXIgU3RvcFRhc2tDb3VudGVyOwogICAgRk9uUHJvZ3Jlc3NVcGRhdGVkIFByb2dyZXNzRGVsZWdhdGU7Cn07CgovLyBEYXRhUHJvY2Vzc29yLmNwcAojaW5jbHVkZSAiRGF0YVByb2Nlc3Nvci5oIgoKRkRhdGFQcm9jZXNzb3I6OkZEYXRhUHJvY2Vzc29yKFRBcnJheTxpbnQzMj4gSW5EYXRhLCBGT25Qcm9ncmVzc1VwZGF0ZWQgSW5Qcm9ncmVzc0RlbGVnYXRlKQogICAgOiBEYXRhKEluRGF0YSksIFByb2dyZXNzRGVsZWdhdGUoSW5Qcm9ncmVzc0RlbGVnYXRlKQp7Cn0KCkZEYXRhUHJvY2Vzc29yOjp+RkRhdGFQcm9jZXNzb3IoKSB7fQoKYm9vbCBGRGF0YVByb2Nlc3Nvcjo6SW5pdCgpCnsKICAgIC8vIEluaXRpYWxpemF0aW9uIGNvZGUgaGVyZQogICAgcmV0dXJuIHRydWU7Cn0KCnVpbnQzMiBGRGF0YVByb2Nlc3Nvcjo6UnVuKCkKewogICAgaW50MzIgVG90YWxJdGVtcyA9IERhdGEuTnVtKCk7CiAgICBmb3IgKGludDMyIEluZGV4ID0gMDsgSW5kZXggPCBUb3RhbEl0ZW1zICYmIFN0b3BUYXNrQ291bnRlci5HZXRWYWx1ZSgpID09IDA7ICsrSW5kZXgpCiAgICB7CiAgICAgICAgRGF0YVtJbmRleF0gKj0gMjsgLy8gRXhhbXBsZSBwcm9jZXNzaW5nOiBkb3VibGluZyBlYWNoIHZhbHVlCiAgICAgICAgZmxvYXQgUHJvZ3Jlc3MgPSAoSW5kZXggKyAxKSAvIHN0YXRpY19jYXN0PGZsb2F0PihUb3RhbEl0ZW1zKTsKICAgICAgICBQcm9ncmVzc0RlbGVnYXRlLkV4ZWN1dGVJZkJvdW5kKFByb2dyZXNzKTsKICAgIH0KICAgIHJldHVybiAwOwp9Cgp2b2lkIEZEYXRhUHJvY2Vzc29yOjpTdG9wKCkKewogICAgU3RvcFRhc2tDb3VudGVyLkluY3JlbWVudCgpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// DataProcessor.h
#pragma once

#include &quot;CoreMinimal.h&quot;
#include &quot;HAL/Runnable.h&quot;

DECLARE_DELEGATE_OneParam(FOnProgressUpdated, float);

class MYPROJECT_API FDataProcessor : public FRunnable
{
public:
    FDataProcessor(TArray&lt;int32&gt; InData, FOnProgressUpdated InProgressDelegate);
    virtual ~FDataProcessor();

    virtual bool Init() override;
    virtual uint32 Run() override;
    virtual void Stop() override;

private:
    TArray&lt;int32&gt; Data;
    FThreadSafeCounter StopTaskCounter;
    FOnProgressUpdated ProgressDelegate;
};

// DataProcessor.cpp
#include &quot;DataProcessor.h&quot;

FDataProcessor::FDataProcessor(TArray&lt;int32&gt; InData, FOnProgressUpdated InProgressDelegate)
    : Data(InData), ProgressDelegate(InProgressDelegate)
{
}

FDataProcessor::~FDataProcessor() {}

bool FDataProcessor::Init()
{
    // Initialization code here
    return true;
}

uint32 FDataProcessor::Run()
{
    int32 TotalItems = Data.Num();
    for (int32 Index = 0; Index &lt; TotalItems &amp;&amp; StopTaskCounter.GetValue() == 0; ++Index)
    {
        Data[Index] *= 2; // Example processing: doubling each value
        float Progress = (Index + 1) / static_cast&lt;float&gt;(TotalItems);
        ProgressDelegate.ExecuteIfBound(Progress);
    }
    return 0;
}

void FDataProcessor::Stop()
{
    StopTaskCounter.Increment();
}</pre></div><div class='content'></div><h1>Summary</h1>
<div class='content'><p>In this section, you learned about multithreading in Unreal Engine, including how to create and manage threads using the <code>FRunnable</code> interface and <code>FRunnableThread</code> class. You also saw practical examples and exercises to help you implement multithreading in your projects. By understanding and utilizing multithreading, you can significantly improve the performance and responsiveness of your Unreal Engine applications.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-01-memory-management' title="Memory Management">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-03-networking-and-multiplayer' title="Networking and Multiplayer">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
