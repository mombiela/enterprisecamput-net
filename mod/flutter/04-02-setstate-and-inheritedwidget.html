<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>setState and InheritedWidget</title>

    <link rel="alternate" href="https://campusempresa.com/mod/flutter/04-02-setstate-and-inheritedwidget" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/flutter/04-02-setstate-and-inheritedwidget" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/flutter/04-02-setstate-and-inheritedwidget" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/flutter/04-02-setstate-and-inheritedwidget" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/flutter/04-02-setstate-and-inheritedwidget" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-01-understanding-state-management' title="Understanding State Management">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">setState and InheritedWidget</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='04-03-provider-package' title="Provider Package">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore two fundamental concepts in Flutter's state management: <code>setState</code> and <code>InheritedWidget</code>. Understanding these concepts is crucial for managing the state of your Flutter applications effectively.</p>
</div><h1>What is State Management?</h1>
<div class='content'><p>State management refers to the way you handle the state of your application. The state is any data that can change over time, such as user inputs, fetched data, or the current screen. Proper state management ensures that your UI updates correctly in response to state changes.</p>
</div><h1>setState</h1>
<div class='content'><p><code>setState</code> is the simplest way to manage state in Flutter. It is used within StatefulWidgets to notify the framework that the internal state of the widget has changed, and the widget should be rebuilt.</p>
</div><h2>How to Use setState</h2>
<div class='content'><ol>
<li><strong>Create a StatefulWidget</strong>: Start by creating a StatefulWidget and its corresponding State class.</li>
<li><strong>Define State Variables</strong>: Define the variables that represent the state of your widget.</li>
<li><strong>Update State with setState</strong>: Use the <code>setState</code> method to update the state variables and trigger a rebuild of the widget.</li>
</ol>
</div><h2>Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0ICdwYWNrYWdlOmZsdXR0ZXIvbWF0ZXJpYWwuZGFydCc7Cgp2b2lkIG1haW4oKSA9PiBydW5BcHAoTXlBcHAoKSk7CgpjbGFzcyBNeUFwcCBleHRlbmRzIFN0YXRlbGVzc1dpZGdldCB7CiAgQG92ZXJyaWRlCiAgV2lkZ2V0IGJ1aWxkKEJ1aWxkQ29udGV4dCBjb250ZXh0KSB7CiAgICByZXR1cm4gTWF0ZXJpYWxBcHAoCiAgICAgIGhvbWU6IENvdW50ZXJTY3JlZW4oKSwKICAgICk7CiAgfQp9CgpjbGFzcyBDb3VudGVyU2NyZWVuIGV4dGVuZHMgU3RhdGVmdWxXaWRnZXQgewogIEBvdmVycmlkZQogIF9Db3VudGVyU2NyZWVuU3RhdGUgY3JlYXRlU3RhdGUoKSA9PiBfQ291bnRlclNjcmVlblN0YXRlKCk7Cn0KCmNsYXNzIF9Db3VudGVyU2NyZWVuU3RhdGUgZXh0ZW5kcyBTdGF0ZTxDb3VudGVyU2NyZWVuPiB7CiAgaW50IF9jb3VudGVyID0gMDsKCiAgdm9pZCBfaW5jcmVtZW50Q291bnRlcigpIHsKICAgIHNldFN0YXRlKCgpIHsKICAgICAgX2NvdW50ZXIrKzsKICAgIH0pOwogIH0KCiAgQG92ZXJyaWRlCiAgV2lkZ2V0IGJ1aWxkKEJ1aWxkQ29udGV4dCBjb250ZXh0KSB7CiAgICByZXR1cm4gU2NhZmZvbGQoCiAgICAgIGFwcEJhcjogQXBwQmFyKAogICAgICAgIHRpdGxlOiBUZXh0KCdDb3VudGVyIEFwcCcpLAogICAgICApLAogICAgICBib2R5OiBDZW50ZXIoCiAgICAgICAgY2hpbGQ6IFRleHQoCiAgICAgICAgICAnQ291bnRlcjogJF9jb3VudGVyJywKICAgICAgICAgIHN0eWxlOiBUZXh0U3R5bGUoZm9udFNpemU6IDI0KSwKICAgICAgICApLAogICAgICApLAogICAgICBmbG9hdGluZ0FjdGlvbkJ1dHRvbjogRmxvYXRpbmdBY3Rpb25CdXR0b24oCiAgICAgICAgb25QcmVzc2VkOiBfaW5jcmVtZW50Q291bnRlciwKICAgICAgICBjaGlsZDogSWNvbihJY29ucy5hZGQpLAogICAgICApLAogICAgKTsKICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import 'package:flutter/material.dart';

void main() =&gt; runApp(MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      home: CounterScreen(),
    );
  }
}

class CounterScreen extends StatefulWidget {
  @override
  _CounterScreenState createState() =&gt; _CounterScreenState();
}

class _CounterScreenState extends State&lt;CounterScreen&gt; {
  int _counter = 0;

  void _incrementCounter() {
    setState(() {
      _counter++;
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Counter App'),
      ),
      body: Center(
        child: Text(
          'Counter: $_counter',
          style: TextStyle(fontSize: 24),
        ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: _incrementCounter,
        child: Icon(Icons.add),
      ),
    );
  }
}</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>StatefulWidget</strong>: <code>CounterScreen</code> is a StatefulWidget.</li>
<li><strong>State Class</strong>: <code>_CounterScreenState</code> is the State class where the state variables and <code>setState</code> method are defined.</li>
<li><strong>State Variable</strong>: <code>_counter</code> is the state variable.</li>
<li><strong>setState Method</strong>: <code>_incrementCounter</code> method uses <code>setState</code> to update <code>_counter</code> and trigger a rebuild.</li>
</ul>
</div><h1>InheritedWidget</h1>
<div class='content'><p><code>InheritedWidget</code> is a more advanced way to manage state. It allows you to propagate state down the widget tree efficiently and is often used for sharing state across multiple widgets.</p>
</div><h2>How to Use InheritedWidget</h2>
<div class='content'><ol>
<li><strong>Create an InheritedWidget</strong>: Define a class that extends <code>InheritedWidget</code>.</li>
<li><strong>Provide State</strong>: Use the InheritedWidget to provide state to its descendants.</li>
<li><strong>Access State</strong>: Use the <code>of</code> method to access the state from the InheritedWidget.</li>
</ol>
</div><h2>Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0ICdwYWNrYWdlOmZsdXR0ZXIvbWF0ZXJpYWwuZGFydCc7Cgp2b2lkIG1haW4oKSA9PiBydW5BcHAoTXlBcHAoKSk7CgpjbGFzcyBNeUFwcCBleHRlbmRzIFN0YXRlbGVzc1dpZGdldCB7CiAgQG92ZXJyaWRlCiAgV2lkZ2V0IGJ1aWxkKEJ1aWxkQ29udGV4dCBjb250ZXh0KSB7CiAgICByZXR1cm4gTWF0ZXJpYWxBcHAoCiAgICAgIGhvbWU6IENvdW50ZXJQcm92aWRlcigKICAgICAgICBjaGlsZDogQ291bnRlclNjcmVlbigpLAogICAgICApLAogICAgKTsKICB9Cn0KCmNsYXNzIENvdW50ZXJQcm92aWRlciBleHRlbmRzIEluaGVyaXRlZFdpZGdldCB7CiAgZmluYWwgaW50IGNvdW50ZXI7CiAgZmluYWwgRnVuY3Rpb24oKSBpbmNyZW1lbnRDb3VudGVyOwoKICBDb3VudGVyUHJvdmlkZXIoe0tleT8ga2V5LCByZXF1aXJlZCBXaWRnZXQgY2hpbGR9KQogICAgICA6IGNvdW50ZXIgPSAwLAogICAgICAgIGluY3JlbWVudENvdW50ZXIgPSAoKSB7fSwKICAgICAgICBzdXBlcihrZXk6IGtleSwgY2hpbGQ6IGNoaWxkKTsKCiAgQG92ZXJyaWRlCiAgYm9vbCB1cGRhdGVTaG91bGROb3RpZnkoQ291bnRlclByb3ZpZGVyIG9sZFdpZGdldCkgewogICAgcmV0dXJuIG9sZFdpZGdldC5jb3VudGVyICE9IGNvdW50ZXI7CiAgfQoKICBzdGF0aWMgQ291bnRlclByb3ZpZGVyPyBvZihCdWlsZENvbnRleHQgY29udGV4dCkgewogICAgcmV0dXJuIGNvbnRleHQuZGVwZW5kT25Jbmhlcml0ZWRXaWRnZXRPZkV4YWN0VHlwZTxDb3VudGVyUHJvdmlkZXI+KCk7CiAgfQp9CgpjbGFzcyBDb3VudGVyU2NyZWVuIGV4dGVuZHMgU3RhdGVsZXNzV2lkZ2V0IHsKICBAb3ZlcnJpZGUKICBXaWRnZXQgYnVpbGQoQnVpbGRDb250ZXh0IGNvbnRleHQpIHsKICAgIGZpbmFsIHByb3ZpZGVyID0gQ291bnRlclByb3ZpZGVyLm9mKGNvbnRleHQpOwoKICAgIHJldHVybiBTY2FmZm9sZCgKICAgICAgYXBwQmFyOiBBcHBCYXIoCiAgICAgICAgdGl0bGU6IFRleHQoJ0NvdW50ZXIgQXBwIHdpdGggSW5oZXJpdGVkV2lkZ2V0JyksCiAgICAgICksCiAgICAgIGJvZHk6IENlbnRlcigKICAgICAgICBjaGlsZDogVGV4dCgKICAgICAgICAgICdDb3VudGVyOiAke3Byb3ZpZGVyPy5jb3VudGVyfScsCiAgICAgICAgICBzdHlsZTogVGV4dFN0eWxlKGZvbnRTaXplOiAyNCksCiAgICAgICAgKSwKICAgICAgKSwKICAgICAgZmxvYXRpbmdBY3Rpb25CdXR0b246IEZsb2F0aW5nQWN0aW9uQnV0dG9uKAogICAgICAgIG9uUHJlc3NlZDogcHJvdmlkZXI/LmluY3JlbWVudENvdW50ZXIsCiAgICAgICAgY2hpbGQ6IEljb24oSWNvbnMuYWRkKSwKICAgICAgKSwKICAgICk7CiAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import 'package:flutter/material.dart';

void main() =&gt; runApp(MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      home: CounterProvider(
        child: CounterScreen(),
      ),
    );
  }
}

class CounterProvider extends InheritedWidget {
  final int counter;
  final Function() incrementCounter;

  CounterProvider({Key? key, required Widget child})
      : counter = 0,
        incrementCounter = () {},
        super(key: key, child: child);

  @override
  bool updateShouldNotify(CounterProvider oldWidget) {
    return oldWidget.counter != counter;
  }

  static CounterProvider? of(BuildContext context) {
    return context.dependOnInheritedWidgetOfExactType&lt;CounterProvider&gt;();
  }
}

class CounterScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    final provider = CounterProvider.of(context);

    return Scaffold(
      appBar: AppBar(
        title: Text('Counter App with InheritedWidget'),
      ),
      body: Center(
        child: Text(
          'Counter: ${provider?.counter}',
          style: TextStyle(fontSize: 24),
        ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: provider?.incrementCounter,
        child: Icon(Icons.add),
      ),
    );
  }
}</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>InheritedWidget</strong>: <code>CounterProvider</code> extends <code>InheritedWidget</code> and provides the state.</li>
<li><strong>State Variables</strong>: <code>counter</code> and <code>incrementCounter</code> are the state variables.</li>
<li><strong>updateShouldNotify</strong>: Determines when the widget should notify its descendants of state changes.</li>
<li><strong>of Method</strong>: Used to access the state from the <code>CounterProvider</code>.</li>
</ul>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Task</h2>
<div class='content'><ol>
<li>Create a StatefulWidget that displays a counter.</li>
<li>Use <code>setState</code> to increment the counter when a button is pressed.</li>
<li>Create an InheritedWidget to provide the counter value and increment function.</li>
<li>Access the counter value and increment function from the InheritedWidget in a separate widget.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0ICdwYWNrYWdlOmZsdXR0ZXIvbWF0ZXJpYWwuZGFydCc7Cgp2b2lkIG1haW4oKSA9PiBydW5BcHAoTXlBcHAoKSk7CgpjbGFzcyBNeUFwcCBleHRlbmRzIFN0YXRlbGVzc1dpZGdldCB7CiAgQG92ZXJyaWRlCiAgV2lkZ2V0IGJ1aWxkKEJ1aWxkQ29udGV4dCBjb250ZXh0KSB7CiAgICByZXR1cm4gTWF0ZXJpYWxBcHAoCiAgICAgIGhvbWU6IENvdW50ZXJQcm92aWRlcigKICAgICAgICBjaGlsZDogQ291bnRlclNjcmVlbigpLAogICAgICApLAogICAgKTsKICB9Cn0KCmNsYXNzIENvdW50ZXJQcm92aWRlciBleHRlbmRzIEluaGVyaXRlZFdpZGdldCB7CiAgZmluYWwgaW50IGNvdW50ZXI7CiAgZmluYWwgRnVuY3Rpb24oKSBpbmNyZW1lbnRDb3VudGVyOwoKICBDb3VudGVyUHJvdmlkZXIoe0tleT8ga2V5LCByZXF1aXJlZCBXaWRnZXQgY2hpbGR9KQogICAgICA6IGNvdW50ZXIgPSAwLAogICAgICAgIGluY3JlbWVudENvdW50ZXIgPSAoKSB7fSwKICAgICAgICBzdXBlcihrZXk6IGtleSwgY2hpbGQ6IGNoaWxkKTsKCiAgQG92ZXJyaWRlCiAgYm9vbCB1cGRhdGVTaG91bGROb3RpZnkoQ291bnRlclByb3ZpZGVyIG9sZFdpZGdldCkgewogICAgcmV0dXJuIG9sZFdpZGdldC5jb3VudGVyICE9IGNvdW50ZXI7CiAgfQoKICBzdGF0aWMgQ291bnRlclByb3ZpZGVyPyBvZihCdWlsZENvbnRleHQgY29udGV4dCkgewogICAgcmV0dXJuIGNvbnRleHQuZGVwZW5kT25Jbmhlcml0ZWRXaWRnZXRPZkV4YWN0VHlwZTxDb3VudGVyUHJvdmlkZXI+KCk7CiAgfQp9CgpjbGFzcyBDb3VudGVyU2NyZWVuIGV4dGVuZHMgU3RhdGVsZXNzV2lkZ2V0IHsKICBAb3ZlcnJpZGUKICBXaWRnZXQgYnVpbGQoQnVpbGRDb250ZXh0IGNvbnRleHQpIHsKICAgIGZpbmFsIHByb3ZpZGVyID0gQ291bnRlclByb3ZpZGVyLm9mKGNvbnRleHQpOwoKICAgIHJldHVybiBTY2FmZm9sZCgKICAgICAgYXBwQmFyOiBBcHBCYXIoCiAgICAgICAgdGl0bGU6IFRleHQoJ0NvdW50ZXIgQXBwIHdpdGggSW5oZXJpdGVkV2lkZ2V0JyksCiAgICAgICksCiAgICAgIGJvZHk6IENlbnRlcigKICAgICAgICBjaGlsZDogVGV4dCgKICAgICAgICAgICdDb3VudGVyOiAke3Byb3ZpZGVyPy5jb3VudGVyfScsCiAgICAgICAgICBzdHlsZTogVGV4dFN0eWxlKGZvbnRTaXplOiAyNCksCiAgICAgICAgKSwKICAgICAgKSwKICAgICAgZmxvYXRpbmdBY3Rpb25CdXR0b246IEZsb2F0aW5nQWN0aW9uQnV0dG9uKAogICAgICAgIG9uUHJlc3NlZDogcHJvdmlkZXI/LmluY3JlbWVudENvdW50ZXIsCiAgICAgICAgY2hpbGQ6IEljb24oSWNvbnMuYWRkKSwKICAgICAgKSwKICAgICk7CiAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import 'package:flutter/material.dart';

void main() =&gt; runApp(MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      home: CounterProvider(
        child: CounterScreen(),
      ),
    );
  }
}

class CounterProvider extends InheritedWidget {
  final int counter;
  final Function() incrementCounter;

  CounterProvider({Key? key, required Widget child})
      : counter = 0,
        incrementCounter = () {},
        super(key: key, child: child);

  @override
  bool updateShouldNotify(CounterProvider oldWidget) {
    return oldWidget.counter != counter;
  }

  static CounterProvider? of(BuildContext context) {
    return context.dependOnInheritedWidgetOfExactType&lt;CounterProvider&gt;();
  }
}

class CounterScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    final provider = CounterProvider.of(context);

    return Scaffold(
      appBar: AppBar(
        title: Text('Counter App with InheritedWidget'),
      ),
      body: Center(
        child: Text(
          'Counter: ${provider?.counter}',
          style: TextStyle(fontSize: 24),
        ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: provider?.incrementCounter,
        child: Icon(Icons.add),
      ),
    );
  }
}</pre></div><div class='content'></div><h2>Common Mistakes</h2>
<div class='content'><ul>
<li><strong>Forgetting to Call setState</strong>: Always call <code>setState</code> when updating state variables in a StatefulWidget.</li>
<li><strong>Not Using updateShouldNotify</strong>: Ensure <code>updateShouldNotify</code> returns true when the state changes in an InheritedWidget.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the basics of state management using <code>setState</code> and <code>InheritedWidget</code>. <code>setState</code> is suitable for simple state management within a single widget, while <code>InheritedWidget</code> is useful for sharing state across multiple widgets. Understanding these concepts is essential for building responsive and maintainable Flutter applications. In the next section, we will explore the Provider package, which offers a more scalable approach to state management.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-01-understanding-state-management' title="Understanding State Management">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='04-03-provider-package' title="Provider Package">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
