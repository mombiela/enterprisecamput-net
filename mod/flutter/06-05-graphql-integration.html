<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GraphQL Integration</title>

    <link rel="alternate" href="https://campusempresa.com/mod/flutter/06-05-graphql-integration" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/flutter/06-05-graphql-integration" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/flutter/06-05-graphql-integration" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/flutter/06-05-graphql-integration" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/flutter/06-05-graphql-integration" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='06-04-using-rest-apis' title="Using REST APIs">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">GraphQL Integration</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-01-introduction-to-persistence' title="Introduction to Persistence">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to integrate GraphQL into your Flutter applications. GraphQL is a query language for APIs and a runtime for executing those queries by using a type system you define for your data. It provides a more efficient, powerful, and flexible alternative to REST.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li>
<p><strong>GraphQL Basics</strong>:</p>
<ul>
<li><strong>Query</strong>: A request for data.</li>
<li><strong>Mutation</strong>: A request to modify data.</li>
<li><strong>Schema</strong>: Defines the structure of the data.</li>
<li><strong>Resolvers</strong>: Functions that handle the queries and mutations.</li>
</ul>
</li>
<li>
<p><strong>GraphQL Client</strong>:</p>
<ul>
<li>A library that helps in making GraphQL queries and mutations from a Flutter app.</li>
</ul>
</li>
</ol>
</div><h1>Setting Up GraphQL in Flutter</h1>
<div class='content'></div><h2>Step 1: Add Dependencies</h2>
<div class='content'><p>First, add the necessary dependencies to your <code>pubspec.yaml</code> file:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVwZW5kZW5jaWVzOgogIGZsdXR0ZXI6CiAgICBzZGs6IGZsdXR0ZXIKICBncmFwaHFsX2ZsdXR0ZXI6IF41LjAuMA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>dependencies:
  flutter:
    sdk: flutter
  graphql_flutter: ^5.0.0</pre></div><div class='content'><p>Run <code>flutter pub get</code> to install the new dependencies.</p>
</div><h2>Step 2: Initialize GraphQL Client</h2>
<div class='content'><p>Create a file named <code>graphql_config.dart</code> to configure the GraphQL client:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0ICdwYWNrYWdlOmdyYXBocWxfZmx1dHRlci9ncmFwaHFsX2ZsdXR0ZXIuZGFydCc7CgpjbGFzcyBHcmFwaFFMQ29uZmlnIHsKICBzdGF0aWMgSHR0cExpbmsgaHR0cExpbmsgPSBIdHRwTGluaygKICAgICdodHRwczovL3lvdXItZ3JhcGhxbC1lbmRwb2ludC5jb20vZ3JhcGhxbCcsCiAgKTsKCiAgc3RhdGljIFZhbHVlTm90aWZpZXI8R3JhcGhRTENsaWVudD4gY2xpZW50ID0gVmFsdWVOb3RpZmllcigKICAgIEdyYXBoUUxDbGllbnQoCiAgICAgIGxpbms6IGh0dHBMaW5rLAogICAgICBjYWNoZTogR3JhcGhRTENhY2hlKHN0b3JlOiBJbk1lbW9yeVN0b3JlKCkpLAogICAgKSwKICApOwoKICBzdGF0aWMgR3JhcGhRTENsaWVudCBnZXRDbGllbnQoKSB7CiAgICByZXR1cm4gR3JhcGhRTENsaWVudCgKICAgICAgbGluazogaHR0cExpbmssCiAgICAgIGNhY2hlOiBHcmFwaFFMQ2FjaGUoc3RvcmU6IEluTWVtb3J5U3RvcmUoKSksCiAgICApOwogIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import 'package:graphql_flutter/graphql_flutter.dart';

class GraphQLConfig {
  static HttpLink httpLink = HttpLink(
    'https://your-graphql-endpoint.com/graphql',
  );

  static ValueNotifier&lt;GraphQLClient&gt; client = ValueNotifier(
    GraphQLClient(
      link: httpLink,
      cache: GraphQLCache(store: InMemoryStore()),
    ),
  );

  static GraphQLClient getClient() {
    return GraphQLClient(
      link: httpLink,
      cache: GraphQLCache(store: InMemoryStore()),
    );
  }
}</pre></div><div class='content'></div><h2>Step 3: Create Queries and Mutations</h2>
<div class='content'><p>Define your GraphQL queries and mutations. For example, create a file named <code>queries.dart</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgU3RyaW5nIGZldGNoVXNlcnMgPSAiIiIKICBxdWVyeSB7CiAgICB1c2VycyB7CiAgICAgIGlkCiAgICAgIG5hbWUKICAgICAgZW1haWwKICAgIH0KICB9CiIiIjsKCmNvbnN0IFN0cmluZyBhZGRVc2VyID0gIiIiCiAgbXV0YXRpb24gQWRkVXNlcihcJG5hbWU6IFN0cmluZyEsIFwkZW1haWw6IFN0cmluZyEpIHsKICAgIGFkZFVzZXIobmFtZTogXCRuYW1lLCBlbWFpbDogXCRlbWFpbCkgewogICAgICBpZAogICAgICBuYW1lCiAgICAgIGVtYWlsCiAgICB9CiAgfQoiIiI7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const String fetchUsers = &quot;&quot;&quot;
  query {
    users {
      id
      name
      email
    }
  }
&quot;&quot;&quot;;

const String addUser = &quot;&quot;&quot;
  mutation AddUser(\$name: String!, \$email: String!) {
    addUser(name: \$name, email: \$email) {
      id
      name
      email
    }
  }
&quot;&quot;&quot;;</pre></div><div class='content'></div><h2>Step 4: Execute Queries and Mutations</h2>
<div class='content'><p>Use the <code>GraphQLProvider</code> and <code>Query</code> widgets to execute queries and display data. For example, in your <code>main.dart</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0ICdwYWNrYWdlOmZsdXR0ZXIvbWF0ZXJpYWwuZGFydCc7CmltcG9ydCAncGFja2FnZTpncmFwaHFsX2ZsdXR0ZXIvZ3JhcGhxbF9mbHV0dGVyLmRhcnQnOwppbXBvcnQgJ2dyYXBocWxfY29uZmlnLmRhcnQnOwppbXBvcnQgJ3F1ZXJpZXMuZGFydCc7Cgp2b2lkIG1haW4oKSB7CiAgcnVuQXBwKE15QXBwKCkpOwp9CgpjbGFzcyBNeUFwcCBleHRlbmRzIFN0YXRlbGVzc1dpZGdldCB7CiAgQG92ZXJyaWRlCiAgV2lkZ2V0IGJ1aWxkKEJ1aWxkQ29udGV4dCBjb250ZXh0KSB7CiAgICByZXR1cm4gR3JhcGhRTFByb3ZpZGVyKAogICAgICBjbGllbnQ6IEdyYXBoUUxDb25maWcuY2xpZW50LAogICAgICBjaGlsZDogTWF0ZXJpYWxBcHAoCiAgICAgICAgaG9tZTogVXNlckxpc3RTY3JlZW4oKSwKICAgICAgKSwKICAgICk7CiAgfQp9CgpjbGFzcyBVc2VyTGlzdFNjcmVlbiBleHRlbmRzIFN0YXRlbGVzc1dpZGdldCB7CiAgQG92ZXJyaWRlCiAgV2lkZ2V0IGJ1aWxkKEJ1aWxkQ29udGV4dCBjb250ZXh0KSB7CiAgICByZXR1cm4gU2NhZmZvbGQoCiAgICAgIGFwcEJhcjogQXBwQmFyKAogICAgICAgIHRpdGxlOiBUZXh0KCdHcmFwaFFMIFVzZXJzJyksCiAgICAgICksCiAgICAgIGJvZHk6IFF1ZXJ5KAogICAgICAgIG9wdGlvbnM6IFF1ZXJ5T3B0aW9ucygKICAgICAgICAgIGRvY3VtZW50OiBncWwoZmV0Y2hVc2VycyksCiAgICAgICAgKSwKICAgICAgICBidWlsZGVyOiAoUXVlcnlSZXN1bHQgcmVzdWx0LCB7IFZvaWRDYWxsYmFjaz8gcmVmZXRjaCwgRmV0Y2hNb3JlPyBmZXRjaE1vcmUgfSkgewogICAgICAgICAgaWYgKHJlc3VsdC5oYXNFeGNlcHRpb24pIHsKICAgICAgICAgICAgcmV0dXJuIFRleHQocmVzdWx0LmV4Y2VwdGlvbi50b1N0cmluZygpKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAocmVzdWx0LmlzTG9hZGluZykgewogICAgICAgICAgICByZXR1cm4gQ2VudGVyKGNoaWxkOiBDaXJjdWxhclByb2dyZXNzSW5kaWNhdG9yKCkpOwogICAgICAgICAgfQoKICAgICAgICAgIExpc3QgdXNlcnMgPSByZXN1bHQuZGF0YSFbJ3VzZXJzJ107CgogICAgICAgICAgcmV0dXJuIExpc3RWaWV3LmJ1aWxkZXIoCiAgICAgICAgICAgIGl0ZW1Db3VudDogdXNlcnMubGVuZ3RoLAogICAgICAgICAgICBpdGVtQnVpbGRlcjogKGNvbnRleHQsIGluZGV4KSB7CiAgICAgICAgICAgICAgZmluYWwgdXNlciA9IHVzZXJzW2luZGV4XTsKICAgICAgICAgICAgICByZXR1cm4gTGlzdFRpbGUoCiAgICAgICAgICAgICAgICB0aXRsZTogVGV4dCh1c2VyWyduYW1lJ10pLAogICAgICAgICAgICAgICAgc3VidGl0bGU6IFRleHQodXNlclsnZW1haWwnXSksCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICk7CiAgICAgICAgfSwKICAgICAgKSwKICAgICk7CiAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import 'package:flutter/material.dart';
import 'package:graphql_flutter/graphql_flutter.dart';
import 'graphql_config.dart';
import 'queries.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return GraphQLProvider(
      client: GraphQLConfig.client,
      child: MaterialApp(
        home: UserListScreen(),
      ),
    );
  }
}

class UserListScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('GraphQL Users'),
      ),
      body: Query(
        options: QueryOptions(
          document: gql(fetchUsers),
        ),
        builder: (QueryResult result, { VoidCallback? refetch, FetchMore? fetchMore }) {
          if (result.hasException) {
            return Text(result.exception.toString());
          }

          if (result.isLoading) {
            return Center(child: CircularProgressIndicator());
          }

          List users = result.data!['users'];

          return ListView.builder(
            itemCount: users.length,
            itemBuilder: (context, index) {
              final user = users[index];
              return ListTile(
                title: Text(user['name']),
                subtitle: Text(user['email']),
              );
            },
          );
        },
      ),
    );
  }
}</pre></div><div class='content'></div><h2>Step 5: Handling Mutations</h2>
<div class='content'><p>To handle mutations, use the <code>Mutation</code> widget. For example, to add a new user:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgQWRkVXNlclNjcmVlbiBleHRlbmRzIFN0YXRlbGVzc1dpZGdldCB7CiAgZmluYWwgVGV4dEVkaXRpbmdDb250cm9sbGVyIG5hbWVDb250cm9sbGVyID0gVGV4dEVkaXRpbmdDb250cm9sbGVyKCk7CiAgZmluYWwgVGV4dEVkaXRpbmdDb250cm9sbGVyIGVtYWlsQ29udHJvbGxlciA9IFRleHRFZGl0aW5nQ29udHJvbGxlcigpOwoKICBAb3ZlcnJpZGUKICBXaWRnZXQgYnVpbGQoQnVpbGRDb250ZXh0IGNvbnRleHQpIHsKICAgIHJldHVybiBTY2FmZm9sZCgKICAgICAgYXBwQmFyOiBBcHBCYXIoCiAgICAgICAgdGl0bGU6IFRleHQoJ0FkZCBVc2VyJyksCiAgICAgICksCiAgICAgIGJvZHk6IE11dGF0aW9uKAogICAgICAgIG9wdGlvbnM6IE11dGF0aW9uT3B0aW9ucygKICAgICAgICAgIGRvY3VtZW50OiBncWwoYWRkVXNlciksCiAgICAgICAgKSwKICAgICAgICBidWlsZGVyOiAoUnVuTXV0YXRpb24gcnVuTXV0YXRpb24sIFF1ZXJ5UmVzdWx0PyByZXN1bHQpIHsKICAgICAgICAgIHJldHVybiBDb2x1bW4oCiAgICAgICAgICAgIGNoaWxkcmVuOiBbCiAgICAgICAgICAgICAgVGV4dEZpZWxkKAogICAgICAgICAgICAgICAgY29udHJvbGxlcjogbmFtZUNvbnRyb2xsZXIsCiAgICAgICAgICAgICAgICBkZWNvcmF0aW9uOiBJbnB1dERlY29yYXRpb24obGFiZWxUZXh0OiAnTmFtZScpLAogICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgVGV4dEZpZWxkKAogICAgICAgICAgICAgICAgY29udHJvbGxlcjogZW1haWxDb250cm9sbGVyLAogICAgICAgICAgICAgICAgZGVjb3JhdGlvbjogSW5wdXREZWNvcmF0aW9uKGxhYmVsVGV4dDogJ0VtYWlsJyksCiAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICBFbGV2YXRlZEJ1dHRvbigKICAgICAgICAgICAgICAgIG9uUHJlc3NlZDogKCkgewogICAgICAgICAgICAgICAgICBydW5NdXRhdGlvbih7CiAgICAgICAgICAgICAgICAgICAgJ25hbWUnOiBuYW1lQ29udHJvbGxlci50ZXh0LAogICAgICAgICAgICAgICAgICAgICdlbWFpbCc6IGVtYWlsQ29udHJvbGxlci50ZXh0LAogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBjaGlsZDogVGV4dCgnQWRkIFVzZXInKSwKICAgICAgICAgICAgICApLAogICAgICAgICAgICAgIGlmIChyZXN1bHQgIT0gbnVsbCAmJiByZXN1bHQuaGFzRXhjZXB0aW9uKQogICAgICAgICAgICAgICAgVGV4dChyZXN1bHQuZXhjZXB0aW9uLnRvU3RyaW5nKCkpLAogICAgICAgICAgICAgIGlmIChyZXN1bHQgIT0gbnVsbCAmJiByZXN1bHQuaXNMb2FkaW5nKQogICAgICAgICAgICAgICAgQ2lyY3VsYXJQcm9ncmVzc0luZGljYXRvcigpLAogICAgICAgICAgICAgIGlmIChyZXN1bHQgIT0gbnVsbCAmJiByZXN1bHQuZGF0YSAhPSBudWxsKQogICAgICAgICAgICAgICAgVGV4dCgnVXNlciBhZGRlZCBzdWNjZXNzZnVsbHkhJyksCiAgICAgICAgICAgIF0sCiAgICAgICAgICApOwogICAgICAgIH0sCiAgICAgICksCiAgICApOwogIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class AddUserScreen extends StatelessWidget {
  final TextEditingController nameController = TextEditingController();
  final TextEditingController emailController = TextEditingController();

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Add User'),
      ),
      body: Mutation(
        options: MutationOptions(
          document: gql(addUser),
        ),
        builder: (RunMutation runMutation, QueryResult? result) {
          return Column(
            children: [
              TextField(
                controller: nameController,
                decoration: InputDecoration(labelText: 'Name'),
              ),
              TextField(
                controller: emailController,
                decoration: InputDecoration(labelText: 'Email'),
              ),
              ElevatedButton(
                onPressed: () {
                  runMutation({
                    'name': nameController.text,
                    'email': emailController.text,
                  });
                },
                child: Text('Add User'),
              ),
              if (result != null &amp;&amp; result.hasException)
                Text(result.exception.toString()),
              if (result != null &amp;&amp; result.isLoading)
                CircularProgressIndicator(),
              if (result != null &amp;&amp; result.data != null)
                Text('User added successfully!'),
            ],
          );
        },
      ),
    );
  }
}</pre></div><div class='content'></div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Task</h2>
<div class='content'><ol>
<li>Create a new Flutter project.</li>
<li>Set up GraphQL using the steps above.</li>
<li>Create a screen to fetch and display a list of users.</li>
<li>Create a screen to add a new user.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><p>Refer to the code snippets provided in the steps above to complete the exercise.</p>
</div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Incorrect Endpoint</strong>: Ensure the GraphQL endpoint URL is correct.</li>
<li><strong>Schema Mismatch</strong>: Ensure the queries and mutations match the GraphQL schema.</li>
<li><strong>Error Handling</strong>: Always handle errors gracefully to improve user experience.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, you learned how to integrate GraphQL into your Flutter application. You set up the GraphQL client, created queries and mutations, and executed them using the <code>Query</code> and <code>Mutation</code> widgets. This knowledge will help you build more efficient and flexible data-driven applications. In the next module, we will explore persistence and storage options in Flutter.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-04-using-rest-apis' title="Using REST APIs">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-01-introduction-to-persistence' title="Introduction to Persistence">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
