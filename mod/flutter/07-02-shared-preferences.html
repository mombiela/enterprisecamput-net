<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shared Preferences</title>

    <link rel="alternate" href="https://campusempresa.com/mod/flutter/07-02-shared-preferences" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/flutter/07-02-shared-preferences" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/flutter/07-02-shared-preferences" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/flutter/07-02-shared-preferences" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/flutter/07-02-shared-preferences" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-01-introduction-to-persistence' title="Introduction to Persistence">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Shared Preferences</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-03-file-storage' title="File Storage">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Shared Preferences in Flutter is a simple way to store small amounts of data persistently. This is particularly useful for storing user preferences, settings, or any other small data that needs to be retained across app launches.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>SharedPreferences Package</strong>: A Flutter plugin that provides a persistent storage mechanism for simple data.</li>
<li><strong>Key-Value Storage</strong>: Data is stored as key-value pairs, similar to a dictionary.</li>
<li><strong>Data Types Supported</strong>: Shared Preferences support basic data types like <code>int</code>, <code>double</code>, <code>bool</code>, <code>String</code>, and <code>List&lt;String&gt;</code>.</li>
</ol>
</div><h1><p>Setting Up Shared Preferences</p>
</h1>
<div class='content'></div><h2><p>Step 1: Add Dependency</p>
</h2>
<div class='content'><p>First, add the <code>shared_preferences</code> package to your <code>pubspec.yaml</code> file:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVwZW5kZW5jaWVzOgogIGZsdXR0ZXI6CiAgICBzZGs6IGZsdXR0ZXIKICBzaGFyZWRfcHJlZmVyZW5jZXM6IF4yLjAuNg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>dependencies:
  flutter:
    sdk: flutter
  shared_preferences: ^2.0.6</pre></div><div class='content'><p>Run <code>flutter pub get</code> to install the package.</p>
</div><h2><p>Step 2: Import the Package</p>
</h2>
<div class='content'><p>Import the <code>shared_preferences</code> package in your Dart file:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0ICdwYWNrYWdlOnNoYXJlZF9wcmVmZXJlbmNlcy9zaGFyZWRfcHJlZmVyZW5jZXMuZGFydCc7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import 'package:shared_preferences/shared_preferences.dart';</pre></div><div class='content'></div><h1><p>Using Shared Preferences</p>
</h1>
<div class='content'></div><h2><p>Saving Data</p>
</h2>
<div class='content'><p>To save data, you need to get an instance of <code>SharedPreferences</code> and then use the appropriate setter method.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnV0dXJlPHZvaWQ+IHNhdmVEYXRhKCkgYXN5bmMgewogIGZpbmFsIHByZWZzID0gYXdhaXQgU2hhcmVkUHJlZmVyZW5jZXMuZ2V0SW5zdGFuY2UoKTsKICBhd2FpdCBwcmVmcy5zZXRJbnQoJ2NvdW50ZXInLCAxMCk7CiAgYXdhaXQgcHJlZnMuc2V0U3RyaW5nKCd1c2VybmFtZScsICdKb2huRG9lJyk7CiAgYXdhaXQgcHJlZnMuc2V0Qm9vbCgnaXNMb2dnZWRJbicsIHRydWUpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Future&lt;void&gt; saveData() async {
  final prefs = await SharedPreferences.getInstance();
  await prefs.setInt('counter', 10);
  await prefs.setString('username', 'JohnDoe');
  await prefs.setBool('isLoggedIn', true);
}</pre></div><div class='content'></div><h2><p>Reading Data</p>
</h2>
<div class='content'><p>To read data, you also need to get an instance of <code>SharedPreferences</code> and then use the appropriate getter method.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnV0dXJlPHZvaWQ+IHJlYWREYXRhKCkgYXN5bmMgewogIGZpbmFsIHByZWZzID0gYXdhaXQgU2hhcmVkUHJlZmVyZW5jZXMuZ2V0SW5zdGFuY2UoKTsKICBpbnQgY291bnRlciA9IHByZWZzLmdldEludCgnY291bnRlcicpID8/IDA7CiAgU3RyaW5nIHVzZXJuYW1lID0gcHJlZnMuZ2V0U3RyaW5nKCd1c2VybmFtZScpID8/ICdHdWVzdCc7CiAgYm9vbCBpc0xvZ2dlZEluID0gcHJlZnMuZ2V0Qm9vbCgnaXNMb2dnZWRJbicpID8/IGZhbHNlOwoKICBwcmludCgnQ291bnRlcjogJGNvdW50ZXInKTsKICBwcmludCgnVXNlcm5hbWU6ICR1c2VybmFtZScpOwogIHByaW50KCdJcyBMb2dnZWQgSW46ICRpc0xvZ2dlZEluJyk7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Future&lt;void&gt; readData() async {
  final prefs = await SharedPreferences.getInstance();
  int counter = prefs.getInt('counter') ?? 0;
  String username = prefs.getString('username') ?? 'Guest';
  bool isLoggedIn = prefs.getBool('isLoggedIn') ?? false;

  print('Counter: $counter');
  print('Username: $username');
  print('Is Logged In: $isLoggedIn');
}</pre></div><div class='content'></div><h2><p>Removing Data</p>
</h2>
<div class='content'><p>To remove data, use the <code>remove</code> method with the key of the data you want to delete.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnV0dXJlPHZvaWQ+IHJlbW92ZURhdGEoKSBhc3luYyB7CiAgZmluYWwgcHJlZnMgPSBhd2FpdCBTaGFyZWRQcmVmZXJlbmNlcy5nZXRJbnN0YW5jZSgpOwogIGF3YWl0IHByZWZzLnJlbW92ZSgnY291bnRlcicpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Future&lt;void&gt; removeData() async {
  final prefs = await SharedPreferences.getInstance();
  await prefs.remove('counter');
}</pre></div><div class='content'></div><h1><p>Practical Example</p>
</h1>
<div class='content'><p>Let's create a simple Flutter app that uses Shared Preferences to store and retrieve a counter value.</p>
</div><h2><p>Step 1: Create a New Flutter Project</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Zmx1dHRlciBjcmVhdGUgc2hhcmVkX3ByZWZlcmVuY2VzX2V4YW1wbGUKY2Qgc2hhcmVkX3ByZWZlcmVuY2VzX2V4YW1wbGU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>flutter create shared_preferences_example
cd shared_preferences_example</pre></div><div class='content'></div><h2><p>Step 2: Update <code>pubspec.yaml</code></p>
</h2>
<div class='content'><p>Add the <code>shared_preferences</code> dependency:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVwZW5kZW5jaWVzOgogIGZsdXR0ZXI6CiAgICBzZGs6IGZsdXR0ZXIKICBzaGFyZWRfcHJlZmVyZW5jZXM6IF4yLjAuNg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>dependencies:
  flutter:
    sdk: flutter
  shared_preferences: ^2.0.6</pre></div><div class='content'></div><h2><p>Step 3: Update <code>main.dart</code></p>
</h2>
<div class='content'><p>Replace the content of <code>lib/main.dart</code> with the following code:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0ICdwYWNrYWdlOmZsdXR0ZXIvbWF0ZXJpYWwuZGFydCc7CmltcG9ydCAncGFja2FnZTpzaGFyZWRfcHJlZmVyZW5jZXMvc2hhcmVkX3ByZWZlcmVuY2VzLmRhcnQnOwoKdm9pZCBtYWluKCkgewogIHJ1bkFwcChNeUFwcCgpKTsKfQoKY2xhc3MgTXlBcHAgZXh0ZW5kcyBTdGF0ZWxlc3NXaWRnZXQgewogIEBvdmVycmlkZQogIFdpZGdldCBidWlsZChCdWlsZENvbnRleHQgY29udGV4dCkgewogICAgcmV0dXJuIE1hdGVyaWFsQXBwKAogICAgICBob21lOiBDb3VudGVyU2NyZWVuKCksCiAgICApOwogIH0KfQoKY2xhc3MgQ291bnRlclNjcmVlbiBleHRlbmRzIFN0YXRlZnVsV2lkZ2V0IHsKICBAb3ZlcnJpZGUKICBfQ291bnRlclNjcmVlblN0YXRlIGNyZWF0ZVN0YXRlKCkgPT4gX0NvdW50ZXJTY3JlZW5TdGF0ZSgpOwp9CgpjbGFzcyBfQ291bnRlclNjcmVlblN0YXRlIGV4dGVuZHMgU3RhdGU8Q291bnRlclNjcmVlbj4gewogIGludCBfY291bnRlciA9IDA7CgogIEBvdmVycmlkZQogIHZvaWQgaW5pdFN0YXRlKCkgewogICAgc3VwZXIuaW5pdFN0YXRlKCk7CiAgICBfbG9hZENvdW50ZXIoKTsKICB9CgogIC8vIExvYWQgY291bnRlciB2YWx1ZSBmcm9tIFNoYXJlZFByZWZlcmVuY2VzCiAgRnV0dXJlPHZvaWQ+IF9sb2FkQ291bnRlcigpIGFzeW5jIHsKICAgIGZpbmFsIHByZWZzID0gYXdhaXQgU2hhcmVkUHJlZmVyZW5jZXMuZ2V0SW5zdGFuY2UoKTsKICAgIHNldFN0YXRlKCgpIHsKICAgICAgX2NvdW50ZXIgPSBwcmVmcy5nZXRJbnQoJ2NvdW50ZXInKSA/PyAwOwogICAgfSk7CiAgfQoKICAvLyBJbmNyZW1lbnQgY291bnRlciBhbmQgc2F2ZSB0byBTaGFyZWRQcmVmZXJlbmNlcwogIEZ1dHVyZTx2b2lkPiBfaW5jcmVtZW50Q291bnRlcigpIGFzeW5jIHsKICAgIGZpbmFsIHByZWZzID0gYXdhaXQgU2hhcmVkUHJlZmVyZW5jZXMuZ2V0SW5zdGFuY2UoKTsKICAgIHNldFN0YXRlKCgpIHsKICAgICAgX2NvdW50ZXIrKzsKICAgIH0pOwogICAgYXdhaXQgcHJlZnMuc2V0SW50KCdjb3VudGVyJywgX2NvdW50ZXIpOwogIH0KCiAgQG92ZXJyaWRlCiAgV2lkZ2V0IGJ1aWxkKEJ1aWxkQ29udGV4dCBjb250ZXh0KSB7CiAgICByZXR1cm4gU2NhZmZvbGQoCiAgICAgIGFwcEJhcjogQXBwQmFyKAogICAgICAgIHRpdGxlOiBUZXh0KCdTaGFyZWQgUHJlZmVyZW5jZXMgRXhhbXBsZScpLAogICAgICApLAogICAgICBib2R5OiBDZW50ZXIoCiAgICAgICAgY2hpbGQ6IENvbHVtbigKICAgICAgICAgIG1haW5BeGlzQWxpZ25tZW50OiBNYWluQXhpc0FsaWdubWVudC5jZW50ZXIsCiAgICAgICAgICBjaGlsZHJlbjogPFdpZGdldD5bCiAgICAgICAgICAgIFRleHQoCiAgICAgICAgICAgICAgJ1lvdSBoYXZlIHB1c2hlZCB0aGUgYnV0dG9uIHRoaXMgbWFueSB0aW1lczonLAogICAgICAgICAgICApLAogICAgICAgICAgICBUZXh0KAogICAgICAgICAgICAgICckX2NvdW50ZXInLAogICAgICAgICAgICAgIHN0eWxlOiBUaGVtZS5vZihjb250ZXh0KS50ZXh0VGhlbWUuaGVhZGxpbmU0LAogICAgICAgICAgICApLAogICAgICAgICAgXSwKICAgICAgICApLAogICAgICApLAogICAgICBmbG9hdGluZ0FjdGlvbkJ1dHRvbjogRmxvYXRpbmdBY3Rpb25CdXR0b24oCiAgICAgICAgb25QcmVzc2VkOiBfaW5jcmVtZW50Q291bnRlciwKICAgICAgICB0b29sdGlwOiAnSW5jcmVtZW50JywKICAgICAgICBjaGlsZDogSWNvbihJY29ucy5hZGQpLAogICAgICApLAogICAgKTsKICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import 'package:flutter/material.dart';
import 'package:shared_preferences/shared_preferences.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      home: CounterScreen(),
    );
  }
}

class CounterScreen extends StatefulWidget {
  @override
  _CounterScreenState createState() =&gt; _CounterScreenState();
}

class _CounterScreenState extends State&lt;CounterScreen&gt; {
  int _counter = 0;

  @override
  void initState() {
    super.initState();
    _loadCounter();
  }

  // Load counter value from SharedPreferences
  Future&lt;void&gt; _loadCounter() async {
    final prefs = await SharedPreferences.getInstance();
    setState(() {
      _counter = prefs.getInt('counter') ?? 0;
    });
  }

  // Increment counter and save to SharedPreferences
  Future&lt;void&gt; _incrementCounter() async {
    final prefs = await SharedPreferences.getInstance();
    setState(() {
      _counter++;
    });
    await prefs.setInt('counter', _counter);
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Shared Preferences Example'),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: &lt;Widget&gt;[
            Text(
              'You have pushed the button this many times:',
            ),
            Text(
              '$_counter',
              style: Theme.of(context).textTheme.headline4,
            ),
          ],
        ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: _incrementCounter,
        tooltip: 'Increment',
        child: Icon(Icons.add),
      ),
    );
  }
}</pre></div><div class='content'></div><h2><p>Step 4: Run the App</p>
</h2>
<div class='content'><p>Run the app using <code>flutter run</code>. You should see a counter that increments each time you press the floating action button. The counter value is saved using Shared Preferences and will persist across app launches.</p>
</div><h1><p>Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Save User Preferences</p>
</h2>
<div class='content'><p>Create a form that allows users to save their name and email. Use Shared Preferences to persist this data.</p>
<p><strong>Solution:</strong></p>
<ol>
<li>Add text fields for name and email.</li>
<li>Save the data using Shared Preferences when the user submits the form.</li>
<li>Load the data when the form is initialized.</li>
</ol>
</div><h2><p>Exercise 2: Theme Preference</p>
</h2>
<div class='content'><p>Add a toggle switch to enable dark mode. Save the user's preference using Shared Preferences and apply the theme accordingly.</p>
<p><strong>Solution:</strong></p>
<ol>
<li>Add a switch to toggle between light and dark themes.</li>
<li>Save the theme preference using Shared Preferences.</li>
<li>Load the theme preference when the app starts and apply the theme.</li>
</ol>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Forgetting to await</strong>: Always use <code>await</code> when calling methods on <code>SharedPreferences</code> to ensure the data is saved or loaded correctly.</li>
<li><strong>Null Safety</strong>: Always provide a default value when reading data to handle cases where the key might not exist.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, you learned how to use Shared Preferences in Flutter to store and retrieve small amounts of data persistently. This is a powerful tool for saving user settings, preferences, and other small pieces of data that need to be retained across app launches. In the next section, we will explore file storage for handling larger amounts of data.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-01-introduction-to-persistence' title="Introduction to Persistence">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-03-file-storage' title="File Storage">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
