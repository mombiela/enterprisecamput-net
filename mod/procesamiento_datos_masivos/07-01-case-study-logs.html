<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case Study 1: Log Analysis</title>

    <link rel="alternate" href="https://campusempresa.com/mod/procesamiento_datos_masivos/07-01-caso-estudio-logs" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/procesamiento_datos_masivos/07-01-cas-estudi-logs" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/procesamiento_datos_masivos/07-01-case-study-logs" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/procesamiento_datos_masivos/07-01-caso-estudio-logs" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/procesamiento_datos_masivos/07-01-cas-estudi-logs" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='06-03-data-visualization' title="Data Visualization">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Case Study 1: Log Analysis</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-02-case-study-recommendations' title="Case Study 2: Real-Time Recommendations">Next &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this case study, we will explore how to analyze large volumes of log data using various big data processing techniques and tools. Log data is generated by servers, applications, and network devices, and it contains valuable information for monitoring system performance, detecting anomalies, and troubleshooting issues.</p>
</div><h1>Objectives</h1>
<div class='content'><ul>
<li>Understand the importance of log analysis.</li>
<li>Learn how to preprocess and store log data.</li>
<li>Apply big data processing techniques to analyze log data.</li>
<li>Visualize the results for better insights.</li>
</ul>
</div><h1>Importance of Log Analysis</h1>
<div class='content'><p>Log analysis is crucial for several reasons:</p>
<ul>
<li><strong>Performance Monitoring:</strong> Helps in tracking the performance of systems and applications.</li>
<li><strong>Security:</strong> Detects unauthorized access and potential security breaches.</li>
<li><strong>Troubleshooting:</strong> Identifies and resolves issues quickly.</li>
<li><strong>Compliance:</strong> Ensures adherence to regulatory requirements.</li>
</ul>
</div><h1>Steps in Log Analysis</h1>
<div class='content'><ol>
<li><strong>Data Collection:</strong> Gathering log data from various sources.</li>
<li><strong>Data Preprocessing:</strong> Cleaning and transforming the data.</li>
<li><strong>Data Storage:</strong> Storing the data in a scalable and efficient manner.</li>
<li><strong>Data Processing:</strong> Analyzing the data to extract meaningful insights.</li>
<li><strong>Data Visualization:</strong> Presenting the results in an understandable format.</li>
</ol>
</div><h1>Data Collection</h1>
<div class='content'><p>Log data can be collected from multiple sources such as:</p>
<ul>
<li>Web servers (e.g., Apache, Nginx)</li>
<li>Application servers</li>
<li>Databases</li>
<li>Network devices (e.g., routers, firewalls)</li>
</ul>
</div><h2>Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDb2xsZWN0aW5nIGxvZ3MgZnJvbSBhbiBBcGFjaGUgc2VydmVyCnNjcCB1c2VyQHNlcnZlcjovdmFyL2xvZy9hcGFjaGUyL2FjY2Vzcy5sb2cgL2xvY2FsL3BhdGgv"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Collecting logs from an Apache server
scp user@server:/var/log/apache2/access.log /local/path/</pre></div><div class='content'></div><h1>Data Preprocessing</h1>
<div class='content'><p>Preprocessing involves cleaning and transforming the raw log data into a structured format suitable for analysis.</p>
</div><h2>Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHJlCgpkZWYgcHJlcHJvY2Vzc19sb2dfbGluZShsb2dfbGluZSk6CiAgICAjIFJlZ3VsYXIgZXhwcmVzc2lvbiB0byBwYXJzZSBBcGFjaGUgbG9nIGxpbmVzCiAgICBsb2dfcGF0dGVybiA9IHJlLmNvbXBpbGUocicoXFMrKSAoXFMrKSAoXFMrKSBcWyguKj8pXF0gIiguKj8pIiAoXGR7M30pIChcZCspJykKICAgIG1hdGNoID0gbG9nX3BhdHRlcm4ubWF0Y2gobG9nX2xpbmUpCiAgICAKICAgIGlmIG1hdGNoOgogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICJpcCI6IG1hdGNoLmdyb3VwKDEpLAogICAgICAgICAgICAidXNlcl9pZGVudGlmaWVyIjogbWF0Y2guZ3JvdXAoMiksCiAgICAgICAgICAgICJ1c2VyX2lkIjogbWF0Y2guZ3JvdXAoMyksCiAgICAgICAgICAgICJ0aW1lc3RhbXAiOiBtYXRjaC5ncm91cCg0KSwKICAgICAgICAgICAgInJlcXVlc3QiOiBtYXRjaC5ncm91cCg1KSwKICAgICAgICAgICAgInN0YXR1c19jb2RlIjogbWF0Y2guZ3JvdXAoNiksCiAgICAgICAgICAgICJzaXplIjogbWF0Y2guZ3JvdXAoNykKICAgICAgICB9CiAgICByZXR1cm4gTm9uZQoKIyBFeGFtcGxlIGxvZyBsaW5lCmxvZ19saW5lID0gJzEyNy4wLjAuMSAtIGZyYW5rIFsxMC9PY3QvMjAwMDoxMzo1NTozNiAtMDcwMF0gIkdFVCAvYXBhY2hlX3BiLmdpZiBIVFRQLzEuMCIgMjAwIDIzMjYnCnByZXByb2Nlc3NlZF9sb2cgPSBwcmVwcm9jZXNzX2xvZ19saW5lKGxvZ19saW5lKQpwcmludChwcmVwcm9jZXNzZWRfbG9nKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import re

def preprocess_log_line(log_line):
    # Regular expression to parse Apache log lines
    log_pattern = re.compile(r'(\S+) (\S+) (\S+) \[(.*?)\] &quot;(.*?)&quot; (\d{3}) (\d+)')
    match = log_pattern.match(log_line)
    
    if match:
        return {
            &quot;ip&quot;: match.group(1),
            &quot;user_identifier&quot;: match.group(2),
            &quot;user_id&quot;: match.group(3),
            &quot;timestamp&quot;: match.group(4),
            &quot;request&quot;: match.group(5),
            &quot;status_code&quot;: match.group(6),
            &quot;size&quot;: match.group(7)
        }
    return None

# Example log line
log_line = '127.0.0.1 - frank [10/Oct/2000:13:55:36 -0700] &quot;GET /apache_pb.gif HTTP/1.0&quot; 200 2326'
preprocessed_log = preprocess_log_line(log_line)
print(preprocessed_log)</pre></div><div class='content'></div><h1>Data Storage</h1>
<div class='content'><p>Storing log data efficiently is crucial for scalability and performance. Common storage solutions include:</p>
<ul>
<li><strong>HDFS (Hadoop Distributed File System):</strong> For distributed storage.</li>
<li><strong>NoSQL Databases:</strong> Such as MongoDB or Cassandra for flexible schema and high write throughput.</li>
<li><strong>Cloud Storage:</strong> Services like Amazon S3 or Google Cloud Storage for scalability and durability.</li>
</ul>
</div><h2>Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweW1vbmdvIGltcG9ydCBNb25nb0NsaWVudAoKIyBDb25uZWN0IHRvIE1vbmdvREIKY2xpZW50ID0gTW9uZ29DbGllbnQoJ21vbmdvZGI6Ly9sb2NhbGhvc3Q6MjcwMTcvJykKZGIgPSBjbGllbnRbJ2xvZ19hbmFseXNpcyddCmNvbGxlY3Rpb24gPSBkYlsnbG9ncyddCgojIEluc2VydCBwcmVwcm9jZXNzZWQgbG9nIGludG8gTW9uZ29EQgpjb2xsZWN0aW9uLmluc2VydF9vbmUocHJlcHJvY2Vzc2VkX2xvZyk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pymongo import MongoClient

# Connect to MongoDB
client = MongoClient('mongodb://localhost:27017/')
db = client['log_analysis']
collection = db['logs']

# Insert preprocessed log into MongoDB
collection.insert_one(preprocessed_log)</pre></div><div class='content'></div><h1>Data Processing</h1>
<div class='content'><p>Processing log data involves querying and analyzing the data to extract insights. Tools like Apache Spark can be used for distributed processing.</p>
</div><h2>Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaXRpYWxpemUgU3Bhcmsgc2Vzc2lvbgpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIkxvZ0FuYWx5c2lzIikuZ2V0T3JDcmVhdGUoKQoKIyBMb2FkIGRhdGEgZnJvbSBNb25nb0RCCmRmID0gc3BhcmsucmVhZC5mb3JtYXQoIm1vbmdvIikub3B0aW9uKCJ1cmkiLCAibW9uZ29kYjovL2xvY2FsaG9zdDoyNzAxNy9sb2dfYW5hbHlzaXMubG9ncyIpLmxvYWQoKQoKIyBQZXJmb3JtIGFuYWx5c2lzIChlLmcuLCBjb3VudCByZXF1ZXN0cyBieSBzdGF0dXMgY29kZSkKc3RhdHVzX2NvZGVfY291bnRzID0gZGYuZ3JvdXBCeSgic3RhdHVzX2NvZGUiKS5jb3VudCgpCnN0YXR1c19jb2RlX2NvdW50cy5zaG93KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Initialize Spark session
spark = SparkSession.builder.appName(&quot;LogAnalysis&quot;).getOrCreate()

# Load data from MongoDB
df = spark.read.format(&quot;mongo&quot;).option(&quot;uri&quot;, &quot;mongodb://localhost:27017/log_analysis.logs&quot;).load()

# Perform analysis (e.g., count requests by status code)
status_code_counts = df.groupBy(&quot;status_code&quot;).count()
status_code_counts.show()</pre></div><div class='content'></div><h1>Data Visualization</h1>
<div class='content'><p>Visualizing the results helps in understanding the data better and making informed decisions. Tools like Matplotlib, Seaborn, or specialized dashboards like Kibana can be used.</p>
</div><h2>Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG1hdHBsb3RsaWIucHlwbG90IGFzIHBsdAoKIyBTYW1wbGUgZGF0YQpzdGF0dXNfY29kZXMgPSBbJzIwMCcsICc0MDQnLCAnNTAwJ10KY291bnRzID0gWzE1MDAsIDMwMCwgNTBdCgojIFBsb3R0aW5nCnBsdC5iYXIoc3RhdHVzX2NvZGVzLCBjb3VudHMpCnBsdC54bGFiZWwoJ1N0YXR1cyBDb2RlJykKcGx0LnlsYWJlbCgnQ291bnQnKQpwbHQudGl0bGUoJ0hUVFAgU3RhdHVzIENvZGUgRGlzdHJpYnV0aW9uJykKcGx0LnNob3coKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import matplotlib.pyplot as plt

# Sample data
status_codes = ['200', '404', '500']
counts = [1500, 300, 50]

# Plotting
plt.bar(status_codes, counts)
plt.xlabel('Status Code')
plt.ylabel('Count')
plt.title('HTTP Status Code Distribution')
plt.show()</pre></div><div class='content'></div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise</h2>
<div class='content'><ol>
<li>Collect log data from a web server.</li>
<li>Preprocess the log data to extract relevant fields.</li>
<li>Store the preprocessed data in a NoSQL database.</li>
<li>Use Apache Spark to analyze the data and find the top 5 IP addresses with the most requests.</li>
<li>Visualize the results using a bar chart.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><ol>
<li><strong>Collect log data:</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2NwIHVzZXJAc2VydmVyOi92YXIvbG9nL2FwYWNoZTIvYWNjZXNzLmxvZyAvbG9jYWwvcGF0aC8="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>scp user@server:/var/log/apache2/access.log /local/path/</pre></div><div class='content'><ol start="2">
<li><strong>Preprocess the log data:</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQcmVwcm9jZXNzaW5nIGZ1bmN0aW9uIGFzIHNob3duIGFib3Zl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Preprocessing function as shown above</pre></div><div class='content'><ol start="3">
<li><strong>Store the data in MongoDB:</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBNb25nb0RCIGluc2VydGlvbiBjb2RlIGFzIHNob3duIGFib3Zl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># MongoDB insertion code as shown above</pre></div><div class='content'><ol start="4">
<li><strong>Analyze the data with Spark:</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTcGFyayBhbmFseXNpcyBjb2RlCnRvcF9pcHMgPSBkZi5ncm91cEJ5KCJpcCIpLmNvdW50KCkub3JkZXJCeSgiY291bnQiLCBhc2NlbmRpbmc9RmFsc2UpLmxpbWl0KDUpCnRvcF9pcHMuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Spark analysis code
top_ips = df.groupBy(&quot;ip&quot;).count().orderBy(&quot;count&quot;, ascending=False).limit(5)
top_ips.show()</pre></div><div class='content'><ol start="5">
<li><strong>Visualize the results:</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBWaXN1YWxpemF0aW9uIGNvZGUKaXBzID0gWycxOTIuMTY4LjEuMScsICcxOTIuMTY4LjEuMicsICcxOTIuMTY4LjEuMycsICcxOTIuMTY4LjEuNCcsICcxOTIuMTY4LjEuNSddCmNvdW50cyA9IFs1MDAsIDQ1MCwgNDAwLCAzNTAsIDMwMF0KCnBsdC5iYXIoaXBzLCBjb3VudHMpCnBsdC54bGFiZWwoJ0lQIEFkZHJlc3MnKQpwbHQueWxhYmVsKCdSZXF1ZXN0IENvdW50JykKcGx0LnRpdGxlKCdUb3AgNSBJUCBBZGRyZXNzZXMgYnkgUmVxdWVzdCBDb3VudCcpCnBsdC5zaG93KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Visualization code
ips = ['192.168.1.1', '192.168.1.2', '192.168.1.3', '192.168.1.4', '192.168.1.5']
counts = [500, 450, 400, 350, 300]

plt.bar(ips, counts)
plt.xlabel('IP Address')
plt.ylabel('Request Count')
plt.title('Top 5 IP Addresses by Request Count')
plt.show()</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this case study, we covered the end-to-end process of log analysis, from data collection to visualization. By following these steps, you can gain valuable insights from log data, which can help in monitoring performance, enhancing security, and troubleshooting issues effectively. This practical approach provides a solid foundation for handling massive data processing tasks in real-world scenarios.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-03-data-visualization' title="Data Visualization">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-02-case-study-recommendations' title="Case Study 2: Real-Time Recommendations">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
