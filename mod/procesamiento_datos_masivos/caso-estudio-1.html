<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case Study 1: Log Analysis</title>

    <link rel="alternate" href="https://campusempresa.com/mod/procesamiento_datos_masivos/caso-estudio-1" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/procesamiento_datos_masivos/caso-estudio-1" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/procesamiento_datos_masivos/caso-estudio-1" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/procesamiento_datos_masivos/caso-estudio-1" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/procesamiento_datos_masivos/caso-estudio-1" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this case study, we will explore how to analyze large volumes of logs generated by computer systems. Logs are detailed records of events that occur in a system and are essential for monitoring, debugging, and security. We will learn to process and extract valuable information from these data using big data processing tools and techniques.</p>
</div><h1>Objectives</h1>
<div class='content'><ul>
<li>Understand the importance of logs in system monitoring and debugging.</li>
<li>Learn to preprocess and clean log data.</li>
<li>Use big data processing tools to analyze logs.</li>
<li>Extract valuable information and generate reports from the logs.</li>
</ul>
</div><h1>Tools and Technologies</h1>
<div class='content'><ul>
<li><strong>Apache Hadoop</strong>: For distributed storage and processing of large volumes of data.</li>
<li><strong>Apache Spark</strong>: For fast, in-memory processing of big data.</li>
<li><strong>Python</strong>: For data manipulation and analysis.</li>
<li><strong>Logstash</strong>: For log ingestion and transformation.</li>
<li><strong>Kibana</strong>: For log data visualization.</li>
</ul>
</div><h1>Dataset</h1>
<div class='content'><p>The dataset used in this case study consists of web access logs generated by an Apache web server. Each log line contains information about an HTTP request, including the client's IP address, the date and time of the request, the HTTP method, the requested resource, the HTTP status code, and the response size.</p>
<p>Example of a log line:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("MTI3LjAuMC4xIC0gLSBbMTAvT2N0LzIwMjM6MTM6NTU6MzYgLTA3MDBdICJHRVQgL2luZGV4Lmh0bWwgSFRUUC8xLjEiIDIwMCAyMzI2"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>127.0.0.1 - - [10/Oct/2023:13:55:36 -0700] &quot;GET /index.html HTTP/1.1&quot; 200 2326</pre></div><div class='content'></div><h1>Data Preprocessing</h1>
<div class='content'><p>Before analyzing the logs, it is necessary to preprocess the data to clean and structure it properly.</p>
</div><h2>Preprocessing Steps</h2>
<div class='content'><ol>
<li><strong>Remove corrupt lines</strong>: Filter lines that do not follow the expected format.</li>
<li><strong>Parse log lines</strong>: Extract relevant fields from each line.</li>
<li><strong>Convert data types</strong>: Ensure each field has the correct data type (e.g., convert dates to datetime objects).</li>
</ol>
<p>Example of Python code to preprocess logs:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHJlCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCgpsb2dfcGF0dGVybiA9IHJlLmNvbXBpbGUoCiAgICByJyg/UDxpcD5cZCtcLlxkK1wuXGQrXC5cZCspIC0gLSBcWyg/UDxkYXRldGltZT5bXlxdXSspXF0gIig/UDxtZXRob2Q+XHcrKSAoP1A8cmVzb3VyY2U+W15cc10rKSBIVFRQL1xkXC5cZCIgKD9QPHN0YXR1cz5cZCspICg/UDxzaXplPlxkKyknCikKCmRlZiBwYXJzZV9sb2dfbGluZShsaW5lKToKICAgIG1hdGNoID0gbG9nX3BhdHRlcm4ubWF0Y2gobGluZSkKICAgIGlmIG1hdGNoOgogICAgICAgIGRhdGEgPSBtYXRjaC5ncm91cGRpY3QoKQogICAgICAgIGRhdGFbJ2RhdGV0aW1lJ10gPSBkYXRldGltZS5zdHJwdGltZShkYXRhWydkYXRldGltZSddLCAnJWQvJWIvJVk6JUg6JU06JVMgJXonKQogICAgICAgIGRhdGFbJ3N0YXR1cyddID0gaW50KGRhdGFbJ3N0YXR1cyddKQogICAgICAgIGRhdGFbJ3NpemUnXSA9IGludChkYXRhWydzaXplJ10pCiAgICAgICAgcmV0dXJuIGRhdGEKICAgIHJldHVybiBOb25lCgojIEV4YW1wbGUgdXNhZ2UKbG9nX2xpbmUgPSAnMTI3LjAuMC4xIC0gLSBbMTAvT2N0LzIwMjM6MTM6NTU6MzYgLTA3MDBdICJHRVQgL2luZGV4Lmh0bWwgSFRUUC8xLjEiIDIwMCAyMzI2JwpwYXJzZWRfbG9nID0gcGFyc2VfbG9nX2xpbmUobG9nX2xpbmUpCnByaW50KHBhcnNlZF9sb2cp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import re
from datetime import datetime

log_pattern = re.compile(
    r'(?P&lt;ip&gt;\d+\.\d+\.\d+\.\d+) - - \[(?P&lt;datetime&gt;[^\]]+)\] &quot;(?P&lt;method&gt;\w+) (?P&lt;resource&gt;[^\s]+) HTTP/\d\.\d&quot; (?P&lt;status&gt;\d+) (?P&lt;size&gt;\d+)'
)

def parse_log_line(line):
    match = log_pattern.match(line)
    if match:
        data = match.groupdict()
        data['datetime'] = datetime.strptime(data['datetime'], '%d/%b/%Y:%H:%M:%S %z')
        data['status'] = int(data['status'])
        data['size'] = int(data['size'])
        return data
    return None

# Example usage
log_line = '127.0.0.1 - - [10/Oct/2023:13:55:36 -0700] &quot;GET /index.html HTTP/1.1&quot; 200 2326'
parsed_log = parse_log_line(log_line)
print(parsed_log)</pre></div><div class='content'></div><h1>Log Analysis</h1>
<div class='content'><p>Once the data is preprocessed, we can proceed with the analysis. We will use Apache Spark to perform distributed analysis and gain insights from the logs.</p>
</div><h2>Analysis Examples</h2>
<div class='content'><ul>
<li><strong>Count the number of requests per IP</strong>: Identify the IPs making the most requests.</li>
<li><strong>Distribution of HTTP status codes</strong>: Analyze the frequency of different status codes (200, 404, 500, etc.).</li>
<li><strong>Most requested resources</strong>: Determine which resources are most accessed on the server.</li>
</ul>
<p>Example of PySpark code to count requests per IP:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCmZyb20gcHlzcGFyay5zcWwuZnVuY3Rpb25zIGltcG9ydCBjb2wKCiMgQ3JlYXRlIGEgU3Bhcmsgc2Vzc2lvbgpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIkxvZ0FuYWx5c2lzIikuZ2V0T3JDcmVhdGUoKQoKIyBMb2FkIHRoZSBwcmVwcm9jZXNzZWQgbG9ncyBpbnRvIGEgRGF0YUZyYW1lCmxvZ3NfZGYgPSBzcGFyay5yZWFkLmpzb24oInBhdGgvdG8vcHJlcHJvY2Vzc2VkX2xvZ3MuanNvbiIpCgojIENvdW50IHRoZSBudW1iZXIgb2YgcmVxdWVzdHMgcGVyIElQCmlwX2NvdW50cyA9IGxvZ3NfZGYuZ3JvdXBCeSgiaXAiKS5jb3VudCgpLm9yZGVyQnkoY29sKCJjb3VudCIpLmRlc2MoKSkKCiMgU2hvdyB0aGUgcmVzdWx0cwppcF9jb3VudHMuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession
from pyspark.sql.functions import col

# Create a Spark session
spark = SparkSession.builder.appName(&quot;LogAnalysis&quot;).getOrCreate()

# Load the preprocessed logs into a DataFrame
logs_df = spark.read.json(&quot;path/to/preprocessed_logs.json&quot;)

# Count the number of requests per IP
ip_counts = logs_df.groupBy(&quot;ip&quot;).count().orderBy(col(&quot;count&quot;).desc())

# Show the results
ip_counts.show()</pre></div><div class='content'></div><h1>Data Visualization</h1>
<div class='content'><p>To visualize the analysis results, we will use Kibana. Kibana allows creating interactive dashboards that facilitate data interpretation.</p>
</div><h2>Visualization Examples</h2>
<div class='content'><ul>
<li><strong>Bar chart</strong>: Number of requests per IP.</li>
<li><strong>Pie chart</strong>: Distribution of HTTP status codes.</li>
<li><strong>Line chart</strong>: Request trend over time.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this case study, we have learned to analyze web access logs using big data processing tools. From data preprocessing to analysis and visualization, each step is crucial to extract valuable information from logs. These skills are essential for any professional working with large volumes of data and needing to monitor and debug systems effectively.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
