<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project 4: Machine Learning with Hadoop</title>

    <link rel="alternate" href="https://campusempresa.com/mod/hadoop/08-04-project-4-machine-learning-with-hadoop" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/hadoop/08-04-project-4-machine-learning-with-hadoop" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/hadoop/08-04-project-4-machine-learning-with-hadoop" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/hadoop/08-04-project-4-machine-learning-with-hadoop" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/hadoop/08-04-project-4-machine-learning-with-hadoop" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-03-project-3-real-time-data-processing-with-hadoop' title="Project 3: Real-Time Data Processing with Hadoop">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Project 4: Machine Learning with Hadoop</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
			</div>
</div>
<div class='content'></div><h1><p>Introduction</p>
</h1>
<div class='content'><p>In this project, we will explore how to leverage Hadoop for machine learning tasks. We will use the Hadoop ecosystem tools to preprocess data, train machine learning models, and evaluate their performance. This project will provide hands-on experience with integrating Hadoop with machine learning frameworks.</p>
</div><h1><p>Objectives</p>
</h1>
<div class='content'><ul>
<li>Understand the integration of Hadoop with machine learning frameworks.</li>
<li>Preprocess large datasets using Hadoop tools.</li>
<li>Train and evaluate machine learning models on Hadoop.</li>
<li>Implement a machine learning pipeline using Hadoop ecosystem tools.</li>
</ul>
</div><h1><p>Prerequisites</p>
</h1>
<div class='content'><ul>
<li>Basic understanding of Hadoop and its ecosystem.</li>
<li>Familiarity with machine learning concepts.</li>
<li>Knowledge of programming in Java or Python.</li>
</ul>
</div><h1><p>Tools and Technologies</p>
</h1>
<div class='content'><ul>
<li><strong>Hadoop</strong>: For distributed storage and processing.</li>
<li><strong>Apache Mahout</strong>: A scalable machine learning library.</li>
<li><strong>Apache Spark</strong>: For distributed data processing and machine learning.</li>
<li><strong>HDFS</strong>: For storing large datasets.</li>
<li><strong>YARN</strong>: For resource management.</li>
</ul>
</div><h1><p>Step-by-Step Guide</p>
</h1>
<div class='content'></div><h2><p>Step 1: Setting Up the Environment</p>
</h2>
<div class='content'><ol>
<li><strong>Install Hadoop</strong>: Ensure Hadoop is installed and configured on your system. Refer to Module 1 for setup instructions.</li>
<li><strong>Install Apache Mahout</strong>: Follow the official <a href="https://mahout.apache.org/general/installation.html">Mahout installation guide</a>.</li>
<li><strong>Install Apache Spark</strong>: Follow the official <a href="https://spark.apache.org/docs/latest/">Spark installation guide</a>.</li>
</ol>
</div><h2><p>Step 2: Data Preprocessing</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Load Data into HDFS</strong>:</p>
<ul>
<li>Download a sample dataset (e.g., the Iris dataset).</li>
<li>Upload the dataset to HDFS using the following command:
<pre><code class="language-bash">hdfs dfs -put iris.csv /user/hadoop/iris.csv
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Data Cleaning with Apache Pig</strong>:</p>
<ul>
<li>Write a Pig script to clean the data:
<pre><code class="language-pig">-- Load the data
raw_data = LOAD '/user/hadoop/iris.csv' USING PigStorage(',') 
            AS (sepal_length:float, sepal_width:float, petal_length:float, petal_width:float, class:chararray);

-- Filter out any invalid records
clean_data = FILTER raw_data BY (sepal_length IS NOT NULL AND sepal_width IS NOT NULL 
                                 AND petal_length IS NOT NULL AND petal_width IS NOT NULL);

-- Store the cleaned data
STORE clean_data INTO '/user/hadoop/clean_iris' USING PigStorage(',');
</code></pre>
</li>
<li>Run the Pig script:
<pre><code class="language-bash">pig -x mapreduce clean_data.pig
</code></pre>
</li>
</ul>
</li>
</ol>
</div><h2><p>Step 3: Training a Machine Learning Model</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Using Apache Mahout</strong>:</p>
<ul>
<li>
<p>Convert the cleaned data to Mahout's format:</p>
<pre><code class="language-bash">mahout seqdirectory -i /user/hadoop/clean_iris -o /user/hadoop/seq_iris
mahout seq2sparse -i /user/hadoop/seq_iris -o /user/hadoop/sparse_iris
</code></pre>
</li>
<li>
<p>Train a k-means clustering model:</p>
<pre><code class="language-bash">mahout kmeans -i /user/hadoop/sparse_iris/tfidf-vectors -c /user/hadoop/clusters -o /user/hadoop/kmeans_output -k 3 -ow -cl
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Using Apache Spark</strong>:</p>
<ul>
<li>
<p>Write a Spark script to train a logistic regression model:</p>
<pre><code class="language-python">from pyspark.sql import SparkSession
from pyspark.ml.feature import VectorAssembler
from pyspark.ml.classification import LogisticRegression
from pyspark.ml.evaluation import MulticlassClassificationEvaluator

# Initialize Spark session
spark = SparkSession.builder.appName(&quot;IrisClassification&quot;).getOrCreate()

# Load data
data = spark.read.csv(&quot;/user/hadoop/clean_iris&quot;, header=False, inferSchema=True)
data = data.withColumnRenamed(&quot;_c4&quot;, &quot;label&quot;)

# Assemble features
assembler = VectorAssembler(inputCols=[&quot;_c0&quot;, &quot;_c1&quot;, &quot;_c2&quot;, &quot;_c3&quot;], outputCol=&quot;features&quot;)
data = assembler.transform(data)

# Split data into training and test sets
train_data, test_data = data.randomSplit([0.7, 0.3])

# Train logistic regression model
lr = LogisticRegression(featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;)
model = lr.fit(train_data)

# Make predictions
predictions = model.transform(test_data)

# Evaluate model
evaluator = MulticlassClassificationEvaluator(labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, metricName=&quot;accuracy&quot;)
accuracy = evaluator.evaluate(predictions)
print(f&quot;Test Accuracy: {accuracy}&quot;)

# Stop Spark session
spark.stop()
</code></pre>
</li>
<li>
<p>Run the Spark script:</p>
<pre><code class="language-bash">spark-submit iris_classification.py
</code></pre>
</li>
</ul>
</li>
</ol>
</div><h2><p>Step 4: Model Evaluation</p>
</h2>
<div class='content'><ul>
<li>Evaluate the performance of the trained models using appropriate metrics (e.g., accuracy, precision, recall).</li>
<li>Compare the results of different models and discuss their performance.</li>
</ul>
</div><h2><p>Step 5: Conclusion</p>
</h2>
<div class='content'><ul>
<li>Summarize the steps taken to preprocess data, train machine learning models, and evaluate their performance.</li>
<li>Highlight the benefits of using Hadoop for machine learning tasks, such as scalability and efficiency.</li>
<li>Discuss potential improvements and future work, such as experimenting with different algorithms or tuning hyperparameters.</li>
</ul>
</div><h1><p>Summary</p>
</h1>
<div class='content'><p>In this project, we successfully integrated Hadoop with machine learning frameworks to preprocess data, train models, and evaluate their performance. We used Apache Mahout and Apache Spark to demonstrate different approaches to machine learning with Hadoop. This hands-on experience provided valuable insights into the capabilities and advantages of using Hadoop for large-scale machine learning tasks.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-03-project-3-real-time-data-processing-with-hadoop' title="Project 3: Real-Time Data Processing with Hadoop">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
