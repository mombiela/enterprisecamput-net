<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hadoop in Machine Learning</title>

    <link rel="alternate" href="https://campusempresa.com/mod/hadoop/07-02-hadoop-in-machine-learning" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/hadoop/07-02-hadoop-in-machine-learning" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/hadoop/07-02-hadoop-in-machine-learning" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/hadoop/07-02-hadoop-in-machine-learning" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/hadoop/07-02-hadoop-in-machine-learning" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='07-01-hadoop-in-data-warehousing' title="Hadoop in Data Warehousing">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Hadoop in Machine Learning</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-03-hadoop-in-real-time-data-processing' title="Hadoop in Real-Time Data Processing">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1><p>Introduction</p>
</h1>
<div class='content'><p>Machine learning involves training algorithms to make predictions or decisions based on data. As datasets grow larger, traditional data processing tools struggle to handle the volume, velocity, and variety of data. Hadoop, with its distributed computing capabilities, provides a robust framework for processing large-scale data, making it an ideal platform for machine learning tasks.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Big Data and Machine Learning</strong>:</p>
<ul>
<li><strong>Big Data</strong>: Refers to datasets that are too large or complex for traditional data-processing software.</li>
<li><strong>Machine Learning</strong>: A subset of artificial intelligence that involves training algorithms to learn from and make predictions on data.</li>
</ul>
</li>
<li>
<p><strong>Hadoop's Role in Machine Learning</strong>:</p>
<ul>
<li><strong>Scalability</strong>: Hadoop can scale horizontally by adding more nodes to the cluster.</li>
<li><strong>Distributed Storage</strong>: HDFS allows for the storage of large datasets across multiple nodes.</li>
<li><strong>Parallel Processing</strong>: MapReduce and other Hadoop ecosystem tools enable parallel processing of data.</li>
</ul>
</li>
<li>
<p><strong>Hadoop Ecosystem Tools for Machine Learning</strong>:</p>
<ul>
<li><strong>Apache Mahout</strong>: A library of scalable machine learning algorithms.</li>
<li><strong>Apache Spark</strong>: A fast and general-purpose cluster-computing system with built-in modules for streaming, SQL, machine learning, and graph processing.</li>
<li><strong>H2O.ai</strong>: An open-source platform for machine learning that integrates with Hadoop.</li>
</ul>
</li>
</ol>
</div><h1><p>Practical Example: Using Apache Spark for Machine Learning</p>
</h1>
<div class='content'></div><h2><p>Step 1: Setting Up the Environment</p>
</h2>
<div class='content'><p>Ensure you have Hadoop and Spark installed and configured on your system. You can follow the setup instructions from previous modules.</p>
</div><h2><p>Step 2: Loading Data into HDFS</p>
</h2>
<div class='content'><p>First, we need to load our dataset into HDFS. For this example, we'll use a sample dataset <code>data.csv</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aGRmcyBkZnMgLXB1dCBkYXRhLmNzdiAvdXNlci9oYWRvb3AvZGF0YS8="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>hdfs dfs -put data.csv /user/hadoop/data/</pre></div><div class='content'></div><h2><p>Step 3: Writing a Spark ML Program</p>
</h2>
<div class='content'><p>We'll write a simple Spark program to perform a machine learning task, such as linear regression.</p>
<h4>Code Example: Linear Regression with Spark MLlib</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCmZyb20gcHlzcGFyay5tbC5yZWdyZXNzaW9uIGltcG9ydCBMaW5lYXJSZWdyZXNzaW9uCmZyb20gcHlzcGFyay5tbC5mZWF0dXJlIGltcG9ydCBWZWN0b3JBc3NlbWJsZXIKCiMgSW5pdGlhbGl6ZSBTcGFyayBzZXNzaW9uCnNwYXJrID0gU3BhcmtTZXNzaW9uLmJ1aWxkZXIuYXBwTmFtZSgiTGluZWFyUmVncmVzc2lvbkV4YW1wbGUiKS5nZXRPckNyZWF0ZSgpCgojIExvYWQgZGF0YQpkYXRhID0gc3BhcmsucmVhZC5jc3YoIi91c2VyL2hhZG9vcC9kYXRhL2RhdGEuY3N2IiwgaGVhZGVyPVRydWUsIGluZmVyU2NoZW1hPVRydWUpCgojIFByZXBhcmUgZGF0YSBmb3IgTUwKYXNzZW1ibGVyID0gVmVjdG9yQXNzZW1ibGVyKGlucHV0Q29scz1bImZlYXR1cmUxIiwgImZlYXR1cmUyIl0sIG91dHB1dENvbD0iZmVhdHVyZXMiKQpkYXRhID0gYXNzZW1ibGVyLnRyYW5zZm9ybShkYXRhKQoKIyBTcGxpdCBkYXRhIGludG8gdHJhaW5pbmcgYW5kIHRlc3Qgc2V0cwp0cmFpbl9kYXRhLCB0ZXN0X2RhdGEgPSBkYXRhLnJhbmRvbVNwbGl0KFswLjgsIDAuMl0pCgojIEluaXRpYWxpemUgYW5kIHRyYWluIHRoZSBtb2RlbApsciA9IExpbmVhclJlZ3Jlc3Npb24oZmVhdHVyZXNDb2w9ImZlYXR1cmVzIiwgbGFiZWxDb2w9ImxhYmVsIikKbHJfbW9kZWwgPSBsci5maXQodHJhaW5fZGF0YSkKCiMgTWFrZSBwcmVkaWN0aW9ucwpwcmVkaWN0aW9ucyA9IGxyX21vZGVsLnRyYW5zZm9ybSh0ZXN0X2RhdGEpCgojIFNob3cgcHJlZGljdGlvbnMKcHJlZGljdGlvbnMuc2VsZWN0KCJmZWF0dXJlcyIsICJsYWJlbCIsICJwcmVkaWN0aW9uIikuc2hvdygpCgojIFN0b3AgU3Bhcmsgc2Vzc2lvbgpzcGFyay5zdG9wKCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession
from pyspark.ml.regression import LinearRegression
from pyspark.ml.feature import VectorAssembler

# Initialize Spark session
spark = SparkSession.builder.appName(&quot;LinearRegressionExample&quot;).getOrCreate()

# Load data
data = spark.read.csv(&quot;/user/hadoop/data/data.csv&quot;, header=True, inferSchema=True)

# Prepare data for ML
assembler = VectorAssembler(inputCols=[&quot;feature1&quot;, &quot;feature2&quot;], outputCol=&quot;features&quot;)
data = assembler.transform(data)

# Split data into training and test sets
train_data, test_data = data.randomSplit([0.8, 0.2])

# Initialize and train the model
lr = LinearRegression(featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;)
lr_model = lr.fit(train_data)

# Make predictions
predictions = lr_model.transform(test_data)

# Show predictions
predictions.select(&quot;features&quot;, &quot;label&quot;, &quot;prediction&quot;).show()

# Stop Spark session
spark.stop()</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>SparkSession</strong>: Entry point to programming with Spark.</li>
<li><strong>VectorAssembler</strong>: Combines multiple columns into a single vector column, which is required for MLlib.</li>
<li><strong>LinearRegression</strong>: A linear regression model from Spark MLlib.</li>
<li><strong>fit()</strong>: Trains the model using the training data.</li>
<li><strong>transform()</strong>: Makes predictions on the test data.</li>
</ul>
</div><h2><p>Step 4: Evaluating the Model</p>
</h2>
<div class='content'><p>Evaluate the performance of the model using metrics such as Mean Squared Error (MSE) or R-squared.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmV2YWx1YXRpb24gaW1wb3J0IFJlZ3Jlc3Npb25FdmFsdWF0b3IKCiMgSW5pdGlhbGl6ZSBldmFsdWF0b3IKZXZhbHVhdG9yID0gUmVncmVzc2lvbkV2YWx1YXRvcihwcmVkaWN0aW9uQ29sPSJwcmVkaWN0aW9uIiwgbGFiZWxDb2w9ImxhYmVsIiwgbWV0cmljTmFtZT0icm1zZSIpCgojIENhbGN1bGF0ZSBSTVNFCnJtc2UgPSBldmFsdWF0b3IuZXZhbHVhdGUocHJlZGljdGlvbnMpCnByaW50KGYiUm9vdCBNZWFuIFNxdWFyZWQgRXJyb3IgKFJNU0UpOiB7cm1zZX0iKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.evaluation import RegressionEvaluator

# Initialize evaluator
evaluator = RegressionEvaluator(predictionCol=&quot;prediction&quot;, labelCol=&quot;label&quot;, metricName=&quot;rmse&quot;)

# Calculate RMSE
rmse = evaluator.evaluate(predictions)
print(f&quot;Root Mean Squared Error (RMSE): {rmse}&quot;)</pre></div><div class='content'></div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Implement a Classification Model</p>
</h2>
<div class='content'><ol>
<li><strong>Objective</strong>: Implement a classification model using Spark MLlib to classify data into different categories.</li>
<li><strong>Dataset</strong>: Use a sample dataset <code>classification_data.csv</code> with features and labels.</li>
<li><strong>Steps</strong>:
<ul>
<li>Load the dataset into HDFS.</li>
<li>Write a Spark program to load the data, prepare it for ML, and train a classification model (e.g., Logistic Regression).</li>
<li>Evaluate the model using appropriate metrics (e.g., accuracy, precision, recall).</li>
</ul>
</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCmZyb20gcHlzcGFyay5tbC5jbGFzc2lmaWNhdGlvbiBpbXBvcnQgTG9naXN0aWNSZWdyZXNzaW9uCmZyb20gcHlzcGFyay5tbC5mZWF0dXJlIGltcG9ydCBWZWN0b3JBc3NlbWJsZXIKZnJvbSBweXNwYXJrLm1sLmV2YWx1YXRpb24gaW1wb3J0IE11bHRpY2xhc3NDbGFzc2lmaWNhdGlvbkV2YWx1YXRvcgoKIyBJbml0aWFsaXplIFNwYXJrIHNlc3Npb24Kc3BhcmsgPSBTcGFya1Nlc3Npb24uYnVpbGRlci5hcHBOYW1lKCJDbGFzc2lmaWNhdGlvbkV4YW1wbGUiKS5nZXRPckNyZWF0ZSgpCgojIExvYWQgZGF0YQpkYXRhID0gc3BhcmsucmVhZC5jc3YoIi91c2VyL2hhZG9vcC9kYXRhL2NsYXNzaWZpY2F0aW9uX2RhdGEuY3N2IiwgaGVhZGVyPVRydWUsIGluZmVyU2NoZW1hPVRydWUpCgojIFByZXBhcmUgZGF0YSBmb3IgTUwKYXNzZW1ibGVyID0gVmVjdG9yQXNzZW1ibGVyKGlucHV0Q29scz1bImZlYXR1cmUxIiwgImZlYXR1cmUyIl0sIG91dHB1dENvbD0iZmVhdHVyZXMiKQpkYXRhID0gYXNzZW1ibGVyLnRyYW5zZm9ybShkYXRhKQoKIyBTcGxpdCBkYXRhIGludG8gdHJhaW5pbmcgYW5kIHRlc3Qgc2V0cwp0cmFpbl9kYXRhLCB0ZXN0X2RhdGEgPSBkYXRhLnJhbmRvbVNwbGl0KFswLjgsIDAuMl0pCgojIEluaXRpYWxpemUgYW5kIHRyYWluIHRoZSBtb2RlbApsciA9IExvZ2lzdGljUmVncmVzc2lvbihmZWF0dXJlc0NvbD0iZmVhdHVyZXMiLCBsYWJlbENvbD0ibGFiZWwiKQpscl9tb2RlbCA9IGxyLmZpdCh0cmFpbl9kYXRhKQoKIyBNYWtlIHByZWRpY3Rpb25zCnByZWRpY3Rpb25zID0gbHJfbW9kZWwudHJhbnNmb3JtKHRlc3RfZGF0YSkKCiMgRXZhbHVhdGUgdGhlIG1vZGVsCmV2YWx1YXRvciA9IE11bHRpY2xhc3NDbGFzc2lmaWNhdGlvbkV2YWx1YXRvcihwcmVkaWN0aW9uQ29sPSJwcmVkaWN0aW9uIiwgbGFiZWxDb2w9ImxhYmVsIiwgbWV0cmljTmFtZT0iYWNjdXJhY3kiKQphY2N1cmFjeSA9IGV2YWx1YXRvci5ldmFsdWF0ZShwcmVkaWN0aW9ucykKcHJpbnQoZiJBY2N1cmFjeToge2FjY3VyYWN5fSIpCgojIFN0b3AgU3Bhcmsgc2Vzc2lvbgpzcGFyay5zdG9wKCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession
from pyspark.ml.classification import LogisticRegression
from pyspark.ml.feature import VectorAssembler
from pyspark.ml.evaluation import MulticlassClassificationEvaluator

# Initialize Spark session
spark = SparkSession.builder.appName(&quot;ClassificationExample&quot;).getOrCreate()

# Load data
data = spark.read.csv(&quot;/user/hadoop/data/classification_data.csv&quot;, header=True, inferSchema=True)

# Prepare data for ML
assembler = VectorAssembler(inputCols=[&quot;feature1&quot;, &quot;feature2&quot;], outputCol=&quot;features&quot;)
data = assembler.transform(data)

# Split data into training and test sets
train_data, test_data = data.randomSplit([0.8, 0.2])

# Initialize and train the model
lr = LogisticRegression(featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;)
lr_model = lr.fit(train_data)

# Make predictions
predictions = lr_model.transform(test_data)

# Evaluate the model
evaluator = MulticlassClassificationEvaluator(predictionCol=&quot;prediction&quot;, labelCol=&quot;label&quot;, metricName=&quot;accuracy&quot;)
accuracy = evaluator.evaluate(predictions)
print(f&quot;Accuracy: {accuracy}&quot;)

# Stop Spark session
spark.stop()</pre></div><div class='content'></div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we explored how Hadoop can be leveraged for machine learning tasks. We discussed the role of Hadoop in handling big data for machine learning and provided practical examples using Apache Spark. By integrating Hadoop with machine learning tools, we can efficiently process and analyze large datasets, enabling more accurate and scalable machine learning models.</p>
<p>Next, we will delve into real-time data processing with Hadoop, exploring tools and techniques for handling streaming data.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='07-01-hadoop-in-data-warehousing' title="Hadoop in Data Warehousing">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-03-hadoop-in-real-time-data-processing' title="Hadoop in Real-Time Data Processing">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
