<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    <title>Hadoop Data Serialization</title>

    <link rel="alternate" href="https://campusempresa.com/mod/hadoop/06-04-hadoop-data-serialization" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/hadoop/06-04-hadoop-data-serialization" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/hadoop/06-04-hadoop-data-serialization" hreflang="en" />
    
	<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"> -->
	<link href="/css/bootstrap/bootstrap.css?v=1" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.2b8e6213f8.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "hadoop";
  		var TEMA_NAME = "06-04";
  		var TYPE = "mod";
  		var PATH = "mod/hadoop/06-04-hadoop-data-serialization";
  		var IS_INDEX = false;
  		var DEVELOP = sessionStorage.getItem("DEVELOP") == "true";
  		  		var ALL_PAGES_MOD = ["01-01-what-is-hadoop","01-02-hadoop-ecosystem-overview","01-03-hadoop-vs-traditional-databases","01-04-setting-up-hadoop-environment","02-01-hadoop-core-components","02-02-hdfs","02-03-mapreduce-framework","02-04-yarn","03-01-hdfs-architecture","03-02-hdfs-commands","03-03-data-replication-in-hdfs","03-04-hdfs-fault-tolerance","04-01-introduction-to-mapreduce","04-02-mapreduce-job-workflow","04-03-writing-a-mapreduce-program","04-04-mapreduce-optimization-techniques","05-01-apache-pig","05-02-apache-hive","05-03-apache-hbase","05-04-apache-sqoop","05-05-apache-flume","05-06-apache-oozie","06-01-hadoop-security","06-02-hadoop-cluster-management","06-03-hadoop-performance-tuning","06-04-hadoop-data-serialization","07-01-hadoop-in-data-warehousing","07-02-hadoop-in-machine-learning","07-03-hadoop-in-real-time-data-processing","07-04-case-studies-of-hadoop-implementations","08-01-project-1-analyzing-big-data-with-hadoop","08-02-project-2-building-a-data-pipeline-with-hadoop-ecosystem","08-03-project-3-real-time-data-processing-with-hadoop","08-04-project-4-machine-learning-with-hadoop"];
  		  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<!-- <script type="text/javascript" src="/js/main.js"></script> -->
  	<script type="module" src="/js/app.198aab099d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/hadoop/06-04-hadoop-data-serialization" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/hadoop/06-04-hadoop-data-serialization" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my_modules" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/end_modules" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" style="display:none;" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="hadoop">
		<a  href="#" class="text-secondary d-none" data-read-mod="hadoop" data-read-unit="06-04" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="hadoop" data-unread-unit="06-04" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-03-hadoop-performance-tuning' title="Hadoop Performance Tuning" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-03-hadoop-performance-tuning' title="Hadoop Performance Tuning" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h2 style="text-decoration:underline">Hadoop Data Serialization</h2>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='07-01-hadoop-in-data-warehousing' title="Hadoop in Data Warehousing" class="py-2 px-3 btn btn-primary"
				data-read-mod="hadoop" data-read-unit="06-04">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='07-01-hadoop-in-data-warehousing' title="Hadoop in Data Warehousing" class="py-2 px-3 btn btn-primary" 
				data-read-mod="hadoop" data-read-unit="06-04">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Data serialization is a crucial aspect of Hadoop, enabling efficient storage and transmission of data across the Hadoop ecosystem. In this module, we will explore the concept of data serialization, its importance, and the various serialization frameworks used in Hadoop.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li>
<p><strong>What is Data Serialization?</strong></p>
<ul>
<li>The process of converting data structures or objects into a format that can be easily stored and transmitted.</li>
<li>Deserialization is the reverse process, converting the serialized data back into its original format.</li>
</ul>
</li>
<li>
<p><strong>Importance of Data Serialization in Hadoop</strong></p>
<ul>
<li>Efficient storage: Serialized data takes up less space.</li>
<li>Faster data transfer: Serialized data can be transmitted more quickly over the network.</li>
<li>Interoperability: Serialized data can be easily shared between different systems and programming languages.</li>
</ul>
</li>
<li>
<p><strong>Common Serialization Frameworks in Hadoop</strong></p>
<ul>
<li><strong>Writable</strong>: Hadoop's native serialization format.</li>
<li><strong>Avro</strong>: A serialization framework developed within the Apache Hadoop project.</li>
<li><strong>Protocol Buffers</strong>: A language-neutral, platform-neutral extensible mechanism for serializing structured data.</li>
<li><strong>Thrift</strong>: A software framework for scalable cross-language services development.</li>
</ul>
</li>
</ol>
</div><h1>Writable Serialization</h1>
<div class='content'></div><h2>Overview</h2>
<div class='content'><p>Writable is Hadoop's native serialization format, designed for high performance and efficiency. It is used extensively within Hadoop for data storage and transmission.</p>
</div><h2>Example</h2>
<div class='content'><p>Let's look at a simple example of how to use Writable in Hadoop.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuaGFkb29wLmlvLkludFdyaXRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5oYWRvb3AuaW8uVGV4dDsKaW1wb3J0IG9yZy5hcGFjaGUuaGFkb29wLmlvLldyaXRhYmxlOwoKaW1wb3J0IGphdmEuaW8uRGF0YUlucHV0OwppbXBvcnQgamF2YS5pby5EYXRhT3V0cHV0OwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKCnB1YmxpYyBjbGFzcyBDdXN0b21Xcml0YWJsZSBpbXBsZW1lbnRzIFdyaXRhYmxlIHsKICAgIHByaXZhdGUgSW50V3JpdGFibGUgaWQ7CiAgICBwcml2YXRlIFRleHQgbmFtZTsKCiAgICBwdWJsaWMgQ3VzdG9tV3JpdGFibGUoKSB7CiAgICAgICAgdGhpcy5pZCA9IG5ldyBJbnRXcml0YWJsZSgpOwogICAgICAgIHRoaXMubmFtZSA9IG5ldyBUZXh0KCk7CiAgICB9CgogICAgcHVibGljIEN1c3RvbVdyaXRhYmxlKGludCBpZCwgU3RyaW5nIG5hbWUpIHsKICAgICAgICB0aGlzLmlkID0gbmV3IEludFdyaXRhYmxlKGlkKTsKICAgICAgICB0aGlzLm5hbWUgPSBuZXcgVGV4dChuYW1lKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHdyaXRlKERhdGFPdXRwdXQgb3V0KSB0aHJvd3MgSU9FeGNlcHRpb24gewogICAgICAgIGlkLndyaXRlKG91dCk7CiAgICAgICAgbmFtZS53cml0ZShvdXQpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgcmVhZEZpZWxkcyhEYXRhSW5wdXQgaW4pIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgaWQucmVhZEZpZWxkcyhpbik7CiAgICAgICAgbmFtZS5yZWFkRmllbGRzKGluKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyBTdHJpbmcgdG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuIGlkICsgIlx0IiArIG5hbWU7CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.io.Writable;

import java.io.DataInput;
import java.io.DataOutput;
import java.io.IOException;

public class CustomWritable implements Writable {
    private IntWritable id;
    private Text name;

    public CustomWritable() {
        this.id = new IntWritable();
        this.name = new Text();
    }

    public CustomWritable(int id, String name) {
        this.id = new IntWritable(id);
        this.name = new Text(name);
    }

    @Override
    public void write(DataOutput out) throws IOException {
        id.write(out);
        name.write(out);
    }

    @Override
    public void readFields(DataInput in) throws IOException {
        id.readFields(in);
        name.readFields(in);
    }

    @Override
    public String toString() {
        return id + &quot;\t&quot; + name;
    }
}</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>IntWritable</strong> and <strong>Text</strong> are Hadoop's built-in Writable implementations for integers and strings, respectively.</li>
<li>The <code>write</code> method serializes the data to a <code>DataOutput</code> stream.</li>
<li>The <code>readFields</code> method deserializes the data from a <code>DataInput</code> stream.</li>
<li>The <code>toString</code> method provides a human-readable representation of the data.</li>
</ul>
</div><h1>Avro Serialization</h1>
<div class='content'></div><h2>Overview</h2>
<div class='content'><p>Avro is a serialization framework developed within the Apache Hadoop project. It provides rich data structures, a compact and fast binary data format, and a container file to store persistent data.</p>
</div><h2>Example</h2>
<div class='content'><p>Let's look at a simple example of how to use Avro in Hadoop.</p>
<ol>
<li><strong>Define the Schema</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJ0eXBlIjogInJlY29yZCIsCiAgIm5hbWUiOiAiVXNlciIsCiAgImZpZWxkcyI6IFsKICAgIHsibmFtZSI6ICJpZCIsICJ0eXBlIjogImludCJ9LAogICAgeyJuYW1lIjogIm5hbWUiLCAidHlwZSI6ICJzdHJpbmcifQogIF0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;type&quot;: &quot;record&quot;,
  &quot;name&quot;: &quot;User&quot;,
  &quot;fields&quot;: [
    {&quot;name&quot;: &quot;id&quot;, &quot;type&quot;: &quot;int&quot;},
    {&quot;name&quot;: &quot;name&quot;, &quot;type&quot;: &quot;string&quot;}
  ]
}</pre></div><div class='content'><ol start="2">
<li><strong>Generate Java Classes</strong></li>
</ol>
<p>Use the Avro tools to generate Java classes from the schema.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("amF2YSAtamFyIGF2cm8tdG9vbHMtMS44LjIuamFyIGNvbXBpbGUgc2NoZW1hIHVzZXIuYXZzYyAu"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>java -jar avro-tools-1.8.2.jar compile schema user.avsc .</pre></div><div class='content'><ol start="3">
<li><strong>Serialize and Deserialize Data</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuYXZyby5TY2hlbWE7CmltcG9ydCBvcmcuYXBhY2hlLmF2cm8uZmlsZS5EYXRhRmlsZVJlYWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYXZyby5maWxlLkRhdGFGaWxlV3JpdGVyOwppbXBvcnQgb3JnLmFwYWNoZS5hdnJvLmdlbmVyaWMuR2VuZXJpY0RhdGE7CmltcG9ydCBvcmcuYXBhY2hlLmF2cm8uZ2VuZXJpYy5HZW5lcmljRGF0dW1SZWFkZXI7CmltcG9ydCBvcmcuYXBhY2hlLmF2cm8uZ2VuZXJpYy5HZW5lcmljRGF0dW1Xcml0ZXI7CmltcG9ydCBvcmcuYXBhY2hlLmF2cm8uZ2VuZXJpYy5HZW5lcmljUmVjb3JkOwoKaW1wb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CgpwdWJsaWMgY2xhc3MgQXZyb0V4YW1wbGUgewogICAgcHVibGljIHN0YXRpYyB2b2lkIG1haW4oU3RyaW5nW10gYXJncykgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICBTY2hlbWEgc2NoZW1hID0gbmV3IFNjaGVtYS5QYXJzZXIoKS5wYXJzZShuZXcgRmlsZSgidXNlci5hdnNjIikpOwoKICAgICAgICAvLyBDcmVhdGUgYSByZWNvcmQKICAgICAgICBHZW5lcmljUmVjb3JkIHVzZXIxID0gbmV3IEdlbmVyaWNEYXRhLlJlY29yZChzY2hlbWEpOwogICAgICAgIHVzZXIxLnB1dCgiaWQiLCAxKTsKICAgICAgICB1c2VyMS5wdXQoIm5hbWUiLCAiSm9obiBEb2UiKTsKCiAgICAgICAgLy8gU2VyaWFsaXplIHRoZSByZWNvcmQgdG8gYSBmaWxlCiAgICAgICAgRmlsZSBmaWxlID0gbmV3IEZpbGUoInVzZXJzLmF2cm8iKTsKICAgICAgICBEYXR1bVdyaXRlcjxHZW5lcmljUmVjb3JkPiBkYXR1bVdyaXRlciA9IG5ldyBHZW5lcmljRGF0dW1Xcml0ZXI8PihzY2hlbWEpOwogICAgICAgIERhdGFGaWxlV3JpdGVyPEdlbmVyaWNSZWNvcmQ+IGRhdGFGaWxlV3JpdGVyID0gbmV3IERhdGFGaWxlV3JpdGVyPD4oZGF0dW1Xcml0ZXIpOwogICAgICAgIGRhdGFGaWxlV3JpdGVyLmNyZWF0ZShzY2hlbWEsIGZpbGUpOwogICAgICAgIGRhdGFGaWxlV3JpdGVyLmFwcGVuZCh1c2VyMSk7CiAgICAgICAgZGF0YUZpbGVXcml0ZXIuY2xvc2UoKTsKCiAgICAgICAgLy8gRGVzZXJpYWxpemUgdGhlIHJlY29yZCBmcm9tIHRoZSBmaWxlCiAgICAgICAgRGF0dW1SZWFkZXI8R2VuZXJpY1JlY29yZD4gZGF0dW1SZWFkZXIgPSBuZXcgR2VuZXJpY0RhdHVtUmVhZGVyPD4oc2NoZW1hKTsKICAgICAgICBEYXRhRmlsZVJlYWRlcjxHZW5lcmljUmVjb3JkPiBkYXRhRmlsZVJlYWRlciA9IG5ldyBEYXRhRmlsZVJlYWRlcjw+KGZpbGUsIGRhdHVtUmVhZGVyKTsKICAgICAgICB3aGlsZSAoZGF0YUZpbGVSZWFkZXIuaGFzTmV4dCgpKSB7CiAgICAgICAgICAgIEdlbmVyaWNSZWNvcmQgdXNlciA9IGRhdGFGaWxlUmVhZGVyLm5leHQoKTsKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKHVzZXIpOwogICAgICAgIH0KICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.avro.Schema;
import org.apache.avro.file.DataFileReader;
import org.apache.avro.file.DataFileWriter;
import org.apache.avro.generic.GenericData;
import org.apache.avro.generic.GenericDatumReader;
import org.apache.avro.generic.GenericDatumWriter;
import org.apache.avro.generic.GenericRecord;

import java.io.File;
import java.io.IOException;

public class AvroExample {
    public static void main(String[] args) throws IOException {
        Schema schema = new Schema.Parser().parse(new File(&quot;user.avsc&quot;));

        // Create a record
        GenericRecord user1 = new GenericData.Record(schema);
        user1.put(&quot;id&quot;, 1);
        user1.put(&quot;name&quot;, &quot;John Doe&quot;);

        // Serialize the record to a file
        File file = new File(&quot;users.avro&quot;);
        DatumWriter&lt;GenericRecord&gt; datumWriter = new GenericDatumWriter&lt;&gt;(schema);
        DataFileWriter&lt;GenericRecord&gt; dataFileWriter = new DataFileWriter&lt;&gt;(datumWriter);
        dataFileWriter.create(schema, file);
        dataFileWriter.append(user1);
        dataFileWriter.close();

        // Deserialize the record from the file
        DatumReader&lt;GenericRecord&gt; datumReader = new GenericDatumReader&lt;&gt;(schema);
        DataFileReader&lt;GenericRecord&gt; dataFileReader = new DataFileReader&lt;&gt;(file, datumReader);
        while (dataFileReader.hasNext()) {
            GenericRecord user = dataFileReader.next();
            System.out.println(user);
        }
    }
}</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Schema</strong>: Defines the structure of the data.</li>
<li><strong>GenericRecord</strong>: Represents a record conforming to the schema.</li>
<li><strong>DatumWriter</strong> and <strong>DataFileWriter</strong>: Used to serialize the data to a file.</li>
<li><strong>DatumReader</strong> and <strong>DataFileReader</strong>: Used to deserialize the data from a file.</li>
</ul>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise</h2>
<div class='content'><ol>
<li>
<p>Create a custom Writable class to serialize and deserialize a record with the following fields:</p>
<ul>
<li><code>int age</code></li>
<li><code>String address</code></li>
</ul>
</li>
<li>
<p>Write a Java program to serialize and deserialize a record using Avro with the following schema:</p>
<ul>
<li><code>int productId</code></li>
<li><code>String productName</code></li>
<li><code>double price</code></li>
</ul>
</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><ol>
<li><strong>Custom Writable Class</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuaGFkb29wLmlvLkludFdyaXRhYmxlOwppbXBvcnQgb3JnLmFwYWNoZS5oYWRvb3AuaW8uVGV4dDsKaW1wb3J0IG9yZy5hcGFjaGUuaGFkb29wLmlvLldyaXRhYmxlOwoKaW1wb3J0IGphdmEuaW8uRGF0YUlucHV0OwppbXBvcnQgamF2YS5pby5EYXRhT3V0cHV0OwppbXBvcnQgamF2YS5pby5JT0V4Y2VwdGlvbjsKCnB1YmxpYyBjbGFzcyBDdXN0b21Xcml0YWJsZSBpbXBsZW1lbnRzIFdyaXRhYmxlIHsKICAgIHByaXZhdGUgSW50V3JpdGFibGUgYWdlOwogICAgcHJpdmF0ZSBUZXh0IGFkZHJlc3M7CgogICAgcHVibGljIEN1c3RvbVdyaXRhYmxlKCkgewogICAgICAgIHRoaXMuYWdlID0gbmV3IEludFdyaXRhYmxlKCk7CiAgICAgICAgdGhpcy5hZGRyZXNzID0gbmV3IFRleHQoKTsKICAgIH0KCiAgICBwdWJsaWMgQ3VzdG9tV3JpdGFibGUoaW50IGFnZSwgU3RyaW5nIGFkZHJlc3MpIHsKICAgICAgICB0aGlzLmFnZSA9IG5ldyBJbnRXcml0YWJsZShhZ2UpOwogICAgICAgIHRoaXMuYWRkcmVzcyA9IG5ldyBUZXh0KGFkZHJlc3MpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgd3JpdGUoRGF0YU91dHB1dCBvdXQpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgYWdlLndyaXRlKG91dCk7CiAgICAgICAgYWRkcmVzcy53cml0ZShvdXQpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgcmVhZEZpZWxkcyhEYXRhSW5wdXQgaW4pIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgYWdlLnJlYWRGaWVsZHMoaW4pOwogICAgICAgIGFkZHJlc3MucmVhZEZpZWxkcyhpbik7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgU3RyaW5nIHRvU3RyaW5nKCkgewogICAgICAgIHJldHVybiBhZ2UgKyAiXHQiICsgYWRkcmVzczsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.io.Writable;

import java.io.DataInput;
import java.io.DataOutput;
import java.io.IOException;

public class CustomWritable implements Writable {
    private IntWritable age;
    private Text address;

    public CustomWritable() {
        this.age = new IntWritable();
        this.address = new Text();
    }

    public CustomWritable(int age, String address) {
        this.age = new IntWritable(age);
        this.address = new Text(address);
    }

    @Override
    public void write(DataOutput out) throws IOException {
        age.write(out);
        address.write(out);
    }

    @Override
    public void readFields(DataInput in) throws IOException {
        age.readFields(in);
        address.readFields(in);
    }

    @Override
    public String toString() {
        return age + &quot;\t&quot; + address;
    }
}</pre></div><div class='content'><ol start="2">
<li><strong>Avro Serialization and Deserialization</strong></li>
</ol>
<p><strong>Schema (product.avsc)</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJ0eXBlIjogInJlY29yZCIsCiAgIm5hbWUiOiAiUHJvZHVjdCIsCiAgImZpZWxkcyI6IFsKICAgIHsibmFtZSI6ICJwcm9kdWN0SWQiLCAidHlwZSI6ICJpbnQifSwKICAgIHsibmFtZSI6ICJwcm9kdWN0TmFtZSIsICJ0eXBlIjogInN0cmluZyJ9LAogICAgeyJuYW1lIjogInByaWNlIiwgInR5cGUiOiAiZG91YmxlIn0KICBdCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;type&quot;: &quot;record&quot;,
  &quot;name&quot;: &quot;Product&quot;,
  &quot;fields&quot;: [
    {&quot;name&quot;: &quot;productId&quot;, &quot;type&quot;: &quot;int&quot;},
    {&quot;name&quot;: &quot;productName&quot;, &quot;type&quot;: &quot;string&quot;},
    {&quot;name&quot;: &quot;price&quot;, &quot;type&quot;: &quot;double&quot;}
  ]
}</pre></div><div class='content'><p><strong>Java Program</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuYXZyby5TY2hlbWE7CmltcG9ydCBvcmcuYXBhY2hlLmF2cm8uZmlsZS5EYXRhRmlsZVJlYWRlcjsKaW1wb3J0IG9yZy5hcGFjaGUuYXZyby5maWxlLkRhdGFGaWxlV3JpdGVyOwppbXBvcnQgb3JnLmFwYWNoZS5hdnJvLmdlbmVyaWMuR2VuZXJpY0RhdGE7CmltcG9ydCBvcmcuYXBhY2hlLmF2cm8uZ2VuZXJpYy5HZW5lcmljRGF0dW1SZWFkZXI7CmltcG9ydCBvcmcuYXBhY2hlLmF2cm8uZ2VuZXJpYy5HZW5lcmljRGF0dW1Xcml0ZXI7CmltcG9ydCBvcmcuYXBhY2hlLmF2cm8uZ2VuZXJpYy5HZW5lcmljUmVjb3JkOwoKaW1wb3J0IGphdmEuaW8uRmlsZTsKaW1wb3J0IGphdmEuaW8uSU9FeGNlcHRpb247CgpwdWJsaWMgY2xhc3MgQXZyb1Byb2R1Y3RFeGFtcGxlIHsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHRocm93cyBJT0V4Y2VwdGlvbiB7CiAgICAgICAgU2NoZW1hIHNjaGVtYSA9IG5ldyBTY2hlbWEuUGFyc2VyKCkucGFyc2UobmV3IEZpbGUoInByb2R1Y3QuYXZzYyIpKTsKCiAgICAgICAgLy8gQ3JlYXRlIGEgcmVjb3JkCiAgICAgICAgR2VuZXJpY1JlY29yZCBwcm9kdWN0MSA9IG5ldyBHZW5lcmljRGF0YS5SZWNvcmQoc2NoZW1hKTsKICAgICAgICBwcm9kdWN0MS5wdXQoInByb2R1Y3RJZCIsIDEwMSk7CiAgICAgICAgcHJvZHVjdDEucHV0KCJwcm9kdWN0TmFtZSIsICJMYXB0b3AiKTsKICAgICAgICBwcm9kdWN0MS5wdXQoInByaWNlIiwgNzk5Ljk5KTsKCiAgICAgICAgLy8gU2VyaWFsaXplIHRoZSByZWNvcmQgdG8gYSBmaWxlCiAgICAgICAgRmlsZSBmaWxlID0gbmV3IEZpbGUoInByb2R1Y3RzLmF2cm8iKTsKICAgICAgICBEYXR1bVdyaXRlcjxHZW5lcmljUmVjb3JkPiBkYXR1bVdyaXRlciA9IG5ldyBHZW5lcmljRGF0dW1Xcml0ZXI8PihzY2hlbWEpOwogICAgICAgIERhdGFGaWxlV3JpdGVyPEdlbmVyaWNSZWNvcmQ+IGRhdGFGaWxlV3JpdGVyID0gbmV3IERhdGFGaWxlV3JpdGVyPD4oZGF0dW1Xcml0ZXIpOwogICAgICAgIGRhdGFGaWxlV3JpdGVyLmNyZWF0ZShzY2hlbWEsIGZpbGUpOwogICAgICAgIGRhdGFGaWxlV3JpdGVyLmFwcGVuZChwcm9kdWN0MSk7CiAgICAgICAgZGF0YUZpbGVXcml0ZXIuY2xvc2UoKTsKCiAgICAgICAgLy8gRGVzZXJpYWxpemUgdGhlIHJlY29yZCBmcm9tIHRoZSBmaWxlCiAgICAgICAgRGF0dW1SZWFkZXI8R2VuZXJpY1JlY29yZD4gZGF0dW1SZWFkZXIgPSBuZXcgR2VuZXJpY0RhdHVtUmVhZGVyPD4oc2NoZW1hKTsKICAgICAgICBEYXRhRmlsZVJlYWRlcjxHZW5lcmljUmVjb3JkPiBkYXRhRmlsZVJlYWRlciA9IG5ldyBEYXRhRmlsZVJlYWRlcjw+KGZpbGUsIGRhdHVtUmVhZGVyKTsKICAgICAgICB3aGlsZSAoZGF0YUZpbGVSZWFkZXIuaGFzTmV4dCgpKSB7CiAgICAgICAgICAgIEdlbmVyaWNSZWNvcmQgcHJvZHVjdCA9IGRhdGFGaWxlUmVhZGVyLm5leHQoKTsKICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKHByb2R1Y3QpOwogICAgICAgIH0KICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.avro.Schema;
import org.apache.avro.file.DataFileReader;
import org.apache.avro.file.DataFileWriter;
import org.apache.avro.generic.GenericData;
import org.apache.avro.generic.GenericDatumReader;
import org.apache.avro.generic.GenericDatumWriter;
import org.apache.avro.generic.GenericRecord;

import java.io.File;
import java.io.IOException;

public class AvroProductExample {
    public static void main(String[] args) throws IOException {
        Schema schema = new Schema.Parser().parse(new File(&quot;product.avsc&quot;));

        // Create a record
        GenericRecord product1 = new GenericData.Record(schema);
        product1.put(&quot;productId&quot;, 101);
        product1.put(&quot;productName&quot;, &quot;Laptop&quot;);
        product1.put(&quot;price&quot;, 799.99);

        // Serialize the record to a file
        File file = new File(&quot;products.avro&quot;);
        DatumWriter&lt;GenericRecord&gt; datumWriter = new GenericDatumWriter&lt;&gt;(schema);
        DataFileWriter&lt;GenericRecord&gt; dataFileWriter = new DataFileWriter&lt;&gt;(datumWriter);
        dataFileWriter.create(schema, file);
        dataFileWriter.append(product1);
        dataFileWriter.close();

        // Deserialize the record from the file
        DatumReader&lt;GenericRecord&gt; datumReader = new GenericDatumReader&lt;&gt;(schema);
        DataFileReader&lt;GenericRecord&gt; dataFileReader = new DataFileReader&lt;&gt;(file, datumReader);
        while (dataFileReader.hasNext()) {
            GenericRecord product = dataFileReader.next();
            System.out.println(product);
        }
    }
}</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this module, we explored the concept of data serialization in Hadoop, its importance, and the various serialization frameworks used in Hadoop. We delved into Hadoop's native Writable serialization and the Avro serialization framework, providing practical examples and exercises to reinforce the concepts. Understanding data serialization is crucial for efficient data storage and transmission in Hadoop, enabling seamless interoperability and performance optimization.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='06-03-hadoop-performance-tuning' title="Hadoop Performance Tuning" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='06-03-hadoop-performance-tuning' title="Hadoop Performance Tuning" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='07-01-hadoop-in-data-warehousing' title="Hadoop in Data Warehousing" class="py-2 px-3 btn btn-primary"
				data-read-mod="hadoop" data-read-unit="06-04">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='07-01-hadoop-in-data-warehousing' title="Hadoop in Data Warehousing" class="py-2 px-3 btn btn-primary" 
				data-read-mod="hadoop" data-read-unit="06-04">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>Hadoop Course</h1>
<h2>Module 1: Introduction to Hadoop</h2>
<ul>
<li><a href="01-01-what-is-hadoop">What is Hadoop?</a></li>
<li><a href="01-02-hadoop-ecosystem-overview">Hadoop Ecosystem Overview</a></li>
<li><a href="01-03-hadoop-vs-traditional-databases">Hadoop vs Traditional Databases</a></li>
<li><a href="01-04-setting-up-hadoop-environment">Setting Up Hadoop Environment</a></li>
</ul>
<h2>Module 2: Hadoop Architecture</h2>
<ul>
<li><a href="02-01-hadoop-core-components">Hadoop Core Components</a></li>
<li><a href="02-02-hdfs">HDFS (Hadoop Distributed File System)</a></li>
<li><a href="02-03-mapreduce-framework">MapReduce Framework</a></li>
<li><a href="02-04-yarn">YARN (Yet Another Resource Negotiator)</a></li>
</ul>
<h2>Module 3: HDFS (Hadoop Distributed File System)</h2>
<ul>
<li><a href="03-01-hdfs-architecture">HDFS Architecture</a></li>
<li><a href="03-02-hdfs-commands">HDFS Commands</a></li>
<li><a href="03-03-data-replication-in-hdfs">Data Replication in HDFS</a></li>
<li><a href="03-04-hdfs-fault-tolerance">HDFS Fault Tolerance</a></li>
</ul>
<h2>Module 4: MapReduce Programming</h2>
<ul>
<li><a href="04-01-introduction-to-mapreduce">Introduction to MapReduce</a></li>
<li><a href="04-02-mapreduce-job-workflow">MapReduce Job Workflow</a></li>
<li><a href="04-03-writing-a-mapreduce-program">Writing a MapReduce Program</a></li>
<li><a href="04-04-mapreduce-optimization-techniques">MapReduce Optimization Techniques</a></li>
</ul>
<h2>Module 5: Hadoop Ecosystem Tools</h2>
<ul>
<li><a href="05-01-apache-pig">Apache Pig</a></li>
<li><a href="05-02-apache-hive">Apache Hive</a></li>
<li><a href="05-03-apache-hbase">Apache HBase</a></li>
<li><a href="05-04-apache-sqoop">Apache Sqoop</a></li>
<li><a href="05-05-apache-flume">Apache Flume</a></li>
<li><a href="05-06-apache-oozie">Apache Oozie</a></li>
</ul>
<h2>Module 6: Advanced Hadoop Concepts</h2>
<ul>
<li><a href="06-01-hadoop-security">Hadoop Security</a></li>
<li><a href="06-02-hadoop-cluster-management">Hadoop Cluster Management</a></li>
<li><a href="06-03-hadoop-performance-tuning">Hadoop Performance Tuning</a></li>
<li><a href="06-04-hadoop-data-serialization">Hadoop Data Serialization</a></li>
</ul>
<h2>Module 7: Real-World Applications and Case Studies</h2>
<ul>
<li><a href="07-01-hadoop-in-data-warehousing">Hadoop in Data Warehousing</a></li>
<li><a href="07-02-hadoop-in-machine-learning">Hadoop in Machine Learning</a></li>
<li><a href="07-03-hadoop-in-real-time-data-processing">Hadoop in Real-Time Data Processing</a></li>
<li><a href="07-04-case-studies-of-hadoop-implementations">Case Studies of Hadoop Implementations</a></li>
</ul>
<h2>Module 8: Hands-On Projects</h2>
<ul>
<li><a href="08-01-project-1-analyzing-big-data-with-hadoop">Project 1: Analyzing Big Data with Hadoop</a></li>
<li><a href="08-02-project-2-building-a-data-pipeline-with-hadoop-ecosystem">Project 2: Building a Data Pipeline with Hadoop Ecosystem</a></li>
<li><a href="08-03-project-3-real-time-data-processing-with-hadoop">Project 3: Real-Time Data Processing with Hadoop</a></li>
<li><a href="08-04-project-4-machine-learning-with-hadoop">Project 4: Machine Learning with Hadoop</a></li>
</ul>

	</div>










			<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<p id="loginModalEmail"></p>
            	<div id="mensaje" class="d-none alert alert-danger"></div>
            	<div id="mensaje_info" class="d-none alert alert-success"></div>
            	
            	<div id="modal-body-main">
					<div class="mt-4 d-none" id="forgotPasswordSection">
						<div class="mb-3">
    <label for="recovery-email" class="form-label">Email</label>
    <input type="email" required class="form-control" id="recovery-email" placeholder="Enter your email">
</div>
<button class="btn btn-primary" id="btnRecover">Send recovery link</button>

					</div>
									
					<div class="mt-4 d-none" id="deleteUserSection">	
						<div class="mb-3 alert alert-danger">
	Warning! You are about to delete all registration and progress data.<br><b>This action cannot be undone.</b>
</div>
<div class="mb-3">
    <input type="password" required class="form-control" id="delete-user-pwd" placeholder="Enter your password">
</div>
<button class="btn btn-primary" id="btnDeleteUser">Delete user</button>

					</div>
					
					<div class="mt-4 d-none" id="changePassordSection">
						<div class="mb-3 row">
	<div class="col col-12 my-2">
	    <input type="password" required class="form-control" id="change-pwd-actual" placeholder="Enter current password">
	</div>
	<div class="col col-12 my-2">
    	<input type="password" required class="form-control" id="change-pwd-new-1" placeholder="Enter new password">
	</div>
	<div class="col col-12 my-2">
    	<input type="password" required class="form-control" id="change-pwd-new-2" placeholder="Repeat new password">
	</div>
</div>
<button class="btn btn-primary" id="btnChangePassword">Change password</button>

					</div>
					
					<div class="mt-4 d-none alert alert-warning" id="verifyPasswordSection">
						<p><b>Falta verificar correu</b></p>
						<a id="btnVerifyEmail" href="#">Send verification link</a>

					</div>
					
					<div class="mt-4 d-none" id="disconnectUserSection">
						<div class="mb-3">
    <button id="btnDisconnect" class="btn btn-primary">Disconnect</button>
</div>

<hr>

<div class="mt-3">
    <button class="btn btn-outline-secondary" id="change-password-link">Change password</button>
</div>

<div class="mt-3">
    <a href="#" id="delete-user-link">Delete user</a>
</div>

					</div>
	            
	            	<div class="mt-4 d-none" id="modalTabsSection">
	            		<ul class="nav nav-tabs" id="authTabs" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="login-tab" data-bs-toggle="tab" data-bs-target="#login" type="button" role="tab" aria-controls="login" aria-selected="true">
        	Log in
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="register-tab" data-bs-toggle="tab" data-bs-target="#register" type="button" role="tab" aria-controls="register" aria-selected="false">
        	Sign up
        </button>
    </li>
</ul>

<div class="tab-content mt-3" id="authTabsContent">
    <div class="tab-pane fade show active" id="login" role="tabpanel" aria-labelledby="login-tab">
    	<div class="mb-3">
    <label for="login-username" class="form-label">Email</label>
    <input type="email" required class="form-control" id="login-username" placeholder="Enter your email">
</div>
<div class="mb-3">
    <label for="login-password" class="form-label">Password</label>
    <input type="password"  required class="form-control" id="login-password" placeholder="Enter your password">
</div>
<button class="btn btn-primary" id="btnLogin">Log in</button>
<div class="mt-3">
    <a href="#" id="forgot-password-link">Have you forgotten your password?</a>
</div>
    </div>

    <div class="tab-pane fade" id="register" role="tabpanel" aria-labelledby="register-tab">
    	<div class="mb-3">
    <label for="register-email" class="form-label">Email</label>
    <input type="email" class="form-control" id="register-email" required placeholder="Enter your email">
</div>

<div class="mb-3">
    <label for="register-password" class="form-label">Password</label>
    <input type="password" class="form-control"  required id="register-password" placeholder="Enter your password">
</div>

<div class="mb-3">
    <label for="register-name" class="form-label">Name</label>
    <input type="text" class="form-control"  required id="register-name" placeholder="Enter your name">
</div>

<div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" id="accept-conditions-reg">
    <label for="accept-conditions-reg" class="form-check-label">
        I have read and accept the <a href="/privacity" target="blank">Privacy Policy</a> and the <a href="/licence" target="blank">Terms and Conditions of Use</a>.
    </label>
</div>

<div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" id="accept-allow_comunications">
    <label for="accept-allow_comunications" class="form-check-label">
        I wish to receive news and updates about courses (optional).
    </label>
</div>

<button id="btnRegister" class="btn btn-primary">Sign up</button>
    </div>
</div>
	            	</div>
            	</div>
            </div>
        </div>
    </div>
</div>

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
