<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MapReduce Framework</title>

    <link rel="alternate" href="https://campusempresa.com/mod/hadoop/mapreduce-framework" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/hadoop/mapreduce-framework" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/hadoop/mapreduce-framework" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/hadoop/mapreduce-framework" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/hadoop/mapreduce-framework" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='hdfs'>&#x25C4;HDFS (Hadoop Distributed File System)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">MapReduce Framework</a>
	</div>
	<div class='col-4 text-end'>
					<a href='yarn'>YARN (Yet Another Resource Negotiator) &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to MapReduce</h1>
<div class='content'><p>MapReduce is a programming model and an associated implementation for processing and generating large data sets with a parallel, distributed algorithm on a cluster. It was originally developed by Google and is now widely used in various big data processing frameworks, including Hadoop.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Map Function</strong>: Processes input key/value pairs to generate a set of intermediate key/value pairs.</li>
<li><strong>Reduce Function</strong>: Merges all intermediate values associated with the same intermediate key.</li>
<li><strong>Job</strong>: A complete MapReduce computation, consisting of a map phase, a shuffle and sort phase, and a reduce phase.</li>
<li><strong>Task</strong>: An individual unit of work; a job is divided into multiple tasks.</li>
</ul>
</div><h1>How MapReduce Works</h1>
<div class='content'><p>The MapReduce framework operates in three main stages: Map, Shuffle and Sort, and Reduce.</p>
</div><h2>Map Stage</h2>
<div class='content'><p>The input data is split into independent chunks, which are processed by the map tasks in a completely parallel manner. The framework sorts the outputs of the maps, which are then input to the reduce tasks.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIFRva2VuaXplck1hcHBlciBleHRlbmRzIE1hcHBlcjxPYmplY3QsIFRleHQsIFRleHQsIEludFdyaXRhYmxlPiB7CiAgICBwcml2YXRlIGZpbmFsIHN0YXRpYyBJbnRXcml0YWJsZSBvbmUgPSBuZXcgSW50V3JpdGFibGUoMSk7CiAgICBwcml2YXRlIFRleHQgd29yZCA9IG5ldyBUZXh0KCk7CgogICAgcHVibGljIHZvaWQgbWFwKE9iamVjdCBrZXksIFRleHQgdmFsdWUsIENvbnRleHQgY29udGV4dCkgdGhyb3dzIElPRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5nVG9rZW5pemVyIGl0ciA9IG5ldyBTdHJpbmdUb2tlbml6ZXIodmFsdWUudG9TdHJpbmcoKSk7CiAgICAgICAgd2hpbGUgKGl0ci5oYXNNb3JlVG9rZW5zKCkpIHsKICAgICAgICAgICAgd29yZC5zZXQoaXRyLm5leHRUb2tlbigpKTsKICAgICAgICAgICAgY29udGV4dC53cml0ZSh3b3JkLCBvbmUpOwogICAgICAgIH0KICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class TokenizerMapper extends Mapper&lt;Object, Text, Text, IntWritable&gt; {
    private final static IntWritable one = new IntWritable(1);
    private Text word = new Text();

    public void map(Object key, Text value, Context context) throws IOException, InterruptedException {
        StringTokenizer itr = new StringTokenizer(value.toString());
        while (itr.hasMoreTokens()) {
            word.set(itr.nextToken());
            context.write(word, one);
        }
    }
}</pre></div><div class='content'><p><em>Explanation</em>: This example shows a simple Mapper class that tokenizes text input and emits each word with a count of one.</p>
</div><h2>Shuffle and Sort Stage</h2>
<div class='content'><p>This stage is handled by the Hadoop framework. It sorts the map outputs and transfers them to the reducers.</p>
</div><h2>Reduce Stage</h2>
<div class='content'><p>The reduce tasks take the intermediate key/value pairs produced by the map tasks and process them to produce the final output.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIEludFN1bVJlZHVjZXIgZXh0ZW5kcyBSZWR1Y2VyPFRleHQsIEludFdyaXRhYmxlLCBUZXh0LCBJbnRXcml0YWJsZT4gewogICAgcHJpdmF0ZSBJbnRXcml0YWJsZSByZXN1bHQgPSBuZXcgSW50V3JpdGFibGUoKTsKCiAgICBwdWJsaWMgdm9pZCByZWR1Y2UoVGV4dCBrZXksIEl0ZXJhYmxlPEludFdyaXRhYmxlPiB2YWx1ZXMsIENvbnRleHQgY29udGV4dCkgdGhyb3dzIElPRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgaW50IHN1bSA9IDA7CiAgICAgICAgZm9yIChJbnRXcml0YWJsZSB2YWwgOiB2YWx1ZXMpIHsKICAgICAgICAgICAgc3VtICs9IHZhbC5nZXQoKTsKICAgICAgICB9CiAgICAgICAgcmVzdWx0LnNldChzdW0pOwogICAgICAgIGNvbnRleHQud3JpdGUoa2V5LCByZXN1bHQpOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class IntSumReducer extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {
    private IntWritable result = new IntWritable();

    public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException {
        int sum = 0;
        for (IntWritable val : values) {
            sum += val.get();
        }
        result.set(sum);
        context.write(key, result);
    }
}</pre></div><div class='content'><p><em>Explanation</em>: This example shows a Reducer class that sums up the counts for each word and writes the final count to the output.</p>
</div><h1>Advanced MapReduce Concepts</h1>
<div class='content'></div><h2>Combiner</h2>
<div class='content'><p>A combiner is a mini-reducer that performs a local reduce task on the map output. It helps in reducing the amount of data transferred between the map and reduce tasks.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIFRva2VuaXplckNvbWJpbmVyIGV4dGVuZHMgUmVkdWNlcjxUZXh0LCBJbnRXcml0YWJsZSwgVGV4dCwgSW50V3JpdGFibGU+IHsKICAgIHByaXZhdGUgSW50V3JpdGFibGUgcmVzdWx0ID0gbmV3IEludFdyaXRhYmxlKCk7CgogICAgcHVibGljIHZvaWQgcmVkdWNlKFRleHQga2V5LCBJdGVyYWJsZTxJbnRXcml0YWJsZT4gdmFsdWVzLCBDb250ZXh0IGNvbnRleHQpIHRocm93cyBJT0V4Y2VwdGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgIGludCBzdW0gPSAwOwogICAgICAgIGZvciAoSW50V3JpdGFibGUgdmFsIDogdmFsdWVzKSB7CiAgICAgICAgICAgIHN1bSArPSB2YWwuZ2V0KCk7CiAgICAgICAgfQogICAgICAgIHJlc3VsdC5zZXQoc3VtKTsKICAgICAgICBjb250ZXh0LndyaXRlKGtleSwgcmVzdWx0KTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class TokenizerCombiner extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {
    private IntWritable result = new IntWritable();

    public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException {
        int sum = 0;
        for (IntWritable val : values) {
            sum += val.get();
        }
        result.set(sum);
        context.write(key, result);
    }
}</pre></div><div class='content'><p><em>Explanation</em>: This combiner class performs local aggregation of word counts before sending them to the reducer.</p>
</div><h2>Partitioners</h2>
<div class='content'><p>Partitioners control the partitioning of the intermediate map-output keys. The key (or a subset of the key) is used to derive the partition, typically by a hash function.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIEN1c3RvbVBhcnRpdGlvbmVyIGV4dGVuZHMgUGFydGl0aW9uZXI8VGV4dCwgSW50V3JpdGFibGU+IHsKICAgIEBPdmVycmlkZQogICAgcHVibGljIGludCBnZXRQYXJ0aXRpb24oVGV4dCBrZXksIEludFdyaXRhYmxlIHZhbHVlLCBpbnQgbnVtUGFydGl0aW9ucykgewogICAgICAgIHJldHVybiAoa2V5Lmhhc2hDb2RlKCkgJiBJbnRlZ2VyLk1BWF9WQUxVRSkgJSBudW1QYXJ0aXRpb25zOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class CustomPartitioner extends Partitioner&lt;Text, IntWritable&gt; {
    @Override
    public int getPartition(Text key, IntWritable value, int numPartitions) {
        return (key.hashCode() &amp; Integer.MAX_VALUE) % numPartitions;
    }
}</pre></div><div class='content'><p><em>Explanation</em>: This custom partitioner ensures that the keys are evenly distributed across the reducers.</p>
</div><h1>Optimizing MapReduce Jobs</h1>
<div class='content'><ul>
<li><strong>Data Locality</strong>: Ensure that the data is processed where it is stored to minimize network I/O.</li>
<li><strong>Speculative Execution</strong>: Enable speculative execution to handle slow-running tasks.</li>
<li><strong>Combiner</strong>: Use combiners to reduce the amount of data shuffled between map and reduce tasks.</li>
<li><strong>Proper Configuration</strong>: Tune the number of map and reduce tasks based on the cluster resources and job requirements.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>The MapReduce framework is a powerful tool for processing large data sets in a distributed and parallel manner. Understanding its core concepts and advanced features allows you to write efficient and scalable data processing jobs. By leveraging combiners, partitioners, and proper job configuration, you can optimize your MapReduce jobs for better performance.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='hdfs'>&#x25C4;HDFS (Hadoop Distributed File System)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">MapReduce Framework</a>
	</div>
	<div class='col-4 text-end'>
					<a href='yarn'>YARN (Yet Another Resource Negotiator) &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
