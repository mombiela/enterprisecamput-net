<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apache Pig</title>

    <link rel="alternate" href="https://campusempresa.com/mod/hadoop/05-01-apache-pig" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/hadoop/05-01-apache-pig" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/hadoop/05-01-apache-pig" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/hadoop/05-01-apache-pig" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/hadoop/05-01-apache-pig" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-04-mapreduce-optimization-techniques' title="MapReduce Optimization Techniques">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Apache Pig</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-02-apache-hive' title="Apache Hive">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1><p>Introduction to Apache Pig</p>
</h1>
<div class='content'><p>Apache Pig is a high-level platform for creating programs that run on Apache Hadoop. The language for this platform is called Pig Latin. Pig can execute its Hadoop jobs in MapReduce, Apache Tez, or Apache Spark. Pig was designed to make it easier to write and understand data analysis programs, which are then converted into sequences of MapReduce jobs.</p>
</div><h2><p>Key Features of Apache Pig</p>
</h2>
<div class='content'><ul>
<li><strong>Ease of Programming</strong>: Pig Latin is a high-level language that abstracts the complexity of writing MapReduce programs.</li>
<li><strong>Optimization Opportunities</strong>: The Pig framework can optimize the execution of Pig Latin scripts.</li>
<li><strong>Extensibility</strong>: Users can create their own functions to process data.</li>
</ul>
</div><h1><p>Pig Latin Basics</p>
</h1>
<div class='content'><p>Pig Latin is the language used to write data analysis programs in Apache Pig. It includes a set of operations such as loading data, transforming it, and storing the final results.</p>
</div><h2><p>Basic Syntax</p>
</h2>
<div class='content'><p>Here is a simple example of a Pig Latin script:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gTG9hZCBkYXRhIGZyb20gYSBmaWxlCmRhdGEgPSBMT0FEICdpbnB1dC50eHQnIFVTSU5HIFBpZ1N0b3JhZ2UoJywnKSBBUyAobmFtZTpjaGFyYXJyYXksIGFnZTppbnQsIGNpdHk6Y2hhcmFycmF5KTsKCi0tIEZpbHRlciBkYXRhIHRvIGluY2x1ZGUgb25seSBwZW9wbGUgb2xkZXIgdGhhbiAzMApmaWx0ZXJlZF9kYXRhID0gRklMVEVSIGRhdGEgQlkgYWdlID4gMzA7CgotLSBHcm91cCBkYXRhIGJ5IGNpdHkKZ3JvdXBlZF9kYXRhID0gR1JPVVAgZmlsdGVyZWRfZGF0YSBCWSBjaXR5OwoKLS0gQ291bnQgdGhlIG51bWJlciBvZiBwZW9wbGUgaW4gZWFjaCBjaXR5CmNpdHlfY291bnQgPSBGT1JFQUNIIGdyb3VwZWRfZGF0YSBHRU5FUkFURSBncm91cCwgQ09VTlQoZmlsdGVyZWRfZGF0YSk7CgotLSBTdG9yZSB0aGUgcmVzdWx0cyBpbiBhIGZpbGUKU1RPUkUgY2l0eV9jb3VudCBJTlRPICdvdXRwdXQudHh0JyBVU0lORyBQaWdTdG9yYWdlKCcsJyk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Load data from a file
data = LOAD 'input.txt' USING PigStorage(',') AS (name:chararray, age:int, city:chararray);

-- Filter data to include only people older than 30
filtered_data = FILTER data BY age &gt; 30;

-- Group data by city
grouped_data = GROUP filtered_data BY city;

-- Count the number of people in each city
city_count = FOREACH grouped_data GENERATE group, COUNT(filtered_data);

-- Store the results in a file
STORE city_count INTO 'output.txt' USING PigStorage(',');</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ol>
<li><strong>LOAD</strong>: Loads data from a file.</li>
<li><strong>FILTER</strong>: Filters the data based on a condition.</li>
<li><strong>GROUP</strong>: Groups the data by a specified field.</li>
<li><strong>FOREACH</strong>: Iterates over the grouped data to generate new data.</li>
<li><strong>STORE</strong>: Stores the results in a file.</li>
</ol>
</div><h1><p>Practical Example</p>
</h1>
<div class='content'><p>Let's walk through a practical example where we analyze a dataset of user information.</p>
</div><h2><p>Dataset</p>
</h2>
<div class='content'><p>Assume we have a dataset <code>users.txt</code> with the following content:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Sm9obiwyNSxOZXcgWW9yawpKYW5lLDMyLExvcyBBbmdlbGVzCk1pa2UsMzUsQ2hpY2FnbwpTYXJhLDI4LE5ldyBZb3JrClRvbSw0MCxMb3MgQW5nZWxlcw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>John,25,New York
Jane,32,Los Angeles
Mike,35,Chicago
Sara,28,New York
Tom,40,Los Angeles</pre></div><div class='content'></div><h2><p>Pig Latin Script</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gTG9hZCB0aGUgZGF0YXNldAp1c2VycyA9IExPQUQgJ3VzZXJzLnR4dCcgVVNJTkcgUGlnU3RvcmFnZSgnLCcpIEFTIChuYW1lOmNoYXJhcnJheSwgYWdlOmludCwgY2l0eTpjaGFyYXJyYXkpOwoKLS0gRmlsdGVyIHVzZXJzIG9sZGVyIHRoYW4gMzAKb2xkZXJfdXNlcnMgPSBGSUxURVIgdXNlcnMgQlkgYWdlID4gMzA7CgotLSBHcm91cCB1c2VycyBieSBjaXR5Cmdyb3VwZWRfdXNlcnMgPSBHUk9VUCBvbGRlcl91c2VycyBCWSBjaXR5OwoKLS0gQ291bnQgdGhlIG51bWJlciBvZiB1c2VycyBpbiBlYWNoIGNpdHkKdXNlcl9jb3VudCA9IEZPUkVBQ0ggZ3JvdXBlZF91c2VycyBHRU5FUkFURSBncm91cCBBUyBjaXR5LCBDT1VOVChvbGRlcl91c2VycykgQVMgY291bnQ7CgotLSBTdG9yZSB0aGUgcmVzdWx0cwpTVE9SRSB1c2VyX2NvdW50IElOVE8gJ3VzZXJfY291bnQudHh0JyBVU0lORyBQaWdTdG9yYWdlKCcsJyk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Load the dataset
users = LOAD 'users.txt' USING PigStorage(',') AS (name:chararray, age:int, city:chararray);

-- Filter users older than 30
older_users = FILTER users BY age &gt; 30;

-- Group users by city
grouped_users = GROUP older_users BY city;

-- Count the number of users in each city
user_count = FOREACH grouped_users GENERATE group AS city, COUNT(older_users) AS count;

-- Store the results
STORE user_count INTO 'user_count.txt' USING PigStorage(',');</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ol>
<li><strong>LOAD</strong>: Loads the <code>users.txt</code> file.</li>
<li><strong>FILTER</strong>: Filters users who are older than 30.</li>
<li><strong>GROUP</strong>: Groups the filtered users by city.</li>
<li><strong>FOREACH</strong>: Generates a count of users for each city.</li>
<li><strong>STORE</strong>: Stores the results in <code>user_count.txt</code>.</li>
</ol>
</div><h1><p>Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Filtering Data</p>
</h2>
<div class='content'><p><strong>Task</strong>: Write a Pig Latin script to filter users who are younger than 30 and store the results.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gTG9hZCB0aGUgZGF0YXNldAp1c2VycyA9IExPQUQgJ3VzZXJzLnR4dCcgVVNJTkcgUGlnU3RvcmFnZSgnLCcpIEFTIChuYW1lOmNoYXJhcnJheSwgYWdlOmludCwgY2l0eTpjaGFyYXJyYXkpOwoKLS0gRmlsdGVyIHVzZXJzIHlvdW5nZXIgdGhhbiAzMAp5b3VuZ2VyX3VzZXJzID0gRklMVEVSIHVzZXJzIEJZIGFnZSA8IDMwOwoKLS0gU3RvcmUgdGhlIHJlc3VsdHMKU1RPUkUgeW91bmdlcl91c2VycyBJTlRPICd5b3VuZ2VyX3VzZXJzLnR4dCcgVVNJTkcgUGlnU3RvcmFnZSgnLCcpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Load the dataset
users = LOAD 'users.txt' USING PigStorage(',') AS (name:chararray, age:int, city:chararray);

-- Filter users younger than 30
younger_users = FILTER users BY age &lt; 30;

-- Store the results
STORE younger_users INTO 'younger_users.txt' USING PigStorage(',');</pre></div><div class='content'></div><h2><p>Exercise 2: Counting Users by Age Group</p>
</h2>
<div class='content'><p><strong>Task</strong>: Write a Pig Latin script to group users by age and count the number of users in each age group.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gTG9hZCB0aGUgZGF0YXNldAp1c2VycyA9IExPQUQgJ3VzZXJzLnR4dCcgVVNJTkcgUGlnU3RvcmFnZSgnLCcpIEFTIChuYW1lOmNoYXJhcnJheSwgYWdlOmludCwgY2l0eTpjaGFyYXJyYXkpOwoKLS0gR3JvdXAgdXNlcnMgYnkgYWdlCmdyb3VwZWRfYnlfYWdlID0gR1JPVVAgdXNlcnMgQlkgYWdlOwoKLS0gQ291bnQgdGhlIG51bWJlciBvZiB1c2VycyBpbiBlYWNoIGFnZSBncm91cAphZ2VfY291bnQgPSBGT1JFQUNIIGdyb3VwZWRfYnlfYWdlIEdFTkVSQVRFIGdyb3VwIEFTIGFnZSwgQ09VTlQodXNlcnMpIEFTIGNvdW50OwoKLS0gU3RvcmUgdGhlIHJlc3VsdHMKU1RPUkUgYWdlX2NvdW50IElOVE8gJ2FnZV9jb3VudC50eHQnIFVTSU5HIFBpZ1N0b3JhZ2UoJywnKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Load the dataset
users = LOAD 'users.txt' USING PigStorage(',') AS (name:chararray, age:int, city:chararray);

-- Group users by age
grouped_by_age = GROUP users BY age;

-- Count the number of users in each age group
age_count = FOREACH grouped_by_age GENERATE group AS age, COUNT(users) AS count;

-- Store the results
STORE age_count INTO 'age_count.txt' USING PigStorage(',');</pre></div><div class='content'></div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Incorrect Data Types</strong>: Ensure that the data types specified in the <code>LOAD</code> statement match the actual data.</li>
<li><strong>Missing Semicolons</strong>: Each Pig Latin statement should end with a semicolon.</li>
<li><strong>Case Sensitivity</strong>: Pig Latin is case-sensitive. Ensure that field names and keywords are correctly capitalized.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we introduced Apache Pig and its high-level language, Pig Latin. We covered the basics of writing Pig Latin scripts, including loading data, filtering, grouping, and storing results. We also provided practical examples and exercises to reinforce the concepts. In the next module, we will explore Apache Hive, another powerful tool in the Hadoop ecosystem.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-04-mapreduce-optimization-techniques' title="MapReduce Optimization Techniques">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-02-apache-hive' title="Apache Hive">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
