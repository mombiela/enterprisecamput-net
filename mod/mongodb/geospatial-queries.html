<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geospatial Queries in MongoDB</title>

    <link rel="alternate" href="https://campusempresa.com/mod/mongodb/geospatial-queries" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/mongodb/geospatial-queries" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/mongodb/geospatial-queries" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/mongodb/geospatial-queries" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/mongodb/geospatial-queries" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='full-text-search'>&#x25C4;Full-Text Search</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Geospatial Queries in MongoDB</a>
	</div>
	<div class='col-4 text-end'>
					<a href='time-series-data'>Time Series Data &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Geospatial Queries</h1>
<div class='content'><p>Geospatial queries allow you to perform location-based searches and operations on your data. MongoDB supports geospatial queries through the use of geospatial indexes and specific query operators.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Geospatial Data Types</strong>: MongoDB supports two main types of geospatial data: <code>Point</code> and <code>Polygon</code>.</li>
<li><strong>Geospatial Indexes</strong>: Indexes that enable efficient querying of geospatial data.</li>
<li><strong>Geospatial Query Operators</strong>: Operators that allow you to perform various geospatial queries.</li>
</ul>
</div><h1>Geospatial Data Types</h1>
<div class='content'><p>MongoDB supports GeoJSON objects and legacy coordinate pairs for geospatial data.</p>
</div><h2>GeoJSON Objects</h2>
<div class='content'><p>GeoJSON is a format for encoding a variety of geographic data structures.</p>
<ul>
<li><strong>Point</strong>: Represents a single location.
<pre><code class="language-json">{ &quot;type&quot;: &quot;Point&quot;, &quot;coordinates&quot;: [longitude, latitude] }
</code></pre>
</li>
<li><strong>Polygon</strong>: Represents an area enclosed by a series of points.
<pre><code class="language-json">{ 
  &quot;type&quot;: &quot;Polygon&quot;, 
  &quot;coordinates&quot;: [
    [ [longitude1, latitude1], [longitude2, latitude2], [longitude3, latitude3], [longitude1, latitude1] ]
  ] 
}
</code></pre>
</li>
</ul>
</div><h2>Legacy Coordinate Pairs</h2>
<div class='content'><p>Legacy coordinate pairs are simple arrays of <code>[longitude, latitude]</code>.</p>
</div><h1>Geospatial Indexes</h1>
<div class='content'><p>To perform geospatial queries efficiently, you need to create geospatial indexes.</p>
</div><h2>2dsphere Index</h2>
<div class='content'><p>The <code>2dsphere</code> index supports queries that interpret geometries on an Earth-like sphere.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIuY29sbGVjdGlvbi5jcmVhdGVJbmRleCh7IGxvY2F0aW9uOiAiMmRzcGhlcmUiIH0p"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.collection.createIndex({ location: &quot;2dsphere&quot; })</pre></div><div class='content'></div><h2>2d Index</h2>
<div class='content'><p>The <code>2d</code> index supports queries on a flat, Cartesian plane.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIuY29sbGVjdGlvbi5jcmVhdGVJbmRleCh7IGxvY2F0aW9uOiAiMmQiIH0p"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.collection.createIndex({ location: &quot;2d&quot; })</pre></div><div class='content'></div><h1>Geospatial Query Operators</h1>
<div class='content'><p>MongoDB provides several operators to perform geospatial queries.</p>
</div><h2>$near</h2>
<div class='content'><p>Finds documents that are close to a specified point.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIuY29sbGVjdGlvbi5maW5kKHsKICBsb2NhdGlvbjogewogICAgJG5lYXI6IHsKICAgICAgJGdlb21ldHJ5OiB7IHR5cGU6ICJQb2ludCIsIGNvb3JkaW5hdGVzOiBbbG9uZ2l0dWRlLCBsYXRpdHVkZV0gfSwKICAgICAgJG1heERpc3RhbmNlOiBkaXN0YW5jZV9pbl9tZXRlcnMKICAgIH0KICB9Cn0p"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.collection.find({
  location: {
    $near: {
      $geometry: { type: &quot;Point&quot;, coordinates: [longitude, latitude] },
      $maxDistance: distance_in_meters
    }
  }
})</pre></div><div class='content'></div><h2>$geoWithin</h2>
<div class='content'><p>Finds documents within a specified geometry.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIuY29sbGVjdGlvbi5maW5kKHsKICBsb2NhdGlvbjogewogICAgJGdlb1dpdGhpbjogewogICAgICAkZ2VvbWV0cnk6IHsKICAgICAgICB0eXBlOiAiUG9seWdvbiIsCiAgICAgICAgY29vcmRpbmF0ZXM6IFsgWyBbbG9uZ2l0dWRlMSwgbGF0aXR1ZGUxXSwgW2xvbmdpdHVkZTIsIGxhdGl0dWRlMl0sIFtsb25naXR1ZGUzLCBsYXRpdHVkZTNdLCBbbG9uZ2l0dWRlMSwgbGF0aXR1ZGUxXSBdIF0KICAgICAgfQogICAgfQogIH0KfSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.collection.find({
  location: {
    $geoWithin: {
      $geometry: {
        type: &quot;Polygon&quot;,
        coordinates: [ [ [longitude1, latitude1], [longitude2, latitude2], [longitude3, latitude3], [longitude1, latitude1] ] ]
      }
    }
  }
})</pre></div><div class='content'></div><h2>$geoIntersects</h2>
<div class='content'><p>Finds documents that intersect with a specified geometry.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIuY29sbGVjdGlvbi5maW5kKHsKICBsb2NhdGlvbjogewogICAgJGdlb0ludGVyc2VjdHM6IHsKICAgICAgJGdlb21ldHJ5OiB7CiAgICAgICAgdHlwZTogIlBvbHlnb24iLAogICAgICAgIGNvb3JkaW5hdGVzOiBbIFsgW2xvbmdpdHVkZTEsIGxhdGl0dWRlMV0sIFtsb25naXR1ZGUyLCBsYXRpdHVkZTJdLCBbbG9uZ2l0dWRlMywgbGF0aXR1ZGUzXSwgW2xvbmdpdHVkZTEsIGxhdGl0dWRlMV0gXSBdCiAgICAgIH0KICAgIH0KICB9Cn0p"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.collection.find({
  location: {
    $geoIntersects: {
      $geometry: {
        type: &quot;Polygon&quot;,
        coordinates: [ [ [longitude1, latitude1], [longitude2, latitude2], [longitude3, latitude3], [longitude1, latitude1] ] ]
      }
    }
  }
})</pre></div><div class='content'></div><h1>Examples and Exercises</h1>
<div class='content'></div><h2>Example 1: Creating a Geospatial Index</h2>
<div class='content'><p>Create a <code>2dsphere</code> index on a collection named <code>places</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIucGxhY2VzLmNyZWF0ZUluZGV4KHsgbG9jYXRpb246ICIyZHNwaGVyZSIgfSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.places.createIndex({ location: &quot;2dsphere&quot; })</pre></div><div class='content'></div><h2>Example 2: Finding Nearby Locations</h2>
<div class='content'><p>Find all places within 500 meters of a specific point.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIucGxhY2VzLmZpbmQoewogIGxvY2F0aW9uOiB7CiAgICAkbmVhcjogewogICAgICAkZ2VvbWV0cnk6IHsgdHlwZTogIlBvaW50IiwgY29vcmRpbmF0ZXM6IFstNzMuOTcsIDQwLjc3XSB9LAogICAgICAkbWF4RGlzdGFuY2U6IDUwMAogICAgfQogIH0KfSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.places.find({
  location: {
    $near: {
      $geometry: { type: &quot;Point&quot;, coordinates: [-73.97, 40.77] },
      $maxDistance: 500
    }
  }
})</pre></div><div class='content'></div><h2>Exercise 1: Creating and Querying Geospatial Data</h2>
<div class='content'><ol>
<li>Insert a few documents with geospatial data into a collection named <code>restaurants</code>.</li>
<li>Create a <code>2dsphere</code> index on the <code>location</code> field.</li>
<li>Write a query to find all restaurants within 1 kilometer of a given point.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gU3RlcCAxOiBJbnNlcnQgZG9jdW1lbnRzCmRiLnJlc3RhdXJhbnRzLmluc2VydE1hbnkoWwogIHsgbmFtZTogIlJlc3RhdXJhbnQgQSIsIGxvY2F0aW9uOiB7IHR5cGU6ICJQb2ludCIsIGNvb3JkaW5hdGVzOiBbLTczLjk3LCA0MC43N10gfSB9LAogIHsgbmFtZTogIlJlc3RhdXJhbnQgQiIsIGxvY2F0aW9uOiB7IHR5cGU6ICJQb2ludCIsIGNvb3JkaW5hdGVzOiBbLTczLjk4LCA0MC43OF0gfSB9LAogIHsgbmFtZTogIlJlc3RhdXJhbnQgQyIsIGxvY2F0aW9uOiB7IHR5cGU6ICJQb2ludCIsIGNvb3JkaW5hdGVzOiBbLTczLjk5LCA0MC43OV0gfSB9Cl0pCgovLyBTdGVwIDI6IENyZWF0ZSBhIDJkc3BoZXJlIGluZGV4CmRiLnJlc3RhdXJhbnRzLmNyZWF0ZUluZGV4KHsgbG9jYXRpb246ICIyZHNwaGVyZSIgfSkKCi8vIFN0ZXAgMzogUXVlcnkgZm9yIG5lYXJieSByZXN0YXVyYW50cwpkYi5yZXN0YXVyYW50cy5maW5kKHsKICBsb2NhdGlvbjogewogICAgJG5lYXI6IHsKICAgICAgJGdlb21ldHJ5OiB7IHR5cGU6ICJQb2ludCIsIGNvb3JkaW5hdGVzOiBbLTczLjk3LCA0MC43N10gfSwKICAgICAgJG1heERpc3RhbmNlOiAxMDAwCiAgICB9CiAgfQp9KQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Step 1: Insert documents
db.restaurants.insertMany([
  { name: &quot;Restaurant A&quot;, location: { type: &quot;Point&quot;, coordinates: [-73.97, 40.77] } },
  { name: &quot;Restaurant B&quot;, location: { type: &quot;Point&quot;, coordinates: [-73.98, 40.78] } },
  { name: &quot;Restaurant C&quot;, location: { type: &quot;Point&quot;, coordinates: [-73.99, 40.79] } }
])

// Step 2: Create a 2dsphere index
db.restaurants.createIndex({ location: &quot;2dsphere&quot; })

// Step 3: Query for nearby restaurants
db.restaurants.find({
  location: {
    $near: {
      $geometry: { type: &quot;Point&quot;, coordinates: [-73.97, 40.77] },
      $maxDistance: 1000
    }
  }
})</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Geospatial queries in MongoDB allow you to perform powerful location-based searches and operations. By understanding geospatial data types, indexes, and query operators, you can efficiently manage and query geospatial data in your applications. Practice creating indexes and running queries to become proficient in handling geospatial data with MongoDB.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='full-text-search'>&#x25C4;Full-Text Search</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Geospatial Queries in MongoDB</a>
	</div>
	<div class='col-4 text-end'>
					<a href='time-series-data'>Time Series Data &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
