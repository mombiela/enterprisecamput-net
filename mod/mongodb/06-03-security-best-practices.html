<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Best Practices</title>

    <link rel="alternate" href="https://campusempresa.com/mod/mongodb/06-03-security-best-practices" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/mongodb/06-03-security-best-practices" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/mongodb/06-03-security-best-practices" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/mongodb/06-03-security-best-practices" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/mongodb/06-03-security-best-practices" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-02-backup-and-restore' title="Backup and Restore">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Security Best Practices</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-04-monitoring-and-alerts' title="Monitoring and Alerts">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will cover essential security practices to ensure your MongoDB deployment is secure. Security is a critical aspect of any database system, and MongoDB provides several features to help you protect your data.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Authentication</strong>: Verifying the identity of users and applications.</li>
<li><strong>Authorization</strong>: Controlling access to resources based on user roles.</li>
<li><strong>Encryption</strong>: Protecting data at rest and in transit.</li>
<li><strong>Network Security</strong>: Securing the network environment where MongoDB is deployed.</li>
<li><strong>Auditing</strong>: Tracking and logging database activities.</li>
</ol>
</div><h1><p>Authentication</p>
</h1>
<div class='content'></div><h2><p>Enabling Authentication</p>
</h2>
<div class='content'><p>By default, MongoDB does not require authentication, which means anyone can access the database. To enable authentication:</p>
<ol>
<li>
<p><strong>Create an Admin User</strong>:</p>
<pre><code class="language-bash">use admin
db.createUser({
  user: &quot;admin&quot;,
  pwd: &quot;securepassword&quot;,
  roles: [{ role: &quot;userAdminAnyDatabase&quot;, db: &quot;admin&quot; }]
})
</code></pre>
</li>
<li>
<p><strong>Enable Authentication in Configuration File</strong>:
Edit the <code>mongod.conf</code> file to include:</p>
<pre><code class="language-yaml">security:
  authorization: &quot;enabled&quot;
</code></pre>
</li>
<li>
<p><strong>Restart MongoDB</strong>:</p>
<pre><code class="language-bash">sudo systemctl restart mongod
</code></pre>
</li>
</ol>
</div><h2><p>Practical Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ29ubmVjdCB0byB0aGUgYWRtaW4gZGF0YWJhc2UKdXNlIGFkbWluCgovLyBDcmVhdGUgYSBuZXcgdXNlciB3aXRoIHJlYWRXcml0ZSBhY2Nlc3MgdG8gYSBzcGVjaWZpYyBkYXRhYmFzZQpkYi5jcmVhdGVVc2VyKHsKICB1c2VyOiAiYXBwVXNlciIsCiAgcHdkOiAiYXBwVXNlclBhc3N3b3JkIiwKICByb2xlczogW3sgcm9sZTogInJlYWRXcml0ZSIsIGRiOiAibXlEYXRhYmFzZSIgfV0KfSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Connect to the admin database
use admin

// Create a new user with readWrite access to a specific database
db.createUser({
  user: &quot;appUser&quot;,
  pwd: &quot;appUserPassword&quot;,
  roles: [{ role: &quot;readWrite&quot;, db: &quot;myDatabase&quot; }]
})</pre></div><div class='content'></div><h1><p>Authorization</p>
</h1>
<div class='content'></div><h2><p>Role-Based Access Control (RBAC)</p>
</h2>
<div class='content'><p>MongoDB uses RBAC to manage user permissions. Common roles include:</p>
<ul>
<li><code>read</code>: Allows read-only access to a database.</li>
<li><code>readWrite</code>: Allows read and write access to a database.</li>
<li><code>dbAdmin</code>: Provides administrative rights to a database.</li>
<li><code>userAdmin</code>: Allows management of user accounts.</li>
</ul>
</div><h2><p>Practical Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQXNzaWduIHRoZSByZWFkV3JpdGUgcm9sZSB0byBhIHVzZXIgZm9yIGEgc3BlY2lmaWMgZGF0YWJhc2UKZGIuZ3JhbnRSb2xlc1RvVXNlcigiYXBwVXNlciIsIFt7IHJvbGU6ICJyZWFkV3JpdGUiLCBkYjogIm15RGF0YWJhc2UiIH1dKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Assign the readWrite role to a user for a specific database
db.grantRolesToUser(&quot;appUser&quot;, [{ role: &quot;readWrite&quot;, db: &quot;myDatabase&quot; }])</pre></div><div class='content'></div><h1><p>Encryption</p>
</h1>
<div class='content'></div><h2><p>Data at Rest</p>
</h2>
<div class='content'><p>MongoDB supports encryption at rest using the WiredTiger storage engine. To enable it:</p>
<ol>
<li>
<p><strong>Edit the Configuration File</strong>:</p>
<pre><code class="language-yaml">security:
  enableEncryption: true
  encryptionKeyFile: /path/to/keyfile
</code></pre>
</li>
<li>
<p><strong>Generate an Encryption Key</strong>:</p>
<pre><code class="language-bash">openssl rand -base64 32 &gt; /path/to/keyfile
chmod 600 /path/to/keyfile
</code></pre>
</li>
<li>
<p><strong>Restart MongoDB</strong>:</p>
<pre><code class="language-bash">sudo systemctl restart mongod
</code></pre>
</li>
</ol>
</div><h2><p>Data in Transit</p>
</h2>
<div class='content'><p>To encrypt data in transit, use TLS/SSL:</p>
<ol>
<li>
<p><strong>Generate Certificates</strong>:</p>
<pre><code class="language-bash">openssl req -newkey rsa:2048 -new -x509 -days 365 -nodes -out mongodb-cert.crt -keyout mongodb-cert.key
</code></pre>
</li>
<li>
<p><strong>Edit the Configuration File</strong>:</p>
<pre><code class="language-yaml">net:
  ssl:
    mode: requireSSL
    PEMKeyFile: /path/to/mongodb-cert.pem
</code></pre>
</li>
<li>
<p><strong>Restart MongoDB</strong>:</p>
<pre><code class="language-bash">sudo systemctl restart mongod
</code></pre>
</li>
</ol>
</div><h1><p>Network Security</p>
</h1>
<div class='content'></div><h2><p>IP Whitelisting</p>
</h2>
<div class='content'><p>Restrict access to MongoDB by allowing only specific IP addresses:</p>
<ol>
<li>
<p><strong>Edit the Configuration File</strong>:</p>
<pre><code class="language-yaml">net:
  bindIp: 127.0.0.1,192.168.1.100
</code></pre>
</li>
<li>
<p><strong>Restart MongoDB</strong>:</p>
<pre><code class="language-bash">sudo systemctl restart mongod
</code></pre>
</li>
</ol>
</div><h2><p>Firewalls</p>
</h2>
<div class='content'><p>Use firewalls to block unauthorized access:</p>
<ol>
<li><strong>Configure UFW (Uncomplicated Firewall)</strong>:
<pre><code class="language-bash">sudo ufw allow from 192.168.1.100 to any port 27017
sudo ufw enable
</code></pre>
</li>
</ol>
</div><h1><p>Auditing</p>
</h1>
<div class='content'></div><h2><p>Enabling Auditing</p>
</h2>
<div class='content'><p>MongoDB Enterprise supports auditing to track database activities:</p>
<ol>
<li>
<p><strong>Edit the Configuration File</strong>:</p>
<pre><code class="language-yaml">auditLog:
  destination: file
  format: JSON
  path: /var/log/mongodb/audit.log
</code></pre>
</li>
<li>
<p><strong>Restart MongoDB</strong>:</p>
<pre><code class="language-bash">sudo systemctl restart mongod
</code></pre>
</li>
</ol>
</div><h2><p>Practical Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRXhhbXBsZSBvZiBhbiBhdWRpdCBsb2cgZW50cnkKewogICJhdHlwZSI6ICJhdXRoQ2hlY2siLAogICJ0cyI6IElTT0RhdGUoIjIwMjMtMTAtMDFUMTI6MDA6MDBaIiksCiAgImxvY2FsIjogeyAiaXAiOiAiMTI3LjAuMC4xIiwgInBvcnQiOiAyNzAxNyB9LAogICJyZW1vdGUiOiB7ICJpcCI6ICIxOTIuMTY4LjEuMTAwIiwgInBvcnQiOiA1MDAwMCB9LAogICJ1c2VycyI6IFt7ICJ1c2VyIjogImFkbWluIiwgImRiIjogImFkbWluIiB9XSwKICAicm9sZXMiOiBbeyAicm9sZSI6ICJyZWFkV3JpdGUiLCAiZGIiOiAibXlEYXRhYmFzZSIgfV0sCiAgInBhcmFtIjogeyAiY29tbWFuZCI6ICJmaW5kIiwgIm5zIjogIm15RGF0YWJhc2UubXlDb2xsZWN0aW9uIiB9LAogICJyZXN1bHQiOiAwCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Example of an audit log entry
{
  &quot;atype&quot;: &quot;authCheck&quot;,
  &quot;ts&quot;: ISODate(&quot;2023-10-01T12:00:00Z&quot;),
  &quot;local&quot;: { &quot;ip&quot;: &quot;127.0.0.1&quot;, &quot;port&quot;: 27017 },
  &quot;remote&quot;: { &quot;ip&quot;: &quot;192.168.1.100&quot;, &quot;port&quot;: 50000 },
  &quot;users&quot;: [{ &quot;user&quot;: &quot;admin&quot;, &quot;db&quot;: &quot;admin&quot; }],
  &quot;roles&quot;: [{ &quot;role&quot;: &quot;readWrite&quot;, &quot;db&quot;: &quot;myDatabase&quot; }],
  &quot;param&quot;: { &quot;command&quot;: &quot;find&quot;, &quot;ns&quot;: &quot;myDatabase.myCollection&quot; },
  &quot;result&quot;: 0
}</pre></div><div class='content'></div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Enable Authentication</p>
</h2>
<div class='content'><ol>
<li>Create an admin user with the username <code>admin</code> and password <code>admin123</code>.</li>
<li>Enable authentication in the MongoDB configuration file.</li>
<li>Restart MongoDB and verify that authentication is required.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNlIGFkbWluCmRiLmNyZWF0ZVVzZXIoewogIHVzZXI6ICJhZG1pbiIsCiAgcHdkOiAiYWRtaW4xMjMiLAogIHJvbGVzOiBbeyByb2xlOiAidXNlckFkbWluQW55RGF0YWJhc2UiLCBkYjogImFkbWluIiB9XQp9KQoKIyBFZGl0IG1vbmdvZC5jb25mCiMgc2VjdXJpdHk6CiMgICBhdXRob3JpemF0aW9uOiAiZW5hYmxlZCIKCnN1ZG8gc3lzdGVtY3RsIHJlc3RhcnQgbW9uZ29k"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>use admin
db.createUser({
  user: &quot;admin&quot;,
  pwd: &quot;admin123&quot;,
  roles: [{ role: &quot;userAdminAnyDatabase&quot;, db: &quot;admin&quot; }]
})

# Edit mongod.conf
# security:
#   authorization: &quot;enabled&quot;

sudo systemctl restart mongod</pre></div><div class='content'></div><h2><p>Exercise 2: Create a User with Specific Roles</p>
</h2>
<div class='content'><ol>
<li>Create a user <code>reportUser</code> with read-only access to the <code>reports</code> database.</li>
<li>Verify the user's permissions by attempting to write to the <code>reports</code> database.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNlIHJlcG9ydHMKZGIuY3JlYXRlVXNlcih7CiAgdXNlcjogInJlcG9ydFVzZXIiLAogIHB3ZDogInJlcG9ydFBhc3N3b3JkIiwKICByb2xlczogW3sgcm9sZTogInJlYWQiLCBkYjogInJlcG9ydHMiIH1dCn0pCgovLyBWZXJpZnkgcGVybWlzc2lvbnMKZGIuYXV0aCgicmVwb3J0VXNlciIsICJyZXBvcnRQYXNzd29yZCIpCmRiLnJlcG9ydHMuaW5zZXJ0KHsgbmFtZTogIlRlc3QgUmVwb3J0IiB9KSAvLyBUaGlzIHNob3VsZCBmYWls"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>use reports
db.createUser({
  user: &quot;reportUser&quot;,
  pwd: &quot;reportPassword&quot;,
  roles: [{ role: &quot;read&quot;, db: &quot;reports&quot; }]
})

// Verify permissions
db.auth(&quot;reportUser&quot;, &quot;reportPassword&quot;)
db.reports.insert({ name: &quot;Test Report&quot; }) // This should fail</pre></div><div class='content'></div><h1><p>Summary</p>
</h1>
<div class='content'><p>In this section, we covered essential security practices for MongoDB, including authentication, authorization, encryption, network security, and auditing. By implementing these practices, you can significantly enhance the security of your MongoDB deployment. In the next section, we will explore performance tuning to optimize your MongoDB instance.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-02-backup-and-restore' title="Backup and Restore">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-04-monitoring-and-alerts' title="Monitoring and Alerts">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
