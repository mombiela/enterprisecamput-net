<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Media Application</title>

    <link rel="alternate" href="https://campusempresa.com/mod/mongodb/08-03-social-media-application" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/mongodb/08-03-social-media-application" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/mongodb/08-03-social-media-application" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/mongodb/08-03-social-media-application" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/mongodb/08-03-social-media-application" class="px-2">CA</a>
					</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-02-ecommerce-application' title="E-commerce Application">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Social Media Application</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-04-iot-data-management' title="IoT Data Management">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to build a social media application using MongoDB. This will involve designing the schema, implementing CRUD operations, and utilizing advanced MongoDB features to handle large volumes of data efficiently.</p>
</div><h1><p>Objectives</p>
</h1>
<div class='content'><ul>
<li>Understand the schema design for a social media application.</li>
<li>Implement CRUD operations for user profiles, posts, and comments.</li>
<li>Use MongoDB features like indexing and aggregation to optimize performance.</li>
</ul>
</div><h1><p>Schema Design</p>
</h1>
<div class='content'></div><h2><p>Key Collections</p>
</h2>
<div class='content'><ol>
<li><strong>Users</strong>: Stores user profile information.</li>
<li><strong>Posts</strong>: Stores user posts.</li>
<li><strong>Comments</strong>: Stores comments on posts.</li>
<li><strong>Likes</strong>: Stores likes on posts and comments.</li>
</ol>
</div><h2><p>Users Collection</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJfaWQiOiBPYmplY3RJZCgiLi4uIiksCiAgInVzZXJuYW1lIjogImpvaG5fZG9lIiwKICAiZW1haWwiOiAiam9obkBleGFtcGxlLmNvbSIsCiAgInBhc3N3b3JkIjogImhhc2hlZF9wYXNzd29yZCIsCiAgInByb2ZpbGUiOiB7CiAgICAiYmlvIjogIlNvZnR3YXJlIERldmVsb3BlciIsCiAgICAibG9jYXRpb24iOiAiU2FuIEZyYW5jaXNjbywgQ0EiLAogICAgIndlYnNpdGUiOiAiaHR0cHM6Ly9qb2huZG9lLmNvbSIKICB9LAogICJmb2xsb3dlcnMiOiBbT2JqZWN0SWQoIi4uLiIpXSwKICAiZm9sbG93aW5nIjogW09iamVjdElkKCIuLi4iKV0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;_id&quot;: ObjectId(&quot;...&quot;),
  &quot;username&quot;: &quot;john_doe&quot;,
  &quot;email&quot;: &quot;john@example.com&quot;,
  &quot;password&quot;: &quot;hashed_password&quot;,
  &quot;profile&quot;: {
    &quot;bio&quot;: &quot;Software Developer&quot;,
    &quot;location&quot;: &quot;San Francisco, CA&quot;,
    &quot;website&quot;: &quot;https://johndoe.com&quot;
  },
  &quot;followers&quot;: [ObjectId(&quot;...&quot;)],
  &quot;following&quot;: [ObjectId(&quot;...&quot;)]
}</pre></div><div class='content'></div><h2><p>Posts Collection</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJfaWQiOiBPYmplY3RJZCgiLi4uIiksCiAgInVzZXJfaWQiOiBPYmplY3RJZCgiLi4uIiksCiAgImNvbnRlbnQiOiAiVGhpcyBpcyBteSBmaXJzdCBwb3N0ISIsCiAgImNyZWF0ZWRfYXQiOiBJU09EYXRlKCIyMDIzLTEwLTAxVDEyOjAwOjAwWiIpLAogICJsaWtlcyI6IFtPYmplY3RJZCgiLi4uIildLAogICJjb21tZW50cyI6IFtPYmplY3RJZCgiLi4uIildCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;_id&quot;: ObjectId(&quot;...&quot;),
  &quot;user_id&quot;: ObjectId(&quot;...&quot;),
  &quot;content&quot;: &quot;This is my first post!&quot;,
  &quot;created_at&quot;: ISODate(&quot;2023-10-01T12:00:00Z&quot;),
  &quot;likes&quot;: [ObjectId(&quot;...&quot;)],
  &quot;comments&quot;: [ObjectId(&quot;...&quot;)]
}</pre></div><div class='content'></div><h2><p>Comments Collection</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJfaWQiOiBPYmplY3RJZCgiLi4uIiksCiAgInBvc3RfaWQiOiBPYmplY3RJZCgiLi4uIiksCiAgInVzZXJfaWQiOiBPYmplY3RJZCgiLi4uIiksCiAgImNvbnRlbnQiOiAiR3JlYXQgcG9zdCEiLAogICJjcmVhdGVkX2F0IjogSVNPRGF0ZSgiMjAyMy0xMC0wMVQxMjozMDowMFoiKSwKICAibGlrZXMiOiBbT2JqZWN0SWQoIi4uLiIpXQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;_id&quot;: ObjectId(&quot;...&quot;),
  &quot;post_id&quot;: ObjectId(&quot;...&quot;),
  &quot;user_id&quot;: ObjectId(&quot;...&quot;),
  &quot;content&quot;: &quot;Great post!&quot;,
  &quot;created_at&quot;: ISODate(&quot;2023-10-01T12:30:00Z&quot;),
  &quot;likes&quot;: [ObjectId(&quot;...&quot;)]
}</pre></div><div class='content'></div><h2><p>Likes Collection</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJfaWQiOiBPYmplY3RJZCgiLi4uIiksCiAgInVzZXJfaWQiOiBPYmplY3RJZCgiLi4uIiksCiAgInBvc3RfaWQiOiBPYmplY3RJZCgiLi4uIiksCiAgImNvbW1lbnRfaWQiOiBPYmplY3RJZCgiLi4uIiksCiAgImNyZWF0ZWRfYXQiOiBJU09EYXRlKCIyMDIzLTEwLTAxVDEyOjQ1OjAwWiIpCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;_id&quot;: ObjectId(&quot;...&quot;),
  &quot;user_id&quot;: ObjectId(&quot;...&quot;),
  &quot;post_id&quot;: ObjectId(&quot;...&quot;),
  &quot;comment_id&quot;: ObjectId(&quot;...&quot;),
  &quot;created_at&quot;: ISODate(&quot;2023-10-01T12:45:00Z&quot;)
}</pre></div><div class='content'></div><h1><p>CRUD Operations</p>
</h1>
<div class='content'></div><h2><p>Creating a User</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIudXNlcnMuaW5zZXJ0T25lKHsKICAidXNlcm5hbWUiOiAiam9obl9kb2UiLAogICJlbWFpbCI6ICJqb2huQGV4YW1wbGUuY29tIiwKICAicGFzc3dvcmQiOiAiaGFzaGVkX3Bhc3N3b3JkIiwKICAicHJvZmlsZSI6IHsKICAgICJiaW8iOiAiU29mdHdhcmUgRGV2ZWxvcGVyIiwKICAgICJsb2NhdGlvbiI6ICJTYW4gRnJhbmNpc2NvLCBDQSIsCiAgICAid2Vic2l0ZSI6ICJodHRwczovL2pvaG5kb2UuY29tIgogIH0sCiAgImZvbGxvd2VycyI6IFtdLAogICJmb2xsb3dpbmciOiBbXQp9KTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.users.insertOne({
  &quot;username&quot;: &quot;john_doe&quot;,
  &quot;email&quot;: &quot;john@example.com&quot;,
  &quot;password&quot;: &quot;hashed_password&quot;,
  &quot;profile&quot;: {
    &quot;bio&quot;: &quot;Software Developer&quot;,
    &quot;location&quot;: &quot;San Francisco, CA&quot;,
    &quot;website&quot;: &quot;https://johndoe.com&quot;
  },
  &quot;followers&quot;: [],
  &quot;following&quot;: []
});</pre></div><div class='content'></div><h2><p>Reading User Profiles</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIudXNlcnMuZmluZE9uZSh7ICJ1c2VybmFtZSI6ICJqb2huX2RvZSIgfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.users.findOne({ &quot;username&quot;: &quot;john_doe&quot; });</pre></div><div class='content'></div><h2><p>Updating User Profile</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIudXNlcnMudXBkYXRlT25lKAogIHsgInVzZXJuYW1lIjogImpvaG5fZG9lIiB9LAogIHsgJHNldDogeyAicHJvZmlsZS5iaW8iOiAiRnVsbCBTdGFjayBEZXZlbG9wZXIiIH0gfQopOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.users.updateOne(
  { &quot;username&quot;: &quot;john_doe&quot; },
  { $set: { &quot;profile.bio&quot;: &quot;Full Stack Developer&quot; } }
);</pre></div><div class='content'></div><h2><p>Deleting a User</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIudXNlcnMuZGVsZXRlT25lKHsgInVzZXJuYW1lIjogImpvaG5fZG9lIiB9KTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.users.deleteOne({ &quot;username&quot;: &quot;john_doe&quot; });</pre></div><div class='content'></div><h2><p>Creating a Post</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIucG9zdHMuaW5zZXJ0T25lKHsKICAidXNlcl9pZCI6IE9iamVjdElkKCIuLi4iKSwKICAiY29udGVudCI6ICJUaGlzIGlzIG15IGZpcnN0IHBvc3QhIiwKICAiY3JlYXRlZF9hdCI6IG5ldyBEYXRlKCksCiAgImxpa2VzIjogW10sCiAgImNvbW1lbnRzIjogW10KfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.posts.insertOne({
  &quot;user_id&quot;: ObjectId(&quot;...&quot;),
  &quot;content&quot;: &quot;This is my first post!&quot;,
  &quot;created_at&quot;: new Date(),
  &quot;likes&quot;: [],
  &quot;comments&quot;: []
});</pre></div><div class='content'></div><h2><p>Reading Posts</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIucG9zdHMuZmluZCh7ICJ1c2VyX2lkIjogT2JqZWN0SWQoIi4uLiIpIH0pLnNvcnQoeyAiY3JlYXRlZF9hdCI6IC0xIH0pOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.posts.find({ &quot;user_id&quot;: ObjectId(&quot;...&quot;) }).sort({ &quot;created_at&quot;: -1 });</pre></div><div class='content'></div><h2><p>Updating a Post</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIucG9zdHMudXBkYXRlT25lKAogIHsgIl9pZCI6IE9iamVjdElkKCIuLi4iKSB9LAogIHsgJHNldDogeyAiY29udGVudCI6ICJVcGRhdGVkIHBvc3QgY29udGVudCIgfSB9Cik7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.posts.updateOne(
  { &quot;_id&quot;: ObjectId(&quot;...&quot;) },
  { $set: { &quot;content&quot;: &quot;Updated post content&quot; } }
);</pre></div><div class='content'></div><h2><p>Deleting a Post</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIucG9zdHMuZGVsZXRlT25lKHsgIl9pZCI6IE9iamVjdElkKCIuLi4iKSB9KTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.posts.deleteOne({ &quot;_id&quot;: ObjectId(&quot;...&quot;) });</pre></div><div class='content'></div><h2><p>Creating a Comment</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIuY29tbWVudHMuaW5zZXJ0T25lKHsKICAicG9zdF9pZCI6IE9iamVjdElkKCIuLi4iKSwKICAidXNlcl9pZCI6IE9iamVjdElkKCIuLi4iKSwKICAiY29udGVudCI6ICJHcmVhdCBwb3N0ISIsCiAgImNyZWF0ZWRfYXQiOiBuZXcgRGF0ZSgpLAogICJsaWtlcyI6IFtdCn0pOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.comments.insertOne({
  &quot;post_id&quot;: ObjectId(&quot;...&quot;),
  &quot;user_id&quot;: ObjectId(&quot;...&quot;),
  &quot;content&quot;: &quot;Great post!&quot;,
  &quot;created_at&quot;: new Date(),
  &quot;likes&quot;: []
});</pre></div><div class='content'></div><h2><p>Reading Comments</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIuY29tbWVudHMuZmluZCh7ICJwb3N0X2lkIjogT2JqZWN0SWQoIi4uLiIpIH0pLnNvcnQoeyAiY3JlYXRlZF9hdCI6IC0xIH0pOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.comments.find({ &quot;post_id&quot;: ObjectId(&quot;...&quot;) }).sort({ &quot;created_at&quot;: -1 });</pre></div><div class='content'></div><h2><p>Updating a Comment</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIuY29tbWVudHMudXBkYXRlT25lKAogIHsgIl9pZCI6IE9iamVjdElkKCIuLi4iKSB9LAogIHsgJHNldDogeyAiY29udGVudCI6ICJVcGRhdGVkIGNvbW1lbnQgY29udGVudCIgfSB9Cik7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.comments.updateOne(
  { &quot;_id&quot;: ObjectId(&quot;...&quot;) },
  { $set: { &quot;content&quot;: &quot;Updated comment content&quot; } }
);</pre></div><div class='content'></div><h2><p>Deleting a Comment</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIuY29tbWVudHMuZGVsZXRlT25lKHsgIl9pZCI6IE9iamVjdElkKCIuLi4iKSB9KTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.comments.deleteOne({ &quot;_id&quot;: ObjectId(&quot;...&quot;) });</pre></div><div class='content'></div><h1><p>Indexing and Aggregation</p>
</h1>
<div class='content'></div><h2><p>Creating Indexes</p>
</h2>
<div class='content'><p>To improve the performance of queries, especially on large collections, we can create indexes.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIudXNlcnMuY3JlYXRlSW5kZXgoeyAidXNlcm5hbWUiOiAxIH0pOwpkYi5wb3N0cy5jcmVhdGVJbmRleCh7ICJ1c2VyX2lkIjogMSwgImNyZWF0ZWRfYXQiOiAtMSB9KTsKZGIuY29tbWVudHMuY3JlYXRlSW5kZXgoeyAicG9zdF9pZCI6IDEsICJjcmVhdGVkX2F0IjogLTEgfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.users.createIndex({ &quot;username&quot;: 1 });
db.posts.createIndex({ &quot;user_id&quot;: 1, &quot;created_at&quot;: -1 });
db.comments.createIndex({ &quot;post_id&quot;: 1, &quot;created_at&quot;: -1 });</pre></div><div class='content'></div><h2><p>Aggregation Example</p>
</h2>
<div class='content'><p>To get the number of posts each user has made:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIucG9zdHMuYWdncmVnYXRlKFsKICB7ICRncm91cDogeyBfaWQ6ICIkdXNlcl9pZCIsIHBvc3RDb3VudDogeyAkc3VtOiAxIH0gfSB9LAogIHsgJHNvcnQ6IHsgcG9zdENvdW50OiAtMSB9IH0KXSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.posts.aggregate([
  { $group: { _id: &quot;$user_id&quot;, postCount: { $sum: 1 } } },
  { $sort: { postCount: -1 } }
]);</pre></div><div class='content'></div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Task</p>
</h2>
<div class='content'><ol>
<li>Create a new user.</li>
<li>Add a post for the user.</li>
<li>Add a comment to the post.</li>
<li>Like the post and the comment.</li>
<li>Retrieve the post along with its comments and likes.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gMS4gQ3JlYXRlIGEgbmV3IHVzZXIKY29uc3QgdXNlcklkID0gZGIudXNlcnMuaW5zZXJ0T25lKHsKICAidXNlcm5hbWUiOiAiamFuZV9kb2UiLAogICJlbWFpbCI6ICJqYW5lQGV4YW1wbGUuY29tIiwKICAicGFzc3dvcmQiOiAiaGFzaGVkX3Bhc3N3b3JkIiwKICAicHJvZmlsZSI6IHsKICAgICJiaW8iOiAiR3JhcGhpYyBEZXNpZ25lciIsCiAgICAibG9jYXRpb24iOiAiTmV3IFlvcmssIE5ZIiwKICAgICJ3ZWJzaXRlIjogImh0dHBzOi8vamFuZWRvZS5jb20iCiAgfSwKICAiZm9sbG93ZXJzIjogW10sCiAgImZvbGxvd2luZyI6IFtdCn0pLmluc2VydGVkSWQ7CgovLyAyLiBBZGQgYSBwb3N0IGZvciB0aGUgdXNlcgpjb25zdCBwb3N0SWQgPSBkYi5wb3N0cy5pbnNlcnRPbmUoewogICJ1c2VyX2lkIjogdXNlcklkLAogICJjb250ZW50IjogIkhlbGxvLCB3b3JsZCEiLAogICJjcmVhdGVkX2F0IjogbmV3IERhdGUoKSwKICAibGlrZXMiOiBbXSwKICAiY29tbWVudHMiOiBbXQp9KS5pbnNlcnRlZElkOwoKLy8gMy4gQWRkIGEgY29tbWVudCB0byB0aGUgcG9zdApjb25zdCBjb21tZW50SWQgPSBkYi5jb21tZW50cy5pbnNlcnRPbmUoewogICJwb3N0X2lkIjogcG9zdElkLAogICJ1c2VyX2lkIjogdXNlcklkLAogICJjb250ZW50IjogIk5pY2UgdG8gbWVldCB5b3UgYWxsISIsCiAgImNyZWF0ZWRfYXQiOiBuZXcgRGF0ZSgpLAogICJsaWtlcyI6IFtdCn0pLmluc2VydGVkSWQ7CgovLyA0LiBMaWtlIHRoZSBwb3N0IGFuZCB0aGUgY29tbWVudApkYi5wb3N0cy51cGRhdGVPbmUoCiAgeyAiX2lkIjogcG9zdElkIH0sCiAgeyAkcHVzaDogeyAibGlrZXMiOiB1c2VySWQgfSB9Cik7CgpkYi5jb21tZW50cy51cGRhdGVPbmUoCiAgeyAiX2lkIjogY29tbWVudElkIH0sCiAgeyAkcHVzaDogeyAibGlrZXMiOiB1c2VySWQgfSB9Cik7CgovLyA1LiBSZXRyaWV2ZSB0aGUgcG9zdCBhbG9uZyB3aXRoIGl0cyBjb21tZW50cyBhbmQgbGlrZXMKY29uc3QgcG9zdFdpdGhDb21tZW50cyA9IGRiLnBvc3RzLmFnZ3JlZ2F0ZShbCiAgeyAkbWF0Y2g6IHsgIl9pZCI6IHBvc3RJZCB9IH0sCiAgewogICAgJGxvb2t1cDogewogICAgICBmcm9tOiAiY29tbWVudHMiLAogICAgICBsb2NhbEZpZWxkOiAiX2lkIiwKICAgICAgZm9yZWlnbkZpZWxkOiAicG9zdF9pZCIsCiAgICAgIGFzOiAiY29tbWVudHMiCiAgICB9CiAgfSwKICB7CiAgICAkbG9va3VwOiB7CiAgICAgIGZyb206ICJ1c2VycyIsCiAgICAgIGxvY2FsRmllbGQ6ICJsaWtlcyIsCiAgICAgIGZvcmVpZ25GaWVsZDogIl9pZCIsCiAgICAgIGFzOiAibGlrZWRCeSIKICAgIH0KICB9Cl0pLnRvQXJyYXkoKTsKCnByaW50anNvbihwb3N0V2l0aENvbW1lbnRzKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// 1. Create a new user
const userId = db.users.insertOne({
  &quot;username&quot;: &quot;jane_doe&quot;,
  &quot;email&quot;: &quot;jane@example.com&quot;,
  &quot;password&quot;: &quot;hashed_password&quot;,
  &quot;profile&quot;: {
    &quot;bio&quot;: &quot;Graphic Designer&quot;,
    &quot;location&quot;: &quot;New York, NY&quot;,
    &quot;website&quot;: &quot;https://janedoe.com&quot;
  },
  &quot;followers&quot;: [],
  &quot;following&quot;: []
}).insertedId;

// 2. Add a post for the user
const postId = db.posts.insertOne({
  &quot;user_id&quot;: userId,
  &quot;content&quot;: &quot;Hello, world!&quot;,
  &quot;created_at&quot;: new Date(),
  &quot;likes&quot;: [],
  &quot;comments&quot;: []
}).insertedId;

// 3. Add a comment to the post
const commentId = db.comments.insertOne({
  &quot;post_id&quot;: postId,
  &quot;user_id&quot;: userId,
  &quot;content&quot;: &quot;Nice to meet you all!&quot;,
  &quot;created_at&quot;: new Date(),
  &quot;likes&quot;: []
}).insertedId;

// 4. Like the post and the comment
db.posts.updateOne(
  { &quot;_id&quot;: postId },
  { $push: { &quot;likes&quot;: userId } }
);

db.comments.updateOne(
  { &quot;_id&quot;: commentId },
  { $push: { &quot;likes&quot;: userId } }
);

// 5. Retrieve the post along with its comments and likes
const postWithComments = db.posts.aggregate([
  { $match: { &quot;_id&quot;: postId } },
  {
    $lookup: {
      from: &quot;comments&quot;,
      localField: &quot;_id&quot;,
      foreignField: &quot;post_id&quot;,
      as: &quot;comments&quot;
    }
  },
  {
    $lookup: {
      from: &quot;users&quot;,
      localField: &quot;likes&quot;,
      foreignField: &quot;_id&quot;,
      as: &quot;likedBy&quot;
    }
  }
]).toArray();

printjson(postWithComments);</pre></div><div class='content'></div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we have covered the essential aspects of building a social media application using MongoDB. We designed the schema, implemented CRUD operations, and utilized indexing and aggregation to optimize performance. This knowledge can be applied to build scalable and efficient social media platforms. In the next section, we will explore IoT data management with MongoDB.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-02-ecommerce-application' title="E-commerce Application">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-04-iot-data-management' title="IoT Data Management">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
