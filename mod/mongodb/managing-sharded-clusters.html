<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Managing Sharded Clusters</title>

    <link rel="alternate" href="https://campusempresa.com/mod/mongodb/managing-sharded-clusters" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/mongodb/managing-sharded-clusters" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/mongodb/managing-sharded-clusters" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/mongodb/managing-sharded-clusters" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/mongodb/managing-sharded-clusters" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='configuring-sharded-clusters'>&#x25C4;Configuring Sharded Clusters</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Managing Sharded Clusters</a>
	</div>
	<div class='col-4 text-end'>
					<a href='authentication-and-authorization'>Authentication and Authorization &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Sharding</h1>
<div class='content'><p>Sharding is a method for distributing data across multiple machines. MongoDB uses sharding to support deployments with very large data sets and high throughput operations.</p>
<ul>
<li><strong>Sharding</strong>: The process of storing data records across multiple machines.</li>
<li><strong>Shard</strong>: Each machine in a sharded cluster.</li>
<li><strong>Cluster</strong>: A group of servers that work together to manage data and operations.</li>
</ul>
</div><h1>Components of a Sharded Cluster</h1>
<div class='content'><p>A MongoDB sharded cluster consists of the following components:</p>
<ul>
<li><strong>Shards</strong>: These are the data-bearing servers in the cluster. Each shard can be a replica set.</li>
<li><strong>Config Servers</strong>: These store metadata and configuration settings for the cluster.</li>
<li><strong>Query Routers (mongos)</strong>: These route client requests to the appropriate shard(s).</li>
</ul>
</div><h1>Setting Up a Sharded Cluster</h1>
<div class='content'></div><h2>Step 1: Deploy Config Servers</h2>
<div class='content'><p>Config servers store the metadata for the sharded cluster. You need at least three config servers for production environments.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9uZ29kIC0tY29uZmlnc3ZyIC0tcmVwbFNldCBjb25maWdSZXBsU2V0IC0tZGJwYXRoIC9kYXRhL2NvbmZpZ2RiIC0tcG9ydCAyNzAxOQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>mongod --configsvr --replSet configReplSet --dbpath /data/configdb --port 27019</pre></div><div class='content'></div><h2>Step 2: Deploy Shards</h2>
<div class='content'><p>Each shard can be a standalone mongod instance or a replica set. For production, use replica sets.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9uZ29kIC0tc2hhcmRzdnIgLS1yZXBsU2V0IHNoYXJkUmVwbFNldDEgLS1kYnBhdGggL2RhdGEvc2hhcmQxIC0tcG9ydCAyNzAxOA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>mongod --shardsvr --replSet shardReplSet1 --dbpath /data/shard1 --port 27018</pre></div><div class='content'></div><h2>Step 3: Deploy Query Routers (mongos)</h2>
<div class='content'><p>Query routers are the interface between client applications and the sharded cluster.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9uZ29zIC0tY29uZmlnZGIgY29uZmlnUmVwbFNldC9sb2NhbGhvc3Q6MjcwMTkgLS1wb3J0IDI3MDE3"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>mongos --configdb configReplSet/localhost:27019 --port 27017</pre></div><div class='content'></div><h2>Step 4: Connect to the Cluster and Add Shards</h2>
<div class='content'><p>Connect to the mongos instance and add shards to the cluster.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2guYWRkU2hhcmQoInNoYXJkUmVwbFNldDEvbG9jYWxob3N0OjI3MDE4Iik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sh.addShard(&quot;shardReplSet1/localhost:27018&quot;)</pre></div><div class='content'></div><h1>Sharding a Collection</h1>
<div class='content'><p>To shard a collection, you need to:</p>
<ol>
<li>Enable sharding for the database.</li>
<li>Choose a shard key.</li>
<li>Shard the collection.</li>
</ol>
</div><h2>Enabling Sharding for a Database</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2guZW5hYmxlU2hhcmRpbmcoIm15RGF0YWJhc2UiKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sh.enableSharding(&quot;myDatabase&quot;)</pre></div><div class='content'></div><h2>Choosing a Shard Key</h2>
<div class='content'><p>The shard key is a field that determines the distribution of the collection's documents across the shards.</p>
<ul>
<li><strong>Hashed Shard Key</strong>: Distributes data based on a hashed value of the shard key.</li>
<li><strong>Ranged Shard Key</strong>: Distributes data based on a range of shard key values.</li>
</ul>
</div><h2>Sharding the Collection</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2guc2hhcmRDb2xsZWN0aW9uKCJteURhdGFiYXNlLm15Q29sbGVjdGlvbiIsIHsgc2hhcmRLZXk6IDEgfSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sh.shardCollection(&quot;myDatabase.myCollection&quot;, { shardKey: 1 })</pre></div><div class='content'></div><h1>Managing Sharded Clusters</h1>
<div class='content'></div><h2>Balancing Data</h2>
<div class='content'><p>MongoDB automatically balances the data across shards. However, you can manually trigger a balancer if needed.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2guc3RhcnRCYWxhbmNlcigpCnNoLnN0b3BCYWxhbmNlcigp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sh.startBalancer()
sh.stopBalancer()</pre></div><div class='content'></div><h2>Monitoring Sharded Clusters</h2>
<div class='content'><p>Use the following commands to monitor the status of your sharded cluster:</p>
<ul>
<li>
<p><strong>Cluster Status</strong>: Provides an overview of the cluster.</p>
<pre><code class="language-javascript">sh.status()
</code></pre>
</li>
<li>
<p><strong>Balancer Status</strong>: Shows the status of the balancer.</p>
<pre><code class="language-javascript">sh.getBalancerState()
</code></pre>
</li>
</ul>
</div><h2>Backing Up Sharded Clusters</h2>
<div class='content'><p>Backing up a sharded cluster involves backing up each shard and the config servers.</p>
<ul>
<li><strong>Backup Shards</strong>: Use <code>mongodump</code> to back up each shard.</li>
<li><strong>Backup Config Servers</strong>: Use <code>mongodump</code> to back up the config servers.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9uZ29kdW1wIC0taG9zdCBzaGFyZFJlcGxTZXQxL2xvY2FsaG9zdDoyNzAxOCAtLW91dCAvYmFja3VwL3NoYXJkMQptb25nb2R1bXAgLS1ob3N0IGNvbmZpZ1JlcGxTZXQvbG9jYWxob3N0OjI3MDE5IC0tb3V0IC9iYWNrdXAvY29uZmln"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>mongodump --host shardReplSet1/localhost:27018 --out /backup/shard1
mongodump --host configReplSet/localhost:27019 --out /backup/config</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Managing sharded clusters in MongoDB involves setting up and configuring shards, config servers, and query routers. Sharding allows MongoDB to handle large datasets and high throughput by distributing data across multiple machines. Key tasks include enabling sharding for databases, choosing appropriate shard keys, and monitoring and balancing data across the cluster. Proper management ensures efficient and reliable performance of your MongoDB sharded cluster.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='configuring-sharded-clusters'>&#x25C4;Configuring Sharded Clusters</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Managing Sharded Clusters</a>
	</div>
	<div class='col-4 text-end'>
					<a href='authentication-and-authorization'>Authentication and Authorization &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
