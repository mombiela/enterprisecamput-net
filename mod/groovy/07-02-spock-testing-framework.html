<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spock Testing Framework</title>

    <link rel="alternate" href="https://campusempresa.com/mod/groovy/07-02-spock-testing-framework" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/groovy/07-02-spock-testing-framework" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/groovy/07-02-spock-testing-framework" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/groovy/07-02-spock-testing-framework" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/groovy/07-02-spock-testing-framework" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-01-gradle-build-tool' title="Gradle Build Tool">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Spock Testing Framework</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-03-grails-framework' title="Grails Framework">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>The Spock Testing Framework is a powerful and expressive testing framework for Java and Groovy applications. It leverages Groovy's dynamic capabilities to provide a more readable and maintainable way to write tests. In this section, we will cover the basics of Spock, its features, and how to write and run tests using Spock.</p>
</div><h1>What is Spock?</h1>
<div class='content'><p>Spock is a testing and specification framework for Java and Groovy applications. It is designed to be expressive and readable, making it easier to write and understand tests. Spock supports both unit and integration testing and integrates seamlessly with popular build tools like Gradle and Maven.</p>
</div><h2>Key Features of Spock:</h2>
<div class='content'><ul>
<li><strong>Specification Language</strong>: Spock uses a specification language that is more readable and expressive than traditional testing frameworks.</li>
<li><strong>Data-Driven Testing</strong>: Spock makes it easy to write data-driven tests using data tables.</li>
<li><strong>Mocking and Stubbing</strong>: Spock has built-in support for mocking and stubbing, making it easier to isolate the code under test.</li>
<li><strong>Integration with Build Tools</strong>: Spock integrates seamlessly with Gradle and Maven, making it easy to run tests as part of your build process.</li>
</ul>
</div><h1>Setting Up Spock</h1>
<div class='content'><p>To use Spock in your Groovy project, you need to add the Spock dependencies to your build configuration. Here, we'll show you how to set up Spock with Gradle.</p>
</div><h2>Adding Spock to a Gradle Project</h2>
<div class='content'><ol>
<li>Open your <code>build.gradle</code> file.</li>
<li>Add the Spock dependencies to the <code>dependencies</code> section:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVwZW5kZW5jaWVzIHsKICAgIHRlc3RJbXBsZW1lbnRhdGlvbiAnb3JnLnNwb2NrZnJhbWV3b3JrOnNwb2NrLWNvcmU6Mi4wLWdyb292eS0zLjAnCiAgICB0ZXN0SW1wbGVtZW50YXRpb24gJ29yZy5jb2RlaGF1cy5ncm9vdnk6Z3Jvb3Z5LWFsbDozLjAuNycKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>dependencies {
    testImplementation 'org.spockframework:spock-core:2.0-groovy-3.0'
    testImplementation 'org.codehaus.groovy:groovy-all:3.0.7'
}</pre></div><div class='content'><ol start="3">
<li>Ensure you have the <code>test</code> task configured to run your tests:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dGVzdCB7CiAgICB1c2VKVW5pdFBsYXRmb3JtKCkKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>test {
    useJUnitPlatform()
}</pre></div><div class='content'></div><h1>Writing Your First Spock Test</h1>
<div class='content'><p>Let's write a simple Spock test to get started. We'll create a test for a simple calculator class.</p>
</div><h2>Calculator Class</h2>
<div class='content'><p>First, create a simple <code>Calculator</code> class:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgQ2FsY3VsYXRvciB7CiAgICBpbnQgYWRkKGludCBhLCBpbnQgYikgewogICAgICAgIHJldHVybiBhICsgYgogICAgfQoKICAgIGludCBzdWJ0cmFjdChpbnQgYSwgaW50IGIpIHsKICAgICAgICByZXR1cm4gYSAtIGIKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Calculator {
    int add(int a, int b) {
        return a + b
    }

    int subtract(int a, int b) {
        return a - b
    }
}</pre></div><div class='content'></div><h2>Spock Test Specification</h2>
<div class='content'><p>Next, create a Spock test specification for the <code>Calculator</code> class:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHNwb2NrLmxhbmcuU3BlY2lmaWNhdGlvbgoKY2xhc3MgQ2FsY3VsYXRvclNwZWMgZXh0ZW5kcyBTcGVjaWZpY2F0aW9uIHsKCiAgICBkZWYgImFkZGl0aW9uIHNob3VsZCByZXR1cm4gdGhlIHN1bSBvZiB0d28gbnVtYmVycyIoKSB7CiAgICAgICAgZ2l2ZW46ICJhIGNhbGN1bGF0b3IiCiAgICAgICAgZGVmIGNhbGN1bGF0b3IgPSBuZXcgQ2FsY3VsYXRvcigpCgogICAgICAgIHdoZW46ICJhZGRpbmcgdHdvIG51bWJlcnMiCiAgICAgICAgZGVmIHJlc3VsdCA9IGNhbGN1bGF0b3IuYWRkKDMsIDQpCgogICAgICAgIHRoZW46ICJ0aGUgcmVzdWx0IHNob3VsZCBiZSB0aGUgc3VtIG9mIHRoZSBudW1iZXJzIgogICAgICAgIHJlc3VsdCA9PSA3CiAgICB9CgogICAgZGVmICJzdWJ0cmFjdGlvbiBzaG91bGQgcmV0dXJuIHRoZSBkaWZmZXJlbmNlIG9mIHR3byBudW1iZXJzIigpIHsKICAgICAgICBnaXZlbjogImEgY2FsY3VsYXRvciIKICAgICAgICBkZWYgY2FsY3VsYXRvciA9IG5ldyBDYWxjdWxhdG9yKCkKCiAgICAgICAgd2hlbjogInN1YnRyYWN0aW5nIHR3byBudW1iZXJzIgogICAgICAgIGRlZiByZXN1bHQgPSBjYWxjdWxhdG9yLnN1YnRyYWN0KDEwLCA0KQoKICAgICAgICB0aGVuOiAidGhlIHJlc3VsdCBzaG91bGQgYmUgdGhlIGRpZmZlcmVuY2Ugb2YgdGhlIG51bWJlcnMiCiAgICAgICAgcmVzdWx0ID09IDYKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import spock.lang.Specification

class CalculatorSpec extends Specification {

    def &quot;addition should return the sum of two numbers&quot;() {
        given: &quot;a calculator&quot;
        def calculator = new Calculator()

        when: &quot;adding two numbers&quot;
        def result = calculator.add(3, 4)

        then: &quot;the result should be the sum of the numbers&quot;
        result == 7
    }

    def &quot;subtraction should return the difference of two numbers&quot;() {
        given: &quot;a calculator&quot;
        def calculator = new Calculator()

        when: &quot;subtracting two numbers&quot;
        def result = calculator.subtract(10, 4)

        then: &quot;the result should be the difference of the numbers&quot;
        result == 6
    }
}</pre></div><div class='content'></div><h2>Explanation of the Test Specification</h2>
<div class='content'><ul>
<li><strong>Specification Class</strong>: The test class extends <code>spock.lang.Specification</code>, which is the base class for all Spock specifications.</li>
<li><strong>Feature Methods</strong>: Each test method is called a feature method. The method name should describe the behavior being tested.</li>
<li><strong>Blocks</strong>: Spock uses blocks to structure the test:
<ul>
<li><code>given</code>: Sets up the context or preconditions.</li>
<li><code>when</code>: Describes the action or event.</li>
<li><code>then</code>: Specifies the expected outcome.</li>
</ul>
</li>
</ul>
</div><h1>Running Spock Tests</h1>
<div class='content'><p>To run your Spock tests, simply execute the <code>test</code> task in Gradle:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Li9ncmFkbGV3IHRlc3Q="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>./gradlew test</pre></div><div class='content'><p>Gradle will compile and run your Spock tests, and you will see the test results in the console.</p>
</div><h1>Data-Driven Testing</h1>
<div class='content'><p>Spock makes it easy to write data-driven tests using data tables. Let's modify our <code>CalculatorSpec</code> to include a data-driven test for the addition method.</p>
</div><h2>Data-Driven Test Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHNwb2NrLmxhbmcuU3BlY2lmaWNhdGlvbgppbXBvcnQgc3BvY2subGFuZy5VbnJvbGwKCmNsYXNzIENhbGN1bGF0b3JTcGVjIGV4dGVuZHMgU3BlY2lmaWNhdGlvbiB7CgogICAgQFVucm9sbAogICAgZGVmICJhZGRpdGlvbiBvZiAjYSBhbmQgI2Igc2hvdWxkIHJldHVybiAjcmVzdWx0IigpIHsKICAgICAgICBnaXZlbjogImEgY2FsY3VsYXRvciIKICAgICAgICBkZWYgY2FsY3VsYXRvciA9IG5ldyBDYWxjdWxhdG9yKCkKCiAgICAgICAgZXhwZWN0OiAidGhlIHJlc3VsdCBzaG91bGQgYmUgdGhlIHN1bSBvZiB0aGUgbnVtYmVycyIKICAgICAgICBjYWxjdWxhdG9yLmFkZChhLCBiKSA9PSByZXN1bHQKCiAgICAgICAgd2hlcmU6CiAgICAgICAgYSB8IGIgfHwgcmVzdWx0CiAgICAgICAgMSB8IDIgfHwgMwogICAgICAgIDMgfCA0IHx8IDcKICAgICAgICA1IHwgNiB8fCAxMQogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import spock.lang.Specification
import spock.lang.Unroll

class CalculatorSpec extends Specification {

    @Unroll
    def &quot;addition of #a and #b should return #result&quot;() {
        given: &quot;a calculator&quot;
        def calculator = new Calculator()

        expect: &quot;the result should be the sum of the numbers&quot;
        calculator.add(a, b) == result

        where:
        a | b || result
        1 | 2 || 3
        3 | 4 || 7
        5 | 6 || 11
    }
}</pre></div><div class='content'></div><h2>Explanation of Data-Driven Test</h2>
<div class='content'><ul>
<li><strong>@Unroll</strong>: The <code>@Unroll</code> annotation tells Spock to run the test for each row in the data table and include the parameter values in the test name.</li>
<li><strong>where Block</strong>: The <code>where</code> block defines the data table. Each row represents a set of input values and the expected result.</li>
</ul>
</div><h1>Mocking and Stubbing</h1>
<div class='content'><p>Spock has built-in support for mocking and stubbing, which makes it easy to isolate the code under test. Let's see an example of how to use mocks in Spock.</p>
</div><h2>Mocking Example</h2>
<div class='content'><p>Suppose we have a <code>UserService</code> class that depends on a <code>UserRepository</code> interface. We want to test the <code>UserService</code> without relying on the actual <code>UserRepository</code> implementation.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW50ZXJmYWNlIFVzZXJSZXBvc2l0b3J5IHsKICAgIFVzZXIgZmluZFVzZXJCeUlkKExvbmcgaWQpCn0KCmNsYXNzIFVzZXJTZXJ2aWNlIHsKICAgIFVzZXJSZXBvc2l0b3J5IHVzZXJSZXBvc2l0b3J5CgogICAgVXNlciBnZXRVc2VyKExvbmcgaWQpIHsKICAgICAgICByZXR1cm4gdXNlclJlcG9zaXRvcnkuZmluZFVzZXJCeUlkKGlkKQogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>interface UserRepository {
    User findUserById(Long id)
}

class UserService {
    UserRepository userRepository

    User getUser(Long id) {
        return userRepository.findUserById(id)
    }
}</pre></div><div class='content'></div><h2>Spock Test with Mock</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHNwb2NrLmxhbmcuU3BlY2lmaWNhdGlvbgoKY2xhc3MgVXNlclNlcnZpY2VTcGVjIGV4dGVuZHMgU3BlY2lmaWNhdGlvbiB7CgogICAgZGVmICJnZXRVc2VyIHNob3VsZCByZXR1cm4gdXNlciBmcm9tIHJlcG9zaXRvcnkiKCkgewogICAgICAgIGdpdmVuOiAiYSB1c2VyIHJlcG9zaXRvcnkgbW9jayIKICAgICAgICBkZWYgdXNlclJlcG9zaXRvcnkgPSBNb2NrKFVzZXJSZXBvc2l0b3J5KQogICAgICAgIGRlZiB1c2VyU2VydmljZSA9IG5ldyBVc2VyU2VydmljZSh1c2VyUmVwb3NpdG9yeTogdXNlclJlcG9zaXRvcnkpCiAgICAgICAgZGVmIHVzZXIgPSBuZXcgVXNlcihpZDogMSwgbmFtZTogIkpvaG4gRG9lIikKCiAgICAgICAgd2hlbjogInRoZSByZXBvc2l0b3J5IHJldHVybnMgYSB1c2VyIgogICAgICAgIHVzZXJSZXBvc2l0b3J5LmZpbmRVc2VyQnlJZCgxKSA+PiB1c2VyCgogICAgICAgIHRoZW46ICJ0aGUgc2VydmljZSBzaG91bGQgcmV0dXJuIHRoZSB1c2VyIgogICAgICAgIHVzZXJTZXJ2aWNlLmdldFVzZXIoMSkgPT0gdXNlcgogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import spock.lang.Specification

class UserServiceSpec extends Specification {

    def &quot;getUser should return user from repository&quot;() {
        given: &quot;a user repository mock&quot;
        def userRepository = Mock(UserRepository)
        def userService = new UserService(userRepository: userRepository)
        def user = new User(id: 1, name: &quot;John Doe&quot;)

        when: &quot;the repository returns a user&quot;
        userRepository.findUserById(1) &gt;&gt; user

        then: &quot;the service should return the user&quot;
        userService.getUser(1) == user
    }
}</pre></div><div class='content'></div><h2>Explanation of Mocking Example</h2>
<div class='content'><ul>
<li><strong>Mock</strong>: The <code>Mock</code> method creates a mock implementation of the <code>UserRepository</code> interface.</li>
<li><strong>Interaction</strong>: The <code>&gt;&gt;</code> operator is used to define the behavior of the mock. In this case, it specifies that when <code>findUserById(1)</code> is called, the mock should return the <code>user</code> object.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we have covered the basics of the Spock Testing Framework, including setting up Spock, writing and running tests, data-driven testing, and mocking. Spock's expressive syntax and powerful features make it an excellent choice for testing Groovy and Java applications. In the next module, we will explore the Grails Framework and how it can be used for web development with Groovy.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-01-gradle-build-tool' title="Gradle Build Tool">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-03-grails-framework' title="Grails Framework">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
