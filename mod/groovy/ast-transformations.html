<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AST Transformations in Groovy</title>

    <link rel="alternate" href="https://campusempresa.com/mod/groovy/ast-transformations" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/groovy/ast-transformations" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/groovy/ast-transformations" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/groovy/ast-transformations" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/groovy/ast-transformations" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='dsls'>&#x25C4;DSLs (Domain-Specific Languages)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">AST Transformations in Groovy</a>
	</div>
	<div class='col-4 text-end'>
					<a href='groovy-and-xml'>Groovy and XML &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to AST Transformations</h1>
<div class='content'><p>Abstract Syntax Tree (AST) Transformations are a powerful feature in Groovy that allows developers to modify the structure of code at compile time. This can be used to inject code, perform optimizations, or enforce coding standards.</p>
<ul>
<li><strong>AST</strong>: Abstract Syntax Tree, a tree representation of the abstract syntactic structure of source code.</li>
<li><strong>Transformation</strong>: Modifying the AST to change how the code behaves or is compiled.</li>
</ul>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Compile-time Metaprogramming</strong>: AST transformations occur during the compilation phase, allowing for modifications before the code is executed.</li>
<li><strong>Annotations</strong>: Groovy uses annotations to trigger AST transformations.</li>
<li><strong>Phases</strong>: Groovy's compilation process is divided into several phases, and transformations can be applied at different stages.</li>
</ul>
</div><h1>Common AST Transformations</h1>
<div class='content'><p>Groovy provides several built-in AST transformations that can be used to simplify code and add functionality.</p>
</div><h2>@ToString</h2>
<div class='content'><p>Generates a <code>toString()</code> method for a class.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGdyb292eS50cmFuc2Zvcm0uVG9TdHJpbmcKCkBUb1N0cmluZwpjbGFzcyBQZXJzb24gewogICAgU3RyaW5nIG5hbWUKICAgIGludCBhZ2UKfQoKZGVmIHBlcnNvbiA9IG5ldyBQZXJzb24obmFtZTogJ0pvaG4nLCBhZ2U6IDMwKQpwcmludGxuIHBlcnNvbi50b1N0cmluZygpIC8vIE91dHB1dDogUGVyc29uKEpvaG4sIDMwKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import groovy.transform.ToString

@ToString
class Person {
    String name
    int age
}

def person = new Person(name: 'John', age: 30)
println person.toString() // Output: Person(John, 30)</pre></div><div class='content'></div><h2>@EqualsAndHashCode</h2>
<div class='content'><p>Generates <code>equals()</code> and <code>hashCode()</code> methods.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGdyb292eS50cmFuc2Zvcm0uRXF1YWxzQW5kSGFzaENvZGUKCkBFcXVhbHNBbmRIYXNoQ29kZQpjbGFzcyBQZXJzb24gewogICAgU3RyaW5nIG5hbWUKICAgIGludCBhZ2UKfQoKZGVmIHBlcnNvbjEgPSBuZXcgUGVyc29uKG5hbWU6ICdKb2huJywgYWdlOiAzMCkKZGVmIHBlcnNvbjIgPSBuZXcgUGVyc29uKG5hbWU6ICdKb2huJywgYWdlOiAzMCkKYXNzZXJ0IHBlcnNvbjEgPT0gcGVyc29uMiAvLyB0cnVl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import groovy.transform.EqualsAndHashCode

@EqualsAndHashCode
class Person {
    String name
    int age
}

def person1 = new Person(name: 'John', age: 30)
def person2 = new Person(name: 'John', age: 30)
assert person1 == person2 // true</pre></div><div class='content'></div><h2>@Immutable</h2>
<div class='content'><p>Makes a class immutable by generating final fields and providing a constructor.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGdyb292eS50cmFuc2Zvcm0uSW1tdXRhYmxlCgpASW1tdXRhYmxlCmNsYXNzIFBvaW50IHsKICAgIGludCB4LCB5Cn0KCmRlZiBwb2ludCA9IG5ldyBQb2ludCgxMCwgMjApCmFzc2VydCBwb2ludC54ID09IDEwCmFzc2VydCBwb2ludC55ID09IDIw"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import groovy.transform.Immutable

@Immutable
class Point {
    int x, y
}

def point = new Point(10, 20)
assert point.x == 10
assert point.y == 20</pre></div><div class='content'></div><h1>Custom AST Transformations</h1>
<div class='content'><p>Creating custom AST transformations allows for more advanced and specific modifications.</p>
</div><h2>Writing a Simple AST Transformation</h2>
<div class='content'><ol>
<li><strong>Create the Annotation</strong>: Define an annotation to mark where the transformation should be applied.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlCmltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5SZXRlbnRpb24KaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLlJldGVudGlvblBvbGljeQppbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0CgpAUmV0ZW50aW9uKFJldGVudGlvblBvbGljeS5TT1VSQ0UpCkBUYXJnZXQoW0VsZW1lbnRUeXBlLlRZUEVdKQpAaW50ZXJmYWNlIE15VHJhbnNmb3JtYXRpb24ge30="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import java.lang.annotation.ElementType
import java.lang.annotation.Retention
import java.lang.annotation.RetentionPolicy
import java.lang.annotation.Target

@Retention(RetentionPolicy.SOURCE)
@Target([ElementType.TYPE])
@interface MyTransformation {}</pre></div><div class='content'><ol start="2">
<li><strong>Implement the Transformation</strong>: Create a class that implements <code>ASTTransformation</code>.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5jb2RlaGF1cy5ncm9vdnkuYXN0LioKaW1wb3J0IG9yZy5jb2RlaGF1cy5ncm9vdnkuYXN0LmJ1aWxkZXIuQXN0QnVpbGRlcgppbXBvcnQgb3JnLmNvZGVoYXVzLmdyb292eS5jb250cm9sLioKaW1wb3J0IG9yZy5jb2RlaGF1cy5ncm9vdnkudHJhbnNmb3JtLioKCkBHcm9vdnlBU1RUcmFuc2Zvcm1hdGlvbihwaGFzZSA9IENvbXBpbGVQaGFzZS5DQU5PTklDQUxJWkFUSU9OKQpjbGFzcyBNeVRyYW5zZm9ybWF0aW9uSW1wbCBpbXBsZW1lbnRzIEFTVFRyYW5zZm9ybWF0aW9uIHsKICAgIHZvaWQgdmlzaXQoQVNUTm9kZVtdIG5vZGVzLCBTb3VyY2VVbml0IHNvdXJjZSkgewogICAgICAgIG5vZGVzLmVhY2ggeyBub2RlIC0+CiAgICAgICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgQ2xhc3NOb2RlKSB7CiAgICAgICAgICAgICAgICBDbGFzc05vZGUgY2xhc3NOb2RlID0gKENsYXNzTm9kZSkgbm9kZQogICAgICAgICAgICAgICAgLy8gRXhhbXBsZTogQWRkIGEgbmV3IG1ldGhvZCB0byB0aGUgY2xhc3MKICAgICAgICAgICAgICAgIGNsYXNzTm9kZS5hZGRNZXRob2QoCiAgICAgICAgICAgICAgICAgICAgbmV3IE1ldGhvZE5vZGUoCiAgICAgICAgICAgICAgICAgICAgICAgICduZXdNZXRob2QnLAogICAgICAgICAgICAgICAgICAgICAgICBBQ0NfUFVCTElDLAogICAgICAgICAgICAgICAgICAgICAgICBDbGFzc0hlbHBlci5WT0lEX1RZUEUsCiAgICAgICAgICAgICAgICAgICAgICAgIFtdIGFzIFBhcmFtZXRlcltdLAogICAgICAgICAgICAgICAgICAgICAgICBbXSBhcyBDbGFzc05vZGVbXSwKICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEJsb2NrU3RhdGVtZW50KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgW25ldyBFeHByZXNzaW9uU3RhdGVtZW50KG5ldyBDb25zdGFudEV4cHJlc3Npb24oJ0hlbGxvIGZyb20gQVNUIFRyYW5zZm9ybWF0aW9uIScpKV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgVmFyaWFibGVTY29wZSgpCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.codehaus.groovy.ast.*
import org.codehaus.groovy.ast.builder.AstBuilder
import org.codehaus.groovy.control.*
import org.codehaus.groovy.transform.*

@GroovyASTTransformation(phase = CompilePhase.CANONICALIZATION)
class MyTransformationImpl implements ASTTransformation {
    void visit(ASTNode[] nodes, SourceUnit source) {
        nodes.each { node -&gt;
            if (node instanceof ClassNode) {
                ClassNode classNode = (ClassNode) node
                // Example: Add a new method to the class
                classNode.addMethod(
                    new MethodNode(
                        'newMethod',
                        ACC_PUBLIC,
                        ClassHelper.VOID_TYPE,
                        [] as Parameter[],
                        [] as ClassNode[],
                        new BlockStatement(
                            [new ExpressionStatement(new ConstantExpression('Hello from AST Transformation!'))],
                            new VariableScope()
                        )
                    )
                )
            }
        }
    }
}</pre></div><div class='content'><ol start="3">
<li><strong>Apply the Annotation</strong>: Use the annotation in your code.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QE15VHJhbnNmb3JtYXRpb24KY2xhc3MgRXhhbXBsZSB7fQoKZGVmIGV4YW1wbGUgPSBuZXcgRXhhbXBsZSgpCmV4YW1wbGUubmV3TWV0aG9kKCkgLy8gT3V0cHV0OiBIZWxsbyBmcm9tIEFTVCBUcmFuc2Zvcm1hdGlvbiE="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@MyTransformation
class Example {}

def example = new Example()
example.newMethod() // Output: Hello from AST Transformation!</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>AST Transformations in Groovy provide a robust mechanism for modifying code at compile time, enabling powerful metaprogramming capabilities. By understanding and utilizing both built-in and custom transformations, developers can write more concise, maintainable, and efficient code. As you advance in Groovy, mastering AST transformations will significantly enhance your ability to manipulate and optimize your codebase.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='dsls'>&#x25C4;DSLs (Domain-Specific Languages)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">AST Transformations in Groovy</a>
	</div>
	<div class='col-4 text-end'>
					<a href='groovy-and-xml'>Groovy and XML &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
