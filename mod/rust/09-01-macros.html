<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Macros</title>

    <link rel="alternate" href="https://campusempresa.com/mod/rust/09-01-macros" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/rust/09-01-macros" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/rust/09-01-macros" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=2" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/rust/09-01-macros" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/rust/09-01-macros" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Programming Languages</a>
				 					<a href="/categ/frameworks">Frameworks and Libraries</a>
				 					<a href="/categ/tech-tools">Technical Tools</a>
				 					<a href="/categ/foundations">Theoretical Foundations</a>
				 					<a href="/categ/soft-skills">Social Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-03-shared-state' title="Shared State">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Macros</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-02-unsafe-rust' title="Unsafe Rust">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Macros in Rust are a powerful feature that allows you to write code that writes other code (metaprogramming). They enable you to reduce code duplication and implement complex patterns in a concise manner. In this section, we will cover the basics of macros, how to define and use them, and provide practical examples and exercises to solidify your understanding.</p>
</div><h1><p>What are Macros?</p>
</h1>
<div class='content'><p>Macros in Rust come in two main forms:</p>
<ol>
<li><strong>Declarative Macros</strong> (also known as &quot;macros by example&quot;)</li>
<li><strong>Procedural Macros</strong></li>
</ol>
</div><h2><p>Declarative Macros</p>
</h2>
<div class='content'><p>Declarative macros are defined using the <code>macro_rules!</code> keyword. They allow you to define patterns that are matched against the input and expanded into Rust code.</p>
</div><h2><p>Procedural Macros</p>
</h2>
<div class='content'><p>Procedural macros are more complex and allow you to manipulate Rust code at a syntactic level. They are defined using functions and can be used for custom derive, attribute-like macros, and function-like macros.</p>
</div><h1><p>Defining and Using Declarative Macros</p>
</h1>
<div class='content'></div><h2><p>Basic Syntax</p>
</h2>
<div class='content'><p>The basic syntax for defining a declarative macro is as follows:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWFjcm9fcnVsZXMhIG1hY3JvX25hbWUgewogICAgKHBhdHRlcm4pID0+IHsKICAgICAgICBleHBhbnNpb24KICAgIH07Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>macro_rules! macro_name {
    (pattern) =&gt; {
        expansion
    };
}</pre></div><div class='content'></div><h2><p>Example: Simple Macro</p>
</h2>
<div class='content'><p>Let's start with a simple example of a macro that prints &quot;Hello, World!&quot;:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWFjcm9fcnVsZXMhIGhlbGxvX3dvcmxkIHsKICAgICgpID0+IHsKICAgICAgICBwcmludGxuISgiSGVsbG8sIFdvcmxkISIpOwogICAgfTsKfQoKZm4gbWFpbigpIHsKICAgIGhlbGxvX3dvcmxkISgpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>macro_rules! hello_world {
    () =&gt; {
        println!(&quot;Hello, World!&quot;);
    };
}

fn main() {
    hello_world!();
}</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li><code>macro_rules! hello_world</code> defines a new macro named <code>hello_world</code>.</li>
<li><code>()</code> is the pattern that matches the input (in this case, no input).</li>
<li><code>println!(&quot;Hello, World!&quot;);</code> is the expansion that replaces the macro invocation.</li>
</ul>
</div><h2><p>Example: Macro with Arguments</p>
</h2>
<div class='content'><p>Macros can also take arguments. Here's an example of a macro that takes a name and prints a greeting:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWFjcm9fcnVsZXMhIGdyZWV0IHsKICAgICgkbmFtZTpleHByKSA9PiB7CiAgICAgICAgcHJpbnRsbiEoIkhlbGxvLCB7fSEiLCAkbmFtZSk7CiAgICB9Owp9CgpmbiBtYWluKCkgewogICAgZ3JlZXQhKCJBbGljZSIpOwogICAgZ3JlZXQhKCJCb2IiKTsKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>macro_rules! greet {
    ($name:expr) =&gt; {
        println!(&quot;Hello, {}!&quot;, $name);
    };
}

fn main() {
    greet!(&quot;Alice&quot;);
    greet!(&quot;Bob&quot;);
}</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li><code>$name:expr</code> matches any Rust expression and binds it to the variable <code>$name</code>.</li>
<li><code>println!(&quot;Hello, {}!&quot;, $name);</code> is the expansion that uses the provided name.</li>
</ul>
</div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Define a Macro to Calculate the Square of a Number</p>
</h2>
<div class='content'><p><strong>Task:</strong>
Define a macro named <code>square</code> that takes a number as input and returns its square.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWFjcm9fcnVsZXMhIHNxdWFyZSB7CiAgICAoJHg6ZXhwcikgPT4gewogICAgICAgICR4ICogJHgKICAgIH07Cn0KCmZuIG1haW4oKSB7CiAgICBsZXQgbnVtID0gNDsKICAgIHByaW50bG4hKCJUaGUgc3F1YXJlIG9mIHt9IGlzIHt9IiwgbnVtLCBzcXVhcmUhKG51bSkpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>macro_rules! square {
    ($x:expr) =&gt; {
        $x * $x
    };
}

fn main() {
    let num = 4;
    println!(&quot;The square of {} is {}&quot;, num, square!(num));
}</pre></div><div class='content'></div><h2><p>Exercise 2: Define a Macro to Create a Vector</p>
</h2>
<div class='content'><p><strong>Task:</strong>
Define a macro named <code>create_vector</code> that takes a list of elements and creates a <code>Vec</code> containing those elements.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWFjcm9fcnVsZXMhIGNyZWF0ZV92ZWN0b3IgewogICAgKCQoJHg6ZXhwciksKikgPT4gewogICAgICAgIHsKICAgICAgICAgICAgbGV0IG11dCB2ZWMgPSBWZWM6Om5ldygpOwogICAgICAgICAgICAkKAogICAgICAgICAgICAgICAgdmVjLnB1c2goJHgpOwogICAgICAgICAgICApKgogICAgICAgICAgICB2ZWMKICAgICAgICB9CiAgICB9Owp9CgpmbiBtYWluKCkgewogICAgbGV0IHYgPSBjcmVhdGVfdmVjdG9yIVsxLCAyLCAzLCA0LCA1XTsKICAgIHByaW50bG4hKCJ7Oj99Iiwgdik7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>macro_rules! create_vector {
    ($($x:expr),*) =&gt; {
        {
            let mut vec = Vec::new();
            $(
                vec.push($x);
            )*
            vec
        }
    };
}

fn main() {
    let v = create_vector![1, 2, 3, 4, 5];
    println!(&quot;{:?}&quot;, v);
}</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li><code>($($x:expr),*)</code> matches zero or more expressions separated by commas.</li>
<li>The expansion creates a new <code>Vec</code> and pushes each element into it.</li>
</ul>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'></div><h2><p>Common Mistake: Forgetting the <code>!</code> in Macro Invocation</p>
</h2>
<div class='content'><p>When invoking a macro, always remember to include the <code>!</code> after the macro name. For example, <code>hello_world!()</code> instead of <code>hello_world()</code>.</p>
</div><h2><p>Tip: Use Macros to Reduce Code Duplication</p>
</h2>
<div class='content'><p>Macros are particularly useful for reducing code duplication. If you find yourself writing repetitive code, consider whether a macro could simplify your code.</p>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered the basics of macros in Rust, focusing on declarative macros. We learned how to define and use macros, provided practical examples, and included exercises to reinforce the concepts. Macros are a powerful tool in Rust that can help you write more concise and maintainable code. In the next section, we will explore more advanced features of Rust, including unsafe code and the Foreign Function Interface (FFI).</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-03-shared-state' title="Shared State">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-02-unsafe-rust' title="Unsafe Rust">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
