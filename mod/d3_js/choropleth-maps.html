<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choropleth Maps in D3.js</title>

    <link rel="alternate" href="https://campusempresa.com/mod/d3_js/choropleth-maps" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/d3_js/choropleth-maps" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/d3_js/choropleth-maps" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/d3_js/choropleth-maps" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/d3_js/choropleth-maps" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='force-layouts'>&#x25C4;Force Layouts</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Choropleth Maps in D3.js</a>
	</div>
	<div class='col-4 text-end'>
					<a href='heatmaps'>Heatmaps &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Choropleth Maps</h1>
<div class='content'><p>Choropleth maps are a type of thematic map where areas are shaded or patterned in proportion to the value of a variable being represented. These maps are useful for visualizing data across geographical regions.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Geographical Data</strong>: Data that includes geographical locations, such as countries, states, or counties.</li>
<li><strong>Color Scales</strong>: A range of colors used to represent different values on the map.</li>
<li><strong>GeoJSON</strong>: A format for encoding a variety of geographic data structures using JavaScript Object Notation (JSON).</li>
</ul>
</div><h1>Setting Up Your Environment</h1>
<div class='content'><p>Before creating a choropleth map, ensure you have the necessary tools and libraries installed.</p>
</div><h2>Prerequisites</h2>
<div class='content'><ul>
<li>Basic understanding of HTML, CSS, and JavaScript.</li>
<li>Familiarity with D3.js basics.</li>
</ul>
</div><h2>Installation</h2>
<div class='content'><p>To get started, include D3.js in your project. You can do this by adding the following script tag to your HTML file:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PHNjcmlwdCBzcmM9Imh0dHBzOi8vZDNqcy5vcmcvZDMudjYubWluLmpzIj48L3NjcmlwdD4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;script src=&quot;https://d3js.org/d3.v6.min.js&quot;&gt;&lt;/script&gt;</pre></div><div class='content'></div><h1>Creating a Basic Choropleth Map</h1>
<div class='content'><p>Let's create a simple choropleth map using D3.js.</p>
</div><h2>Step 1: Prepare the HTML Structure</h2>
<div class='content'><p>Create an HTML file with a basic structure:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSJVVEYtOCI+CiAgICA8dGl0bGU+Q2hvcm9wbGV0aCBNYXA8L3RpdGxlPgogICAgPHN0eWxlPgogICAgICAgIC5tYXAgewogICAgICAgICAgICB3aWR0aDogODAwcHg7CiAgICAgICAgICAgIGhlaWdodDogNjAwcHg7CiAgICAgICAgfQogICAgPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KICAgIDxkaXYgY2xhc3M9Im1hcCIgaWQ9Im1hcCI+PC9kaXY+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9kM2pzLm9yZy9kMy52Ni5taW4uanMiPjwvc2NyaXB0PgogICAgPHNjcmlwdCBzcmM9InNjcmlwdC5qcyI+PC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Choropleth Map&lt;/title&gt;
    &lt;style&gt;
        .map {
            width: 800px;
            height: 600px;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class=&quot;map&quot; id=&quot;map&quot;&gt;&lt;/div&gt;
    &lt;script src=&quot;https://d3js.org/d3.v6.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;script.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><div class='content'></div><h2>Step 2: Load GeoJSON Data</h2>
<div class='content'><p>In your <code>script.js</code> file, load the GeoJSON data for the geographical regions you want to display. For this example, we'll use a sample GeoJSON file for US states.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZDMuanNvbigncGF0aC90by91cy1zdGF0ZXMuanNvbicpLnRoZW4oZnVuY3Rpb24oZGF0YSkgewogICAgY29uc29sZS5sb2coZGF0YSk7Cn0pOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>d3.json('path/to/us-states.json').then(function(data) {
    console.log(data);
});</pre></div><div class='content'></div><h2>Step 3: Create an SVG Element</h2>
<div class='content'><p>Create an SVG element to hold the map:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3Qgd2lkdGggPSA4MDA7CmNvbnN0IGhlaWdodCA9IDYwMDsKCmNvbnN0IHN2ZyA9IGQzLnNlbGVjdCgiI21hcCIpCiAgICAuYXBwZW5kKCJzdmciKQogICAgLmF0dHIoIndpZHRoIiwgd2lkdGgpCiAgICAuYXR0cigiaGVpZ2h0IiwgaGVpZ2h0KTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const width = 800;
const height = 600;

const svg = d3.select(&quot;#map&quot;)
    .append(&quot;svg&quot;)
    .attr(&quot;width&quot;, width)
    .attr(&quot;height&quot;, height);</pre></div><div class='content'></div><h2>Step 4: Define a Projection and Path Generator</h2>
<div class='content'><p>Define a projection to convert geographical coordinates to screen coordinates and a path generator to draw the map:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgcHJvamVjdGlvbiA9IGQzLmdlb0FsYmVyc1VzYSgpCiAgICAudHJhbnNsYXRlKFt3aWR0aCAvIDIsIGhlaWdodCAvIDJdKQogICAgLnNjYWxlKDEwMDApOwoKY29uc3QgcGF0aCA9IGQzLmdlb1BhdGgoKQogICAgLnByb2plY3Rpb24ocHJvamVjdGlvbik7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const projection = d3.geoAlbersUsa()
    .translate([width / 2, height / 2])
    .scale(1000);

const path = d3.geoPath()
    .projection(projection);</pre></div><div class='content'></div><h2>Step 5: Draw the Map</h2>
<div class='content'><p>Use the GeoJSON data to draw the map:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZDMuanNvbigncGF0aC90by91cy1zdGF0ZXMuanNvbicpLnRoZW4oZnVuY3Rpb24oZGF0YSkgewogICAgc3ZnLnNlbGVjdEFsbCgicGF0aCIpCiAgICAgICAgLmRhdGEoZGF0YS5mZWF0dXJlcykKICAgICAgICAuZW50ZXIoKQogICAgICAgIC5hcHBlbmQoInBhdGgiKQogICAgICAgIC5hdHRyKCJkIiwgcGF0aCkKICAgICAgICAuYXR0cigiZmlsbCIsICIjY2NjIikKICAgICAgICAuYXR0cigic3Ryb2tlIiwgIiMzMzMiKTsKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>d3.json('path/to/us-states.json').then(function(data) {
    svg.selectAll(&quot;path&quot;)
        .data(data.features)
        .enter()
        .append(&quot;path&quot;)
        .attr(&quot;d&quot;, path)
        .attr(&quot;fill&quot;, &quot;#ccc&quot;)
        .attr(&quot;stroke&quot;, &quot;#333&quot;);
});</pre></div><div class='content'></div><h1>Adding Data to the Map</h1>
<div class='content'><p>To make the map more informative, we'll add data and use color scales to represent it.</p>
</div><h2>Step 1: Prepare the Data</h2>
<div class='content'><p>Assume we have a dataset that includes values for each state:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZGF0YSA9IFsKICAgIHsgc3RhdGU6ICdDYWxpZm9ybmlhJywgdmFsdWU6IDEwMCB9LAogICAgeyBzdGF0ZTogJ1RleGFzJywgdmFsdWU6IDgwIH0sCiAgICAvLyBBZGQgbW9yZSBkYXRhIGhlcmUKXTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const data = [
    { state: 'California', value: 100 },
    { state: 'Texas', value: 80 },
    // Add more data here
];</pre></div><div class='content'></div><h2>Step 2: Create a Color Scale</h2>
<div class='content'><p>Create a color scale to represent the data values:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgY29sb3JTY2FsZSA9IGQzLnNjYWxlUXVhbnRpemUoKQogICAgLmRvbWFpbihbMCwgMTAwXSkKICAgIC5yYW5nZShkMy5zY2hlbWVCbHVlc1s5XSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const colorScale = d3.scaleQuantize()
    .domain([0, 100])
    .range(d3.schemeBlues[9]);</pre></div><div class='content'></div><h2>Step 3: Merge Data with GeoJSON</h2>
<div class='content'><p>Merge the data with the GeoJSON features:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZDMuanNvbigncGF0aC90by91cy1zdGF0ZXMuanNvbicpLnRoZW4oZnVuY3Rpb24oZ2VvRGF0YSkgewogICAgZGF0YS5mb3JFYWNoKGQgPT4gewogICAgICAgIGNvbnN0IHN0YXRlID0gZ2VvRGF0YS5mZWF0dXJlcy5maW5kKGYgPT4gZi5wcm9wZXJ0aWVzLm5hbWUgPT09IGQuc3RhdGUpOwogICAgICAgIGlmIChzdGF0ZSkgewogICAgICAgICAgICBzdGF0ZS5wcm9wZXJ0aWVzLnZhbHVlID0gZC52YWx1ZTsKICAgICAgICB9CiAgICB9KTsKCiAgICBzdmcuc2VsZWN0QWxsKCJwYXRoIikKICAgICAgICAuZGF0YShnZW9EYXRhLmZlYXR1cmVzKQogICAgICAgIC5lbnRlcigpCiAgICAgICAgLmFwcGVuZCgicGF0aCIpCiAgICAgICAgLmF0dHIoImQiLCBwYXRoKQogICAgICAgIC5hdHRyKCJmaWxsIiwgZCA9PiBjb2xvclNjYWxlKGQucHJvcGVydGllcy52YWx1ZSkpCiAgICAgICAgLmF0dHIoInN0cm9rZSIsICIjMzMzIik7Cn0pOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>d3.json('path/to/us-states.json').then(function(geoData) {
    data.forEach(d =&gt; {
        const state = geoData.features.find(f =&gt; f.properties.name === d.state);
        if (state) {
            state.properties.value = d.value;
        }
    });

    svg.selectAll(&quot;path&quot;)
        .data(geoData.features)
        .enter()
        .append(&quot;path&quot;)
        .attr(&quot;d&quot;, path)
        .attr(&quot;fill&quot;, d =&gt; colorScale(d.properties.value))
        .attr(&quot;stroke&quot;, &quot;#333&quot;);
});</pre></div><div class='content'></div><h1>Advanced Features</h1>
<div class='content'><p>Enhance your choropleth map with interactive features and additional data visualization techniques.</p>
</div><h2>Tooltips</h2>
<div class='content'><p>Add tooltips to display data values when hovering over regions:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgdG9vbHRpcCA9IGQzLnNlbGVjdCgiYm9keSIpLmFwcGVuZCgiZGl2IikKICAgIC5hdHRyKCJjbGFzcyIsICJ0b29sdGlwIikKICAgIC5zdHlsZSgib3BhY2l0eSIsIDApOwoKc3ZnLnNlbGVjdEFsbCgicGF0aCIpCiAgICAub24oIm1vdXNlb3ZlciIsIGZ1bmN0aW9uKGV2ZW50LCBkKSB7CiAgICAgICAgdG9vbHRpcC50cmFuc2l0aW9uKCkKICAgICAgICAgICAgLmR1cmF0aW9uKDIwMCkKICAgICAgICAgICAgLnN0eWxlKCJvcGFjaXR5IiwgLjkpOwogICAgICAgIHRvb2x0aXAuaHRtbChkLnByb3BlcnRpZXMubmFtZSArICI8YnIvPiIgKyBkLnByb3BlcnRpZXMudmFsdWUpCiAgICAgICAgICAgIC5zdHlsZSgibGVmdCIsIChldmVudC5wYWdlWCArIDUpICsgInB4IikKICAgICAgICAgICAgLnN0eWxlKCJ0b3AiLCAoZXZlbnQucGFnZVkgLSAyOCkgKyAicHgiKTsKICAgIH0pCiAgICAub24oIm1vdXNlb3V0IiwgZnVuY3Rpb24oZCkgewogICAgICAgIHRvb2x0aXAudHJhbnNpdGlvbigpCiAgICAgICAgICAgIC5kdXJhdGlvbig1MDApCiAgICAgICAgICAgIC5zdHlsZSgib3BhY2l0eSIsIDApOwogICAgfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const tooltip = d3.select(&quot;body&quot;).append(&quot;div&quot;)
    .attr(&quot;class&quot;, &quot;tooltip&quot;)
    .style(&quot;opacity&quot;, 0);

svg.selectAll(&quot;path&quot;)
    .on(&quot;mouseover&quot;, function(event, d) {
        tooltip.transition()
            .duration(200)
            .style(&quot;opacity&quot;, .9);
        tooltip.html(d.properties.name + &quot;&lt;br/&gt;&quot; + d.properties.value)
            .style(&quot;left&quot;, (event.pageX + 5) + &quot;px&quot;)
            .style(&quot;top&quot;, (event.pageY - 28) + &quot;px&quot;);
    })
    .on(&quot;mouseout&quot;, function(d) {
        tooltip.transition()
            .duration(500)
            .style(&quot;opacity&quot;, 0);
    });</pre></div><div class='content'></div><h2>Legends</h2>
<div class='content'><p>Add a legend to explain the color scale:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgbGVnZW5kID0gc3ZnLmFwcGVuZCgiZyIpCiAgICAuYXR0cigiY2xhc3MiLCAibGVnZW5kIikKICAgIC5hdHRyKCJ0cmFuc2Zvcm0iLCAidHJhbnNsYXRlKDIwLDIwKSIpOwoKY29uc3QgbGVnZW5kU2NhbGUgPSBkMy5zY2FsZUxpbmVhcigpCiAgICAuZG9tYWluKFswLCAxMDBdKQogICAgLnJhbmdlKFswLCAzMDBdKTsKCmNvbnN0IGxlZ2VuZEF4aXMgPSBkMy5heGlzQm90dG9tKGxlZ2VuZFNjYWxlKQogICAgLnRpY2tzKDUpOwoKbGVnZW5kLnNlbGVjdEFsbCgicmVjdCIpCiAgICAuZGF0YShjb2xvclNjYWxlLnJhbmdlKCkubWFwKGNvbG9yID0+IHsKICAgICAgICBjb25zdCBkID0gY29sb3JTY2FsZS5pbnZlcnRFeHRlbnQoY29sb3IpOwogICAgICAgIGlmICghZFswXSkgZFswXSA9IGxlZ2VuZFNjYWxlLmRvbWFpbigpWzBdOwogICAgICAgIGlmICghZFsxXSkgZFsxXSA9IGxlZ2VuZFNjYWxlLmRvbWFpbigpWzFdOwogICAgICAgIHJldHVybiBkOwogICAgfSkpCiAgICAuZW50ZXIoKS5hcHBlbmQoInJlY3QiKQogICAgLmF0dHIoImhlaWdodCIsIDIwKQogICAgLmF0dHIoIngiLCBkID0+IGxlZ2VuZFNjYWxlKGRbMF0pKQogICAgLmF0dHIoIndpZHRoIiwgZCA9PiBsZWdlbmRTY2FsZShkWzFdKSAtIGxlZ2VuZFNjYWxlKGRbMF0pKQogICAgLmF0dHIoImZpbGwiLCBkID0+IGNvbG9yU2NhbGUoZFswXSkpOwoKbGVnZW5kLmFwcGVuZCgiZyIpCiAgICAuYXR0cigidHJhbnNmb3JtIiwgInRyYW5zbGF0ZSgwLDIwKSIpCiAgICAuY2FsbChsZWdlbmRBeGlzKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const legend = svg.append(&quot;g&quot;)
    .attr(&quot;class&quot;, &quot;legend&quot;)
    .attr(&quot;transform&quot;, &quot;translate(20,20)&quot;);

const legendScale = d3.scaleLinear()
    .domain([0, 100])
    .range([0, 300]);

const legendAxis = d3.axisBottom(legendScale)
    .ticks(5);

legend.selectAll(&quot;rect&quot;)
    .data(colorScale.range().map(color =&gt; {
        const d = colorScale.invertExtent(color);
        if (!d[0]) d[0] = legendScale.domain()[0];
        if (!d[1]) d[1] = legendScale.domain()[1];
        return d;
    }))
    .enter().append(&quot;rect&quot;)
    .attr(&quot;height&quot;, 20)
    .attr(&quot;x&quot;, d =&gt; legendScale(d[0]))
    .attr(&quot;width&quot;, d =&gt; legendScale(d[1]) - legendScale(d[0]))
    .attr(&quot;fill&quot;, d =&gt; colorScale(d[0]));

legend.append(&quot;g&quot;)
    .attr(&quot;transform&quot;, &quot;translate(0,20)&quot;)
    .call(legendAxis);</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Choropleth maps are a powerful tool for visualizing geographical data. By following the steps outlined in this guide, you can create informative and interactive maps using D3.js. As you become more comfortable with these techniques, you can explore additional features and customizations to enhance your maps further.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='force-layouts'>&#x25C4;Force Layouts</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Choropleth Maps in D3.js</a>
	</div>
	<div class='col-4 text-end'>
					<a href='heatmaps'>Heatmaps &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
