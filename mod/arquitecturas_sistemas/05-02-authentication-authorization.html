<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication and Authorization</title>

    <link rel="alternate" href="https://campusempresa.com/mod/arquitecturas_sistemas/05-02-autenticacion-autorizacion" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/arquitecturas_sistemas/05-02-autenticacio-autoritzacio" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/arquitecturas_sistemas/05-02-authentication-authorization" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=2" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/arquitecturas_sistemas/05-02-autenticacion-autorizacion" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/arquitecturas_sistemas/05-02-autenticacio-autoritzacio" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Programming Languages</a>
				 					<a href="/categ/frameworks">Frameworks and Libraries</a>
				 					<a href="/categ/tech-tools">Technical Tools</a>
				 					<a href="/categ/foundations">Theoretical Foundations</a>
				 					<a href="/categ/soft-skills">Social Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-01-security-principles' title="Security Principles">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Authentication and Authorization</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-03-data-protection' title="Data Protection">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1><p>Introduction</p>
</h1>
<div class='content'><p>Authentication and authorization are critical components of system security. They ensure that only legitimate users can access the system and that they can only perform actions they are permitted to. This section will cover the fundamental concepts, methods, and best practices for implementing robust authentication and authorization mechanisms in system architectures.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'></div><h2><p>Authentication</p>
</h2>
<div class='content'><p>Authentication is the process of verifying the identity of a user or system. It ensures that the entity requesting access is who they claim to be.</p>
<p><strong>Common Authentication Methods:</strong></p>
<ul>
<li><strong>Passwords:</strong> The most common method, where users provide a secret password.</li>
<li><strong>Multi-Factor Authentication (MFA):</strong> Combines two or more independent credentials (e.g., password and a one-time code sent to a mobile device).</li>
<li><strong>Biometric Authentication:</strong> Uses unique biological traits such as fingerprints or facial recognition.</li>
<li><strong>OAuth:</strong> An open standard for access delegation, commonly used for token-based authentication.</li>
</ul>
</div><h2><p>Authorization</p>
</h2>
<div class='content'><p>Authorization determines what an authenticated user is allowed to do. It ensures that users can only access resources and perform actions they are permitted to.</p>
<p><strong>Common Authorization Models:</strong></p>
<ul>
<li><strong>Role-Based Access Control (RBAC):</strong> Permissions are assigned to roles, and users are assigned roles.</li>
<li><strong>Attribute-Based Access Control (ABAC):</strong> Permissions are based on attributes (e.g., user attributes, resource attributes, and environmental conditions).</li>
<li><strong>Access Control Lists (ACLs):</strong> Lists that specify which users or system processes are granted access to objects and what operations are allowed.</li>
</ul>
</div><h1><p>Practical Examples</p>
</h1>
<div class='content'></div><h2><p>Example 1: Implementing Basic Authentication in a Web Application</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QsIGpzb25pZnksIG1ha2VfcmVzcG9uc2UKZnJvbSB3ZXJremV1Zy5zZWN1cml0eSBpbXBvcnQgZ2VuZXJhdGVfcGFzc3dvcmRfaGFzaCwgY2hlY2tfcGFzc3dvcmRfaGFzaAoKYXBwID0gRmxhc2soX19uYW1lX18pCgojIFNhbXBsZSB1c2VyIGRhdGEKdXNlcnMgPSB7CiAgICAidXNlcjEiOiBnZW5lcmF0ZV9wYXNzd29yZF9oYXNoKCJwYXNzd29yZDEyMyIpLAogICAgInVzZXIyIjogZ2VuZXJhdGVfcGFzc3dvcmRfaGFzaCgibXlzZWN1cmVwYXNzd29yZCIpCn0KCkBhcHAucm91dGUoJy9sb2dpbicsIG1ldGhvZHM9WydQT1NUJ10pCmRlZiBsb2dpbigpOgogICAgYXV0aCA9IHJlcXVlc3QuYXV0aG9yaXphdGlvbgogICAgaWYgbm90IGF1dGggb3Igbm90IGF1dGgudXNlcm5hbWUgb3Igbm90IGF1dGgucGFzc3dvcmQ6CiAgICAgICAgcmV0dXJuIG1ha2VfcmVzcG9uc2UoJ0NvdWxkIG5vdCB2ZXJpZnknLCA0MDEsIHsnV1dXLUF1dGhlbnRpY2F0ZSc6ICdCYXNpYyByZWFsbT0iTG9naW4gcmVxdWlyZWQhIid9KQoKICAgIHVzZXJfcGFzc3dvcmRfaGFzaCA9IHVzZXJzLmdldChhdXRoLnVzZXJuYW1lKQogICAgaWYgdXNlcl9wYXNzd29yZF9oYXNoIGFuZCBjaGVja19wYXNzd29yZF9oYXNoKHVzZXJfcGFzc3dvcmRfaGFzaCwgYXV0aC5wYXNzd29yZCk6CiAgICAgICAgcmV0dXJuIGpzb25pZnkoeydtZXNzYWdlJzogJ0xvZ2luIHN1Y2Nlc3NmdWwhJ30pCiAgICByZXR1cm4gbWFrZV9yZXNwb25zZSgnQ291bGQgbm90IHZlcmlmeScsIDQwMSwgeydXV1ctQXV0aGVudGljYXRlJzogJ0Jhc2ljIHJlYWxtPSJMb2dpbiByZXF1aXJlZCEiJ30pCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgYXBwLnJ1bihkZWJ1Zz1UcnVlKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, request, jsonify, make_response
from werkzeug.security import generate_password_hash, check_password_hash

app = Flask(__name__)

# Sample user data
users = {
    &quot;user1&quot;: generate_password_hash(&quot;password123&quot;),
    &quot;user2&quot;: generate_password_hash(&quot;mysecurepassword&quot;)
}

@app.route('/login', methods=['POST'])
def login():
    auth = request.authorization
    if not auth or not auth.username or not auth.password:
        return make_response('Could not verify', 401, {'WWW-Authenticate': 'Basic realm=&quot;Login required!&quot;'})

    user_password_hash = users.get(auth.username)
    if user_password_hash and check_password_hash(user_password_hash, auth.password):
        return jsonify({'message': 'Login successful!'})
    return make_response('Could not verify', 401, {'WWW-Authenticate': 'Basic realm=&quot;Login required!&quot;'})

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li>This Flask application demonstrates basic authentication.</li>
<li>User credentials are stored in a dictionary with hashed passwords.</li>
<li>The <code>/login</code> endpoint checks the provided username and password against the stored credentials.</li>
</ul>
</div><h2><p>Example 2: Implementing Role-Based Access Control (RBAC)</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QsIGpzb25pZnkKCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQoKIyBTYW1wbGUgdXNlciBkYXRhIHdpdGggcm9sZXMKdXNlcnMgPSB7CiAgICAiYWRtaW4iOiB7InBhc3N3b3JkIjogImFkbWlucGFzcyIsICJyb2xlIjogImFkbWluIn0sCiAgICAiZWRpdG9yIjogeyJwYXNzd29yZCI6ICJlZGl0b3JwYXNzIiwgInJvbGUiOiAiZWRpdG9yIn0sCiAgICAidmlld2VyIjogeyJwYXNzd29yZCI6ICJ2aWV3ZXJwYXNzIiwgInJvbGUiOiAidmlld2VyIn0KfQoKIyBTYW1wbGUgcm9sZSBwZXJtaXNzaW9ucwpwZXJtaXNzaW9ucyA9IHsKICAgICJhZG1pbiI6IFsiY3JlYXRlIiwgInJlYWQiLCAidXBkYXRlIiwgImRlbGV0ZSJdLAogICAgImVkaXRvciI6IFsiY3JlYXRlIiwgInJlYWQiLCAidXBkYXRlIl0sCiAgICAidmlld2VyIjogWyJyZWFkIl0KfQoKZGVmIGNoZWNrX3Blcm1pc3Npb25zKHJvbGUsIGFjdGlvbik6CiAgICByZXR1cm4gYWN0aW9uIGluIHBlcm1pc3Npb25zLmdldChyb2xlLCBbXSkKCkBhcHAucm91dGUoJy9wZXJmb3JtX2FjdGlvbicsIG1ldGhvZHM9WydQT1NUJ10pCmRlZiBwZXJmb3JtX2FjdGlvbigpOgogICAgYXV0aCA9IHJlcXVlc3QuYXV0aG9yaXphdGlvbgogICAgYWN0aW9uID0gcmVxdWVzdC5qc29uLmdldCgnYWN0aW9uJykKCiAgICBpZiBub3QgYXV0aCBvciBub3QgYXV0aC51c2VybmFtZSBvciBub3QgYXV0aC5wYXNzd29yZDoKICAgICAgICByZXR1cm4ganNvbmlmeSh7J21lc3NhZ2UnOiAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQhJ30pLCA0MDEKCiAgICB1c2VyID0gdXNlcnMuZ2V0KGF1dGgudXNlcm5hbWUpCiAgICBpZiB1c2VyIGFuZCB1c2VyWydwYXNzd29yZCddID09IGF1dGgucGFzc3dvcmQ6CiAgICAgICAgaWYgY2hlY2tfcGVybWlzc2lvbnModXNlclsncm9sZSddLCBhY3Rpb24pOgogICAgICAgICAgICByZXR1cm4ganNvbmlmeSh7J21lc3NhZ2UnOiBmJ0FjdGlvbiB7YWN0aW9ufSBwZXJmb3JtZWQgc3VjY2Vzc2Z1bGx5ISd9KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJldHVybiBqc29uaWZ5KHsnbWVzc2FnZSc6ICdQZXJtaXNzaW9uIGRlbmllZCEnfSksIDQwMwogICAgcmV0dXJuIGpzb25pZnkoeydtZXNzYWdlJzogJ0ludmFsaWQgY3JlZGVudGlhbHMhJ30pLCA0MDEKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBhcHAucnVuKGRlYnVnPVRydWUp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, request, jsonify

app = Flask(__name__)

# Sample user data with roles
users = {
    &quot;admin&quot;: {&quot;password&quot;: &quot;adminpass&quot;, &quot;role&quot;: &quot;admin&quot;},
    &quot;editor&quot;: {&quot;password&quot;: &quot;editorpass&quot;, &quot;role&quot;: &quot;editor&quot;},
    &quot;viewer&quot;: {&quot;password&quot;: &quot;viewerpass&quot;, &quot;role&quot;: &quot;viewer&quot;}
}

# Sample role permissions
permissions = {
    &quot;admin&quot;: [&quot;create&quot;, &quot;read&quot;, &quot;update&quot;, &quot;delete&quot;],
    &quot;editor&quot;: [&quot;create&quot;, &quot;read&quot;, &quot;update&quot;],
    &quot;viewer&quot;: [&quot;read&quot;]
}

def check_permissions(role, action):
    return action in permissions.get(role, [])

@app.route('/perform_action', methods=['POST'])
def perform_action():
    auth = request.authorization
    action = request.json.get('action')

    if not auth or not auth.username or not auth.password:
        return jsonify({'message': 'Authentication required!'}), 401

    user = users.get(auth.username)
    if user and user['password'] == auth.password:
        if check_permissions(user['role'], action):
            return jsonify({'message': f'Action {action} performed successfully!'})
        else:
            return jsonify({'message': 'Permission denied!'}), 403
    return jsonify({'message': 'Invalid credentials!'}), 401

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li>This Flask application demonstrates RBAC.</li>
<li>User credentials and roles are stored in a dictionary.</li>
<li>The <code>/perform_action</code> endpoint checks if the authenticated user has the required permissions to perform the requested action.</li>
</ul>
</div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Implement OAuth2 Authentication</p>
</h2>
<div class='content'><p><strong>Task:</strong>
Implement OAuth2 authentication in a web application using a library such as Flask-OAuthlib.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QsIGpzb25pZnkKZnJvbSBmbGFza19vYXV0aGxpYi5wcm92aWRlciBpbXBvcnQgT0F1dGgyUHJvdmlkZXIKCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQpvYXV0aCA9IE9BdXRoMlByb3ZpZGVyKGFwcCkKCiMgRGVmaW5lIHlvdXIgT0F1dGgyIGNsaWVudCBhbmQgdG9rZW4gc3RvcmFnZSBoZXJlCgpAYXBwLnJvdXRlKCcvb2F1dGgvdG9rZW4nLCBtZXRob2RzPVsnUE9TVCddKQpkZWYgYWNjZXNzX3Rva2VuKCk6CiAgICByZXR1cm4gb2F1dGguY3JlYXRlX3Rva2VuX3Jlc3BvbnNlKCkKCkBhcHAucm91dGUoJy9wcm90ZWN0ZWRfcmVzb3VyY2UnLCBtZXRob2RzPVsnR0VUJ10pCkBvYXV0aC5yZXF1aXJlX29hdXRoKCdlbWFpbCcpCmRlZiBwcm90ZWN0ZWRfcmVzb3VyY2UoKToKICAgIHJldHVybiBqc29uaWZ5KHsnbWVzc2FnZSc6ICdUaGlzIGlzIGEgcHJvdGVjdGVkIHJlc291cmNlJ30pCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgYXBwLnJ1bihkZWJ1Zz1UcnVlKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, request, jsonify
from flask_oauthlib.provider import OAuth2Provider

app = Flask(__name__)
oauth = OAuth2Provider(app)

# Define your OAuth2 client and token storage here

@app.route('/oauth/token', methods=['POST'])
def access_token():
    return oauth.create_token_response()

@app.route('/protected_resource', methods=['GET'])
@oauth.require_oauth('email')
def protected_resource():
    return jsonify({'message': 'This is a protected resource'})

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li>This example sets up an OAuth2 provider using Flask-OAuthlib.</li>
<li>The <code>/oauth/token</code> endpoint handles token creation.</li>
<li>The <code>/protected_resource</code> endpoint is protected and requires a valid OAuth2 token.</li>
</ul>
</div><h2><p>Exercise 2: Implement Attribute-Based Access Control (ABAC)</p>
</h2>
<div class='content'><p><strong>Task:</strong>
Implement ABAC in a web application where access is granted based on user attributes and resource attributes.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QsIGpzb25pZnkKCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQoKIyBTYW1wbGUgdXNlciBkYXRhIHdpdGggYXR0cmlidXRlcwp1c2VycyA9IHsKICAgICJ1c2VyMSI6IHsicGFzc3dvcmQiOiAicGFzc3dvcmQxMjMiLCAiYXR0cmlidXRlcyI6IHsiZGVwYXJ0bWVudCI6ICJzYWxlcyJ9fSwKICAgICJ1c2VyMiI6IHsicGFzc3dvcmQiOiAicGFzc3dvcmQ0NTYiLCAiYXR0cmlidXRlcyI6IHsiZGVwYXJ0bWVudCI6ICJlbmdpbmVlcmluZyJ9fQp9CgojIFNhbXBsZSByZXNvdXJjZSBkYXRhIHdpdGggYXR0cmlidXRlcwpyZXNvdXJjZXMgPSB7CiAgICAicmVzb3VyY2UxIjogeyJhdHRyaWJ1dGVzIjogeyJkZXBhcnRtZW50IjogInNhbGVzIn19LAogICAgInJlc291cmNlMiI6IHsiYXR0cmlidXRlcyI6IHsiZGVwYXJ0bWVudCI6ICJlbmdpbmVlcmluZyJ9fQp9CgpkZWYgY2hlY2tfYWNjZXNzKHVzZXJfYXR0cmlidXRlcywgcmVzb3VyY2VfYXR0cmlidXRlcyk6CiAgICByZXR1cm4gdXNlcl9hdHRyaWJ1dGVzLmdldCgiZGVwYXJ0bWVudCIpID09IHJlc291cmNlX2F0dHJpYnV0ZXMuZ2V0KCJkZXBhcnRtZW50IikKCkBhcHAucm91dGUoJy9hY2Nlc3NfcmVzb3VyY2UnLCBtZXRob2RzPVsnUE9TVCddKQpkZWYgYWNjZXNzX3Jlc291cmNlKCk6CiAgICBhdXRoID0gcmVxdWVzdC5hdXRob3JpemF0aW9uCiAgICByZXNvdXJjZV9pZCA9IHJlcXVlc3QuanNvbi5nZXQoJ3Jlc291cmNlX2lkJykKCiAgICBpZiBub3QgYXV0aCBvciBub3QgYXV0aC51c2VybmFtZSBvciBub3QgYXV0aC5wYXNzd29yZDoKICAgICAgICByZXR1cm4ganNvbmlmeSh7J21lc3NhZ2UnOiAnQXV0aGVudGljYXRpb24gcmVxdWlyZWQhJ30pLCA0MDEKCiAgICB1c2VyID0gdXNlcnMuZ2V0KGF1dGgudXNlcm5hbWUpCiAgICByZXNvdXJjZSA9IHJlc291cmNlcy5nZXQocmVzb3VyY2VfaWQpCgogICAgaWYgdXNlciBhbmQgdXNlclsncGFzc3dvcmQnXSA9PSBhdXRoLnBhc3N3b3JkOgogICAgICAgIGlmIGNoZWNrX2FjY2Vzcyh1c2VyWydhdHRyaWJ1dGVzJ10sIHJlc291cmNlWydhdHRyaWJ1dGVzJ10pOgogICAgICAgICAgICByZXR1cm4ganNvbmlmeSh7J21lc3NhZ2UnOiBmJ0FjY2VzcyB0byB7cmVzb3VyY2VfaWR9IGdyYW50ZWQhJ30pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmV0dXJuIGpzb25pZnkoeydtZXNzYWdlJzogJ0FjY2VzcyBkZW5pZWQhJ30pLCA0MDMKICAgIHJldHVybiBqc29uaWZ5KHsnbWVzc2FnZSc6ICdJbnZhbGlkIGNyZWRlbnRpYWxzISd9KSwgNDAxCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgYXBwLnJ1bihkZWJ1Zz1UcnVlKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, request, jsonify

app = Flask(__name__)

# Sample user data with attributes
users = {
    &quot;user1&quot;: {&quot;password&quot;: &quot;password123&quot;, &quot;attributes&quot;: {&quot;department&quot;: &quot;sales&quot;}},
    &quot;user2&quot;: {&quot;password&quot;: &quot;password456&quot;, &quot;attributes&quot;: {&quot;department&quot;: &quot;engineering&quot;}}
}

# Sample resource data with attributes
resources = {
    &quot;resource1&quot;: {&quot;attributes&quot;: {&quot;department&quot;: &quot;sales&quot;}},
    &quot;resource2&quot;: {&quot;attributes&quot;: {&quot;department&quot;: &quot;engineering&quot;}}
}

def check_access(user_attributes, resource_attributes):
    return user_attributes.get(&quot;department&quot;) == resource_attributes.get(&quot;department&quot;)

@app.route('/access_resource', methods=['POST'])
def access_resource():
    auth = request.authorization
    resource_id = request.json.get('resource_id')

    if not auth or not auth.username or not auth.password:
        return jsonify({'message': 'Authentication required!'}), 401

    user = users.get(auth.username)
    resource = resources.get(resource_id)

    if user and user['password'] == auth.password:
        if check_access(user['attributes'], resource['attributes']):
            return jsonify({'message': f'Access to {resource_id} granted!'})
        else:
            return jsonify({'message': 'Access denied!'}), 403
    return jsonify({'message': 'Invalid credentials!'}), 401

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li>This Flask application demonstrates ABAC.</li>
<li>User and resource attributes are stored in dictionaries.</li>
<li>The <code>/access_resource</code> endpoint checks if the user's attributes match the resource's attributes to grant access.</li>
</ul>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'></div><h2><p>Common Mistakes</p>
</h2>
<div class='content'><ul>
<li><strong>Weak Password Policies:</strong> Ensure that passwords are strong and follow best practices (e.g., minimum length, complexity requirements).</li>
<li><strong>Storing Plain Text Passwords:</strong> Always store passwords securely using hashing algorithms.</li>
<li><strong>Insufficient Logging:</strong> Implement logging for authentication and authorization events to detect and respond to security incidents.</li>
<li><strong>Overly Permissive Roles:</strong> Avoid assigning excessive permissions to roles; follow the principle of least privilege.</li>
</ul>
</div><h2><p>Tips</p>
</h2>
<div class='content'><ul>
<li><strong>Use Established Libraries:</strong> Utilize well-established libraries and frameworks for authentication and authorization to avoid common pitfalls.</li>
<li><strong>Regularly Review Permissions:</strong> Periodically review and update roles and permissions to ensure they align with current security policies.</li>
<li><strong>Implement MFA:</strong> Enhance security by implementing multi-factor authentication.</li>
<li><strong>Educate Users:</strong> Educate users about security best practices, such as recognizing phishing attempts and using strong passwords.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Authentication and authorization are fundamental to securing system architectures. By understanding and implementing robust authentication methods and authorization models, you can ensure that only legitimate users access your system and that they can only perform actions they are permitted to. This section has provided an overview of key concepts, practical examples, and exercises to help you implement effective authentication and authorization mechanisms in your systems.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-01-security-principles' title="Security Principles">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-03-data-protection' title="Data Protection">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
