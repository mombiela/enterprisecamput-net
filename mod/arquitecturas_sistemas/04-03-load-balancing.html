<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Load Balancing</title>

    <link rel="alternate" href="https://campusempresa.com/mod/arquitecturas_sistemas/04-03-balanceo-carga" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/arquitecturas_sistemas/04-03-balanceig-carrega" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/arquitecturas_sistemas/04-03-load-balancing" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/arquitecturas_sistemas/04-03-balanceo-carga" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/arquitecturas_sistemas/04-03-balanceig-carrega" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-02-performance-optimization' title="Performance Optimization">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Load Balancing</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-security-principles' title="Security Principles">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Load balancing is a critical concept in system architecture, especially when designing systems that need to handle high traffic and ensure high availability. This section will cover the principles, types, and practical implementations of load balancing.</p>
</div><h1><p>What is Load Balancing?</p>
</h1>
<div class='content'><p>Load balancing is the process of distributing network or application traffic across multiple servers. This ensures no single server bears too much demand, which can lead to performance degradation or failure. The primary goals of load balancing are:</p>
<ul>
<li><strong>Improved Performance</strong>: By distributing the load, the system can handle more requests efficiently.</li>
<li><strong>High Availability</strong>: Ensures that the system remains operational even if one or more servers fail.</li>
<li><strong>Scalability</strong>: Makes it easier to scale the system by adding more servers.</li>
</ul>
</div><h1><p>Types of Load Balancing</p>
</h1>
<div class='content'><p>There are several types of load balancing, each with its own use cases and advantages. The main types include:</p>
</div><h2><ol>
<li><strong>DNS Load Balancing</strong></li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Description</strong>: Uses DNS to distribute traffic by resolving a domain name to multiple IP addresses.</li>
<li><strong>Use Case</strong>: Simple and effective for distributing traffic geographically.</li>
<li><strong>Example</strong>: A global website with servers in different regions.</li>
</ul>
</div><h2><ol start="2">
<li><strong>Hardware Load Balancers</strong></li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Description</strong>: Dedicated hardware devices that distribute traffic across servers.</li>
<li><strong>Use Case</strong>: High-performance environments where low latency is critical.</li>
<li><strong>Example</strong>: Financial trading platforms.</li>
</ul>
</div><h2><ol start="3">
<li><strong>Software Load Balancers</strong></li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Description</strong>: Software solutions that run on standard servers to distribute traffic.</li>
<li><strong>Use Case</strong>: Flexible and cost-effective for most web applications.</li>
<li><strong>Example</strong>: Nginx, HAProxy.</li>
</ul>
</div><h2><ol start="4">
<li><strong>Application Load Balancers</strong></li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Description</strong>: Operate at the application layer (Layer 7) and can make routing decisions based on content.</li>
<li><strong>Use Case</strong>: Complex routing requirements, such as routing based on URL paths.</li>
<li><strong>Example</strong>: AWS Application Load Balancer.</li>
</ul>
</div><h2><ol start="5">
<li><strong>Network Load Balancers</strong></li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Description</strong>: Operate at the transport layer (Layer 4) and distribute traffic based on IP address and port.</li>
<li><strong>Use Case</strong>: High-performance applications requiring low latency.</li>
<li><strong>Example</strong>: AWS Network Load Balancer.</li>
</ul>
</div><h1><p>Load Balancing Algorithms</p>
</h1>
<div class='content'><p>Load balancers use various algorithms to decide how to distribute traffic. Some common algorithms include:</p>
</div><h2><ol>
<li><strong>Round Robin</strong></li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Description</strong>: Distributes requests sequentially across the servers.</li>
<li><strong>Use Case</strong>: Simple and effective for evenly distributed loads.</li>
<li><strong>Example</strong>: Server 1 gets the first request, Server 2 gets the second, and so on.</li>
</ul>
</div><h2><ol start="2">
<li><strong>Least Connections</strong></li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Description</strong>: Directs traffic to the server with the fewest active connections.</li>
<li><strong>Use Case</strong>: Useful when servers have varying capacities.</li>
<li><strong>Example</strong>: Server 1 has 5 connections, Server 2 has 3 connections; the next request goes to Server 2.</li>
</ul>
</div><h2><ol start="3">
<li><strong>IP Hash</strong></li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Description</strong>: Uses the client's IP address to determine which server will handle the request.</li>
<li><strong>Use Case</strong>: Ensures that the same client is always directed to the same server.</li>
<li><strong>Example</strong>: Client IP 192.168.1.1 always goes to Server 1.</li>
</ul>
</div><h2><ol start="4">
<li><strong>Weighted Round Robin</strong></li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Description</strong>: Similar to Round Robin but assigns a weight to each server based on its capacity.</li>
<li><strong>Use Case</strong>: Useful when servers have different processing capabilities.</li>
<li><strong>Example</strong>: Server 1 (weight 2) gets twice as many requests as Server 2 (weight 1).</li>
</ul>
</div><h1><p>Practical Example: Implementing Load Balancing with Nginx</p>
</h1>
<div class='content'><p>Nginx is a popular software load balancer. Below is an example of how to configure Nginx for load balancing:</p>
</div><h2><p>Configuration File (<code>nginx.conf</code>)</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICB1cHN0cmVhbSBteWFwcCB7CiAgICAgICAgc2VydmVyIGFwcDEuZXhhbXBsZS5jb207CiAgICAgICAgc2VydmVyIGFwcDIuZXhhbXBsZS5jb207CiAgICAgICAgc2VydmVyIGFwcDMuZXhhbXBsZS5jb207CiAgICB9CgogICAgc2VydmVyIHsKICAgICAgICBsaXN0ZW4gODA7CgogICAgICAgIGxvY2F0aW9uIC8gewogICAgICAgICAgICBwcm94eV9wYXNzIGh0dHA6Ly9teWFwcDsKICAgICAgICAgICAgcHJveHlfc2V0X2hlYWRlciBIb3N0ICRob3N0OwogICAgICAgICAgICBwcm94eV9zZXRfaGVhZGVyIFgtUmVhbC1JUCAkcmVtb3RlX2FkZHI7CiAgICAgICAgICAgIHByb3h5X3NldF9oZWFkZXIgWC1Gb3J3YXJkZWQtRm9yICRwcm94eV9hZGRfeF9mb3J3YXJkZWRfZm9yOwogICAgICAgICAgICBwcm94eV9zZXRfaGVhZGVyIFgtRm9yd2FyZGVkLVByb3RvICRzY2hlbWU7CiAgICAgICAgfQogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    upstream myapp {
        server app1.example.com;
        server app2.example.com;
        server app3.example.com;
    }

    server {
        listen 80;

        location / {
            proxy_pass http://myapp;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            proxy_set_header X-Forwarded-Proto $scheme;
        }
    }
}</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>upstream myapp</strong>: Defines a group of servers (app1, app2, app3) to distribute traffic.</li>
<li><strong>proxy_pass http://myapp</strong>: Forwards incoming requests to the defined upstream group.</li>
<li><strong>proxy_set_header</strong>: Sets various headers to pass along with the request.</li>
</ul>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Configure Load Balancing with HAProxy</p>
</h2>
<div class='content'><p><strong>Objective</strong>: Configure HAProxy to load balance traffic between three backend servers.</p>
</div><h2><p>Steps</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Install HAProxy</strong>:</p>
<pre><code class="language-bash">sudo apt-get install haproxy
</code></pre>
</li>
<li>
<p><strong>Edit the HAProxy Configuration File (<code>/etc/haproxy/haproxy.cfg</code>)</strong>:</p>
<pre><code class="language-haproxy">global
    log /dev/log local0
    log /dev/log local1 notice
    chroot /var/lib/haproxy
    stats socket /run/haproxy/admin.sock mode 660 level admin
    stats timeout 30s
    user haproxy
    group haproxy
    daemon

defaults
    log     global
    mode    http
    option  httplog
    option  dontlognull
    timeout connect 5000ms
    timeout client  50000ms
    timeout server  50000ms

frontend http_front
    bind *:80
    default_backend http_back

backend http_back
    balance roundrobin
    server server1 192.168.1.1:80 check
    server server2 192.168.1.2:80 check
    server server3 192.168.1.3:80 check
</code></pre>
</li>
<li>
<p><strong>Restart HAProxy</strong>:</p>
<pre><code class="language-bash">sudo systemctl restart haproxy
</code></pre>
</li>
</ol>
</div><h2><p>Solution Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>frontend http_front</strong>: Defines the front-end configuration, binding to port 80.</li>
<li><strong>backend http_back</strong>: Defines the backend servers and uses the Round Robin algorithm to distribute traffic.</li>
</ul>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Incorrect Configuration</strong>: Ensure the configuration files are correctly formatted and paths are accurate.</li>
<li><strong>Health Checks</strong>: Always configure health checks to ensure traffic is not sent to unhealthy servers.</li>
<li><strong>Monitoring</strong>: Implement monitoring to track the performance and health of your load balancers and backend servers.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Load balancing is essential for building robust and scalable systems. By understanding the different types of load balancers, algorithms, and practical implementations, you can ensure that your system can handle high traffic and remain highly available. In the next section, we will delve into security principles to protect your system architecture.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-02-performance-optimization' title="Performance Optimization">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-security-principles' title="Security Principles">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
