<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Optimization</title>

    <link rel="alternate" href="https://campusempresa.com/mod/ruby/08-03-performance-optimization" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/ruby/08-03-performance-optimization" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/ruby/08-03-performance-optimization" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/ruby/08-03-performance-optimization" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/ruby/08-03-performance-optimization" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='08-02-refactoring' title="Refactoring">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Performance Optimization</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='08-04-security-best-practices' title="Security Best Practices">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Performance optimization is a crucial aspect of software development, ensuring that your Ruby applications run efficiently and can handle the required load. In this section, we will cover various techniques and best practices to optimize the performance of your Ruby code.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Profiling and Benchmarking</strong></li>
<li><strong>Memory Management</strong></li>
<li><strong>Efficient Data Structures</strong></li>
<li><strong>Algorithm Optimization</strong></li>
<li><strong>Concurrency and Parallelism</strong></li>
<li><strong>Caching Strategies</strong></li>
<li><strong>Database Optimization</strong></li>
</ol>
</div><h1>Profiling and Benchmarking</h1>
<div class='content'></div><h2>Profiling</h2>
<div class='content'><p>Profiling helps identify which parts of your code are consuming the most resources. Ruby provides several tools for profiling:</p>
<ul>
<li><strong><code>ruby-prof</code></strong>: A fast code profiler for Ruby.</li>
<li><strong><code>stackprof</code></strong>: A sampling call-stack profiler for Ruby.</li>
</ul>
<h4>Example: Using <code>ruby-prof</code></h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cmVxdWlyZSAncnVieS1wcm9mJwoKUnVieVByb2Yuc3RhcnQKCiMgQ29kZSB0byBwcm9maWxlCmRlZiBzbG93X21ldGhvZAogIHNsZWVwKDIpCmVuZAoKc2xvd19tZXRob2QKCnJlc3VsdCA9IFJ1YnlQcm9mLnN0b3AKCiMgUHJpbnQgYSBmbGF0IHByb2ZpbGUgdG8gdGV4dApwcmludGVyID0gUnVieVByb2Y6OkZsYXRQcmludGVyLm5ldyhyZXN1bHQpCnByaW50ZXIucHJpbnQoU1RET1VUKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>require 'ruby-prof'

RubyProf.start

# Code to profile
def slow_method
  sleep(2)
end

slow_method

result = RubyProf.stop

# Print a flat profile to text
printer = RubyProf::FlatPrinter.new(result)
printer.print(STDOUT)</pre></div><div class='content'></div><h2>Benchmarking</h2>
<div class='content'><p>Benchmarking measures the time taken by code to execute. Ruby's <code>Benchmark</code> module is useful for this purpose.</p>
<h4>Example: Using <code>Benchmark</code></h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cmVxdWlyZSAnYmVuY2htYXJrJwoKdGltZSA9IEJlbmNobWFyay5tZWFzdXJlIGRvCiAgIyBDb2RlIHRvIGJlbmNobWFyawogIDEwMDAudGltZXMgeyAiSGVsbG8sIHdvcmxkISIucmV2ZXJzZSB9CmVuZAoKcHV0cyB0aW1l"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>require 'benchmark'

time = Benchmark.measure do
  # Code to benchmark
  1000.times { &quot;Hello, world!&quot;.reverse }
end

puts time</pre></div><div class='content'></div><h1>Memory Management</h1>
<div class='content'><p>Efficient memory management can significantly improve performance. Key strategies include:</p>
<ul>
<li><strong>Avoiding Memory Leaks</strong>: Ensure objects are properly garbage collected.</li>
<li><strong>Using Symbols Wisely</strong>: Symbols are not garbage collected, so use them judiciously.</li>
<li><strong>Optimizing Object Creation</strong>: Reuse objects when possible.</li>
</ul>
</div><h2>Example: Avoiding Memory Leaks</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbmVmZmljaWVudDogQ3JlYXRlcyBhIG5ldyBzdHJpbmcgb2JqZWN0IGVhY2ggdGltZQpkZWYgY3JlYXRlX3N0cmluZ3MKICAxMDAwLnRpbWVzIHsgInN0cmluZyIgfQplbmQKCiMgRWZmaWNpZW50OiBSZXVzZXMgdGhlIHNhbWUgc3RyaW5nIG9iamVjdApkZWYgY3JlYXRlX3N5bWJvbHMKICAxMDAwLnRpbWVzIHsgOnN5bWJvbCB9CmVuZA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Inefficient: Creates a new string object each time
def create_strings
  1000.times { &quot;string&quot; }
end

# Efficient: Reuses the same string object
def create_symbols
  1000.times { :symbol }
end</pre></div><div class='content'></div><h1>Efficient Data Structures</h1>
<div class='content'><p>Choosing the right data structure can greatly impact performance. For example, use arrays for ordered collections and hashes for key-value pairs.</p>
</div><h2>Example: Using Hashes for Fast Lookups</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbmVmZmljaWVudDogTGluZWFyIHNlYXJjaCBpbiBhbiBhcnJheQpkZWYgZmluZF9pbl9hcnJheShhcnIsIHZhbHVlKQogIGFyci5pbmNsdWRlPyh2YWx1ZSkKZW5kCgojIEVmZmljaWVudDogQ29uc3RhbnQgdGltZSBsb29rdXAgaW4gYSBoYXNoCmRlZiBmaW5kX2luX2hhc2goaGFzaCwga2V5KQogIGhhc2gua2V5PyhrZXkpCmVuZA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Inefficient: Linear search in an array
def find_in_array(arr, value)
  arr.include?(value)
end

# Efficient: Constant time lookup in a hash
def find_in_hash(hash, key)
  hash.key?(key)
end</pre></div><div class='content'></div><h1>Algorithm Optimization</h1>
<div class='content'><p>Optimizing algorithms can lead to significant performance gains. Focus on reducing time complexity.</p>
</div><h2>Example: Optimizing a Sorting Algorithm</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbmVmZmljaWVudDogQnViYmxlIHNvcnQgKE8obl4yKSkKZGVmIGJ1YmJsZV9zb3J0KGFycikKICBuID0gYXJyLmxlbmd0aAogIGxvb3AgZG8KICAgIHN3YXBwZWQgPSBmYWxzZQogICAgKG4tMSkudGltZXMgZG8gfGl8CiAgICAgIGlmIGFycltpXSA+IGFycltpKzFdCiAgICAgICAgYXJyW2ldLCBhcnJbaSsxXSA9IGFycltpKzFdLCBhcnJbaV0KICAgICAgICBzd2FwcGVkID0gdHJ1ZQogICAgICBlbmQKICAgIGVuZAogICAgYnJlYWsgdW5sZXNzIHN3YXBwZWQKICBlbmQKICBhcnIKZW5kCgojIEVmZmljaWVudDogUXVpY2sgc29ydCAoTyhuIGxvZyBuKSkKZGVmIHF1aWNrX3NvcnQoYXJyKQogIHJldHVybiBhcnIgaWYgYXJyLmxlbmd0aCA8PSAxCiAgcGl2b3QgPSBhcnIuZGVsZXRlX2F0KHJhbmQoYXJyLmxlbmd0aCkpCiAgbGVmdCwgcmlnaHQgPSBhcnIucGFydGl0aW9uIHsgfHh8IHggPCBwaXZvdCB9CiAgWypxdWlja19zb3J0KGxlZnQpLCBwaXZvdCwgKnF1aWNrX3NvcnQocmlnaHQpXQplbmQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Inefficient: Bubble sort (O(n^2))
def bubble_sort(arr)
  n = arr.length
  loop do
    swapped = false
    (n-1).times do |i|
      if arr[i] &gt; arr[i+1]
        arr[i], arr[i+1] = arr[i+1], arr[i]
        swapped = true
      end
    end
    break unless swapped
  end
  arr
end

# Efficient: Quick sort (O(n log n))
def quick_sort(arr)
  return arr if arr.length &lt;= 1
  pivot = arr.delete_at(rand(arr.length))
  left, right = arr.partition { |x| x &lt; pivot }
  [*quick_sort(left), pivot, *quick_sort(right)]
end</pre></div><div class='content'></div><h1>Concurrency and Parallelism</h1>
<div class='content'><p>Ruby supports concurrency and parallelism through threads and processes. Use these features to perform multiple tasks simultaneously.</p>
</div><h2>Example: Using Threads</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dGhyZWFkcyA9IFtdCgo1LnRpbWVzIGRvIHxpfAogIHRocmVhZHMgPDwgVGhyZWFkLm5ldyBkbwogICAgc2xlZXAoMSkKICAgIHB1dHMgIlRocmVhZCAje2l9IGNvbXBsZXRlZCIKICBlbmQKZW5kCgp0aHJlYWRzLmVhY2goJjpqb2luKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>threads = []

5.times do |i|
  threads &lt;&lt; Thread.new do
    sleep(1)
    puts &quot;Thread #{i} completed&quot;
  end
end

threads.each(&amp;:join)</pre></div><div class='content'></div><h1>Caching Strategies</h1>
<div class='content'><p>Caching can significantly reduce the time taken to retrieve frequently accessed data. Use in-memory caches like <code>Memcached</code> or <code>Redis</code>.</p>
</div><h2>Example: Using `Redis` for Caching</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cmVxdWlyZSAncmVkaXMnCgpyZWRpcyA9IFJlZGlzLm5ldwoKIyBDYWNoZSBhIHZhbHVlCnJlZGlzLnNldCgibXlfa2V5IiwgIm15X3ZhbHVlIikKCiMgUmV0cmlldmUgYSBjYWNoZWQgdmFsdWUKdmFsdWUgPSByZWRpcy5nZXQoIm15X2tleSIpCnB1dHMgdmFsdWU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>require 'redis'

redis = Redis.new

# Cache a value
redis.set(&quot;my_key&quot;, &quot;my_value&quot;)

# Retrieve a cached value
value = redis.get(&quot;my_key&quot;)
puts value</pre></div><div class='content'></div><h1>Database Optimization</h1>
<div class='content'><p>Optimizing database queries and schema can greatly improve performance. Use indexing, query optimization, and connection pooling.</p>
</div><h2>Example: Using Indexes in SQL</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gSW5lZmZpY2llbnQ6IEZ1bGwgdGFibGUgc2NhbgpTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGVtYWlsID0gJ2V4YW1wbGVAZXhhbXBsZS5jb20nOwoKLS0gRWZmaWNpZW50OiBVc2luZyBhbiBpbmRleApDUkVBVEUgSU5ERVggaW5kZXhfdXNlcnNfb25fZW1haWwgT04gdXNlcnMoZW1haWwpOwpTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGVtYWlsID0gJ2V4YW1wbGVAZXhhbXBsZS5jb20nOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Inefficient: Full table scan
SELECT * FROM users WHERE email = 'example@example.com';

-- Efficient: Using an index
CREATE INDEX index_users_on_email ON users(email);
SELECT * FROM users WHERE email = 'example@example.com';</pre></div><div class='content'></div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Profiling and Benchmarking</h2>
<div class='content'><p><strong>Task</strong>: Profile and benchmark the following code to identify performance bottlenecks.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIHNsb3dfbWV0aG9kCiAgc2xlZXAoMikKZW5kCgpkZWYgZmFzdF9tZXRob2QKICBzbGVlcCgwLjUpCmVuZAoKc2xvd19tZXRob2QKZmFzdF9tZXRob2Q="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def slow_method
  sleep(2)
end

def fast_method
  sleep(0.5)
end

slow_method
fast_method</pre></div><div class='content'><p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cmVxdWlyZSAncnVieS1wcm9mJwpyZXF1aXJlICdiZW5jaG1hcmsnCgojIFByb2ZpbGluZwpSdWJ5UHJvZi5zdGFydApzbG93X21ldGhvZApmYXN0X21ldGhvZApyZXN1bHQgPSBSdWJ5UHJvZi5zdG9wCnByaW50ZXIgPSBSdWJ5UHJvZjo6RmxhdFByaW50ZXIubmV3KHJlc3VsdCkKcHJpbnRlci5wcmludChTVERPVVQpCgojIEJlbmNobWFya2luZwp0aW1lID0gQmVuY2htYXJrLm1lYXN1cmUgZG8KICBzbG93X21ldGhvZAogIGZhc3RfbWV0aG9kCmVuZApwdXRzIHRpbWU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>require 'ruby-prof'
require 'benchmark'

# Profiling
RubyProf.start
slow_method
fast_method
result = RubyProf.stop
printer = RubyProf::FlatPrinter.new(result)
printer.print(STDOUT)

# Benchmarking
time = Benchmark.measure do
  slow_method
  fast_method
end
puts time</pre></div><div class='content'></div><h2>Exercise 2: Optimizing Data Structures</h2>
<div class='content'><p><strong>Task</strong>: Optimize the following code by choosing the appropriate data structure.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIGZpbmRfdmFsdWUoYXJyLCB2YWx1ZSkKICBhcnIuaW5jbHVkZT8odmFsdWUpCmVuZAoKYXJyID0gKDEuLjEwMDAwMDApLnRvX2EKcHV0cyBmaW5kX3ZhbHVlKGFyciwgOTk5OTk5KQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def find_value(arr, value)
  arr.include?(value)
end

arr = (1..1000000).to_a
puts find_value(arr, 999999)</pre></div><div class='content'><p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIGZpbmRfdmFsdWUoaGFzaCwga2V5KQogIGhhc2gua2V5PyhrZXkpCmVuZAoKaGFzaCA9ICgxLi4xMDAwMDAwKS50b19hLnRvX2ggeyB8aXwgW2ksIHRydWVdIH0KcHV0cyBmaW5kX3ZhbHVlKGhhc2gsIDk5OTk5OSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def find_value(hash, key)
  hash.key?(key)
end

hash = (1..1000000).to_a.to_h { |i| [i, true] }
puts find_value(hash, 999999)</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered various techniques to optimize the performance of Ruby applications, including profiling, memory management, efficient data structures, algorithm optimization, concurrency, caching, and database optimization. By applying these strategies, you can ensure that your Ruby applications run efficiently and handle the required load effectively.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='08-02-refactoring' title="Refactoring">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='08-04-security-best-practices' title="Security Best Practices">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
