<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Refactoring</title>

    <link rel="alternate" href="https://campusempresa.com/mod/ruby/08-02-refactoring" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/ruby/08-02-refactoring" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/ruby/08-02-refactoring" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/ruby/08-02-refactoring" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/ruby/08-02-refactoring" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='08-01-code-style-conventions' title="Code Style and Conventions">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Refactoring</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='08-03-performance-optimization' title="Performance Optimization">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Refactoring is the process of restructuring existing computer code without changing its external behavior. It aims to improve the nonfunctional attributes of the software, making it easier to understand, more maintainable, and more efficient. In this section, we will cover the key concepts, techniques, and best practices for refactoring Ruby code.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Code Smells</strong>: Indicators that there might be a problem in the code.</li>
<li><strong>Refactoring Techniques</strong>: Specific methods used to improve the code.</li>
<li><strong>Automated Tests</strong>: Ensuring that refactoring does not break existing functionality.</li>
</ol>
</div><h1>Code Smells</h1>
<div class='content'><p>Code smells are patterns in the code that may indicate deeper problems. Here are some common code smells:</p>
<ul>
<li><strong>Duplicated Code</strong>: Same code structure repeated in multiple places.</li>
<li><strong>Long Method</strong>: Methods that are too long and do too much.</li>
<li><strong>Large Class</strong>: Classes that have too many responsibilities.</li>
<li><strong>Feature Envy</strong>: A method that seems more interested in a class other than the one it is in.</li>
<li><strong>Data Clumps</strong>: Groups of data that are often passed together.</li>
</ul>
</div><h1>Refactoring Techniques</h1>
<div class='content'></div><h2>1. Extract Method</h2>
<div class='content'><p><strong>Problem</strong>: A method is too long or does too many things.</p>
<p><strong>Solution</strong>: Break the method into smaller, more focused methods.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBCZWZvcmUgUmVmYWN0b3JpbmcKZGVmIHByaW50X293aW5nCiAgb3V0c3RhbmRpbmcgPSAwLjAKICBwdXRzICIqIgogIHB1dHMgIiogQ3VzdG9tZXIgT3dlcyAqKioiCiAgcHV0cyAiKiIKICBAb3JkZXJzLmVhY2ggZG8gfG9yZGVyfAogICAgb3V0c3RhbmRpbmcgKz0gb3JkZXIuYW1vdW50CiAgZW5kCiAgcHV0cyAibmFtZTogI3tAbmFtZX0iCiAgcHV0cyAiYW1vdW50OiAje291dHN0YW5kaW5nfSIKZW5kCgojIEFmdGVyIFJlZmFjdG9yaW5nCmRlZiBwcmludF9vd2luZwogIHByaW50X2Jhbm5lcgogIG91dHN0YW5kaW5nID0gY2FsY3VsYXRlX291dHN0YW5kaW5nCiAgcHJpbnRfZGV0YWlscyhvdXRzdGFuZGluZykKZW5kCgpkZWYgcHJpbnRfYmFubmVyCiAgcHV0cyAiKiIKICBwdXRzICIqIEN1c3RvbWVyIE93ZXMgKioqIgogIHB1dHMgIioiCmVuZAoKZGVmIGNhbGN1bGF0ZV9vdXRzdGFuZGluZwogIEBvcmRlcnMucmVkdWNlKDAuMCkgeyB8c3VtLCBvcmRlcnwgc3VtICsgb3JkZXIuYW1vdW50IH0KZW5kCgpkZWYgcHJpbnRfZGV0YWlscyhvdXRzdGFuZGluZykKICBwdXRzICJuYW1lOiAje0BuYW1lfSIKICBwdXRzICJhbW91bnQ6ICN7b3V0c3RhbmRpbmd9IgplbmQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Before Refactoring
def print_owing
  outstanding = 0.0
  puts &quot;<strong></strong><strong></strong><strong></strong><strong></strong>*&quot;
  puts &quot;<strong>* Customer Owes </strong>***&quot;
  puts &quot;<strong></strong><strong></strong><strong></strong><strong></strong>*&quot;
  @orders.each do |order|
    outstanding += order.amount
  end
  puts &quot;name: #{@name}&quot;
  puts &quot;amount: #{outstanding}&quot;
end

# After Refactoring
def print_owing
  print_banner
  outstanding = calculate_outstanding
  print_details(outstanding)
end

def print_banner
  puts &quot;<strong></strong><strong></strong><strong></strong><strong></strong>*&quot;
  puts &quot;<strong>* Customer Owes </strong>***&quot;
  puts &quot;<strong></strong><strong></strong><strong></strong><strong></strong>*&quot;
end

def calculate_outstanding
  @orders.reduce(0.0) { |sum, order| sum + order.amount }
end

def print_details(outstanding)
  puts &quot;name: #{@name}&quot;
  puts &quot;amount: #{outstanding}&quot;
end</pre></div><div class='content'></div><h2>2. Inline Method</h2>
<div class='content'><p><strong>Problem</strong>: A method is not doing enough to justify its existence.</p>
<p><strong>Solution</strong>: Replace the method call with the method's content.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBCZWZvcmUgUmVmYWN0b3JpbmcKZGVmIGdldF9yYXRpbmcKICBtb3JlX3RoYW5fZml2ZV9sYXRlX2RlbGl2ZXJpZXMgPyAyIDogMQplbmQKCmRlZiBtb3JlX3RoYW5fZml2ZV9sYXRlX2RlbGl2ZXJpZXMKICBAbnVtYmVyX29mX2xhdGVfZGVsaXZlcmllcyA+IDUKZW5kCgojIEFmdGVyIFJlZmFjdG9yaW5nCmRlZiBnZXRfcmF0aW5nCiAgQG51bWJlcl9vZl9sYXRlX2RlbGl2ZXJpZXMgPiA1ID8gMiA6IDEKZW5k"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Before Refactoring
def get_rating
  more_than_five_late_deliveries ? 2 : 1
end

def more_than_five_late_deliveries
  @number_of_late_deliveries &gt; 5
end

# After Refactoring
def get_rating
  @number_of_late_deliveries &gt; 5 ? 2 : 1
end</pre></div><div class='content'></div><h2>3. Rename Method</h2>
<div class='content'><p><strong>Problem</strong>: A method name does not clearly describe what the method does.</p>
<p><strong>Solution</strong>: Rename the method to something more descriptive.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBCZWZvcmUgUmVmYWN0b3JpbmcKZGVmIGdldF9hbm51YWxfaW5jb21lCiAgIyBtZXRob2QgaW1wbGVtZW50YXRpb24KZW5kCgojIEFmdGVyIFJlZmFjdG9yaW5nCmRlZiBjYWxjdWxhdGVfYW5udWFsX2luY29tZQogICMgbWV0aG9kIGltcGxlbWVudGF0aW9uCmVuZA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Before Refactoring
def get_annual_income
  # method implementation
end

# After Refactoring
def calculate_annual_income
  # method implementation
end</pre></div><div class='content'></div><h2>4. Replace Temp with Query</h2>
<div class='content'><p><strong>Problem</strong>: A temporary variable is holding the result of an expression.</p>
<p><strong>Solution</strong>: Replace the variable with a method call.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBCZWZvcmUgUmVmYWN0b3JpbmcKYmFzZV9wcmljZSA9IHF1YW50aXR5ICogaXRlbV9wcmljZQppZiBiYXNlX3ByaWNlID4gMTAwMAogICMgZG8gc29tZXRoaW5nCmVuZAoKIyBBZnRlciBSZWZhY3RvcmluZwppZiBiYXNlX3ByaWNlID4gMTAwMAogICMgZG8gc29tZXRoaW5nCmVuZAoKZGVmIGJhc2VfcHJpY2UKICBxdWFudGl0eSAqIGl0ZW1fcHJpY2UKZW5k"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Before Refactoring
base_price = quantity * item_price
if base_price &gt; 1000
  # do something
end

# After Refactoring
if base_price &gt; 1000
  # do something
end

def base_price
  quantity * item_price
end</pre></div><div class='content'></div><h1>Automated Tests</h1>
<div class='content'><p>Before refactoring, it is crucial to have a comprehensive suite of automated tests. These tests ensure that the refactoring process does not introduce new bugs. Here are some steps to follow:</p>
<ol>
<li><strong>Write Tests</strong>: Ensure you have tests that cover the existing functionality.</li>
<li><strong>Run Tests</strong>: Run all tests to ensure they pass before refactoring.</li>
<li><strong>Refactor</strong>: Apply the refactoring techniques.</li>
<li><strong>Run Tests Again</strong>: Run all tests again to ensure no functionality is broken.</li>
</ol>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Refactor the Following Code</h2>
<div class='content'><p>Refactor the following code to improve its readability and maintainability.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgT3JkZXIKICBkZWYgaW5pdGlhbGl6ZShjdXN0b21lcikKICAgIEBjdXN0b21lciA9IGN1c3RvbWVyCiAgZW5kCgogIGRlZiBwcmludF9vcmRlcgogICAgcHV0cyAiT3JkZXIgZm9yICN7QGN1c3RvbWVyLm5hbWV9IgogICAgcHV0cyAiSXRlbXM6IgogICAgQGN1c3RvbWVyLm9yZGVycy5lYWNoIGRvIHxvcmRlcnwKICAgICAgcHV0cyAiI3tvcmRlci5pdGVtX25hbWV9OiAje29yZGVyLnByaWNlfSIKICAgIGVuZAogICAgdG90YWwgPSBAY3VzdG9tZXIub3JkZXJzLnJlZHVjZSgwKSB7IHxzdW0sIG9yZGVyfCBzdW0gKyBvcmRlci5wcmljZSB9CiAgICBwdXRzICJUb3RhbDogI3t0b3RhbH0iCiAgZW5kCmVuZA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Order
  def initialize(customer)
    @customer = customer
  end

  def print_order
    puts &quot;Order for #{@customer.name}&quot;
    puts &quot;Items:&quot;
    @customer.orders.each do |order|
      puts &quot;#{order.item_name}: #{order.price}&quot;
    end
    total = @customer.orders.reduce(0) { |sum, order| sum + order.price }
    puts &quot;Total: #{total}&quot;
  end
end</pre></div><div class='content'></div><h2>Solution</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgT3JkZXIKICBkZWYgaW5pdGlhbGl6ZShjdXN0b21lcikKICAgIEBjdXN0b21lciA9IGN1c3RvbWVyCiAgZW5kCgogIGRlZiBwcmludF9vcmRlcgogICAgcHJpbnRfaGVhZGVyCiAgICBwcmludF9pdGVtcwogICAgcHJpbnRfdG90YWwKICBlbmQKCiAgcHJpdmF0ZQoKICBkZWYgcHJpbnRfaGVhZGVyCiAgICBwdXRzICJPcmRlciBmb3IgI3tAY3VzdG9tZXIubmFtZX0iCiAgICBwdXRzICJJdGVtczoiCiAgZW5kCgogIGRlZiBwcmludF9pdGVtcwogICAgQGN1c3RvbWVyLm9yZGVycy5lYWNoIGRvIHxvcmRlcnwKICAgICAgcHV0cyAiI3tvcmRlci5pdGVtX25hbWV9OiAje29yZGVyLnByaWNlfSIKICAgIGVuZAogIGVuZAoKICBkZWYgcHJpbnRfdG90YWwKICAgIHRvdGFsID0gY2FsY3VsYXRlX3RvdGFsCiAgICBwdXRzICJUb3RhbDogI3t0b3RhbH0iCiAgZW5kCgogIGRlZiBjYWxjdWxhdGVfdG90YWwKICAgIEBjdXN0b21lci5vcmRlcnMucmVkdWNlKDApIHsgfHN1bSwgb3JkZXJ8IHN1bSArIG9yZGVyLnByaWNlIH0KICBlbmQKZW5k"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Order
  def initialize(customer)
    @customer = customer
  end

  def print_order
    print_header
    print_items
    print_total
  end

  private

  def print_header
    puts &quot;Order for #{@customer.name}&quot;
    puts &quot;Items:&quot;
  end

  def print_items
    @customer.orders.each do |order|
      puts &quot;#{order.item_name}: #{order.price}&quot;
    end
  end

  def print_total
    total = calculate_total
    puts &quot;Total: #{total}&quot;
  end

  def calculate_total
    @customer.orders.reduce(0) { |sum, order| sum + order.price }
  end
end</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Refactoring is an essential skill for maintaining and improving the quality of your code. By identifying code smells and applying appropriate refactoring techniques, you can make your code more readable, maintainable, and efficient. Always ensure you have a robust suite of automated tests to safeguard against introducing new bugs during the refactoring process.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='08-01-code-style-conventions' title="Code Style and Conventions">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='08-03-performance-optimization' title="Performance Optimization">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
