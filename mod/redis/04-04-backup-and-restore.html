<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backup and Restore</title>

    <link rel="alternate" href="https://campusempresa.com/mod/redis/04-04-backup-and-restore" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/redis/04-04-backup-and-restore" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/redis/04-04-backup-and-restore" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/redis/04-04-backup-and-restore" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/redis/04-04-backup-and-restore" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-03-persistence-configuration' title="Persistence Configuration">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Backup and Restore</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-authentication' title="Authentication">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will cover the essential concepts and practical steps for backing up and restoring Redis data. Ensuring data persistence and recoverability is crucial for maintaining the integrity and availability of your Redis instances.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Backup</strong>: The process of creating a copy of your Redis data that can be used to restore the data in case of failure or data loss.</li>
<li><strong>Restore</strong>: The process of loading data from a backup into a Redis instance to recover from data loss or corruption.</li>
</ol>
</div><h1>Types of Backups</h1>
<div class='content'><p>Redis supports two primary methods for creating backups:</p>
<ol>
<li><strong>Snapshots (RDB)</strong>: A point-in-time snapshot of the dataset.</li>
<li><strong>Append-Only Files (AOF)</strong>: A log of all write operations received by the server.</li>
</ol>
</div><h1>Creating Backups</h1>
<div class='content'></div><h2>Snapshots (RDB)</h2>
<div class='content'><p>Redis can create snapshots of the dataset at specified intervals. These snapshots are stored in RDB files.</p>
<h4>Manual Snapshot Creation</h4>
<p>You can manually create a snapshot using the <code>SAVE</code> or <code>BGSAVE</code> commands.</p>
<ul>
<li><code>SAVE</code>: Blocks the server until the snapshot is created.</li>
<li><code>BGSAVE</code>: Creates the snapshot in the background, allowing the server to continue processing commands.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBzbmFwc2hvdCB1c2luZyBTQVZFClNBVkUKCiMgQ3JlYXRlIGEgc25hcHNob3QgdXNpbmcgQkdTQVZFCkJHU0FWRQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a snapshot using SAVE
SAVE

# Create a snapshot using BGSAVE
BGSAVE</pre></div><div class='content'><h4>Automatic Snapshot Creation</h4>
<p>You can configure Redis to create snapshots automatically by setting the <code>save</code> configuration directive in the <code>redis.conf</code> file.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTYXZlIHRoZSBkYXRhc2V0IGV2ZXJ5IDYwIHNlY29uZHMgaWYgYXQgbGVhc3QgMTAwMCBrZXlzIGhhdmUgY2hhbmdlZApzYXZlIDYwIDEwMDA="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Save the dataset every 60 seconds if at least 1000 keys have changed
save 60 1000</pre></div><div class='content'></div><h2>Append-Only Files (AOF)</h2>
<div class='content'><p>AOF logs every write operation received by the server. This log can be used to reconstruct the dataset.</p>
<h4>Enabling AOF</h4>
<p>To enable AOF, set the <code>appendonly</code> directive to <code>yes</code> in the <code>redis.conf</code> file.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwZW5kb25seSB5ZXM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>appendonly yes</pre></div><div class='content'><h4>Manual AOF Rewrite</h4>
<p>You can manually trigger an AOF rewrite using the <code>BGREWRITEAOF</code> command.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBUcmlnZ2VyIGFuIEFPRiByZXdyaXRlCkJHUkVXUklURUFPRg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Trigger an AOF rewrite
BGREWRITEAOF</pre></div><div class='content'></div><h1>Restoring Data</h1>
<div class='content'></div><h2>Restoring from RDB Snapshot</h2>
<div class='content'><p>To restore data from an RDB snapshot, follow these steps:</p>
<ol>
<li><strong>Stop the Redis server</strong>: Ensure the server is not running to avoid data corruption.</li>
<li><strong>Replace the current RDB file</strong>: Copy the backup RDB file to the Redis data directory, typically <code>/var/lib/redis</code>.</li>
<li><strong>Start the Redis server</strong>: Restart the server to load the data from the RDB file.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTdG9wIHRoZSBSZWRpcyBzZXJ2ZXIKc3VkbyBzeXN0ZW1jdGwgc3RvcCByZWRpcwoKIyBSZXBsYWNlIHRoZSBjdXJyZW50IFJEQiBmaWxlIHdpdGggdGhlIGJhY2t1cApzdWRvIGNwIC9wYXRoL3RvL2JhY2t1cC9kdW1wLnJkYiAvdmFyL2xpYi9yZWRpcy9kdW1wLnJkYgoKIyBTdGFydCB0aGUgUmVkaXMgc2VydmVyCnN1ZG8gc3lzdGVtY3RsIHN0YXJ0IHJlZGlz"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Stop the Redis server
sudo systemctl stop redis

# Replace the current RDB file with the backup
sudo cp /path/to/backup/dump.rdb /var/lib/redis/dump.rdb

# Start the Redis server
sudo systemctl start redis</pre></div><div class='content'></div><h2>Restoring from AOF</h2>
<div class='content'><p>To restore data from an AOF file, follow these steps:</p>
<ol>
<li><strong>Stop the Redis server</strong>: Ensure the server is not running to avoid data corruption.</li>
<li><strong>Replace the current AOF file</strong>: Copy the backup AOF file to the Redis data directory, typically <code>/var/lib/redis</code>.</li>
<li><strong>Start the Redis server</strong>: Restart the server to load the data from the AOF file.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTdG9wIHRoZSBSZWRpcyBzZXJ2ZXIKc3VkbyBzeXN0ZW1jdGwgc3RvcCByZWRpcwoKIyBSZXBsYWNlIHRoZSBjdXJyZW50IEFPRiBmaWxlIHdpdGggdGhlIGJhY2t1cApzdWRvIGNwIC9wYXRoL3RvL2JhY2t1cC9hcHBlbmRvbmx5LmFvZiAvdmFyL2xpYi9yZWRpcy9hcHBlbmRvbmx5LmFvZgoKIyBTdGFydCB0aGUgUmVkaXMgc2VydmVyCnN1ZG8gc3lzdGVtY3RsIHN0YXJ0IHJlZGlz"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Stop the Redis server
sudo systemctl stop redis

# Replace the current AOF file with the backup
sudo cp /path/to/backup/appendonly.aof /var/lib/redis/appendonly.aof

# Start the Redis server
sudo systemctl start redis</pre></div><div class='content'></div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Backup and Restore Using RDB</h2>
<div class='content'><ol>
<li><strong>Create a snapshot</strong>: Use the <code>BGSAVE</code> command to create a snapshot of your current dataset.</li>
<li><strong>Simulate data loss</strong>: Delete some keys from your dataset.</li>
<li><strong>Restore the snapshot</strong>: Stop the Redis server, replace the RDB file with the backup, and restart the server.</li>
</ol>
<h4>Solution</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTdGVwIDE6IENyZWF0ZSBhIHNuYXBzaG90CkJHU0FWRQoKIyBTdGVwIDI6IFNpbXVsYXRlIGRhdGEgbG9zcwpERUwga2V5MSBrZXkyIGtleTMKCiMgU3RlcCAzOiBSZXN0b3JlIHRoZSBzbmFwc2hvdApzdWRvIHN5c3RlbWN0bCBzdG9wIHJlZGlzCnN1ZG8gY3AgL3BhdGgvdG8vYmFja3VwL2R1bXAucmRiIC92YXIvbGliL3JlZGlzL2R1bXAucmRiCnN1ZG8gc3lzdGVtY3RsIHN0YXJ0IHJlZGlz"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Step 1: Create a snapshot
BGSAVE

# Step 2: Simulate data loss
DEL key1 key2 key3

# Step 3: Restore the snapshot
sudo systemctl stop redis
sudo cp /path/to/backup/dump.rdb /var/lib/redis/dump.rdb
sudo systemctl start redis</pre></div><div class='content'></div><h1>Summary</h1>
<div class='content'><p>In this section, we covered the essential concepts and practical steps for backing up and restoring Redis data using RDB snapshots and AOF files. We discussed how to create backups manually and automatically, and how to restore data from these backups. By following these practices, you can ensure the integrity and availability of your Redis data.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-03-persistence-configuration' title="Persistence Configuration">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-authentication' title="Authentication">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
