<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sentinel in Redis</title>

    <link rel="alternate" href="https://campusempresa.com/mod/redis/sentinel" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/redis/sentinel" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/redis/sentinel" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/redis/sentinel" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/redis/sentinel" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='replication'>&#x25C4;Replication</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Sentinel in Redis</a>
	</div>
	<div class='col-4 text-end'>
					<a href='cluster-mode'>Cluster Mode &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Redis Sentinel is a system designed to help manage Redis instances, providing high availability and monitoring capabilities. This topic will cover the basics of Sentinel, its configuration, and how to use it to ensure your Redis instances are resilient and highly available.</p>
</div><h1>Introduction to Redis Sentinel</h1>
<div class='content'><p>Redis Sentinel provides several key features:</p>
<ul>
<li><strong>Monitoring</strong>: Sentinel constantly checks if your master and replica instances are working as expected.</li>
<li><strong>Notification</strong>: Sentinel can notify the system administrators or other systems via an API when something is wrong with one of the monitored Redis instances.</li>
<li><strong>Automatic Failover</strong>: If a master is not working as expected, Sentinel can start a failover process where a replica is promoted to master.</li>
<li><strong>Configuration Provider</strong>: Sentinel acts as a source of authority for clients to discover the current master and replicas.</li>
</ul>
</div><h1>Setting Up Redis Sentinel</h1>
<div class='content'><p>To set up Redis Sentinel, you need to configure Sentinel instances and ensure they can communicate with each other and the Redis instances they are monitoring.</p>
</div><h2>Sentinel Configuration File</h2>
<div class='content'><p>A typical Sentinel configuration file (<code>sentinel.conf</code>) includes the following key settings:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlIHNlbnRpbmVsLmNvbmYKCiMgTmFtZSBvZiB0aGUgbW9uaXRvcmVkIG1hc3RlcgpzZW50aW5lbCBtb25pdG9yIG15bWFzdGVyIDEyNy4wLjAuMSA2Mzc5IDIKCiMgQXV0aGVudGljYXRpb24gZm9yIHRoZSBtYXN0ZXIKc2VudGluZWwgYXV0aC1wYXNzIG15bWFzdGVyIHlvdXJfcGFzc3dvcmQKCiMgSG93IG9mdGVuIHRvIHBpbmcgdGhlIG1hc3RlciBhbmQgcmVwbGljYXMKc2VudGluZWwgZG93bi1hZnRlci1taWxsaXNlY29uZHMgbXltYXN0ZXIgNTAwMAoKIyBIb3cgbG9uZyB0byB3YWl0IGJlZm9yZSBmYWlsaW5nIG92ZXIKc2VudGluZWwgZmFpbG92ZXItdGltZW91dCBteW1hc3RlciA2MDAwMAoKIyBOdW1iZXIgb2YgcmVwbGljYXMgdG8gcmVjb25maWd1cmUgYWZ0ZXIgYSBmYWlsb3ZlcgpzZW50aW5lbCBwYXJhbGxlbC1zeW5jcyBteW1hc3RlciAx"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example sentinel.conf

# Name of the monitored master
sentinel monitor mymaster 127.0.0.1 6379 2

# Authentication for the master
sentinel auth-pass mymaster your_password

# How often to ping the master and replicas
sentinel down-after-milliseconds mymaster 5000

# How long to wait before failing over
sentinel failover-timeout mymaster 60000

# Number of replicas to reconfigure after a failover
sentinel parallel-syncs mymaster 1</pre></div><div class='content'><ul>
<li><code>sentinel monitor &lt;master-name&gt; &lt;ip&gt; &lt;port&gt; &lt;quorum&gt;</code>: Defines the master to monitor. The quorum is the number of Sentinels that need to agree before a failover is initiated.</li>
<li><code>sentinel auth-pass &lt;master-name&gt; &lt;password&gt;</code>: Sets the password for authenticating with the master.</li>
<li><code>sentinel down-after-milliseconds &lt;master-name&gt; &lt;milliseconds&gt;</code>: Time to wait before considering the master as down.</li>
<li><code>sentinel failover-timeout &lt;master-name&gt; &lt;milliseconds&gt;</code>: Time to wait before starting a new failover.</li>
<li><code>sentinel parallel-syncs &lt;master-name&gt; &lt;number&gt;</code>: Number of replicas to reconfigure in parallel during a failover.</li>
</ul>
</div><h2>Running Sentinel</h2>
<div class='content'><p>To start a Sentinel instance, use the following command:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cmVkaXMtc2VydmVyIC9wYXRoL3RvL3NlbnRpbmVsLmNvbmYgLS1zZW50aW5lbA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>redis-server /path/to/sentinel.conf --sentinel</pre></div><div class='content'></div><h1>Monitoring and Notification</h1>
<div class='content'><p>Sentinel continuously monitors the health of the Redis instances. If a master instance is deemed to be down, Sentinel will notify the administrators and other systems configured to receive notifications.</p>
</div><h2>Example of Monitoring</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTZW50aW5lbCBsb2cgb3V0cHV0ClsxMjM0NV0gMDEgSmFuIDAxOjAwOjAwLjAwMCAqICttb25pdG9yIG1hc3RlciBteW1hc3RlciAxMjcuMC4wLjEgNjM3OSBxdW9ydW0gMgpbMTIzNDVdIDAxIEphbiAwMTowMDowNS4wMDAgKiArc2Rvd24gbWFzdGVyIG15bWFzdGVyIDEyNy4wLjAuMSA2Mzc5ClsxMjM0NV0gMDEgSmFuIDAxOjAwOjEwLjAwMCAqICtvZG93biBtYXN0ZXIgbXltYXN0ZXIgMTI3LjAuMC4xIDYzNzkgI3F1b3J1bSAyClsxMjM0NV0gMDEgSmFuIDAxOjAwOjE1LjAwMCAqICtuZXctZXBvY2ggMQpbMTIzNDVdIDAxIEphbiAwMTowMDoyMC4wMDAgKiArdHJ5LWZhaWxvdmVyIG1hc3RlciBteW1hc3RlciAxMjcuMC4wLjEgNjM3OQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Sentinel log output
[12345] 01 Jan 01:00:00.000 * +monitor master mymaster 127.0.0.1 6379 quorum 2
[12345] 01 Jan 01:00:05.000 * +sdown master mymaster 127.0.0.1 6379
[12345] 01 Jan 01:00:10.000 * +odown master mymaster 127.0.0.1 6379 #quorum 2
[12345] 01 Jan 01:00:15.000 * +new-epoch 1
[12345] 01 Jan 01:00:20.000 * +try-failover master mymaster 127.0.0.1 6379</pre></div><div class='content'></div><h1>Automatic Failover</h1>
<div class='content'><p>When a master is considered down, Sentinel will initiate a failover process. This involves promoting one of the replicas to master and reconfiguring the other replicas to replicate from the new master.</p>
</div><h2>Example of Failover</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTZW50aW5lbCBsb2cgb3V0cHV0IGR1cmluZyBmYWlsb3ZlcgpbMTIzNDVdIDAxIEphbiAwMTowMDoyMC4wMDAgKiArZmFpbG92ZXItc3RhdGUtc2VsZWN0LXNsYXZlIG1hc3RlciBteW1hc3RlciAxMjcuMC4wLjEgNjM3OQpbMTIzNDVdIDAxIEphbiAwMTowMDoyNS4wMDAgKiArc2VsZWN0ZWQtc2xhdmUgc2xhdmUgMTI3LjAuMC4xOjYzODAKWzEyMzQ1XSAwMSBKYW4gMDE6MDA6MzAuMDAwICogK2ZhaWxvdmVyLXN0YXRlLXNlbmQtc2xhdmVvZi1ub29uZSBzbGF2ZSAxMjcuMC4wLjE6NjM4MApbMTIzNDVdIDAxIEphbiAwMTowMDozNS4wMDAgKiArZmFpbG92ZXItZW5kIG1hc3RlciBteW1hc3RlciAxMjcuMC4wLjEgNjM3OQpbMTIzNDVdIDAxIEphbiAwMTowMDo0MC4wMDAgKiArc3dpdGNoLW1hc3RlciBteW1hc3RlciAxMjcuMC4wLjEgNjM3OSAxMjcuMC4wLjEgNjM4MA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Sentinel log output during failover
[12345] 01 Jan 01:00:20.000 * +failover-state-select-slave master mymaster 127.0.0.1 6379
[12345] 01 Jan 01:00:25.000 * +selected-slave slave 127.0.0.1:6380
[12345] 01 Jan 01:00:30.000 * +failover-state-send-slaveof-noone slave 127.0.0.1:6380
[12345] 01 Jan 01:00:35.000 * +failover-end master mymaster 127.0.0.1 6379
[12345] 01 Jan 01:00:40.000 * +switch-master mymaster 127.0.0.1 6379 127.0.0.1 6380</pre></div><div class='content'></div><h1>Configuration Provider</h1>
<div class='content'><p>Clients can use Sentinel to discover the current master and replicas. This is particularly useful for applications that need to connect to the master for write operations and replicas for read operations.</p>
</div><h2>Example of Using Sentinel to Discover Master</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHJlZGlzCmZyb20gcmVkaXMuc2VudGluZWwgaW1wb3J0IFNlbnRpbmVsCgpzZW50aW5lbCA9IFNlbnRpbmVsKFsoJ2xvY2FsaG9zdCcsIDI2Mzc5KV0sIHNvY2tldF90aW1lb3V0PTAuMSkKbWFzdGVyID0gc2VudGluZWwubWFzdGVyX2ZvcignbXltYXN0ZXInLCBzb2NrZXRfdGltZW91dD0wLjEpCnNsYXZlID0gc2VudGluZWwuc2xhdmVfZm9yKCdteW1hc3RlcicsIHNvY2tldF90aW1lb3V0PTAuMSkKCiMgV3JpdGUgdG8gbWFzdGVyCm1hc3Rlci5zZXQoJ2ZvbycsICdiYXInKQoKIyBSZWFkIGZyb20gc2xhdmUKcHJpbnQoc2xhdmUuZ2V0KCdmb28nKSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import redis
from redis.sentinel import Sentinel

sentinel = Sentinel([('localhost', 26379)], socket_timeout=0.1)
master = sentinel.master_for('mymaster', socket_timeout=0.1)
slave = sentinel.slave_for('mymaster', socket_timeout=0.1)

# Write to master
master.set('foo', 'bar')

# Read from slave
print(slave.get('foo'))</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Redis Sentinel is a powerful tool for ensuring high availability and monitoring of Redis instances. By understanding its configuration and capabilities, you can set up a resilient Redis environment that can handle failures gracefully. Sentinel's ability to monitor, notify, and automatically failover makes it an essential component for any production Redis deployment.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='replication'>&#x25C4;Replication</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Sentinel in Redis</a>
	</div>
	<div class='col-4 text-end'>
					<a href='cluster-mode'>Cluster Mode &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
