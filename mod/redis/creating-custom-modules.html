<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creating Custom Modules</title>

    <link rel="alternate" href="https://campusempresa.com/mod/redis/creating-custom-modules" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/redis/creating-custom-modules" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/redis/creating-custom-modules" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/redis/creating-custom-modules" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/redis/creating-custom-modules" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='popular-redis-modules'>&#x25C4;Popular Redis Modules</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Creating Custom Modules</a>
	</div>
	<div class='col-4 text-end'>
					<a href='caching'>Caching &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Redis Modules</h1>
<div class='content'><p>Redis modules extend the functionality of Redis by allowing developers to add new commands and data types. This section will cover the basics of Redis modules, their purpose, and how they can be used to enhance Redis capabilities.</p>
<ul>
<li><strong>Purpose of Redis Modules</strong>: Extend Redis with custom commands and data structures.</li>
<li><strong>Use Cases</strong>: Custom analytics, specialized data processing, and domain-specific functionalities.</li>
</ul>
</div><h1>Setting Up the Development Environment</h1>
<div class='content'><p>Before creating custom modules, you need to set up your development environment.</p>
<ul>
<li><strong>Prerequisites</strong>:
<ul>
<li>Redis server installed.</li>
<li>Development tools: C compiler (e.g., GCC), make, and Redis source code.</li>
</ul>
</li>
</ul>
</div><h2>Example: Installing Prerequisites on Ubuntu</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3VkbyBhcHQtZ2V0IHVwZGF0ZQpzdWRvIGFwdC1nZXQgaW5zdGFsbCBidWlsZC1lc3NlbnRpYWwgdGNsCnN1ZG8gYXB0LWdldCBpbnN0YWxsIHJlZGlzLXNlcnZlcg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sudo apt-get update
sudo apt-get install build-essential tcl
sudo apt-get install redis-server</pre></div><div class='content'></div><h1>Creating a Simple Redis Module</h1>
<div class='content'><p>This section will guide you through creating a simple Redis module that adds a custom command.</p>
</div><h2>Step 1: Create the Module File</h2>
<div class='content'><p>Create a new file named <code>mymodule.c</code>.</p>
</div><h2>Step 2: Include Necessary Headers</h2>
<div class='content'><p>Include the Redis module API header.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I2luY2x1ZGUgInJlZGlzbW9kdWxlLmgi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#include &quot;redismodule.h&quot;</pre></div><div class='content'></div><h2>Step 3: Define the Command Function</h2>
<div class='content'><p>Define a function that will be executed when the custom command is called.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW50IE15Q29tbWFuZF9SZWRpc0NvbW1hbmQoUmVkaXNNb2R1bGVDdHggKmN0eCwgUmVkaXNNb2R1bGVTdHJpbmcgKiphcmd2LCBpbnQgYXJnYykgewogICAgaWYgKGFyZ2MgIT0gMikgewogICAgICAgIHJldHVybiBSZWRpc01vZHVsZV9Xcm9uZ0FyaXR5KGN0eCk7CiAgICB9CiAgICBSZWRpc01vZHVsZV9SZXBseVdpdGhTdHJpbmcoY3R4LCBhcmd2WzFdKTsKICAgIHJldHVybiBSRURJU01PRFVMRV9PSzsKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>int MyCommand_RedisCommand(RedisModuleCtx *ctx, RedisModuleString **argv, int argc) {
    if (argc != 2) {
        return RedisModule_WrongArity(ctx);
    }
    RedisModule_ReplyWithString(ctx, argv[1]);
    return REDISMODULE_OK;
}</pre></div><div class='content'></div><h2>Step 4: Register the Command</h2>
<div class='content'><p>Register the command in the module initialization function.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW50IFJlZGlzTW9kdWxlX09uTG9hZChSZWRpc01vZHVsZUN0eCAqY3R4LCBSZWRpc01vZHVsZVN0cmluZyAqKmFyZ3YsIGludCBhcmdjKSB7CiAgICBpZiAoUmVkaXNNb2R1bGVfSW5pdChjdHgsICJteW1vZHVsZSIsIDEsIFJFRElTTU9EVUxFX0FQSVZFUl8xKSA9PSBSRURJU01PRFVMRV9FUlIpIHsKICAgICAgICByZXR1cm4gUkVESVNNT0RVTEVfRVJSOwogICAgfQogICAgaWYgKFJlZGlzTW9kdWxlX0NyZWF0ZUNvbW1hbmQoY3R4LCAibXltb2R1bGUubXljb21tYW5kIiwgTXlDb21tYW5kX1JlZGlzQ29tbWFuZCwgInJlYWRvbmx5IiwgMSwgMSwgMSkgPT0gUkVESVNNT0RVTEVfRVJSKSB7CiAgICAgICAgcmV0dXJuIFJFRElTTU9EVUxFX0VSUjsKICAgIH0KICAgIHJldHVybiBSRURJU01PRFVMRV9PSzsKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>int RedisModule_OnLoad(RedisModuleCtx *ctx, RedisModuleString **argv, int argc) {
    if (RedisModule_Init(ctx, &quot;mymodule&quot;, 1, REDISMODULE_APIVER_1) == REDISMODULE_ERR) {
        return REDISMODULE_ERR;
    }
    if (RedisModule_CreateCommand(ctx, &quot;mymodule.mycommand&quot;, MyCommand_RedisCommand, &quot;readonly&quot;, 1, 1, 1) == REDISMODULE_ERR) {
        return REDISMODULE_ERR;
    }
    return REDISMODULE_OK;
}</pre></div><div class='content'></div><h2>Step 5: Compile the Module</h2>
<div class='content'><p>Compile the module using the following command:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2NjIC1vIG15bW9kdWxlLnNvIC1zaGFyZWQgLWZQSUMgLUkvcGF0aC90by9yZWRpcy9zcmMgbXltb2R1bGUuYw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcc -o mymodule.so -shared -fPIC -I/path/to/redis/src mymodule.c</pre></div><div class='content'></div><h2>Step 6: Load the Module into Redis</h2>
<div class='content'><p>Load the module into Redis by adding the following line to your <code>redis.conf</code> file or using the <code>MODULE LOAD</code> command.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cmVkaXMtc2VydmVyIC0tbG9hZG1vZHVsZSAuL215bW9kdWxlLnNv"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>redis-server --loadmodule ./mymodule.so</pre></div><div class='content'></div><h1>Advanced Module Features</h1>
<div class='content'><p>Once you have the basics down, you can explore more advanced features such as custom data types, background processing, and interacting with Redis internals.</p>
<ul>
<li><strong>Custom Data Types</strong>: Create new data structures that can be manipulated with custom commands.</li>
<li><strong>Background Processing</strong>: Perform long-running tasks without blocking the Redis server.</li>
<li><strong>Interacting with Redis Internals</strong>: Access and manipulate Redis data structures directly.</li>
</ul>
</div><h2>Example: Custom Data Type</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRGVmaW5lIHRoZSBkYXRhIHR5cGUKUmVkaXNNb2R1bGVUeXBlICpNeVR5cGU7CgovLyBDcmVhdGUgYSBuZXcgaW5zdGFuY2Ugb2YgdGhlIGRhdGEgdHlwZQp2b2lkICpNeVR5cGVfUmRiTG9hZChSZWRpc01vZHVsZUlPICpyZGIsIGludCBlbmN2ZXIpIHsKICAgIC8vIEltcGxlbWVudGF0aW9uCn0KCi8vIFJlZ2lzdGVyIHRoZSBkYXRhIHR5cGUKaW50IFJlZGlzTW9kdWxlX09uTG9hZChSZWRpc01vZHVsZUN0eCAqY3R4LCBSZWRpc01vZHVsZVN0cmluZyAqKmFyZ3YsIGludCBhcmdjKSB7CiAgICBNeVR5cGUgPSBSZWRpc01vZHVsZV9DcmVhdGVEYXRhVHlwZShjdHgsICJteXR5cGUiLCAwLCBNeVR5cGVfUmRiTG9hZCwgTlVMTCwgTlVMTCwgTlVMTCwgTlVMTCk7CiAgICBpZiAoTXlUeXBlID09IE5VTEwpIHJldHVybiBSRURJU01PRFVMRV9FUlI7CiAgICByZXR1cm4gUkVESVNNT0RVTEVfT0s7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Define the data type
RedisModuleType *MyType;

// Create a new instance of the data type
void *MyType_RdbLoad(RedisModuleIO *rdb, int encver) {
    // Implementation
}

// Register the data type
int RedisModule_OnLoad(RedisModuleCtx *ctx, RedisModuleString **argv, int argc) {
    MyType = RedisModule_CreateDataType(ctx, &quot;mytype&quot;, 0, MyType_RdbLoad, NULL, NULL, NULL, NULL);
    if (MyType == NULL) return REDISMODULE_ERR;
    return REDISMODULE_OK;
}</pre></div><div class='content'></div><h1>Testing and Debugging Modules</h1>
<div class='content'><p>Testing and debugging are crucial parts of module development. Use Redis logs and debugging tools to ensure your module works correctly.</p>
<ul>
<li><strong>Redis Logs</strong>: Use <code>RedisModule_Log</code> to log messages.</li>
<li><strong>Debugging Tools</strong>: Use GDB or other debugging tools to step through your code.</li>
</ul>
</div><h2>Example: Logging</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UmVkaXNNb2R1bGVfTG9nKGN0eCwgIm5vdGljZSIsICJNeUNvbW1hbmQgd2FzIGNhbGxlZCIpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>RedisModule_Log(ctx, &quot;notice&quot;, &quot;MyCommand was called&quot;);</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Creating custom Redis modules allows you to extend Redis with new commands and data types tailored to your specific needs. By following the steps outlined in this topic, you can set up your development environment, create a simple module, and explore advanced features. Testing and debugging are essential to ensure your module functions correctly.</p>
<p>Redis modules provide powerful capabilities to enhance your Redis server, making it a versatile tool for various applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='popular-redis-modules'>&#x25C4;Popular Redis Modules</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Creating Custom Modules</a>
	</div>
	<div class='col-4 text-end'>
					<a href='caching'>Caching &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
