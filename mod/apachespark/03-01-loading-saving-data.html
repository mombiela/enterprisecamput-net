<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading and Saving Data</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/03-01-loading-saving-data" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/03-01-loading-saving-data" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/03-01-loading-saving-data" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/apachespark/03-01-loading-saving-data" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/apachespark/03-01-loading-saving-data" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-spark-sql' title="Spark SQL">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Loading and Saving Data</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-02-dataframe-operations' title="DataFrame Operations">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to load and save data using Apache Spark. This is a fundamental skill for any data engineer or data scientist working with Spark, as it allows you to interact with various data sources and destinations.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Data Sources and Formats</strong>: Understanding the different data sources and formats that Spark can read from and write to.</li>
<li><strong>Loading Data</strong>: How to load data into Spark DataFrames from various sources.</li>
<li><strong>Saving Data</strong>: How to save Spark DataFrames to different destinations.</li>
<li><strong>Configuration Options</strong>: Various options and parameters that can be used to customize the loading and saving process.</li>
</ol>
</div><h1>Data Sources and Formats</h1>
<div class='content'><p>Spark supports a wide range of data sources and formats, including:</p>
<ul>
<li><strong>CSV</strong>: Comma-Separated Values</li>
<li><strong>JSON</strong>: JavaScript Object Notation</li>
<li><strong>Parquet</strong>: Columnar storage format</li>
<li><strong>Avro</strong>: Row-based storage format</li>
<li><strong>ORC</strong>: Optimized Row Columnar format</li>
<li><strong>JDBC</strong>: Java Database Connectivity for relational databases</li>
<li><strong>HDFS</strong>: Hadoop Distributed File System</li>
<li><strong>S3</strong>: Amazon Simple Storage Service</li>
</ul>
</div><h1>Loading Data</h1>
<div class='content'></div><h2>Example: Loading a CSV File</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaXRpYWxpemUgU3Bhcmsgc2Vzc2lvbgpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIkxvYWRDU1ZFeGFtcGxlIikuZ2V0T3JDcmVhdGUoKQoKIyBMb2FkIENTViBmaWxlIGludG8gRGF0YUZyYW1lCmRmID0gc3BhcmsucmVhZC5jc3YoInBhdGgvdG8veW91ci9maWxlLmNzdiIsIGhlYWRlcj1UcnVlLCBpbmZlclNjaGVtYT1UcnVlKQoKIyBTaG93IHRoZSBmaXJzdCA1IHJvd3MKZGYuc2hvdyg1KQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Initialize Spark session
spark = SparkSession.builder.appName(&quot;LoadCSVExample&quot;).getOrCreate()

# Load CSV file into DataFrame
df = spark.read.csv(&quot;path/to/your/file.csv&quot;, header=True, inferSchema=True)

# Show the first 5 rows
df.show(5)</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li><code>SparkSession.builder.appName(&quot;LoadCSVExample&quot;).getOrCreate()</code>: Initializes a Spark session.</li>
<li><code>spark.read.csv(&quot;path/to/your/file.csv&quot;, header=True, inferSchema=True)</code>: Reads a CSV file into a DataFrame. The <code>header=True</code> option indicates that the first row contains column names, and <code>inferSchema=True</code> automatically infers the data types of the columns.</li>
<li><code>df.show(5)</code>: Displays the first 5 rows of the DataFrame.</li>
</ul>
</div><h2>Example: Loading a JSON File</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMb2FkIEpTT04gZmlsZSBpbnRvIERhdGFGcmFtZQpkZiA9IHNwYXJrLnJlYWQuanNvbigicGF0aC90by95b3VyL2ZpbGUuanNvbiIpCgojIFNob3cgdGhlIGZpcnN0IDUgcm93cwpkZi5zaG93KDUp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Load JSON file into DataFrame
df = spark.read.json(&quot;path/to/your/file.json&quot;)

# Show the first 5 rows
df.show(5)</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li><code>spark.read.json(&quot;path/to/your/file.json&quot;)</code>: Reads a JSON file into a DataFrame.</li>
<li><code>df.show(5)</code>: Displays the first 5 rows of the DataFrame.</li>
</ul>
</div><h1>Saving Data</h1>
<div class='content'></div><h2>Example: Saving a DataFrame as a Parquet File</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTYXZlIERhdGFGcmFtZSB0byBQYXJxdWV0IGZpbGUKZGYud3JpdGUucGFycXVldCgicGF0aC90by9zYXZlL3BhcnF1ZXRfZmlsZSIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Save DataFrame to Parquet file
df.write.parquet(&quot;path/to/save/parquet_file&quot;)</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li><code>df.write.parquet(&quot;path/to/save/parquet_file&quot;)</code>: Saves the DataFrame as a Parquet file at the specified path.</li>
</ul>
</div><h2>Example: Saving a DataFrame to a CSV File</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTYXZlIERhdGFGcmFtZSB0byBDU1YgZmlsZQpkZi53cml0ZS5jc3YoInBhdGgvdG8vc2F2ZS9jc3ZfZmlsZSIsIGhlYWRlcj1UcnVlKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Save DataFrame to CSV file
df.write.csv(&quot;path/to/save/csv_file&quot;, header=True)</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li><code>df.write.csv(&quot;path/to/save/csv_file&quot;, header=True)</code>: Saves the DataFrame as a CSV file at the specified path. The <code>header=True</code> option includes the column names in the output file.</li>
</ul>
</div><h1>Configuration Options</h1>
<div class='content'><p>When loading and saving data, you can use various options to customize the process. Here are some common options:</p>
<ul>
<li><strong><code>sep</code></strong>: Specifies the delimiter for CSV files (e.g., <code>sep=&quot;,&quot;</code> for comma).</li>
<li><strong><code>mode</code></strong>: Specifies the behavior when data already exists at the destination (e.g., <code>mode=&quot;overwrite&quot;</code> to overwrite existing data).</li>
<li><strong><code>partitionBy</code></strong>: Specifies the columns to partition the data by when saving (e.g., <code>partitionBy=&quot;year,month&quot;</code>).</li>
</ul>
</div><h2>Example: Loading a CSV File with Custom Delimiter</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMb2FkIENTViBmaWxlIHdpdGggY3VzdG9tIGRlbGltaXRlcgpkZiA9IHNwYXJrLnJlYWQuY3N2KCJwYXRoL3RvL3lvdXIvZmlsZS5jc3YiLCBzZXA9IjsiLCBoZWFkZXI9VHJ1ZSwgaW5mZXJTY2hlbWE9VHJ1ZSkKCiMgU2hvdyB0aGUgZmlyc3QgNSByb3dzCmRmLnNob3coNSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Load CSV file with custom delimiter
df = spark.read.csv(&quot;path/to/your/file.csv&quot;, sep=&quot;;&quot;, header=True, inferSchema=True)

# Show the first 5 rows
df.show(5)</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li><code>sep=&quot;;&quot;</code>: Specifies that the delimiter for the CSV file is a semicolon (<code>;</code>).</li>
</ul>
</div><h2>Example: Saving a DataFrame with Partitioning</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTYXZlIERhdGFGcmFtZSB3aXRoIHBhcnRpdGlvbmluZwpkZi53cml0ZS5wYXJ0aXRpb25CeSgieWVhciIsICJtb250aCIpLnBhcnF1ZXQoInBhdGgvdG8vc2F2ZS9wYXJ0aXRpb25lZF9wYXJxdWV0Iik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Save DataFrame with partitioning
df.write.partitionBy(&quot;year&quot;, &quot;month&quot;).parquet(&quot;path/to/save/partitioned_parquet&quot;)</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li><code>partitionBy(&quot;year&quot;, &quot;month&quot;)</code>: Partitions the data by the <code>year</code> and <code>month</code> columns when saving as a Parquet file.</li>
</ul>
</div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Load and Save CSV Data</h2>
<div class='content'><ol>
<li><strong>Load a CSV file</strong>: Load a CSV file into a DataFrame.</li>
<li><strong>Save the DataFrame</strong>: Save the DataFrame as a Parquet file.</li>
</ol>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbml0aWFsaXplIFNwYXJrIHNlc3Npb24Kc3BhcmsgPSBTcGFya1Nlc3Npb24uYnVpbGRlci5hcHBOYW1lKCJFeGVyY2lzZTEiKS5nZXRPckNyZWF0ZSgpCgojIExvYWQgQ1NWIGZpbGUgaW50byBEYXRhRnJhbWUKZGYgPSBzcGFyay5yZWFkLmNzdigicGF0aC90by95b3VyL2ZpbGUuY3N2IiwgaGVhZGVyPVRydWUsIGluZmVyU2NoZW1hPVRydWUpCgojIFNhdmUgRGF0YUZyYW1lIHRvIFBhcnF1ZXQgZmlsZQpkZi53cml0ZS5wYXJxdWV0KCJwYXRoL3RvL3NhdmUvcGFycXVldF9maWxlIik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Initialize Spark session
spark = SparkSession.builder.appName(&quot;Exercise1&quot;).getOrCreate()

# Load CSV file into DataFrame
df = spark.read.csv(&quot;path/to/your/file.csv&quot;, header=True, inferSchema=True)

# Save DataFrame to Parquet file
df.write.parquet(&quot;path/to/save/parquet_file&quot;)</pre></div><div class='content'></div><h2>Exercise 2: Load and Save JSON Data</h2>
<div class='content'><ol>
<li><strong>Load a JSON file</strong>: Load a JSON file into a DataFrame.</li>
<li><strong>Save the DataFrame</strong>: Save the DataFrame as a CSV file with a custom delimiter.</li>
</ol>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbml0aWFsaXplIFNwYXJrIHNlc3Npb24Kc3BhcmsgPSBTcGFya1Nlc3Npb24uYnVpbGRlci5hcHBOYW1lKCJFeGVyY2lzZTIiKS5nZXRPckNyZWF0ZSgpCgojIExvYWQgSlNPTiBmaWxlIGludG8gRGF0YUZyYW1lCmRmID0gc3BhcmsucmVhZC5qc29uKCJwYXRoL3RvL3lvdXIvZmlsZS5qc29uIikKCiMgU2F2ZSBEYXRhRnJhbWUgdG8gQ1NWIGZpbGUgd2l0aCBjdXN0b20gZGVsaW1pdGVyCmRmLndyaXRlLmNzdigicGF0aC90by9zYXZlL2Nzdl9maWxlIiwgc2VwPSJ8IiwgaGVhZGVyPVRydWUp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Initialize Spark session
spark = SparkSession.builder.appName(&quot;Exercise2&quot;).getOrCreate()

# Load JSON file into DataFrame
df = spark.read.json(&quot;path/to/your/file.json&quot;)

# Save DataFrame to CSV file with custom delimiter
df.write.csv(&quot;path/to/save/csv_file&quot;, sep=&quot;|&quot;, header=True)</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Incorrect File Paths</strong>: Ensure that the file paths are correct and accessible from the Spark environment.</li>
<li><strong>Schema Mismatch</strong>: When loading data, ensure that the schema matches the data format to avoid errors.</li>
<li><strong>Overwriting Data</strong>: Be cautious with the <code>mode=&quot;overwrite&quot;</code> option to avoid unintentionally overwriting important data.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the basics of loading and saving data in Apache Spark. We explored different data sources and formats, learned how to load data into DataFrames, and how to save DataFrames to various destinations. We also looked at some common configuration options and provided practical exercises to reinforce the concepts. In the next section, we will dive deeper into DataFrame operations.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-spark-sql' title="Spark SQL">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-02-dataframe-operations' title="DataFrame Operations">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
