<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spark DataFrames</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/02-03-spark-dataframes" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/02-03-spark-dataframes" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/02-03-spark-dataframes" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/apachespark/02-03-spark-dataframes" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/apachespark/02-03-spark-dataframes" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='02-02-transformations-actions' title="Transformations and Actions">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Spark DataFrames</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='02-04-spark-sql' title="Spark SQL">Next &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1><p>Introduction</p>
</h1>
<div class='content'><p>Spark DataFrames are a distributed collection of data organized into named columns, similar to a table in a relational database or a data frame in R/Python. They provide a higher-level abstraction than RDDs and are optimized for performance.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'></div><h2><ol>
<li>What is a DataFrame?</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: A DataFrame is a distributed collection of data organized into named columns.</li>
<li><strong>Schema</strong>: DataFrames have a schema, which is a structure that defines the column names and data types.</li>
<li><strong>Optimization</strong>: DataFrames are optimized for performance using Catalyst Optimizer and Tungsten execution engine.</li>
</ul>
</div><h2><ol start="2">
<li>Creating DataFrames</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>From RDDs</strong>: Convert an existing RDD to a DataFrame.</li>
<li><strong>From Structured Data</strong>: Load data from structured data sources like JSON, CSV, Parquet, etc.</li>
<li><strong>From Existing Data</strong>: Create DataFrames from existing data structures like lists or dictionaries in Python.</li>
</ul>
</div><h2><ol start="3">
<li>DataFrame Operations</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Transformations</strong>: Operations that return a new DataFrame, such as <code>select</code>, <code>filter</code>, <code>groupBy</code>, etc.</li>
<li><strong>Actions</strong>: Operations that trigger computation and return results, such as <code>show</code>, <code>collect</code>, <code>count</code>, etc.</li>
</ul>
</div><h1><p>Practical Examples</p>
</h1>
<div class='content'></div><h2><p>Example 1: Creating a DataFrame from a List</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaXRpYWxpemUgU3BhcmsgU2Vzc2lvbgpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIkRhdGFGcmFtZUV4YW1wbGUiKS5nZXRPckNyZWF0ZSgpCgojIFNhbXBsZSBkYXRhCmRhdGEgPSBbKCJBbGljZSIsIDM0KSwgKCJCb2IiLCA0NSksICgiQ2F0aHkiLCAyOSldCgojIERlZmluZSBzY2hlbWEKY29sdW1ucyA9IFsiTmFtZSIsICJBZ2UiXQoKIyBDcmVhdGUgRGF0YUZyYW1lCmRmID0gc3BhcmsuY3JlYXRlRGF0YUZyYW1lKGRhdGEsIGNvbHVtbnMpCgojIFNob3cgRGF0YUZyYW1lCmRmLnNob3coKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Initialize Spark Session
spark = SparkSession.builder.appName(&quot;DataFrameExample&quot;).getOrCreate()

# Sample data
data = [(&quot;Alice&quot;, 34), (&quot;Bob&quot;, 45), (&quot;Cathy&quot;, 29)]

# Define schema
columns = [&quot;Name&quot;, &quot;Age&quot;]

# Create DataFrame
df = spark.createDataFrame(data, columns)

# Show DataFrame
df.show()</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>We start by initializing a Spark session.</li>
<li>We define a list of tuples containing sample data.</li>
<li>We specify the column names.</li>
<li>We create a DataFrame using <code>createDataFrame</code> method.</li>
<li>Finally, we display the DataFrame using the <code>show</code> method.</li>
</ul>
</div><h2><p>Example 2: Loading Data from a CSV File</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMb2FkIERhdGFGcmFtZSBmcm9tIENTViBmaWxlCmRmID0gc3BhcmsucmVhZC5jc3YoInBhdGgvdG8vZmlsZS5jc3YiLCBoZWFkZXI9VHJ1ZSwgaW5mZXJTY2hlbWE9VHJ1ZSkKCiMgU2hvdyBEYXRhRnJhbWUKZGYuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Load DataFrame from CSV file
df = spark.read.csv(&quot;path/to/file.csv&quot;, header=True, inferSchema=True)

# Show DataFrame
df.show()</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>We use the <code>read.csv</code> method to load data from a CSV file.</li>
<li>The <code>header=True</code> option indicates that the first row contains column names.</li>
<li>The <code>inferSchema=True</code> option automatically infers the data types of the columns.</li>
<li>We display the DataFrame using the <code>show</code> method.</li>
</ul>
</div><h2><p>Example 3: DataFrame Transformations</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTZWxlY3Qgc3BlY2lmaWMgY29sdW1ucwpkZl9zZWxlY3RlZCA9IGRmLnNlbGVjdCgiTmFtZSIsICJBZ2UiKQoKIyBGaWx0ZXIgcm93cwpkZl9maWx0ZXJlZCA9IGRmLmZpbHRlcihkZi5BZ2UgPiAzMCkKCiMgR3JvdXAgYnkgYW5kIGFnZ3JlZ2F0ZQpkZl9ncm91cGVkID0gZGYuZ3JvdXBCeSgiQWdlIikuY291bnQoKQoKIyBTaG93IHJlc3VsdHMKZGZfc2VsZWN0ZWQuc2hvdygpCmRmX2ZpbHRlcmVkLnNob3coKQpkZl9ncm91cGVkLnNob3coKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Select specific columns
df_selected = df.select(&quot;Name&quot;, &quot;Age&quot;)

# Filter rows
df_filtered = df.filter(df.Age &gt; 30)

# Group by and aggregate
df_grouped = df.groupBy(&quot;Age&quot;).count()

# Show results
df_selected.show()
df_filtered.show()
df_grouped.show()</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>We use the <code>select</code> method to choose specific columns.</li>
<li>We use the <code>filter</code> method to filter rows based on a condition.</li>
<li>We use the <code>groupBy</code> method to group rows by a specific column and then apply an aggregation function (<code>count</code> in this case).</li>
<li>We display the results using the <code>show</code> method.</li>
</ul>
</div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Creating and Displaying a DataFrame</p>
</h2>
<div class='content'><p><strong>Task</strong>: Create a DataFrame from a list of tuples containing employee names and salaries. Display the DataFrame.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTYW1wbGUgZGF0YQpkYXRhID0gWygiSm9obiIsIDUwMDAwKSwgKCJKYW5lIiwgNjAwMDApLCAoIkRvZSIsIDcwMDAwKV0KCiMgRGVmaW5lIHNjaGVtYQpjb2x1bW5zID0gWyJOYW1lIiwgIlNhbGFyeSJdCgojIENyZWF0ZSBEYXRhRnJhbWUKZGYgPSBzcGFyay5jcmVhdGVEYXRhRnJhbWUoZGF0YSwgY29sdW1ucykKCiMgU2hvdyBEYXRhRnJhbWUKZGYuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Sample data
data = [(&quot;John&quot;, 50000), (&quot;Jane&quot;, 60000), (&quot;Doe&quot;, 70000)]

# Define schema
columns = [&quot;Name&quot;, &quot;Salary&quot;]

# Create DataFrame
df = spark.createDataFrame(data, columns)

# Show DataFrame
df.show()</pre></div><div class='content'></div><h2><p>Exercise 2: Loading and Filtering Data</p>
</h2>
<div class='content'><p><strong>Task</strong>: Load a DataFrame from a CSV file containing product information (ProductID, ProductName, Price). Filter the DataFrame to show only products with a price greater than 100.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMb2FkIERhdGFGcmFtZSBmcm9tIENTViBmaWxlCmRmID0gc3BhcmsucmVhZC5jc3YoInBhdGgvdG8vcHJvZHVjdHMuY3N2IiwgaGVhZGVyPVRydWUsIGluZmVyU2NoZW1hPVRydWUpCgojIEZpbHRlciByb3dzCmRmX2ZpbHRlcmVkID0gZGYuZmlsdGVyKGRmLlByaWNlID4gMTAwKQoKIyBTaG93IGZpbHRlcmVkIERhdGFGcmFtZQpkZl9maWx0ZXJlZC5zaG93KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Load DataFrame from CSV file
df = spark.read.csv(&quot;path/to/products.csv&quot;, header=True, inferSchema=True)

# Filter rows
df_filtered = df.filter(df.Price &gt; 100)

# Show filtered DataFrame
df_filtered.show()</pre></div><div class='content'></div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Schema Mismatch</strong>: Ensure that the schema matches the data types in the source data.</li>
<li><strong>Case Sensitivity</strong>: Column names are case-sensitive. Ensure consistent use of column names.</li>
<li><strong>Lazy Evaluation</strong>: Remember that transformations are lazy and actions trigger computation.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we introduced Spark DataFrames, a powerful abstraction for working with structured data. We covered how to create DataFrames from various sources, perform transformations and actions, and provided practical examples and exercises. Understanding DataFrames is crucial for efficient data processing in Spark, and this knowledge will be built upon in subsequent modules.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='02-02-transformations-actions' title="Transformations and Actions">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='02-04-spark-sql' title="Spark SQL">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
