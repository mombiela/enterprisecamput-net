<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collaborative Filtering in Apache Spark</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/collaborative-filtering" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/collaborative-filtering" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/collaborative-filtering" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/apachespark/collaborative-filtering" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/apachespark/collaborative-filtering" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='clustering'>&#x25C4;Clustering</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Collaborative Filtering in Apache Spark</a>
	</div>
	<div class='col-4 text-end'>
					<a href='model-evaluation-and-tuning'>Model Evaluation and Tuning &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Collaborative Filtering is a popular technique used in recommendation systems. It makes automatic predictions about the interests of a user by collecting preferences from many users. In this topic, we will explore how to implement Collaborative Filtering using Apache Spark, from beginner to advanced levels.</p>
</div><h1>Introduction to Collaborative Filtering</h1>
<div class='content'><ul>
<li><strong>Definition</strong>: Collaborative Filtering is a method used to predict the preferences of a user by analyzing preferences from a large number of users.</li>
<li><strong>Applications</strong>: Commonly used in recommendation systems for movies, music, products, etc.</li>
<li><strong>Types</strong>:
<ul>
<li><strong>User-based Collaborative Filtering</strong>: Recommends items by finding similar users.</li>
<li><strong>Item-based Collaborative Filtering</strong>: Recommends items by finding similar items.</li>
</ul>
</li>
</ul>
</div><h1>Setting Up Apache Spark</h1>
<div class='content'><p>Before diving into Collaborative Filtering, ensure you have Apache Spark set up on your machine.</p>
<ul>
<li><strong>Installation</strong>: Follow the <a href="https://spark.apache.org/docs/latest/">official Apache Spark documentation</a> for installation instructions.</li>
<li><strong>Environment</strong>: Ensure you have Java and Scala installed, as they are prerequisites for running Spark.</li>
</ul>
</div><h1>Basic Concepts of Collaborative Filtering in Spark</h1>
<div class='content'></div><h2>Alternating Least Squares (ALS)</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: ALS is an algorithm used in Spark's MLlib for Collaborative Filtering.</li>
<li><strong>Functionality</strong>: It works by factorizing the user-item interaction matrix into two lower-dimensional matrices.</li>
</ul>
</div><h2>Example Dataset</h2>
<div class='content'><p>For this example, we will use a simple dataset of user ratings for movies.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VXNlcklELCBNb3ZpZUlELCBSYXRpbmcKMSwgMTAxLCA1CjEsIDEwMiwgMwoyLCAxMDEsIDQKMiwgMTAzLCAyCjMsIDEwMiwgNAozLCAxMDMsIDU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>UserID, MovieID, Rating
1, 101, 5
1, 102, 3
2, 101, 4
2, 103, 2
3, 102, 4
3, 103, 5</pre></div><div class='content'></div><h1>Implementing Collaborative Filtering in Spark</h1>
<div class='content'></div><h2>Step 1: Load Data</h2>
<div class='content'><p>First, load the data into a Spark DataFrame.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIkNvbGxhYm9yYXRpdmVGaWx0ZXJpbmciKS5nZXRPckNyZWF0ZSgpCgojIExvYWQgZGF0YQpkYXRhID0gWwogICAgKDEsIDEwMSwgNSksCiAgICAoMSwgMTAyLCAzKSwKICAgICgyLCAxMDEsIDQpLAogICAgKDIsIDEwMywgMiksCiAgICAoMywgMTAyLCA0KSwKICAgICgzLCAxMDMsIDUpCl0KCmNvbHVtbnMgPSBbIlVzZXJJRCIsICJNb3ZpZUlEIiwgIlJhdGluZyJdCmRmID0gc3BhcmsuY3JlYXRlRGF0YUZyYW1lKGRhdGEsIGNvbHVtbnMpCmRmLnNob3coKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

spark = SparkSession.builder.appName(&quot;CollaborativeFiltering&quot;).getOrCreate()

# Load data
data = [
    (1, 101, 5),
    (1, 102, 3),
    (2, 101, 4),
    (2, 103, 2),
    (3, 102, 4),
    (3, 103, 5)
]

columns = [&quot;UserID&quot;, &quot;MovieID&quot;, &quot;Rating&quot;]
df = spark.createDataFrame(data, columns)
df.show()</pre></div><div class='content'></div><h2>Step 2: Prepare Data for ALS</h2>
<div class='content'><p>Convert the DataFrame into an RDD and prepare it for the ALS algorithm.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmV2YWx1YXRpb24gaW1wb3J0IFJlZ3Jlc3Npb25FdmFsdWF0b3IKZnJvbSBweXNwYXJrLm1sLnJlY29tbWVuZGF0aW9uIGltcG9ydCBBTFMKCiMgQ29udmVydCBEYXRhRnJhbWUgdG8gUkRECnJhdGluZ3MgPSBkZi5yZGQubWFwKGxhbWJkYSByb3c6IChyb3dbMF0sIHJvd1sxXSwgcm93WzJdKSkKCiMgU3BsaXQgZGF0YSBpbnRvIHRyYWluaW5nIGFuZCB0ZXN0IHNldHMKKHRyYWluaW5nLCB0ZXN0KSA9IGRmLnJhbmRvbVNwbGl0KFswLjgsIDAuMl0p"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.evaluation import RegressionEvaluator
from pyspark.ml.recommendation import ALS

# Convert DataFrame to RDD
ratings = df.rdd.map(lambda row: (row[0], row[1], row[2]))

# Split data into training and test sets
(training, test) = df.randomSplit([0.8, 0.2])</pre></div><div class='content'></div><h2>Step 3: Train the ALS Model</h2>
<div class='content'><p>Train the ALS model using the training data.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBCdWlsZCB0aGUgcmVjb21tZW5kYXRpb24gbW9kZWwgdXNpbmcgQUxTCmFscyA9IEFMUyhtYXhJdGVyPTEwLCByZWdQYXJhbT0wLjAxLCB1c2VyQ29sPSJVc2VySUQiLCBpdGVtQ29sPSJNb3ZpZUlEIiwgcmF0aW5nQ29sPSJSYXRpbmciKQptb2RlbCA9IGFscy5maXQodHJhaW5pbmcp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Build the recommendation model using ALS
als = ALS(maxIter=10, regParam=0.01, userCol=&quot;UserID&quot;, itemCol=&quot;MovieID&quot;, ratingCol=&quot;Rating&quot;)
model = als.fit(training)</pre></div><div class='content'></div><h2>Step 4: Make Predictions</h2>
<div class='content'><p>Use the trained model to make predictions on the test data.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBNYWtlIHByZWRpY3Rpb25zCnByZWRpY3Rpb25zID0gbW9kZWwudHJhbnNmb3JtKHRlc3QpCnByZWRpY3Rpb25zLnNob3coKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Make predictions
predictions = model.transform(test)
predictions.show()</pre></div><div class='content'></div><h2>Step 5: Evaluate the Model</h2>
<div class='content'><p>Evaluate the model using Root Mean Square Error (RMSE).</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFdmFsdWF0ZSB0aGUgbW9kZWwKZXZhbHVhdG9yID0gUmVncmVzc2lvbkV2YWx1YXRvcihtZXRyaWNOYW1lPSJybXNlIiwgbGFiZWxDb2w9IlJhdGluZyIsIHByZWRpY3Rpb25Db2w9InByZWRpY3Rpb24iKQpybXNlID0gZXZhbHVhdG9yLmV2YWx1YXRlKHByZWRpY3Rpb25zKQpwcmludChmIlJvb3QtbWVhbi1zcXVhcmUgZXJyb3IgPSB7cm1zZX0iKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Evaluate the model
evaluator = RegressionEvaluator(metricName=&quot;rmse&quot;, labelCol=&quot;Rating&quot;, predictionCol=&quot;prediction&quot;)
rmse = evaluator.evaluate(predictions)
print(f&quot;Root-mean-square error = {rmse}&quot;)</pre></div><div class='content'></div><h1>Advanced Topics in Collaborative Filtering</h1>
<div class='content'></div><h2>Hyperparameter Tuning</h2>
<div class='content'><ul>
<li><strong>Grid Search</strong>: Perform grid search to find the best hyperparameters for the ALS model.</li>
<li><strong>Cross-Validation</strong>: Use cross-validation to ensure the model's robustness.</li>
</ul>
</div><h2>Handling Cold Start Problem</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: The cold start problem occurs when the system cannot make accurate recommendations due to lack of data.</li>
<li><strong>Solution</strong>: Use techniques like default ratings or hybrid models to mitigate this issue.</li>
</ul>
</div><h2>Implicit Feedback</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: Implicit feedback refers to indirect signals of user preferences, such as clicks or views.</li>
<li><strong>Implementation</strong>: Spark's ALS can handle implicit feedback by setting the <code>implicitPrefs</code> parameter to <code>True</code>.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this topic, we covered the basics and advanced aspects of implementing Collaborative Filtering using Apache Spark. We started with setting up Spark, loading data, and implementing the ALS algorithm. We also discussed advanced topics like hyperparameter tuning and handling the cold start problem. By the end of this topic, you should have a solid understanding of how to build and evaluate a recommendation system using Collaborative Filtering in Spark.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='clustering'>&#x25C4;Clustering</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Collaborative Filtering in Apache Spark</a>
	</div>
	<div class='col-4 text-end'>
					<a href='model-evaluation-and-tuning'>Model Evaluation and Tuning &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
