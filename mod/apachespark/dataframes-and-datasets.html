<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataFrames and Datasets</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/dataframes-and-datasets" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/dataframes-and-datasets" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/dataframes-and-datasets" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/apachespark/dataframes-and-datasets" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/apachespark/dataframes-and-datasets" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='spark-context'>&#x25C4;Spark Context</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">DataFrames and Datasets</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-spark-sql'>Introduction to Spark SQL &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to DataFrames and Datasets</h1>
<div class='content'><p>Apache Spark is a powerful tool for big data processing, and understanding DataFrames and Datasets is crucial for leveraging its full potential. This section will guide you through the basics to advanced concepts of DataFrames and Datasets in Spark.</p>
</div><h1>What are DataFrames?</h1>
<div class='content'><ul>
<li><strong>DataFrame</strong>: A distributed collection of data organized into named columns, similar to a table in a relational database or a data frame in R/Python.</li>
<li><strong>Schema</strong>: The structure of a DataFrame, defining column names and data types.</li>
</ul>
</div><h2>Creating DataFrames</h2>
<div class='content'><p>You can create DataFrames from various data sources such as CSV, JSON, Parquet files, or existing RDDs.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaXRpYWxpemUgU3Bhcmsgc2Vzc2lvbgpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIkRhdGFGcmFtZUV4YW1wbGUiKS5nZXRPckNyZWF0ZSgpCgojIENyZWF0ZSBEYXRhRnJhbWUgZnJvbSBhIEpTT04gZmlsZQpkZiA9IHNwYXJrLnJlYWQuanNvbigicGF0aC90by9qc29uL2ZpbGUuanNvbiIpCgojIFNob3cgdGhlIERhdGFGcmFtZQpkZi5zaG93KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Initialize Spark session
spark = SparkSession.builder.appName(&quot;DataFrameExample&quot;).getOrCreate()

# Create DataFrame from a JSON file
df = spark.read.json(&quot;path/to/json/file.json&quot;)

# Show the DataFrame
df.show()</pre></div><div class='content'></div><h2>Basic Operations on DataFrames</h2>
<div class='content'><ul>
<li><strong>Show</strong>: Display the content of the DataFrame.</li>
<li><strong>Select</strong>: Select specific columns.</li>
<li><strong>Filter</strong>: Filter rows based on a condition.</li>
<li><strong>GroupBy</strong>: Group data and perform aggregations.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTZWxlY3Qgc3BlY2lmaWMgY29sdW1ucwpkZi5zZWxlY3QoImNvbHVtbjEiLCAiY29sdW1uMiIpLnNob3coKQoKIyBGaWx0ZXIgcm93cwpkZi5maWx0ZXIoZGZbImNvbHVtbjEiXSA+IDEwKS5zaG93KCkKCiMgR3JvdXAgYnkgYW5kIGFnZ3JlZ2F0ZQpkZi5ncm91cEJ5KCJjb2x1bW4xIikuY291bnQoKS5zaG93KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Select specific columns
df.select(&quot;column1&quot;, &quot;column2&quot;).show()

# Filter rows
df.filter(df[&quot;column1&quot;] &gt; 10).show()

# Group by and aggregate
df.groupBy(&quot;column1&quot;).count().show()</pre></div><div class='content'></div><h1>What are Datasets?</h1>
<div class='content'><ul>
<li><strong>Dataset</strong>: A strongly-typed, distributed collection of data. Datasets provide the benefits of RDDs (strong typing and functional programming) along with the optimized execution engine of DataFrames.</li>
</ul>
</div><h2>Creating Datasets</h2>
<div class='content'><p>Datasets are available in Scala and Java but not in Python. Below is an example in Scala:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuc3Bhcmsuc3FsLlNwYXJrU2Vzc2lvbgoKLy8gSW5pdGlhbGl6ZSBTcGFyayBzZXNzaW9uCnZhbCBzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIkRhdGFzZXRFeGFtcGxlIikuZ2V0T3JDcmVhdGUoKQoKLy8gSW1wb3J0IGltcGxpY2l0cyBmb3IgY29udmVydGluZyBSRERzIHRvIERhdGFzZXRzCmltcG9ydCBzcGFyay5pbXBsaWNpdHMuXwoKLy8gQ3JlYXRlIERhdGFzZXQgZnJvbSBhIGNhc2UgY2xhc3MKY2FzZSBjbGFzcyBQZXJzb24obmFtZTogU3RyaW5nLCBhZ2U6IEludCkKdmFsIHBlb3BsZURTID0gU2VxKFBlcnNvbigiQWxpY2UiLCAyOSksIFBlcnNvbigiQm9iIiwgMzUpKS50b0RTKCkKCi8vIFNob3cgdGhlIERhdGFzZXQKcGVvcGxlRFMuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.spark.sql.SparkSession

// Initialize Spark session
val spark = SparkSession.builder.appName(&quot;DatasetExample&quot;).getOrCreate()

// Import implicits for converting RDDs to Datasets
import spark.implicits._

// Create Dataset from a case class
case class Person(name: String, age: Int)
val peopleDS = Seq(Person(&quot;Alice&quot;, 29), Person(&quot;Bob&quot;, 35)).toDS()

// Show the Dataset
peopleDS.show()</pre></div><div class='content'></div><h2>Basic Operations on Datasets</h2>
<div class='content'><ul>
<li><strong>Map</strong>: Apply a function to each element.</li>
<li><strong>Filter</strong>: Filter elements based on a condition.</li>
<li><strong>GroupByKey</strong>: Group data and perform aggregations.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gTWFwIG9wZXJhdGlvbgp2YWwgbmFtZXNEUyA9IHBlb3BsZURTLm1hcChwZXJzb24gPT4gcGVyc29uLm5hbWUpCgovLyBGaWx0ZXIgb3BlcmF0aW9uCnZhbCBhZHVsdHNEUyA9IHBlb3BsZURTLmZpbHRlcihwZXJzb24gPT4gcGVyc29uLmFnZSA+IDE4KQoKLy8gR3JvdXBCeUtleSBhbmQgYWdncmVnYXRpb24KdmFsIGFnZUdyb3VwRFMgPSBwZW9wbGVEUy5ncm91cEJ5S2V5KF8uYWdlKS5jb3VudCgp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Map operation
val namesDS = peopleDS.map(person =&gt; person.name)

// Filter operation
val adultsDS = peopleDS.filter(person =&gt; person.age &gt; 18)

// GroupByKey and aggregation
val ageGroupDS = peopleDS.groupByKey(_.age).count()</pre></div><div class='content'></div><h1>Comparing DataFrames and Datasets</h1>
<div class='content'><table>
<thead>
<tr>
<th>Feature</th>
<th>DataFrame</th>
<th>Dataset</th>
</tr>
</thead>
<tbody>
<tr>
<td>Language Support</td>
<td>Python, Scala, Java, R</td>
<td>Scala, Java</td>
</tr>
<tr>
<td>Type Safety</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>Compile-time Safety</td>
<td>No</td>
<td>Yes</td>
</tr>
<tr>
<td>Performance</td>
<td>Optimized execution engine</td>
<td>Optimized execution engine</td>
</tr>
<tr>
<td>Ease of Use</td>
<td>Easier for data manipulation</td>
<td>Easier for functional programming</td>
</tr>
</tbody>
</table>
</div><h1>Advanced Operations</h1>
<h2>Joins</h2>
<div class='content'><p>Joining DataFrames or Datasets is a common operation in data processing.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBKb2luIHR3byBEYXRhRnJhbWVzCmRmMSA9IHNwYXJrLnJlYWQuanNvbigicGF0aC90by9qc29uMS5qc29uIikKZGYyID0gc3BhcmsucmVhZC5qc29uKCJwYXRoL3RvL2pzb24yLmpzb24iKQoKam9pbmVkX2RmID0gZGYxLmpvaW4oZGYyLCBkZjFbImlkIl0gPT0gZGYyWyJpZCJdKQpqb2luZWRfZGYuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Join two DataFrames
df1 = spark.read.json(&quot;path/to/json1.json&quot;)
df2 = spark.read.json(&quot;path/to/json2.json&quot;)

joined_df = df1.join(df2, df1[&quot;id&quot;] == df2[&quot;id&quot;])
joined_df.show()</pre></div><div class='content'></div><h2>UDFs (User-Defined Functions)</h2>
<div class='content'><p>You can define custom functions to apply to DataFrames or Datasets.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbC5mdW5jdGlvbnMgaW1wb3J0IHVkZgpmcm9tIHB5c3Bhcmsuc3FsLnR5cGVzIGltcG9ydCBTdHJpbmdUeXBlCgojIERlZmluZSBhIFVERgpkZWYgdXBwZXJfY2FzZShzKToKICAgIHJldHVybiBzLnVwcGVyKCkKCiMgUmVnaXN0ZXIgdGhlIFVERgp1cHBlcl9jYXNlX3VkZiA9IHVkZih1cHBlcl9jYXNlLCBTdHJpbmdUeXBlKCkpCgojIEFwcGx5IHRoZSBVREYKZGYud2l0aENvbHVtbigidXBwZXJfbmFtZSIsIHVwcGVyX2Nhc2VfdWRmKGRmWyJuYW1lIl0pKS5zaG93KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql.functions import udf
from pyspark.sql.types import StringType

# Define a UDF
def upper_case(s):
    return s.upper()

# Register the UDF
upper_case_udf = udf(upper_case, StringType())

# Apply the UDF
df.withColumn(&quot;upper_name&quot;, upper_case_udf(df[&quot;name&quot;])).show()</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>DataFrames and Datasets are essential components of Apache Spark, providing powerful abstractions for data manipulation and processing. DataFrames offer ease of use and optimized performance, while Datasets provide type safety and functional programming capabilities. Understanding these concepts will enable you to write efficient and robust Spark applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='spark-context'>&#x25C4;Spark Context</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">DataFrames and Datasets</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-spark-sql'>Introduction to Spark SQL &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
