<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Implementation</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/08-03-implementation" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/08-03-implementation" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/08-03-implementation" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/apachespark/08-03-implementation" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/apachespark/08-03-implementation" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='08-02-project-setup' title="Project Setup">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Implementation</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='08-04-presentation-review' title="Presentation and Review">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will guide you through the implementation phase of your Capstone Project. This phase involves applying the knowledge and skills you have acquired throughout the course to solve a real-world problem using Apache Spark. We will break down the implementation process into manageable steps, provide practical examples, and offer exercises to reinforce your understanding.</p>
</div><h1>Steps for Implementation</h1>
<div class='content'><ol>
<li><strong>Define the Problem Statement</strong></li>
<li><strong>Data Collection and Preparation</strong></li>
<li><strong>Data Processing and Transformation</strong></li>
<li><strong>Model Building and Evaluation</strong></li>
<li><strong>Optimization and Tuning</strong></li>
<li><strong>Deployment</strong></li>
</ol>
</div><h2>1. Define the Problem Statement</h2>
<div class='content'><p>Clearly articulate the problem you are trying to solve. This could be anything from real-time data processing to building a machine learning model.</p>
<p><strong>Example:</strong></p>
<ul>
<li>Problem: Predicting customer churn for a telecom company.</li>
<li>Objective: Use historical customer data to predict which customers are likely to churn in the next month.</li>
</ul>
</div><h2>2. Data Collection and Preparation</h2>
<div class='content'><p>Collect the necessary data and prepare it for processing. This may involve cleaning the data, handling missing values, and transforming it into a suitable format.</p>
<p><strong>Example:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaXRpYWxpemUgU3BhcmsgU2Vzc2lvbgpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIkN1c3RvbWVyQ2h1cm5QcmVkaWN0aW9uIikuZ2V0T3JDcmVhdGUoKQoKIyBMb2FkIGRhdGEKZGF0YSA9IHNwYXJrLnJlYWQuY3N2KCJjdXN0b21lcl9kYXRhLmNzdiIsIGhlYWRlcj1UcnVlLCBpbmZlclNjaGVtYT1UcnVlKQoKIyBEaXNwbGF5IHNjaGVtYQpkYXRhLnByaW50U2NoZW1hKCkKCiMgU2hvdyBmaXJzdCBmZXcgcm93cwpkYXRhLnNob3coNSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Initialize Spark Session
spark = SparkSession.builder.appName(&quot;CustomerChurnPrediction&quot;).getOrCreate()

# Load data
data = spark.read.csv(&quot;customer_data.csv&quot;, header=True, inferSchema=True)

# Display schema
data.printSchema()

# Show first few rows
data.show(5)</pre></div><div class='content'></div><h2>3. Data Processing and Transformation</h2>
<div class='content'><p>Perform necessary data transformations and feature engineering to prepare the data for modeling.</p>
<p><strong>Example:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbC5mdW5jdGlvbnMgaW1wb3J0IGNvbCwgd2hlbgoKIyBIYW5kbGUgbWlzc2luZyB2YWx1ZXMKZGF0YSA9IGRhdGEubmEuZmlsbCh7IlRvdGFsQ2hhcmdlcyI6IDB9KQoKIyBGZWF0dXJlIGVuZ2luZWVyaW5nCmRhdGEgPSBkYXRhLndpdGhDb2x1bW4oIlNlbmlvckNpdGl6ZW4iLCB3aGVuKGNvbCgiU2VuaW9yQ2l0aXplbiIpID09IDEsICJZZXMiKS5vdGhlcndpc2UoIk5vIikpCgojIENvbnZlcnQgY2F0ZWdvcmljYWwgY29sdW1ucyB0byBudW1lcmljYWwKZnJvbSBweXNwYXJrLm1sLmZlYXR1cmUgaW1wb3J0IFN0cmluZ0luZGV4ZXIKCmluZGV4ZXIgPSBTdHJpbmdJbmRleGVyKGlucHV0Q29scz1bImdlbmRlciIsICJTZW5pb3JDaXRpemVuIiwgIlBhcnRuZXIiLCAiRGVwZW5kZW50cyJdLCAKICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0Q29scz1bImdlbmRlckluZGV4IiwgInNlbmlvckNpdGl6ZW5JbmRleCIsICJwYXJ0bmVySW5kZXgiLCAiZGVwZW5kZW50c0luZGV4Il0pCmRhdGEgPSBpbmRleGVyLmZpdChkYXRhKS50cmFuc2Zvcm0oZGF0YSkKCiMgU2VsZWN0IHJlbGV2YW50IGNvbHVtbnMKZGF0YSA9IGRhdGEuc2VsZWN0KCJnZW5kZXJJbmRleCIsICJzZW5pb3JDaXRpemVuSW5kZXgiLCAicGFydG5lckluZGV4IiwgImRlcGVuZGVudHNJbmRleCIsICJ0ZW51cmUiLCAiTW9udGhseUNoYXJnZXMiLCAiVG90YWxDaGFyZ2VzIiwgIkNodXJuIikKZGF0YS5zaG93KDUp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql.functions import col, when

# Handle missing values
data = data.na.fill({&quot;TotalCharges&quot;: 0})

# Feature engineering
data = data.withColumn(&quot;SeniorCitizen&quot;, when(col(&quot;SeniorCitizen&quot;) == 1, &quot;Yes&quot;).otherwise(&quot;No&quot;))

# Convert categorical columns to numerical
from pyspark.ml.feature import StringIndexer

indexer = StringIndexer(inputCols=[&quot;gender&quot;, &quot;SeniorCitizen&quot;, &quot;Partner&quot;, &quot;Dependents&quot;], 
                        outputCols=[&quot;genderIndex&quot;, &quot;seniorCitizenIndex&quot;, &quot;partnerIndex&quot;, &quot;dependentsIndex&quot;])
data = indexer.fit(data).transform(data)

# Select relevant columns
data = data.select(&quot;genderIndex&quot;, &quot;seniorCitizenIndex&quot;, &quot;partnerIndex&quot;, &quot;dependentsIndex&quot;, &quot;tenure&quot;, &quot;MonthlyCharges&quot;, &quot;TotalCharges&quot;, &quot;Churn&quot;)
data.show(5)</pre></div><div class='content'></div><h2>4. Model Building and Evaluation</h2>
<div class='content'><p>Build and evaluate your machine learning model using Spark MLlib.</p>
<p><strong>Example:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmZlYXR1cmUgaW1wb3J0IFZlY3RvckFzc2VtYmxlcgpmcm9tIHB5c3BhcmsubWwuY2xhc3NpZmljYXRpb24gaW1wb3J0IExvZ2lzdGljUmVncmVzc2lvbgpmcm9tIHB5c3BhcmsubWwuZXZhbHVhdGlvbiBpbXBvcnQgQmluYXJ5Q2xhc3NpZmljYXRpb25FdmFsdWF0b3IKCiMgQXNzZW1ibGUgZmVhdHVyZXMKYXNzZW1ibGVyID0gVmVjdG9yQXNzZW1ibGVyKGlucHV0Q29scz1bImdlbmRlckluZGV4IiwgInNlbmlvckNpdGl6ZW5JbmRleCIsICJwYXJ0bmVySW5kZXgiLCAiZGVwZW5kZW50c0luZGV4IiwgInRlbnVyZSIsICJNb250aGx5Q2hhcmdlcyIsICJUb3RhbENoYXJnZXMiXSwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRDb2w9ImZlYXR1cmVzIikKZGF0YSA9IGFzc2VtYmxlci50cmFuc2Zvcm0oZGF0YSkKCiMgU3BsaXQgZGF0YSBpbnRvIHRyYWluaW5nIGFuZCB0ZXN0IHNldHMKdHJhaW5fZGF0YSwgdGVzdF9kYXRhID0gZGF0YS5yYW5kb21TcGxpdChbMC43LCAwLjNdLCBzZWVkPTQyKQoKIyBCdWlsZCBsb2dpc3RpYyByZWdyZXNzaW9uIG1vZGVsCmxyID0gTG9naXN0aWNSZWdyZXNzaW9uKGxhYmVsQ29sPSJDaHVybiIsIGZlYXR1cmVzQ29sPSJmZWF0dXJlcyIpCm1vZGVsID0gbHIuZml0KHRyYWluX2RhdGEpCgojIEV2YWx1YXRlIG1vZGVsCnByZWRpY3Rpb25zID0gbW9kZWwudHJhbnNmb3JtKHRlc3RfZGF0YSkKZXZhbHVhdG9yID0gQmluYXJ5Q2xhc3NpZmljYXRpb25FdmFsdWF0b3IobGFiZWxDb2w9IkNodXJuIikKYWNjdXJhY3kgPSBldmFsdWF0b3IuZXZhbHVhdGUocHJlZGljdGlvbnMpCnByaW50KGYiTW9kZWwgQWNjdXJhY3k6IHthY2N1cmFjeX0iKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.feature import VectorAssembler
from pyspark.ml.classification import LogisticRegression
from pyspark.ml.evaluation import BinaryClassificationEvaluator

# Assemble features
assembler = VectorAssembler(inputCols=[&quot;genderIndex&quot;, &quot;seniorCitizenIndex&quot;, &quot;partnerIndex&quot;, &quot;dependentsIndex&quot;, &quot;tenure&quot;, &quot;MonthlyCharges&quot;, &quot;TotalCharges&quot;], 
                            outputCol=&quot;features&quot;)
data = assembler.transform(data)

# Split data into training and test sets
train_data, test_data = data.randomSplit([0.7, 0.3], seed=42)

# Build logistic regression model
lr = LogisticRegression(labelCol=&quot;Churn&quot;, featuresCol=&quot;features&quot;)
model = lr.fit(train_data)

# Evaluate model
predictions = model.transform(test_data)
evaluator = BinaryClassificationEvaluator(labelCol=&quot;Churn&quot;)
accuracy = evaluator.evaluate(predictions)
print(f&quot;Model Accuracy: {accuracy}&quot;)</pre></div><div class='content'></div><h2>5. Optimization and Tuning</h2>
<div class='content'><p>Optimize and tune your model to improve its performance.</p>
<p><strong>Example:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLnR1bmluZyBpbXBvcnQgUGFyYW1HcmlkQnVpbGRlciwgQ3Jvc3NWYWxpZGF0b3IKCiMgQ3JlYXRlIHBhcmFtZXRlciBncmlkCnBhcmFtR3JpZCA9IChQYXJhbUdyaWRCdWlsZGVyKCkKICAgICAgICAgICAgIC5hZGRHcmlkKGxyLnJlZ1BhcmFtLCBbMC4wMSwgMC4xLCAxLjBdKQogICAgICAgICAgICAgLmFkZEdyaWQobHIuZWxhc3RpY05ldFBhcmFtLCBbMC4wLCAwLjUsIDEuMF0pCiAgICAgICAgICAgICAuYnVpbGQoKSkKCiMgQ3Jvc3MtdmFsaWRhdGlvbgpjcm9zc3ZhbCA9IENyb3NzVmFsaWRhdG9yKGVzdGltYXRvcj1sciwKICAgICAgICAgICAgICAgICAgICAgICAgICBlc3RpbWF0b3JQYXJhbU1hcHM9cGFyYW1HcmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgIGV2YWx1YXRvcj1ldmFsdWF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtRm9sZHM9MykKCiMgRml0IG1vZGVsCmN2TW9kZWwgPSBjcm9zc3ZhbC5maXQodHJhaW5fZGF0YSkKCiMgRXZhbHVhdGUgYmVzdCBtb2RlbApiZXN0TW9kZWwgPSBjdk1vZGVsLmJlc3RNb2RlbApwcmVkaWN0aW9ucyA9IGJlc3RNb2RlbC50cmFuc2Zvcm0odGVzdF9kYXRhKQphY2N1cmFjeSA9IGV2YWx1YXRvci5ldmFsdWF0ZShwcmVkaWN0aW9ucykKcHJpbnQoZiJPcHRpbWl6ZWQgTW9kZWwgQWNjdXJhY3k6IHthY2N1cmFjeX0iKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.tuning import ParamGridBuilder, CrossValidator

# Create parameter grid
paramGrid = (ParamGridBuilder()
             .addGrid(lr.regParam, [0.01, 0.1, 1.0])
             .addGrid(lr.elasticNetParam, [0.0, 0.5, 1.0])
             .build())

# Cross-validation
crossval = CrossValidator(estimator=lr,
                          estimatorParamMaps=paramGrid,
                          evaluator=evaluator,
                          numFolds=3)

# Fit model
cvModel = crossval.fit(train_data)

# Evaluate best model
bestModel = cvModel.bestModel
predictions = bestModel.transform(test_data)
accuracy = evaluator.evaluate(predictions)
print(f&quot;Optimized Model Accuracy: {accuracy}&quot;)</pre></div><div class='content'></div><h2>6. Deployment</h2>
<div class='content'><p>Deploy your model to a production environment where it can be used to make predictions on new data.</p>
<p><strong>Example:</strong></p>
<ul>
<li>Save the model:</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YmVzdE1vZGVsLnNhdmUoInBhdGgvdG8vc2F2ZS9tb2RlbCIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>bestModel.save(&quot;path/to/save/model&quot;)</pre></div><div class='content'><ul>
<li>Load the model for future use:</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmNsYXNzaWZpY2F0aW9uIGltcG9ydCBMb2dpc3RpY1JlZ3Jlc3Npb25Nb2RlbAoKbG9hZGVkTW9kZWwgPSBMb2dpc3RpY1JlZ3Jlc3Npb25Nb2RlbC5sb2FkKCJwYXRoL3RvL3NhdmUvbW9kZWwiKQpuZXdfcHJlZGljdGlvbnMgPSBsb2FkZWRNb2RlbC50cmFuc2Zvcm0obmV3X2RhdGEp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.classification import LogisticRegressionModel

loadedModel = LogisticRegressionModel.load(&quot;path/to/save/model&quot;)
new_predictions = loadedModel.transform(new_data)</pre></div><div class='content'></div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Data Preparation</h2>
<div class='content'><ul>
<li>Load a dataset of your choice.</li>
<li>Handle missing values and perform necessary data transformations.</li>
</ul>
</div><h2>Exercise 2: Model Building</h2>
<div class='content'><ul>
<li>Build a machine learning model using Spark MLlib.</li>
<li>Evaluate the model's performance.</li>
</ul>
</div><h2>Exercise 3: Optimization</h2>
<div class='content'><ul>
<li>Tune the hyperparameters of your model to improve its accuracy.</li>
</ul>
</div><h2>Exercise 4: Deployment</h2>
<div class='content'><ul>
<li>Save your trained model and load it to make predictions on new data.</li>
</ul>
</div><h1>Summary</h1>
<div class='content'><p>In this section, we covered the implementation phase of your Capstone Project. We walked through defining the problem statement, data collection and preparation, data processing and transformation, model building and evaluation, optimization and tuning, and finally, deployment. By following these steps and completing the exercises, you will gain hands-on experience in solving real-world problems using Apache Spark.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='08-02-project-setup' title="Project Setup">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='08-04-presentation-review' title="Presentation and Review">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
