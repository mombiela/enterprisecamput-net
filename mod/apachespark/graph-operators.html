<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graph Operators in Apache Spark</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/graph-operators" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/graph-operators" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/graph-operators" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/apachespark/graph-operators" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/apachespark/graph-operators" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='graph-representation'>&#x25C4;Graph Representation</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Graph Operators in Apache Spark</a>
	</div>
	<div class='col-4 text-end'>
					<a href='graph-algorithms'>Graph Algorithms &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Graph Operators</h1>
<div class='content'><p>Graph operators are essential tools in graph processing and analysis. Apache Spark provides a powerful library called GraphX for graph-parallel computations. This section will introduce you to the basic concepts of graph operators and how they are implemented in Spark.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Graph</strong>: A collection of vertices (nodes) and edges (links) connecting pairs of vertices.</li>
<li><strong>GraphX</strong>: Spark's API for graphs and graph-parallel computation.</li>
<li><strong>RDD</strong>: Resilient Distributed Dataset, the fundamental data structure of Spark.</li>
</ul>
</div><h1>Basic Graph Operators</h1>
<div class='content'><p>GraphX provides a variety of operators to manipulate and analyze graphs. Here are some of the basic graph operators:</p>
</div><h2>Creating Graphs</h2>
<div class='content'><p>You can create graphs in GraphX using two RDDs: one for vertices and one for edges.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuc3BhcmsuZ3JhcGh4Ll8KaW1wb3J0IG9yZy5hcGFjaGUuc3BhcmsucmRkLlJERAoKLy8gQ3JlYXRlIGFuIFJERCBmb3IgdGhlIHZlcnRpY2VzCnZhbCB2ZXJ0aWNlczogUkREWyhWZXJ0ZXhJZCwgU3RyaW5nKV0gPSBzYy5wYXJhbGxlbGl6ZShBcnJheSgoMUwsICJBbGljZSIpLCAoMkwsICJCb2IiKSwgKDNMLCAiQ2hhcmxpZSIpKSkKCi8vIENyZWF0ZSBhbiBSREQgZm9yIGVkZ2VzCnZhbCBlZGdlczogUkREW0VkZ2VbU3RyaW5nXV0gPSBzYy5wYXJhbGxlbGl6ZShBcnJheShFZGdlKDFMLCAyTCwgImZyaWVuZCIpLCBFZGdlKDJMLCAzTCwgImZvbGxvdyIpKSkKCi8vIEJ1aWxkIHRoZSBpbml0aWFsIEdyYXBoCnZhbCBncmFwaDogR3JhcGhbU3RyaW5nLCBTdHJpbmddID0gR3JhcGgodmVydGljZXMsIGVkZ2VzKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.spark.graphx._
import org.apache.spark.rdd.RDD

// Create an RDD for the vertices
val vertices: RDD[(VertexId, String)] = sc.parallelize(Array((1L, &quot;Alice&quot;), (2L, &quot;Bob&quot;), (3L, &quot;Charlie&quot;)))

// Create an RDD for edges
val edges: RDD[Edge[String]] = sc.parallelize(Array(Edge(1L, 2L, &quot;friend&quot;), Edge(2L, 3L, &quot;follow&quot;)))

// Build the initial Graph
val graph: Graph[String, String] = Graph(vertices, edges)</pre></div><div class='content'></div><h2>Transforming Graphs</h2>
<div class='content'><p>GraphX allows you to transform graphs using the <code>mapVertices</code> and <code>mapEdges</code> operators.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gVHJhbnNmb3JtIHZlcnRpY2VzCnZhbCBuZXdHcmFwaCA9IGdyYXBoLm1hcFZlcnRpY2VzKChpZCwgbmFtZSkgPT4gbmFtZS50b1VwcGVyQ2FzZSkKCi8vIFRyYW5zZm9ybSBlZGdlcwp2YWwgbmV3R3JhcGhFZGdlcyA9IGdyYXBoLm1hcEVkZ2VzKGVkZ2UgPT4gZWRnZS5hdHRyLnRvVXBwZXJDYXNlKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Transform vertices
val newGraph = graph.mapVertices((id, name) =&gt; name.toUpperCase)

// Transform edges
val newGraphEdges = graph.mapEdges(edge =&gt; edge.attr.toUpperCase)</pre></div><div class='content'></div><h2>Subgraph</h2>
<div class='content'><p>You can create a subgraph by filtering vertices and edges.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ3JlYXRlIGEgc3ViZ3JhcGggd2hlcmUgdGhlIHZlcnRleCBuYW1lIHN0YXJ0cyB3aXRoICdBJwp2YWwgc3ViZ3JhcGggPSBncmFwaC5zdWJncmFwaCh2cHJlZCA9IChpZCwgbmFtZSkgPT4gbmFtZS5zdGFydHNXaXRoKCJBIikp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Create a subgraph where the vertex name starts with 'A'
val subgraph = graph.subgraph(vpred = (id, name) =&gt; name.startsWith(&quot;A&quot;))</pre></div><div class='content'></div><h2>Join Operators</h2>
<div class='content'><p>GraphX provides join operators to combine graphs with external data.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRXh0ZXJuYWwgZGF0YQp2YWwgZXh0ZXJuYWxEYXRhOiBSRERbKFZlcnRleElkLCBJbnQpXSA9IHNjLnBhcmFsbGVsaXplKEFycmF5KCgxTCwgMTAwKSwgKDJMLCAyMDApKSkKCi8vIEpvaW4gdGhlIGdyYXBoIHdpdGggdGhlIGV4dGVybmFsIGRhdGEKdmFsIGpvaW5lZEdyYXBoID0gZ3JhcGgub3V0ZXJKb2luVmVydGljZXMoZXh0ZXJuYWxEYXRhKSB7CiAgY2FzZSAoaWQsIG5hbWUsIFNvbWUoZGF0YSkpID0+IChuYW1lLCBkYXRhKQogIGNhc2UgKGlkLCBuYW1lLCBOb25lKSA9PiAobmFtZSwgMCkKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// External data
val externalData: RDD[(VertexId, Int)] = sc.parallelize(Array((1L, 100), (2L, 200)))

// Join the graph with the external data
val joinedGraph = graph.outerJoinVertices(externalData) {
  case (id, name, Some(data)) =&gt; (name, data)
  case (id, name, None) =&gt; (name, 0)
}</pre></div><div class='content'></div><h1>Advanced Graph Operators</h1>
<div class='content'><p>For more complex graph operations, GraphX provides advanced operators like <code>aggregateMessages</code> and <code>pregel</code>.</p>
</div><h2>Aggregate Messages</h2>
<div class='content'><p>The <code>aggregateMessages</code> operator allows you to send messages along edges and aggregate them at the destination vertices.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIG1lc3NhZ2VzID0gZ3JhcGguYWdncmVnYXRlTWVzc2FnZXNbSW50XSgKICB0cmlwbGV0ID0+IHsKICAgIC8vIFNlbmQgbWVzc2FnZSB0byBkZXN0aW5hdGlvbiB2ZXJ0ZXgKICAgIHRyaXBsZXQuc2VuZFRvRHN0KDEpCiAgfSwKICAvLyBTdW0gdGhlIG1lc3NhZ2VzCiAgXyArIF8KKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val messages = graph.aggregateMessages[Int](
  triplet =&gt; {
    // Send message to destination vertex
    triplet.sendToDst(1)
  },
  // Sum the messages
  _ + _
)</pre></div><div class='content'></div><h2>Pregel API</h2>
<div class='content'><p>The Pregel API is used for iterative graph algorithms. It allows you to perform computations in a vertex-centric manner.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIGluaXRpYWxNc2cgPSAwCnZhbCBtYXhJdGVyYXRpb25zID0gNQoKdmFsIHByZWdlbEdyYXBoID0gZ3JhcGgucHJlZ2VsKGluaXRpYWxNc2csIG1heEl0ZXJhdGlvbnMpKAogIChpZCwgYXR0ciwgbXNnKSA9PiBhdHRyICsgbXNnLCAvLyBWZXJ0ZXggUHJvZ3JhbQogIHRyaXBsZXQgPT4geyAvLyBTZW5kIE1lc3NhZ2UKICAgIEl0ZXJhdG9yKCh0cmlwbGV0LmRzdElkLCB0cmlwbGV0LnNyY0F0dHIgKyAxKSkKICB9LAogIChhLCBiKSA9PiBhICsgYiAvLyBNZXJnZSBNZXNzYWdlCik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val initialMsg = 0
val maxIterations = 5

val pregelGraph = graph.pregel(initialMsg, maxIterations)(
  (id, attr, msg) =&gt; attr + msg, // Vertex Program
  triplet =&gt; { // Send Message
    Iterator((triplet.dstId, triplet.srcAttr + 1))
  },
  (a, b) =&gt; a + b // Merge Message
)</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Graph operators in Apache Spark's GraphX provide a robust framework for graph processing and analysis. By understanding and utilizing these operators, you can perform a wide range of graph computations efficiently. From basic transformations to advanced iterative algorithms, GraphX equips you with the tools needed to handle complex graph data.</p>
</div><h2>Summary</h2>
<div class='content'><ul>
<li><strong>GraphX</strong>: Spark's API for graph-parallel computations.</li>
<li><strong>Basic Operators</strong>: Creating, transforming, and subgraphing graphs.</li>
<li><strong>Advanced Operators</strong>: Aggregate messages and Pregel API for iterative algorithms.</li>
</ul>
<p>By mastering these operators, you can leverage the full power of GraphX to solve real-world graph problems.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='graph-representation'>&#x25C4;Graph Representation</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Graph Operators in Apache Spark</a>
	</div>
	<div class='col-4 text-end'>
					<a href='graph-algorithms'>Graph Algorithms &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
