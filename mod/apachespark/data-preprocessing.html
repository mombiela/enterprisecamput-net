<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Preprocessing in Apache Spark</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/data-preprocessing" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/data-preprocessing" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/data-preprocessing" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/apachespark/data-preprocessing" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/apachespark/data-preprocessing" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='basic-statistics'>&#x25C4;Basic Statistics</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Data Preprocessing in Apache Spark</a>
	</div>
	<div class='col-4 text-end'>
					<a href='classification-and-regression'>Classification and Regression &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Data preprocessing is a crucial step in the data analysis pipeline. It involves cleaning, transforming, and preparing raw data for analysis. In this section, we will cover the basics of data preprocessing using Apache Spark, progressing from beginner to advanced levels.</p>
</div><h1>Introduction to Data Preprocessing</h1>
<div class='content'><p>Data preprocessing involves several steps to ensure that the data is in a suitable format for analysis. These steps include:</p>
<ul>
<li>Data Cleaning</li>
<li>Data Transformation</li>
<li>Data Integration</li>
<li>Data Reduction</li>
</ul>
</div><h1>Setting Up Apache Spark</h1>
<div class='content'><p>Before diving into data preprocessing, ensure you have Apache Spark installed and set up. You can follow the official <a href="https://spark.apache.org/docs/latest/">Apache Spark documentation</a> for installation instructions.</p>
</div><h2>Example: Initializing Spark Session</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaXRpYWxpemUgYSBTcGFyayBzZXNzaW9uCnNwYXJrID0gU3BhcmtTZXNzaW9uLmJ1aWxkZXIgXAogICAgLmFwcE5hbWUoIkRhdGFQcmVwcm9jZXNzaW5nIikgXAogICAgLmdldE9yQ3JlYXRlKCkKCiMgQ2hlY2sgU3Bhcmsgc2Vzc2lvbgpwcmludChzcGFyayk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Initialize a Spark session
spark = SparkSession.builder \
    .appName(&quot;DataPreprocessing&quot;) \
    .getOrCreate()

# Check Spark session
print(spark)</pre></div><div class='content'></div><h1>Data Cleaning</h1>
<div class='content'><p>Data cleaning involves handling missing values, removing duplicates, and correcting errors in the dataset.</p>
</div><h2>Handling Missing Values</h2>
<div class='content'><ul>
<li><strong>Drop missing values</strong>: Remove rows with missing values.</li>
<li><strong>Fill missing values</strong>: Replace missing values with a specific value or a statistical measure (mean, median, etc.).</li>
</ul>
<h4>Example: Dropping Missing Values</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMb2FkIHNhbXBsZSBkYXRhCmRhdGEgPSBbKCJBbGljZSIsIDM0LCBOb25lKSwgKCJCb2IiLCBOb25lLCAiSFIiKSwgKCJDYXRoeSIsIDI5LCAiSVQiKV0KY29sdW1ucyA9IFsiTmFtZSIsICJBZ2UiLCAiRGVwYXJ0bWVudCJdCmRmID0gc3BhcmsuY3JlYXRlRGF0YUZyYW1lKGRhdGEsIGNvbHVtbnMpCgojIERyb3Agcm93cyB3aXRoIGFueSBtaXNzaW5nIHZhbHVlcwpkZl9jbGVhbmVkID0gZGYubmEuZHJvcCgpCgpkZl9jbGVhbmVkLnNob3coKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Load sample data
data = [(&quot;Alice&quot;, 34, None), (&quot;Bob&quot;, None, &quot;HR&quot;), (&quot;Cathy&quot;, 29, &quot;IT&quot;)]
columns = [&quot;Name&quot;, &quot;Age&quot;, &quot;Department&quot;]
df = spark.createDataFrame(data, columns)

# Drop rows with any missing values
df_cleaned = df.na.drop()

df_cleaned.show()</pre></div><div class='content'><h4>Example: Filling Missing Values</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBGaWxsIG1pc3NpbmcgdmFsdWVzIHdpdGggYSBzcGVjaWZpYyB2YWx1ZQpkZl9maWxsZWQgPSBkZi5uYS5maWxsKHsiQWdlIjogMCwgIkRlcGFydG1lbnQiOiAiVW5rbm93biJ9KQoKZGZfZmlsbGVkLnNob3coKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Fill missing values with a specific value
df_filled = df.na.fill({&quot;Age&quot;: 0, &quot;Department&quot;: &quot;Unknown&quot;})

df_filled.show()</pre></div><div class='content'></div><h1>Data Transformation</h1>
<div class='content'><p>Data transformation involves converting data into a suitable format for analysis. Common transformations include normalization, scaling, and encoding categorical variables.</p>
</div><h2>Normalization and Scaling</h2>
<div class='content'><ul>
<li><strong>Normalization</strong>: Adjusts the range of data.</li>
<li><strong>Scaling</strong>: Adjusts the scale of data.</li>
</ul>
<h4>Example: Scaling Data</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmZlYXR1cmUgaW1wb3J0IE1pbk1heFNjYWxlcgpmcm9tIHB5c3BhcmsubWwubGluYWxnIGltcG9ydCBWZWN0b3JzCgojIFNhbXBsZSBkYXRhCmRhdGEgPSBbKDAsIFZlY3RvcnMuZGVuc2UoWzEuMCwgMC4xLCAtMS4wXSksKSwKICAgICAgICAoMSwgVmVjdG9ycy5kZW5zZShbMi4wLCAxLjEsIDEuMF0pLCksCiAgICAgICAgKDIsIFZlY3RvcnMuZGVuc2UoWzMuMCwgMTAuMSwgMy4wXSksKV0KZGYgPSBzcGFyay5jcmVhdGVEYXRhRnJhbWUoZGF0YSwgWyJpZCIsICJmZWF0dXJlcyJdKQoKIyBJbml0aWFsaXplIE1pbk1heFNjYWxlcgpzY2FsZXIgPSBNaW5NYXhTY2FsZXIoaW5wdXRDb2w9ImZlYXR1cmVzIiwgb3V0cHV0Q29sPSJzY2FsZWRGZWF0dXJlcyIpCgojIEZpdCBhbmQgdHJhbnNmb3JtIHRoZSBkYXRhCnNjYWxlck1vZGVsID0gc2NhbGVyLmZpdChkZikKc2NhbGVkRGF0YSA9IHNjYWxlck1vZGVsLnRyYW5zZm9ybShkZikKCnNjYWxlZERhdGEuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.feature import MinMaxScaler
from pyspark.ml.linalg import Vectors

# Sample data
data = [(0, Vectors.dense([1.0, 0.1, -1.0]),),
        (1, Vectors.dense([2.0, 1.1, 1.0]),),
        (2, Vectors.dense([3.0, 10.1, 3.0]),)]
df = spark.createDataFrame(data, [&quot;id&quot;, &quot;features&quot;])

# Initialize MinMaxScaler
scaler = MinMaxScaler(inputCol=&quot;features&quot;, outputCol=&quot;scaledFeatures&quot;)

# Fit and transform the data
scalerModel = scaler.fit(df)
scaledData = scalerModel.transform(df)

scaledData.show()</pre></div><div class='content'></div><h2>Encoding Categorical Variables</h2>
<div class='content'><ul>
<li><strong>One-Hot Encoding</strong>: Converts categorical variables into binary vectors.</li>
<li><strong>String Indexing</strong>: Assigns numerical indices to categorical variables.</li>
</ul>
<h4>Example: One-Hot Encoding</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmZlYXR1cmUgaW1wb3J0IE9uZUhvdEVuY29kZXIsIFN0cmluZ0luZGV4ZXIKCiMgU2FtcGxlIGRhdGEKZGF0YSA9IFsoIkhSIiwpLCAoIklUIiwpLCAoIkhSIiwpLCAoIkZpbmFuY2UiLCldCmRmID0gc3BhcmsuY3JlYXRlRGF0YUZyYW1lKGRhdGEsIFsiRGVwYXJ0bWVudCJdKQoKIyBTdHJpbmdJbmRleGVyCmluZGV4ZXIgPSBTdHJpbmdJbmRleGVyKGlucHV0Q29sPSJEZXBhcnRtZW50Iiwgb3V0cHV0Q29sPSJEZXB0SW5kZXgiKQpkZl9pbmRleGVkID0gaW5kZXhlci5maXQoZGYpLnRyYW5zZm9ybShkZikKCiMgT25lSG90RW5jb2RlcgplbmNvZGVyID0gT25lSG90RW5jb2RlcihpbnB1dENvbD0iRGVwdEluZGV4Iiwgb3V0cHV0Q29sPSJEZXB0VmVjIikKZGZfZW5jb2RlZCA9IGVuY29kZXIuZml0KGRmX2luZGV4ZWQpLnRyYW5zZm9ybShkZl9pbmRleGVkKQoKZGZfZW5jb2RlZC5zaG93KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.feature import OneHotEncoder, StringIndexer

# Sample data
data = [(&quot;HR&quot;,), (&quot;IT&quot;,), (&quot;HR&quot;,), (&quot;Finance&quot;,)]
df = spark.createDataFrame(data, [&quot;Department&quot;])

# StringIndexer
indexer = StringIndexer(inputCol=&quot;Department&quot;, outputCol=&quot;DeptIndex&quot;)
df_indexed = indexer.fit(df).transform(df)

# OneHotEncoder
encoder = OneHotEncoder(inputCol=&quot;DeptIndex&quot;, outputCol=&quot;DeptVec&quot;)
df_encoded = encoder.fit(df_indexed).transform(df_indexed)

df_encoded.show()</pre></div><div class='content'></div><h1>Data Integration</h1>
<div class='content'><p>Data integration involves combining data from different sources into a single dataset.</p>
</div><h2>Example: Joining DataFrames</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTYW1wbGUgZGF0YQpkYXRhMSA9IFsoIkFsaWNlIiwgMzQpLCAoIkJvYiIsIDQ1KV0KZGF0YTIgPSBbKCJBbGljZSIsICJIUiIpLCAoIkJvYiIsICJJVCIpXQpjb2x1bW5zMSA9IFsiTmFtZSIsICJBZ2UiXQpjb2x1bW5zMiA9IFsiTmFtZSIsICJEZXBhcnRtZW50Il0KCmRmMSA9IHNwYXJrLmNyZWF0ZURhdGFGcmFtZShkYXRhMSwgY29sdW1uczEpCmRmMiA9IHNwYXJrLmNyZWF0ZURhdGFGcmFtZShkYXRhMiwgY29sdW1uczIpCgojIEpvaW4gRGF0YUZyYW1lcwpkZl9qb2luZWQgPSBkZjEuam9pbihkZjIsIG9uPSJOYW1lIiwgaG93PSJpbm5lciIpCgpkZl9qb2luZWQuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Sample data
data1 = [(&quot;Alice&quot;, 34), (&quot;Bob&quot;, 45)]
data2 = [(&quot;Alice&quot;, &quot;HR&quot;), (&quot;Bob&quot;, &quot;IT&quot;)]
columns1 = [&quot;Name&quot;, &quot;Age&quot;]
columns2 = [&quot;Name&quot;, &quot;Department&quot;]

df1 = spark.createDataFrame(data1, columns1)
df2 = spark.createDataFrame(data2, columns2)

# Join DataFrames
df_joined = df1.join(df2, on=&quot;Name&quot;, how=&quot;inner&quot;)

df_joined.show()</pre></div><div class='content'></div><h1>Data Reduction</h1>
<div class='content'><p>Data reduction involves reducing the volume of data while maintaining its integrity. Techniques include sampling, feature selection, and dimensionality reduction.</p>
</div><h2>Example: Feature Selection</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmZlYXR1cmUgaW1wb3J0IFZlY3RvckFzc2VtYmxlcgpmcm9tIHB5c3BhcmsubWwuc3RhdCBpbXBvcnQgQ29ycmVsYXRpb24KCiMgU2FtcGxlIGRhdGEKZGF0YSA9IFsoMSwgMC4xLCAtMS4wLCAzLjApLCAoMiwgMS4xLCAxLjAsIDIuMCksICgzLCAxMC4xLCAzLjAsIDEuMCldCmNvbHVtbnMgPSBbImlkIiwgImZlYXR1cmUxIiwgImZlYXR1cmUyIiwgImZlYXR1cmUzIl0KZGYgPSBzcGFyay5jcmVhdGVEYXRhRnJhbWUoZGF0YSwgY29sdW1ucykKCiMgQXNzZW1ibGUgZmVhdHVyZXMgaW50byBhIHNpbmdsZSB2ZWN0b3IKYXNzZW1ibGVyID0gVmVjdG9yQXNzZW1ibGVyKGlucHV0Q29scz1bImZlYXR1cmUxIiwgImZlYXR1cmUyIiwgImZlYXR1cmUzIl0sIG91dHB1dENvbD0iZmVhdHVyZXMiKQpkZl92ZWN0b3IgPSBhc3NlbWJsZXIudHJhbnNmb3JtKGRmKQoKIyBDb21wdXRlIGNvcnJlbGF0aW9uIG1hdHJpeApjb3JyZWxhdGlvbl9tYXRyaXggPSBDb3JyZWxhdGlvbi5jb3JyKGRmX3ZlY3RvciwgImZlYXR1cmVzIikuaGVhZCgpWzBdCnByaW50KCJDb3JyZWxhdGlvbiBtYXRyaXg6XG4iLCBjb3JyZWxhdGlvbl9tYXRyaXgp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.feature import VectorAssembler
from pyspark.ml.stat import Correlation

# Sample data
data = [(1, 0.1, -1.0, 3.0), (2, 1.1, 1.0, 2.0), (3, 10.1, 3.0, 1.0)]
columns = [&quot;id&quot;, &quot;feature1&quot;, &quot;feature2&quot;, &quot;feature3&quot;]
df = spark.createDataFrame(data, columns)

# Assemble features into a single vector
assembler = VectorAssembler(inputCols=[&quot;feature1&quot;, &quot;feature2&quot;, &quot;feature3&quot;], outputCol=&quot;features&quot;)
df_vector = assembler.transform(df)

# Compute correlation matrix
correlation_matrix = Correlation.corr(df_vector, &quot;features&quot;).head()[0]
print(&quot;Correlation matrix:\n&quot;, correlation_matrix)</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Data preprocessing is a fundamental step in the data analysis pipeline. Using Apache Spark, we can efficiently clean, transform, integrate, and reduce data at scale. By mastering these techniques, you can ensure that your data is ready for analysis and modeling, leading to more accurate and reliable results.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='basic-statistics'>&#x25C4;Basic Statistics</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Data Preprocessing in Apache Spark</a>
	</div>
	<div class='col-4 text-end'>
					<a href='classification-and-regression'>Classification and Regression &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
