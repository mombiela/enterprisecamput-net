<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Model Evaluation and Tuning</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/model-evaluation-and-tuning" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/model-evaluation-and-tuning" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/model-evaluation-and-tuning" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/apachespark/model-evaluation-and-tuning" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/apachespark/model-evaluation-and-tuning" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='collaborative-filtering'>&#x25C4;Collaborative Filtering</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Model Evaluation and Tuning</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-graphx'>Introduction to GraphX &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Model evaluation and tuning are critical steps in the machine learning pipeline. They ensure that the models you build are not only accurate but also generalize well to unseen data. In this section, we will explore how to evaluate and tune machine learning models using Apache Spark's MLlib.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Model Evaluation</strong>: The process of assessing how well a model performs.</li>
<li><strong>Model Tuning</strong>: The process of optimizing the model parameters to improve performance.</li>
<li><strong>Cross-Validation</strong>: A technique to evaluate the model's performance by splitting the data into training and testing sets multiple times.</li>
<li><strong>Hyperparameters</strong>: Parameters that are set before the learning process begins and control the learning process.</li>
</ul>
</div><h1>Model Evaluation</h1>
<div class='content'></div><h2>Metrics</h2>
<div class='content'><p>Spark MLlib provides several metrics to evaluate the performance of machine learning models:</p>
<ul>
<li><strong>Classification Metrics</strong>: Accuracy, Precision, Recall, F1 Score, etc.</li>
<li><strong>Regression Metrics</strong>: Mean Squared Error (MSE), Root Mean Squared Error (RMSE), Mean Absolute Error (MAE), R-squared, etc.</li>
</ul>
</div><h2>Example: Evaluating a Classification Model</h2>
<div class='content'><p>Let's evaluate a logistic regression model using accuracy as the metric.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmNsYXNzaWZpY2F0aW9uIGltcG9ydCBMb2dpc3RpY1JlZ3Jlc3Npb24KZnJvbSBweXNwYXJrLm1sLmV2YWx1YXRpb24gaW1wb3J0IE11bHRpY2xhc3NDbGFzc2lmaWNhdGlvbkV2YWx1YXRvcgpmcm9tIHB5c3Bhcmsuc3FsIGltcG9ydCBTcGFya1Nlc3Npb24KCiMgSW5pdGlhbGl6ZSBTcGFyayBzZXNzaW9uCnNwYXJrID0gU3BhcmtTZXNzaW9uLmJ1aWxkZXIuYXBwTmFtZSgiTW9kZWxFdmFsdWF0aW9uIikuZ2V0T3JDcmVhdGUoKQoKIyBMb2FkIGRhdGEKZGF0YSA9IHNwYXJrLnJlYWQuZm9ybWF0KCJsaWJzdm0iKS5sb2FkKCJkYXRhL21sbGliL3NhbXBsZV9saWJzdm1fZGF0YS50eHQiKQoKIyBTcGxpdCBkYXRhIGludG8gdHJhaW5pbmcgYW5kIHRlc3Qgc2V0cwp0cmFpbl9kYXRhLCB0ZXN0X2RhdGEgPSBkYXRhLnJhbmRvbVNwbGl0KFswLjcsIDAuM10pCgojIFRyYWluIGEgbG9naXN0aWMgcmVncmVzc2lvbiBtb2RlbApsciA9IExvZ2lzdGljUmVncmVzc2lvbigpCm1vZGVsID0gbHIuZml0KHRyYWluX2RhdGEpCgojIE1ha2UgcHJlZGljdGlvbnMKcHJlZGljdGlvbnMgPSBtb2RlbC50cmFuc2Zvcm0odGVzdF9kYXRhKQoKIyBFdmFsdWF0ZSB0aGUgbW9kZWwKZXZhbHVhdG9yID0gTXVsdGljbGFzc0NsYXNzaWZpY2F0aW9uRXZhbHVhdG9yKG1ldHJpY05hbWU9ImFjY3VyYWN5IikKYWNjdXJhY3kgPSBldmFsdWF0b3IuZXZhbHVhdGUocHJlZGljdGlvbnMpCnByaW50KGYiVGVzdCBBY2N1cmFjeToge2FjY3VyYWN5fSIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.classification import LogisticRegression
from pyspark.ml.evaluation import MulticlassClassificationEvaluator
from pyspark.sql import SparkSession

# Initialize Spark session
spark = SparkSession.builder.appName(&quot;ModelEvaluation&quot;).getOrCreate()

# Load data
data = spark.read.format(&quot;libsvm&quot;).load(&quot;data/mllib/sample_libsvm_data.txt&quot;)

# Split data into training and test sets
train_data, test_data = data.randomSplit([0.7, 0.3])

# Train a logistic regression model
lr = LogisticRegression()
model = lr.fit(train_data)

# Make predictions
predictions = model.transform(test_data)

# Evaluate the model
evaluator = MulticlassClassificationEvaluator(metricName=&quot;accuracy&quot;)
accuracy = evaluator.evaluate(predictions)
print(f&quot;Test Accuracy: {accuracy}&quot;)</pre></div><div class='content'></div><h2>Example: Evaluating a Regression Model</h2>
<div class='content'><p>Let's evaluate a linear regression model using RMSE as the metric.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLnJlZ3Jlc3Npb24gaW1wb3J0IExpbmVhclJlZ3Jlc3Npb24KZnJvbSBweXNwYXJrLm1sLmV2YWx1YXRpb24gaW1wb3J0IFJlZ3Jlc3Npb25FdmFsdWF0b3IKCiMgTG9hZCBkYXRhCmRhdGEgPSBzcGFyay5yZWFkLmZvcm1hdCgibGlic3ZtIikubG9hZCgiZGF0YS9tbGxpYi9zYW1wbGVfbGluZWFyX3JlZ3Jlc3Npb25fZGF0YS50eHQiKQoKIyBTcGxpdCBkYXRhIGludG8gdHJhaW5pbmcgYW5kIHRlc3Qgc2V0cwp0cmFpbl9kYXRhLCB0ZXN0X2RhdGEgPSBkYXRhLnJhbmRvbVNwbGl0KFswLjcsIDAuM10pCgojIFRyYWluIGEgbGluZWFyIHJlZ3Jlc3Npb24gbW9kZWwKbHIgPSBMaW5lYXJSZWdyZXNzaW9uKCkKbW9kZWwgPSBsci5maXQodHJhaW5fZGF0YSkKCiMgTWFrZSBwcmVkaWN0aW9ucwpwcmVkaWN0aW9ucyA9IG1vZGVsLnRyYW5zZm9ybSh0ZXN0X2RhdGEpCgojIEV2YWx1YXRlIHRoZSBtb2RlbApldmFsdWF0b3IgPSBSZWdyZXNzaW9uRXZhbHVhdG9yKG1ldHJpY05hbWU9InJtc2UiKQpybXNlID0gZXZhbHVhdG9yLmV2YWx1YXRlKHByZWRpY3Rpb25zKQpwcmludChmIlRlc3QgUk1TRToge3Jtc2V9Iik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.regression import LinearRegression
from pyspark.ml.evaluation import RegressionEvaluator

# Load data
data = spark.read.format(&quot;libsvm&quot;).load(&quot;data/mllib/sample_linear_regression_data.txt&quot;)

# Split data into training and test sets
train_data, test_data = data.randomSplit([0.7, 0.3])

# Train a linear regression model
lr = LinearRegression()
model = lr.fit(train_data)

# Make predictions
predictions = model.transform(test_data)

# Evaluate the model
evaluator = RegressionEvaluator(metricName=&quot;rmse&quot;)
rmse = evaluator.evaluate(predictions)
print(f&quot;Test RMSE: {rmse}&quot;)</pre></div><div class='content'></div><h1>Model Tuning</h1>
<div class='content'></div><h2>Hyperparameter Tuning</h2>
<div class='content'><p>Hyperparameter tuning involves finding the best set of hyperparameters for a model. Spark MLlib provides tools like <code>ParamGridBuilder</code> and <code>CrossValidator</code> to facilitate this process.</p>
</div><h2>Example: Hyperparameter Tuning with Cross-Validation</h2>
<div class='content'><p>Let's tune the hyperparameters of a logistic regression model using cross-validation.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLnR1bmluZyBpbXBvcnQgUGFyYW1HcmlkQnVpbGRlciwgQ3Jvc3NWYWxpZGF0b3IKCiMgRGVmaW5lIHRoZSBwYXJhbWV0ZXIgZ3JpZApwYXJhbUdyaWQgPSBQYXJhbUdyaWRCdWlsZGVyKCkgXAogICAgLmFkZEdyaWQobHIucmVnUGFyYW0sIFswLjEsIDAuMDFdKSBcCiAgICAuYWRkR3JpZChsci5lbGFzdGljTmV0UGFyYW0sIFswLjAsIDAuNSwgMS4wXSkgXAogICAgLmJ1aWxkKCkKCiMgRGVmaW5lIHRoZSBjcm9zcy12YWxpZGF0b3IKY3Jvc3N2YWwgPSBDcm9zc1ZhbGlkYXRvcihlc3RpbWF0b3I9bHIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZXN0aW1hdG9yUGFyYW1NYXBzPXBhcmFtR3JpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICBldmFsdWF0b3I9ZXZhbHVhdG9yLAogICAgICAgICAgICAgICAgICAgICAgICAgIG51bUZvbGRzPTMpCgojIFJ1biBjcm9zcy12YWxpZGF0aW9uIGFuZCBjaG9vc2UgdGhlIGJlc3Qgc2V0IG9mIHBhcmFtZXRlcnMKY3ZNb2RlbCA9IGNyb3NzdmFsLmZpdCh0cmFpbl9kYXRhKQoKIyBNYWtlIHByZWRpY3Rpb25zIG9uIHRoZSB0ZXN0IGRhdGEKcHJlZGljdGlvbnMgPSBjdk1vZGVsLnRyYW5zZm9ybSh0ZXN0X2RhdGEpCgojIEV2YWx1YXRlIHRoZSB0dW5lZCBtb2RlbAphY2N1cmFjeSA9IGV2YWx1YXRvci5ldmFsdWF0ZShwcmVkaWN0aW9ucykKcHJpbnQoZiJUdW5lZCBUZXN0IEFjY3VyYWN5OiB7YWNjdXJhY3l9Iik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.tuning import ParamGridBuilder, CrossValidator

# Define the parameter grid
paramGrid = ParamGridBuilder() \
    .addGrid(lr.regParam, [0.1, 0.01]) \
    .addGrid(lr.elasticNetParam, [0.0, 0.5, 1.0]) \
    .build()

# Define the cross-validator
crossval = CrossValidator(estimator=lr,
                          estimatorParamMaps=paramGrid,
                          evaluator=evaluator,
                          numFolds=3)

# Run cross-validation and choose the best set of parameters
cvModel = crossval.fit(train_data)

# Make predictions on the test data
predictions = cvModel.transform(test_data)

# Evaluate the tuned model
accuracy = evaluator.evaluate(predictions)
print(f&quot;Tuned Test Accuracy: {accuracy}&quot;)</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Model evaluation and tuning are essential for building robust machine learning models. Apache Spark MLlib provides a comprehensive set of tools to evaluate and tune models efficiently. By understanding and applying these techniques, you can significantly improve the performance and reliability of your machine learning applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='collaborative-filtering'>&#x25C4;Collaborative Filtering</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Model Evaluation and Tuning</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-graphx'>Introduction to GraphX &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
