<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Running Spark on Azure</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/06-02-running-spark-azure" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/06-02-running-spark-azure" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/06-02-running-spark-azure" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/apachespark/06-02-running-spark-azure" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/apachespark/06-02-running-spark-azure" class="px-2">CA</a>
					</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-01-running-spark-aws' title="Running Spark on AWS">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Running Spark on Azure</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-03-running-spark-google-cloud' title="Running Spark on Google Cloud">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to run Apache Spark on Microsoft Azure. Azure provides a robust platform for deploying and managing Spark applications, offering various services and tools to simplify the process. By the end of this module, you will be able to set up and run Spark applications on Azure, leveraging its cloud capabilities for scalable and efficient data processing.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Azure HDInsight</strong>: A fully-managed cloud service that makes it easy to process big data using popular open-source frameworks such as Apache Hadoop, Apache Spark, Apache Hive, and Apache Kafka.</li>
<li><strong>Azure Databricks</strong>: An Apache Spark-based analytics platform optimized for the Microsoft Azure cloud services platform.</li>
<li><strong>Azure Synapse Analytics</strong>: A limitless analytics service that brings together big data and data warehousing.</li>
</ol>
</div><h1><p>Setting Up Spark on Azure HDInsight</p>
</h1>
<div class='content'></div><h2><p>Step-by-Step Guide</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Create an HDInsight Cluster</strong>:</p>
<ul>
<li>Navigate to the Azure portal.</li>
<li>Click on &quot;Create a resource&quot; and search for &quot;HDInsight&quot;.</li>
<li>Click &quot;Create&quot; and fill in the necessary details such as subscription, resource group, cluster name, and region.</li>
<li>Choose the cluster type as &quot;Spark&quot;.</li>
<li>Configure the cluster size and other settings as per your requirements.</li>
<li>Review and create the cluster.</li>
</ul>
</li>
<li>
<p><strong>Accessing the Cluster</strong>:</p>
<ul>
<li>Once the cluster is created, go to the HDInsight cluster dashboard.</li>
<li>Use the &quot;Cluster Dashboard&quot; link to access the Ambari management interface.</li>
<li>From Ambari, you can manage and monitor your Spark cluster.</li>
</ul>
</li>
<li>
<p><strong>Submitting Spark Jobs</strong>:</p>
<ul>
<li>Use the Ambari interface or SSH into the cluster to submit Spark jobs.</li>
<li>Example command to submit a Spark job:
<pre><code class="language-bash">spark-submit --class org.apache.spark.examples.SparkPi --master yarn --deploy-mode cluster /usr/hdp/current/spark2-client/examples/jars/spark-examples_2.11-2.3.0.jar 10
</code></pre>
</li>
</ul>
</li>
</ol>
</div><h1><p>Setting Up Spark on Azure Databricks</p>
</h1>
<div class='content'></div><h2><p>Step-by-Step Guide</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Create an Azure Databricks Workspace</strong>:</p>
<ul>
<li>Navigate to the Azure portal.</li>
<li>Click on &quot;Create a resource&quot; and search for &quot;Azure Databricks&quot;.</li>
<li>Click &quot;Create&quot; and fill in the necessary details such as subscription, resource group, workspace name, and region.</li>
<li>Click &quot;Create&quot; to deploy the workspace.</li>
</ul>
</li>
<li>
<p><strong>Create a Databricks Cluster</strong>:</p>
<ul>
<li>Go to the Azure Databricks workspace you created.</li>
<li>Click on &quot;Clusters&quot; in the left-hand menu.</li>
<li>Click &quot;Create Cluster&quot; and configure the cluster settings such as cluster name, cluster mode, and worker nodes.</li>
<li>Click &quot;Create Cluster&quot; to start the cluster.</li>
</ul>
</li>
<li>
<p><strong>Running Spark Jobs</strong>:</p>
<ul>
<li>Once the cluster is running, click on &quot;Workspace&quot; in the left-hand menu.</li>
<li>Create a new notebook by clicking on the &quot;Create&quot; button and selecting &quot;Notebook&quot;.</li>
<li>Choose a language (e.g., Scala, Python) and attach the notebook to your cluster.</li>
<li>Write and run Spark code in the notebook. For example:
<pre><code class="language-python">from pyspark.sql import SparkSession

spark = SparkSession.builder.appName(&quot;example&quot;).getOrCreate()
data = [(&quot;Alice&quot;, 34), (&quot;Bob&quot;, 45), (&quot;Cathy&quot;, 29)]
df = spark.createDataFrame(data, [&quot;Name&quot;, &quot;Age&quot;])
df.show()
</code></pre>
</li>
</ul>
</li>
</ol>
</div><h1><p>Setting Up Spark on Azure Synapse Analytics</p>
</h1>
<div class='content'></div><h2><p>Step-by-Step Guide</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Create an Azure Synapse Workspace</strong>:</p>
<ul>
<li>Navigate to the Azure portal.</li>
<li>Click on &quot;Create a resource&quot; and search for &quot;Azure Synapse Analytics&quot;.</li>
<li>Click &quot;Create&quot; and fill in the necessary details such as subscription, resource group, workspace name, and region.</li>
<li>Click &quot;Review + create&quot; and then &quot;Create&quot; to deploy the workspace.</li>
</ul>
</li>
<li>
<p><strong>Create a Spark Pool</strong>:</p>
<ul>
<li>Go to the Azure Synapse workspace you created.</li>
<li>Click on &quot;Manage&quot; in the left-hand menu.</li>
<li>Under &quot;Apache Spark pools&quot;, click &quot;New&quot;.</li>
<li>Configure the Spark pool settings such as pool name, node size, and number of nodes.</li>
<li>Click &quot;Create&quot; to create the Spark pool.</li>
</ul>
</li>
<li>
<p><strong>Running Spark Jobs</strong>:</p>
<ul>
<li>Go to the &quot;Develop&quot; section in the left-hand menu.</li>
<li>Create a new notebook by clicking on the &quot;New&quot; button and selecting &quot;Notebook&quot;.</li>
<li>Attach the notebook to your Spark pool.</li>
<li>Write and run Spark code in the notebook. For example:
<pre><code class="language-python">from pyspark.sql import SparkSession

spark = SparkSession.builder.appName(&quot;example&quot;).getOrCreate()
data = [(&quot;Alice&quot;, 34), (&quot;Bob&quot;, 45), (&quot;Cathy&quot;, 29)]
df = spark.createDataFrame(data, [&quot;Name&quot;, &quot;Age&quot;])
df.show()
</code></pre>
</li>
</ul>
</li>
</ol>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Running a Spark Job on Azure Databricks</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Create a Databricks Cluster</strong>:</p>
<ul>
<li>Follow the steps outlined above to create an Azure Databricks workspace and cluster.</li>
</ul>
</li>
<li>
<p><strong>Create a Notebook</strong>:</p>
<ul>
<li>Create a new notebook in your Databricks workspace.</li>
</ul>
</li>
<li>
<p><strong>Write and Run Spark Code</strong>:</p>
<ul>
<li>In the notebook, write the following Spark code to read a CSV file from Azure Blob Storage and perform a simple transformation:
<pre><code class="language-python">from pyspark.sql import SparkSession

spark = SparkSession.builder.appName(&quot;AzureExample&quot;).getOrCreate()

# Replace with your Azure Blob Storage account details
storage_account_name = &quot;your_storage_account_name&quot;
storage_account_access_key = &quot;your_storage_account_access_key&quot;
container_name = &quot;your_container_name&quot;
file_path = &quot;your_file_path.csv&quot;

spark.conf.set(&quot;fs.azure.account.key.&quot; + storage_account_name + &quot;.blob.core.windows.net&quot;, storage_account_access_key)

df = spark.read.csv(f&quot;wasbs://{container_name}@{storage_account_name}.blob.core.windows.net/{file_path}&quot;, header=True, inferSchema=True)
df.show()

# Perform a simple transformation
df_filtered = df.filter(df['Age'] &gt; 30)
df_filtered.show()
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Run the Notebook</strong>:</p>
<ul>
<li>Attach the notebook to your cluster and run the cells to execute the Spark job.</li>
</ul>
</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'><p>The provided code reads a CSV file from Azure Blob Storage, displays its contents, and then filters the rows where the 'Age' column is greater than 30. Ensure you replace the placeholder values with your actual Azure Blob Storage account details.</p>
</div><h1><p>Summary</p>
</h1>
<div class='content'><p>In this module, we covered how to run Apache Spark on Azure using different services such as HDInsight, Databricks, and Synapse Analytics. We walked through the steps to set up clusters, create notebooks, and run Spark jobs. By leveraging Azure's cloud capabilities, you can efficiently manage and scale your Spark applications.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-01-running-spark-aws' title="Running Spark on AWS">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-03-running-spark-google-cloud' title="Running Spark on Google Cloud">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
