<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spark Architecture</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/01-03-spark-architecture" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/01-03-spark-architecture" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/01-03-spark-architecture" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/apachespark/01-03-spark-architecture" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/apachespark/01-03-spark-architecture" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='01-02-setting-up-spark-environment' title="Setting Up the Spark Environment">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Spark Architecture</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='01-04-spark-shell' title="Spark Shell">Next &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1><p>Introduction</p>
</h1>
<div class='content'><p>Apache Spark is a powerful open-source processing engine built around speed, ease of use, and sophisticated analytics. Understanding its architecture is crucial for leveraging its full potential. This section will cover the core components and the overall architecture of Apache Spark.</p>
</div><h1><p>Key Components of Spark Architecture</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Driver Program</strong></p>
<ul>
<li>The driver program is the main control process that creates the SparkContext, connects to the cluster, and coordinates the execution of tasks.</li>
<li>It translates the user program into tasks and schedules them to run on executors.</li>
</ul>
</li>
<li>
<p><strong>SparkContext</strong></p>
<ul>
<li>The SparkContext is the entry point for any Spark application. It initializes the Spark application and allows the driver to access the cluster.</li>
<li>It is responsible for setting up internal services and establishing a connection to the cluster manager.</li>
</ul>
</li>
<li>
<p><strong>Cluster Manager</strong></p>
<ul>
<li>The cluster manager allocates resources across the cluster. Spark supports several cluster managers:
<ul>
<li><strong>Standalone Cluster Manager</strong>: A simple cluster manager included with Spark.</li>
<li><strong>Apache Mesos</strong>: A general cluster manager that can also run Hadoop MapReduce and other applications.</li>
<li><strong>Hadoop YARN</strong>: The resource manager in Hadoop 2.</li>
<li><strong>Kubernetes</strong>: An open-source system for automating deployment, scaling, and management of containerized applications.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Worker Nodes</strong></p>
<ul>
<li>Worker nodes are the nodes in the cluster that execute tasks assigned by the driver.</li>
<li>Each worker node runs an executor, which is responsible for running individual tasks and returning results to the driver.</li>
</ul>
</li>
<li>
<p><strong>Executors</strong></p>
<ul>
<li>Executors are distributed agents responsible for executing tasks. Each Spark application has its own executors.</li>
<li>They run on worker nodes and perform data processing and storage.</li>
<li>Executors also provide in-memory storage for RDDs that are cached by user programs through SparkContext.</li>
</ul>
</li>
<li>
<p><strong>Tasks</strong></p>
<ul>
<li>Tasks are the smallest unit of work in Spark. They are the individual units of work sent to executors by the driver.</li>
<li>Each task runs on a partition of the data and performs operations like map, filter, and reduce.</li>
</ul>
</li>
</ol>
</div><h1><p>Spark Execution Flow</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Job Submission</strong></p>
<ul>
<li>The driver program submits a job to the SparkContext.</li>
<li>The job is divided into stages based on wide transformations (e.g., shuffle operations).</li>
</ul>
</li>
<li>
<p><strong>Task Scheduling</strong></p>
<ul>
<li>The SparkContext communicates with the cluster manager to allocate resources.</li>
<li>The job is divided into tasks, which are distributed to executors on worker nodes.</li>
</ul>
</li>
<li>
<p><strong>Task Execution</strong></p>
<ul>
<li>Executors on worker nodes execute the tasks.</li>
<li>Tasks process data and perform transformations and actions.</li>
</ul>
</li>
<li>
<p><strong>Result Collection</strong></p>
<ul>
<li>The results of the tasks are sent back to the driver.</li>
<li>The driver program collects and processes the results.</li>
</ul>
</li>
</ol>
</div><h1><p>Example: Word Count Program</p>
</h1>
<div class='content'><p>To illustrate the Spark architecture, let's look at a simple Word Count program.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrIGltcG9ydCBTcGFya0NvbnRleHQKCiMgSW5pdGlhbGl6ZSBTcGFya0NvbnRleHQKc2MgPSBTcGFya0NvbnRleHQoImxvY2FsIiwgIldvcmRDb3VudCIpCgojIFJlYWQgaW5wdXQgZmlsZQp0ZXh0X2ZpbGUgPSBzYy50ZXh0RmlsZSgiaGRmczovL3BhdGgvdG8vaW5wdXQudHh0IikKCiMgUGVyZm9ybSB3b3JkIGNvdW50CmNvdW50cyA9IHRleHRfZmlsZS5mbGF0TWFwKGxhbWJkYSBsaW5lOiBsaW5lLnNwbGl0KCIgIikpIFwKICAgICAgICAgICAgICAgICAgLm1hcChsYW1iZGEgd29yZDogKHdvcmQsIDEpKSBcCiAgICAgICAgICAgICAgICAgIC5yZWR1Y2VCeUtleShsYW1iZGEgYSwgYjogYSArIGIpCgojIFNhdmUgdGhlIHJlc3VsdApjb3VudHMuc2F2ZUFzVGV4dEZpbGUoImhkZnM6Ly9wYXRoL3RvL291dHB1dCIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark import SparkContext

# Initialize SparkContext
sc = SparkContext(&quot;local&quot;, &quot;WordCount&quot;)

# Read input file
text_file = sc.textFile(&quot;hdfs://path/to/input.txt&quot;)

# Perform word count
counts = text_file.flatMap(lambda line: line.split(&quot; &quot;)) \
                  .map(lambda word: (word, 1)) \
                  .reduceByKey(lambda a, b: a + b)

# Save the result
counts.saveAsTextFile(&quot;hdfs://path/to/output&quot;)</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Initialization</strong>:</p>
<ul>
<li><code>SparkContext</code> is initialized, which sets up the driver program and connects to the cluster manager.</li>
</ul>
</li>
<li>
<p><strong>Data Loading</strong>:</p>
<ul>
<li>The input file is read into an RDD (<code>text_file</code>).</li>
</ul>
</li>
<li>
<p><strong>Transformations</strong>:</p>
<ul>
<li><code>flatMap</code> splits each line into words.</li>
<li><code>map</code> transforms each word into a key-value pair (word, 1).</li>
<li><code>reduceByKey</code> aggregates the counts for each word.</li>
</ul>
</li>
<li>
<p><strong>Action</strong>:</p>
<ul>
<li><code>saveAsTextFile</code> triggers the execution of the transformations and saves the result to the specified path.</li>
</ul>
</li>
</ol>
</div><h1><p>Summary</p>
</h1>
<div class='content'><p>Understanding the architecture of Apache Spark is essential for developing efficient and scalable applications. The key components include the driver program, SparkContext, cluster manager, worker nodes, executors, and tasks. The execution flow involves job submission, task scheduling, task execution, and result collection. By grasping these concepts, you can better optimize and troubleshoot your Spark applications.</p>
<p>In the next section, we will explore the Spark Shell, which provides an interactive environment for running Spark commands and testing code snippets.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='01-02-setting-up-spark-environment' title="Setting Up the Spark Environment">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='01-04-spark-shell' title="Spark Shell">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
