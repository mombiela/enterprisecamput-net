<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spark MLlib</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/04-03-spark-mllib" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/04-03-spark-mllib" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/04-03-spark-mllib" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/apachespark/04-03-spark-mllib" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/apachespark/04-03-spark-mllib" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Programming Languages</a>
				 					<a href="/categ/frameworks">Frameworks and Libraries</a>
				 					<a href="/categ/tech-tools">Technical Tools</a>
				 					<a href="/categ/foundations">Theoretical Foundations</a>
				 					<a href="/categ/soft-skills">Social Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-02-structured-streaming' title="Structured Streaming">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Spark MLlib</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-04-graphx' title="GraphX">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Apache Spark's MLlib is a scalable machine learning library that provides various algorithms and utilities for machine learning tasks. This module will cover the basics of MLlib, including its architecture, key concepts, and practical examples to help you get started with machine learning in Spark.</p>
</div><h1><p>Table of Contents</p>
</h1>
<div class='content'><ol>
<li><a href="#introduction-to-mllib">Introduction to MLlib</a></li>
<li><a href="#mllib-architecture">MLlib Architecture</a></li>
<li><a href="#basic-mllib-operations">Basic MLlib Operations</a></li>
<li><a href="#practical-example-linear-regression">Practical Example: Linear Regression</a></li>
<li><a href="#exercises">Exercises</a></li>
<li><a href="#summary">Summary</a></li>
</ol>
</div><h1><p>Introduction to MLlib</p>
</h1>
<div class='content'><p>MLlib is designed to make machine learning scalable and easy. It provides:</p>
<ul>
<li><strong>Common learning algorithms</strong>: Classification, regression, clustering, collaborative filtering, etc.</li>
<li><strong>Featurization</strong>: Feature extraction, transformation, dimensionality reduction, and selection.</li>
<li><strong>Pipelines</strong>: Tools for constructing, evaluating, and tuning machine learning pipelines.</li>
<li><strong>Persistence</strong>: Saving and loading algorithms, models, and pipelines.</li>
<li><strong>Utilities</strong>: Linear algebra, statistics, data handling, etc.</li>
</ul>
</div><h1><p>MLlib Architecture</p>
</h1>
<div class='content'><p>MLlib is built on top of Spark and leverages its distributed computing capabilities. The architecture includes:</p>
<ul>
<li><strong>DataFrame-based API</strong>: Provides high-level APIs for constructing machine learning pipelines.</li>
<li><strong>RDD-based API</strong>: Lower-level API for more control over the data processing.</li>
<li><strong>Pipelines</strong>: Allow for the construction of complex workflows that include multiple stages of data processing and model training.</li>
</ul>
</div><h2><p>Comparison of DataFrame-based API and RDD-based API</p>
</h2>
<div class='content'><table>
<thead>
<tr>
<th>Feature</th>
<th>DataFrame-based API</th>
<th>RDD-based API</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ease of Use</td>
<td>High</td>
<td>Medium</td>
</tr>
<tr>
<td>Performance</td>
<td>Optimized</td>
<td>Less optimized</td>
</tr>
<tr>
<td>Flexibility</td>
<td>Medium</td>
<td>High</td>
</tr>
<tr>
<td>Integration with Spark</td>
<td>Seamless</td>
<td>Requires more effort</td>
</tr>
</tbody>
</table>
</div><h1><p>Basic MLlib Operations</p>
</h1>
<div class='content'></div><h2><p>Importing MLlib</p>
</h2>
<div class='content'><p>To use MLlib, you need to import the necessary libraries:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmxpbmFsZyBpbXBvcnQgVmVjdG9ycwpmcm9tIHB5c3BhcmsubWwucmVncmVzc2lvbiBpbXBvcnQgTGluZWFyUmVncmVzc2lvbg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.linalg import Vectors
from pyspark.ml.regression import LinearRegression</pre></div><div class='content'></div><h2><p>Creating a DataFrame</p>
</h2>
<div class='content'><p>MLlib works with DataFrames. Here's how to create a simple DataFrame:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaXRpYWxpemUgU3Bhcmsgc2Vzc2lvbgpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIk1MbGliRXhhbXBsZSIpLmdldE9yQ3JlYXRlKCkKCiMgQ3JlYXRlIGEgRGF0YUZyYW1lCmRhdGEgPSBbKDEuMCwgVmVjdG9ycy5kZW5zZSgwLjAsIDEuMSwgMC4xKSksCiAgICAgICAgKDAuMCwgVmVjdG9ycy5kZW5zZSgyLjAsIDEuMCwgLTEuMCkpLAogICAgICAgICgwLjAsIFZlY3RvcnMuZGVuc2UoMi4wLCAxLjMsIDEuMCkpLAogICAgICAgICgxLjAsIFZlY3RvcnMuZGVuc2UoMC4wLCAxLjIsIC0wLjUpKV0KZGYgPSBzcGFyay5jcmVhdGVEYXRhRnJhbWUoZGF0YSwgWyJsYWJlbCIsICJmZWF0dXJlcyJdKQpkZi5zaG93KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Initialize Spark session
spark = SparkSession.builder.appName(&quot;MLlibExample&quot;).getOrCreate()

# Create a DataFrame
data = [(1.0, Vectors.dense(0.0, 1.1, 0.1)),
        (0.0, Vectors.dense(2.0, 1.0, -1.0)),
        (0.0, Vectors.dense(2.0, 1.3, 1.0)),
        (1.0, Vectors.dense(0.0, 1.2, -0.5))]
df = spark.createDataFrame(data, [&quot;label&quot;, &quot;features&quot;])
df.show()</pre></div><div class='content'></div><h2><p>Training a Model</p>
</h2>
<div class='content'><p>Here's how to train a linear regression model:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbml0aWFsaXplIHRoZSBsaW5lYXIgcmVncmVzc2lvbiBtb2RlbApsciA9IExpbmVhclJlZ3Jlc3Npb24oZmVhdHVyZXNDb2w9J2ZlYXR1cmVzJywgbGFiZWxDb2w9J2xhYmVsJykKCiMgRml0IHRoZSBtb2RlbApscl9tb2RlbCA9IGxyLmZpdChkZikKCiMgUHJpbnQgdGhlIGNvZWZmaWNpZW50cyBhbmQgaW50ZXJjZXB0IGZvciBsaW5lYXIgcmVncmVzc2lvbgpwcmludCgiQ29lZmZpY2llbnRzOiAiICsgc3RyKGxyX21vZGVsLmNvZWZmaWNpZW50cykpCnByaW50KCJJbnRlcmNlcHQ6ICIgKyBzdHIobHJfbW9kZWwuaW50ZXJjZXB0KSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Initialize the linear regression model
lr = LinearRegression(featuresCol='features', labelCol='label')

# Fit the model
lr_model = lr.fit(df)

# Print the coefficients and intercept for linear regression
print(&quot;Coefficients: &quot; + str(lr_model.coefficients))
print(&quot;Intercept: &quot; + str(lr_model.intercept))</pre></div><div class='content'></div><h1><p>Practical Example: Linear Regression</p>
</h1>
<div class='content'><p>Let's dive deeper into a practical example of linear regression using MLlib.</p>
</div><h2><p>Step 1: Import Libraries</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmxpbmFsZyBpbXBvcnQgVmVjdG9ycwpmcm9tIHB5c3BhcmsubWwucmVncmVzc2lvbiBpbXBvcnQgTGluZWFyUmVncmVzc2lvbgpmcm9tIHB5c3Bhcmsuc3FsIGltcG9ydCBTcGFya1Nlc3Npb24="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.linalg import Vectors
from pyspark.ml.regression import LinearRegression
from pyspark.sql import SparkSession</pre></div><div class='content'></div><h2><p>Step 2: Initialize Spark Session</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3BhcmsgPSBTcGFya1Nlc3Npb24uYnVpbGRlci5hcHBOYW1lKCJMaW5lYXJSZWdyZXNzaW9uRXhhbXBsZSIpLmdldE9yQ3JlYXRlKCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>spark = SparkSession.builder.appName(&quot;LinearRegressionExample&quot;).getOrCreate()</pre></div><div class='content'></div><h2><p>Step 3: Create DataFrame</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGF0YSA9IFsoMS4wLCBWZWN0b3JzLmRlbnNlKDAuMCwgMS4xLCAwLjEpKSwKICAgICAgICAoMC4wLCBWZWN0b3JzLmRlbnNlKDIuMCwgMS4wLCAtMS4wKSksCiAgICAgICAgKDAuMCwgVmVjdG9ycy5kZW5zZSgyLjAsIDEuMywgMS4wKSksCiAgICAgICAgKDEuMCwgVmVjdG9ycy5kZW5zZSgwLjAsIDEuMiwgLTAuNSkpXQpkZiA9IHNwYXJrLmNyZWF0ZURhdGFGcmFtZShkYXRhLCBbImxhYmVsIiwgImZlYXR1cmVzIl0pCmRmLnNob3coKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>data = [(1.0, Vectors.dense(0.0, 1.1, 0.1)),
        (0.0, Vectors.dense(2.0, 1.0, -1.0)),
        (0.0, Vectors.dense(2.0, 1.3, 1.0)),
        (1.0, Vectors.dense(0.0, 1.2, -0.5))]
df = spark.createDataFrame(data, [&quot;label&quot;, &quot;features&quot;])
df.show()</pre></div><div class='content'></div><h2><p>Step 4: Train the Model</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bHIgPSBMaW5lYXJSZWdyZXNzaW9uKGZlYXR1cmVzQ29sPSdmZWF0dXJlcycsIGxhYmVsQ29sPSdsYWJlbCcpCmxyX21vZGVsID0gbHIuZml0KGRmKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>lr = LinearRegression(featuresCol='features', labelCol='label')
lr_model = lr.fit(df)</pre></div><div class='content'></div><h2><p>Step 5: Evaluate the Model</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQcmludCB0aGUgY29lZmZpY2llbnRzIGFuZCBpbnRlcmNlcHQgZm9yIGxpbmVhciByZWdyZXNzaW9uCnByaW50KCJDb2VmZmljaWVudHM6ICIgKyBzdHIobHJfbW9kZWwuY29lZmZpY2llbnRzKSkKcHJpbnQoIkludGVyY2VwdDogIiArIHN0cihscl9tb2RlbC5pbnRlcmNlcHQpKQoKIyBTdW1tYXJpemUgdGhlIG1vZGVsIG92ZXIgdGhlIHRyYWluaW5nIHNldCBhbmQgcHJpbnQgb3V0IHNvbWUgbWV0cmljcwp0cmFpbmluZ1N1bW1hcnkgPSBscl9tb2RlbC5zdW1tYXJ5CnByaW50KCJSTVNFOiAlZiIgJSB0cmFpbmluZ1N1bW1hcnkucm9vdE1lYW5TcXVhcmVkRXJyb3IpCnByaW50KCJyMjogJWYiICUgdHJhaW5pbmdTdW1tYXJ5LnIyKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Print the coefficients and intercept for linear regression
print(&quot;Coefficients: &quot; + str(lr_model.coefficients))
print(&quot;Intercept: &quot; + str(lr_model.intercept))

# Summarize the model over the training set and print out some metrics
trainingSummary = lr_model.summary
print(&quot;RMSE: %f&quot; % trainingSummary.rootMeanSquaredError)
print(&quot;r2: %f&quot; % trainingSummary.r2)</pre></div><div class='content'></div><h1><p>Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Logistic Regression</p>
</h2>
<div class='content'><ol>
<li>Create a DataFrame with binary labels and features.</li>
<li>Train a logistic regression model.</li>
<li>Evaluate the model by printing the coefficients and intercept.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmNsYXNzaWZpY2F0aW9uIGltcG9ydCBMb2dpc3RpY1JlZ3Jlc3Npb24KCiMgQ3JlYXRlIERhdGFGcmFtZQpkYXRhID0gWygxLjAsIFZlY3RvcnMuZGVuc2UoMC4wLCAxLjEsIDAuMSkpLAogICAgICAgICgwLjAsIFZlY3RvcnMuZGVuc2UoMi4wLCAxLjAsIC0xLjApKSwKICAgICAgICAoMC4wLCBWZWN0b3JzLmRlbnNlKDIuMCwgMS4zLCAxLjApKSwKICAgICAgICAoMS4wLCBWZWN0b3JzLmRlbnNlKDAuMCwgMS4yLCAtMC41KSldCmRmID0gc3BhcmsuY3JlYXRlRGF0YUZyYW1lKGRhdGEsIFsibGFiZWwiLCAiZmVhdHVyZXMiXSkKCiMgVHJhaW4gbG9naXN0aWMgcmVncmVzc2lvbiBtb2RlbApsciA9IExvZ2lzdGljUmVncmVzc2lvbihmZWF0dXJlc0NvbD0nZmVhdHVyZXMnLCBsYWJlbENvbD0nbGFiZWwnKQpscl9tb2RlbCA9IGxyLmZpdChkZikKCiMgUHJpbnQgY29lZmZpY2llbnRzIGFuZCBpbnRlcmNlcHQKcHJpbnQoIkNvZWZmaWNpZW50czogIiArIHN0cihscl9tb2RlbC5jb2VmZmljaWVudHMpKQpwcmludCgiSW50ZXJjZXB0OiAiICsgc3RyKGxyX21vZGVsLmludGVyY2VwdCkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.classification import LogisticRegression

# Create DataFrame
data = [(1.0, Vectors.dense(0.0, 1.1, 0.1)),
        (0.0, Vectors.dense(2.0, 1.0, -1.0)),
        (0.0, Vectors.dense(2.0, 1.3, 1.0)),
        (1.0, Vectors.dense(0.0, 1.2, -0.5))]
df = spark.createDataFrame(data, [&quot;label&quot;, &quot;features&quot;])

# Train logistic regression model
lr = LogisticRegression(featuresCol='features', labelCol='label')
lr_model = lr.fit(df)

# Print coefficients and intercept
print(&quot;Coefficients: &quot; + str(lr_model.coefficients))
print(&quot;Intercept: &quot; + str(lr_model.intercept))</pre></div><div class='content'></div><h1><p>Summary</p>
</h1>
<div class='content'><p>In this module, we covered the basics of Spark MLlib, including its architecture and key concepts. We also walked through a practical example of linear regression and provided an exercise to practice logistic regression. MLlib is a powerful tool for scalable machine learning, and understanding its fundamentals is crucial for leveraging Spark's full potential in data processing and analysis.</p>
<p>Next, we will explore Spark Streaming and how to process real-time data streams using Spark.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-02-structured-streaming' title="Structured Streaming">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-04-graphx' title="GraphX">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
