<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced RDD Operations</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/advanced-rdd-operations" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/advanced-rdd-operations" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/advanced-rdd-operations" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/apachespark/advanced-rdd-operations" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/apachespark/advanced-rdd-operations" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='tuning-spark-applications'>&#x25C4;Tuning Spark Applications</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Advanced RDD Operations</a>
	</div>
	<div class='col-4 text-end'>
					<a href='custom-data-sources'>Custom Data Sources &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this section, we will delve into advanced operations on Resilient Distributed Datasets (RDDs) in Apache Spark. These operations are essential for performing complex data transformations and actions efficiently. We will cover key concepts, provide code examples, and include exercises to solidify your understanding.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Transformations vs Actions</strong>: Understanding the difference between these two types of operations.</li>
<li><strong>Pair RDDs</strong>: Special RDDs that consist of key-value pairs, enabling more complex operations.</li>
<li><strong>Advanced Transformations</strong>: Operations like <code>aggregateByKey</code>, <code>combineByKey</code>, and <code>cogroup</code>.</li>
<li><strong>Advanced Actions</strong>: Operations like <code>countByKey</code>, <code>lookup</code>, and <code>foreach</code>.</li>
</ul>
</div><h1>Transformations vs Actions</h1>
<div class='content'><p>Transformations create a new RDD from an existing one, while actions trigger the execution of the transformations to return a result or write data to an external storage system.</p>
</div><h2>Example:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIHJkZCA9IHNjLnBhcmFsbGVsaXplKFNlcSgxLCAyLCAzLCA0LCA1KSkKCi8vIFRyYW5zZm9ybWF0aW9uCnZhbCBzcXVhcmVkUmRkID0gcmRkLm1hcCh4ID0+IHggKiB4KQoKLy8gQWN0aW9uCnZhbCByZXN1bHQgPSBzcXVhcmVkUmRkLmNvbGxlY3QoKQpwcmludGxuKHJlc3VsdC5ta1N0cmluZygiLCAiKSkgLy8gT3V0cHV0OiAxLCA0LCA5LCAxNiwgMjU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val rdd = sc.parallelize(Seq(1, 2, 3, 4, 5))

// Transformation
val squaredRdd = rdd.map(x =&gt; x * x)

// Action
val result = squaredRdd.collect()
println(result.mkString(&quot;, &quot;)) // Output: 1, 4, 9, 16, 25</pre></div><div class='content'></div><h1>Pair RDDs</h1>
<div class='content'><p>Pair RDDs are RDDs of key-value pairs, which are useful for aggregating data, performing joins, and other operations.</p>
</div><h2>Example:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIHBhaXJSZGQgPSBzYy5wYXJhbGxlbGl6ZShTZXEoKCJhIiwgMSksICgiYiIsIDIpLCAoImEiLCAzKSkpCgovLyBUcmFuc2Zvcm1hdGlvbgp2YWwgZ3JvdXBlZFJkZCA9IHBhaXJSZGQuZ3JvdXBCeUtleSgpCgovLyBBY3Rpb24KZ3JvdXBlZFJkZC5jb2xsZWN0KCkuZm9yZWFjaChwcmludGxuKQovLyBPdXRwdXQ6IChhLENvbXBhY3RCdWZmZXIoMSwgMykpCi8vICAgICAgICAgKGIsQ29tcGFjdEJ1ZmZlcigyKSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val pairRdd = sc.parallelize(Seq((&quot;a&quot;, 1), (&quot;b&quot;, 2), (&quot;a&quot;, 3)))

// Transformation
val groupedRdd = pairRdd.groupByKey()

// Action
groupedRdd.collect().foreach(println)
// Output: (a,CompactBuffer(1, 3))
//         (b,CompactBuffer(2))</pre></div><div class='content'></div><h1>Advanced Transformations</h1>
<div class='content'></div><h2>`aggregateByKey`</h2>
<div class='content'><p>Aggregates values of each key using a given combine functions and a neutral &quot;zero value&quot;.</p>
<h4>Example:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIHBhaXJSZGQgPSBzYy5wYXJhbGxlbGl6ZShTZXEoKCJhIiwgMSksICgiYiIsIDIpLCAoImEiLCAzKSwgKCJiIiwgNCkpKQoKLy8gWmVybyB2YWx1ZSBpcyAwLCBzZXFPcCBhZGRzIHZhbHVlcyB3aXRoaW4gYSBwYXJ0aXRpb24sIGNvbWJPcCBhZGRzIHZhbHVlcyBhY3Jvc3MgcGFydGl0aW9ucwp2YWwgYWdncmVnYXRlZFJkZCA9IHBhaXJSZGQuYWdncmVnYXRlQnlLZXkoMCkoXyArIF8sIF8gKyBfKQoKLy8gQWN0aW9uCmFnZ3JlZ2F0ZWRSZGQuY29sbGVjdCgpLmZvcmVhY2gocHJpbnRsbikKLy8gT3V0cHV0OiAoYSwgNCkKLy8gICAgICAgICAoYiwgNik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val pairRdd = sc.parallelize(Seq((&quot;a&quot;, 1), (&quot;b&quot;, 2), (&quot;a&quot;, 3), (&quot;b&quot;, 4)))

// Zero value is 0, seqOp adds values within a partition, combOp adds values across partitions
val aggregatedRdd = pairRdd.aggregateByKey(0)(_ + _, _ + _)

// Action
aggregatedRdd.collect().foreach(println)
// Output: (a, 4)
//         (b, 6)</pre></div><div class='content'></div><h2>`combineByKey`</h2>
<div class='content'><p>Generalized aggregation function that allows different aggregation logic for combining values within a partition and across partitions.</p>
<h4>Example:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIHBhaXJSZGQgPSBzYy5wYXJhbGxlbGl6ZShTZXEoKCJhIiwgMSksICgiYiIsIDIpLCAoImEiLCAzKSwgKCJiIiwgNCkpKQoKLy8gQ3JlYXRlIGNvbWJpbmVyLCBtZXJnZSB2YWx1ZSB3aXRoaW4gcGFydGl0aW9uLCBtZXJnZSB2YWx1ZSBhY3Jvc3MgcGFydGl0aW9ucwp2YWwgY29tYmluZWRSZGQgPSBwYWlyUmRkLmNvbWJpbmVCeUtleSgKICAodjogSW50KSA9PiB2LAogIChjOiBJbnQsIHY6IEludCkgPT4gYyArIHYsCiAgKGMxOiBJbnQsIGMyOiBJbnQpID0+IGMxICsgYzIKKQoKLy8gQWN0aW9uCmNvbWJpbmVkUmRkLmNvbGxlY3QoKS5mb3JlYWNoKHByaW50bG4pCi8vIE91dHB1dDogKGEsIDQpCi8vICAgICAgICAgKGIsIDYp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val pairRdd = sc.parallelize(Seq((&quot;a&quot;, 1), (&quot;b&quot;, 2), (&quot;a&quot;, 3), (&quot;b&quot;, 4)))

// Create combiner, merge value within partition, merge value across partitions
val combinedRdd = pairRdd.combineByKey(
  (v: Int) =&gt; v,
  (c: Int, v: Int) =&gt; c + v,
  (c1: Int, c2: Int) =&gt; c1 + c2
)

// Action
combinedRdd.collect().foreach(println)
// Output: (a, 4)
//         (b, 6)</pre></div><div class='content'></div><h2>`cogroup`</h2>
<div class='content'><p>Groups data from two RDDs by key.</p>
<h4>Example:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIHJkZDEgPSBzYy5wYXJhbGxlbGl6ZShTZXEoKCJhIiwgMSksICgiYiIsIDIpKSkKdmFsIHJkZDIgPSBzYy5wYXJhbGxlbGl6ZShTZXEoKCJhIiwgMyksICgiYiIsIDQpLCAoImEiLCA1KSkpCgovLyBUcmFuc2Zvcm1hdGlvbgp2YWwgY29ncm91cGVkUmRkID0gcmRkMS5jb2dyb3VwKHJkZDIpCgovLyBBY3Rpb24KY29ncm91cGVkUmRkLmNvbGxlY3QoKS5mb3JlYWNoKHByaW50bG4pCi8vIE91dHB1dDogKGEsKENvbXBhY3RCdWZmZXIoMSksQ29tcGFjdEJ1ZmZlcigzLCA1KSkpCi8vICAgICAgICAgKGIsKENvbXBhY3RCdWZmZXIoMiksQ29tcGFjdEJ1ZmZlcig0KSkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val rdd1 = sc.parallelize(Seq((&quot;a&quot;, 1), (&quot;b&quot;, 2)))
val rdd2 = sc.parallelize(Seq((&quot;a&quot;, 3), (&quot;b&quot;, 4), (&quot;a&quot;, 5)))

// Transformation
val cogroupedRdd = rdd1.cogroup(rdd2)

// Action
cogroupedRdd.collect().foreach(println)
// Output: (a,(CompactBuffer(1),CompactBuffer(3, 5)))
//         (b,(CompactBuffer(2),CompactBuffer(4)))</pre></div><div class='content'></div><h1>Advanced Actions</h1>
<div class='content'></div><h2>`countByKey`</h2>
<div class='content'><p>Counts the number of elements for each key.</p>
<h4>Example:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIHBhaXJSZGQgPSBzYy5wYXJhbGxlbGl6ZShTZXEoKCJhIiwgMSksICgiYiIsIDIpLCAoImEiLCAzKSwgKCJiIiwgNCkpKQoKLy8gQWN0aW9uCnZhbCBjb3VudEJ5S2V5UmVzdWx0ID0gcGFpclJkZC5jb3VudEJ5S2V5KCkKcHJpbnRsbihjb3VudEJ5S2V5UmVzdWx0KQovLyBPdXRwdXQ6IE1hcChhIC0+IDIsIGIgLT4gMik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val pairRdd = sc.parallelize(Seq((&quot;a&quot;, 1), (&quot;b&quot;, 2), (&quot;a&quot;, 3), (&quot;b&quot;, 4)))

// Action
val countByKeyResult = pairRdd.countByKey()
println(countByKeyResult)
// Output: Map(a -&gt; 2, b -&gt; 2)</pre></div><div class='content'></div><h2>`lookup`</h2>
<div class='content'><p>Returns all values associated with a given key.</p>
<h4>Example:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIHBhaXJSZGQgPSBzYy5wYXJhbGxlbGl6ZShTZXEoKCJhIiwgMSksICgiYiIsIDIpLCAoImEiLCAzKSwgKCJiIiwgNCkpKQoKLy8gQWN0aW9uCnZhbCBsb29rdXBSZXN1bHQgPSBwYWlyUmRkLmxvb2t1cCgiYSIpCnByaW50bG4obG9va3VwUmVzdWx0Lm1rU3RyaW5nKCIsICIpKSAvLyBPdXRwdXQ6IDEsIDM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val pairRdd = sc.parallelize(Seq((&quot;a&quot;, 1), (&quot;b&quot;, 2), (&quot;a&quot;, 3), (&quot;b&quot;, 4)))

// Action
val lookupResult = pairRdd.lookup(&quot;a&quot;)
println(lookupResult.mkString(&quot;, &quot;)) // Output: 1, 3</pre></div><div class='content'></div><h2>`foreach`</h2>
<div class='content'><p>Applies a function to each element of the RDD.</p>
<h4>Example:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIHJkZCA9IHNjLnBhcmFsbGVsaXplKFNlcSgxLCAyLCAzLCA0LCA1KSkKCi8vIEFjdGlvbgpyZGQuZm9yZWFjaCh4ID0+IHByaW50bG4oeCAqIHgpKQovLyBPdXRwdXQ6IDEKLy8gICAgICAgICA0Ci8vICAgICAgICAgOQovLyAgICAgICAgIDE2Ci8vICAgICAgICAgMjU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val rdd = sc.parallelize(Seq(1, 2, 3, 4, 5))

// Action
rdd.foreach(x =&gt; println(x * x))
// Output: 1
//         4
//         9
//         16
//         25</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we explored advanced RDD operations in Apache Spark. We covered the distinction between transformations and actions, delved into pair RDDs, and examined advanced transformations and actions. These operations are crucial for performing complex data manipulations and analyses efficiently. Practice these concepts with the provided examples and exercises to deepen your understanding.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='tuning-spark-applications'>&#x25C4;Tuning Spark Applications</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Advanced RDD Operations</a>
	</div>
	<div class='col-4 text-end'>
					<a href='custom-data-sources'>Custom Data Sources &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
