<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Big Data Analytics</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/07-02-big-data-analytics" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/07-02-big-data-analytics" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/07-02-big-data-analytics" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/apachespark/07-02-big-data-analytics" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/apachespark/07-02-big-data-analytics" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-01-real-time-data-processing' title="Real-Time Data Processing">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Big Data Analytics</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-03-machine-learning-pipelines' title="Machine Learning Pipelines">Next &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Big Data Analytics involves examining large and varied data sets to uncover hidden patterns, unknown correlations, market trends, customer preferences, and other useful business information. Apache Spark is a powerful tool for Big Data Analytics due to its speed, ease of use, and sophisticated analytics capabilities.</p>
<p>In this section, we will cover:</p>
<ol>
<li>The importance of Big Data Analytics.</li>
<li>Key concepts and tools in Spark for Big Data Analytics.</li>
<li>Practical examples of performing analytics with Spark.</li>
<li>Exercises to reinforce the concepts learned.</li>
</ol>
</div><h1>Importance of Big Data Analytics</h1>
<div class='content'><p>Big Data Analytics is crucial for:</p>
<ul>
<li><strong>Improving Decision Making</strong>: By analyzing large datasets, businesses can make more informed decisions.</li>
<li><strong>Enhancing Customer Experience</strong>: Understanding customer behavior and preferences helps in personalizing services.</li>
<li><strong>Optimizing Operations</strong>: Identifying inefficiencies and optimizing processes.</li>
<li><strong>Innovating Products and Services</strong>: Gaining insights into market trends and customer needs.</li>
</ul>
</div><h1>Key Concepts and Tools in Spark for Big Data Analytics</h1>
<div class='content'></div><h2>1. Spark SQL</h2>
<div class='content'><p>Spark SQL is a module for structured data processing. It allows querying data via SQL as well as the DataFrame API.</p>
</div><h2>2. DataFrames</h2>
<div class='content'><p>DataFrames are distributed collections of data organized into named columns, similar to a table in a relational database.</p>
</div><h2>3. Machine Learning with MLlib</h2>
<div class='content'><p>MLlib is Sparkâ€™s scalable machine learning library, which includes algorithms for classification, regression, clustering, and more.</p>
</div><h2>4. GraphX</h2>
<div class='content'><p>GraphX is a library for manipulating graphs and performing graph-parallel computations.</p>
</div><h1>Practical Examples</h1>
<div class='content'></div><h2>Example 1: Analyzing Sales Data with Spark SQL</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaXRpYWxpemUgU3BhcmsgU2Vzc2lvbgpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIkJpZ0RhdGFBbmFseXRpY3MiKS5nZXRPckNyZWF0ZSgpCgojIExvYWQgZGF0YSBpbnRvIERhdGFGcmFtZQpzYWxlc19kZiA9IHNwYXJrLnJlYWQuY3N2KCJzYWxlc19kYXRhLmNzdiIsIGhlYWRlcj1UcnVlLCBpbmZlclNjaGVtYT1UcnVlKQoKIyBSZWdpc3RlciBEYXRhRnJhbWUgYXMgYSBTUUwgdGVtcG9yYXJ5IHZpZXcKc2FsZXNfZGYuY3JlYXRlT3JSZXBsYWNlVGVtcFZpZXcoInNhbGVzIikKCiMgUGVyZm9ybSBTUUwgcXVlcnkgdG8gYW5hbHl6ZSBzYWxlcyBkYXRhCnJlc3VsdCA9IHNwYXJrLnNxbCgiIiIKICAgIFNFTEVDVCBwcm9kdWN0LCBTVU0oYW1vdW50KSBhcyB0b3RhbF9zYWxlcwogICAgRlJPTSBzYWxlcwogICAgR1JPVVAgQlkgcHJvZHVjdAogICAgT1JERVIgQlkgdG90YWxfc2FsZXMgREVTQwoiIiIpCgojIFNob3cgdGhlIHJlc3VsdApyZXN1bHQuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Initialize Spark Session
spark = SparkSession.builder.appName(&quot;BigDataAnalytics&quot;).getOrCreate()

# Load data into DataFrame
sales_df = spark.read.csv(&quot;sales_data.csv&quot;, header=True, inferSchema=True)

# Register DataFrame as a SQL temporary view
sales_df.createOrReplaceTempView(&quot;sales&quot;)

# Perform SQL query to analyze sales data
result = spark.sql(&quot;&quot;&quot;
    SELECT product, SUM(amount) as total_sales
    FROM sales
    GROUP BY product
    ORDER BY total_sales DESC
&quot;&quot;&quot;)

# Show the result
result.show()</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li>We start by initializing a Spark session.</li>
<li>Load the sales data from a CSV file into a DataFrame.</li>
<li>Register the DataFrame as a temporary SQL view.</li>
<li>Perform an SQL query to calculate the total sales for each product.</li>
<li>Display the result.</li>
</ul>
</div><h2>Example 2: Customer Segmentation with MLlib</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmNsdXN0ZXJpbmcgaW1wb3J0IEtNZWFucwpmcm9tIHB5c3BhcmsubWwuZmVhdHVyZSBpbXBvcnQgVmVjdG9yQXNzZW1ibGVyCgojIExvYWQgY3VzdG9tZXIgZGF0YQpjdXN0b21lcl9kZiA9IHNwYXJrLnJlYWQuY3N2KCJjdXN0b21lcl9kYXRhLmNzdiIsIGhlYWRlcj1UcnVlLCBpbmZlclNjaGVtYT1UcnVlKQoKIyBTZWxlY3QgZmVhdHVyZXMgZm9yIGNsdXN0ZXJpbmcKYXNzZW1ibGVyID0gVmVjdG9yQXNzZW1ibGVyKGlucHV0Q29scz1bImFnZSIsICJpbmNvbWUiLCAic3BlbmRpbmdfc2NvcmUiXSwgb3V0cHV0Q29sPSJmZWF0dXJlcyIpCmN1c3RvbWVyX2ZlYXR1cmVzID0gYXNzZW1ibGVyLnRyYW5zZm9ybShjdXN0b21lcl9kZikKCiMgVHJhaW4gS01lYW5zIG1vZGVsCmttZWFucyA9IEtNZWFucyhrPTMsIHNlZWQ9MSkKbW9kZWwgPSBrbWVhbnMuZml0KGN1c3RvbWVyX2ZlYXR1cmVzKQoKIyBNYWtlIHByZWRpY3Rpb25zCnByZWRpY3Rpb25zID0gbW9kZWwudHJhbnNmb3JtKGN1c3RvbWVyX2ZlYXR1cmVzKQoKIyBTaG93IHRoZSByZXN1bHQKcHJlZGljdGlvbnMuc2VsZWN0KCJjdXN0b21lcl9pZCIsICJwcmVkaWN0aW9uIikuc2hvdygp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.clustering import KMeans
from pyspark.ml.feature import VectorAssembler

# Load customer data
customer_df = spark.read.csv(&quot;customer_data.csv&quot;, header=True, inferSchema=True)

# Select features for clustering
assembler = VectorAssembler(inputCols=[&quot;age&quot;, &quot;income&quot;, &quot;spending_score&quot;], outputCol=&quot;features&quot;)
customer_features = assembler.transform(customer_df)

# Train KMeans model
kmeans = KMeans(k=3, seed=1)
model = kmeans.fit(customer_features)

# Make predictions
predictions = model.transform(customer_features)

# Show the result
predictions.select(&quot;customer_id&quot;, &quot;prediction&quot;).show()</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li>Load customer data into a DataFrame.</li>
<li>Use <code>VectorAssembler</code> to combine feature columns into a single vector column.</li>
<li>Train a KMeans clustering model with 3 clusters.</li>
<li>Make predictions and display the customer IDs along with their cluster assignments.</li>
</ul>
</div><h1>Exercises</h1>
<div class='content'></div><h2>Exercise 1: Analyzing Website Traffic Data</h2>
<div class='content'><p><strong>Task:</strong></p>
<ul>
<li>Load website traffic data from a CSV file.</li>
<li>Calculate the total number of visits per page.</li>
<li>Identify the top 5 most visited pages.</li>
</ul>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMb2FkIHdlYnNpdGUgdHJhZmZpYyBkYXRhCnRyYWZmaWNfZGYgPSBzcGFyay5yZWFkLmNzdigid2Vic2l0ZV90cmFmZmljLmNzdiIsIGhlYWRlcj1UcnVlLCBpbmZlclNjaGVtYT1UcnVlKQoKIyBSZWdpc3RlciBEYXRhRnJhbWUgYXMgYSBTUUwgdGVtcG9yYXJ5IHZpZXcKdHJhZmZpY19kZi5jcmVhdGVPclJlcGxhY2VUZW1wVmlldygidHJhZmZpYyIpCgojIFBlcmZvcm0gU1FMIHF1ZXJ5IHRvIGFuYWx5emUgd2Vic2l0ZSB0cmFmZmljCnJlc3VsdCA9IHNwYXJrLnNxbCgiIiIKICAgIFNFTEVDVCBwYWdlLCBDT1VOVCgqKSBhcyB2aXNpdF9jb3VudAogICAgRlJPTSB0cmFmZmljCiAgICBHUk9VUCBCWSBwYWdlCiAgICBPUkRFUiBCWSB2aXNpdF9jb3VudCBERVNDCiAgICBMSU1JVCA1CiIiIikKCiMgU2hvdyB0aGUgcmVzdWx0CnJlc3VsdC5zaG93KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Load website traffic data
traffic_df = spark.read.csv(&quot;website_traffic.csv&quot;, header=True, inferSchema=True)

# Register DataFrame as a SQL temporary view
traffic_df.createOrReplaceTempView(&quot;traffic&quot;)

# Perform SQL query to analyze website traffic
result = spark.sql(&quot;&quot;&quot;
    SELECT page, COUNT(*) as visit_count
    FROM traffic
    GROUP BY page
    ORDER BY visit_count DESC
    LIMIT 5
&quot;&quot;&quot;)

# Show the result
result.show()</pre></div><div class='content'></div><h2>Exercise 2: Predicting Customer Churn</h2>
<div class='content'><p><strong>Task:</strong></p>
<ul>
<li>Load customer data.</li>
<li>Use MLlib to train a logistic regression model to predict customer churn.</li>
<li>Evaluate the model's accuracy.</li>
</ul>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmNsYXNzaWZpY2F0aW9uIGltcG9ydCBMb2dpc3RpY1JlZ3Jlc3Npb24KZnJvbSBweXNwYXJrLm1sLmV2YWx1YXRpb24gaW1wb3J0IEJpbmFyeUNsYXNzaWZpY2F0aW9uRXZhbHVhdG9yCgojIExvYWQgY3VzdG9tZXIgZGF0YQpjdXN0b21lcl9kZiA9IHNwYXJrLnJlYWQuY3N2KCJjdXN0b21lcl9jaHVybi5jc3YiLCBoZWFkZXI9VHJ1ZSwgaW5mZXJTY2hlbWE9VHJ1ZSkKCiMgU2VsZWN0IGZlYXR1cmVzIGFuZCBsYWJlbAphc3NlbWJsZXIgPSBWZWN0b3JBc3NlbWJsZXIoaW5wdXRDb2xzPVsiYWdlIiwgImluY29tZSIsICJzcGVuZGluZ19zY29yZSJdLCBvdXRwdXRDb2w9ImZlYXR1cmVzIikKY3VzdG9tZXJfZmVhdHVyZXMgPSBhc3NlbWJsZXIudHJhbnNmb3JtKGN1c3RvbWVyX2RmKQpjdXN0b21lcl9kYXRhID0gY3VzdG9tZXJfZmVhdHVyZXMuc2VsZWN0KCJmZWF0dXJlcyIsICJjaHVybiIpCgojIFNwbGl0IGRhdGEgaW50byB0cmFpbmluZyBhbmQgdGVzdCBzZXRzCnRyYWluX2RhdGEsIHRlc3RfZGF0YSA9IGN1c3RvbWVyX2RhdGEucmFuZG9tU3BsaXQoWzAuNywgMC4zXSwgc2VlZD0xKQoKIyBUcmFpbiBsb2dpc3RpYyByZWdyZXNzaW9uIG1vZGVsCmxyID0gTG9naXN0aWNSZWdyZXNzaW9uKGxhYmVsQ29sPSJjaHVybiIsIGZlYXR1cmVzQ29sPSJmZWF0dXJlcyIpCm1vZGVsID0gbHIuZml0KHRyYWluX2RhdGEpCgojIE1ha2UgcHJlZGljdGlvbnMKcHJlZGljdGlvbnMgPSBtb2RlbC50cmFuc2Zvcm0odGVzdF9kYXRhKQoKIyBFdmFsdWF0ZSBtb2RlbApldmFsdWF0b3IgPSBCaW5hcnlDbGFzc2lmaWNhdGlvbkV2YWx1YXRvcihsYWJlbENvbD0iY2h1cm4iKQphY2N1cmFjeSA9IGV2YWx1YXRvci5ldmFsdWF0ZShwcmVkaWN0aW9ucykKCiMgU2hvdyBhY2N1cmFjeQpwcmludChmIk1vZGVsIEFjY3VyYWN5OiB7YWNjdXJhY3l9Iik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.classification import LogisticRegression
from pyspark.ml.evaluation import BinaryClassificationEvaluator

# Load customer data
customer_df = spark.read.csv(&quot;customer_churn.csv&quot;, header=True, inferSchema=True)

# Select features and label
assembler = VectorAssembler(inputCols=[&quot;age&quot;, &quot;income&quot;, &quot;spending_score&quot;], outputCol=&quot;features&quot;)
customer_features = assembler.transform(customer_df)
customer_data = customer_features.select(&quot;features&quot;, &quot;churn&quot;)

# Split data into training and test sets
train_data, test_data = customer_data.randomSplit([0.7, 0.3], seed=1)

# Train logistic regression model
lr = LogisticRegression(labelCol=&quot;churn&quot;, featuresCol=&quot;features&quot;)
model = lr.fit(train_data)

# Make predictions
predictions = model.transform(test_data)

# Evaluate model
evaluator = BinaryClassificationEvaluator(labelCol=&quot;churn&quot;)
accuracy = evaluator.evaluate(predictions)

# Show accuracy
print(f&quot;Model Accuracy: {accuracy}&quot;)</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we explored the importance of Big Data Analytics and how Apache Spark can be leveraged to perform powerful data analysis. We covered key tools such as Spark SQL, DataFrames, MLlib, and GraphX, and provided practical examples and exercises to solidify your understanding. With these skills, you are now equipped to handle large datasets and extract valuable insights to drive decision-making and innovation.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-01-real-time-data-processing' title="Real-Time Data Processing">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-03-machine-learning-pipelines' title="Machine Learning Pipelines">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiÃ¨ncia d'Ãºs i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
