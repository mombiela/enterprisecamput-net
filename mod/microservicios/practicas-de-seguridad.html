<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security Practices in Microservices</title>

    <link rel="alternate" href="https://campusempresa.com/mod/microservicios/practicas-de-seguridad" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/microservicios/practicas-de-seguridad" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/microservicios/practicas-de-seguridad" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/microservicios/practicas-de-seguridad" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/microservicios/practicas-de-seguridad" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In microservices development, security is a critical aspect that should not be underestimated. As applications are broken down into smaller, distributed services, the attack surface increases, requiring special attention to security practices. This topic will cover the best security practices for microservices, providing examples and exercises to help IT professionals implement secure solutions.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Authentication and Authorization</strong>: Ensuring that only authorized users and services can access resources.</li>
<li><strong>Secure Communication</strong>: Ensuring that all communications between microservices are encrypted.</li>
<li><strong>Secure Configuration Management</strong>: Securely handling configurations and secrets.</li>
<li><strong>Logging and Monitoring</strong>: Implementing logging and monitoring to detect and respond to security incidents.</li>
<li><strong>Security Testing</strong>: Regularly conducting security tests to identify and mitigate vulnerabilities.</li>
</ul>
</div><h1>Authentication and Authorization</h1>
<div class='content'></div><h2>Authentication</h2>
<div class='content'><p>Authentication is the process of verifying the identity of a user or service. In the context of microservices, it is common to use JWT (JSON Web Tokens) to authenticate requests.</p>
<p>Example of generating a JWT token in Node.js:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7Cgpjb25zdCB1c2VyID0gewogIGlkOiAxLAogIHVzZXJuYW1lOiAndXNlcjEnCn07Cgpjb25zdCB0b2tlbiA9IGp3dC5zaWduKHVzZXIsICdzZWNyZXRLZXknLCB7IGV4cGlyZXNJbjogJzFoJyB9KTsKCmNvbnNvbGUubG9nKHRva2VuKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const jwt = require('jsonwebtoken');

const user = {
  id: 1,
  username: 'user1'
};

const token = jwt.sign(user, 'secretKey', { expiresIn: '1h' });

console.log(token);</pre></div><div class='content'></div><h2>Authorization</h2>
<div class='content'><p>Authorization determines what resources an authenticated user or service can access. A common approach is to use OAuth 2.0 to manage permissions.</p>
<p>Example of OAuth 2.0 configuration in Spring Boot:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QENvbmZpZ3VyYXRpb24KQEVuYWJsZUF1dGhvcml6YXRpb25TZXJ2ZXIKcHVibGljIGNsYXNzIEF1dGhvcml6YXRpb25TZXJ2ZXJDb25maWcgZXh0ZW5kcyBBdXRob3JpemF0aW9uU2VydmVyQ29uZmlndXJlckFkYXB0ZXIgewoKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgY29uZmlndXJlKENsaWVudERldGFpbHNTZXJ2aWNlQ29uZmlndXJlciBjbGllbnRzKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBjbGllbnRzLmluTWVtb3J5KCkKICAgICAgICAgICAgLndpdGhDbGllbnQoImNsaWVudElkIikKICAgICAgICAgICAgLnNlY3JldCgiY2xpZW50U2VjcmV0IikKICAgICAgICAgICAgLmF1dGhvcml6ZWRHcmFudFR5cGVzKCJhdXRob3JpemF0aW9uX2NvZGUiLCAicmVmcmVzaF90b2tlbiIsICJwYXNzd29yZCIpCiAgICAgICAgICAgIC5zY29wZXMoInJlYWQiLCAid3JpdGUiKTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@Configuration
@EnableAuthorizationServer
public class AuthorizationServerConfig extends AuthorizationServerConfigurerAdapter {

    @Override
    public void configure(ClientDetailsServiceConfigurer clients) throws Exception {
        clients.inMemory()
            .withClient(&quot;clientId&quot;)
            .secret(&quot;clientSecret&quot;)
            .authorizedGrantTypes(&quot;authorization_code&quot;, &quot;refresh_token&quot;, &quot;password&quot;)
            .scopes(&quot;read&quot;, &quot;write&quot;);
    }
}</pre></div><div class='content'></div><h1>Secure Communication</h1>
<div class='content'><p>To secure communication between microservices, it is essential to use HTTPS and TLS encryption.</p>
</div><h2>HTTPS configuration in an Express.js server:</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwpjb25zdCBodHRwcyA9IHJlcXVpcmUoJ2h0dHBzJyk7CmNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7Cgpjb25zdCBhcHAgPSBleHByZXNzKCk7Cgpjb25zdCBvcHRpb25zID0gewogIGtleTogZnMucmVhZEZpbGVTeW5jKCdrZXkucGVtJyksCiAgY2VydDogZnMucmVhZEZpbGVTeW5jKCdjZXJ0LnBlbScpCn07CgpodHRwcy5jcmVhdGVTZXJ2ZXIob3B0aW9ucywgYXBwKS5saXN0ZW4oMzAwMCwgKCkgPT4gewogIGNvbnNvbGUubG9nKCdTZXJ2ZXIgaXMgcnVubmluZyBvbiBodHRwczovL2xvY2FsaG9zdDozMDAwJyk7Cn0pOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const fs = require('fs');
const https = require('https');
const express = require('express');

const app = express();

const options = {
  key: fs.readFileSync('key.pem'),
  cert: fs.readFileSync('cert.pem')
};

https.createServer(options, app).listen(3000, () =&gt; {
  console.log('Server is running on https://localhost:3000');
});</pre></div><div class='content'></div><h1>Secure Configuration Management</h1>
<div class='content'><p>Secrets and sensitive configurations must be managed securely. Tools like HashiCorp Vault or AWS Secrets Manager are useful for this purpose.</p>
</div><h2>Example of using AWS Secrets Manager in Python:</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGJvdG8zCmZyb20gYm90b2NvcmUuZXhjZXB0aW9ucyBpbXBvcnQgTm9DcmVkZW50aWFsc0Vycm9yLCBQYXJ0aWFsQ3JlZGVudGlhbHNFcnJvcgoKZGVmIGdldF9zZWNyZXQoKToKICAgIHNlY3JldF9uYW1lID0gIm15X3NlY3JldCIKICAgIHJlZ2lvbl9uYW1lID0gInVzLXdlc3QtMiIKCiAgICBjbGllbnQgPSBib3RvMy5jbGllbnQoCiAgICAgICAgc2VydmljZV9uYW1lPSdzZWNyZXRzbWFuYWdlcicsCiAgICAgICAgcmVnaW9uX25hbWU9cmVnaW9uX25hbWUKICAgICkKCiAgICB0cnk6CiAgICAgICAgZ2V0X3NlY3JldF92YWx1ZV9yZXNwb25zZSA9IGNsaWVudC5nZXRfc2VjcmV0X3ZhbHVlKAogICAgICAgICAgICBTZWNyZXRJZD1zZWNyZXRfbmFtZQogICAgICAgICkKICAgICAgICBzZWNyZXQgPSBnZXRfc2VjcmV0X3ZhbHVlX3Jlc3BvbnNlWydTZWNyZXRTdHJpbmcnXQogICAgICAgIHJldHVybiBzZWNyZXQKICAgIGV4Y2VwdCAoTm9DcmVkZW50aWFsc0Vycm9yLCBQYXJ0aWFsQ3JlZGVudGlhbHNFcnJvcikgYXMgZToKICAgICAgICBwcmludChmIkVycm9yIHJldHJpZXZpbmcgc2VjcmV0OiB7ZX0iKQogICAgICAgIHJldHVybiBOb25l"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import boto3
from botocore.exceptions import NoCredentialsError, PartialCredentialsError

def get_secret():
    secret_name = &quot;my_secret&quot;
    region_name = &quot;us-west-2&quot;

    client = boto3.client(
        service_name='secretsmanager',
        region_name=region_name
    )

    try:
        get_secret_value_response = client.get_secret_value(
            SecretId=secret_name
        )
        secret = get_secret_value_response['SecretString']
        return secret
    except (NoCredentialsError, PartialCredentialsError) as e:
        print(f&quot;Error retrieving secret: {e}&quot;)
        return None</pre></div><div class='content'></div><h1>Logging and Monitoring</h1>
<div class='content'><p>Implementing a logging and monitoring system is crucial to detect and respond to security incidents. Tools like ELK Stack (Elasticsearch, Logstash, Kibana) and Prometheus are widely used.</p>
</div><h2>Example of Logstash configuration to receive logs:</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW5wdXQgewogIGJlYXRzIHsKICAgIHBvcnQgPT4gNTA0NAogIH0KfQoKZmlsdGVyIHsKICBqc29uIHsKICAgIHNvdXJjZSA9PiAibWVzc2FnZSIKICB9Cn0KCm91dHB1dCB7CiAgZWxhc3RpY3NlYXJjaCB7CiAgICBob3N0cyA9PiBbImxvY2FsaG9zdDo5MjAwIl0KICAgIGluZGV4ID0+ICJtaWNyb3NlcnZpY2UtbG9ncy0leytZWVlZLk1NLmRkfSIKICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>input {
  beats {
    port =&gt; 5044
  }
}

filter {
  json {
    source =&gt; &quot;message&quot;
  }
}

output {
  elasticsearch {
    hosts =&gt; [&quot;localhost:9200&quot;]
    index =&gt; &quot;microservice-logs-%{+YYYY.MM.dd}&quot;
  }
}</pre></div><div class='content'></div><h1>Security Testing</h1>
<div class='content'><p>Regularly conducting security tests helps identify and mitigate vulnerabilities. Tools like OWASP ZAP and Burp Suite are useful for penetration testing.</p>
</div><h2>Example of using OWASP ZAP to scan a web application:</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("emFwLnNoIC1kYWVtb24gLXBvcnQgODA4MCAtaG9zdCAxMjcuMC4wLjEgLWNvbmZpZyBhcGkua2V5PTEyMzQ1CnphcC1jbGkgcXVpY2stc2NhbiBodHRwOi8vbG9jYWxob3N0OjMwMDA="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>zap.sh -daemon -port 8080 -host 127.0.0.1 -config api.key=12345
zap-cli quick-scan http://localhost:3000</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Security in microservices is a fundamental aspect that must be addressed from design to implementation and operation. By following the security practices described in this topic, IT professionals can build more secure and resilient systems. Remember that security is an ongoing process and should be reviewed and improved regularly.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
