<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitoring and Logging</title>

    <link rel="alternate" href="https://campusempresa.com/mod/microservicios/06-01-monitoreo-logging" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/microservicios/06-01-monitoreo-logging" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/microservicios/06-01-monitoring-logging" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/microservicios/06-01-monitoring-logging" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/microservicios/06-01-monitoring-logging" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-03-cicd-microservices' title="CI/CD for Microservices">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Monitoring and Logging</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-02-error-management' title="Error Management and Recovery">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Monitoring and logging are critical components in maintaining the health, performance, and security of microservices. This section will cover the essential concepts, tools, and best practices for implementing effective monitoring and logging strategies in a microservices architecture.</p>
</div><h1>Key Concepts</h1>
<div class='content'></div><h2>Monitoring</h2>
<div class='content'><p>Monitoring involves continuously collecting, analyzing, and visualizing data from your microservices to ensure they are running smoothly. Key aspects include:</p>
<ul>
<li><strong>Metrics</strong>: Quantitative data points such as CPU usage, memory consumption, request rates, and error rates.</li>
<li><strong>Alerts</strong>: Notifications triggered when metrics exceed predefined thresholds.</li>
<li><strong>Dashboards</strong>: Visual representations of metrics to provide insights into the system's health.</li>
</ul>
</div><h2>Logging</h2>
<div class='content'><p>Logging involves recording information about the system's operation, which can be used for debugging, auditing, and analyzing the behavior of microservices. Key aspects include:</p>
<ul>
<li><strong>Log Levels</strong>: Different levels of log severity (e.g., DEBUG, INFO, WARN, ERROR).</li>
<li><strong>Structured Logging</strong>: Logs that are formatted in a consistent, machine-readable way (e.g., JSON).</li>
<li><strong>Log Aggregation</strong>: Centralizing logs from multiple services for easier analysis.</li>
</ul>
</div><h1>Tools and Technologies</h1>
<div class='content'></div><h2>Monitoring Tools</h2>
<div class='content'><ul>
<li><strong>Prometheus</strong>: An open-source monitoring and alerting toolkit designed for reliability and scalability.</li>
<li><strong>Grafana</strong>: A powerful visualization tool that integrates with Prometheus to create interactive dashboards.</li>
<li><strong>Datadog</strong>: A monitoring and analytics platform for cloud-scale applications.</li>
</ul>
</div><h2>Logging Tools</h2>
<div class='content'><ul>
<li><strong>ELK Stack (Elasticsearch, Logstash, Kibana)</strong>: A popular stack for searching, analyzing, and visualizing log data.</li>
<li><strong>Fluentd</strong>: An open-source data collector for unified logging.</li>
<li><strong>Graylog</strong>: A powerful log management tool that provides real-time search and analysis.</li>
</ul>
</div><h1>Practical Example: Setting Up Monitoring and Logging</h1>
<div class='content'></div><h2>Step 1: Setting Up Prometheus and Grafana</h2>
<div class='content'><ol>
<li>
<p><strong>Install Prometheus</strong>:</p>
<pre><code class="language-bash">docker run -d --name=prometheus -p 9090:9090 prom/prometheus
</code></pre>
</li>
<li>
<p><strong>Configure Prometheus</strong>:
Create a <code>prometheus.yml</code> configuration file:</p>
<pre><code class="language-yaml">global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'microservices'
    static_configs:
      - targets: ['localhost:8080']
</code></pre>
</li>
<li>
<p><strong>Install Grafana</strong>:</p>
<pre><code class="language-bash">docker run -d --name=grafana -p 3000:3000 grafana/grafana
</code></pre>
</li>
<li>
<p><strong>Configure Grafana</strong>:</p>
<ul>
<li>Access Grafana at <code>http://localhost:3000</code>.</li>
<li>Add Prometheus as a data source.</li>
<li>Create dashboards to visualize metrics.</li>
</ul>
</li>
</ol>
</div><h2>Step 2: Setting Up ELK Stack for Logging</h2>
<div class='content'><ol>
<li>
<p><strong>Install Elasticsearch</strong>:</p>
<pre><code class="language-bash">docker run -d --name=elasticsearch -p 9200:9200 -e &quot;discovery.type=single-node&quot; elasticsearch:7.10.1
</code></pre>
</li>
<li>
<p><strong>Install Logstash</strong>:</p>
<pre><code class="language-bash">docker run -d --name=logstash -p 5044:5044 -v $(pwd)/logstash.conf:/usr/share/logstash/pipeline/logstash.conf logstash:7.10.1
</code></pre>
<p>Example <code>logstash.conf</code>:</p>
<pre><code class="language-plaintext">input {
  beats {
    port =&gt; 5044
  }
}

output {
  elasticsearch {
    hosts =&gt; [&quot;http://elasticsearch:9200&quot;]
    index =&gt; &quot;microservices-logs-%{+YYYY.MM.dd}&quot;
  }
}
</code></pre>
</li>
<li>
<p><strong>Install Kibana</strong>:</p>
<pre><code class="language-bash">docker run -d --name=kibana -p 5601:5601 --link elasticsearch:elasticsearch kibana:7.10.1
</code></pre>
</li>
<li>
<p><strong>Configure Kibana</strong>:</p>
<ul>
<li>Access Kibana at <code>http://localhost:5601</code>.</li>
<li>Set up index patterns to visualize logs.</li>
</ul>
</li>
</ol>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Implement Monitoring and Logging for a Sample Microservice</h2>
<div class='content'><ol>
<li>
<p><strong>Create a Sample Microservice</strong>:</p>
<pre><code class="language-python"># app.py
from flask import Flask
import logging

app = Flask(__name__)

logging.basicConfig(level=logging.INFO)

@app.route('/')
def hello_world():
    app.logger.info('Hello World endpoint was reached')
    return 'Hello, World!'

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=8080)
</code></pre>
</li>
<li>
<p><strong>Dockerize the Microservice</strong>:</p>
<pre><code class="language-dockerfile"># Dockerfile
FROM python:3.8-slim

WORKDIR /app

COPY app.py /app

RUN pip install flask

CMD [&quot;python&quot;, &quot;app.py&quot;]
</code></pre>
</li>
<li>
<p><strong>Run the Microservice</strong>:</p>
<pre><code class="language-bash">docker build -t sample-microservice .
docker run -d --name=sample-microservice -p 8080:8080 sample-microservice
</code></pre>
</li>
<li>
<p><strong>Integrate with Prometheus and ELK Stack</strong>:</p>
<ul>
<li>Ensure Prometheus is scraping metrics from the microservice.</li>
<li>Configure Logstash to collect logs from the microservice.</li>
</ul>
</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><ul>
<li>
<p><strong>Prometheus Configuration</strong>:</p>
<pre><code class="language-yaml">scrape_configs:
  - job_name: 'sample-microservice'
    static_configs:
      - targets: ['localhost:8080']
</code></pre>
</li>
<li>
<p><strong>Logstash Configuration</strong>:</p>
<pre><code class="language-plaintext">input {
  file {
    path =&gt; &quot;/var/log/sample-microservice.log&quot;
    start_position =&gt; &quot;beginning&quot;
  }
}

output {
  elasticsearch {
    hosts =&gt; [&quot;http://elasticsearch:9200&quot;]
    index =&gt; &quot;sample-microservice-logs-%{+YYYY.MM.dd}&quot;
  }
}
</code></pre>
</li>
</ul>
</div><h1>Summary</h1>
<div class='content'><p>In this section, we covered the importance of monitoring and logging in a microservices architecture. We discussed key concepts, tools, and technologies, and provided a practical example of setting up monitoring with Prometheus and Grafana, and logging with the ELK stack. By implementing these practices, you can ensure the health, performance, and security of your microservices.</p>
<p>Next, we will delve into error management and recovery strategies to handle failures gracefully in a microservices environment.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-03-cicd-microservices' title="CI/CD for Microservices">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-02-error-management' title="Error Management and Recovery">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
