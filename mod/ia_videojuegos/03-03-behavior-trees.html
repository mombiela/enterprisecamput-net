<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Behavior Trees</title>

    <link rel="alternate" href="https://campusempresa.com/mod/ia_videojuegos/03-03-behavior-trees" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/ia_videojuegos/03-03-behavior-trees" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/ia_videojuegos/03-03-behavior-trees" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/ia_videojuegos/03-03-behavior-trees" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/ia_videojuegos/03-03-behavior-trees" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='03-02-decision-trees' title="Decision Trees">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Behavior Trees</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-04-rule-based-systems' title="Rule-Based Systems">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Behavior Trees (BTs) are a powerful and flexible way to model the decision-making process of game characters. They are widely used in the game industry due to their modularity, reusability, and ease of understanding.</p>
</div><h1><p>Key Concepts of Behavior Trees</p>
</h1>
<div class='content'><ol>
<li><strong>Nodes</strong>: The basic building blocks of a behavior tree. Each node represents a specific behavior or decision.</li>
<li><strong>Root Node</strong>: The starting point of the behavior tree.</li>
<li><strong>Composite Nodes</strong>: Nodes that can have one or more child nodes. They control the flow of execution.</li>
<li><strong>Decorator Nodes</strong>: Nodes that modify the behavior of their child nodes.</li>
<li><strong>Leaf Nodes</strong>: The end nodes that perform actions or checks.</li>
</ol>
</div><h2><p>Types of Composite Nodes</p>
</h2>
<div class='content'><ol>
<li><strong>Sequence</strong>: Executes child nodes in order until one fails.</li>
<li><strong>Selector</strong>: Executes child nodes in order until one succeeds.</li>
<li><strong>Parallel</strong>: Executes all child nodes simultaneously.</li>
</ol>
</div><h2><p>Types of Decorator Nodes</p>
</h2>
<div class='content'><ol>
<li><strong>Inverter</strong>: Inverts the result of its child node.</li>
<li><strong>Repeater</strong>: Repeats the execution of its child node.</li>
<li><strong>Succeeder</strong>: Always returns success regardless of the child node's result.</li>
</ol>
</div><h2><p>Types of Leaf Nodes</p>
</h2>
<div class='content'><ol>
<li><strong>Action</strong>: Performs a specific task.</li>
<li><strong>Condition</strong>: Checks a condition and returns success or failure.</li>
</ol>
</div><h1><p>Example of a Behavior Tree</p>
</h1>
<div class='content'><p>Let's consider a simple example where an NPC (Non-Player Character) patrols an area and chases the player if they are detected.</p>
</div><h2><p>Behavior Tree Structure</p>
</h2>
<div class='content'><ul>
<li><strong>Root</strong>
<ul>
<li><strong>Selector</strong>
<ul>
<li><strong>Sequence (Patrol)</strong>
<ul>
<li><strong>Action (Move to Waypoint 1)</strong></li>
<li><strong>Action (Move to Waypoint 2)</strong></li>
</ul>
</li>
<li><strong>Sequence (Chase Player)</strong>
<ul>
<li><strong>Condition (Player Detected)</strong></li>
<li><strong>Action (Move to Player)</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div><h2><p>Pseudocode Implementation</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgTm9kZToKICAgIGRlZiBydW4oc2VsZik6CiAgICAgICAgcGFzcwoKY2xhc3MgQWN0aW9uKE5vZGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGFjdGlvbik6CiAgICAgICAgc2VsZi5hY3Rpb24gPSBhY3Rpb24KCiAgICBkZWYgcnVuKHNlbGYpOgogICAgICAgIHJldHVybiBzZWxmLmFjdGlvbigpCgpjbGFzcyBDb25kaXRpb24oTm9kZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgY29uZGl0aW9uKToKICAgICAgICBzZWxmLmNvbmRpdGlvbiA9IGNvbmRpdGlvbgoKICAgIGRlZiBydW4oc2VsZik6CiAgICAgICAgcmV0dXJuIHNlbGYuY29uZGl0aW9uKCkKCmNsYXNzIFNlcXVlbmNlKE5vZGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGNoaWxkcmVuKToKICAgICAgICBzZWxmLmNoaWxkcmVuID0gY2hpbGRyZW4KCiAgICBkZWYgcnVuKHNlbGYpOgogICAgICAgIGZvciBjaGlsZCBpbiBzZWxmLmNoaWxkcmVuOgogICAgICAgICAgICBpZiBub3QgY2hpbGQucnVuKCk6CiAgICAgICAgICAgICAgICByZXR1cm4gRmFsc2UKICAgICAgICByZXR1cm4gVHJ1ZQoKY2xhc3MgU2VsZWN0b3IoTm9kZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgY2hpbGRyZW4pOgogICAgICAgIHNlbGYuY2hpbGRyZW4gPSBjaGlsZHJlbgoKICAgIGRlZiBydW4oc2VsZik6CiAgICAgICAgZm9yIGNoaWxkIGluIHNlbGYuY2hpbGRyZW46CiAgICAgICAgICAgIGlmIGNoaWxkLnJ1bigpOgogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gRmFsc2UKCiMgQWN0aW9ucwpkZWYgbW92ZV90b193YXlwb2ludF8xKCk6CiAgICBwcmludCgiTW92aW5nIHRvIFdheXBvaW50IDEiKQogICAgcmV0dXJuIFRydWUKCmRlZiBtb3ZlX3RvX3dheXBvaW50XzIoKToKICAgIHByaW50KCJNb3ZpbmcgdG8gV2F5cG9pbnQgMiIpCiAgICByZXR1cm4gVHJ1ZQoKZGVmIG1vdmVfdG9fcGxheWVyKCk6CiAgICBwcmludCgiQ2hhc2luZyBQbGF5ZXIiKQogICAgcmV0dXJuIFRydWUKCiMgQ29uZGl0aW9ucwpkZWYgcGxheWVyX2RldGVjdGVkKCk6CiAgICBwcmludCgiUGxheWVyIERldGVjdGVkIikKICAgIHJldHVybiBUcnVlCgojIEJ1aWxkaW5nIHRoZSBCZWhhdmlvciBUcmVlCnBhdHJvbF9zZXF1ZW5jZSA9IFNlcXVlbmNlKFtBY3Rpb24obW92ZV90b193YXlwb2ludF8xKSwgQWN0aW9uKG1vdmVfdG9fd2F5cG9pbnRfMildKQpjaGFzZV9zZXF1ZW5jZSA9IFNlcXVlbmNlKFtDb25kaXRpb24ocGxheWVyX2RldGVjdGVkKSwgQWN0aW9uKG1vdmVfdG9fcGxheWVyKV0pCnJvb3QgPSBTZWxlY3RvcihbcGF0cm9sX3NlcXVlbmNlLCBjaGFzZV9zZXF1ZW5jZV0pCgojIFJ1bm5pbmcgdGhlIEJlaGF2aW9yIFRyZWUKcm9vdC5ydW4oKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Node:
    def run(self):
        pass

class Action(Node):
    def __init__(self, action):
        self.action = action

    def run(self):
        return self.action()

class Condition(Node):
    def __init__(self, condition):
        self.condition = condition

    def run(self):
        return self.condition()

class Sequence(Node):
    def __init__(self, children):
        self.children = children

    def run(self):
        for child in self.children:
            if not child.run():
                return False
        return True

class Selector(Node):
    def __init__(self, children):
        self.children = children

    def run(self):
        for child in self.children:
            if child.run():
                return True
        return False

# Actions
def move_to_waypoint_1():
    print(&quot;Moving to Waypoint 1&quot;)
    return True

def move_to_waypoint_2():
    print(&quot;Moving to Waypoint 2&quot;)
    return True

def move_to_player():
    print(&quot;Chasing Player&quot;)
    return True

# Conditions
def player_detected():
    print(&quot;Player Detected&quot;)
    return True

# Building the Behavior Tree
patrol_sequence = Sequence([Action(move_to_waypoint_1), Action(move_to_waypoint_2)])
chase_sequence = Sequence([Condition(player_detected), Action(move_to_player)])
root = Selector([patrol_sequence, chase_sequence])

# Running the Behavior Tree
root.run()</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>Action Nodes</strong>: <code>move_to_waypoint_1</code>, <code>move_to_waypoint_2</code>, and <code>move_to_player</code> are actions that the NPC can perform.</li>
<li><strong>Condition Node</strong>: <code>player_detected</code> checks if the player is detected.</li>
<li><strong>Sequence Node</strong>: <code>patrol_sequence</code> and <code>chase_sequence</code> are sequences of actions and conditions.</li>
<li><strong>Selector Node</strong>: <code>root</code> selects between patrolling and chasing based on the conditions.</li>
</ul>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Extend the Behavior Tree</p>
</h2>
<div class='content'><p>Extend the behavior tree to include a new action where the NPC returns to a safe zone if the player's health is low.</p>
<h4>Steps:</h4>
<ol>
<li>Add a new condition to check if the player's health is low.</li>
<li>Add a new action to move to the safe zone.</li>
<li>Integrate these into the existing behavior tree.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBOZXcgQWN0aW9ucwpkZWYgbW92ZV90b19zYWZlX3pvbmUoKToKICAgIHByaW50KCJNb3ZpbmcgdG8gU2FmZSBab25lIikKICAgIHJldHVybiBUcnVlCgojIE5ldyBDb25kaXRpb25zCmRlZiBwbGF5ZXJfaGVhbHRoX2xvdygpOgogICAgcHJpbnQoIlBsYXllciBIZWFsdGggTG93IikKICAgIHJldHVybiBUcnVlCgojIEJ1aWxkaW5nIHRoZSBFeHRlbmRlZCBCZWhhdmlvciBUcmVlCnJldHVybl90b19zYWZlX3pvbmVfc2VxdWVuY2UgPSBTZXF1ZW5jZShbQ29uZGl0aW9uKHBsYXllcl9oZWFsdGhfbG93KSwgQWN0aW9uKG1vdmVfdG9fc2FmZV96b25lKV0pCnJvb3QgPSBTZWxlY3RvcihbcmV0dXJuX3RvX3NhZmVfem9uZV9zZXF1ZW5jZSwgcGF0cm9sX3NlcXVlbmNlLCBjaGFzZV9zZXF1ZW5jZV0pCgojIFJ1bm5pbmcgdGhlIEV4dGVuZGVkIEJlaGF2aW9yIFRyZWUKcm9vdC5ydW4oKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># New Actions
def move_to_safe_zone():
    print(&quot;Moving to Safe Zone&quot;)
    return True

# New Conditions
def player_health_low():
    print(&quot;Player Health Low&quot;)
    return True

# Building the Extended Behavior Tree
return_to_safe_zone_sequence = Sequence([Condition(player_health_low), Action(move_to_safe_zone)])
root = Selector([return_to_safe_zone_sequence, patrol_sequence, chase_sequence])

# Running the Extended Behavior Tree
root.run()</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>New Action Node</strong>: <code>move_to_safe_zone</code> is the action to move to the safe zone.</li>
<li><strong>New Condition Node</strong>: <code>player_health_low</code> checks if the player's health is low.</li>
<li><strong>New Sequence Node</strong>: <code>return_to_safe_zone_sequence</code> is the sequence for returning to the safe zone.</li>
<li><strong>Updated Selector Node</strong>: <code>root</code> now includes the new sequence for returning to the safe zone.</li>
</ul>
</div><h1><p>Summary</p>
</h1>
<div class='content'><p>Behavior Trees provide a structured and modular way to implement complex behaviors in game characters. By understanding and utilizing nodes, sequences, selectors, and decorators, you can create flexible and reusable AI behaviors. The practical exercise helps reinforce the concepts by extending the behavior tree with new actions and conditions.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='03-02-decision-trees' title="Decision Trees">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-04-rule-based-systems' title="Rule-Based Systems">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
