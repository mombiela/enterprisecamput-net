<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Dynamic Inventory</title>

    <link rel="alternate" href="https://campusempresa.com/mod/ansible/10-02-dynamic-inventory" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/ansible/10-02-dynamic-inventory" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/ansible/10-02-dynamic-inventory" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>var DEVELOP = window.location.href.indexOf("localhost")!=-1 && true;</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/ansible/10-02-dynamic-inventory" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/ansible/10-02-dynamic-inventory" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>
		<!-- <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

			</div>
		</div>
	</div>
</div>
 -->
 
<div class="top-bar container-fluid">
	<div class="container-xxl">
		<nav class="navbar navbar-expand-md p-0">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<div class="navbar-nav me-auto">
							<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

					</div>
				</div>			
							</div>
		</nav>
	</div>
</div>				<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='10-01-custom-modules' title="Custom Modules">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<h2 style="text-decoration:underline">Dynamic Inventory</h2>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='10-03-ansible-plugins' title="Ansible Plugins">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Dynamic Inventory in Ansible allows you to manage and configure your infrastructure dynamically, without the need to manually update static inventory files. This is particularly useful in environments where the infrastructure is constantly changing, such as cloud environments.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li>
<p><strong>Static vs. Dynamic Inventory</strong>:</p>
<ul>
<li><strong>Static Inventory</strong>: A predefined list of hosts and groups in a file.</li>
<li><strong>Dynamic Inventory</strong>: Inventory is generated dynamically by querying external sources like cloud providers, databases, or other APIs.</li>
</ul>
</li>
<li>
<p><strong>Inventory Scripts</strong>: Custom scripts that generate inventory data dynamically.</p>
</li>
<li>
<p><strong>Inventory Plugins</strong>: Built-in or custom plugins that can be used to fetch inventory data from various sources.</p>
</li>
</ol>
</div><h1>Why Use Dynamic Inventory?</h1>
<div class='content'><ul>
<li><strong>Scalability</strong>: Automatically adapt to changes in your infrastructure.</li>
<li><strong>Flexibility</strong>: Integrate with various cloud providers and services.</li>
<li><strong>Automation</strong>: Reduce manual intervention and errors.</li>
</ul>
</div><h1>Setting Up Dynamic Inventory</h1>
<div class='content'></div><h2>Using Inventory Scripts</h2>
<div class='content'><ol>
<li>
<p><strong>Create an Inventory Script</strong>:</p>
<ul>
<li>Write a script that outputs JSON data in the format expected by Ansible.</li>
</ul>
<pre><code class="language-python"># dynamic_inventory.py
import json

inventory = {
    &quot;all&quot;: {
        &quot;hosts&quot;: [&quot;host1.example.com&quot;, &quot;host2.example.com&quot;],
        &quot;vars&quot;: {
            &quot;ansible_user&quot;: &quot;admin&quot;
        }
    },
    &quot;_meta&quot;: {
        &quot;hostvars&quot;: {
            &quot;host1.example.com&quot;: {
                &quot;ansible_host&quot;: &quot;192.168.1.1&quot;
            },
            &quot;host2.example.com&quot;: {
                &quot;ansible_host&quot;: &quot;192.168.1.2&quot;
            }
        }
    }
}

print(json.dumps(inventory))
</code></pre>
</li>
<li>
<p><strong>Make the Script Executable</strong>:</p>
<pre><code class="language-bash">chmod +x dynamic_inventory.py
</code></pre>
</li>
<li>
<p><strong>Use the Script in Ansible</strong>:</p>
<ul>
<li>Specify the script as the inventory source when running Ansible commands.</li>
</ul>
<pre><code class="language-bash">ansible -i dynamic_inventory.py all -m ping
</code></pre>
</li>
</ol>
</div><h2>Using Inventory Plugins</h2>
<div class='content'><ol>
<li>
<p><strong>Enable the Plugin</strong>:</p>
<ul>
<li>Ensure the required plugin is enabled in your <code>ansible.cfg</code> file.</li>
</ul>
<pre><code class="language-ini">[defaults]
inventory = ./inventory/aws_ec2.yml
</code></pre>
</li>
<li>
<p><strong>Configure the Plugin</strong>:</p>
<ul>
<li>Create a configuration file for the plugin.</li>
</ul>
<pre><code class="language-yaml"># inventory/aws_ec2.yml
plugin: aws_ec2
regions:
  - us-east-1
filters:
  instance-state-name: running
keyed_groups:
  - key: tags.Name
    prefix: tag
</code></pre>
</li>
<li>
<p><strong>Run Ansible Commands</strong>:</p>
<ul>
<li>Use the configuration file as the inventory source.</li>
</ul>
<pre><code class="language-bash">ansible -i inventory/aws_ec2.yml all -m ping
</code></pre>
</li>
</ol>
</div><h1>Practical Example</h1>
<div class='content'></div><h2>Example: Using AWS EC2 Plugin</h2>
<div class='content'><ol>
<li>
<p><strong>Install Boto3</strong>:</p>
<ul>
<li>Ensure you have the <code>boto3</code> library installed.</li>
</ul>
<pre><code class="language-bash">pip install boto3
</code></pre>
</li>
<li>
<p><strong>Create AWS EC2 Inventory Configuration</strong>:</p>
<pre><code class="language-yaml"># inventory/aws_ec2.yml
plugin: aws_ec2
regions:
  - us-west-2
filters:
  instance-state-name: running
keyed_groups:
  - key: tags.Name
    prefix: tag
</code></pre>
</li>
<li>
<p><strong>Run Ansible Command</strong>:</p>
<pre><code class="language-bash">ansible -i inventory/aws_ec2.yml all -m ping
</code></pre>
</li>
</ol>
</div><h1>Exercises</h1>
<div class='content'></div><h2>Exercise 1: Create a Custom Inventory Script</h2>
<div class='content'><ol>
<li>Write a Python script that generates a dynamic inventory for a set of hosts.</li>
<li>Make the script executable.</li>
<li>Use the script as the inventory source in an Ansible command.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBjdXN0b21faW52ZW50b3J5LnB5CmltcG9ydCBqc29uCgppbnZlbnRvcnkgPSB7CiAgICAiYWxsIjogewogICAgICAgICJob3N0cyI6IFsid2ViMS5leGFtcGxlLmNvbSIsICJ3ZWIyLmV4YW1wbGUuY29tIl0sCiAgICAgICAgInZhcnMiOiB7CiAgICAgICAgICAgICJhbnNpYmxlX3VzZXIiOiAiYWRtaW4iCiAgICAgICAgfQogICAgfSwKICAgICJfbWV0YSI6IHsKICAgICAgICAiaG9zdHZhcnMiOiB7CiAgICAgICAgICAgICJ3ZWIxLmV4YW1wbGUuY29tIjogewogICAgICAgICAgICAgICAgImFuc2libGVfaG9zdCI6ICIxMC4wLjAuMSIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgIndlYjIuZXhhbXBsZS5jb20iOiB7CiAgICAgICAgICAgICAgICAiYW5zaWJsZV9ob3N0IjogIjEwLjAuMC4yIgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9CgpwcmludChqc29uLmR1bXBzKGludmVudG9yeSkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># custom_inventory.py
import json

inventory = {
    &quot;all&quot;: {
        &quot;hosts&quot;: [&quot;web1.example.com&quot;, &quot;web2.example.com&quot;],
        &quot;vars&quot;: {
            &quot;ansible_user&quot;: &quot;admin&quot;
        }
    },
    &quot;_meta&quot;: {
        &quot;hostvars&quot;: {
            &quot;web1.example.com&quot;: {
                &quot;ansible_host&quot;: &quot;10.0.0.1&quot;
            },
            &quot;web2.example.com&quot;: {
                &quot;ansible_host&quot;: &quot;10.0.0.2&quot;
            }
        }
    }
}

print(json.dumps(inventory))</pre></div><div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2htb2QgK3ggY3VzdG9tX2ludmVudG9yeS5weQphbnNpYmxlIC1pIGN1c3RvbV9pbnZlbnRvcnkucHkgYWxsIC1tIHBpbmc="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>chmod +x custom_inventory.py
ansible -i custom_inventory.py all -m ping</pre></div><div class='content'></div><h2>Exercise 2: Configure and Use an Inventory Plugin</h2>
<div class='content'><ol>
<li>Choose a cloud provider plugin (e.g., AWS EC2).</li>
<li>Create a configuration file for the plugin.</li>
<li>Run an Ansible command using the plugin configuration.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBpbnZlbnRvcnkvYXdzX2VjMi55bWwKcGx1Z2luOiBhd3NfZWMyCnJlZ2lvbnM6CiAgLSB1cy13ZXN0LTIKZmlsdGVyczoKICBpbnN0YW5jZS1zdGF0ZS1uYW1lOiBydW5uaW5nCmtleWVkX2dyb3VwczoKICAtIGtleTogdGFncy5OYW1lCiAgICBwcmVmaXg6IHRhZw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># inventory/aws_ec2.yml
plugin: aws_ec2
regions:
  - us-west-2
filters:
  instance-state-name: running
keyed_groups:
  - key: tags.Name
    prefix: tag</pre></div><div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZSAtaSBpbnZlbnRvcnkvYXdzX2VjMi55bWwgYWxsIC1tIHBpbmc="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible -i inventory/aws_ec2.yml all -m ping</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>JSON Format</strong>: Ensure your inventory script outputs valid JSON.</li>
<li><strong>Permissions</strong>: Make sure your script is executable.</li>
<li><strong>Dependencies</strong>: Install necessary libraries (e.g., <code>boto3</code> for AWS).</li>
<li><strong>Configuration</strong>: Double-check your plugin configuration for typos or incorrect settings.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Dynamic Inventory in Ansible provides a powerful way to manage and scale your infrastructure dynamically. By using inventory scripts or plugins, you can automate the process of keeping your inventory up-to-date, reducing manual effort and potential errors. This module has covered the basics of setting up and using dynamic inventory, providing you with the tools to integrate it into your Ansible workflows.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='10-01-custom-modules' title="Custom Modules">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='10-03-ansible-plugins' title="Ansible Plugins">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
	     crossorigin="anonymous"></script>
	<!-- enterprise_campus -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-0611338592562725"
	     data-ad-slot="6914733106"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
	     (adsbygoogle = window.adsbygoogle || []).push({});
	</script>
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>Ansible: From Beginner to Advanced</h1>
<h2>Module 1: Introduction to Ansible</h2>
<ul>
<li><a href="01-01-what-is-ansible">What is Ansible?</a></li>
<li><a href="01-02-installing-ansible">Installing Ansible</a></li>
<li><a href="01-03-ansible-architecture">Ansible Architecture</a></li>
<li><a href="01-04-basic-ansible-commands">Basic Ansible Commands</a></li>
</ul>
<h2>Module 2: Ansible Basics</h2>
<ul>
<li><a href="02-01-inventory-files">Inventory Files</a></li>
<li><a href="02-02-ansible-configuration">Ansible Configuration</a></li>
<li><a href="02-03-ad-hoc-commands">Ad-Hoc Commands</a></li>
<li><a href="02-04-ansible-modules">Ansible Modules</a></li>
</ul>
<h2>Module 3: Playbooks</h2>
<ul>
<li><a href="03-01-introduction-to-playbooks">Introduction to Playbooks</a></li>
<li><a href="03-02-writing-your-first-playbook">Writing Your First Playbook</a></li>
<li><a href="03-03-playbook-structure">Playbook Structure</a></li>
<li><a href="03-04-variables-and-facts">Variables and Facts</a></li>
<li><a href="03-05-conditionals-and-loops">Conditionals and Loops</a></li>
</ul>
<h2>Module 4: Roles</h2>
<ul>
<li><a href="04-01-introduction-to-roles">Introduction to Roles</a></li>
<li><a href="04-02-creating-roles">Creating Roles</a></li>
<li><a href="04-03-role-directory-structure">Role Directory Structure</a></li>
<li><a href="04-04-using-roles-in-playbooks">Using Roles in Playbooks</a></li>
</ul>
<h2>Module 5: Advanced Playbook Techniques</h2>
<ul>
<li><a href="05-01-handlers">Handlers</a></li>
<li><a href="05-02-templates">Templates</a></li>
<li><a href="05-03-ansible-vault">Ansible Vault</a></li>
<li><a href="05-04-error-handling">Error Handling</a></li>
<li><a href="05-05-optimizing-playbooks">Optimizing Playbooks</a></li>
</ul>
<h2>Module 6: Ansible Galaxy</h2>
<ul>
<li><a href="06-01-what-is-ansible-galaxy">What is Ansible Galaxy?</a></li>
<li><a href="06-02-using-ansible-galaxy">Using Ansible Galaxy</a></li>
<li><a href="06-03-creating-and-sharing-roles">Creating and Sharing Roles</a></li>
</ul>
<h2>Module 7: Ansible Tower</h2>
<ul>
<li><a href="07-01-introduction-to-ansible-tower">Introduction to Ansible Tower</a></li>
<li><a href="07-02-installing-ansible-tower">Installing Ansible Tower</a></li>
<li><a href="07-03-using-ansible-tower">Using Ansible Tower</a></li>
<li><a href="07-04-managing-projects-and-inventories">Managing Projects and Inventories</a></li>
</ul>
<h2>Module 8: Ansible for DevOps</h2>
<ul>
<li><a href="08-01-ansible-and-docker">Ansible and Docker</a></li>
<li><a href="08-02-ansible-and-kubernetes">Ansible and Kubernetes</a></li>
<li><a href="08-03-ci-cd-with-ansible">CI/CD with Ansible</a></li>
<li><a href="08-04-ansible-in-cloud-environments">Ansible in Cloud Environments</a></li>
</ul>
<h2>Module 9: Ansible Best Practices</h2>
<ul>
<li><a href="09-01-code-organization">Code Organization</a></li>
<li><a href="09-02-security-best-practices">Security Best Practices</a></li>
<li><a href="09-03-performance-tuning">Performance Tuning</a></li>
<li><a href="09-04-testing-ansible-code">Testing Ansible Code</a></li>
</ul>
<h2>Module 10: Advanced Ansible Topics</h2>
<ul>
<li><a href="10-01-custom-modules">Custom Modules</a></li>
<li><a href="10-02-dynamic-inventory">Dynamic Inventory</a></li>
<li><a href="10-03-ansible-plugins">Ansible Plugins</a></li>
<li><a href="10-04-ansible-api">Ansible API</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
</body>
</html>
