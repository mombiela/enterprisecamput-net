<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conditionals and Loops</title>

    <link rel="alternate" href="https://campusempresa.com/mod/ansible/03-05-conditionals-and-loops" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/ansible/03-05-conditionals-and-loops" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/ansible/03-05-conditionals-and-loops" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/ansible/03-05-conditionals-and-loops" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/ansible/03-05-conditionals-and-loops" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Programming Languages</a>
				 					<a href="/categ/frameworks">Frameworks and Libraries</a>
				 					<a href="/categ/tech-tools">Technical Tools</a>
				 					<a href="/categ/foundations">Theoretical Foundations</a>
				 					<a href="/categ/soft-skills">Social Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-04-variables-and-facts' title="Variables and Facts">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Conditionals and Loops</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-01-introduction-to-roles' title="Introduction to Roles">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to use conditionals and loops in Ansible playbooks. These features allow you to create more dynamic and flexible automation scripts.</p>
</div><h1><p>Conditionals</p>
</h1>
<div class='content'><p>Conditionals in Ansible allow you to execute tasks based on certain conditions. This is useful when you want to perform actions only if specific criteria are met.</p>
</div><h2><p>Basic Syntax</p>
</h2>
<div class='content'><p>The basic syntax for conditionals in Ansible is to use the <code>when</code> keyword followed by a Jinja2 expression.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBJbnN0YWxsIEFwYWNoZSBvbiBEZWJpYW4tYmFzZWQgc3lzdGVtcwogIGFwdDoKICAgIG5hbWU6IGFwYWNoZTIKICAgIHN0YXRlOiBwcmVzZW50CiAgd2hlbjogYW5zaWJsZV9vc19mYW1pbHkgPT0gIkRlYmlhbiI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Install Apache on Debian-based systems
  apt:
    name: apache2
    state: present
  when: ansible_os_family == &quot;Debian&quot;</pre></div><div class='content'></div><h2><p>Practical Example</p>
</h2>
<div class='content'><p>Let's consider a more detailed example where we install different packages based on the operating system.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBJbnN0YWxsIHdlYiBzZXJ2ZXIKICBob3N0czogYWxsCiAgdGFza3M6CiAgICAtIG5hbWU6IEluc3RhbGwgQXBhY2hlIG9uIERlYmlhbi1iYXNlZCBzeXN0ZW1zCiAgICAgIGFwdDoKICAgICAgICBuYW1lOiBhcGFjaGUyCiAgICAgICAgc3RhdGU6IHByZXNlbnQKICAgICAgd2hlbjogYW5zaWJsZV9vc19mYW1pbHkgPT0gIkRlYmlhbiIKCiAgICAtIG5hbWU6IEluc3RhbGwgQXBhY2hlIG9uIFJlZEhhdC1iYXNlZCBzeXN0ZW1zCiAgICAgIHl1bToKICAgICAgICBuYW1lOiBodHRwZAogICAgICAgIHN0YXRlOiBwcmVzZW50CiAgICAgIHdoZW46IGFuc2libGVfb3NfZmFtaWx5ID09ICJSZWRIYXQi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Install web server
  hosts: all
  tasks:
    - name: Install Apache on Debian-based systems
      apt:
        name: apache2
        state: present
      when: ansible_os_family == &quot;Debian&quot;

    - name: Install Apache on RedHat-based systems
      yum:
        name: httpd
        state: present
      when: ansible_os_family == &quot;RedHat&quot;</pre></div><div class='content'></div><h2><p>Common Mistakes</p>
</h2>
<div class='content'><ul>
<li><strong>Incorrect Condition Syntax</strong>: Ensure that the condition is a valid Jinja2 expression.</li>
<li><strong>Indentation Errors</strong>: Make sure the <code>when</code> keyword is correctly indented under the task.</li>
</ul>
</div><h1><p>Loops</p>
</h1>
<div class='content'><p>Loops in Ansible allow you to repeat a task multiple times with different parameters. This is useful for tasks like installing multiple packages or creating multiple users.</p>
</div><h2><p>Basic Syntax</p>
</h2>
<div class='content'><p>The basic syntax for loops in Ansible is to use the <code>loop</code> keyword followed by a list of items.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBJbnN0YWxsIG11bHRpcGxlIHBhY2thZ2VzCiAgYXB0OgogICAgbmFtZTogInt7IGl0ZW0gfX0iCiAgICBzdGF0ZTogcHJlc2VudAogIGxvb3A6CiAgICAtIGFwYWNoZTIKICAgIC0gbXlzcWwtc2VydmVyCiAgICAtIHBocA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Install multiple packages
  apt:
    name: &quot;{{ item }}&quot;
    state: present
  loop:
    - apache2
    - mysql-server
    - php</pre></div><div class='content'></div><h2><p>Practical Example</p>
</h2>
<div class='content'><p>Let's consider a more detailed example where we create multiple users.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBDcmVhdGUgbXVsdGlwbGUgdXNlcnMKICBob3N0czogYWxsCiAgdGFza3M6CiAgICAtIG5hbWU6IEFkZCB1c2VycwogICAgICB1c2VyOgogICAgICAgIG5hbWU6ICJ7eyBpdGVtLm5hbWUgfX0iCiAgICAgICAgc3RhdGU6IHByZXNlbnQKICAgICAgICBncm91cHM6ICJ7eyBpdGVtLmdyb3VwcyB9fSIKICAgICAgbG9vcDoKICAgICAgICAtIHsgbmFtZTogJ2FsaWNlJywgZ3JvdXBzOiAnYWRtaW4nIH0KICAgICAgICAtIHsgbmFtZTogJ2JvYicsIGdyb3VwczogJ3VzZXJzJyB9CiAgICAgICAgLSB7IG5hbWU6ICdjaGFybGllJywgZ3JvdXBzOiAndXNlcnMnIH0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Create multiple users
  hosts: all
  tasks:
    - name: Add users
      user:
        name: &quot;{{ item.name }}&quot;
        state: present
        groups: &quot;{{ item.groups }}&quot;
      loop:
        - { name: 'alice', groups: 'admin' }
        - { name: 'bob', groups: 'users' }
        - { name: 'charlie', groups: 'users' }</pre></div><div class='content'></div><h2><p>Loop Control</p>
</h2>
<div class='content'><p>You can also control the behavior of loops using <code>loop_control</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBJbnN0YWxsIG11bHRpcGxlIHBhY2thZ2VzIHdpdGggaW5kZXgKICBhcHQ6CiAgICBuYW1lOiAie3sgaXRlbSB9fSIKICAgIHN0YXRlOiBwcmVzZW50CiAgbG9vcDoKICAgIC0gYXBhY2hlMgogICAgLSBteXNxbC1zZXJ2ZXIKICAgIC0gcGhwCiAgbG9vcF9jb250cm9sOgogICAgaW5kZXhfdmFyOiBwa2dfaW5kZXg="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Install multiple packages with index
  apt:
    name: &quot;{{ item }}&quot;
    state: present
  loop:
    - apache2
    - mysql-server
    - php
  loop_control:
    index_var: pkg_index</pre></div><div class='content'></div><h2><p>Common Mistakes</p>
</h2>
<div class='content'><ul>
<li><strong>Incorrect Loop Syntax</strong>: Ensure that the loop is a valid list.</li>
<li><strong>Variable Scope</strong>: Be cautious about variable scope within loops.</li>
</ul>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise</p>
</h2>
<div class='content'><p>Write a playbook that performs the following tasks:</p>
<ol>
<li>Installs <code>nginx</code> on Debian-based systems and <code>httpd</code> on RedHat-based systems.</li>
<li>Creates three users: <code>user1</code>, <code>user2</code>, and <code>user3</code>, each belonging to the <code>users</code> group.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBDb25kaXRpb25hbCBhbmQgTG9vcCBFeGVyY2lzZQogIGhvc3RzOiBhbGwKICB0YXNrczoKICAgIC0gbmFtZTogSW5zdGFsbCB3ZWIgc2VydmVyIG9uIERlYmlhbi1iYXNlZCBzeXN0ZW1zCiAgICAgIGFwdDoKICAgICAgICBuYW1lOiBuZ2lueAogICAgICAgIHN0YXRlOiBwcmVzZW50CiAgICAgIHdoZW46IGFuc2libGVfb3NfZmFtaWx5ID09ICJEZWJpYW4iCgogICAgLSBuYW1lOiBJbnN0YWxsIHdlYiBzZXJ2ZXIgb24gUmVkSGF0LWJhc2VkIHN5c3RlbXMKICAgICAgeXVtOgogICAgICAgIG5hbWU6IGh0dHBkCiAgICAgICAgc3RhdGU6IHByZXNlbnQKICAgICAgd2hlbjogYW5zaWJsZV9vc19mYW1pbHkgPT0gIlJlZEhhdCIKCiAgICAtIG5hbWU6IENyZWF0ZSBtdWx0aXBsZSB1c2VycwogICAgICB1c2VyOgogICAgICAgIG5hbWU6ICJ7eyBpdGVtIH19IgogICAgICAgIHN0YXRlOiBwcmVzZW50CiAgICAgICAgZ3JvdXBzOiB1c2VycwogICAgICBsb29wOgogICAgICAgIC0gdXNlcjEKICAgICAgICAtIHVzZXIyCiAgICAgICAgLSB1c2VyMw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Conditional and Loop Exercise
  hosts: all
  tasks:
    - name: Install web server on Debian-based systems
      apt:
        name: nginx
        state: present
      when: ansible_os_family == &quot;Debian&quot;

    - name: Install web server on RedHat-based systems
      yum:
        name: httpd
        state: present
      when: ansible_os_family == &quot;RedHat&quot;

    - name: Create multiple users
      user:
        name: &quot;{{ item }}&quot;
        state: present
        groups: users
      loop:
        - user1
        - user2
        - user3</pre></div><div class='content'></div><h1><p>Summary</p>
</h1>
<div class='content'><p>In this section, we covered:</p>
<ul>
<li>The use of conditionals with the <code>when</code> keyword to execute tasks based on specific conditions.</li>
<li>The use of loops with the <code>loop</code> keyword to repeat tasks with different parameters.</li>
<li>Practical examples and common mistakes to avoid.</li>
</ul>
<p>Understanding conditionals and loops will help you create more dynamic and flexible Ansible playbooks. In the next section, we will delve into roles, which allow you to organize your playbooks into reusable components.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-04-variables-and-facts' title="Variables and Facts">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-01-introduction-to-roles' title="Introduction to Roles">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
