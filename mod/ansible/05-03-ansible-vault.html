<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ansible Vault</title>

    <link rel="alternate" href="https://campusempresa.com/mod/ansible/05-03-ansible-vault" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/ansible/05-03-ansible-vault" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/ansible/05-03-ansible-vault" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/ansible/05-03-ansible-vault" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/ansible/05-03-ansible-vault" class="px-2">CA</a>
					</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-02-templates' title="Templates">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Ansible Vault</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-04-error-handling' title="Error Handling">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Ansible Vault is a feature that allows you to keep sensitive data such as passwords or keys in encrypted files, rather than as plaintext in playbooks or roles. This is crucial for maintaining security and confidentiality in your automation scripts.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Encryption and Decryption</strong>: Ansible Vault can encrypt and decrypt files using a password or a key file.</li>
<li><strong>Vault IDs</strong>: Allows you to manage multiple vault passwords.</li>
<li><strong>Vault Files</strong>: Files that are encrypted using Ansible Vault.</li>
</ol>
</div><h1><p>Why Use Ansible Vault?</p>
</h1>
<div class='content'><ul>
<li><strong>Security</strong>: Protect sensitive information from being exposed.</li>
<li><strong>Compliance</strong>: Meet security compliance requirements by encrypting sensitive data.</li>
<li><strong>Ease of Use</strong>: Integrates seamlessly with Ansible playbooks and roles.</li>
</ul>
</div><h1><p>Basic Commands</p>
</h1>
<div class='content'></div><h2><p>Encrypting a File</p>
</h2>
<div class='content'><p>To encrypt a file using Ansible Vault, use the following command:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCBlbmNyeXB0IDxmaWxlbmFtZT4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault encrypt &lt;filename&gt;</pre></div><div class='content'><p>Example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCBlbmNyeXB0IHNlY3JldHMueW1s"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault encrypt secrets.yml</pre></div><div class='content'></div><h2><p>Decrypting a File</p>
</h2>
<div class='content'><p>To decrypt a file, use:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCBkZWNyeXB0IDxmaWxlbmFtZT4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault decrypt &lt;filename&gt;</pre></div><div class='content'><p>Example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCBkZWNyeXB0IHNlY3JldHMueW1s"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault decrypt secrets.yml</pre></div><div class='content'></div><h2><p>Editing an Encrypted File</p>
</h2>
<div class='content'><p>To edit an encrypted file, use:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCBlZGl0IDxmaWxlbmFtZT4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault edit &lt;filename&gt;</pre></div><div class='content'><p>Example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCBlZGl0IHNlY3JldHMueW1s"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault edit secrets.yml</pre></div><div class='content'></div><h2><p>Viewing an Encrypted File</p>
</h2>
<div class='content'><p>To view the contents of an encrypted file without editing, use:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCB2aWV3IDxmaWxlbmFtZT4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault view &lt;filename&gt;</pre></div><div class='content'><p>Example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCB2aWV3IHNlY3JldHMueW1s"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault view secrets.yml</pre></div><div class='content'></div><h2><p>Re-keying an Encrypted File</p>
</h2>
<div class='content'><p>To change the password of an encrypted file, use:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCByZWtleSA8ZmlsZW5hbWU+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault rekey &lt;filename&gt;</pre></div><div class='content'><p>Example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS12YXVsdCByZWtleSBzZWNyZXRzLnltbA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-vault rekey secrets.yml</pre></div><div class='content'></div><h1><p>Using Vault in Playbooks</p>
</h1>
<div class='content'><p>You can use encrypted files in your playbooks by specifying the vault password file or prompting for the password.</p>
</div><h2><p>Example Playbook</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogRXhhbXBsZSBQbGF5Ym9vayB3aXRoIFZhdWx0CiAgaG9zdHM6IGFsbAogIHZhcnNfZmlsZXM6CiAgICAtIHNlY3JldHMueW1sCiAgdGFza3M6CiAgICAtIG5hbWU6IFByaW50IHNlY3JldCBtZXNzYWdlCiAgICAgIGRlYnVnOgogICAgICAgIG1zZzogInt7IHNlY3JldF9tZXNzYWdlIH19Ig=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Example Playbook with Vault
  hosts: all
  vars_files:
    - secrets.yml
  tasks:
    - name: Print secret message
      debug:
        msg: &quot;{{ secret_message }}&quot;</pre></div><div class='content'></div><h2><p>Running the Playbook</p>
</h2>
<div class='content'><p>To run the playbook with a vault password file:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS1wbGF5Ym9vayBwbGF5Ym9vay55bWwgLS12YXVsdC1wYXNzd29yZC1maWxlIC52YXVsdF9wYXNzLnR4dA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-playbook playbook.yml --vault-password-file .vault_pass.txt</pre></div><div class='content'><p>To run the playbook and be prompted for the vault password:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS1wbGF5Ym9vayBwbGF5Ym9vay55bWwgLS1hc2stdmF1bHQtcGFzcw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-playbook playbook.yml --ask-vault-pass</pre></div><div class='content'></div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Encrypting and Using a Secret File</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Create a file named <code>secrets.yml</code> with the following content:</strong></p>
<pre><code class="language-yaml">secret_message: &quot;This is a secret message&quot;
</code></pre>
</li>
<li>
<p><strong>Encrypt the file using Ansible Vault:</strong></p>
<pre><code class="language-bash">ansible-vault encrypt secrets.yml
</code></pre>
</li>
<li>
<p><strong>Create a playbook named <code>vault_playbook.yml</code> that uses the encrypted file:</strong></p>
<pre><code class="language-yaml">---
- name: Playbook using Vault
  hosts: localhost
  vars_files:
    - secrets.yml
  tasks:
    - name: Print the secret message
      debug:
        msg: &quot;{{ secret_message }}&quot;
</code></pre>
</li>
<li>
<p><strong>Run the playbook and provide the vault password when prompted:</strong></p>
<pre><code class="language-bash">ansible-playbook vault_playbook.yml --ask-vault-pass
</code></pre>
</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Encrypting the file:</strong></p>
<pre><code class="language-bash">ansible-vault encrypt secrets.yml
</code></pre>
</li>
<li>
<p><strong>Playbook content (<code>vault_playbook.yml</code>):</strong></p>
<pre><code class="language-yaml">---
- name: Playbook using Vault
  hosts: localhost
  vars_files:
    - secrets.yml
  tasks:
    - name: Print the secret message
      debug:
        msg: &quot;{{ secret_message }}&quot;
</code></pre>
</li>
<li>
<p><strong>Running the playbook:</strong></p>
<pre><code class="language-bash">ansible-playbook vault_playbook.yml --ask-vault-pass
</code></pre>
</li>
</ol>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Forgetting to encrypt files</strong>: Always ensure sensitive files are encrypted before committing them to version control.</li>
<li><strong>Misplacing the vault password</strong>: Store the vault password securely and avoid hardcoding it in scripts.</li>
<li><strong>Using multiple vault passwords</strong>: Use Vault IDs to manage multiple vault passwords effectively.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Ansible Vault is a powerful tool for securing sensitive data in your automation scripts. By understanding how to encrypt, decrypt, and use vault files in playbooks, you can enhance the security of your Ansible projects. Practice encrypting and using vault files to become proficient in managing sensitive information securely.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-02-templates' title="Templates">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-04-error-handling' title="Error Handling">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
