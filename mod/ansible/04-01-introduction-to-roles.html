<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Introduction to Roles</title>

    <link rel="alternate" href="https://campusempresa.com/mod/ansible/04-01-introduction-to-roles" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/ansible/04-01-introduction-to-roles" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/ansible/04-01-introduction-to-roles" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>var DEVELOP = window.location.href.indexOf("localhost")!=-1 && true;</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/ansible/04-01-introduction-to-roles" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/ansible/04-01-introduction-to-roles" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>
		<!-- <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

			</div>
		</div>
	</div>
</div>
 -->
 
<div class="top-bar container-fluid">
	<div class="container-xxl">
		<nav class="navbar navbar-expand-md p-0">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<div class="navbar-nav me-auto">
							<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

					</div>
				</div>			
							</div>
		</nav>
	</div>
</div>				<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-05-conditionals-and-loops' title="Conditionals and Loops">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<h2 style="text-decoration:underline">Introduction to Roles</h2>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-02-creating-roles' title="Creating Roles">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore the concept of roles in Ansible, which is a powerful feature that helps in organizing and reusing Ansible code. Roles allow you to break down your playbooks into smaller, reusable components, making your automation tasks more manageable and scalable.</p>
</div><h1>What are Roles?</h1>
<div class='content'><p>Roles in Ansible are a way to group related tasks, variables, files, templates, and handlers into a single unit. This modular approach helps in organizing your playbooks and makes it easier to share and reuse code.</p>
</div><h2>Key Concepts of Roles</h2>
<div class='content'><ol>
<li><strong>Modularity</strong>: Roles allow you to break down complex playbooks into smaller, manageable pieces.</li>
<li><strong>Reusability</strong>: Roles can be reused across different playbooks and projects.</li>
<li><strong>Organization</strong>: Roles help in organizing your Ansible code by separating different functionalities into distinct directories.</li>
<li><strong>Scalability</strong>: Roles make it easier to scale your automation tasks by reusing existing roles and combining them in different ways.</li>
</ol>
</div><h1>Role Directory Structure</h1>
<div class='content'><p>A role has a specific directory structure that Ansible expects. Here is a typical structure of a role:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bXlfcm9sZS8K4pSc4pSA4pSAIGRlZmF1bHRzLwrilIIgICDilJTilIDilIAgbWFpbi55bWwK4pSc4pSA4pSAIGZpbGVzLwrilJzilIDilIAgaGFuZGxlcnMvCuKUgiAgIOKUlOKUgOKUgCBtYWluLnltbArilJzilIDilIAgbWV0YS8K4pSCICAg4pSU4pSA4pSAIG1haW4ueW1sCuKUnOKUgOKUgCB0YXNrcy8K4pSCICAg4pSU4pSA4pSAIG1haW4ueW1sCuKUnOKUgOKUgCB0ZW1wbGF0ZXMvCuKUnOKUgOKUgCB0ZXN0cy8K4pSCICAg4pSc4pSA4pSAIGludmVudG9yeQrilIIgICDilJTilIDilIAgdGVzdC55bWwK4pSU4pSA4pSAIHZhcnMvCiAgICDilJTilIDilIAgbWFpbi55bWw="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>my_role/
├── defaults/
│   └── main.yml
├── files/
├── handlers/
│   └── main.yml
├── meta/
│   └── main.yml
├── tasks/
│   └── main.yml
├── templates/
├── tests/
│   ├── inventory
│   └── test.yml
└── vars/
    └── main.yml</pre></div><div class='content'></div><h2>Explanation of Directories</h2>
<div class='content'><ul>
<li><strong>defaults/</strong>: Contains default variables for the role.</li>
<li><strong>files/</strong>: Contains files that can be deployed by the role.</li>
<li><strong>handlers/</strong>: Contains handlers that can be used within the role.</li>
<li><strong>meta/</strong>: Contains metadata about the role, such as dependencies.</li>
<li><strong>tasks/</strong>: Contains the main list of tasks to be executed by the role.</li>
<li><strong>templates/</strong>: Contains Jinja2 templates that can be deployed by the role.</li>
<li><strong>tests/</strong>: Contains test playbooks and inventory files for testing the role.</li>
<li><strong>vars/</strong>: Contains variables that are specific to the role.</li>
</ul>
</div><h1>Creating a Simple Role</h1>
<div class='content'><p>Let's create a simple role that installs and starts the Apache web server.</p>
</div><h2>Step-by-Step Guide</h2>
<div class='content'><ol>
<li>
<p><strong>Create the Role Directory Structure</strong></p>
<pre><code class="language-bash">$ ansible-galaxy init my_apache_role
</code></pre>
<p>This command will create the necessary directory structure for the role.</p>
</li>
<li>
<p><strong>Define Tasks</strong></p>
<p>Edit the <code>tasks/main.yml</code> file to include tasks for installing and starting Apache.</p>
<pre><code class="language-yaml">---
# tasks/main.yml
- name: Install Apache
  apt:
    name: apache2
    state: present
    update_cache: yes

- name: Start Apache
  service:
    name: apache2
    state: started
    enabled: yes
</code></pre>
</li>
<li>
<p><strong>Define Handlers</strong></p>
<p>Edit the <code>handlers/main.yml</code> file to include a handler for restarting Apache.</p>
<pre><code class="language-yaml">---
# handlers/main.yml
- name: Restart Apache
  service:
    name: apache2
    state: restarted
</code></pre>
</li>
<li>
<p><strong>Define Default Variables</strong></p>
<p>Edit the <code>defaults/main.yml</code> file to include any default variables.</p>
<pre><code class="language-yaml">---
# defaults/main.yml
apache_port: 80
</code></pre>
</li>
<li>
<p><strong>Define Templates</strong></p>
<p>If you need to deploy configuration files, you can place Jinja2 templates in the <code>templates/</code> directory.</p>
<pre><code class="language-jinja2"># templates/apache.conf.j2
Listen {{ apache_port }}
</code></pre>
</li>
<li>
<p><strong>Use the Role in a Playbook</strong></p>
<p>Create a playbook that uses the role.</p>
<pre><code class="language-yaml">---
# playbook.yml
- hosts: webservers
  roles:
    - my_apache_role
</code></pre>
</li>
</ol>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Create a Role to Install and Configure Nginx</h2>
<div class='content'><ol>
<li>
<p><strong>Create a Role</strong></p>
<p>Use the <code>ansible-galaxy init</code> command to create a role named <code>my_nginx_role</code>.</p>
<pre><code class="language-bash">$ ansible-galaxy init my_nginx_role
</code></pre>
</li>
<li>
<p><strong>Define Tasks</strong></p>
<p>Edit the <code>tasks/main.yml</code> file to include tasks for installing and starting Nginx.</p>
<pre><code class="language-yaml">---
# tasks/main.yml
- name: Install Nginx
  apt:
    name: nginx
    state: present
    update_cache: yes

- name: Start Nginx
  service:
    name: nginx
    state: started
    enabled: yes
</code></pre>
</li>
<li>
<p><strong>Define Handlers</strong></p>
<p>Edit the <code>handlers/main.yml</code> file to include a handler for restarting Nginx.</p>
<pre><code class="language-yaml">---
# handlers/main.yml
- name: Restart Nginx
  service:
    name: nginx
    state: restarted
</code></pre>
</li>
<li>
<p><strong>Define Default Variables</strong></p>
<p>Edit the <code>defaults/main.yml</code> file to include any default variables.</p>
<pre><code class="language-yaml">---
# defaults/main.yml
nginx_port: 80
</code></pre>
</li>
<li>
<p><strong>Define Templates</strong></p>
<p>If you need to deploy configuration files, you can place Jinja2 templates in the <code>templates/</code> directory.</p>
<pre><code class="language-jinja2"># templates/nginx.conf.j2
server {
    listen {{ nginx_port }};
    server_name localhost;
    location / {
        root /var/www/html;
        index index.html index.htm;
    }
}
</code></pre>
</li>
<li>
<p><strong>Use the Role in a Playbook</strong></p>
<p>Create a playbook that uses the role.</p>
<pre><code class="language-yaml">---
# playbook.yml
- hosts: webservers
  roles:
    - my_nginx_role
</code></pre>
</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><ol>
<li>
<p><strong>Create the Role</strong></p>
<pre><code class="language-bash">$ ansible-galaxy init my_nginx_role
</code></pre>
</li>
<li>
<p><strong>Define Tasks</strong></p>
<pre><code class="language-yaml">---
# tasks/main.yml
- name: Install Nginx
  apt:
    name: nginx
    state: present
    update_cache: yes

- name: Start Nginx
  service:
    name: nginx
    state: started
    enabled: yes
</code></pre>
</li>
<li>
<p><strong>Define Handlers</strong></p>
<pre><code class="language-yaml">---
# handlers/main.yml
- name: Restart Nginx
  service:
    name: nginx
    state: restarted
</code></pre>
</li>
<li>
<p><strong>Define Default Variables</strong></p>
<pre><code class="language-yaml">---
# defaults/main.yml
nginx_port: 80
</code></pre>
</li>
<li>
<p><strong>Define Templates</strong></p>
<pre><code class="language-jinja2"># templates/nginx.conf.j2
server {
    listen {{ nginx_port }};
    server_name localhost;
    location / {
        root /var/www/html;
        index index.html index.htm;
    }
}
</code></pre>
</li>
<li>
<p><strong>Use the Role in a Playbook</strong></p>
<pre><code class="language-yaml">---
# playbook.yml
- hosts: webservers
  roles:
    - my_nginx_role
</code></pre>
</li>
</ol>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we have learned about the concept of roles in Ansible and how they help in organizing and reusing code. We also created a simple role to install and configure the Apache web server. By using roles, you can make your Ansible playbooks more modular, reusable, and easier to manage. In the next section, we will dive deeper into creating roles and explore more advanced features.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-05-conditionals-and-loops' title="Conditionals and Loops">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-02-creating-roles' title="Creating Roles">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
	     crossorigin="anonymous"></script>
	<!-- enterprise_campus -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-0611338592562725"
	     data-ad-slot="6914733106"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
	     (adsbygoogle = window.adsbygoogle || []).push({});
	</script>
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>Ansible: From Beginner to Advanced</h1>
<h2>Module 1: Introduction to Ansible</h2>
<ul>
<li><a href="01-01-what-is-ansible">What is Ansible?</a></li>
<li><a href="01-02-installing-ansible">Installing Ansible</a></li>
<li><a href="01-03-ansible-architecture">Ansible Architecture</a></li>
<li><a href="01-04-basic-ansible-commands">Basic Ansible Commands</a></li>
</ul>
<h2>Module 2: Ansible Basics</h2>
<ul>
<li><a href="02-01-inventory-files">Inventory Files</a></li>
<li><a href="02-02-ansible-configuration">Ansible Configuration</a></li>
<li><a href="02-03-ad-hoc-commands">Ad-Hoc Commands</a></li>
<li><a href="02-04-ansible-modules">Ansible Modules</a></li>
</ul>
<h2>Module 3: Playbooks</h2>
<ul>
<li><a href="03-01-introduction-to-playbooks">Introduction to Playbooks</a></li>
<li><a href="03-02-writing-your-first-playbook">Writing Your First Playbook</a></li>
<li><a href="03-03-playbook-structure">Playbook Structure</a></li>
<li><a href="03-04-variables-and-facts">Variables and Facts</a></li>
<li><a href="03-05-conditionals-and-loops">Conditionals and Loops</a></li>
</ul>
<h2>Module 4: Roles</h2>
<ul>
<li><a href="04-01-introduction-to-roles">Introduction to Roles</a></li>
<li><a href="04-02-creating-roles">Creating Roles</a></li>
<li><a href="04-03-role-directory-structure">Role Directory Structure</a></li>
<li><a href="04-04-using-roles-in-playbooks">Using Roles in Playbooks</a></li>
</ul>
<h2>Module 5: Advanced Playbook Techniques</h2>
<ul>
<li><a href="05-01-handlers">Handlers</a></li>
<li><a href="05-02-templates">Templates</a></li>
<li><a href="05-03-ansible-vault">Ansible Vault</a></li>
<li><a href="05-04-error-handling">Error Handling</a></li>
<li><a href="05-05-optimizing-playbooks">Optimizing Playbooks</a></li>
</ul>
<h2>Module 6: Ansible Galaxy</h2>
<ul>
<li><a href="06-01-what-is-ansible-galaxy">What is Ansible Galaxy?</a></li>
<li><a href="06-02-using-ansible-galaxy">Using Ansible Galaxy</a></li>
<li><a href="06-03-creating-and-sharing-roles">Creating and Sharing Roles</a></li>
</ul>
<h2>Module 7: Ansible Tower</h2>
<ul>
<li><a href="07-01-introduction-to-ansible-tower">Introduction to Ansible Tower</a></li>
<li><a href="07-02-installing-ansible-tower">Installing Ansible Tower</a></li>
<li><a href="07-03-using-ansible-tower">Using Ansible Tower</a></li>
<li><a href="07-04-managing-projects-and-inventories">Managing Projects and Inventories</a></li>
</ul>
<h2>Module 8: Ansible for DevOps</h2>
<ul>
<li><a href="08-01-ansible-and-docker">Ansible and Docker</a></li>
<li><a href="08-02-ansible-and-kubernetes">Ansible and Kubernetes</a></li>
<li><a href="08-03-ci-cd-with-ansible">CI/CD with Ansible</a></li>
<li><a href="08-04-ansible-in-cloud-environments">Ansible in Cloud Environments</a></li>
</ul>
<h2>Module 9: Ansible Best Practices</h2>
<ul>
<li><a href="09-01-code-organization">Code Organization</a></li>
<li><a href="09-02-security-best-practices">Security Best Practices</a></li>
<li><a href="09-03-performance-tuning">Performance Tuning</a></li>
<li><a href="09-04-testing-ansible-code">Testing Ansible Code</a></li>
</ul>
<h2>Module 10: Advanced Ansible Topics</h2>
<ul>
<li><a href="10-01-custom-modules">Custom Modules</a></li>
<li><a href="10-02-dynamic-inventory">Dynamic Inventory</a></li>
<li><a href="10-03-ansible-plugins">Ansible Plugins</a></li>
<li><a href="10-04-ansible-api">Ansible API</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
</body>
</html>
