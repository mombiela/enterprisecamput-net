<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Templates</title>

    <link rel="alternate" href="https://campusempresa.com/mod/ansible/05-02-templates" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/ansible/05-02-templates" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/ansible/05-02-templates" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/ansible/05-02-templates" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/ansible/05-02-templates" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-01-handlers' title="Handlers">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Templates</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-03-ansible-vault' title="Ansible Vault">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Templates in Ansible are a powerful feature that allows you to dynamically generate configuration files and other text files based on variables and logic defined in your playbooks. Templates are written in the Jinja2 templating language, which is a flexible and expressive language for creating dynamic content.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Jinja2 Templating Language</strong>: The language used to write templates in Ansible.</li>
<li><strong>Template Module</strong>: The Ansible module used to apply templates.</li>
<li><strong>Variables</strong>: Dynamic values that can be inserted into templates.</li>
<li><strong>Control Structures</strong>: Logic such as loops and conditionals that can be used within templates.</li>
</ol>
</div><h1>Using the Template Module</h1>
<div class='content'><p>The <code>template</code> module is used to process a Jinja2 template and copy the rendered file to a remote host.</p>
</div><h2>Basic Syntax</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBBcHBseSBhIHRlbXBsYXRlCiAgdGVtcGxhdGU6CiAgICBzcmM6IC9wYXRoL3RvL3RlbXBsYXRlLmoyCiAgICBkZXN0OiAvcGF0aC90by9kZXN0aW5hdGlvbi9maWxl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Apply a template
  template:
    src: /path/to/template.j2
    dest: /path/to/destination/file</pre></div><div class='content'></div><h2>Example</h2>
<div class='content'><p>Let's create a simple template and use it in a playbook.</p>
<h4>Step 1: Create a Template File</h4>
<p>Create a file named <code>nginx.conf.j2</code> with the following content:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VydmVyIHsKICAgIGxpc3RlbiA4MDsKICAgIHNlcnZlcl9uYW1lIHt7IHNlcnZlcl9uYW1lIH19OwogICAgcm9vdCB7eyBkb2N1bWVudF9yb290IH19OwogICAgCiAgICBsb2NhdGlvbiAvIHsKICAgICAgICB0cnlfZmlsZXMgJHVyaSAkdXJpLyA9NDA0OwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>server {
    listen 80;
    server_name {{ server_name }};
    root {{ document_root }};
    
    location / {
        try_files $uri $uri/ =404;
    }
}</pre></div><div class='content'><h4>Step 2: Create a Playbook</h4>
<p>Create a playbook named <code>deploy_nginx.yml</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogRGVwbG95IE5naW54IGNvbmZpZ3VyYXRpb24KICBob3N0czogd2Vic2VydmVycwogIHZhcnM6CiAgICBzZXJ2ZXJfbmFtZTogZXhhbXBsZS5jb20KICAgIGRvY3VtZW50X3Jvb3Q6IC92YXIvd3d3L2h0bWwKICB0YXNrczoKICAgIC0gbmFtZTogQXBwbHkgTmdpbnggY29uZmlndXJhdGlvbiB0ZW1wbGF0ZQogICAgICB0ZW1wbGF0ZToKICAgICAgICBzcmM6IG5naW54LmNvbmYuajIKICAgICAgICBkZXN0OiAvZXRjL25naW54L25naW54LmNvbmYKICAgICAgbm90aWZ5OgogICAgICAgIC0gUmVzdGFydCBOZ2lueAoKICBoYW5kbGVyczoKICAgIC0gbmFtZTogUmVzdGFydCBOZ2lueAogICAgICBzZXJ2aWNlOgogICAgICAgIG5hbWU6IG5naW54CiAgICAgICAgc3RhdGU6IHJlc3RhcnRlZA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Deploy Nginx configuration
  hosts: webservers
  vars:
    server_name: example.com
    document_root: /var/www/html
  tasks:
    - name: Apply Nginx configuration template
      template:
        src: nginx.conf.j2
        dest: /etc/nginx/nginx.conf
      notify:
        - Restart Nginx

  handlers:
    - name: Restart Nginx
      service:
        name: nginx
        state: restarted</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Template File (<code>nginx.conf.j2</code>)</strong>: This file contains placeholders (<code>{{ server_name }}</code> and <code>{{ document_root }}</code>) that will be replaced with actual values when the template is rendered.</li>
<li><strong>Playbook (<code>deploy_nginx.yml</code>)</strong>:
<ul>
<li><strong>vars</strong>: Defines the variables <code>server_name</code> and <code>document_root</code>.</li>
<li><strong>tasks</strong>: Uses the <code>template</code> module to apply the <code>nginx.conf.j2</code> template and copy the rendered file to <code>/etc/nginx/nginx.conf</code>.</li>
<li><strong>handlers</strong>: Defines a handler to restart Nginx whenever the configuration file is changed.</li>
</ul>
</li>
</ul>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise</h2>
<div class='content'><ol>
<li>
<p>Create a Jinja2 template file named <code>index.html.j2</code> with the following content:</p>
<pre><code class="language-jinja2">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;{{ title }}&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;{{ heading }}&lt;/h1&gt;
    &lt;p&gt;{{ message }}&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
</li>
<li>
<p>Create a playbook named <code>deploy_website.yml</code> that uses the <code>template</code> module to apply the <code>index.html.j2</code> template and copy the rendered file to <code>/var/www/html/index.html</code>. Define the following variables in the playbook:</p>
<ul>
<li><code>title</code>: &quot;Welcome to My Website&quot;</li>
<li><code>heading</code>: &quot;Hello, World!&quot;</li>
<li><code>message</code>: &quot;This is a dynamically generated web page.&quot;</li>
</ul>
</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><h4>Step 1: Create the Template File</h4>
<p>Create a file named <code>index.html.j2</code> with the following content:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDx0aXRsZT57eyB0aXRsZSB9fTwvdGl0bGU+CjwvaGVhZD4KPGJvZHk+CiAgICA8aDE+e3sgaGVhZGluZyB9fTwvaDE+CiAgICA8cD57eyBtZXNzYWdlIH19PC9wPgo8L2JvZHk+CjwvaHRtbD4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;{{ title }}&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;{{ heading }}&lt;/h1&gt;
    &lt;p&gt;{{ message }}&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><div class='content'><h4>Step 2: Create the Playbook</h4>
<p>Create a playbook named <code>deploy_website.yml</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogRGVwbG95IHdlYnNpdGUKICBob3N0czogd2Vic2VydmVycwogIHZhcnM6CiAgICB0aXRsZTogIldlbGNvbWUgdG8gTXkgV2Vic2l0ZSIKICAgIGhlYWRpbmc6ICJIZWxsbywgV29ybGQhIgogICAgbWVzc2FnZTogIlRoaXMgaXMgYSBkeW5hbWljYWxseSBnZW5lcmF0ZWQgd2ViIHBhZ2UuIgogIHRhc2tzOgogICAgLSBuYW1lOiBBcHBseSB3ZWJzaXRlIHRlbXBsYXRlCiAgICAgIHRlbXBsYXRlOgogICAgICAgIHNyYzogaW5kZXguaHRtbC5qMgogICAgICAgIGRlc3Q6IC92YXIvd3d3L2h0bWwvaW5kZXguaHRtbA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Deploy website
  hosts: webservers
  vars:
    title: &quot;Welcome to My Website&quot;
    heading: &quot;Hello, World!&quot;
    message: &quot;This is a dynamically generated web page.&quot;
  tasks:
    - name: Apply website template
      template:
        src: index.html.j2
        dest: /var/www/html/index.html</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Template File (<code>index.html.j2</code>)</strong>: Contains placeholders (<code>{{ title }}</code>, <code>{{ heading }}</code>, and <code>{{ message }}</code>) that will be replaced with actual values when the template is rendered.</li>
<li><strong>Playbook (<code>deploy_website.yml</code>)</strong>:
<ul>
<li><strong>vars</strong>: Defines the variables <code>title</code>, <code>heading</code>, and <code>message</code>.</li>
<li><strong>tasks</strong>: Uses the <code>template</code> module to apply the <code>index.html.j2</code> template and copy the rendered file to <code>/var/www/html/index.html</code>.</li>
</ul>
</li>
</ul>
</div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Undefined Variables</strong>: Ensure all variables used in the template are defined in the playbook.</li>
<li><strong>File Permissions</strong>: Verify that the destination directory has the correct permissions to allow the template to be copied.</li>
<li><strong>Syntax Errors</strong>: Check for syntax errors in the Jinja2 template, such as missing braces or incorrect variable names.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Templates in Ansible provide a flexible way to generate dynamic configuration files and other text files. By using the Jinja2 templating language, you can create templates that incorporate variables and logic, making your playbooks more powerful and adaptable. In the next section, we will explore Ansible Vault, which allows you to securely store sensitive data such as passwords and keys.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-01-handlers' title="Handlers">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-03-ansible-vault' title="Ansible Vault">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
