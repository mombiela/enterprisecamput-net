<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ansible API</title>

    <link rel="alternate" href="https://campusempresa.com/mod/ansible/10-04-ansible-api" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/ansible/10-04-ansible-api" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/ansible/10-04-ansible-api" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/ansible/10-04-ansible-api" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/ansible/10-04-ansible-api" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='10-03-ansible-plugins' title="Ansible Plugins">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Ansible API</h2></a>
			</div>
	<div class='col-2 text-end'>
			</div>
</div>
<div class='content'><p>The Ansible API allows you to interact programmatically with Ansible, enabling automation and integration with other systems. This module will cover the basics of using the Ansible API, including how to set it up, make requests, and handle responses.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>RESTful API</strong>: Ansible Tower provides a RESTful API that allows you to interact with Ansible programmatically.</li>
<li><strong>Authentication</strong>: Secure access to the API using tokens or basic authentication.</li>
<li><strong>Endpoints</strong>: Specific URLs that represent different resources in Ansible Tower.</li>
<li><strong>HTTP Methods</strong>: Common methods include GET, POST, PUT, and DELETE to interact with the API.</li>
</ol>
</div><h1>Setting Up the Ansible API</h1>
<div class='content'></div><h2>Prerequisites</h2>
<div class='content'><ul>
<li>Ansible Tower installed and running.</li>
<li>API access enabled in Ansible Tower.</li>
<li>An API token or user credentials for authentication.</li>
</ul>
</div><h2>Generating an API Token</h2>
<div class='content'><ol>
<li>Log in to Ansible Tower.</li>
<li>Navigate to <strong>User Settings</strong>.</li>
<li>Generate a new API token.</li>
</ol>
</div><h2>Example: Generating an API Token</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y3VybCAtdSA8dXNlcm5hbWU+OjxwYXNzd29yZD4gLVggUE9TVCBodHRwczovLzxhbnNpYmxlLXRvd2VyLXVybD4vYXBpL3YyL3Rva2Vucy8="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>curl -u &lt;username&gt;:&lt;password&gt; -X POST https://&lt;ansible-tower-url&gt;/api/v2/tokens/</pre></div><div class='content'><p>Replace <code>&lt;username&gt;</code>, <code>&lt;password&gt;</code>, and <code>&lt;ansible-tower-url&gt;</code> with your actual credentials and URL.</p>
</div><h1>Making API Requests</h1>
<div class='content'></div><h2>Basic Structure</h2>
<div class='content'><ul>
<li><strong>Base URL</strong>: <code>https://&lt;ansible-tower-url&gt;/api/v2/</code></li>
<li><strong>Headers</strong>: Include the <code>Authorization</code> header with your token.</li>
<li><strong>Endpoints</strong>: Specific paths to resources, e.g., <code>/projects/</code>, <code>/inventories/</code>.</li>
</ul>
</div><h2>Example: Fetching Projects</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y3VybCAtSCAiQXV0aG9yaXphdGlvbjogQmVhcmVyIDx5b3VyLWFwaS10b2tlbj4iIGh0dHBzOi8vPGFuc2libGUtdG93ZXItdXJsPi9hcGkvdjIvcHJvamVjdHMv"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>curl -H &quot;Authorization: Bearer &lt;your-api-token&gt;&quot; https://&lt;ansible-tower-url&gt;/api/v2/projects/</pre></div><div class='content'></div><h2>Example: Creating a New Project</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y3VybCAtSCAiQXV0aG9yaXphdGlvbjogQmVhcmVyIDx5b3VyLWFwaS10b2tlbj4iIFwKICAgICAtSCAiQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uIiBcCiAgICAgLVggUE9TVCBcCiAgICAgLWQgJ3sKICAgICAgICAgICAibmFtZSI6ICJOZXcgUHJvamVjdCIsCiAgICAgICAgICAgImRlc2NyaXB0aW9uIjogIkEgbmV3IHByb2plY3QgY3JlYXRlZCB2aWEgQVBJIiwKICAgICAgICAgICAic2NtX3R5cGUiOiAiZ2l0IiwKICAgICAgICAgICAic2NtX3VybCI6ICJodHRwczovL2dpdGh1Yi5jb20veW91ci1yZXBvLmdpdCIKICAgICAgICAgfScgXAogICAgIGh0dHBzOi8vPGFuc2libGUtdG93ZXItdXJsPi9hcGkvdjIvcHJvamVjdHMv"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>curl -H &quot;Authorization: Bearer &lt;your-api-token&gt;&quot; \
     -H &quot;Content-Type: application/json&quot; \
     -X POST \
     -d '{
           &quot;name&quot;: &quot;New Project&quot;,
           &quot;description&quot;: &quot;A new project created via API&quot;,
           &quot;scm_type&quot;: &quot;git&quot;,
           &quot;scm_url&quot;: &quot;https://github.com/your-repo.git&quot;
         }' \
     https://&lt;ansible-tower-url&gt;/api/v2/projects/</pre></div><div class='content'></div><h1>Handling Responses</h1>
<div class='content'></div><h2>Response Structure</h2>
<div class='content'><ul>
<li><strong>Status Code</strong>: Indicates the result of the request (e.g., 200 for success, 404 for not found).</li>
<li><strong>Body</strong>: JSON-formatted data representing the resource.</li>
</ul>
</div><h2>Example: Parsing a Response</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHJlcXVlc3RzCgp1cmwgPSAiaHR0cHM6Ly88YW5zaWJsZS10b3dlci11cmw+L2FwaS92Mi9wcm9qZWN0cy8iCmhlYWRlcnMgPSB7CiAgICAiQXV0aG9yaXphdGlvbiI6ICJCZWFyZXIgPHlvdXItYXBpLXRva2VuPiIKfQoKcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcnMpCgppZiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDA6CiAgICBwcm9qZWN0cyA9IHJlc3BvbnNlLmpzb24oKQogICAgZm9yIHByb2plY3QgaW4gcHJvamVjdHNbJ3Jlc3VsdHMnXToKICAgICAgICBwcmludChmIlByb2plY3QgTmFtZToge3Byb2plY3RbJ25hbWUnXX0iKQplbHNlOgogICAgcHJpbnQoZiJGYWlsZWQgdG8gZmV0Y2ggcHJvamVjdHM6IHtyZXNwb25zZS5zdGF0dXNfY29kZX0iKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import requests

url = &quot;https://&lt;ansible-tower-url&gt;/api/v2/projects/&quot;
headers = {
    &quot;Authorization&quot;: &quot;Bearer &lt;your-api-token&gt;&quot;
}

response = requests.get(url, headers=headers)

if response.status_code == 200:
    projects = response.json()
    for project in projects['results']:
        print(f&quot;Project Name: {project['name']}&quot;)
else:
    print(f&quot;Failed to fetch projects: {response.status_code}&quot;)</pre></div><div class='content'></div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: List All Job Templates</h2>
<div class='content'><ol>
<li>Use the API to list all job templates in your Ansible Tower.</li>
<li>Print the name and ID of each job template.</li>
</ol>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHJlcXVlc3RzCgp1cmwgPSAiaHR0cHM6Ly88YW5zaWJsZS10b3dlci11cmw+L2FwaS92Mi9qb2JfdGVtcGxhdGVzLyIKaGVhZGVycyA9IHsKICAgICJBdXRob3JpemF0aW9uIjogIkJlYXJlciA8eW91ci1hcGktdG9rZW4+Igp9CgpyZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwsIGhlYWRlcnM9aGVhZGVycykKCmlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMDoKICAgIGpvYl90ZW1wbGF0ZXMgPSByZXNwb25zZS5qc29uKCkKICAgIGZvciB0ZW1wbGF0ZSBpbiBqb2JfdGVtcGxhdGVzWydyZXN1bHRzJ106CiAgICAgICAgcHJpbnQoZiJKb2IgVGVtcGxhdGUgTmFtZToge3RlbXBsYXRlWyduYW1lJ119LCBJRDoge3RlbXBsYXRlWydpZCddfSIpCmVsc2U6CiAgICBwcmludChmIkZhaWxlZCB0byBmZXRjaCBqb2IgdGVtcGxhdGVzOiB7cmVzcG9uc2Uuc3RhdHVzX2NvZGV9Iik="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import requests

url = &quot;https://&lt;ansible-tower-url&gt;/api/v2/job_templates/&quot;
headers = {
    &quot;Authorization&quot;: &quot;Bearer &lt;your-api-token&gt;&quot;
}

response = requests.get(url, headers=headers)

if response.status_code == 200:
    job_templates = response.json()
    for template in job_templates['results']:
        print(f&quot;Job Template Name: {template['name']}, ID: {template['id']}&quot;)
else:
    print(f&quot;Failed to fetch job templates: {response.status_code}&quot;)</pre></div><div class='content'></div><h2>Exercise 2: Create a New Inventory</h2>
<div class='content'><ol>
<li>Use the API to create a new inventory in your Ansible Tower.</li>
<li>Verify the creation by listing all inventories.</li>
</ol>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHJlcXVlc3RzCgojIENyZWF0ZSBhIG5ldyBpbnZlbnRvcnkKdXJsID0gImh0dHBzOi8vPGFuc2libGUtdG93ZXItdXJsPi9hcGkvdjIvaW52ZW50b3JpZXMvIgpoZWFkZXJzID0gewogICAgIkF1dGhvcml6YXRpb24iOiAiQmVhcmVyIDx5b3VyLWFwaS10b2tlbj4iLAogICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIgp9CmRhdGEgPSB7CiAgICAibmFtZSI6ICJOZXcgSW52ZW50b3J5IiwKICAgICJkZXNjcmlwdGlvbiI6ICJBbiBpbnZlbnRvcnkgY3JlYXRlZCB2aWEgQVBJIiwKICAgICJvcmdhbml6YXRpb24iOiAxICAjIFJlcGxhY2Ugd2l0aCB5b3VyIG9yZ2FuaXphdGlvbiBJRAp9CgpyZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249ZGF0YSkKCmlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMToKICAgIHByaW50KCJJbnZlbnRvcnkgY3JlYXRlZCBzdWNjZXNzZnVsbHkuIikKZWxzZToKICAgIHByaW50KGYiRmFpbGVkIHRvIGNyZWF0ZSBpbnZlbnRvcnk6IHtyZXNwb25zZS5zdGF0dXNfY29kZX0iKQoKIyBWZXJpZnkgdGhlIGNyZWF0aW9uCnJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybCwgaGVhZGVycz1oZWFkZXJzKQoKaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgaW52ZW50b3JpZXMgPSByZXNwb25zZS5qc29uKCkKICAgIGZvciBpbnZlbnRvcnkgaW4gaW52ZW50b3JpZXNbJ3Jlc3VsdHMnXToKICAgICAgICBwcmludChmIkludmVudG9yeSBOYW1lOiB7aW52ZW50b3J5WyduYW1lJ119LCBJRDoge2ludmVudG9yeVsnaWQnXX0iKQplbHNlOgogICAgcHJpbnQoZiJGYWlsZWQgdG8gZmV0Y2ggaW52ZW50b3JpZXM6IHtyZXNwb25zZS5zdGF0dXNfY29kZX0iKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import requests

# Create a new inventory
url = &quot;https://&lt;ansible-tower-url&gt;/api/v2/inventories/&quot;
headers = {
    &quot;Authorization&quot;: &quot;Bearer &lt;your-api-token&gt;&quot;,
    &quot;Content-Type&quot;: &quot;application/json&quot;
}
data = {
    &quot;name&quot;: &quot;New Inventory&quot;,
    &quot;description&quot;: &quot;An inventory created via API&quot;,
    &quot;organization&quot;: 1  # Replace with your organization ID
}

response = requests.post(url, headers=headers, json=data)

if response.status_code == 201:
    print(&quot;Inventory created successfully.&quot;)
else:
    print(f&quot;Failed to create inventory: {response.status_code}&quot;)

# Verify the creation
response = requests.get(url, headers=headers)

if response.status_code == 200:
    inventories = response.json()
    for inventory in inventories['results']:
        print(f&quot;Inventory Name: {inventory['name']}, ID: {inventory['id']}&quot;)
else:
    print(f&quot;Failed to fetch inventories: {response.status_code}&quot;)</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Authentication Errors</strong>: Ensure your API token is valid and included in the <code>Authorization</code> header.</li>
<li><strong>Endpoint Errors</strong>: Double-check the endpoint URLs and ensure they are correct.</li>
<li><strong>Data Format</strong>: Ensure the data sent in POST/PUT requests is correctly formatted as JSON.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this module, you learned how to interact with the Ansible API, including setting up authentication, making requests, and handling responses. You also practiced creating and listing resources using the API. This knowledge allows you to integrate Ansible with other systems and automate tasks programmatically.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='10-03-ansible-plugins' title="Ansible Plugins">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
