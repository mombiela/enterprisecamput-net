<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Managing Windows Servers with Ansible</title>

    <link rel="alternate" href="https://campusempresa.com/mod/ansible/managing-windows-servers" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/ansible/managing-windows-servers" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/ansible/managing-windows-servers" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/ansible/managing-windows-servers" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/ansible/managing-windows-servers" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='managing-linux-servers'>&#x25C4;Managing Linux Servers</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Managing Windows Servers with Ansible</a>
	</div>
	<div class='col-4 text-end'>
					<a href='network-automation'>Network Automation &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Ansible is a powerful automation tool that can manage both Linux and Windows servers. This section will guide you through the process of managing Windows servers using Ansible, from basic setup to advanced configurations.</p>
</div><h1>Prerequisites</h1>
<div class='content'><p>Before you start managing Windows servers with Ansible, ensure you have the following:</p>
<ul>
<li>A control machine with Ansible installed (Linux or macOS).</li>
<li>Windows servers with WinRM enabled.</li>
<li>Basic understanding of Ansible and YAML.</li>
</ul>
</div><h1>Setting Up the Environment</h1>
<div class='content'></div><h2>Installing Required Packages</h2>
<div class='content'><p>To manage Windows servers, you need to install the <code>pywinrm</code> package on your control machine.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgInB5d2lucm0+PTAuMy4wIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install &quot;pywinrm&gt;=0.3.0&quot;</pre></div><div class='content'></div><h2>Configuring WinRM on Windows Servers</h2>
<div class='content'><p>WinRM (Windows Remote Management) must be configured on your Windows servers. You can use the following PowerShell script to enable and configure WinRM:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFbmFibGUgV2luUk0Kd2lucm0gcXVpY2tjb25maWcgLWZvcmNlCgojIFNldCBXaW5STSBzZXJ2aWNlIHRvIGF1dG8tc3RhcnQKU2V0LVNlcnZpY2UgLU5hbWUgV2luUk0gLVN0YXJ0dXBUeXBlIEF1dG9tYXRpYwoKIyBBbGxvdyB1bmVuY3J5cHRlZCB0cmFmZmljIChvcHRpb25hbCwgZm9yIHRlc3RpbmcgcHVycG9zZXMpCndpbnJtIHNldCB3aW5ybS9jb25maWcvc2VydmljZSAnQHtBbGxvd1VuZW5jcnlwdGVkPSJ0cnVlIn0nCgojIEFsbG93IGJhc2ljIGF1dGhlbnRpY2F0aW9uIChvcHRpb25hbCwgZm9yIHRlc3RpbmcgcHVycG9zZXMpCndpbnJtIHNldCB3aW5ybS9jb25maWcvc2VydmljZS9hdXRoICdAe0Jhc2ljPSJ0cnVlIn0nCgojIENyZWF0ZSBhIFdpblJNIGxpc3RlbmVyCndpbnJtIGNyZWF0ZSB3aW5ybS9jb25maWcvTGlzdGVuZXI/QWRkcmVzcz0qK1RyYW5zcG9ydD1IVFRQCgojIFZlcmlmeSB0aGUgY29uZmlndXJhdGlvbgp3aW5ybSBnZXQgd2lucm0vY29uZmln"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Enable WinRM
winrm quickconfig -force

# Set WinRM service to auto-start
Set-Service -Name WinRM -StartupType Automatic

# Allow unencrypted traffic (optional, for testing purposes)
winrm set winrm/config/service '@{AllowUnencrypted=&quot;true&quot;}'

# Allow basic authentication (optional, for testing purposes)
winrm set winrm/config/service/auth '@{Basic=&quot;true&quot;}'

# Create a WinRM listener
winrm create winrm/config/Listener?Address=*+Transport=HTTP

# Verify the configuration
winrm get winrm/config</pre></div><div class='content'></div><h1>Inventory Configuration</h1>
<div class='content'></div><h2>Defining Windows Hosts</h2>
<div class='content'><p>In your Ansible inventory file, define your Windows hosts and specify the connection details.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("W3dpbmRvd3NdCndpbmRvd3Nfc2VydmVyIGFuc2libGVfaG9zdD0xOTIuMTY4LjEuMTAKClt3aW5kb3dzOnZhcnNdCmFuc2libGVfdXNlcj1BZG1pbmlzdHJhdG9yCmFuc2libGVfcGFzc3dvcmQ9WW91clBhc3N3b3JkCmFuc2libGVfY29ubmVjdGlvbj13aW5ybQphbnNpYmxlX3dpbnJtX3RyYW5zcG9ydD1iYXNpYwphbnNpYmxlX3BvcnQ9NTk4NQphbnNpYmxlX3dpbnJtX3NlcnZlcl9jZXJ0X3ZhbGlkYXRpb249aWdub3Jl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>[windows]
windows_server ansible_host=192.168.1.10

[windows:vars]
ansible_user=Administrator
ansible_password=YourPassword
ansible_connection=winrm
ansible_winrm_transport=basic
ansible_port=5985
ansible_winrm_server_cert_validation=ignore</pre></div><div class='content'></div><h1>Basic Playbook for Windows</h1>
<div class='content'></div><h2>Creating a Simple Playbook</h2>
<div class='content'><p>Create a simple Ansible playbook to test the connection to your Windows server.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogVGVzdCBjb25uZWN0aW9uIHRvIFdpbmRvd3Mgc2VydmVyCiAgaG9zdHM6IHdpbmRvd3MKICB0YXNrczoKICAgIC0gbmFtZTogUGluZyB0aGUgV2luZG93cyBzZXJ2ZXIKICAgICAgd2luX3Bpbmc6"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Test connection to Windows server
  hosts: windows
  tasks:
    - name: Ping the Windows server
      win_ping:</pre></div><div class='content'><p>Run the playbook with the following command:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS1wbGF5Ym9vayB0ZXN0X2Nvbm5lY3Rpb24ueW1s"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-playbook test_connection.yml</pre></div><div class='content'></div><h1>Managing Windows Features</h1>
<div class='content'></div><h2>Installing Windows Features</h2>
<div class='content'><p>You can use the <code>win_feature</code> module to install Windows features.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogSW5zdGFsbCBJSVMgb24gV2luZG93cyBzZXJ2ZXIKICBob3N0czogd2luZG93cwogIHRhc2tzOgogICAgLSBuYW1lOiBJbnN0YWxsIElJUwogICAgICB3aW5fZmVhdHVyZToKICAgICAgICBuYW1lOiBXZWItU2VydmVyCiAgICAgICAgc3RhdGU6IHByZXNlbnQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Install IIS on Windows server
  hosts: windows
  tasks:
    - name: Install IIS
      win_feature:
        name: Web-Server
        state: present</pre></div><div class='content'></div><h2>Removing Windows Features</h2>
<div class='content'><p>Similarly, you can remove Windows features using the <code>win_feature</code> module.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogUmVtb3ZlIElJUyBmcm9tIFdpbmRvd3Mgc2VydmVyCiAgaG9zdHM6IHdpbmRvd3MKICB0YXNrczoKICAgIC0gbmFtZTogUmVtb3ZlIElJUwogICAgICB3aW5fZmVhdHVyZToKICAgICAgICBuYW1lOiBXZWItU2VydmVyCiAgICAgICAgc3RhdGU6IGFic2VudA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Remove IIS from Windows server
  hosts: windows
  tasks:
    - name: Remove IIS
      win_feature:
        name: Web-Server
        state: absent</pre></div><div class='content'></div><h1>Managing Files and Directories</h1>
<div class='content'></div><h2>Copying Files</h2>
<div class='content'><p>Use the <code>win_copy</code> module to copy files to the Windows server.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogQ29weSBmaWxlIHRvIFdpbmRvd3Mgc2VydmVyCiAgaG9zdHM6IHdpbmRvd3MKICB0YXNrczoKICAgIC0gbmFtZTogQ29weSBhIGZpbGUKICAgICAgd2luX2NvcHk6CiAgICAgICAgc3JjOiAvcGF0aC90by9sb2NhbC9maWxlLnR4dAogICAgICAgIGRlc3Q6IEM6XHBhdGhcdG9ccmVtb3RlXGZpbGUudHh0"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Copy file to Windows server
  hosts: windows
  tasks:
    - name: Copy a file
      win_copy:
        src: /path/to/local/file.txt
        dest: C:\path\to\remote\file.txt</pre></div><div class='content'></div><h2>Managing Directories</h2>
<div class='content'><p>Use the <code>win_file</code> module to create or delete directories.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogTWFuYWdlIGRpcmVjdG9yaWVzIG9uIFdpbmRvd3Mgc2VydmVyCiAgaG9zdHM6IHdpbmRvd3MKICB0YXNrczoKICAgIC0gbmFtZTogQ3JlYXRlIGEgZGlyZWN0b3J5CiAgICAgIHdpbl9maWxlOgogICAgICAgIHBhdGg6IEM6XHBhdGhcdG9cZGlyZWN0b3J5CiAgICAgICAgc3RhdGU6IGRpcmVjdG9yeQoKICAgIC0gbmFtZTogRGVsZXRlIGEgZGlyZWN0b3J5CiAgICAgIHdpbl9maWxlOgogICAgICAgIHBhdGg6IEM6XHBhdGhcdG9cZGlyZWN0b3J5CiAgICAgICAgc3RhdGU6IGFic2VudA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Manage directories on Windows server
  hosts: windows
  tasks:
    - name: Create a directory
      win_file:
        path: C:\path\to\directory
        state: directory

    - name: Delete a directory
      win_file:
        path: C:\path\to\directory
        state: absent</pre></div><div class='content'></div><h1>Advanced Configurations</h1>
<div class='content'></div><h2>Managing Windows Services</h2>
<div class='content'><p>Use the <code>win_service</code> module to manage Windows services.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogTWFuYWdlIFdpbmRvd3Mgc2VydmljZXMKICBob3N0czogd2luZG93cwogIHRhc2tzOgogICAgLSBuYW1lOiBFbnN1cmUgdGhlIHNlcnZpY2UgaXMgcnVubmluZwogICAgICB3aW5fc2VydmljZToKICAgICAgICBuYW1lOiB3dWF1c2VydgogICAgICAgIHN0YXJ0X21vZGU6IGF1dG8KICAgICAgICBzdGF0ZTogc3RhcnRlZAoKICAgIC0gbmFtZTogU3RvcCBhIHNlcnZpY2UKICAgICAgd2luX3NlcnZpY2U6CiAgICAgICAgbmFtZTogd3VhdXNlcnYKICAgICAgICBzdGF0ZTogc3RvcHBlZA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Manage Windows services
  hosts: windows
  tasks:
    - name: Ensure the service is running
      win_service:
        name: wuauserv
        start_mode: auto
        state: started

    - name: Stop a service
      win_service:
        name: wuauserv
        state: stopped</pre></div><div class='content'></div><h2>Executing PowerShell Scripts</h2>
<div class='content'><p>Use the <code>win_shell</code> or <code>win_command</code> module to execute PowerShell scripts.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogRXhlY3V0ZSBQb3dlclNoZWxsIHNjcmlwdCBvbiBXaW5kb3dzIHNlcnZlcgogIGhvc3RzOiB3aW5kb3dzCiAgdGFza3M6CiAgICAtIG5hbWU6IFJ1biBQb3dlclNoZWxsIHNjcmlwdAogICAgICB3aW5fc2hlbGw6IHwKICAgICAgICBHZXQtUHJvY2VzcyB8IFdoZXJlLU9iamVjdCB7ICRfLkNQVSAtZ3QgMTAwIH0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Execute PowerShell script on Windows server
  hosts: windows
  tasks:
    - name: Run PowerShell script
      win_shell: |
        Get-Process | Where-Object { $_.CPU -gt 100 }</pre></div><div class='content'></div><h1>Summary</h1>
<div class='content'><p>Managing Windows servers with Ansible involves setting up WinRM, configuring the inventory, and using various Ansible modules to perform tasks. By following this guide, you can automate the management of Windows servers, from basic tasks like copying files to advanced configurations like managing services and executing PowerShell scripts. With practice, you'll be able to leverage Ansible's full potential to streamline your Windows server management.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='managing-linux-servers'>&#x25C4;Managing Linux Servers</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Managing Windows Servers with Ansible</a>
	</div>
	<div class='col-4 text-end'>
					<a href='network-automation'>Network Automation &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
