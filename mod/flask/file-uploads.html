<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Uploads in Flask</title>

    <link rel="alternate" href="https://campusempresa.com/mod/flask/file-uploads" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/flask/file-uploads" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/flask/file-uploads" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/flask/file-uploads" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/flask/file-uploads" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='form-validation-wtforms'>&#x25C4;Form Validation with WTForms</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">File Uploads in Flask</a>
	</div>
	<div class='col-4 text-end'>
					<a href='handling-user-input-securely'>Handling User Input Securely &#x25BA;</a>
			</div>
</div>
<div class='content'><p>File uploads are a common feature in web applications, allowing users to upload files such as images, documents, and other media. Flask provides a straightforward way to handle file uploads. This topic will guide you from the basics to more advanced file upload handling in Flask.</p>
</div><h1>Introduction to File Uploads</h1>
<div class='content'><ul>
<li><strong>What are file uploads?</strong>
<ul>
<li>File uploads allow users to send files from their local machine to a server.</li>
</ul>
</li>
<li><strong>Why are file uploads important?</strong>
<ul>
<li>They enable functionalities such as profile picture updates, document submissions, and media sharing.</li>
</ul>
</li>
</ul>
</div><h1>Setting Up Your Flask Application</h1>
<div class='content'><p>Before handling file uploads, ensure you have Flask installed and set up. If not, you can install Flask using pip:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgRmxhc2s="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install Flask</pre></div><div class='content'><p>Create a basic Flask application:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlbmRlcl90ZW1wbGF0ZSwgcmVxdWVzdAoKYXBwID0gRmxhc2soX19uYW1lX18pCgpAYXBwLnJvdXRlKCcvJykKZGVmIGluZGV4KCk6CiAgICByZXR1cm4gcmVuZGVyX3RlbXBsYXRlKCdpbmRleC5odG1sJykKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBhcHAucnVuKGRlYnVnPVRydWUp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, render_template, request

app = Flask(__name__)

@app.route('/')
def index():
    return render_template('index.html')

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'></div><h1>Handling Basic File Uploads</h1>
<div class='content'></div><h2>Configuring the Application</h2>
<div class='content'><p>To handle file uploads, you need to configure your Flask application to specify the upload folder and allowed file extensions.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9zCgphcHAuY29uZmlnWydVUExPQURfRk9MREVSJ10gPSAndXBsb2Fkcy8nCmFwcC5jb25maWdbJ0FMTE9XRURfRVhURU5TSU9OUyddID0geydwbmcnLCAnanBnJywgJ2pwZWcnLCAnZ2lmJ30KCmRlZiBhbGxvd2VkX2ZpbGUoZmlsZW5hbWUpOgogICAgcmV0dXJuICcuJyBpbiBmaWxlbmFtZSBhbmQgZmlsZW5hbWUucnNwbGl0KCcuJywgMSlbMV0ubG93ZXIoKSBpbiBhcHAuY29uZmlnWydBTExPV0VEX0VYVEVOU0lPTlMnXQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import os

app.config['UPLOAD_FOLDER'] = 'uploads/'
app.config['ALLOWED_EXTENSIONS'] = {'png', 'jpg', 'jpeg', 'gif'}

def allowed_file(filename):
    return '.' in filename and filename.rsplit('.', 1)[1].lower() in app.config['ALLOWED_EXTENSIONS']</pre></div><div class='content'></div><h2>Creating the Upload Form</h2>
<div class='content'><p>Create an HTML form to allow users to upload files. Save this as <code>templates/index.html</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KICA8aGVhZD4KICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04Ij4KICAgIDx0aXRsZT5GaWxlIFVwbG9hZDwvdGl0bGU+CiAgPC9oZWFkPgogIDxib2R5PgogICAgPGgxPlVwbG9hZCBhIEZpbGU8L2gxPgogICAgPGZvcm0gbWV0aG9kPSJwb3N0IiBlbmN0eXBlPSJtdWx0aXBhcnQvZm9ybS1kYXRhIiBhY3Rpb249Ii91cGxvYWQiPgogICAgICA8aW5wdXQgdHlwZT0iZmlsZSIgbmFtZT0iZmlsZSI+CiAgICAgIDxpbnB1dCB0eXBlPSJzdWJtaXQiIHZhbHVlPSJVcGxvYWQiPgogICAgPC9mb3JtPgogIDwvYm9keT4KPC9odG1sPg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;title&gt;File Upload&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Upload a File&lt;/h1&gt;
    &lt;form method=&quot;post&quot; enctype=&quot;multipart/form-data&quot; action=&quot;/upload&quot;&gt;
      &lt;input type=&quot;file&quot; name=&quot;file&quot;&gt;
      &lt;input type=&quot;submit&quot; value=&quot;Upload&quot;&gt;
    &lt;/form&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre></div><div class='content'></div><h2>Handling the File Upload</h2>
<div class='content'><p>Add a route to handle the file upload in your Flask application:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QGFwcC5yb3V0ZSgnL3VwbG9hZCcsIG1ldGhvZHM9WydQT1NUJ10pCmRlZiB1cGxvYWRfZmlsZSgpOgogICAgaWYgJ2ZpbGUnIG5vdCBpbiByZXF1ZXN0LmZpbGVzOgogICAgICAgIHJldHVybiAnTm8gZmlsZSBwYXJ0JwogICAgZmlsZSA9IHJlcXVlc3QuZmlsZXNbJ2ZpbGUnXQogICAgaWYgZmlsZS5maWxlbmFtZSA9PSAnJzoKICAgICAgICByZXR1cm4gJ05vIHNlbGVjdGVkIGZpbGUnCiAgICBpZiBmaWxlIGFuZCBhbGxvd2VkX2ZpbGUoZmlsZS5maWxlbmFtZSk6CiAgICAgICAgZmlsZW5hbWUgPSBzZWN1cmVfZmlsZW5hbWUoZmlsZS5maWxlbmFtZSkKICAgICAgICBmaWxlLnNhdmUob3MucGF0aC5qb2luKGFwcC5jb25maWdbJ1VQTE9BRF9GT0xERVInXSwgZmlsZW5hbWUpKQogICAgICAgIHJldHVybiAnRmlsZSBzdWNjZXNzZnVsbHkgdXBsb2FkZWQnCiAgICByZXR1cm4gJ0ZpbGUgdHlwZSBub3QgYWxsb3dlZCc="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@app.route('/upload', methods=['POST'])
def upload_file():
    if 'file' not in request.files:
        return 'No file part'
    file = request.files['file']
    if file.filename == '':
        return 'No selected file'
    if file and allowed_file(file.filename):
        filename = secure_filename(file.filename)
        file.save(os.path.join(app.config['UPLOAD_FOLDER'], filename))
        return 'File successfully uploaded'
    return 'File type not allowed'</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong><code>request.files</code></strong>: Accesses the uploaded file.</li>
<li><strong><code>secure_filename</code></strong>: Ensures the filename is safe to use.</li>
<li><strong><code>file.save</code></strong>: Saves the file to the specified upload folder.</li>
</ul>
</div><h1>Advanced File Upload Handling</h1>
<div class='content'></div><h2>Validating File Size</h2>
<div class='content'><p>To prevent users from uploading excessively large files, you can validate the file size:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwLmNvbmZpZ1snTUFYX0NPTlRFTlRfTEVOR1RIJ10gPSAxNiAqIDEwMjQgKiAxMDI0ICAjIDE2IE1CCgpAYXBwLmVycm9yaGFuZGxlcig0MTMpCmRlZiByZXF1ZXN0X2VudGl0eV90b29fbGFyZ2UoZXJyb3IpOgogICAgcmV0dXJuICdGaWxlIFRvbyBMYXJnZScsIDQxMw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>app.config['MAX_CONTENT_LENGTH'] = 16 * 1024 * 1024  # 16 MB

@app.errorhandler(413)
def request_entity_too_large(error):
    return 'File Too Large', 413</pre></div><div class='content'></div><h2>Storing Files in a Database</h2>
<div class='content'><p>Instead of saving files to the filesystem, you can store them in a database. Here’s an example using SQLAlchemy:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFza19zcWxhbGNoZW15IGltcG9ydCBTUUxBbGNoZW15CgphcHAuY29uZmlnWydTUUxBTENIRU1ZX0RBVEFCQVNFX1VSSSddID0gJ3NxbGl0ZTovLy9maWxlcy5kYicKZGIgPSBTUUxBbGNoZW15KGFwcCkKCmNsYXNzIEZpbGUoZGIuTW9kZWwpOgogICAgaWQgPSBkYi5Db2x1bW4oZGIuSW50ZWdlciwgcHJpbWFyeV9rZXk9VHJ1ZSkKICAgIG5hbWUgPSBkYi5Db2x1bW4oZGIuU3RyaW5nKDgwKSwgbnVsbGFibGU9RmFsc2UpCiAgICBkYXRhID0gZGIuQ29sdW1uKGRiLkxhcmdlQmluYXJ5LCBudWxsYWJsZT1GYWxzZSkKCkBhcHAucm91dGUoJy91cGxvYWQnLCBtZXRob2RzPVsnUE9TVCddKQpkZWYgdXBsb2FkX2ZpbGUoKToKICAgIGZpbGUgPSByZXF1ZXN0LmZpbGVzWydmaWxlJ10KICAgIGlmIGZpbGUgYW5kIGFsbG93ZWRfZmlsZShmaWxlLmZpbGVuYW1lKToKICAgICAgICBuZXdfZmlsZSA9IEZpbGUobmFtZT1zZWN1cmVfZmlsZW5hbWUoZmlsZS5maWxlbmFtZSksIGRhdGE9ZmlsZS5yZWFkKCkpCiAgICAgICAgZGIuc2Vzc2lvbi5hZGQobmV3X2ZpbGUpCiAgICAgICAgZGIuc2Vzc2lvbi5jb21taXQoKQogICAgICAgIHJldHVybiAnRmlsZSBzdWNjZXNzZnVsbHkgdXBsb2FkZWQnCiAgICByZXR1cm4gJ0ZpbGUgdHlwZSBub3QgYWxsb3dlZCc="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask_sqlalchemy import SQLAlchemy

app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///files.db'
db = SQLAlchemy(app)

class File(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(80), nullable=False)
    data = db.Column(db.LargeBinary, nullable=False)

@app.route('/upload', methods=['POST'])
def upload_file():
    file = request.files['file']
    if file and allowed_file(file.filename):
        new_file = File(name=secure_filename(file.filename), data=file.read())
        db.session.add(new_file)
        db.session.commit()
        return 'File successfully uploaded'
    return 'File type not allowed'</pre></div><div class='content'></div><h2>Serving Uploaded Files</h2>
<div class='content'><p>To serve uploaded files, you can create a route to send the file to the client:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgc2VuZF9mcm9tX2RpcmVjdG9yeQoKQGFwcC5yb3V0ZSgnL3VwbG9hZHMvPGZpbGVuYW1lPicpCmRlZiB1cGxvYWRlZF9maWxlKGZpbGVuYW1lKToKICAgIHJldHVybiBzZW5kX2Zyb21fZGlyZWN0b3J5KGFwcC5jb25maWdbJ1VQTE9BRF9GT0xERVInXSwgZmlsZW5hbWUp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import send_from_directory

@app.route('/uploads/&lt;filename&gt;')
def uploaded_file(filename):
    return send_from_directory(app.config['UPLOAD_FOLDER'], filename)</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Handling file uploads in Flask involves configuring your application, creating an upload form, and writing routes to handle the file upload process. Advanced techniques include validating file size and storing files in a database. With these skills, you can implement robust file upload functionality in your Flask applications.</p>
<p>By following this guide, you should now have a solid understanding of how to handle file uploads in Flask, from basic setups to more advanced implementations.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='form-validation-wtforms'>&#x25C4;Form Validation with WTForms</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">File Uploads in Flask</a>
	</div>
	<div class='col-4 text-end'>
					<a href='handling-user-input-securely'>Handling User Input Securely &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
