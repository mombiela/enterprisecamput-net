<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Defining Models</title>

    <link rel="alternate" href="https://campusempresa.com/mod/flask/04-02-defining-models" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/flask/04-02-defining-models" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/flask/04-02-defining-models" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/flask/04-02-defining-models" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/flask/04-02-defining-models" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-01-intro-flask-sqlalchemy' title="Introduction to Flask-SQLAlchemy">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Defining Models</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='04-03-crud-operations' title="Performing CRUD Operations">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into defining models using Flask-SQLAlchemy. Models are a crucial part of any web application as they represent the data structure and the relationships between different data entities. Flask-SQLAlchemy is an extension for Flask that adds support for SQLAlchemy, a powerful ORM (Object Relational Mapper) that allows you to interact with the database in an object-oriented way.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Model Definition</strong>: Creating classes that represent tables in the database.</li>
<li><strong>Fields/Columns</strong>: Defining attributes of the model that correspond to columns in the database table.</li>
<li><strong>Relationships</strong>: Establishing relationships between different models (e.g., one-to-many, many-to-many).</li>
<li><strong>CRUD Operations</strong>: Basic operations to create, read, update, and delete records.</li>
</ol>
</div><h1><p>Setting Up Flask-SQLAlchemy</p>
</h1>
<div class='content'><p>Before defining models, ensure that Flask-SQLAlchemy is installed and configured in your Flask application.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbnN0YWxsIEZsYXNrLVNRTEFsY2hlbXkKcGlwIGluc3RhbGwgZmxhc2stc3FsYWxjaGVteQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Install Flask-SQLAlchemy
pip install flask-sqlalchemy</pre></div><div class='content'></div><h2><p>Configuration</p>
</h2>
<div class='content'><p>Add the following configuration to your Flask application:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2sKZnJvbSBmbGFza19zcWxhbGNoZW15IGltcG9ydCBTUUxBbGNoZW15CgphcHAgPSBGbGFzayhfX25hbWVfXykKYXBwLmNvbmZpZ1snU1FMQUxDSEVNWV9EQVRBQkFTRV9VUkknXSA9ICdzcWxpdGU6Ly8vc2l0ZS5kYicgICMgRXhhbXBsZSB1c2luZyBTUUxpdGUKYXBwLmNvbmZpZ1snU1FMQUxDSEVNWV9UUkFDS19NT0RJRklDQVRJT05TJ10gPSBGYWxzZQpkYiA9IFNRTEFsY2hlbXkoYXBwKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask
from flask_sqlalchemy import SQLAlchemy

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///site.db'  # Example using SQLite
app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False
db = SQLAlchemy(app)</pre></div><div class='content'></div><h1><p>Defining a Model</p>
</h1>
<div class='content'><p>A model in Flask-SQLAlchemy is a Python class that inherits from <code>db.Model</code>. Each attribute of the class represents a column in the database table.</p>
</div><h2><p>Example: User Model</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKCmNsYXNzIFVzZXIoZGIuTW9kZWwpOgogICAgaWQgPSBkYi5Db2x1bW4oZGIuSW50ZWdlciwgcHJpbWFyeV9rZXk9VHJ1ZSkKICAgIHVzZXJuYW1lID0gZGIuQ29sdW1uKGRiLlN0cmluZygyMCksIHVuaXF1ZT1UcnVlLCBudWxsYWJsZT1GYWxzZSkKICAgIGVtYWlsID0gZGIuQ29sdW1uKGRiLlN0cmluZygxMjApLCB1bmlxdWU9VHJ1ZSwgbnVsbGFibGU9RmFsc2UpCiAgICBpbWFnZV9maWxlID0gZGIuQ29sdW1uKGRiLlN0cmluZygyMCksIG51bGxhYmxlPUZhbHNlLCBkZWZhdWx0PSdkZWZhdWx0LmpwZycpCiAgICBwYXNzd29yZCA9IGRiLkNvbHVtbihkYi5TdHJpbmcoNjApLCBudWxsYWJsZT1GYWxzZSkKICAgIHBvc3RzID0gZGIucmVsYXRpb25zaGlwKCdQb3N0JywgYmFja3JlZj0nYXV0aG9yJywgbGF6eT1UcnVlKQoKICAgIGRlZiBfX3JlcHJfXyhzZWxmKToKICAgICAgICByZXR1cm4gZiJVc2VyKCd7c2VsZi51c2VybmFtZX0nLCAne3NlbGYuZW1haWx9JywgJ3tzZWxmLmltYWdlX2ZpbGV9Jyki"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from datetime import datetime

class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(20), unique=True, nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)
    image_file = db.Column(db.String(20), nullable=False, default='default.jpg')
    password = db.Column(db.String(60), nullable=False)
    posts = db.relationship('Post', backref='author', lazy=True)

    def __repr__(self):
        return f&quot;User('{self.username}', '{self.email}', '{self.image_file}')&quot;</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>id</strong>: Primary key for the table.</li>
<li><strong>username</strong>: A string field with a maximum length of 20 characters, must be unique and cannot be null.</li>
<li><strong>email</strong>: A string field with a maximum length of 120 characters, must be unique and cannot be null.</li>
<li><strong>image_file</strong>: A string field with a default value, cannot be null.</li>
<li><strong>password</strong>: A string field for storing hashed passwords, cannot be null.</li>
<li><strong>posts</strong>: A relationship field that links the User model to the Post model (one-to-many relationship).</li>
</ul>
</div><h2><p>Example: Post Model</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgUG9zdChkYi5Nb2RlbCk6CiAgICBpZCA9IGRiLkNvbHVtbihkYi5JbnRlZ2VyLCBwcmltYXJ5X2tleT1UcnVlKQogICAgdGl0bGUgPSBkYi5Db2x1bW4oZGIuU3RyaW5nKDEwMCksIG51bGxhYmxlPUZhbHNlKQogICAgZGF0ZV9wb3N0ZWQgPSBkYi5Db2x1bW4oZGIuRGF0ZVRpbWUsIG51bGxhYmxlPUZhbHNlLCBkZWZhdWx0PWRhdGV0aW1lLnV0Y25vdykKICAgIGNvbnRlbnQgPSBkYi5Db2x1bW4oZGIuVGV4dCwgbnVsbGFibGU9RmFsc2UpCiAgICB1c2VyX2lkID0gZGIuQ29sdW1uKGRiLkludGVnZXIsIGRiLkZvcmVpZ25LZXkoJ3VzZXIuaWQnKSwgbnVsbGFibGU9RmFsc2UpCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBmIlBvc3QoJ3tzZWxmLnRpdGxlfScsICd7c2VsZi5kYXRlX3Bvc3RlZH0nKSI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Post(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    title = db.Column(db.String(100), nullable=False)
    date_posted = db.Column(db.DateTime, nullable=False, default=datetime.utcnow)
    content = db.Column(db.Text, nullable=False)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)

    def __repr__(self):
        return f&quot;Post('{self.title}', '{self.date_posted}')&quot;</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>id</strong>: Primary key for the table.</li>
<li><strong>title</strong>: A string field with a maximum length of 100 characters, cannot be null.</li>
<li><strong>date_posted</strong>: A datetime field with a default value of the current time, cannot be null.</li>
<li><strong>content</strong>: A text field for the post content, cannot be null.</li>
<li><strong>user_id</strong>: A foreign key linking to the User model, cannot be null.</li>
</ul>
</div><h1><p>Creating the Database</p>
</h1>
<div class='content'><p>To create the database and the tables defined by your models, use the following commands in the Flask shell:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSB5b3VyYXBwbGljYXRpb24gaW1wb3J0IGRiCmRiLmNyZWF0ZV9hbGwoKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from yourapplication import db
db.create_all()</pre></div><div class='content'><p>This will create the <code>site.db</code> file (or the database specified in your configuration) with the tables for the <code>User</code> and <code>Post</code> models.</p>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Task</p>
</h2>
<div class='content'><ol>
<li>
<p>Define a new model called <code>Comment</code> with the following fields:</p>
<ul>
<li><code>id</code>: Primary key.</li>
<li><code>content</code>: Text field, cannot be null.</li>
<li><code>date_posted</code>: DateTime field, default to current time, cannot be null.</li>
<li><code>user_id</code>: Foreign key linking to the <code>User</code> model, cannot be null.</li>
<li><code>post_id</code>: Foreign key linking to the <code>Post</code> model, cannot be null.</li>
</ul>
</li>
<li>
<p>Create the database and the tables.</p>
</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgQ29tbWVudChkYi5Nb2RlbCk6CiAgICBpZCA9IGRiLkNvbHVtbihkYi5JbnRlZ2VyLCBwcmltYXJ5X2tleT1UcnVlKQogICAgY29udGVudCA9IGRiLkNvbHVtbihkYi5UZXh0LCBudWxsYWJsZT1GYWxzZSkKICAgIGRhdGVfcG9zdGVkID0gZGIuQ29sdW1uKGRiLkRhdGVUaW1lLCBudWxsYWJsZT1GYWxzZSwgZGVmYXVsdD1kYXRldGltZS51dGNub3cpCiAgICB1c2VyX2lkID0gZGIuQ29sdW1uKGRiLkludGVnZXIsIGRiLkZvcmVpZ25LZXkoJ3VzZXIuaWQnKSwgbnVsbGFibGU9RmFsc2UpCiAgICBwb3N0X2lkID0gZGIuQ29sdW1uKGRiLkludGVnZXIsIGRiLkZvcmVpZ25LZXkoJ3Bvc3QuaWQnKSwgbnVsbGFibGU9RmFsc2UpCgogICAgZGVmIF9fcmVwcl9fKHNlbGYpOgogICAgICAgIHJldHVybiBmIkNvbW1lbnQoJ3tzZWxmLmNvbnRlbnR9JywgJ3tzZWxmLmRhdGVfcG9zdGVkfScpIgoKIyBDcmVhdGUgdGhlIGRhdGFiYXNlIGFuZCB0YWJsZXMKZGIuY3JlYXRlX2FsbCgp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Comment(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    content = db.Column(db.Text, nullable=False)
    date_posted = db.Column(db.DateTime, nullable=False, default=datetime.utcnow)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)
    post_id = db.Column(db.Integer, db.ForeignKey('post.id'), nullable=False)

    def __repr__(self):
        return f&quot;Comment('{self.content}', '{self.date_posted}')&quot;

# Create the database and tables
db.create_all()</pre></div><div class='content'></div><h1><p>Summary</p>
</h1>
<div class='content'><p>In this section, we covered the basics of defining models using Flask-SQLAlchemy. We learned how to create models, define fields, establish relationships, and create the database tables. Understanding these concepts is crucial for building robust and scalable web applications with Flask. In the next section, we will explore performing CRUD operations with these models.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-01-intro-flask-sqlalchemy' title="Introduction to Flask-SQLAlchemy">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='04-03-crud-operations' title="Performing CRUD Operations">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
