<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using Flask-Admin for Admin Interfaces</title>

    <link rel="alternate" href="https://campusempresa.com/mod/flask/10-03-flask-admin" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/flask/10-03-flask-admin" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/flask/10-03-flask-admin" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/flask/10-03-flask-admin" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/flask/10-03-flask-admin" class="px-2">CA</a>
					</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='10-02-flask-mail' title="Using Flask-Mail for Email">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Using Flask-Admin for Admin Interfaces</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='10-04-flask-socketio' title="Using Flask-SocketIO for WebSockets">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Flask-Admin is a powerful extension for Flask that allows you to easily create administrative interfaces for your applications. It provides a simple way to manage your application's data through a web interface, making it easier to perform CRUD operations on your models.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Flask-Admin Overview</strong>: Understand what Flask-Admin is and its benefits.</li>
<li><strong>Installation</strong>: Learn how to install Flask-Admin.</li>
<li><strong>Basic Setup</strong>: Set up a basic Flask-Admin interface.</li>
<li><strong>Model Views</strong>: Create views for your models.</li>
<li><strong>Customizing Views</strong>: Customize the appearance and behavior of your admin views.</li>
<li><strong>Authentication</strong>: Secure your admin interface.</li>
</ol>
</div><h1><p>Flask-Admin Overview</p>
</h1>
<div class='content'><p>Flask-Admin is an extension that adds an administrative interface to any Flask application. It is highly customizable and can be integrated with various ORMs like SQLAlchemy, MongoEngine, and Peewee.</p>
</div><h2><p>Benefits of Using Flask-Admin</p>
</h2>
<div class='content'><ul>
<li><strong>Ease of Use</strong>: Quickly set up an admin interface with minimal code.</li>
<li><strong>Customizability</strong>: Customize the admin interface to fit your needs.</li>
<li><strong>Integration</strong>: Works seamlessly with popular ORMs.</li>
<li><strong>Extensibility</strong>: Extend the functionality with custom views and actions.</li>
</ul>
</div><h1><p>Installation</p>
</h1>
<div class='content'><p>To install Flask-Admin, you can use pip:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgZmxhc2stYWRtaW4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install flask-admin</pre></div><div class='content'></div><h1><p>Basic Setup</p>
</h1>
<div class='content'><p>Let's start by setting up a basic Flask application with Flask-Admin.</p>
</div><h2><p>Step 1: Create a Flask Application</p>
</h2>
<div class='content'><p>Create a new file called <code>app.py</code> and set up a basic Flask application:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2sKZnJvbSBmbGFza19zcWxhbGNoZW15IGltcG9ydCBTUUxBbGNoZW15CmZyb20gZmxhc2tfYWRtaW4gaW1wb3J0IEFkbWluCmZyb20gZmxhc2tfYWRtaW4uY29udHJpYi5zcWxhIGltcG9ydCBNb2RlbFZpZXcKCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQphcHAuY29uZmlnWydTUUxBTENIRU1ZX0RBVEFCQVNFX1VSSSddID0gJ3NxbGl0ZTovLy9teWRhdGFiYXNlLmRiJwphcHAuY29uZmlnWydTRUNSRVRfS0VZJ10gPSAnbXlzZWNyZXRrZXknCmRiID0gU1FMQWxjaGVteShhcHApCmFkbWluID0gQWRtaW4oYXBwLCBuYW1lPSdNeUFwcCcsIHRlbXBsYXRlX21vZGU9J2Jvb3RzdHJhcDMnKQoKIyBEZWZpbmUgYSBtb2RlbApjbGFzcyBVc2VyKGRiLk1vZGVsKToKICAgIGlkID0gZGIuQ29sdW1uKGRiLkludGVnZXIsIHByaW1hcnlfa2V5PVRydWUpCiAgICB1c2VybmFtZSA9IGRiLkNvbHVtbihkYi5TdHJpbmcoODApLCB1bmlxdWU9VHJ1ZSwgbnVsbGFibGU9RmFsc2UpCiAgICBlbWFpbCA9IGRiLkNvbHVtbihkYi5TdHJpbmcoMTIwKSwgdW5pcXVlPVRydWUsIG51bGxhYmxlPUZhbHNlKQoKIyBBZGQgbW9kZWwgdG8gYWRtaW4KYWRtaW4uYWRkX3ZpZXcoTW9kZWxWaWV3KFVzZXIsIGRiLnNlc3Npb24pKQoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIGRiLmNyZWF0ZV9hbGwoKQogICAgYXBwLnJ1bihkZWJ1Zz1UcnVlKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask
from flask_sqlalchemy import SQLAlchemy
from flask_admin import Admin
from flask_admin.contrib.sqla import ModelView

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///mydatabase.db'
app.config['SECRET_KEY'] = 'mysecretkey'
db = SQLAlchemy(app)
admin = Admin(app, name='MyApp', template_mode='bootstrap3')

# Define a model
class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80), unique=True, nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)

# Add model to admin
admin.add_view(ModelView(User, db.session))

if __name__ == '__main__':
    db.create_all()
    app.run(debug=True)</pre></div><div class='content'></div><h2><p>Step 2: Run the Application</p>
</h2>
<div class='content'><p>Run your Flask application:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHl0aG9uIGFwcC5weQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>python app.py</pre></div><div class='content'><p>Open your web browser and navigate to <code>http://127.0.0.1:5000/admin</code>. You should see the Flask-Admin interface with the <code>User</code> model.</p>
</div><h1><p>Model Views</p>
</h1>
<div class='content'><p>Flask-Admin uses views to represent models in the admin interface. The <code>ModelView</code> class is used to create views for SQLAlchemy models.</p>
</div><h2><p>Example: Adding Another Model</p>
</h2>
<div class='content'><p>Let's add another model to our application and include it in the admin interface:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgUG9zdChkYi5Nb2RlbCk6CiAgICBpZCA9IGRiLkNvbHVtbihkYi5JbnRlZ2VyLCBwcmltYXJ5X2tleT1UcnVlKQogICAgdGl0bGUgPSBkYi5Db2x1bW4oZGIuU3RyaW5nKDEyMCksIG51bGxhYmxlPUZhbHNlKQogICAgY29udGVudCA9IGRiLkNvbHVtbihkYi5UZXh0LCBudWxsYWJsZT1GYWxzZSkKICAgIHVzZXJfaWQgPSBkYi5Db2x1bW4oZGIuSW50ZWdlciwgZGIuRm9yZWlnbktleSgndXNlci5pZCcpLCBudWxsYWJsZT1GYWxzZSkKCmFkbWluLmFkZF92aWV3KE1vZGVsVmlldyhQb3N0LCBkYi5zZXNzaW9uKSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class Post(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    title = db.Column(db.String(120), nullable=False)
    content = db.Column(db.Text, nullable=False)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)

admin.add_view(ModelView(Post, db.session))</pre></div><div class='content'></div><h1><p>Customizing Views</p>
</h1>
<div class='content'><p>You can customize the appearance and behavior of your admin views by subclassing <code>ModelView</code>.</p>
</div><h2><p>Example: Customizing the User View</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgVXNlclZpZXcoTW9kZWxWaWV3KToKICAgIGNvbHVtbl9saXN0ID0gKCdpZCcsICd1c2VybmFtZScsICdlbWFpbCcpCiAgICBmb3JtX2NvbHVtbnMgPSAoJ3VzZXJuYW1lJywgJ2VtYWlsJykKCmFkbWluLmFkZF92aWV3KFVzZXJWaWV3KFVzZXIsIGRiLnNlc3Npb24pKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class UserView(ModelView):
    column_list = ('id', 'username', 'email')
    form_columns = ('username', 'email')

admin.add_view(UserView(User, db.session))</pre></div><div class='content'></div><h2><p>Customizing Column Display</p>
</h2>
<div class='content'><ul>
<li><code>column_list</code>: Specifies the columns to display in the list view.</li>
<li><code>form_columns</code>: Specifies the columns to include in the form view.</li>
</ul>
</div><h1><p>Authentication</p>
</h1>
<div class='content'><p>To secure your admin interface, you can use Flask-Login to add authentication.</p>
</div><h2><p>Example: Adding Authentication</p>
</h2>
<div class='content'><p>First, install Flask-Login:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgZmxhc2stbG9naW4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install flask-login</pre></div><div class='content'><p>Then, update your <code>app.py</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFza19sb2dpbiBpbXBvcnQgTG9naW5NYW5hZ2VyLCBVc2VyTWl4aW4sIGxvZ2luX3VzZXIsIGxvZ2luX3JlcXVpcmVkLCBsb2dvdXRfdXNlciwgY3VycmVudF91c2VyCgpsb2dpbl9tYW5hZ2VyID0gTG9naW5NYW5hZ2VyKCkKbG9naW5fbWFuYWdlci5pbml0X2FwcChhcHApCmxvZ2luX21hbmFnZXIubG9naW5fdmlldyA9ICdsb2dpbicKCmNsYXNzIFVzZXIoVXNlck1peGluLCBkYi5Nb2RlbCk6CiAgICBpZCA9IGRiLkNvbHVtbihkYi5JbnRlZ2VyLCBwcmltYXJ5X2tleT1UcnVlKQogICAgdXNlcm5hbWUgPSBkYi5Db2x1bW4oZGIuU3RyaW5nKDgwKSwgdW5pcXVlPVRydWUsIG51bGxhYmxlPUZhbHNlKQogICAgZW1haWwgPSBkYi5Db2x1bW4oZGIuU3RyaW5nKDEyMCksIHVuaXF1ZT1UcnVlLCBudWxsYWJsZT1GYWxzZSkKICAgIHBhc3N3b3JkID0gZGIuQ29sdW1uKGRiLlN0cmluZygxMjApLCBudWxsYWJsZT1GYWxzZSkKCkBsb2dpbl9tYW5hZ2VyLnVzZXJfbG9hZGVyCmRlZiBsb2FkX3VzZXIodXNlcl9pZCk6CiAgICByZXR1cm4gVXNlci5xdWVyeS5nZXQoaW50KHVzZXJfaWQpKQoKQGFwcC5yb3V0ZSgnL2xvZ2luJywgbWV0aG9kcz1bJ0dFVCcsICdQT1NUJ10pCmRlZiBsb2dpbigpOgogICAgIyBJbXBsZW1lbnQgbG9naW4gbG9naWMgaGVyZQogICAgcGFzcwoKQGFwcC5yb3V0ZSgnL2xvZ291dCcpCkBsb2dpbl9yZXF1aXJlZApkZWYgbG9nb3V0KCk6CiAgICBsb2dvdXRfdXNlcigpCiAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcignaW5kZXgnKSkKCmNsYXNzIE15TW9kZWxWaWV3KE1vZGVsVmlldyk6CiAgICBkZWYgaXNfYWNjZXNzaWJsZShzZWxmKToKICAgICAgICByZXR1cm4gY3VycmVudF91c2VyLmlzX2F1dGhlbnRpY2F0ZWQKCmFkbWluLmFkZF92aWV3KE15TW9kZWxWaWV3KFVzZXIsIGRiLnNlc3Npb24pKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask_login import LoginManager, UserMixin, login_user, login_required, logout_user, current_user

login_manager = LoginManager()
login_manager.init_app(app)
login_manager.login_view = 'login'

class User(UserMixin, db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80), unique=True, nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)
    password = db.Column(db.String(120), nullable=False)

@login_manager.user_loader
def load_user(user_id):
    return User.query.get(int(user_id))

@app.route('/login', methods=['GET', 'POST'])
def login():
    # Implement login logic here
    pass

@app.route('/logout')
@login_required
def logout():
    logout_user()
    return redirect(url_for('index'))

class MyModelView(ModelView):
    def is_accessible(self):
        return current_user.is_authenticated

admin.add_view(MyModelView(User, db.session))</pre></div><div class='content'></div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Create an Admin Interface for a Blog Application</p>
</h2>
<div class='content'><ol>
<li><strong>Create Models</strong>: Define models for <code>User</code>, <code>Post</code>, and <code>Comment</code>.</li>
<li><strong>Set Up Flask-Admin</strong>: Add Flask-Admin to your application.</li>
<li><strong>Create Views</strong>: Create views for each model.</li>
<li><strong>Customize Views</strong>: Customize the views to display relevant columns.</li>
<li><strong>Add Authentication</strong>: Secure the admin interface with authentication.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBhcHAucHkKZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlZGlyZWN0LCB1cmxfZm9yCmZyb20gZmxhc2tfc3FsYWxjaGVteSBpbXBvcnQgU1FMQWxjaGVteQpmcm9tIGZsYXNrX2FkbWluIGltcG9ydCBBZG1pbgpmcm9tIGZsYXNrX2FkbWluLmNvbnRyaWIuc3FsYSBpbXBvcnQgTW9kZWxWaWV3CmZyb20gZmxhc2tfbG9naW4gaW1wb3J0IExvZ2luTWFuYWdlciwgVXNlck1peGluLCBsb2dpbl91c2VyLCBsb2dpbl9yZXF1aXJlZCwgbG9nb3V0X3VzZXIsIGN1cnJlbnRfdXNlcgoKYXBwID0gRmxhc2soX19uYW1lX18pCmFwcC5jb25maWdbJ1NRTEFMQ0hFTVlfREFUQUJBU0VfVVJJJ10gPSAnc3FsaXRlOi8vL2Jsb2cuZGInCmFwcC5jb25maWdbJ1NFQ1JFVF9LRVknXSA9ICdteXNlY3JldGtleScKZGIgPSBTUUxBbGNoZW15KGFwcCkKYWRtaW4gPSBBZG1pbihhcHAsIG5hbWU9J0Jsb2dBZG1pbicsIHRlbXBsYXRlX21vZGU9J2Jvb3RzdHJhcDMnKQoKbG9naW5fbWFuYWdlciA9IExvZ2luTWFuYWdlcigpCmxvZ2luX21hbmFnZXIuaW5pdF9hcHAoYXBwKQpsb2dpbl9tYW5hZ2VyLmxvZ2luX3ZpZXcgPSAnbG9naW4nCgpjbGFzcyBVc2VyKFVzZXJNaXhpbiwgZGIuTW9kZWwpOgogICAgaWQgPSBkYi5Db2x1bW4oZGIuSW50ZWdlciwgcHJpbWFyeV9rZXk9VHJ1ZSkKICAgIHVzZXJuYW1lID0gZGIuQ29sdW1uKGRiLlN0cmluZyg4MCksIHVuaXF1ZT1UcnVlLCBudWxsYWJsZT1GYWxzZSkKICAgIGVtYWlsID0gZGIuQ29sdW1uKGRiLlN0cmluZygxMjApLCB1bmlxdWU9VHJ1ZSwgbnVsbGFibGU9RmFsc2UpCiAgICBwYXNzd29yZCA9IGRiLkNvbHVtbihkYi5TdHJpbmcoMTIwKSwgbnVsbGFibGU9RmFsc2UpCgpjbGFzcyBQb3N0KGRiLk1vZGVsKToKICAgIGlkID0gZGIuQ29sdW1uKGRiLkludGVnZXIsIHByaW1hcnlfa2V5PVRydWUpCiAgICB0aXRsZSA9IGRiLkNvbHVtbihkYi5TdHJpbmcoMTIwKSwgbnVsbGFibGU9RmFsc2UpCiAgICBjb250ZW50ID0gZGIuQ29sdW1uKGRiLlRleHQsIG51bGxhYmxlPUZhbHNlKQogICAgdXNlcl9pZCA9IGRiLkNvbHVtbihkYi5JbnRlZ2VyLCBkYi5Gb3JlaWduS2V5KCd1c2VyLmlkJyksIG51bGxhYmxlPUZhbHNlKQoKY2xhc3MgQ29tbWVudChkYi5Nb2RlbCk6CiAgICBpZCA9IGRiLkNvbHVtbihkYi5JbnRlZ2VyLCBwcmltYXJ5X2tleT1UcnVlKQogICAgY29udGVudCA9IGRiLkNvbHVtbihkYi5UZXh0LCBudWxsYWJsZT1GYWxzZSkKICAgIHBvc3RfaWQgPSBkYi5Db2x1bW4oZGIuSW50ZWdlciwgZGIuRm9yZWlnbktleSgncG9zdC5pZCcpLCBudWxsYWJsZT1GYWxzZSkKCkBsb2dpbl9tYW5hZ2VyLnVzZXJfbG9hZGVyCmRlZiBsb2FkX3VzZXIodXNlcl9pZCk6CiAgICByZXR1cm4gVXNlci5xdWVyeS5nZXQoaW50KHVzZXJfaWQpKQoKQGFwcC5yb3V0ZSgnL2xvZ2luJywgbWV0aG9kcz1bJ0dFVCcsICdQT1NUJ10pCmRlZiBsb2dpbigpOgogICAgIyBJbXBsZW1lbnQgbG9naW4gbG9naWMgaGVyZQogICAgcGFzcwoKQGFwcC5yb3V0ZSgnL2xvZ291dCcpCkBsb2dpbl9yZXF1aXJlZApkZWYgbG9nb3V0KCk6CiAgICBsb2dvdXRfdXNlcigpCiAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcignaW5kZXgnKSkKCmNsYXNzIE15TW9kZWxWaWV3KE1vZGVsVmlldyk6CiAgICBkZWYgaXNfYWNjZXNzaWJsZShzZWxmKToKICAgICAgICByZXR1cm4gY3VycmVudF91c2VyLmlzX2F1dGhlbnRpY2F0ZWQKCmFkbWluLmFkZF92aWV3KE15TW9kZWxWaWV3KFVzZXIsIGRiLnNlc3Npb24pKQphZG1pbi5hZGRfdmlldyhNeU1vZGVsVmlldyhQb3N0LCBkYi5zZXNzaW9uKSkKYWRtaW4uYWRkX3ZpZXcoTXlNb2RlbFZpZXcoQ29tbWVudCwgZGIuc2Vzc2lvbikpCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgZGIuY3JlYXRlX2FsbCgpCiAgICBhcHAucnVuKGRlYnVnPVRydWUp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># app.py
from flask import Flask, redirect, url_for
from flask_sqlalchemy import SQLAlchemy
from flask_admin import Admin
from flask_admin.contrib.sqla import ModelView
from flask_login import LoginManager, UserMixin, login_user, login_required, logout_user, current_user

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///blog.db'
app.config['SECRET_KEY'] = 'mysecretkey'
db = SQLAlchemy(app)
admin = Admin(app, name='BlogAdmin', template_mode='bootstrap3')

login_manager = LoginManager()
login_manager.init_app(app)
login_manager.login_view = 'login'

class User(UserMixin, db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80), unique=True, nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)
    password = db.Column(db.String(120), nullable=False)

class Post(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    title = db.Column(db.String(120), nullable=False)
    content = db.Column(db.Text, nullable=False)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)

class Comment(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    content = db.Column(db.Text, nullable=False)
    post_id = db.Column(db.Integer, db.ForeignKey('post.id'), nullable=False)

@login_manager.user_loader
def load_user(user_id):
    return User.query.get(int(user_id))

@app.route('/login', methods=['GET', 'POST'])
def login():
    # Implement login logic here
    pass

@app.route('/logout')
@login_required
def logout():
    logout_user()
    return redirect(url_for('index'))

class MyModelView(ModelView):
    def is_accessible(self):
        return current_user.is_authenticated

admin.add_view(MyModelView(User, db.session))
admin.add_view(MyModelView(Post, db.session))
admin.add_view(MyModelView(Comment, db.session))

if __name__ == '__main__':
    db.create_all()
    app.run(debug=True)</pre></div><div class='content'></div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, you learned how to use Flask-Admin to create an administrative interface for your Flask application. You covered the basics of setting up Flask-Admin, creating model views, customizing views, and securing the admin interface with authentication. This knowledge will help you manage your application's data more efficiently and provide a better user experience for administrators.</p>
<p>Next, you will explore using Flask-SocketIO for real-time communication in your Flask applications.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='10-02-flask-mail' title="Using Flask-Mail for Email">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='10-04-flask-socketio' title="Using Flask-SocketIO for WebSockets">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
