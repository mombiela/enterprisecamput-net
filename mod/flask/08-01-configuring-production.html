<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuring Flask for Production</title>

    <link rel="alternate" href="https://campusempresa.com/mod/flask/08-01-configuring-production" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/flask/08-01-configuring-production" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/flask/08-01-configuring-production" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/flask/08-01-configuring-production" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/flask/08-01-configuring-production" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Programming Languages</a>
				 					<a href="/categ/frameworks">Frameworks and Libraries</a>
				 					<a href="/categ/tech-tools">Technical Tools</a>
				 					<a href="/categ/foundations">Theoretical Foundations</a>
				 					<a href="/categ/soft-skills">Social Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='07-04-authentication-apis' title="Authentication for APIs">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Configuring Flask for Production</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-02-deploying-heroku' title="Deploying to Heroku">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will cover the essential steps and best practices for configuring a Flask application for production. Running a Flask application in a production environment requires careful consideration of security, performance, and reliability. This guide will help you set up your Flask application to handle real-world traffic efficiently and securely.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Environment Configuration</strong></li>
<li><strong>WSGI Servers</strong></li>
<li><strong>Reverse Proxy Setup</strong></li>
<li><strong>Security Best Practices</strong></li>
<li><strong>Performance Optimization</strong></li>
</ol>
</div><h1><ol>
<li>Environment Configuration</li>
</ol>
</h1>
<div class='content'></div><h2><p>Setting Up Environment Variables</p>
</h2>
<div class='content'><p>Environment variables are crucial for managing configuration settings in a production environment. They help keep sensitive information, such as database credentials and secret keys, out of your source code.</p>
<p><strong>Example: Setting Environment Variables</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZXhwb3J0IEZMQVNLX0VOVj1wcm9kdWN0aW9uCmV4cG9ydCBTRUNSRVRfS0VZPSd5b3VyLXByb2R1Y3Rpb24tc2VjcmV0LWtleScKZXhwb3J0IERBVEFCQVNFX1VSTD0neW91ci1kYXRhYmFzZS11cmwn"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>export FLASK_ENV=production
export SECRET_KEY='your-production-secret-key'
export DATABASE_URL='your-database-url'</pre></div><div class='content'></div><h2><p>Configuring Flask for Production</p>
</h2>
<div class='content'><p>Flask provides a built-in way to switch between development and production configurations using the <code>FLASK_ENV</code> environment variable.</p>
<p><strong>Example: Configuring Flask</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9zCmZyb20gZmxhc2sgaW1wb3J0IEZsYXNrCgphcHAgPSBGbGFzayhfX25hbWVfXykKCiMgTG9hZCBjb25maWd1cmF0aW9uIGZyb20gZW52aXJvbm1lbnQgdmFyaWFibGVzCmFwcC5jb25maWdbJ1NFQ1JFVF9LRVknXSA9IG9zLmdldGVudignU0VDUkVUX0tFWScpCmFwcC5jb25maWdbJ1NRTEFMQ0hFTVlfREFUQUJBU0VfVVJJJ10gPSBvcy5nZXRlbnYoJ0RBVEFCQVNFX1VSTCcpCgppZiBvcy5nZXRlbnYoJ0ZMQVNLX0VOVicpID09ICdwcm9kdWN0aW9uJzoKICAgIGFwcC5jb25maWdbJ0RFQlVHJ10gPSBGYWxzZQplbHNlOgogICAgYXBwLmNvbmZpZ1snREVCVUcnXSA9IFRydWU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import os
from flask import Flask

app = Flask(__name__)

# Load configuration from environment variables
app.config['SECRET_KEY'] = os.getenv('SECRET_KEY')
app.config['SQLALCHEMY_DATABASE_URI'] = os.getenv('DATABASE_URL')

if os.getenv('FLASK_ENV') == 'production':
    app.config['DEBUG'] = False
else:
    app.config['DEBUG'] = True</pre></div><div class='content'></div><h1><ol start="2">
<li>WSGI Servers</li>
</ol>
</h1>
<div class='content'></div><h2><p>What is a WSGI Server?</p>
</h2>
<div class='content'><p>WSGI (Web Server Gateway Interface) is a specification that allows web servers to communicate with web applications. In production, you should use a WSGI server like Gunicorn or uWSGI to serve your Flask application.</p>
</div><h2><p>Setting Up Gunicorn</p>
</h2>
<div class='content'><p>Gunicorn is a popular WSGI server for Python applications. It is simple to set up and highly performant.</p>
<p><strong>Example: Installing Gunicorn</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgZ3VuaWNvcm4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install gunicorn</pre></div><div class='content'><p><strong>Example: Running Flask with Gunicorn</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z3VuaWNvcm4gLXcgNCAtYiAwLjAuMC4wOjgwMDAgbXlhcHA6YXBw"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gunicorn -w 4 -b 0.0.0.0:8000 myapp:app</pre></div><div class='content'><ul>
<li><code>-w 4</code>: Specifies the number of worker processes.</li>
<li><code>-b 0.0.0.0:8000</code>: Binds the server to all available IP addresses on port 8000.</li>
<li><code>myapp:app</code>: Refers to the Flask application instance.</li>
</ul>
</div><h1><ol start="3">
<li>Reverse Proxy Setup</li>
</ol>
</h1>
<div class='content'></div><h2><p>Why Use a Reverse Proxy?</p>
</h2>
<div class='content'><p>A reverse proxy, such as Nginx or Apache, sits in front of your WSGI server and handles incoming HTTP requests. It can provide additional features like load balancing, SSL termination, and caching.</p>
</div><h2><p>Setting Up Nginx as a Reverse Proxy</p>
</h2>
<div class='content'><p><strong>Example: Nginx Configuration</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VydmVyIHsKICAgIGxpc3RlbiA4MDsKICAgIHNlcnZlcl9uYW1lIHlvdXJkb21haW4uY29tOwoKICAgIGxvY2F0aW9uIC8gewogICAgICAgIHByb3h5X3Bhc3MgaHR0cDovLzEyNy4wLjAuMTo4MDAwOwogICAgICAgIHByb3h5X3NldF9oZWFkZXIgSG9zdCAkaG9zdDsKICAgICAgICBwcm94eV9zZXRfaGVhZGVyIFgtUmVhbC1JUCAkcmVtb3RlX2FkZHI7CiAgICAgICAgcHJveHlfc2V0X2hlYWRlciBYLUZvcndhcmRlZC1Gb3IgJHByb3h5X2FkZF94X2ZvcndhcmRlZF9mb3I7CiAgICAgICAgcHJveHlfc2V0X2hlYWRlciBYLUZvcndhcmRlZC1Qcm90byAkc2NoZW1lOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>server {
    listen 80;
    server_name yourdomain.com;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}</pre></div><div class='content'><ul>
<li><code>proxy_pass http://127.0.0.1:8000;</code>: Forwards requests to the Gunicorn server running on port 8000.</li>
<li><code>proxy_set_header</code>: Sets various headers to pass along with the request.</li>
</ul>
</div><h1><ol start="4">
<li>Security Best Practices</li>
</ol>
</h1>
<div class='content'></div><h2><p>Enabling HTTPS</p>
</h2>
<div class='content'><p>Use HTTPS to encrypt data between the client and server. You can obtain a free SSL certificate from Let's Encrypt.</p>
<p><strong>Example: Obtaining an SSL Certificate</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3VkbyBhcHQtZ2V0IGluc3RhbGwgY2VydGJvdCBweXRob24zLWNlcnRib3QtbmdpbngKc3VkbyBjZXJ0Ym90IC0tbmdpbnggLWQgeW91cmRvbWFpbi5jb20="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sudo apt-get install certbot python3-certbot-nginx
sudo certbot --nginx -d yourdomain.com</pre></div><div class='content'></div><h2><p>Secure Headers</p>
</h2>
<div class='content'><p>Add security headers to your responses to protect against common web vulnerabilities.</p>
<p><strong>Example: Adding Security Headers in Flask</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QGFwcC5hZnRlcl9yZXF1ZXN0CmRlZiBhZGRfc2VjdXJpdHlfaGVhZGVycyhyZXNwb25zZSk6CiAgICByZXNwb25zZS5oZWFkZXJzWydDb250ZW50LVNlY3VyaXR5LVBvbGljeSddID0gImRlZmF1bHQtc3JjICdzZWxmJyIKICAgIHJlc3BvbnNlLmhlYWRlcnNbJ1gtQ29udGVudC1UeXBlLU9wdGlvbnMnXSA9ICdub3NuaWZmJwogICAgcmVzcG9uc2UuaGVhZGVyc1snWC1GcmFtZS1PcHRpb25zJ10gPSAnREVOWScKICAgIHJlc3BvbnNlLmhlYWRlcnNbJ1gtWFNTLVByb3RlY3Rpb24nXSA9ICcxOyBtb2RlPWJsb2NrJwogICAgcmV0dXJuIHJlc3BvbnNl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@app.after_request
def add_security_headers(response):
    response.headers['Content-Security-Policy'] = &quot;default-src 'self'&quot;
    response.headers['X-Content-Type-Options'] = 'nosniff'
    response.headers['X-Frame-Options'] = 'DENY'
    response.headers['X-XSS-Protection'] = '1; mode=block'
    return response</pre></div><div class='content'></div><h1><ol start="5">
<li>Performance Optimization</li>
</ol>
</h1>
<div class='content'></div><h2><p>Caching</p>
</h2>
<div class='content'><p>Implement caching to reduce the load on your server and improve response times.</p>
<p><strong>Example: Using Flask-Caching</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgRmxhc2stQ2FjaGluZw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install Flask-Caching</pre></div><div class='content'><p><strong>Example: Configuring Flask-Caching</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFza19jYWNoaW5nIGltcG9ydCBDYWNoZQoKY2FjaGUgPSBDYWNoZShjb25maWc9eydDQUNIRV9UWVBFJzogJ3NpbXBsZSd9KQpjYWNoZS5pbml0X2FwcChhcHApCgpAYXBwLnJvdXRlKCcvZGF0YScpCkBjYWNoZS5jYWNoZWQodGltZW91dD02MCkKZGVmIGdldF9kYXRhKCk6CiAgICAjIEV4cGVuc2l2ZSBjb21wdXRhdGlvbiBvciBkYXRhYmFzZSBxdWVyeQogICAgcmV0dXJuICdFeHBlbnNpdmUgZGF0YSc="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask_caching import Cache

cache = Cache(config={'CACHE_TYPE': 'simple'})
cache.init_app(app)

@app.route('/data')
@cache.cached(timeout=60)
def get_data():
    # Expensive computation or database query
    return 'Expensive data'</pre></div><div class='content'></div><h2><p>Database Connection Pooling</p>
</h2>
<div class='content'><p>Use connection pooling to manage database connections efficiently.</p>
<p><strong>Example: Configuring SQLAlchemy with Connection Pooling</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwLmNvbmZpZ1snU1FMQUxDSEVNWV9FTkdJTkVfT1BUSU9OUyddID0gewogICAgJ3Bvb2xfc2l6ZSc6IDEwLAogICAgJ3Bvb2xfcmVjeWNsZSc6IDI4MAp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>app.config['SQLALCHEMY_ENGINE_OPTIONS'] = {
    'pool_size': 10,
    'pool_recycle': 280
}</pre></div><div class='content'></div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Configuring Flask for production involves several steps to ensure your application is secure, performant, and reliable. By setting up environment variables, using a WSGI server, configuring a reverse proxy, implementing security best practices, and optimizing performance, you can prepare your Flask application to handle real-world traffic effectively.</p>
<p>In the next section, we will cover how to deploy your Flask application to Heroku, a popular cloud platform for hosting web applications.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='07-04-authentication-apis' title="Authentication for APIs">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-02-deploying-heroku' title="Deploying to Heroku">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
