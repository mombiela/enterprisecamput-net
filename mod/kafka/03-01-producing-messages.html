<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Producing Messages</title>

    <link rel="alternate" href="https://campusempresa.com/mod/kafka/03-01-producing-messages" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/kafka/03-01-producing-messages" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/kafka/03-01-producing-messages" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/kafka/03-01-producing-messages" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/kafka/03-01-producing-messages" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-messages-and-offsets' title="Messages and Offsets">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Producing Messages</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-02-consuming-messages' title="Consuming Messages">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into the process of producing messages in Kafka. This involves understanding how to create and send messages to Kafka topics using Kafka producers. We will cover the following key concepts:</p>
<ol>
<li><strong>Introduction to Kafka Producers</strong></li>
<li><strong>Setting Up a Kafka Producer</strong></li>
<li><strong>Producing Messages to a Topic</strong></li>
<li><strong>Key Configuration Parameters</strong></li>
<li><strong>Error Handling and Retries</strong></li>
<li><strong>Practical Exercises</strong></li>
</ol>
</div><h1>1. Introduction to Kafka Producers</h1>
<div class='content'><p>Kafka producers are responsible for sending records to Kafka topics. A producer can send data to one or more topics, and each record consists of a key, a value, and a timestamp.</p>
</div><h2>Key Concepts:</h2>
<div class='content'><ul>
<li><strong>Producer</strong>: A client that sends records to a Kafka cluster.</li>
<li><strong>Record</strong>: A key-value pair that is sent to a Kafka topic.</li>
<li><strong>Topic</strong>: A category or feed name to which records are sent.</li>
</ul>
</div><h1>2. Setting Up a Kafka Producer</h1>
<div class='content'><p>To set up a Kafka producer, you need to include the Kafka client library in your project. Below is an example of setting up a Kafka producer in Java.</p>
</div><h2>Maven Dependency:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGRlcGVuZGVuY3k+CiAgICA8Z3JvdXBJZD5vcmcuYXBhY2hlLmthZmthPC9ncm91cElkPgogICAgPGFydGlmYWN0SWQ+a2Fma2EtY2xpZW50czwvYXJ0aWZhY3RJZD4KICAgIDx2ZXJzaW9uPjIuOC4wPC92ZXJzaW9uPgo8L2RlcGVuZGVuY3k+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;
    &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt;
    &lt;version&gt;2.8.0&lt;/version&gt;
&lt;/dependency&gt;</pre></div><div class='content'></div><h2>Producer Configuration:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5wcm9kdWNlci5LYWZrYVByb2R1Y2VyOwppbXBvcnQgb3JnLmFwYWNoZS5rYWZrYS5jbGllbnRzLnByb2R1Y2VyLlByb2R1Y2VyQ29uZmlnOwppbXBvcnQgb3JnLmFwYWNoZS5rYWZrYS5jbGllbnRzLnByb2R1Y2VyLlByb2R1Y2VyUmVjb3JkOwppbXBvcnQgb3JnLmFwYWNoZS5rYWZrYS5jb21tb24uc2VyaWFsaXphdGlvbi5TdHJpbmdTZXJpYWxpemVyOwoKaW1wb3J0IGphdmEudXRpbC5Qcm9wZXJ0aWVzOwoKcHVibGljIGNsYXNzIEthZmthUHJvZHVjZXJFeGFtcGxlIHsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBQcm9wZXJ0aWVzIHByb3BzID0gbmV3IFByb3BlcnRpZXMoKTsKICAgICAgICBwcm9wcy5wdXQoUHJvZHVjZXJDb25maWcuQk9PVFNUUkFQX1NFUlZFUlNfQ09ORklHLCAibG9jYWxob3N0OjkwOTIiKTsKICAgICAgICBwcm9wcy5wdXQoUHJvZHVjZXJDb25maWcuS0VZX1NFUklBTElaRVJfQ0xBU1NfQ09ORklHLCBTdHJpbmdTZXJpYWxpemVyLmNsYXNzLmdldE5hbWUoKSk7CiAgICAgICAgcHJvcHMucHV0KFByb2R1Y2VyQ29uZmlnLlZBTFVFX1NFUklBTElaRVJfQ0xBU1NfQ09ORklHLCBTdHJpbmdTZXJpYWxpemVyLmNsYXNzLmdldE5hbWUoKSk7CgogICAgICAgIEthZmthUHJvZHVjZXI8U3RyaW5nLCBTdHJpbmc+IHByb2R1Y2VyID0gbmV3IEthZmthUHJvZHVjZXI8Pihwcm9wcyk7CgogICAgICAgIFByb2R1Y2VyUmVjb3JkPFN0cmluZywgU3RyaW5nPiByZWNvcmQgPSBuZXcgUHJvZHVjZXJSZWNvcmQ8PigibXktdG9waWMiLCAia2V5IiwgInZhbHVlIik7CiAgICAgICAgcHJvZHVjZXIuc2VuZChyZWNvcmQpOwoKICAgICAgICBwcm9kdWNlci5jbG9zZSgpOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.producer.KafkaProducer;
import org.apache.kafka.clients.producer.ProducerConfig;
import org.apache.kafka.clients.producer.ProducerRecord;
import org.apache.kafka.common.serialization.StringSerializer;

import java.util.Properties;

public class KafkaProducerExample {
    public static void main(String[] args) {
        Properties props = new Properties();
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, &quot;localhost:9092&quot;);
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName());

        KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(props);

        ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(&quot;my-topic&quot;, &quot;key&quot;, &quot;value&quot;);
        producer.send(record);

        producer.close();
    }
}</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><strong>Properties</strong>: Configuration settings for the producer.</li>
<li><strong>BOOTSTRAP_SERVERS_CONFIG</strong>: The Kafka broker addresses.</li>
<li><strong>KEY_SERIALIZER_CLASS_CONFIG</strong>: Serializer class for the key.</li>
<li><strong>VALUE_SERIALIZER_CLASS_CONFIG</strong>: Serializer class for the value.</li>
<li><strong>ProducerRecord</strong>: Represents the record to be sent to a topic.</li>
</ul>
</div><h1>3. Producing Messages to a Topic</h1>
<div class='content'><p>Producing messages involves creating <code>ProducerRecord</code> instances and sending them using the <code>KafkaProducer</code> instance.</p>
</div><h2>Example:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJvZHVjZXJSZWNvcmQ8U3RyaW5nLCBTdHJpbmc+IHJlY29yZCA9IG5ldyBQcm9kdWNlclJlY29yZDw+KCJteS10b3BpYyIsICJrZXkiLCAidmFsdWUiKTsKcHJvZHVjZXIuc2VuZChyZWNvcmQpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(&quot;my-topic&quot;, &quot;key&quot;, &quot;value&quot;);
producer.send(record);</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><strong>ProducerRecord</strong>: Contains the topic name, key, and value.</li>
<li><strong>send()</strong>: Sends the record to the specified topic.</li>
</ul>
</div><h1>4. Key Configuration Parameters</h1>
<div class='content'><p>Understanding key configuration parameters is crucial for optimizing producer performance and reliability.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>acks</code></td>
<td>The number of acknowledgments the producer requires the leader to have received before considering a request complete.</td>
</tr>
<tr>
<td><code>retries</code></td>
<td>The number of retries if the send fails.</td>
</tr>
<tr>
<td><code>batch.size</code></td>
<td>The size of the batch for sending records.</td>
</tr>
<tr>
<td><code>linger.ms</code></td>
<td>The time to wait before sending a batch.</td>
</tr>
<tr>
<td><code>buffer.memory</code></td>
<td>The total memory available to the producer for buffering.</td>
</tr>
</tbody>
</table>
</div><h2>Example Configuration:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJvcHMucHV0KFByb2R1Y2VyQ29uZmlnLkFDS1NfQ09ORklHLCAiYWxsIik7CnByb3BzLnB1dChQcm9kdWNlckNvbmZpZy5SRVRSSUVTX0NPTkZJRywgMyk7CnByb3BzLnB1dChQcm9kdWNlckNvbmZpZy5CQVRDSF9TSVpFX0NPTkZJRywgMTYzODQpOwpwcm9wcy5wdXQoUHJvZHVjZXJDb25maWcuTElOR0VSX01TX0NPTkZJRywgMSk7CnByb3BzLnB1dChQcm9kdWNlckNvbmZpZy5CVUZGRVJfTUVNT1JZX0NPTkZJRywgMzM1NTQ0MzIpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>props.put(ProducerConfig.ACKS_CONFIG, &quot;all&quot;);
props.put(ProducerConfig.RETRIES_CONFIG, 3);
props.put(ProducerConfig.BATCH_SIZE_CONFIG, 16384);
props.put(ProducerConfig.LINGER_MS_CONFIG, 1);
props.put(ProducerConfig.BUFFER_MEMORY_CONFIG, 33554432);</pre></div><div class='content'></div><h1>5. Error Handling and Retries</h1>
<div class='content'><p>Handling errors and implementing retries are essential for building robust Kafka producers.</p>
</div><h2>Example:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJvZHVjZXIuc2VuZChyZWNvcmQsIChtZXRhZGF0YSwgZXhjZXB0aW9uKSAtPiB7CiAgICBpZiAoZXhjZXB0aW9uICE9IG51bGwpIHsKICAgICAgICBleGNlcHRpb24ucHJpbnRTdGFja1RyYWNlKCk7CiAgICB9IGVsc2UgewogICAgICAgIFN5c3RlbS5vdXQucHJpbnRmKCJTZW50IHJlY29yZChrZXk9JXMgdmFsdWU9JXMpIG1ldGEocGFydGl0aW9uPSVkLCBvZmZzZXQ9JWQpXG4iLAogICAgICAgICAgICAgICAgcmVjb3JkLmtleSgpLCByZWNvcmQudmFsdWUoKSwgbWV0YWRhdGEucGFydGl0aW9uKCksIG1ldGFkYXRhLm9mZnNldCgpKTsKICAgIH0KfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>producer.send(record, (metadata, exception) -&gt; {
    if (exception != null) {
        exception.printStackTrace();
    } else {
        System.out.printf(&quot;Sent record(key=%s value=%s) meta(partition=%d, offset=%d)\n&quot;,
                record.key(), record.value(), metadata.partition(), metadata.offset());
    }
});</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><strong>Callback</strong>: A callback function to handle success or failure of the send operation.</li>
<li><strong>metadata</strong>: Metadata about the sent record.</li>
<li><strong>exception</strong>: Exception thrown during the send operation.</li>
</ul>
</div><h1>6. Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Basic Producer</h2>
<div class='content'><p>Write a Kafka producer that sends 10 messages to a topic named &quot;test-topic&quot;.</p>
<h4>Solution:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Zm9yIChpbnQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7CiAgICBQcm9kdWNlclJlY29yZDxTdHJpbmcsIFN0cmluZz4gcmVjb3JkID0gbmV3IFByb2R1Y2VyUmVjb3JkPD4oInRlc3QtdG9waWMiLCAia2V5IiArIGksICJ2YWx1ZSIgKyBpKTsKICAgIHByb2R1Y2VyLnNlbmQocmVjb3JkKTsKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>for (int i = 0; i &lt; 10; i++) {
    ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(&quot;test-topic&quot;, &quot;key&quot; + i, &quot;value&quot; + i);
    producer.send(record);
}</pre></div><div class='content'></div><h2>Exercise 2: Error Handling</h2>
<div class='content'><p>Modify the producer to include error handling and retries.</p>
<h4>Solution:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJvcHMucHV0KFByb2R1Y2VyQ29uZmlnLlJFVFJJRVNfQ09ORklHLCAzKTsKCmZvciAoaW50IGkgPSAwOyBpIDwgMTA7IGkrKykgewogICAgUHJvZHVjZXJSZWNvcmQ8U3RyaW5nLCBTdHJpbmc+IHJlY29yZCA9IG5ldyBQcm9kdWNlclJlY29yZDw+KCJ0ZXN0LXRvcGljIiwgImtleSIgKyBpLCAidmFsdWUiICsgaSk7CiAgICBwcm9kdWNlci5zZW5kKHJlY29yZCwgKG1ldGFkYXRhLCBleGNlcHRpb24pIC0+IHsKICAgICAgICBpZiAoZXhjZXB0aW9uICE9IG51bGwpIHsKICAgICAgICAgICAgZXhjZXB0aW9uLnByaW50U3RhY2tUcmFjZSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRmKCJTZW50IHJlY29yZChrZXk9JXMgdmFsdWU9JXMpIG1ldGEocGFydGl0aW9uPSVkLCBvZmZzZXQ9JWQpXG4iLAogICAgICAgICAgICAgICAgICAgIHJlY29yZC5rZXkoKSwgcmVjb3JkLnZhbHVlKCksIG1ldGFkYXRhLnBhcnRpdGlvbigpLCBtZXRhZGF0YS5vZmZzZXQoKSk7CiAgICAgICAgfQogICAgfSk7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>props.put(ProducerConfig.RETRIES_CONFIG, 3);

for (int i = 0; i &lt; 10; i++) {
    ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(&quot;test-topic&quot;, &quot;key&quot; + i, &quot;value&quot; + i);
    producer.send(record, (metadata, exception) -&gt; {
        if (exception != null) {
            exception.printStackTrace();
        } else {
            System.out.printf(&quot;Sent record(key=%s value=%s) meta(partition=%d, offset=%d)\n&quot;,
                    record.key(), record.value(), metadata.partition(), metadata.offset());
        }
    });
}</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the basics of producing messages in Kafka. We learned how to set up a Kafka producer, configure it, and send messages to a Kafka topic. We also explored key configuration parameters and error handling mechanisms. By completing the practical exercises, you should now have a solid understanding of how to produce messages in Kafka. In the next section, we will focus on consuming messages from Kafka topics.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-messages-and-offsets' title="Messages and Offsets">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-02-consuming-messages' title="Consuming Messages">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
