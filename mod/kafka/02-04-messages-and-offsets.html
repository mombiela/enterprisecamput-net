<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    <title>Messages and Offsets</title>

    <link rel="alternate" href="https://campusempresa.com/mod/kafka/02-04-messages-and-offsets" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/kafka/02-04-messages-and-offsets" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/kafka/02-04-messages-and-offsets" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.ea63f62b9e.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "en";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "kafka";
  		var TEMA_NAME = "2-4";
  		var TYPE = "mod";
  		var PATH = "mod/kafka/02-04-messages-and-offsets";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.49d891d32f.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/kafka/02-04-messages-and-offsets" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/kafka/02-04-messages-and-offsets" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my_modules" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>My courses</b></i>
</a>
<a href="/end_modules" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Completed             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" style="display:none;" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="kafka">
		<a  href="#" class="text-secondary d-none" data-read-mod="kafka" data-read-unit="2-4" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Mark as read
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="kafka" data-unread-unit="2-4" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Mark as unread
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Course Content
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='02-03-brokers-and-clusters' title="Brokers and Clusters" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='02-03-brokers-and-clusters' title="Brokers and Clusters" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h2 style="text-decoration:underline">Messages and Offsets</h2>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='03-01-producing-messages' title="Producing Messages" class="py-2 px-3 btn btn-primary"
				data-read-mod="kafka" data-read-unit="2-4">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='03-01-producing-messages' title="Producing Messages" class="py-2 px-3 btn btn-primary" 
				data-read-mod="kafka" data-read-unit="2-4">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into the core concepts of messages and offsets in Kafka. Understanding these concepts is crucial for effectively producing and consuming data in Kafka.</p>
</div><h1>What is a Message?</h1>
<div class='content'><p>A message in Kafka is a unit of data. It is essentially a key-value pair that is written to and read from Kafka topics. Here are the key components of a Kafka message:</p>
<ul>
<li><strong>Key</strong>: An optional identifier for the message. It can be used to ensure that messages with the same key are sent to the same partition.</li>
<li><strong>Value</strong>: The actual data payload of the message.</li>
<li><strong>Timestamp</strong>: The time at which the message was produced.</li>
<li><strong>Headers</strong>: Optional metadata associated with the message.</li>
</ul>
</div><h2>Example of a Kafka Message</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJrZXkiOiAidXNlcjEyMyIsCiAgInZhbHVlIjogIlVzZXIgZGF0YSBmb3IgdXNlcjEyMyIsCiAgInRpbWVzdGFtcCI6IDE2MzMwMjQ4MDAwMDAsCiAgImhlYWRlcnMiOiB7CiAgICAic291cmNlIjogIndlYiIsCiAgICAidHlwZSI6ICJ1c2VyLXVwZGF0ZSIKICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;key&quot;: &quot;user123&quot;,
  &quot;value&quot;: &quot;User data for user123&quot;,
  &quot;timestamp&quot;: 1633024800000,
  &quot;headers&quot;: {
    &quot;source&quot;: &quot;web&quot;,
    &quot;type&quot;: &quot;user-update&quot;
  }
}</pre></div><div class='content'></div><h1>What is an Offset?</h1>
<div class='content'><p>An offset is a unique identifier assigned to each message within a partition. It is a sequential number that Kafka uses to keep track of the order of messages. Offsets are crucial for ensuring that messages are consumed in the correct order and for enabling consumers to resume reading from a specific point in the partition.</p>
</div><h2>Key Points about Offsets</h2>
<div class='content'><ul>
<li><strong>Sequential</strong>: Offsets are assigned in a sequential manner within a partition.</li>
<li><strong>Unique</strong>: Each message within a partition has a unique offset.</li>
<li><strong>Persistent</strong>: Offsets are stored persistently, allowing consumers to resume from the last read offset.</li>
</ul>
</div><h1>How Offsets Work</h1>
<div class='content'><p>When a producer sends a message to a Kafka topic, the message is appended to the end of a partition, and an offset is assigned to it. Consumers read messages from a partition by specifying the offset from which they want to start reading.</p>
</div><h2>Example of Offsets in a Partition</h2>
<div class='content'><table>
<thead>
<tr>
<th>Offset</th>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>user123</td>
<td>User data for user123</td>
</tr>
<tr>
<td>1</td>
<td>user456</td>
<td>User data for user456</td>
</tr>
<tr>
<td>2</td>
<td>user789</td>
<td>User data for user789</td>
</tr>
</tbody>
</table>
<p>In this example, the partition contains three messages with offsets 0, 1, and 2.</p>
</div><h1>Practical Example: Producing and Consuming Messages with Offsets</h1>
<div class='content'></div><h2>Producing Messages</h2>
<div class='content'><p>Let's produce some messages to a Kafka topic named <code>user-updates</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5wcm9kdWNlci5LYWZrYVByb2R1Y2VyOwppbXBvcnQgb3JnLmFwYWNoZS5rYWZrYS5jbGllbnRzLnByb2R1Y2VyLlByb2R1Y2VyUmVjb3JkOwppbXBvcnQgamF2YS51dGlsLlByb3BlcnRpZXM7CgpwdWJsaWMgY2xhc3MgUHJvZHVjZXJFeGFtcGxlIHsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBQcm9wZXJ0aWVzIHByb3BzID0gbmV3IFByb3BlcnRpZXMoKTsKICAgICAgICBwcm9wcy5wdXQoImJvb3RzdHJhcC5zZXJ2ZXJzIiwgImxvY2FsaG9zdDo5MDkyIik7CiAgICAgICAgcHJvcHMucHV0KCJrZXkuc2VyaWFsaXplciIsICJvcmcuYXBhY2hlLmthZmthLmNvbW1vbi5zZXJpYWxpemF0aW9uLlN0cmluZ1NlcmlhbGl6ZXIiKTsKICAgICAgICBwcm9wcy5wdXQoInZhbHVlLnNlcmlhbGl6ZXIiLCAib3JnLmFwYWNoZS5rYWZrYS5jb21tb24uc2VyaWFsaXphdGlvbi5TdHJpbmdTZXJpYWxpemVyIik7CgogICAgICAgIEthZmthUHJvZHVjZXI8U3RyaW5nLCBTdHJpbmc+IHByb2R1Y2VyID0gbmV3IEthZmthUHJvZHVjZXI8Pihwcm9wcyk7CgogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgMzsgaSsrKSB7CiAgICAgICAgICAgIFN0cmluZyBrZXkgPSAidXNlciIgKyBpOwogICAgICAgICAgICBTdHJpbmcgdmFsdWUgPSAiVXNlciBkYXRhIGZvciB1c2VyIiArIGk7CiAgICAgICAgICAgIFByb2R1Y2VyUmVjb3JkPFN0cmluZywgU3RyaW5nPiByZWNvcmQgPSBuZXcgUHJvZHVjZXJSZWNvcmQ8PigidXNlci11cGRhdGVzIiwga2V5LCB2YWx1ZSk7CiAgICAgICAgICAgIHByb2R1Y2VyLnNlbmQocmVjb3JkKTsKICAgICAgICB9CgogICAgICAgIHByb2R1Y2VyLmNsb3NlKCk7CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.producer.KafkaProducer;
import org.apache.kafka.clients.producer.ProducerRecord;
import java.util.Properties;

public class ProducerExample {
    public static void main(String[] args) {
        Properties props = new Properties();
        props.put(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
        props.put(&quot;key.serializer&quot;, &quot;org.apache.kafka.common.serialization.StringSerializer&quot;);
        props.put(&quot;value.serializer&quot;, &quot;org.apache.kafka.common.serialization.StringSerializer&quot;);

        KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(props);

        for (int i = 0; i &lt; 3; i++) {
            String key = &quot;user&quot; + i;
            String value = &quot;User data for user&quot; + i;
            ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(&quot;user-updates&quot;, key, value);
            producer.send(record);
        }

        producer.close();
    }
}</pre></div><div class='content'></div><h2>Consuming Messages</h2>
<div class='content'><p>Now, let's consume the messages from the <code>user-updates</code> topic.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5Db25zdW1lclJlY29yZDsKaW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5Db25zdW1lclJlY29yZHM7CmltcG9ydCBvcmcuYXBhY2hlLmthZmthLmNsaWVudHMuY29uc3VtZXIuS2Fma2FDb25zdW1lcjsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5Qcm9wZXJ0aWVzOwoKcHVibGljIGNsYXNzIENvbnN1bWVyRXhhbXBsZSB7CiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7CiAgICAgICAgUHJvcGVydGllcyBwcm9wcyA9IG5ldyBQcm9wZXJ0aWVzKCk7CiAgICAgICAgcHJvcHMucHV0KCJib290c3RyYXAuc2VydmVycyIsICJsb2NhbGhvc3Q6OTA5MiIpOwogICAgICAgIHByb3BzLnB1dCgiZ3JvdXAuaWQiLCAidXNlci11cGRhdGUtZ3JvdXAiKTsKICAgICAgICBwcm9wcy5wdXQoImtleS5kZXNlcmlhbGl6ZXIiLCAib3JnLmFwYWNoZS5rYWZrYS5jb21tb24uc2VyaWFsaXphdGlvbi5TdHJpbmdEZXNlcmlhbGl6ZXIiKTsKICAgICAgICBwcm9wcy5wdXQoInZhbHVlLmRlc2VyaWFsaXplciIsICJvcmcuYXBhY2hlLmthZmthLmNvbW1vbi5zZXJpYWxpemF0aW9uLlN0cmluZ0Rlc2VyaWFsaXplciIpOwoKICAgICAgICBLYWZrYUNvbnN1bWVyPFN0cmluZywgU3RyaW5nPiBjb25zdW1lciA9IG5ldyBLYWZrYUNvbnN1bWVyPD4ocHJvcHMpOwogICAgICAgIGNvbnN1bWVyLnN1YnNjcmliZShDb2xsZWN0aW9ucy5zaW5nbGV0b25MaXN0KCJ1c2VyLXVwZGF0ZXMiKSk7CgogICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgIENvbnN1bWVyUmVjb3JkczxTdHJpbmcsIFN0cmluZz4gcmVjb3JkcyA9IGNvbnN1bWVyLnBvbGwoMTAwKTsKICAgICAgICAgICAgZm9yIChDb25zdW1lclJlY29yZDxTdHJpbmcsIFN0cmluZz4gcmVjb3JkIDogcmVjb3JkcykgewogICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGYoIk9mZnNldDogJWQsIEtleTogJXMsIFZhbHVlOiAlcyVuIiwgcmVjb3JkLm9mZnNldCgpLCByZWNvcmQua2V5KCksIHJlY29yZC52YWx1ZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.consumer.ConsumerRecord;
import org.apache.kafka.clients.consumer.ConsumerRecords;
import org.apache.kafka.clients.consumer.KafkaConsumer;
import java.util.Collections;
import java.util.Properties;

public class ConsumerExample {
    public static void main(String[] args) {
        Properties props = new Properties();
        props.put(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
        props.put(&quot;group.id&quot;, &quot;user-update-group&quot;);
        props.put(&quot;key.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);
        props.put(&quot;value.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);

        KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props);
        consumer.subscribe(Collections.singletonList(&quot;user-updates&quot;));

        while (true) {
            ConsumerRecords&lt;String, String&gt; records = consumer.poll(100);
            for (ConsumerRecord&lt;String, String&gt; record : records) {
                System.out.printf(&quot;Offset: %d, Key: %s, Value: %s%n&quot;, record.offset(), record.key(), record.value());
            }
        }
    }
}</pre></div><div class='content'></div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Produce and Consume Messages</h2>
<div class='content'><ol>
<li><strong>Task</strong>: Write a producer that sends 5 messages to a topic named <code>test-topic</code>. Each message should have a unique key and value.</li>
<li><strong>Task</strong>: Write a consumer that reads messages from <code>test-topic</code> and prints the offset, key, and value of each message.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><h4>Producer</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5wcm9kdWNlci5LYWZrYVByb2R1Y2VyOwppbXBvcnQgb3JnLmFwYWNoZS5rYWZrYS5jbGllbnRzLnByb2R1Y2VyLlByb2R1Y2VyUmVjb3JkOwppbXBvcnQgamF2YS51dGlsLlByb3BlcnRpZXM7CgpwdWJsaWMgY2xhc3MgVGVzdFByb2R1Y2VyIHsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBQcm9wZXJ0aWVzIHByb3BzID0gbmV3IFByb3BlcnRpZXMoKTsKICAgICAgICBwcm9wcy5wdXQoImJvb3RzdHJhcC5zZXJ2ZXJzIiwgImxvY2FsaG9zdDo5MDkyIik7CiAgICAgICAgcHJvcHMucHV0KCJrZXkuc2VyaWFsaXplciIsICJvcmcuYXBhY2hlLmthZmthLmNvbW1vbi5zZXJpYWxpemF0aW9uLlN0cmluZ1NlcmlhbGl6ZXIiKTsKICAgICAgICBwcm9wcy5wdXQoInZhbHVlLnNlcmlhbGl6ZXIiLCAib3JnLmFwYWNoZS5rYWZrYS5jb21tb24uc2VyaWFsaXphdGlvbi5TdHJpbmdTZXJpYWxpemVyIik7CgogICAgICAgIEthZmthUHJvZHVjZXI8U3RyaW5nLCBTdHJpbmc+IHByb2R1Y2VyID0gbmV3IEthZmthUHJvZHVjZXI8Pihwcm9wcyk7CgogICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgNTsgaSsrKSB7CiAgICAgICAgICAgIFN0cmluZyBrZXkgPSAia2V5IiArIGk7CiAgICAgICAgICAgIFN0cmluZyB2YWx1ZSA9ICJ2YWx1ZSIgKyBpOwogICAgICAgICAgICBQcm9kdWNlclJlY29yZDxTdHJpbmcsIFN0cmluZz4gcmVjb3JkID0gbmV3IFByb2R1Y2VyUmVjb3JkPD4oInRlc3QtdG9waWMiLCBrZXksIHZhbHVlKTsKICAgICAgICAgICAgcHJvZHVjZXIuc2VuZChyZWNvcmQpOwogICAgICAgIH0KCiAgICAgICAgcHJvZHVjZXIuY2xvc2UoKTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.producer.KafkaProducer;
import org.apache.kafka.clients.producer.ProducerRecord;
import java.util.Properties;

public class TestProducer {
    public static void main(String[] args) {
        Properties props = new Properties();
        props.put(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
        props.put(&quot;key.serializer&quot;, &quot;org.apache.kafka.common.serialization.StringSerializer&quot;);
        props.put(&quot;value.serializer&quot;, &quot;org.apache.kafka.common.serialization.StringSerializer&quot;);

        KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(props);

        for (int i = 0; i &lt; 5; i++) {
            String key = &quot;key&quot; + i;
            String value = &quot;value&quot; + i;
            ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(&quot;test-topic&quot;, key, value);
            producer.send(record);
        }

        producer.close();
    }
}</pre></div><div class='content'><h4>Consumer</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5Db25zdW1lclJlY29yZDsKaW1wb3J0IG9yZy5hcGFjaGUua2Fma2EuY2xpZW50cy5jb25zdW1lci5Db25zdW1lclJlY29yZHM7CmltcG9ydCBvcmcuYXBhY2hlLmthZmthLmNsaWVudHMuY29uc3VtZXIuS2Fma2FDb25zdW1lcjsKaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsKaW1wb3J0IGphdmEudXRpbC5Qcm9wZXJ0aWVzOwoKcHVibGljIGNsYXNzIFRlc3RDb25zdW1lciB7CiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7CiAgICAgICAgUHJvcGVydGllcyBwcm9wcyA9IG5ldyBQcm9wZXJ0aWVzKCk7CiAgICAgICAgcHJvcHMucHV0KCJib290c3RyYXAuc2VydmVycyIsICJsb2NhbGhvc3Q6OTA5MiIpOwogICAgICAgIHByb3BzLnB1dCgiZ3JvdXAuaWQiLCAidGVzdC1ncm91cCIpOwogICAgICAgIHByb3BzLnB1dCgia2V5LmRlc2VyaWFsaXplciIsICJvcmcuYXBhY2hlLmthZmthLmNvbW1vbi5zZXJpYWxpemF0aW9uLlN0cmluZ0Rlc2VyaWFsaXplciIpOwogICAgICAgIHByb3BzLnB1dCgidmFsdWUuZGVzZXJpYWxpemVyIiwgIm9yZy5hcGFjaGUua2Fma2EuY29tbW9uLnNlcmlhbGl6YXRpb24uU3RyaW5nRGVzZXJpYWxpemVyIik7CgogICAgICAgIEthZmthQ29uc3VtZXI8U3RyaW5nLCBTdHJpbmc+IGNvbnN1bWVyID0gbmV3IEthZmthQ29uc3VtZXI8Pihwcm9wcyk7CiAgICAgICAgY29uc3VtZXIuc3Vic2NyaWJlKENvbGxlY3Rpb25zLnNpbmdsZXRvbkxpc3QoInRlc3QtdG9waWMiKSk7CgogICAgICAgIHdoaWxlICh0cnVlKSB7CiAgICAgICAgICAgIENvbnN1bWVyUmVjb3JkczxTdHJpbmcsIFN0cmluZz4gcmVjb3JkcyA9IGNvbnN1bWVyLnBvbGwoMTAwKTsKICAgICAgICAgICAgZm9yIChDb25zdW1lclJlY29yZDxTdHJpbmcsIFN0cmluZz4gcmVjb3JkIDogcmVjb3JkcykgewogICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGYoIk9mZnNldDogJWQsIEtleTogJXMsIFZhbHVlOiAlcyVuIiwgcmVjb3JkLm9mZnNldCgpLCByZWNvcmQua2V5KCksIHJlY29yZC52YWx1ZSgpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.kafka.clients.consumer.ConsumerRecord;
import org.apache.kafka.clients.consumer.ConsumerRecords;
import org.apache.kafka.clients.consumer.KafkaConsumer;
import java.util.Collections;
import java.util.Properties;

public class TestConsumer {
    public static void main(String[] args) {
        Properties props = new Properties();
        props.put(&quot;bootstrap.servers&quot;, &quot;localhost:9092&quot;);
        props.put(&quot;group.id&quot;, &quot;test-group&quot;);
        props.put(&quot;key.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);
        props.put(&quot;value.deserializer&quot;, &quot;org.apache.kafka.common.serialization.StringDeserializer&quot;);

        KafkaConsumer&lt;String, String&gt; consumer = new KafkaConsumer&lt;&gt;(props);
        consumer.subscribe(Collections.singletonList(&quot;test-topic&quot;));

        while (true) {
            ConsumerRecords&lt;String, String&gt; records = consumer.poll(100);
            for (ConsumerRecord&lt;String, String&gt; record : records) {
                System.out.printf(&quot;Offset: %d, Key: %s, Value: %s%n&quot;, record.offset(), record.key(), record.value());
            }
        }
    }
}</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Mistake</strong>: Not closing the producer after sending messages.
<ul>
<li><strong>Tip</strong>: Always close the producer to ensure all messages are flushed and sent.</li>
</ul>
</li>
<li><strong>Mistake</strong>: Not handling exceptions in producer and consumer code.
<ul>
<li><strong>Tip</strong>: Implement proper exception handling to manage errors gracefully.</li>
</ul>
</li>
<li><strong>Mistake</strong>: Using the same group ID for different consumers that should not share offsets.
<ul>
<li><strong>Tip</strong>: Use unique group IDs for different consumer groups to avoid offset conflicts.</li>
</ul>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the fundamental concepts of messages and offsets in Kafka. We learned how messages are structured, how offsets work, and how to produce and consume messages using Java. Understanding these concepts is essential for working effectively with Kafka. In the next section, we will explore Kafka operations in more detail, including producing and consuming messages programmatically.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='02-03-brokers-and-clusters' title="Brokers and Clusters" class="py-2 px-3 btn btn-primary">
				&#x25C4; Previous 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='02-03-brokers-and-clusters' title="Brokers and Clusters" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='03-01-producing-messages' title="Producing Messages" class="py-2 px-3 btn btn-primary"
				data-read-mod="kafka" data-read-unit="2-4">
				Next &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='03-01-producing-messages' title="Producing Messages" class="py-2 px-3 btn btn-primary" 
				data-read-mod="kafka" data-read-unit="2-4">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Kafka Course</h1>
<h2>Module 1: Introduction to Kafka</h2>
<ul>
<li><a href="01-01-what-is-kafka">What is Kafka?</a></li>
<li><a href="01-02-kafka-use-cases">Kafka Use Cases</a></li>
<li><a href="01-03-kafka-architecture-overview">Kafka Architecture Overview</a></li>
<li><a href="01-04-setting-up-kafka">Setting Up Kafka</a></li>
</ul>
<h2>Module 2: Kafka Core Concepts</h2>
<ul>
<li><a href="02-01-producers-and-consumers">Producers and Consumers</a></li>
<li><a href="02-02-topics-and-partitions">Topics and Partitions</a></li>
<li><a href="02-03-brokers-and-clusters">Brokers and Clusters</a></li>
<li><a href="02-04-messages-and-offsets">Messages and Offsets</a></li>
</ul>
<h2>Module 3: Kafka Operations</h2>
<ul>
<li><a href="03-01-producing-messages">Producing Messages</a></li>
<li><a href="03-02-consuming-messages">Consuming Messages</a></li>
<li><a href="03-03-kafka-connect">Kafka Connect</a></li>
<li><a href="03-04-kafka-streams">Kafka Streams</a></li>
</ul>
<h2>Module 4: Kafka Configuration and Management</h2>
<ul>
<li><a href="04-01-configuring-kafka">Configuring Kafka</a></li>
<li><a href="04-02-managing-kafka-topics">Managing Kafka Topics</a></li>
<li><a href="04-03-monitoring-kafka">Monitoring Kafka</a></li>
<li><a href="04-04-kafka-security">Kafka Security</a></li>
</ul>
<h2>Module 5: Advanced Kafka Topics</h2>
<ul>
<li><a href="05-01-kafka-performance-tuning">Kafka Performance Tuning</a></li>
<li><a href="05-02-kafka-multi-data-center">Kafka in a Multi-Data Center Setup</a></li>
<li><a href="05-03-kafka-schema-registry">Kafka with Schema Registry</a></li>
<li><a href="05-04-kafka-streams-advanced">Kafka Streams Advanced</a></li>
</ul>
<h2>Module 6: Kafka Ecosystem and Integrations</h2>
<ul>
<li><a href="06-01-kafka-hadoop">Kafka with Hadoop</a></li>
<li><a href="06-02-kafka-spark">Kafka with Spark</a></li>
<li><a href="06-03-kafka-flink">Kafka with Flink</a></li>
<li><a href="06-04-kafka-elasticsearch">Kafka with Elasticsearch</a></li>
</ul>
<h2>Module 7: Kafka Case Studies and Best Practices</h2>
<ul>
<li><a href="07-01-real-world-kafka-use-cases">Real-World Kafka Use Cases</a></li>
<li><a href="07-02-kafka-best-practices">Kafka Best Practices</a></li>
<li><a href="07-03-common-kafka-pitfalls">Common Kafka Pitfalls</a></li>
<li><a href="07-04-future-of-kafka">Future of Kafka</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">User not authenticated</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<p id="loginModalEmail"></p>
            	<div id="mensaje" class="d-none alert alert-danger"></div>
            	<div id="mensaje_info" class="d-none alert alert-success"></div>
            	
            	<div id="modal-body-main">
					<div class="mt-4 d-none" id="forgotPasswordSection">
						<div class="mb-3">
    <label for="recovery-email" class="form-label">Email</label>
    <input type="email" required class="form-control" id="recovery-email" placeholder="Enter your email">
</div>
<button class="btn btn-primary" id="btnRecover">Send recovery link</button>

					</div>
									
					<div class="mt-4 d-none" id="deleteUserSection">	
						<div class="mb-3 alert alert-danger">
	Warning! You are about to delete all registration and progress data.<br><b>This action cannot be undone.</b>
</div>
<div class="mb-3">
    <input type="password" required class="form-control" id="delete-user-pwd" placeholder="Enter your password">
</div>
<button class="btn btn-primary" id="btnDeleteUser">Delete user</button>

					</div>
					
					<div class="mt-4 d-none" id="changePassordSection">
						<div class="mb-3 row">
	<div class="col col-12 my-2">
	    <input type="password" required class="form-control" id="change-pwd-actual" placeholder="Enter current password">
	</div>
	<div class="col col-12 my-2">
    	<input type="password" required class="form-control" id="change-pwd-new-1" placeholder="Enter new password">
	</div>
	<div class="col col-12 my-2">
    	<input type="password" required class="form-control" id="change-pwd-new-2" placeholder="Repeat new password">
	</div>
</div>
<button class="btn btn-primary" id="btnChangePassword">Change password</button>

					</div>
					
					<div class="mt-4 d-none alert alert-warning" id="verifyPasswordSection">
						<p><b>Falta verificar correu</b></p>
						<a id="btnVerifyEmail" href="#">Send verification link</a>

					</div>
					
					<div class="mt-4 d-none" id="disconnectUserSection">
						<div class="mb-3">
    <button id="btnDisconnect" class="btn btn-primary">Disconnect</button>
</div>

<hr>

<div class="mt-3">
    <button class="btn btn-outline-secondary" id="change-password-link">Change password</button>
</div>

<div class="mt-3">
    <a href="#" id="delete-user-link">Delete user</a>
</div>

					</div>
	            
	            	<div class="mt-4 d-none" id="modalTabsSection">
	            		<ul class="nav nav-tabs" id="authTabs" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="login-tab" data-bs-toggle="tab" data-bs-target="#login" type="button" role="tab" aria-controls="login" aria-selected="true">
        	Log in
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="register-tab" data-bs-toggle="tab" data-bs-target="#register" type="button" role="tab" aria-controls="register" aria-selected="false">
        	Sign up
        </button>
    </li>
</ul>

<div class="tab-content mt-3" id="authTabsContent">
    <div class="tab-pane fade show active" id="login" role="tabpanel" aria-labelledby="login-tab">
    	<div class="mb-3">
    <label for="login-username" class="form-label">Email</label>
    <input type="email" required class="form-control" id="login-username" placeholder="Enter your email">
</div>
<div class="mb-3">
    <label for="login-password" class="form-label">Password</label>
    <input type="password"  required class="form-control" id="login-password" placeholder="Enter your password">
</div>
<button class="btn btn-primary" id="btnLogin">Log in</button>
<div class="mt-3">
    <a href="#" id="forgot-password-link">Have you forgotten your password?</a>
</div>
    </div>

    <div class="tab-pane fade" id="register" role="tabpanel" aria-labelledby="register-tab">
    	<div class="mb-3">
    <label for="register-email" class="form-label">Email</label>
    <input type="email" class="form-control" id="register-email" required placeholder="Enter your email">
</div>

<div class="mb-3">
    <label for="register-password" class="form-label">Password</label>
    <input type="password" class="form-control"  required id="register-password" placeholder="Enter your password">
</div>

<div class="mb-3">
    <label for="register-name" class="form-label">Name</label>
    <input type="text" class="form-control"  required id="register-name" placeholder="Enter your name">
</div>

<div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" id="accept-conditions-reg">
    <label for="accept-conditions-reg" class="form-check-label">
        I have read and accept the <a href="/privacity" target="blank">Privacy Policy</a> and the <a href="/licence" target="blank">Terms and Conditions of Use</a>.
    </label>
</div>

<div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" id="accept-allow_comunications">
    <label for="accept-allow_comunications" class="form-check-label">
        I wish to receive news and updates about courses (optional).
    </label>
</div>

<button id="btnRegister" class="btn btn-primary">Sign up</button>
    </div>
</div>
	            	</div>
            	</div>
            </div>
        </div>
    </div>
</div>

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
