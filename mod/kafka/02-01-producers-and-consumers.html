<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Producers and Consumers</title>

    <link rel="alternate" href="https://campusempresa.com/mod/kafka/02-01-producers-and-consumers" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/kafka/02-01-producers-and-consumers" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/kafka/02-01-producers-and-consumers" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=3" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/kafka/02-01-producers-and-consumers" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/kafka/02-01-producers-and-consumers" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>Building today's and tomorrow's society</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Languages</a>
				 					<a href="/categ/frameworks">Frameworks</a>
				 					<a href="/categ/tech-tools">Tools</a>
				 					<a href="/categ/foundations">Foundations</a>
				 					<a href="/categ/soft-skills">Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='01-04-setting-up-kafka' title="Setting Up Kafka">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Producers and Consumers</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='02-02-topics-and-partitions' title="Topics and Partitions">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into the core concepts of Kafka producers and consumers. Understanding these components is crucial for effectively working with Kafka, as they form the backbone of Kafka's messaging system.</p>
</div><h1><p>What are Producers and Consumers?</p>
</h1>
<div class='content'></div><h2><p>Producers</p>
</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: Producers are applications that send (or produce) messages to Kafka topics.</li>
<li><strong>Functionality</strong>: They are responsible for creating and sending data to Kafka. Producers can send data to one or more topics.</li>
<li><strong>Key Characteristics</strong>:
<ul>
<li><strong>Asynchronous</strong>: Producers can send messages asynchronously, allowing for high throughput.</li>
<li><strong>Partitioning</strong>: Producers can specify the partition to which a message should be sent, or Kafka can determine the partition based on a partitioning strategy.</li>
<li><strong>Acknowledgments</strong>: Producers can be configured to wait for acknowledgments from Kafka brokers to ensure message delivery.</li>
</ul>
</li>
</ul>
</div><h2><p>Consumers</p>
</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: Consumers are applications that read (or consume) messages from Kafka topics.</li>
<li><strong>Functionality</strong>: They subscribe to one or more topics and process the messages produced to those topics.</li>
<li><strong>Key Characteristics</strong>:
<ul>
<li><strong>Consumer Groups</strong>: Consumers can be part of a consumer group. Each message is delivered to one consumer within the group, enabling load balancing.</li>
<li><strong>Offset Management</strong>: Consumers keep track of the messages they have read using offsets. This allows them to resume reading from where they left off in case of a failure.</li>
</ul>
</li>
</ul>
</div><h1><p>How Producers and Consumers Work</p>
</h1>
<div class='content'></div><h2><p>Producers</p>
</h2>
<div class='content'><ol>
<li><strong>Create a Producer Instance</strong>: Initialize a producer with the necessary configurations.</li>
<li><strong>Send Messages</strong>: Use the producer instance to send messages to a specified topic.</li>
<li><strong>Handle Acknowledgments</strong>: Optionally, handle acknowledgments to ensure message delivery.</li>
</ol>
</div><h2><p>Consumers</p>
</h2>
<div class='content'><ol>
<li><strong>Create a Consumer Instance</strong>: Initialize a consumer with the necessary configurations.</li>
<li><strong>Subscribe to Topics</strong>: Subscribe to one or more topics to start receiving messages.</li>
<li><strong>Poll for Messages</strong>: Continuously poll Kafka for new messages.</li>
<li><strong>Process Messages</strong>: Process the received messages.</li>
<li><strong>Commit Offsets</strong>: Commit the offsets of the processed messages to keep track of the consumer's progress.</li>
</ol>
</div><h1><p>Practical Example</p>
</h1>
<div class='content'></div><h2><p>Producer Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBrYWZrYSBpbXBvcnQgS2Fma2FQcm9kdWNlcgoKIyBDcmVhdGUgYSBLYWZrYSBwcm9kdWNlciBpbnN0YW5jZQpwcm9kdWNlciA9IEthZmthUHJvZHVjZXIoYm9vdHN0cmFwX3NlcnZlcnM9J2xvY2FsaG9zdDo5MDkyJykKCiMgU2VuZCBhIG1lc3NhZ2UgdG8gdGhlICd0ZXN0LXRvcGljJyB0b3BpYwpwcm9kdWNlci5zZW5kKCd0ZXN0LXRvcGljJywgYidIZWxsbywgS2Fma2EhJykKCiMgRW5zdXJlIGFsbCBtZXNzYWdlcyBhcmUgc2VudCBiZWZvcmUgY2xvc2luZyB0aGUgcHJvZHVjZXIKcHJvZHVjZXIuZmx1c2goKQpwcm9kdWNlci5jbG9zZSgp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from kafka import KafkaProducer

# Create a Kafka producer instance
producer = KafkaProducer(bootstrap_servers='localhost:9092')

# Send a message to the 'test-topic' topic
producer.send('test-topic', b'Hello, Kafka!')

# Ensure all messages are sent before closing the producer
producer.flush()
producer.close()</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>KafkaProducer</code>: Initializes a producer instance.</li>
<li><code>bootstrap_servers</code>: Specifies the Kafka broker address.</li>
<li><code>send</code>: Sends a message to the specified topic.</li>
<li><code>flush</code>: Ensures all messages are sent.</li>
<li><code>close</code>: Closes the producer instance.</li>
</ul>
</div><h2><p>Consumer Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBrYWZrYSBpbXBvcnQgS2Fma2FDb25zdW1lcgoKIyBDcmVhdGUgYSBLYWZrYSBjb25zdW1lciBpbnN0YW5jZQpjb25zdW1lciA9IEthZmthQ29uc3VtZXIoJ3Rlc3QtdG9waWMnLCBib290c3RyYXBfc2VydmVycz0nbG9jYWxob3N0OjkwOTInLCBhdXRvX29mZnNldF9yZXNldD0nZWFybGllc3QnLCBncm91cF9pZD0nbXktZ3JvdXAnKQoKIyBDb250aW51b3VzbHkgcG9sbCBmb3IgbmV3IG1lc3NhZ2VzCmZvciBtZXNzYWdlIGluIGNvbnN1bWVyOgogICAgcHJpbnQoZiJSZWNlaXZlZCBtZXNzYWdlOiB7bWVzc2FnZS52YWx1ZS5kZWNvZGUoJ3V0Zi04Jyl9IikKCiMgQ2xvc2UgdGhlIGNvbnN1bWVyIGluc3RhbmNlCmNvbnN1bWVyLmNsb3NlKCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from kafka import KafkaConsumer

# Create a Kafka consumer instance
consumer = KafkaConsumer('test-topic', bootstrap_servers='localhost:9092', auto_offset_reset='earliest', group_id='my-group')

# Continuously poll for new messages
for message in consumer:
    print(f&quot;Received message: {message.value.decode('utf-8')}&quot;)

# Close the consumer instance
consumer.close()</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>KafkaConsumer</code>: Initializes a consumer instance.</li>
<li><code>auto_offset_reset</code>: Specifies where to start reading messages if no offset is found.</li>
<li><code>group_id</code>: Specifies the consumer group ID.</li>
<li><code>for message in consumer</code>: Continuously polls for new messages.</li>
<li><code>message.value.decode('utf-8')</code>: Decodes the message value from bytes to a string.</li>
<li><code>close</code>: Closes the consumer instance.</li>
</ul>
</div><h1><p>Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Create a Producer</p>
</h2>
<div class='content'><ol>
<li>Initialize a Kafka producer.</li>
<li>Send a message to a topic named <code>exercise-topic</code>.</li>
<li>Ensure the message is sent and close the producer.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBrYWZrYSBpbXBvcnQgS2Fma2FQcm9kdWNlcgoKcHJvZHVjZXIgPSBLYWZrYVByb2R1Y2VyKGJvb3RzdHJhcF9zZXJ2ZXJzPSdsb2NhbGhvc3Q6OTA5MicpCnByb2R1Y2VyLnNlbmQoJ2V4ZXJjaXNlLXRvcGljJywgYidUaGlzIGlzIGEgdGVzdCBtZXNzYWdlJykKcHJvZHVjZXIuZmx1c2goKQpwcm9kdWNlci5jbG9zZSgp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from kafka import KafkaProducer

producer = KafkaProducer(bootstrap_servers='localhost:9092')
producer.send('exercise-topic', b'This is a test message')
producer.flush()
producer.close()</pre></div><div class='content'></div><h2><p>Exercise 2: Create a Consumer</p>
</h2>
<div class='content'><ol>
<li>Initialize a Kafka consumer.</li>
<li>Subscribe to the <code>exercise-topic</code>.</li>
<li>Print the messages received from the topic.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBrYWZrYSBpbXBvcnQgS2Fma2FDb25zdW1lcgoKY29uc3VtZXIgPSBLYWZrYUNvbnN1bWVyKCdleGVyY2lzZS10b3BpYycsIGJvb3RzdHJhcF9zZXJ2ZXJzPSdsb2NhbGhvc3Q6OTA5MicsIGF1dG9fb2Zmc2V0X3Jlc2V0PSdlYXJsaWVzdCcsIGdyb3VwX2lkPSdleGVyY2lzZS1ncm91cCcpCgpmb3IgbWVzc2FnZSBpbiBjb25zdW1lcjoKICAgIHByaW50KGYiUmVjZWl2ZWQgbWVzc2FnZToge21lc3NhZ2UudmFsdWUuZGVjb2RlKCd1dGYtOCcpfSIpCgpjb25zdW1lci5jbG9zZSgp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from kafka import KafkaConsumer

consumer = KafkaConsumer('exercise-topic', bootstrap_servers='localhost:9092', auto_offset_reset='earliest', group_id='exercise-group')

for message in consumer:
    print(f&quot;Received message: {message.value.decode('utf-8')}&quot;)

consumer.close()</pre></div><div class='content'></div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Producer Configuration</strong>: Ensure the <code>bootstrap_servers</code> configuration is correct. Incorrect broker addresses will prevent the producer from connecting.</li>
<li><strong>Consumer Offsets</strong>: Always manage offsets properly to avoid reprocessing messages or missing messages.</li>
<li><strong>Error Handling</strong>: Implement error handling in both producers and consumers to handle network issues, broker failures, etc.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered the fundamental concepts of Kafka producers and consumers. We learned how to create and configure producers and consumers, send and receive messages, and manage offsets. Understanding these concepts is essential for building robust Kafka applications. In the next section, we will explore topics and partitions, which are crucial for organizing and distributing messages in Kafka.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='01-04-setting-up-kafka' title="Setting Up Kafka">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='02-02-topics-and-partitions' title="Topics and Partitions">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
