<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kafka Message Format</title>

    <link rel="alternate" href="https://campusempresa.com/mod/kafka/kafka-message-format" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/kafka/kafka-message-format" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/kafka/kafka-message-format" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/kafka/kafka-message-format" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/kafka/kafka-message-format" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='kafka-brokers-and-clusters'>&#x25C4;Kafka Brokers and Clusters</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Kafka Message Format</a>
	</div>
	<div class='col-4 text-end'>
					<a href='producer-api-overview'>Producer API Overview &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Apache Kafka is a distributed streaming platform that allows you to publish and subscribe to streams of records. Understanding the Kafka message format is crucial for efficiently producing and consuming messages. This section will cover the structure of Kafka messages, key concepts, and provide examples to help you grasp the fundamentals.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Message</strong>: The basic unit of data in Kafka, also known as a record.</li>
<li><strong>Producer</strong>: The client application that sends records to a Kafka topic.</li>
<li><strong>Consumer</strong>: The client application that reads records from a Kafka topic.</li>
<li><strong>Topic</strong>: A category or feed name to which records are sent by producers.</li>
<li><strong>Partition</strong>: A division of a topic, allowing for parallel processing.</li>
</ul>
</div><h1>Kafka Message Structure</h1>
<div class='content'><p>A Kafka message consists of several components:</p>
<ol>
<li><strong>Key</strong>: An optional identifier for the message, used for partitioning.</li>
<li><strong>Value</strong>: The actual data payload of the message.</li>
<li><strong>Headers</strong>: Optional metadata for the message.</li>
<li><strong>Timestamp</strong>: The time at which the message was produced.</li>
<li><strong>Offset</strong>: A unique identifier for the message within a partition.</li>
</ol>
</div><h2>Message Components</h2>
<div class='content'><ul>
<li><strong>Key</strong>: Helps in determining the partition to which the message will be sent. If no key is provided, Kafka uses a round-robin approach.</li>
<li><strong>Value</strong>: The main content of the message, which can be any type of data (e.g., JSON, XML, Avro).</li>
<li><strong>Headers</strong>: Key-value pairs that provide additional context or metadata.</li>
<li><strong>Timestamp</strong>: Can be set by the producer or Kafka itself.</li>
<li><strong>Offset</strong>: Automatically assigned by Kafka, ensuring each message has a unique identifier within its partition.</li>
</ul>
</div><h1>Example: Producing a Kafka Message</h1>
<div class='content'><p>Below is an example of producing a Kafka message in Python using the <code>kafka-python</code> library.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBrYWZrYSBpbXBvcnQgS2Fma2FQcm9kdWNlcgppbXBvcnQganNvbgoKIyBJbml0aWFsaXplIHRoZSBLYWZrYSBwcm9kdWNlcgpwcm9kdWNlciA9IEthZmthUHJvZHVjZXIoCiAgICBib290c3RyYXBfc2VydmVycz0nbG9jYWxob3N0OjkwOTInLAogICAgdmFsdWVfc2VyaWFsaXplcj1sYW1iZGEgdjoganNvbi5kdW1wcyh2KS5lbmNvZGUoJ3V0Zi04JykKKQoKIyBEZWZpbmUgdGhlIG1lc3NhZ2UKbWVzc2FnZSA9IHsKICAgICdrZXknOiAndXNlcjEyMycsCiAgICAndmFsdWUnOiB7J2V2ZW50JzogJ2xvZ2luJywgJ3RpbWVzdGFtcCc6ICcyMDIzLTEwLTAxVDEyOjAwOjAwWid9Cn0KCiMgU2VuZCB0aGUgbWVzc2FnZSB0byB0aGUgJ3VzZXItZXZlbnRzJyB0b3BpYwpwcm9kdWNlci5zZW5kKCd1c2VyLWV2ZW50cycsIGtleT1tZXNzYWdlWydrZXknXS5lbmNvZGUoJ3V0Zi04JyksIHZhbHVlPW1lc3NhZ2VbJ3ZhbHVlJ10pCgojIEVuc3VyZSBhbGwgbWVzc2FnZXMgYXJlIHNlbnQgYmVmb3JlIGNsb3NpbmcgdGhlIHByb2R1Y2VyCnByb2R1Y2VyLmZsdXNoKCkKcHJvZHVjZXIuY2xvc2UoKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from kafka import KafkaProducer
import json

# Initialize the Kafka producer
producer = KafkaProducer(
    bootstrap_servers='localhost:9092',
    value_serializer=lambda v: json.dumps(v).encode('utf-8')
)

# Define the message
message = {
    'key': 'user123',
    'value': {'event': 'login', 'timestamp': '2023-10-01T12:00:00Z'}
}

# Send the message to the 'user-events' topic
producer.send('user-events', key=message['key'].encode('utf-8'), value=message['value'])

# Ensure all messages are sent before closing the producer
producer.flush()
producer.close()</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>KafkaProducer</strong>: Initializes the producer with the Kafka broker address and a serializer for the message value.</li>
<li><strong>message</strong>: Defines the message with a key and value.</li>
<li><strong>producer.send</strong>: Sends the message to the specified topic.</li>
<li><strong>producer.flush</strong>: Ensures all buffered messages are sent.</li>
<li><strong>producer.close</strong>: Closes the producer connection.</li>
</ul>
</div><h1>Example: Consuming a Kafka Message</h1>
<div class='content'><p>Below is an example of consuming a Kafka message in Python using the <code>kafka-python</code> library.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBrYWZrYSBpbXBvcnQgS2Fma2FDb25zdW1lcgppbXBvcnQganNvbgoKIyBJbml0aWFsaXplIHRoZSBLYWZrYSBjb25zdW1lcgpjb25zdW1lciA9IEthZmthQ29uc3VtZXIoCiAgICAndXNlci1ldmVudHMnLAogICAgYm9vdHN0cmFwX3NlcnZlcnM9J2xvY2FsaG9zdDo5MDkyJywKICAgIGF1dG9fb2Zmc2V0X3Jlc2V0PSdlYXJsaWVzdCcsCiAgICB2YWx1ZV9kZXNlcmlhbGl6ZXI9bGFtYmRhIHY6IGpzb24ubG9hZHModi5kZWNvZGUoJ3V0Zi04JykpCikKCiMgQ29uc3VtZSBtZXNzYWdlcyBmcm9tIHRoZSAndXNlci1ldmVudHMnIHRvcGljCmZvciBtZXNzYWdlIGluIGNvbnN1bWVyOgogICAgcHJpbnQoZiJLZXk6IHttZXNzYWdlLmtleS5kZWNvZGUoJ3V0Zi04Jyl9LCBWYWx1ZToge21lc3NhZ2UudmFsdWV9IikKCiMgQ2xvc2UgdGhlIGNvbnN1bWVyIGNvbm5lY3Rpb24KY29uc3VtZXIuY2xvc2UoKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from kafka import KafkaConsumer
import json

# Initialize the Kafka consumer
consumer = KafkaConsumer(
    'user-events',
    bootstrap_servers='localhost:9092',
    auto_offset_reset='earliest',
    value_deserializer=lambda v: json.loads(v.decode('utf-8'))
)

# Consume messages from the 'user-events' topic
for message in consumer:
    print(f&quot;Key: {message.key.decode('utf-8')}, Value: {message.value}&quot;)

# Close the consumer connection
consumer.close()</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>KafkaConsumer</strong>: Initializes the consumer with the Kafka broker address and a deserializer for the message value.</li>
<li><strong>consumer</strong>: Subscribes to the 'user-events' topic.</li>
<li><strong>for message in consumer</strong>: Iterates over the messages in the topic.</li>
<li><strong>print</strong>: Outputs the key and value of each message.</li>
<li><strong>consumer.close</strong>: Closes the consumer connection.</li>
</ul>
</div><h1>Summary</h1>
<div class='content'><p>Understanding the Kafka message format is essential for effectively producing and consuming messages. A Kafka message consists of a key, value, headers, timestamp, and offset. Producers send messages to topics, and consumers read messages from topics. By mastering these concepts and practicing with code examples, you can efficiently work with Kafka in your applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='kafka-brokers-and-clusters'>&#x25C4;Kafka Brokers and Clusters</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Kafka Message Format</a>
	</div>
	<div class='col-4 text-end'>
					<a href='producer-api-overview'>Producer API Overview &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
