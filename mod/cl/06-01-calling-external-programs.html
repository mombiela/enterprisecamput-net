<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calling External Programs</title>

    <link rel="alternate" href="https://campusempresa.com/mod/cl/06-01-calling-external-programs" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/cl/06-01-calling-external-programs" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/cl/06-01-calling-external-programs" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/cl/06-01-calling-external-programs" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/cl/06-01-calling-external-programs" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-04-security-permissions' title="Security and Permissions">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Calling External Programs</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-02-interfacing-databases' title="Interfacing with Databases">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this module, we will explore how to call external programs from within a CL (Control Language) script. This is a crucial skill for integrating various systems and leveraging existing functionalities provided by other programs.</p>
</div><h1>Objectives</h1>
<div class='content'><p>By the end of this module, you will:</p>
<ul>
<li>Understand the concept of calling external programs.</li>
<li>Learn the syntax and commands used to call external programs.</li>
<li>Practice calling external programs with practical examples.</li>
<li>Handle errors and return values from external programs.</li>
</ul>
</div><h1>1. Introduction to Calling External Programs</h1>
<div class='content'><p>Calling external programs allows a CL script to execute other programs, which can be written in different languages or be part of the system's utilities. This capability is essential for:</p>
<ul>
<li>Reusing existing code.</li>
<li>Integrating different systems.</li>
<li>Automating complex workflows.</li>
</ul>
</div><h1>2. Basic Syntax</h1>
<div class='content'><p>The primary command used to call an external program in CL is <code>CALL</code>. The syntax is straightforward:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q0FMTCBQR00ocHJvZ3JhbV9uYW1lKSBQQVJNKHBhcmFtZXRlcl9saXN0KQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CALL PGM(program_name) PARM(parameter_list)</pre></div><div class='content'><ul>
<li><code>PGM(program_name)</code>: Specifies the name of the program to be called.</li>
<li><code>PARM(parameter_list)</code>: Specifies the parameters to be passed to the program.</li>
</ul>
</div><h2>Example</h2>
<div class='content'><p>Let's consider a simple example where we call a program named <code>MYPGM</code> with two parameters:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q0FMTCBQR00oTVlQR00pIFBBUk0oJ3BhcmFtMScgJ3BhcmFtMicp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CALL PGM(MYPGM) PARM('param1' 'param2')</pre></div><div class='content'></div><h1>3. Practical Example</h1>
<div class='content'></div><h2>Example Program: `MYPGM`</h2>
<div class='content'><p>First, let's create a simple program named <code>MYPGM</code> that takes two parameters and prints them.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gTVlQR00uUlBHTEUKUEdNICAgICAgICBQQVJNKCZQQVJBTTEgJlBBUkFNMikKRENMICAgICAgICBWQVIoJlBBUkFNMSkgVFlQRSgqQ0hBUikgTEVOKDEwKQpEQ0wgICAgICAgIFZBUigmUEFSQU0yKSBUWVBFKCpDSEFSKSBMRU4oMTApCgpTTkRQR01NU0cgIE1TRygnUGFyYW1ldGVyIDE6ICcgKkNBVCAmUEFSQU0xKQpTTkRQR01NU0cgIE1TRygnUGFyYW1ldGVyIDI6ICcgKkNBVCAmUEFSQU0yKQoKRU5EUEdN"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// MYPGM.RPGLE
PGM        PARM(&amp;PARAM1 &amp;PARAM2)
DCL        VAR(&amp;PARAM1) TYPE(*CHAR) LEN(10)
DCL        VAR(&amp;PARAM2) TYPE(*CHAR) LEN(10)

SNDPGMMSG  MSG('Parameter 1: ' *CAT &amp;PARAM1)
SNDPGMMSG  MSG('Parameter 2: ' *CAT &amp;PARAM2)

ENDPGM</pre></div><div class='content'></div><h2>Calling `MYPGM` from a CL Script</h2>
<div class='content'><p>Now, let's write a CL script to call <code>MYPGM</code> with parameters.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ0FMTE1ZUEdNLkNMTEUKUEdNCgpEQ0wgVkFSKCZQQVJNMSkgVFlQRSgqQ0hBUikgTEVOKDEwKSBWQUxVRSgnSGVsbG8nKQpEQ0wgVkFSKCZQQVJNMikgVFlQRSgqQ0hBUikgTEVOKDEwKSBWQUxVRSgnV29ybGQnKQoKQ0FMTCBQR00oTVlQR00pIFBBUk0oJlBBUk0xICZQQVJNMikKCkVORFBHTQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// CALLMYPGM.CLLE
PGM

DCL VAR(&amp;PARM1) TYPE(*CHAR) LEN(10) VALUE('Hello')
DCL VAR(&amp;PARM2) TYPE(*CHAR) LEN(10) VALUE('World')

CALL PGM(MYPGM) PARM(&amp;PARM1 &amp;PARM2)

ENDPGM</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ol>
<li><strong>Declare Variables</strong>: We declare two variables <code>&amp;PARM1</code> and <code>&amp;PARM2</code> with initial values 'Hello' and 'World'.</li>
<li><strong>Call Program</strong>: We use the <code>CALL</code> command to call <code>MYPGM</code> and pass the variables as parameters.</li>
</ol>
</div><h1>4. Handling Errors and Return Values</h1>
<div class='content'><p>When calling external programs, it's essential to handle potential errors and capture return values. The <code>MONMSG</code> command can be used to monitor for specific messages and handle them accordingly.</p>
</div><h2>Example with Error Handling</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ0FMTE1ZUEdNX1dJVEhfRVJST1JfSEFORExJTkcuQ0xMRQpQR00KCkRDTCBWQVIoJlBBUk0xKSBUWVBFKCpDSEFSKSBMRU4oMTApIFZBTFVFKCdIZWxsbycpCkRDTCBWQVIoJlBBUk0yKSBUWVBFKCpDSEFSKSBMRU4oMTApIFZBTFVFKCdXb3JsZCcpCgpDQUxMIFBHTShNWVBHTSkgUEFSTSgmUEFSTTEgJlBBUk0yKQpNT05NU0cgTVNHSUQoQ1BGMDAwMCkgRVhFQyhETykKICAgIFNORFBHTU1TRyBNU0coJ0Vycm9yIG9jY3VycmVkIHdoaWxlIGNhbGxpbmcgTVlQR00nKQpFTkRETwoKRU5EUEdN"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// CALLMYPGM_WITH_ERROR_HANDLING.CLLE
PGM

DCL VAR(&amp;PARM1) TYPE(*CHAR) LEN(10) VALUE('Hello')
DCL VAR(&amp;PARM2) TYPE(*CHAR) LEN(10) VALUE('World')

CALL PGM(MYPGM) PARM(&amp;PARM1 &amp;PARM2)
MONMSG MSGID(CPF0000) EXEC(DO)
    SNDPGMMSG MSG('Error occurred while calling MYPGM')
ENDDO

ENDPGM</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ol>
<li><strong>Call Program</strong>: We call <code>MYPGM</code> as before.</li>
<li><strong>Monitor for Errors</strong>: We use <code>MONMSG</code> to catch any error messages (<code>CPF0000</code> is a generic message ID for all errors) and execute a block of code if an error occurs.</li>
<li><strong>Send Error Message</strong>: If an error occurs, we send a program message indicating the error.</li>
</ol>
</div><h1>5. Exercises</h1>
<div class='content'></div><h2>Exercise 1: Call an External Program</h2>
<div class='content'><ol>
<li>Create a program named <code>EXTPGM</code> that takes one parameter and prints it.</li>
<li>Write a CL script to call <code>EXTPGM</code> with a parameter value of your choice.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><p><strong>EXTPGM</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRVhUUEdNLlJQR0xFClBHTSAgICAgICAgUEFSTSgmUEFSQU0pCkRDTCAgICAgICAgVkFSKCZQQVJBTSkgVFlQRSgqQ0hBUikgTEVOKDEwKQoKU05EUEdNTVNHICBNU0coJ1BhcmFtZXRlcjogJyAqQ0FUICZQQVJBTSkKCkVORFBHTQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// EXTPGM.RPGLE
PGM        PARM(&amp;PARAM)
DCL        VAR(&amp;PARAM) TYPE(*CHAR) LEN(10)

SNDPGMMSG  MSG('Parameter: ' *CAT &amp;PARAM)

ENDPGM</pre></div><div class='content'><p><strong>CL Script</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ0FMTEVYVFBHTS5DTExFClBHTQoKRENMIFZBUigmUEFSTSkgVFlQRSgqQ0hBUikgTEVOKDEwKSBWQUxVRSgnVGVzdFZhbHVlJykKCkNBTEwgUEdNKEVYVFBHTSkgUEFSTSgmUEFSTSkKCkVORFBHTQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// CALLEXTPGM.CLLE
PGM

DCL VAR(&amp;PARM) TYPE(*CHAR) LEN(10) VALUE('TestValue')

CALL PGM(EXTPGM) PARM(&amp;PARM)

ENDPGM</pre></div><div class='content'></div><h2>Exercise 2: Error Handling</h2>
<div class='content'><ol>
<li>Modify the <code>EXTPGM</code> program to intentionally cause an error (e.g., divide by zero).</li>
<li>Update the CL script to handle the error and print an appropriate message.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><p><strong>EXTPGM with Error</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRVhUUEdNLlJQR0xFClBHTSAgICAgICAgUEFSTSgmUEFSQU0pCkRDTCAgICAgICAgVkFSKCZQQVJBTSkgVFlQRSgqQ0hBUikgTEVOKDEwKQpEQ0wgICAgICAgIFZBUigmWkVSTykgVFlQRSgqREVDKSBMRU4oMyAwKSBWQUxVRSgwKQpEQ0wgICAgICAgIFZBUigmUkVTVUxUKSBUWVBFKCpERUMpIExFTigzIDApCgpDSEdWQVIgICAgIFZBUigmUkVTVUxUKSBWQUxVRSgxIC8gJlpFUk8pIC8vIFRoaXMgd2lsbCBjYXVzZSBhIGRpdmlkZSBieSB6ZXJvIGVycm9yCgpTTkRQR01NU0cgIE1TRygnUGFyYW1ldGVyOiAnICpDQVQgJlBBUkFNKQoKRU5EUEdN"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// EXTPGM.RPGLE
PGM        PARM(&amp;PARAM)
DCL        VAR(&amp;PARAM) TYPE(*CHAR) LEN(10)
DCL        VAR(&amp;ZERO) TYPE(*DEC) LEN(3 0) VALUE(0)
DCL        VAR(&amp;RESULT) TYPE(*DEC) LEN(3 0)

CHGVAR     VAR(&amp;RESULT) VALUE(1 / &amp;ZERO) // This will cause a divide by zero error

SNDPGMMSG  MSG('Parameter: ' *CAT &amp;PARAM)

ENDPGM</pre></div><div class='content'><p><strong>CL Script with Error Handling</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ0FMTEVYVFBHTV9XSVRIX0VSUk9SX0hBTkRMSU5HLkNMTEUKUEdNCgpEQ0wgVkFSKCZQQVJNKSBUWVBFKCpDSEFSKSBMRU4oMTApIFZBTFVFKCdUZXN0VmFsdWUnKQoKQ0FMTCBQR00oRVhUUEdNKSBQQVJNKCZQQVJNKQpNT05NU0cgTVNHSUQoQ1BGMDAwMCkgRVhFQyhETykKICAgIFNORFBHTU1TRyBNU0coJ0Vycm9yIG9jY3VycmVkIHdoaWxlIGNhbGxpbmcgRVhUUEdNJykKRU5ERE8KCkVORFBHTQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// CALLEXTPGM_WITH_ERROR_HANDLING.CLLE
PGM

DCL VAR(&amp;PARM) TYPE(*CHAR) LEN(10) VALUE('TestValue')

CALL PGM(EXTPGM) PARM(&amp;PARM)
MONMSG MSGID(CPF0000) EXEC(DO)
    SNDPGMMSG MSG('Error occurred while calling EXTPGM')
ENDDO

ENDPGM</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this module, we learned how to call external programs from a CL script, pass parameters, and handle errors. This capability is vital for integrating different systems and reusing existing functionalities. In the next module, we will explore interfacing with databases, which will further enhance our ability to create powerful and integrated CL scripts.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-04-security-permissions' title="Security and Permissions">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-02-interfacing-databases' title="Interfacing with Databases">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
