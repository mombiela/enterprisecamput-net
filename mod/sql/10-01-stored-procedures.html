<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stored Procedures</title>

    <link rel="alternate" href="https://campusempresa.com/mod/sql/10-01-stored-procedures" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/sql/10-01-stored-procedures" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/sql/10-01-stored-procedures" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/sql/10-01-stored-procedures" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/sql/10-01-stored-procedures" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='09-04-handling-concurrency' title="Handling Concurrency">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Stored Procedures</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='10-02-triggers' title="Triggers">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Stored procedures are a powerful feature in SQL that allow you to encapsulate a set of SQL statements for reuse. They can help improve performance, maintainability, and security of your database operations.</p>
</div><h1><p>What is a Stored Procedure?</p>
</h1>
<div class='content'><p>A stored procedure is a precompiled collection of one or more SQL statements stored on the database server. They can be executed with a single call, which can simplify complex operations and improve performance by reducing the amount of data sent between the client and server.</p>
</div><h2><p>Key Benefits of Stored Procedures:</p>
</h2>
<div class='content'><ul>
<li><strong>Performance</strong>: Stored procedures are precompiled, which can lead to faster execution times.</li>
<li><strong>Maintainability</strong>: Encapsulating logic in stored procedures makes it easier to manage and update.</li>
<li><strong>Security</strong>: Stored procedures can help control access to data by restricting direct access to tables.</li>
</ul>
</div><h1><p>Creating a Stored Procedure</p>
</h1>
<div class='content'><p>To create a stored procedure, you use the <code>CREATE PROCEDURE</code> statement followed by the procedure name and the SQL statements it contains.</p>
</div><h2><p>Syntax:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSBwcm9jZWR1cmVfbmFtZQpBUwpCRUdJTgogICAgLS0gU1FMIHN0YXRlbWVudHMKRU5EOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE procedure_name
AS
BEGIN
    -- SQL statements
END;</pre></div><div class='content'></div><h2><p>Example:</p>
</h2>
<div class='content'><p>Let's create a simple stored procedure that retrieves all employees from an <code>employees</code> table.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSBHZXRBbGxFbXBsb3llZXMKQVMKQkVHSU4KICAgIFNFTEVDVCAqIEZST00gZW1wbG95ZWVzOwpFTkQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE GetAllEmployees
AS
BEGIN
    SELECT * FROM employees;
END;</pre></div><div class='content'></div><h2><p>Explanation:</p>
</h2>
<div class='content'><ul>
<li><code>CREATE PROCEDURE GetAllEmployees</code>: Defines a new stored procedure named <code>GetAllEmployees</code>.</li>
<li><code>AS BEGIN ... END;</code>: Encapsulates the SQL statements within the procedure.</li>
</ul>
</div><h1><p>Executing a Stored Procedure</p>
</h1>
<div class='content'><p>To execute a stored procedure, you use the <code>EXEC</code> or <code>EXECUTE</code> statement followed by the procedure name.</p>
</div><h2><p>Example:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBHZXRBbGxFbXBsb3llZXM7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC GetAllEmployees;</pre></div><div class='content'></div><h2><p>Explanation:</p>
</h2>
<div class='content'><ul>
<li><code>EXEC GetAllEmployees;</code>: Executes the <code>GetAllEmployees</code> stored procedure, which retrieves all records from the <code>employees</code> table.</li>
</ul>
</div><h1><p>Parameters in Stored Procedures</p>
</h1>
<div class='content'><p>Stored procedures can accept parameters, allowing you to pass data into the procedure and use it within the SQL statements.</p>
</div><h2><p>Syntax:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSBwcm9jZWR1cmVfbmFtZQogICAgQHBhcmFtZXRlcl9uYW1lIGRhdGFfdHlwZQpBUwpCRUdJTgogICAgLS0gU1FMIHN0YXRlbWVudHMgdXNpbmcgQHBhcmFtZXRlcl9uYW1lCkVORDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE procedure_name
    @parameter_name data_type
AS
BEGIN
    -- SQL statements using @parameter_name
END;</pre></div><div class='content'></div><h2><p>Example:</p>
</h2>
<div class='content'><p>Let's create a stored procedure that retrieves employees based on their department.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSBHZXRFbXBsb3llZXNCeURlcGFydG1lbnQKICAgIEBEZXBhcnRtZW50SUQgSU5UCkFTCkJFR0lOCiAgICBTRUxFQ1QgKiBGUk9NIGVtcGxveWVlcwogICAgV0hFUkUgZGVwYXJ0bWVudF9pZCA9IEBEZXBhcnRtZW50SUQ7CkVORDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE GetEmployeesByDepartment
    @DepartmentID INT
AS
BEGIN
    SELECT * FROM employees
    WHERE department_id = @DepartmentID;
END;</pre></div><div class='content'></div><h2><p>Explanation:</p>
</h2>
<div class='content'><ul>
<li><code>@DepartmentID INT</code>: Defines a parameter named <code>@DepartmentID</code> of type <code>INT</code>.</li>
<li><code>WHERE department_id = @DepartmentID;</code>: Uses the parameter to filter employees by department.</li>
</ul>
</div><h2><p>Executing with Parameters:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBHZXRFbXBsb3llZXNCeURlcGFydG1lbnQgQERlcGFydG1lbnRJRCA9IDM7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC GetEmployeesByDepartment @DepartmentID = 3;</pre></div><div class='content'></div><h2><p>Explanation:</p>
</h2>
<div class='content'><ul>
<li><code>@DepartmentID = 3</code>: Passes the value <code>3</code> to the <code>@DepartmentID</code> parameter, retrieving employees from department <code>3</code>.</li>
</ul>
</div><h1><p>Modifying and Dropping Stored Procedures</p>
</h1>
<div class='content'></div><h2><p>Modifying a Stored Procedure:</p>
</h2>
<div class='content'><p>To modify an existing stored procedure, you use the <code>ALTER PROCEDURE</code> statement.</p>
</div><h2><p>Syntax:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QUxURVIgUFJPQ0VEVVJFIHByb2NlZHVyZV9uYW1lCkFTCkJFR0lOCiAgICAtLSBNb2RpZmllZCBTUUwgc3RhdGVtZW50cwpFTkQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ALTER PROCEDURE procedure_name
AS
BEGIN
    -- Modified SQL statements
END;</pre></div><div class='content'></div><h2><p>Example:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QUxURVIgUFJPQ0VEVVJFIEdldEFsbEVtcGxveWVlcwpBUwpCRUdJTgogICAgU0VMRUNUIGVtcGxveWVlX2lkLCBlbXBsb3llZV9uYW1lIEZST00gZW1wbG95ZWVzOwpFTkQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ALTER PROCEDURE GetAllEmployees
AS
BEGIN
    SELECT employee_id, employee_name FROM employees;
END;</pre></div><div class='content'></div><h2><p>Dropping a Stored Procedure:</p>
</h2>
<div class='content'><p>To remove a stored procedure, you use the <code>DROP PROCEDURE</code> statement.</p>
</div><h2><p>Syntax:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RFJPUCBQUk9DRURVUkUgcHJvY2VkdXJlX25hbWU7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DROP PROCEDURE procedure_name;</pre></div><div class='content'></div><h2><p>Example:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RFJPUCBQUk9DRURVUkUgR2V0QWxsRW1wbG95ZWVzOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DROP PROCEDURE GetAllEmployees;</pre></div><div class='content'></div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Create a Stored Procedure</p>
</h2>
<div class='content'><p>Create a stored procedure named <code>GetProductsByCategory</code> that retrieves products based on a given category ID.</p>
<h4>Solution:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSBHZXRQcm9kdWN0c0J5Q2F0ZWdvcnkKICAgIEBDYXRlZ29yeUlEIElOVApBUwpCRUdJTgogICAgU0VMRUNUICogRlJPTSBwcm9kdWN0cwogICAgV0hFUkUgY2F0ZWdvcnlfaWQgPSBAQ2F0ZWdvcnlJRDsKRU5EOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE GetProductsByCategory
    @CategoryID INT
AS
BEGIN
    SELECT * FROM products
    WHERE category_id = @CategoryID;
END;</pre></div><div class='content'></div><h2><p>Exercise 2: Execute a Stored Procedure with Parameters</p>
</h2>
<div class='content'><p>Execute the <code>GetProductsByCategory</code> stored procedure to retrieve products from category <code>5</code>.</p>
<h4>Solution:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBHZXRQcm9kdWN0c0J5Q2F0ZWdvcnkgQENhdGVnb3J5SUQgPSA1Ow=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC GetProductsByCategory @CategoryID = 5;</pre></div><div class='content'></div><h2><p>Exercise 3: Modify a Stored Procedure</p>
</h2>
<div class='content'><p>Modify the <code>GetProductsByCategory</code> stored procedure to include the product name and price in the result set.</p>
<h4>Solution:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QUxURVIgUFJPQ0VEVVJFIEdldFByb2R1Y3RzQnlDYXRlZ29yeQogICAgQENhdGVnb3J5SUQgSU5UCkFTCkJFR0lOCiAgICBTRUxFQ1QgcHJvZHVjdF9uYW1lLCBwcmljZSBGUk9NIHByb2R1Y3RzCiAgICBXSEVSRSBjYXRlZ29yeV9pZCA9IEBDYXRlZ29yeUlEOwpFTkQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ALTER PROCEDURE GetProductsByCategory
    @CategoryID INT
AS
BEGIN
    SELECT product_name, price FROM products
    WHERE category_id = @CategoryID;
END;</pre></div><div class='content'></div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Syntax Errors</strong>: Ensure you use the correct syntax for creating, modifying, and executing stored procedures.</li>
<li><strong>Parameter Mismatches</strong>: Verify that the parameters passed during execution match the defined parameters in the stored procedure.</li>
<li><strong>Security</strong>: Avoid using dynamic SQL within stored procedures to prevent SQL injection attacks.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Stored procedures are a fundamental tool in SQL that can greatly enhance the performance, maintainability, and security of your database operations. By encapsulating complex logic within stored procedures, you can simplify your SQL code and make it more efficient. In the next topic, we will explore triggers, another powerful feature in SQL for automating database tasks.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='09-04-handling-concurrency' title="Handling Concurrency">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='10-02-triggers' title="Triggers">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
