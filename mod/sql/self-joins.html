<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Self Joins</title>

    <link rel="alternate" href="https://campusempresa.com/mod/sql/self-joins" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/sql/self-joins" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/sql/self-joins" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/sql/self-joins" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/sql/self-joins" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='full-outer-join'>&#x25C4;FULL OUTER JOIN</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Self Joins</a>
	</div>
	<div class='col-4 text-end'>
					<a href='aggregate-functions'>Aggregate Functions (COUNT, SUM, AVG, MAX, MIN) &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Self Joins</h1>
<div class='content'><p>A self join is a regular join but the table is joined with itself. This is useful when you need to compare rows within the same table or when you need to find relationships among rows in the same table.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Self Join</strong>: A join where a table is joined with itself.</li>
<li><strong>Alias</strong>: Used to give a table a temporary name to differentiate between the original and the joined instances of the table.</li>
<li><strong>Primary Key</strong>: A unique identifier for each row in a table.</li>
<li><strong>Foreign Key</strong>: A field in a table that uniquely identifies a row in another table (or the same table in the case of self joins).</li>
</ul>
</div><h1>When to Use Self Joins</h1>
<div class='content'><ul>
<li>Finding hierarchical relationships (e.g., employee-manager relationships).</li>
<li>Comparing rows within the same table.</li>
<li>Finding duplicates or patterns within a table.</li>
</ul>
</div><h1>Syntax of Self Joins</h1>
<div class='content'><p>The syntax of a self join is similar to a regular join, but you must use table aliases to differentiate between the instances of the table.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIEEuY29sdW1uMSwgQi5jb2x1bW4yCkZST00gdGFibGVfbmFtZSBBLCB0YWJsZV9uYW1lIEIKV0hFUkUgQS5jb21tb25fZmllbGQgPSBCLmNvbW1vbl9maWVsZDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT A.column1, B.column2
FROM table_name A, table_name B
WHERE A.common_field = B.common_field;</pre></div><div class='content'></div><h1>Example: Employee-Manager Relationship</h1>
<div class='content'><p>Consider an <code>employees</code> table where each employee has a <code>manager_id</code> that references the <code>employee_id</code> of their manager.</p>
</div><h2>Table: employees</h2>
<div class='content'><p>| employee_id | employee_name | manager_id |
|-------------|----------------|------------|
| 1           | John Doe       | NULL       |
| 2           | Jane Smith     | 1          |
| 3           | Emily Davis    | 2          |
| 4           | Michael Brown  | 1          |</p>
</div><h2>Query</h2>
<div class='content'><p>To find the names of employees along with their managers' names:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGUxLmVtcGxveWVlX25hbWUgQVMgRW1wbG95ZWUsIGUyLmVtcGxveWVlX25hbWUgQVMgTWFuYWdlcgpGUk9NIGVtcGxveWVlcyBlMQpMRUZUIEpPSU4gZW1wbG95ZWVzIGUyIE9OIGUxLm1hbmFnZXJfaWQgPSBlMi5lbXBsb3llZV9pZDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT e1.employee_name AS Employee, e2.employee_name AS Manager
FROM employees e1
LEFT JOIN employees e2 ON e1.manager_id = e2.employee_id;</pre></div><div class='content'></div><h2>Result</h2>
<div class='content'><p>| Employee      | Manager     |
|---------------|-------------|
| John Doe      | NULL        |
| Jane Smith    | John Doe    |
| Emily Davis   | Jane Smith  |
| Michael Brown | John Doe    |</p>
</div><h1>Exercises</h1>
<div class='content'><ol>
<li><strong>Basic Self Join</strong>: Write a query to find all pairs of employees who share the same manager.</li>
<li><strong>Hierarchical Data</strong>: Write a query to list all employees and their direct and indirect managers.</li>
<li><strong>Duplicate Detection</strong>: Write a query to find duplicate rows in a table based on a specific column.</li>
</ol>
</div><h2>Exercise 1: Basic Self Join</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGUxLmVtcGxveWVlX25hbWUgQVMgRW1wbG95ZWUxLCBlMi5lbXBsb3llZV9uYW1lIEFTIEVtcGxveWVlMiwgZTEubWFuYWdlcl9pZApGUk9NIGVtcGxveWVlcyBlMQpKT0lOIGVtcGxveWVlcyBlMiBPTiBlMS5tYW5hZ2VyX2lkID0gZTIubWFuYWdlcl9pZApXSEVSRSBlMS5lbXBsb3llZV9pZCAhPSBlMi5lbXBsb3llZV9pZDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT e1.employee_name AS Employee1, e2.employee_name AS Employee2, e1.manager_id
FROM employees e1
JOIN employees e2 ON e1.manager_id = e2.manager_id
WHERE e1.employee_id != e2.employee_id;</pre></div><div class='content'></div><h2>Exercise 2: Hierarchical Data</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("V0lUSCBSRUNVUlNJVkUgRW1wbG95ZWVIaWVyYXJjaHkgQVMgKAogICAgU0VMRUNUIGVtcGxveWVlX2lkLCBlbXBsb3llZV9uYW1lLCBtYW5hZ2VyX2lkCiAgICBGUk9NIGVtcGxveWVlcwogICAgV0hFUkUgbWFuYWdlcl9pZCBJUyBOVUxMCiAgICBVTklPTiBBTEwKICAgIFNFTEVDVCBlLmVtcGxveWVlX2lkLCBlLmVtcGxveWVlX25hbWUsIGVoLmVtcGxveWVlX2lkCiAgICBGUk9NIGVtcGxveWVlcyBlCiAgICBKT0lOIEVtcGxveWVlSGllcmFyY2h5IGVoIE9OIGUubWFuYWdlcl9pZCA9IGVoLmVtcGxveWVlX2lkCikKU0VMRUNUICogRlJPTSBFbXBsb3llZUhpZXJhcmNoeTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>WITH RECURSIVE EmployeeHierarchy AS (
    SELECT employee_id, employee_name, manager_id
    FROM employees
    WHERE manager_id IS NULL
    UNION ALL
    SELECT e.employee_id, e.employee_name, eh.employee_id
    FROM employees e
    JOIN EmployeeHierarchy eh ON e.manager_id = eh.employee_id
)
SELECT * FROM EmployeeHierarchy;</pre></div><div class='content'></div><h2>Exercise 3: Duplicate Detection</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIHQxLioKRlJPTSB0YWJsZV9uYW1lIHQxCkpPSU4gdGFibGVfbmFtZSB0MiBPTiB0MS5jb2x1bW5fdG9fY2hlY2sgPSB0Mi5jb2x1bW5fdG9fY2hlY2sKV0hFUkUgdDEuaWQgIT0gdDIuaWQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT t1.*
FROM table_name t1
JOIN table_name t2 ON t1.column_to_check = t2.column_to_check
WHERE t1.id != t2.id;</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Self joins are a powerful tool in SQL that allow you to compare rows within the same table. They are particularly useful for hierarchical data and finding relationships within a single table. By mastering self joins, you can perform complex queries that involve comparing and analyzing data within the same dataset.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='full-outer-join'>&#x25C4;FULL OUTER JOIN</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Self Joins</a>
	</div>
	<div class='col-4 text-end'>
					<a href='aggregate-functions'>Aggregate Functions (COUNT, SUM, AVG, MAX, MIN) &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
