<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Error Handling in SQL</title>

    <link rel="alternate" href="https://campusempresa.com/mod/sql/error-handling" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/sql/error-handling" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/sql/error-handling" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/sql/error-handling" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/sql/error-handling" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='transactions'>&#x25C4;Transactions</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Error Handling in SQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='query-optimization'>Query Optimization &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Error handling is a crucial aspect of SQL programming, allowing developers to manage and respond to errors that occur during database operations. This topic will guide you through the basics of error handling, progressing to more advanced techniques.</p>
</div><h1>Introduction to Error Handling</h1>
<div class='content'><p>Error handling in SQL involves anticipating potential issues and defining how the system should respond. This ensures that your database operations are robust and can handle unexpected situations gracefully.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Error Codes</strong>: Numeric or alphanumeric codes that represent specific errors.</li>
<li><strong>Error Messages</strong>: Descriptive messages that provide details about the error.</li>
<li><strong>TRY...CATCH</strong>: A construct used to handle exceptions in SQL.</li>
</ul>
</div><h1>Basic Error Handling</h1>
<div class='content'></div><h2>Using Error Codes and Messages</h2>
<div class='content'><p>SQL databases return error codes and messages when an operation fails. Understanding these codes and messages is the first step in error handling.</p>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQXR0ZW1wdGluZyB0byBpbnNlcnQgYSBkdXBsaWNhdGUga2V5CklOU0VSVCBJTlRPIHVzZXJzIChpZCwgbmFtZSkgVkFMVUVTICgxLCAnSm9obiBEb2UnKTsKCi0tIEVycm9yIG1lc3NhZ2U6Ci0tIEVSUk9SOiBkdXBsaWNhdGUga2V5IHZhbHVlIHZpb2xhdGVzIHVuaXF1ZSBjb25zdHJhaW50ICJ1c2Vyc19wa2V5IgotLSBERVRBSUw6IEtleSAoaWQpPSgxKSBhbHJlYWR5IGV4aXN0cy4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Attempting to insert a duplicate key
INSERT INTO users (id, name) VALUES (1, 'John Doe');

-- Error message:
-- ERROR: duplicate key value violates unique constraint &quot;users_pkey&quot;
-- DETAIL: Key (id)=(1) already exists.</pre></div><div class='content'></div><h2>Handling Errors with TRY...CATCH</h2>
<div class='content'><p>The <code>TRY...CATCH</code> construct allows you to catch errors and handle them appropriately.</p>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkVHSU4gVFJZCiAgICAtLSBBdHRlbXB0IHRvIGluc2VydCBhIGR1cGxpY2F0ZSBrZXkKICAgIElOU0VSVCBJTlRPIHVzZXJzIChpZCwgbmFtZSkgVkFMVUVTICgxLCAnSm9obiBEb2UnKTsKRU5EIFRSWQpCRUdJTiBDQVRDSAogICAgLS0gSGFuZGxlIHRoZSBlcnJvcgogICAgUFJJTlQgJ0FuIGVycm9yIG9jY3VycmVkOiAnICsgRVJST1JfTUVTU0FHRSgpOwpFTkQgQ0FUQ0g7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BEGIN TRY
    -- Attempt to insert a duplicate key
    INSERT INTO users (id, name) VALUES (1, 'John Doe');
END TRY
BEGIN CATCH
    -- Handle the error
    PRINT 'An error occurred: ' + ERROR_MESSAGE();
END CATCH;</pre></div><div class='content'></div><h2>Key Points</h2>
<div class='content'><ul>
<li><code>BEGIN TRY</code> block contains the code that might cause an error.</li>
<li><code>BEGIN CATCH</code> block contains the code to handle the error.</li>
<li><code>ERROR_MESSAGE()</code> function returns the error message.</li>
</ul>
</div><h1>Intermediate Error Handling</h1>
<div class='content'></div><h2>Nested TRY...CATCH Blocks</h2>
<div class='content'><p>You can nest <code>TRY...CATCH</code> blocks to handle errors at different levels of your SQL code.</p>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkVHSU4gVFJZCiAgICBCRUdJTiBUUlkKICAgICAgICAtLSBBdHRlbXB0IHRvIGluc2VydCBhIGR1cGxpY2F0ZSBrZXkKICAgICAgICBJTlNFUlQgSU5UTyB1c2VycyAoaWQsIG5hbWUpIFZBTFVFUyAoMSwgJ0pvaG4gRG9lJyk7CiAgICBFTkQgVFJZCiAgICBCRUdJTiBDQVRDSAogICAgICAgIFBSSU5UICdJbm5lciBDQVRDSDogJyArIEVSUk9SX01FU1NBR0UoKTsKICAgICAgICAtLSBSZXRocm93IHRoZSBlcnJvciB0byB0aGUgb3V0ZXIgQ0FUQ0ggYmxvY2sKICAgICAgICBUSFJPVzsKICAgIEVORCBDQVRDSDsKRU5EIFRSWQpCRUdJTiBDQVRDSAogICAgUFJJTlQgJ091dGVyIENBVENIOiAnICsgRVJST1JfTUVTU0FHRSgpOwpFTkQgQ0FUQ0g7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BEGIN TRY
    BEGIN TRY
        -- Attempt to insert a duplicate key
        INSERT INTO users (id, name) VALUES (1, 'John Doe');
    END TRY
    BEGIN CATCH
        PRINT 'Inner CATCH: ' + ERROR_MESSAGE();
        -- Rethrow the error to the outer CATCH block
        THROW;
    END CATCH;
END TRY
BEGIN CATCH
    PRINT 'Outer CATCH: ' + ERROR_MESSAGE();
END CATCH;</pre></div><div class='content'></div><h2>Using Transactions for Error Handling</h2>
<div class='content'><p>Transactions ensure that a series of SQL statements are executed as a single unit. If an error occurs, you can roll back the transaction to maintain data integrity.</p>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkVHSU4gVFJZCiAgICBCRUdJTiBUUkFOU0FDVElPTjsKICAgIAogICAgLS0gSW5zZXJ0IGEgbmV3IHVzZXIKICAgIElOU0VSVCBJTlRPIHVzZXJzIChpZCwgbmFtZSkgVkFMVUVTICgyLCAnSmFuZSBEb2UnKTsKICAgIAogICAgLS0gQXR0ZW1wdCB0byBpbnNlcnQgYSBkdXBsaWNhdGUga2V5CiAgICBJTlNFUlQgSU5UTyB1c2VycyAoaWQsIG5hbWUpIFZBTFVFUyAoMSwgJ0pvaG4gRG9lJyk7CiAgICAKICAgIENPTU1JVCBUUkFOU0FDVElPTjsKRU5EIFRSWQpCRUdJTiBDQVRDSAogICAgUk9MTEJBQ0sgVFJBTlNBQ1RJT047CiAgICBQUklOVCAnVHJhbnNhY3Rpb24gcm9sbGVkIGJhY2sgZHVlIHRvIGVycm9yOiAnICsgRVJST1JfTUVTU0FHRSgpOwpFTkQgQ0FUQ0g7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BEGIN TRY
    BEGIN TRANSACTION;
    
    -- Insert a new user
    INSERT INTO users (id, name) VALUES (2, 'Jane Doe');
    
    -- Attempt to insert a duplicate key
    INSERT INTO users (id, name) VALUES (1, 'John Doe');
    
    COMMIT TRANSACTION;
END TRY
BEGIN CATCH
    ROLLBACK TRANSACTION;
    PRINT 'Transaction rolled back due to error: ' + ERROR_MESSAGE();
END CATCH;</pre></div><div class='content'></div><h2>Key Points</h2>
<div class='content'><ul>
<li><code>BEGIN TRANSACTION</code> starts a new transaction.</li>
<li><code>COMMIT TRANSACTION</code> commits the transaction if no errors occur.</li>
<li><code>ROLLBACK TRANSACTION</code> rolls back the transaction if an error occurs.</li>
</ul>
</div><h1>Advanced Error Handling</h1>
<div class='content'></div><h2>Custom Error Messages</h2>
<div class='content'><p>You can define custom error messages to provide more meaningful feedback to users.</p>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkVHSU4gVFJZCiAgICAtLSBBdHRlbXB0IHRvIGluc2VydCBhIGR1cGxpY2F0ZSBrZXkKICAgIElOU0VSVCBJTlRPIHVzZXJzIChpZCwgbmFtZSkgVkFMVUVTICgxLCAnSm9obiBEb2UnKTsKRU5EIFRSWQpCRUdJTiBDQVRDSAogICAgREVDTEFSRSBARXJyb3JNZXNzYWdlIE5WQVJDSEFSKDQwMDApOwogICAgU0VUIEBFcnJvck1lc3NhZ2UgPSAnQ3VzdG9tIEVycm9yOiAnICsgRVJST1JfTUVTU0FHRSgpOwogICAgUFJJTlQgQEVycm9yTWVzc2FnZTsKRU5EIENBVENIOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BEGIN TRY
    -- Attempt to insert a duplicate key
    INSERT INTO users (id, name) VALUES (1, 'John Doe');
END TRY
BEGIN CATCH
    DECLARE @ErrorMessage NVARCHAR(4000);
    SET @ErrorMessage = 'Custom Error: ' + ERROR_MESSAGE();
    PRINT @ErrorMessage;
END CATCH;</pre></div><div class='content'></div><h2>Logging Errors</h2>
<div class='content'><p>Logging errors to a table can help you track and analyze issues over time.</p>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFRBQkxFIEVycm9yTG9nICgKICAgIEVycm9ySUQgSU5UIElERU5USVRZKDEsMSksCiAgICBFcnJvck1lc3NhZ2UgTlZBUkNIQVIoNDAwMCksCiAgICBFcnJvckRhdGVUaW1lIERBVEVUSU1FCik7CgpCRUdJTiBUUlkKICAgIC0tIEF0dGVtcHQgdG8gaW5zZXJ0IGEgZHVwbGljYXRlIGtleQogICAgSU5TRVJUIElOVE8gdXNlcnMgKGlkLCBuYW1lKSBWQUxVRVMgKDEsICdKb2huIERvZScpOwpFTkQgVFJZCkJFR0lOIENBVENICiAgICBJTlNFUlQgSU5UTyBFcnJvckxvZyAoRXJyb3JNZXNzYWdlLCBFcnJvckRhdGVUaW1lKQogICAgVkFMVUVTIChFUlJPUl9NRVNTQUdFKCksIEdFVERBVEUoKSk7CiAgICBQUklOVCAnRXJyb3IgbG9nZ2VkIHRvIEVycm9yTG9nIHRhYmxlLic7CkVORCBDQVRDSDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE TABLE ErrorLog (
    ErrorID INT IDENTITY(1,1),
    ErrorMessage NVARCHAR(4000),
    ErrorDateTime DATETIME
);

BEGIN TRY
    -- Attempt to insert a duplicate key
    INSERT INTO users (id, name) VALUES (1, 'John Doe');
END TRY
BEGIN CATCH
    INSERT INTO ErrorLog (ErrorMessage, ErrorDateTime)
    VALUES (ERROR_MESSAGE(), GETDATE());
    PRINT 'Error logged to ErrorLog table.';
END CATCH;</pre></div><div class='content'></div><h2>Key Points</h2>
<div class='content'><ul>
<li>Custom error messages provide more context.</li>
<li>Logging errors helps in monitoring and debugging.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Error handling in SQL is essential for creating robust and reliable database applications. By understanding and implementing basic to advanced error handling techniques, you can ensure that your SQL code can gracefully handle unexpected situations and maintain data integrity.</p>
</div><h2>Summary</h2>
<div class='content'><ul>
<li><strong>Basic Error Handling</strong>: Understanding error codes and messages, using <code>TRY...CATCH</code>.</li>
<li><strong>Intermediate Error Handling</strong>: Nested <code>TRY...CATCH</code> blocks, using transactions.</li>
<li><strong>Advanced Error Handling</strong>: Custom error messages, logging errors.</li>
</ul>
<p>By mastering these techniques, you can significantly improve the resilience and reliability of your SQL applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='transactions'>&#x25C4;Transactions</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Error Handling in SQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='query-optimization'>Query Optimization &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
