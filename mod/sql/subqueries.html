<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subqueries</title>

    <link rel="alternate" href="https://campusempresa.com/mod/sql/subqueries" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/sql/subqueries" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/sql/subqueries" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/sql/subqueries" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/sql/subqueries" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='having-clause'>&#x25C4;HAVING Clause</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Subqueries</a>
	</div>
	<div class='col-4 text-end'>
					<a href='common-table-expressions'>Common Table Expressions (CTEs) &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Subqueries</h1>
<div class='content'><p>Subqueries, also known as inner queries or nested queries, are queries within another SQL query. They are used to perform operations that require multiple steps, such as filtering, aggregating, or joining data in a more complex manner.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Subquery</strong>: A query nested inside another query.</li>
<li><strong>Outer Query</strong>: The main query that contains the subquery.</li>
<li><strong>Single-row Subquery</strong>: Returns a single row of results.</li>
<li><strong>Multiple-row Subquery</strong>: Returns multiple rows of results.</li>
<li><strong>Correlated Subquery</strong>: A subquery that references columns from the outer query.</li>
</ul>
</div><h1>Types of Subqueries</h1>
<div class='content'></div><h2>Single-row Subqueries</h2>
<div class='content'><p>Single-row subqueries return one row of results and are often used with comparison operators such as <code>=</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, and <code>&lt;&gt;</code>.</p>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGVtcGxveWVlX2lkLCBmaXJzdF9uYW1lLCBsYXN0X25hbWUKRlJPTSBlbXBsb3llZXMKV0hFUkUgZGVwYXJ0bWVudF9pZCA9ICgKICAgIFNFTEVDVCBkZXBhcnRtZW50X2lkCiAgICBGUk9NIGRlcGFydG1lbnRzCiAgICBXSEVSRSBkZXBhcnRtZW50X25hbWUgPSAnU2FsZXMnCik7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT employee_id, first_name, last_name
FROM employees
WHERE department_id = (
    SELECT department_id
    FROM departments
    WHERE department_name = 'Sales'
);</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>: This query retrieves the <code>employee_id</code>, <code>first_name</code>, and <code>last_name</code> of employees who work in the 'Sales' department. The subquery finds the <code>department_id</code> for 'Sales', and the outer query uses this <code>department_id</code> to filter employees.</li>
</ul>
</div><h2>Multiple-row Subqueries</h2>
<div class='content'><p>Multiple-row subqueries return more than one row and are often used with operators like <code>IN</code>, <code>ANY</code>, or <code>ALL</code>.</p>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGVtcGxveWVlX2lkLCBmaXJzdF9uYW1lLCBsYXN0X25hbWUKRlJPTSBlbXBsb3llZXMKV0hFUkUgZGVwYXJ0bWVudF9pZCBJTiAoCiAgICBTRUxFQ1QgZGVwYXJ0bWVudF9pZAogICAgRlJPTSBkZXBhcnRtZW50cwogICAgV0hFUkUgbG9jYXRpb25faWQgPSAxNzAwCik7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT employee_id, first_name, last_name
FROM employees
WHERE department_id IN (
    SELECT department_id
    FROM departments
    WHERE location_id = 1700
);</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>: This query retrieves the <code>employee_id</code>, <code>first_name</code>, and <code>last_name</code> of employees who work in departments located at <code>location_id</code> 1700. The subquery returns all <code>department_id</code>s at location 1700, and the outer query filters employees based on these <code>department_id</code>s.</li>
</ul>
</div><h2>Correlated Subqueries</h2>
<div class='content'><p>Correlated subqueries reference columns from the outer query and are evaluated once for each row processed by the outer query.</p>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGVtcGxveWVlX2lkLCBmaXJzdF9uYW1lLCBsYXN0X25hbWUKRlJPTSBlbXBsb3llZXMgZQpXSEVSRSBzYWxhcnkgPiAoCiAgICBTRUxFQ1QgQVZHKHNhbGFyeSkKICAgIEZST00gZW1wbG95ZWVzCiAgICBXSEVSRSBkZXBhcnRtZW50X2lkID0gZS5kZXBhcnRtZW50X2lkCik7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT employee_id, first_name, last_name
FROM employees e
WHERE salary &gt; (
    SELECT AVG(salary)
    FROM employees
    WHERE department_id = e.department_id
);</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>: This query retrieves the <code>employee_id</code>, <code>first_name</code>, and <code>last_name</code> of employees whose salary is greater than the average salary of their department. The subquery calculates the average salary for each department, and the outer query compares each employee's salary to this average.</li>
</ul>
</div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Single-row Subquery</h2>
<div class='content'><p>Write a query to find the name of the employee who has the highest salary.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGZpcnN0X25hbWUsIGxhc3RfbmFtZQpGUk9NIGVtcGxveWVlcwpXSEVSRSBzYWxhcnkgPSAoCiAgICBTRUxFQ1QgTUFYKHNhbGFyeSkKICAgIEZST00gZW1wbG95ZWVzCik7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT first_name, last_name
FROM employees
WHERE salary = (
    SELECT MAX(salary)
    FROM employees
);</pre></div><div class='content'></div><h2>Exercise 2: Multiple-row Subquery</h2>
<div class='content'><p>Write a query to find the names of employees who work in the same department as 'John Doe'.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGZpcnN0X25hbWUsIGxhc3RfbmFtZQpGUk9NIGVtcGxveWVlcwpXSEVSRSBkZXBhcnRtZW50X2lkID0gKAogICAgU0VMRUNUIGRlcGFydG1lbnRfaWQKICAgIEZST00gZW1wbG95ZWVzCiAgICBXSEVSRSBmaXJzdF9uYW1lID0gJ0pvaG4nIEFORCBsYXN0X25hbWUgPSAnRG9lJwopOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT first_name, last_name
FROM employees
WHERE department_id = (
    SELECT department_id
    FROM employees
    WHERE first_name = 'John' AND last_name = 'Doe'
);</pre></div><div class='content'></div><h2>Exercise 3: Correlated Subquery</h2>
<div class='content'><p>Write a query to find the names of employees who earn more than the average salary in their department.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGZpcnN0X25hbWUsIGxhc3RfbmFtZQpGUk9NIGVtcGxveWVlcyBlCldIRVJFIHNhbGFyeSA+ICgKICAgIFNFTEVDVCBBVkcoc2FsYXJ5KQogICAgRlJPTSBlbXBsb3llZXMKICAgIFdIRVJFIGRlcGFydG1lbnRfaWQgPSBlLmRlcGFydG1lbnRfaWQKKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT first_name, last_name
FROM employees e
WHERE salary &gt; (
    SELECT AVG(salary)
    FROM employees
    WHERE department_id = e.department_id
);</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Subqueries are powerful tools in SQL that allow for more complex and flexible data retrieval. They can be used to perform operations that would be difficult or impossible with a single query. Understanding how to use single-row, multiple-row, and correlated subqueries will enhance your ability to write efficient and effective SQL queries. Practice using subqueries in different scenarios to become proficient in their application.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='having-clause'>&#x25C4;HAVING Clause</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Subqueries</a>
	</div>
	<div class='col-4 text-end'>
					<a href='common-table-expressions'>Common Table Expressions (CTEs) &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
