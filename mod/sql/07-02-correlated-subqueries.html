<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Correlated Subqueries</title>

    <link rel="alternate" href="https://campusempresa.com/mod/sql/07-02-correlated-subqueries" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/sql/07-02-correlated-subqueries" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/sql/07-02-correlated-subqueries" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>var DEVELOP = window.location.href.indexOf("localhost")!=-1 && true;</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/sql/07-02-correlated-subqueries" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/sql/07-02-correlated-subqueries" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>
		<!-- <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

			</div>
		</div>
	</div>
</div>
 -->
 
<div class="top-bar container-fluid">
	<div class="container-xxl">
		<nav class="navbar navbar-expand-md p-0">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<div class="navbar-nav me-auto">
							<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

					</div>
				</div>			
							</div>
		</nav>
	</div>
</div>				<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='07-01-introduction-subqueries' title="Introduction to Subqueries">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<h2 style="text-decoration:underline">Correlated Subqueries</h2>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-03-exists-not-exists' title="EXISTS and NOT EXISTS">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Correlated subqueries are a powerful feature in SQL that allow you to perform more complex queries by referencing columns from the outer query within the subquery. Unlike regular subqueries, which are executed once, correlated subqueries are executed once for each row processed by the outer query.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Subquery</strong>: A query nested inside another query.</li>
<li><strong>Correlated Subquery</strong>: A subquery that references columns from the outer query.</li>
<li><strong>Outer Query</strong>: The main query that contains the subquery.</li>
</ol>
</div><h1>Syntax</h1>
<div class='content'><p>The basic syntax for a correlated subquery is as follows:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGNvbHVtbjEsIGNvbHVtbjIsIC4uLgpGUk9NIHRhYmxlMSBBUyB0MQpXSEVSRSBjb2x1bW5YID0gKFNFTEVDVCBhZ2dyZWdhdGVfZnVuY3Rpb24oY29sdW1uWSkKICAgICAgICAgICAgICAgICBGUk9NIHRhYmxlMiBBUyB0MgogICAgICAgICAgICAgICAgIFdIRVJFIHQxLmNvbHVtblogPSB0Mi5jb2x1bW5aKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT column1, column2, ...
FROM table1 AS t1
WHERE columnX = (SELECT aggregate_function(columnY)
                 FROM table2 AS t2
                 WHERE t1.columnZ = t2.columnZ);</pre></div><div class='content'></div><h1>Practical Example</h1>
<div class='content'><p>Let's consider two tables: <code>employees</code> and <code>departments</code>.</p>
</div><h2>Table: employees</h2>
<div class='content'><table>
<thead>
<tr>
<th>employee_id</th>
<th>name</th>
<th>department_id</th>
<th>salary</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Alice</td>
<td>1</td>
<td>50000</td>
</tr>
<tr>
<td>2</td>
<td>Bob</td>
<td>2</td>
<td>60000</td>
</tr>
<tr>
<td>3</td>
<td>Charlie</td>
<td>1</td>
<td>55000</td>
</tr>
<tr>
<td>4</td>
<td>David</td>
<td>3</td>
<td>70000</td>
</tr>
<tr>
<td>5</td>
<td>Eve</td>
<td>2</td>
<td>65000</td>
</tr>
</tbody>
</table>
</div><h2>Table: departments</h2>
<div class='content'><table>
<thead>
<tr>
<th>department_id</th>
<th>department_name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>HR</td>
</tr>
<tr>
<td>2</td>
<td>IT</td>
</tr>
<tr>
<td>3</td>
<td>Finance</td>
</tr>
</tbody>
</table>
</div><h2>Example Query</h2>
<div class='content'><p>Find the employees whose salary is greater than the average salary in their department.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIG5hbWUsIHNhbGFyeQpGUk9NIGVtcGxveWVlcyBBUyBlMQpXSEVSRSBzYWxhcnkgPiAoU0VMRUNUIEFWRyhzYWxhcnkpCiAgICAgICAgICAgICAgICBGUk9NIGVtcGxveWVlcyBBUyBlMgogICAgICAgICAgICAgICAgV0hFUkUgZTEuZGVwYXJ0bWVudF9pZCA9IGUyLmRlcGFydG1lbnRfaWQpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT name, salary
FROM employees AS e1
WHERE salary &gt; (SELECT AVG(salary)
                FROM employees AS e2
                WHERE e1.department_id = e2.department_id);</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ol>
<li>
<p><strong>Outer Query</strong>: <code>SELECT name, salary FROM employees AS e1 WHERE ...</code></p>
<ul>
<li>This query selects the <code>name</code> and <code>salary</code> of employees from the <code>employees</code> table.</li>
</ul>
</li>
<li>
<p><strong>Correlated Subquery</strong>: <code>(SELECT AVG(salary) FROM employees AS e2 WHERE e1.department_id = e2.department_id)</code></p>
<ul>
<li>This subquery calculates the average salary for the department of the current employee (<code>e1</code>).</li>
<li>The subquery is executed for each row in the outer query, using the <code>department_id</code> of the current row (<code>e1.department_id</code>).</li>
</ul>
</li>
</ol>
</div><h1>Exercises</h1>
<div class='content'></div><h2>Exercise 1</h2>
<div class='content'><p><strong>Problem</strong>: Find the employees who earn more than the average salary in their department.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIG5hbWUsIHNhbGFyeQpGUk9NIGVtcGxveWVlcyBBUyBlMQpXSEVSRSBzYWxhcnkgPiAoU0VMRUNUIEFWRyhzYWxhcnkpCiAgICAgICAgICAgICAgICBGUk9NIGVtcGxveWVlcyBBUyBlMgogICAgICAgICAgICAgICAgV0hFUkUgZTEuZGVwYXJ0bWVudF9pZCA9IGUyLmRlcGFydG1lbnRfaWQpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT name, salary
FROM employees AS e1
WHERE salary &gt; (SELECT AVG(salary)
                FROM employees AS e2
                WHERE e1.department_id = e2.department_id);</pre></div><div class='content'></div><h2>Exercise 2</h2>
<div class='content'><p><strong>Problem</strong>: List the departments where the average salary is greater than $60,000.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGRlcGFydG1lbnRfbmFtZQpGUk9NIGRlcGFydG1lbnRzIEFTIGQKV0hFUkUgKFNFTEVDVCBBVkcoc2FsYXJ5KQogICAgICAgRlJPTSBlbXBsb3llZXMgQVMgZQogICAgICAgV0hFUkUgZS5kZXBhcnRtZW50X2lkID0gZC5kZXBhcnRtZW50X2lkKSA+IDYwMDAwOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT department_name
FROM departments AS d
WHERE (SELECT AVG(salary)
       FROM employees AS e
       WHERE e.department_id = d.department_id) &gt; 60000;</pre></div><div class='content'></div><h2>Exercise 3</h2>
<div class='content'><p><strong>Problem</strong>: Find the employees who have the highest salary in their department.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIG5hbWUsIHNhbGFyeQpGUk9NIGVtcGxveWVlcyBBUyBlMQpXSEVSRSBzYWxhcnkgPSAoU0VMRUNUIE1BWChzYWxhcnkpCiAgICAgICAgICAgICAgICBGUk9NIGVtcGxveWVlcyBBUyBlMgogICAgICAgICAgICAgICAgV0hFUkUgZTEuZGVwYXJ0bWVudF9pZCA9IGUyLmRlcGFydG1lbnRfaWQpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT name, salary
FROM employees AS e1
WHERE salary = (SELECT MAX(salary)
                FROM employees AS e2
                WHERE e1.department_id = e2.department_id);</pre></div><div class='content'></div><h1>Common Mistakes</h1>
<div class='content'><ol>
<li><strong>Incorrect Column References</strong>: Ensure that the columns referenced in the subquery are correctly correlated with the outer query.</li>
<li><strong>Performance Issues</strong>: Correlated subqueries can be slow because they are executed once for each row in the outer query. Consider using JOINs or other optimization techniques if performance is an issue.</li>
</ol>
</div><h1>Conclusion</h1>
<div class='content'><p>Correlated subqueries are a powerful tool for performing complex queries that depend on the data from the outer query. By understanding how to use them effectively, you can solve a wide range of data retrieval problems in SQL. Practice with the provided exercises to reinforce your understanding and become proficient in using correlated subqueries.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='07-01-introduction-subqueries' title="Introduction to Subqueries">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-03-exists-not-exists' title="EXISTS and NOT EXISTS">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
	     crossorigin="anonymous"></script>
	<!-- enterprise_campus -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-0611338592562725"
	     data-ad-slot="6914733106"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
	     (adsbygoogle = window.adsbygoogle || []).push({});
	</script>
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>SQL Course</h1>
<h2>Module 1: Introduction to SQL</h2>
<ul>
<li><a href="01-01-what-is-sql">What is SQL?</a></li>
<li><a href="01-02-setting-up-environment">Setting Up Your SQL Environment</a></li>
<li><a href="01-03-basic-sql-syntax">Basic SQL Syntax</a></li>
<li><a href="01-04-understanding-databases-tables">Understanding Databases and Tables</a></li>
</ul>
<h2>Module 2: Basic SQL Queries</h2>
<ul>
<li><a href="02-01-select-statement">SELECT Statement</a></li>
<li><a href="02-02-filtering-data-where">Filtering Data with WHERE</a></li>
<li><a href="02-03-sorting-data-order-by">Sorting Data with ORDER BY</a></li>
<li><a href="02-04-limiting-results-limit">Limiting Results with LIMIT</a></li>
</ul>
<h2>Module 3: Working with Multiple Tables</h2>
<ul>
<li><a href="03-01-join-operations">JOIN Operations</a></li>
<li><a href="03-02-inner-join">INNER JOIN</a></li>
<li><a href="03-03-left-join">LEFT JOIN</a></li>
<li><a href="03-04-right-join">RIGHT JOIN</a></li>
<li><a href="03-05-full-outer-join">FULL OUTER JOIN</a></li>
</ul>
<h2>Module 4: Advanced Data Filtering</h2>
<ul>
<li><a href="04-01-using-like-pattern-matching">Using LIKE for Pattern Matching</a></li>
<li><a href="04-02-in-between-operators">IN and BETWEEN Operators</a></li>
<li><a href="04-03-null-values-is-null">NULL Values and IS NULL</a></li>
<li><a href="04-04-aggregating-data-group-by">Aggregating Data with GROUP BY</a></li>
<li><a href="04-05-having-clause">HAVING Clause</a></li>
</ul>
<h2>Module 5: Data Manipulation</h2>
<ul>
<li><a href="05-01-insert-statement">INSERT Statement</a></li>
<li><a href="05-02-update-statement">UPDATE Statement</a></li>
<li><a href="05-03-delete-statement">DELETE Statement</a></li>
<li><a href="05-04-upsert-merge-statement">UPSERT (MERGE) Statement</a></li>
</ul>
<h2>Module 6: Advanced SQL Functions</h2>
<ul>
<li><a href="06-01-string-functions">String Functions</a></li>
<li><a href="06-02-numeric-functions">Numeric Functions</a></li>
<li><a href="06-03-date-time-functions">Date and Time Functions</a></li>
<li><a href="06-04-conditional-expressions">Conditional Expressions</a></li>
</ul>
<h2>Module 7: Subqueries and Nested Queries</h2>
<ul>
<li><a href="07-01-introduction-subqueries">Introduction to Subqueries</a></li>
<li><a href="07-02-correlated-subqueries">Correlated Subqueries</a></li>
<li><a href="07-03-exists-not-exists">EXISTS and NOT EXISTS</a></li>
<li><a href="07-04-using-subqueries-select-from-where">Using Subqueries in SELECT, FROM, and WHERE Clauses</a></li>
</ul>
<h2>Module 8: Indexes and Performance Optimization</h2>
<ul>
<li><a href="08-01-understanding-indexes">Understanding Indexes</a></li>
<li><a href="08-02-creating-managing-indexes">Creating and Managing Indexes</a></li>
<li><a href="08-03-query-optimization-techniques">Query Optimization Techniques</a></li>
<li><a href="08-04-analyzing-query-performance">Analyzing Query Performance</a></li>
</ul>
<h2>Module 9: Transactions and Concurrency</h2>
<ul>
<li><a href="09-01-introduction-transactions">Introduction to Transactions</a></li>
<li><a href="09-02-acid-properties">ACID Properties</a></li>
<li><a href="09-03-transaction-control-statements">Transaction Control Statements</a></li>
<li><a href="09-04-handling-concurrency">Handling Concurrency</a></li>
</ul>
<h2>Module 10: Advanced Topics</h2>
<ul>
<li><a href="10-01-stored-procedures">Stored Procedures</a></li>
<li><a href="10-02-triggers">Triggers</a></li>
<li><a href="10-03-views">Views</a></li>
<li><a href="10-04-common-table-expressions">Common Table Expressions (CTEs)</a></li>
<li><a href="10-05-window-functions">Window Functions</a></li>
</ul>
<h2>Module 11: SQL in Practice</h2>
<ul>
<li><a href="11-01-real-world-use-cases">Real-World Use Cases</a></li>
<li><a href="11-02-best-practices">Best Practices</a></li>
<li><a href="11-03-sql-data-analysis">SQL for Data Analysis</a></li>
<li><a href="11-04-sql-web-development">SQL in Web Development</a></li>
</ul>
<h2>Module 12: Final Project</h2>
<ul>
<li><a href="12-01-project-overview">Project Overview</a></li>
<li><a href="12-02-project-requirements">Project Requirements</a></li>
<li><a href="12-03-project-implementation">Project Implementation</a></li>
<li><a href="12-04-project-presentation">Project Presentation</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
</body>
</html>
