<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reflection</title>

    <link rel="alternate" href="https://campusempresa.com/mod/csharp/06-01-reflection" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/csharp/06-01-reflection" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/csharp/06-01-reflection" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/csharp/06-01-reflection" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/csharp/06-01-reflection" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-04-entity-framework' title="Entity Framework">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Reflection</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-02-attributes' title="Attributes">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Reflection in C# is a powerful feature that allows you to inspect and interact with the metadata of types at runtime. This includes examining the properties, methods, and events of an object, as well as creating instances of types dynamically. Reflection is particularly useful for scenarios such as building frameworks, performing dynamic type discovery, and creating custom attributes.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Metadata</strong>: Information about the types defined in a program, such as classes, interfaces, and methods.</li>
<li><strong>System.Reflection Namespace</strong>: Contains classes that allow you to obtain information about assemblies, modules, members, parameters, and other entities in managed code.</li>
<li><strong>Type Class</strong>: Represents type declarations: class types, interface types, array types, value types, and enumeration types.</li>
</ol>
</div><h1><p>Practical Examples</p>
</h1>
<div class='content'></div><h2><p>Example 1: Inspecting a Type</p>
</h2>
<div class='content'><p>Let's start by inspecting a simple class using reflection.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgU3lzdGVtOwp1c2luZyBTeXN0ZW0uUmVmbGVjdGlvbjsKCnB1YmxpYyBjbGFzcyBQZXJzb24KewogICAgcHVibGljIHN0cmluZyBOYW1lIHsgZ2V0OyBzZXQ7IH0KICAgIHB1YmxpYyBpbnQgQWdlIHsgZ2V0OyBzZXQ7IH0KCiAgICBwdWJsaWMgdm9pZCBTYXlIZWxsbygpCiAgICB7CiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoIkhlbGxvISIpOwogICAgfQp9CgpjbGFzcyBQcm9ncmFtCnsKICAgIHN0YXRpYyB2b2lkIE1haW4oKQogICAgewogICAgICAgIFR5cGUgcGVyc29uVHlwZSA9IHR5cGVvZihQZXJzb24pOwoKICAgICAgICBDb25zb2xlLldyaXRlTGluZSgiUHJvcGVydGllcyBvZiBQZXJzb246Iik7CiAgICAgICAgZm9yZWFjaCAoUHJvcGVydHlJbmZvIHByb3AgaW4gcGVyc29uVHlwZS5HZXRQcm9wZXJ0aWVzKCkpCiAgICAgICAgewogICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgkIlByb3BlcnR5OiB7cHJvcC5OYW1lfSwgVHlwZToge3Byb3AuUHJvcGVydHlUeXBlfSIpOwogICAgICAgIH0KCiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoIlxuTWV0aG9kcyBvZiBQZXJzb246Iik7CiAgICAgICAgZm9yZWFjaCAoTWV0aG9kSW5mbyBtZXRob2QgaW4gcGVyc29uVHlwZS5HZXRNZXRob2RzKCkpCiAgICAgICAgewogICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgkIk1ldGhvZDoge21ldGhvZC5OYW1lfSwgUmV0dXJuIFR5cGU6IHttZXRob2QuUmV0dXJuVHlwZX0iKTsKICAgICAgICB9CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using System;
using System.Reflection;

public class Person
{
    public string Name { get; set; }
    public int Age { get; set; }

    public void SayHello()
    {
        Console.WriteLine(&quot;Hello!&quot;);
    }
}

class Program
{
    static void Main()
    {
        Type personType = typeof(Person);

        Console.WriteLine(&quot;Properties of Person:&quot;);
        foreach (PropertyInfo prop in personType.GetProperties())
        {
            Console.WriteLine($&quot;Property: {prop.Name}, Type: {prop.PropertyType}&quot;);
        }

        Console.WriteLine(&quot;\nMethods of Person:&quot;);
        foreach (MethodInfo method in personType.GetMethods())
        {
            Console.WriteLine($&quot;Method: {method.Name}, Return Type: {method.ReturnType}&quot;);
        }
    }
}</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li><code>typeof(Person)</code>: Gets the <code>Type</code> object representing the <code>Person</code> class.</li>
<li><code>GetProperties()</code>: Retrieves an array of <code>PropertyInfo</code> objects representing all the public properties of the <code>Person</code> class.</li>
<li><code>GetMethods()</code>: Retrieves an array of <code>MethodInfo</code> objects representing all the public methods of the <code>Person</code> class.</li>
</ul>
</div><h2><p>Example 2: Creating an Instance Dynamically</p>
</h2>
<div class='content'><p>You can also create an instance of a type dynamically using reflection.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgU3lzdGVtOwp1c2luZyBTeXN0ZW0uUmVmbGVjdGlvbjsKCnB1YmxpYyBjbGFzcyBQZXJzb24KewogICAgcHVibGljIHN0cmluZyBOYW1lIHsgZ2V0OyBzZXQ7IH0KICAgIHB1YmxpYyBpbnQgQWdlIHsgZ2V0OyBzZXQ7IH0KCiAgICBwdWJsaWMgdm9pZCBTYXlIZWxsbygpCiAgICB7CiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoIkhlbGxvISIpOwogICAgfQp9CgpjbGFzcyBQcm9ncmFtCnsKICAgIHN0YXRpYyB2b2lkIE1haW4oKQogICAgewogICAgICAgIFR5cGUgcGVyc29uVHlwZSA9IHR5cGVvZihQZXJzb24pOwogICAgICAgIG9iamVjdCBwZXJzb25JbnN0YW5jZSA9IEFjdGl2YXRvci5DcmVhdGVJbnN0YW5jZShwZXJzb25UeXBlKTsKCiAgICAgICAgUHJvcGVydHlJbmZvIG5hbWVQcm9wZXJ0eSA9IHBlcnNvblR5cGUuR2V0UHJvcGVydHkoIk5hbWUiKTsKICAgICAgICBuYW1lUHJvcGVydHkuU2V0VmFsdWUocGVyc29uSW5zdGFuY2UsICJKb2huIERvZSIpOwoKICAgICAgICBQcm9wZXJ0eUluZm8gYWdlUHJvcGVydHkgPSBwZXJzb25UeXBlLkdldFByb3BlcnR5KCJBZ2UiKTsKICAgICAgICBhZ2VQcm9wZXJ0eS5TZXRWYWx1ZShwZXJzb25JbnN0YW5jZSwgMzApOwoKICAgICAgICBNZXRob2RJbmZvIHNheUhlbGxvTWV0aG9kID0gcGVyc29uVHlwZS5HZXRNZXRob2QoIlNheUhlbGxvIik7CiAgICAgICAgc2F5SGVsbG9NZXRob2QuSW52b2tlKHBlcnNvbkluc3RhbmNlLCBudWxsKTsKCiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoJCJOYW1lOiB7bmFtZVByb3BlcnR5LkdldFZhbHVlKHBlcnNvbkluc3RhbmNlKX0sIEFnZToge2FnZVByb3BlcnR5LkdldFZhbHVlKHBlcnNvbkluc3RhbmNlKX0iKTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using System;
using System.Reflection;

public class Person
{
    public string Name { get; set; }
    public int Age { get; set; }

    public void SayHello()
    {
        Console.WriteLine(&quot;Hello!&quot;);
    }
}

class Program
{
    static void Main()
    {
        Type personType = typeof(Person);
        object personInstance = Activator.CreateInstance(personType);

        PropertyInfo nameProperty = personType.GetProperty(&quot;Name&quot;);
        nameProperty.SetValue(personInstance, &quot;John Doe&quot;);

        PropertyInfo ageProperty = personType.GetProperty(&quot;Age&quot;);
        ageProperty.SetValue(personInstance, 30);

        MethodInfo sayHelloMethod = personType.GetMethod(&quot;SayHello&quot;);
        sayHelloMethod.Invoke(personInstance, null);

        Console.WriteLine($&quot;Name: {nameProperty.GetValue(personInstance)}, Age: {ageProperty.GetValue(personInstance)}&quot;);
    }
}</pre></div><div class='content'><p><strong>Explanation:</strong></p>
<ul>
<li><code>Activator.CreateInstance(personType)</code>: Creates an instance of the <code>Person</code> class.</li>
<li><code>GetProperty(&quot;Name&quot;)</code>: Retrieves the <code>PropertyInfo</code> object for the <code>Name</code> property.</li>
<li><code>SetValue(personInstance, &quot;John Doe&quot;)</code>: Sets the value of the <code>Name</code> property to &quot;John Doe&quot;.</li>
<li><code>GetMethod(&quot;SayHello&quot;)</code>: Retrieves the <code>MethodInfo</code> object for the <code>SayHello</code> method.</li>
<li><code>Invoke(personInstance, null)</code>: Invokes the <code>SayHello</code> method on the <code>personInstance</code>.</li>
</ul>
</div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Inspecting a Custom Class</p>
</h2>
<div class='content'><p>Create a class named <code>Car</code> with properties <code>Make</code>, <code>Model</code>, and <code>Year</code>. Use reflection to list all the properties and methods of the <code>Car</code> class.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgU3lzdGVtOwp1c2luZyBTeXN0ZW0uUmVmbGVjdGlvbjsKCnB1YmxpYyBjbGFzcyBDYXIKewogICAgcHVibGljIHN0cmluZyBNYWtlIHsgZ2V0OyBzZXQ7IH0KICAgIHB1YmxpYyBzdHJpbmcgTW9kZWwgeyBnZXQ7IHNldDsgfQogICAgcHVibGljIGludCBZZWFyIHsgZ2V0OyBzZXQ7IH0KCiAgICBwdWJsaWMgdm9pZCBEcml2ZSgpCiAgICB7CiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoIkRyaXZpbmcuLi4iKTsKICAgIH0KfQoKY2xhc3MgUHJvZ3JhbQp7CiAgICBzdGF0aWMgdm9pZCBNYWluKCkKICAgIHsKICAgICAgICBUeXBlIGNhclR5cGUgPSB0eXBlb2YoQ2FyKTsKCiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoIlByb3BlcnRpZXMgb2YgQ2FyOiIpOwogICAgICAgIGZvcmVhY2ggKFByb3BlcnR5SW5mbyBwcm9wIGluIGNhclR5cGUuR2V0UHJvcGVydGllcygpKQogICAgICAgIHsKICAgICAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoJCJQcm9wZXJ0eToge3Byb3AuTmFtZX0sIFR5cGU6IHtwcm9wLlByb3BlcnR5VHlwZX0iKTsKICAgICAgICB9CgogICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKCJcbk1ldGhvZHMgb2YgQ2FyOiIpOwogICAgICAgIGZvcmVhY2ggKE1ldGhvZEluZm8gbWV0aG9kIGluIGNhclR5cGUuR2V0TWV0aG9kcygpKQogICAgICAgIHsKICAgICAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoJCJNZXRob2Q6IHttZXRob2QuTmFtZX0sIFJldHVybiBUeXBlOiB7bWV0aG9kLlJldHVyblR5cGV9Iik7CiAgICAgICAgfQogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using System;
using System.Reflection;

public class Car
{
    public string Make { get; set; }
    public string Model { get; set; }
    public int Year { get; set; }

    public void Drive()
    {
        Console.WriteLine(&quot;Driving...&quot;);
    }
}

class Program
{
    static void Main()
    {
        Type carType = typeof(Car);

        Console.WriteLine(&quot;Properties of Car:&quot;);
        foreach (PropertyInfo prop in carType.GetProperties())
        {
            Console.WriteLine($&quot;Property: {prop.Name}, Type: {prop.PropertyType}&quot;);
        }

        Console.WriteLine(&quot;\nMethods of Car:&quot;);
        foreach (MethodInfo method in carType.GetMethods())
        {
            Console.WriteLine($&quot;Method: {method.Name}, Return Type: {method.ReturnType}&quot;);
        }
    }
}</pre></div><div class='content'></div><h2><p>Exercise 2: Dynamic Method Invocation</p>
</h2>
<div class='content'><p>Create an instance of the <code>Car</code> class dynamically and set its properties using reflection. Then, invoke the <code>Drive</code> method.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgU3lzdGVtOwp1c2luZyBTeXN0ZW0uUmVmbGVjdGlvbjsKCnB1YmxpYyBjbGFzcyBDYXIKewogICAgcHVibGljIHN0cmluZyBNYWtlIHsgZ2V0OyBzZXQ7IH0KICAgIHB1YmxpYyBzdHJpbmcgTW9kZWwgeyBnZXQ7IHNldDsgfQogICAgcHVibGljIGludCBZZWFyIHsgZ2V0OyBzZXQ7IH0KCiAgICBwdWJsaWMgdm9pZCBEcml2ZSgpCiAgICB7CiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoIkRyaXZpbmcuLi4iKTsKICAgIH0KfQoKY2xhc3MgUHJvZ3JhbQp7CiAgICBzdGF0aWMgdm9pZCBNYWluKCkKICAgIHsKICAgICAgICBUeXBlIGNhclR5cGUgPSB0eXBlb2YoQ2FyKTsKICAgICAgICBvYmplY3QgY2FySW5zdGFuY2UgPSBBY3RpdmF0b3IuQ3JlYXRlSW5zdGFuY2UoY2FyVHlwZSk7CgogICAgICAgIFByb3BlcnR5SW5mbyBtYWtlUHJvcGVydHkgPSBjYXJUeXBlLkdldFByb3BlcnR5KCJNYWtlIik7CiAgICAgICAgbWFrZVByb3BlcnR5LlNldFZhbHVlKGNhckluc3RhbmNlLCAiVG95b3RhIik7CgogICAgICAgIFByb3BlcnR5SW5mbyBtb2RlbFByb3BlcnR5ID0gY2FyVHlwZS5HZXRQcm9wZXJ0eSgiTW9kZWwiKTsKICAgICAgICBtb2RlbFByb3BlcnR5LlNldFZhbHVlKGNhckluc3RhbmNlLCAiQ29yb2xsYSIpOwoKICAgICAgICBQcm9wZXJ0eUluZm8geWVhclByb3BlcnR5ID0gY2FyVHlwZS5HZXRQcm9wZXJ0eSgiWWVhciIpOwogICAgICAgIHllYXJQcm9wZXJ0eS5TZXRWYWx1ZShjYXJJbnN0YW5jZSwgMjAyMSk7CgogICAgICAgIE1ldGhvZEluZm8gZHJpdmVNZXRob2QgPSBjYXJUeXBlLkdldE1ldGhvZCgiRHJpdmUiKTsKICAgICAgICBkcml2ZU1ldGhvZC5JbnZva2UoY2FySW5zdGFuY2UsIG51bGwpOwoKICAgICAgICBDb25zb2xlLldyaXRlTGluZSgkIk1ha2U6IHttYWtlUHJvcGVydHkuR2V0VmFsdWUoY2FySW5zdGFuY2UpfSwgTW9kZWw6IHttb2RlbFByb3BlcnR5LkdldFZhbHVlKGNhckluc3RhbmNlKX0sIFllYXI6IHt5ZWFyUHJvcGVydHkuR2V0VmFsdWUoY2FySW5zdGFuY2UpfSIpOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using System;
using System.Reflection;

public class Car
{
    public string Make { get; set; }
    public string Model { get; set; }
    public int Year { get; set; }

    public void Drive()
    {
        Console.WriteLine(&quot;Driving...&quot;);
    }
}

class Program
{
    static void Main()
    {
        Type carType = typeof(Car);
        object carInstance = Activator.CreateInstance(carType);

        PropertyInfo makeProperty = carType.GetProperty(&quot;Make&quot;);
        makeProperty.SetValue(carInstance, &quot;Toyota&quot;);

        PropertyInfo modelProperty = carType.GetProperty(&quot;Model&quot;);
        modelProperty.SetValue(carInstance, &quot;Corolla&quot;);

        PropertyInfo yearProperty = carType.GetProperty(&quot;Year&quot;);
        yearProperty.SetValue(carInstance, 2021);

        MethodInfo driveMethod = carType.GetMethod(&quot;Drive&quot;);
        driveMethod.Invoke(carInstance, null);

        Console.WriteLine($&quot;Make: {makeProperty.GetValue(carInstance)}, Model: {modelProperty.GetValue(carInstance)}, Year: {yearProperty.GetValue(carInstance)}&quot;);
    }
}</pre></div><div class='content'></div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Access Modifiers</strong>: Reflection can only access public members by default. To access non-public members, you need to use binding flags.</li>
<li><strong>Performance</strong>: Reflection is slower than direct code access. Use it judiciously, especially in performance-critical applications.</li>
<li><strong>Security</strong>: Be cautious when using reflection to invoke methods or access properties, as it can potentially expose private data or methods.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Reflection is a versatile tool in C# that allows you to inspect and manipulate types at runtime. It is particularly useful for dynamic type discovery, building frameworks, and creating custom attributes. However, it should be used judiciously due to its performance overhead and potential security implications. In the next topic, we will explore attributes, which are closely related to reflection and provide a way to add metadata to your code.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-04-entity-framework' title="Entity Framework">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-02-attributes' title="Attributes">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
