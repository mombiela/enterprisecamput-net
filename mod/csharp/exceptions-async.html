<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Handling Exceptions in Async Code</title>

    <link rel="alternate" href="https://campusempresa.com/mod/csharp/exceptions-async" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/csharp/exceptions-async" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/csharp/exceptions-async" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/csharp/exceptions-async" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/csharp/exceptions-async" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='async-await'>&#x25C4;Async and Await</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Handling Exceptions in Async Code</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-databases'>Introduction to Databases &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Handling exceptions in asynchronous code can be challenging for beginners and advanced programmers alike. This section will guide you through the basics of exception handling in async code, progressing to more advanced techniques and best practices.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Asynchronous Programming</strong>: Running tasks in the background without blocking the main thread.</li>
<li><strong>Exceptions</strong>: Errors that occur during the execution of a program.</li>
<li><strong>Exception Handling</strong>: Mechanisms to catch and handle errors gracefully.</li>
</ul>
</div><h1>Basic Exception Handling in Async Code</h1>
<div class='content'></div><h2>Using `try-catch` with `async` and `await`</h2>
<div class='content'><p>When working with asynchronous methods, you can use <code>try-catch</code> blocks to handle exceptions just like in synchronous code.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2sgRXhhbXBsZU1ldGhvZEFzeW5jKCkKewogICAgdHJ5CiAgICB7CiAgICAgICAgYXdhaXQgVGFzay5SdW4oKCkgPT4geyB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkV4Y2VwdGlvbigiQW4gZXJyb3Igb2NjdXJyZWQuIik7IH0pOwogICAgfQogICAgY2F0Y2ggKEludmFsaWRPcGVyYXRpb25FeGNlcHRpb24gZXgpCiAgICB7CiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoJCJDYXVnaHQgYW4gZXhjZXB0aW9uOiB7ZXguTWVzc2FnZX0iKTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task ExampleMethodAsync()
{
    try
    {
        await Task.Run(() =&gt; { throw new InvalidOperationException(&quot;An error occurred.&quot;); });
    }
    catch (InvalidOperationException ex)
    {
        Console.WriteLine($&quot;Caught an exception: {ex.Message}&quot;);
    }
}</pre></div><div class='content'><p>In this example:</p>
<ul>
<li><code>Task.Run</code> is used to simulate an asynchronous operation that throws an exception.</li>
<li>The <code>try-catch</code> block catches the <code>InvalidOperationException</code> and handles it by printing a message to the console.</li>
</ul>
</div><h1>Handling Exceptions in Multiple Async Methods</h1>
<div class='content'></div><h2>Propagating Exceptions</h2>
<div class='content'><p>Exceptions in async methods can propagate up the call stack. You can catch them at a higher level if needed.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2sgTWV0aG9kMUFzeW5jKCkKewogICAgYXdhaXQgTWV0aG9kMkFzeW5jKCk7Cn0KCnB1YmxpYyBhc3luYyBUYXNrIE1ldGhvZDJBc3luYygpCnsKICAgIHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXhjZXB0aW9uKCJBbiBlcnJvciBvY2N1cnJlZCBpbiBNZXRob2QyQXN5bmMuIik7Cn0KCnB1YmxpYyBhc3luYyBUYXNrIE1haW5NZXRob2RBc3luYygpCnsKICAgIHRyeQogICAgewogICAgICAgIGF3YWl0IE1ldGhvZDFBc3luYygpOwogICAgfQogICAgY2F0Y2ggKEludmFsaWRPcGVyYXRpb25FeGNlcHRpb24gZXgpCiAgICB7CiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoJCJDYXVnaHQgYW4gZXhjZXB0aW9uOiB7ZXguTWVzc2FnZX0iKTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task Method1Async()
{
    await Method2Async();
}

public async Task Method2Async()
{
    throw new InvalidOperationException(&quot;An error occurred in Method2Async.&quot;);
}

public async Task MainMethodAsync()
{
    try
    {
        await Method1Async();
    }
    catch (InvalidOperationException ex)
    {
        Console.WriteLine($&quot;Caught an exception: {ex.Message}&quot;);
    }
}</pre></div><div class='content'><p>In this example:</p>
<ul>
<li><code>Method2Async</code> throws an exception.</li>
<li><code>Method1Async</code> calls <code>Method2Async</code> but does not handle the exception.</li>
<li><code>MainMethodAsync</code> calls <code>Method1Async</code> and catches the propagated exception.</li>
</ul>
</div><h1>Advanced Exception Handling</h1>
<div class='content'></div><h2>Using `Task.WhenAll` with Exception Handling</h2>
<div class='content'><p>When running multiple tasks concurrently, you can use <code>Task.WhenAll</code> to wait for all tasks to complete and handle exceptions.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2sgUnVuTXVsdGlwbGVUYXNrc0FzeW5jKCkKewogICAgdmFyIHRhc2sxID0gVGFzay5SdW4oKCkgPT4geyB0aHJvdyBuZXcgSW52YWxpZE9wZXJhdGlvbkV4Y2VwdGlvbigiVGFzazEgZmFpbGVkLiIpOyB9KTsKICAgIHZhciB0YXNrMiA9IFRhc2suUnVuKCgpID0+IHsgdGhyb3cgbmV3IEludmFsaWRPcGVyYXRpb25FeGNlcHRpb24oIlRhc2syIGZhaWxlZC4iKTsgfSk7CgogICAgdHJ5CiAgICB7CiAgICAgICAgYXdhaXQgVGFzay5XaGVuQWxsKHRhc2sxLCB0YXNrMik7CiAgICB9CiAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgewogICAgICAgIGZvcmVhY2ggKHZhciBpbm5lckV4Y2VwdGlvbiBpbiBleC5Jbm5lckV4Y2VwdGlvbnMpCiAgICAgICAgewogICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgkIkNhdWdodCBhbiBleGNlcHRpb246IHtpbm5lckV4Y2VwdGlvbi5NZXNzYWdlfSIpOwogICAgICAgIH0KICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task RunMultipleTasksAsync()
{
    var task1 = Task.Run(() =&gt; { throw new InvalidOperationException(&quot;Task1 failed.&quot;); });
    var task2 = Task.Run(() =&gt; { throw new InvalidOperationException(&quot;Task2 failed.&quot;); });

    try
    {
        await Task.WhenAll(task1, task2);
    }
    catch (Exception ex)
    {
        foreach (var innerException in ex.InnerExceptions)
        {
            Console.WriteLine($&quot;Caught an exception: {innerException.Message}&quot;);
        }
    }
}</pre></div><div class='content'><p>In this example:</p>
<ul>
<li>Two tasks are created, both of which throw exceptions.</li>
<li><code>Task.WhenAll</code> waits for both tasks to complete.</li>
<li>The <code>catch</code> block iterates through <code>InnerExceptions</code> to handle each exception individually.</li>
</ul>
</div><h2>Using `Task.Exception` Property</h2>
<div class='content'><p>You can also access the <code>Exception</code> property of a <code>Task</code> to handle exceptions after the task has completed.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2sgSGFuZGxlVGFza0V4Y2VwdGlvbkFzeW5jKCkKewogICAgdmFyIHRhc2sgPSBUYXNrLlJ1bigoKSA9PiB7IHRocm93IG5ldyBJbnZhbGlkT3BlcmF0aW9uRXhjZXB0aW9uKCJUYXNrIGZhaWxlZC4iKTsgfSk7CgogICAgdHJ5CiAgICB7CiAgICAgICAgYXdhaXQgdGFzazsKICAgIH0KICAgIGNhdGNoCiAgICB7CiAgICAgICAgaWYgKHRhc2suRXhjZXB0aW9uICE9IG51bGwpCiAgICAgICAgewogICAgICAgICAgICBmb3JlYWNoICh2YXIgaW5uZXJFeGNlcHRpb24gaW4gdGFzay5FeGNlcHRpb24uSW5uZXJFeGNlcHRpb25zKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgkIkNhdWdodCBhbiBleGNlcHRpb246IHtpbm5lckV4Y2VwdGlvbi5NZXNzYWdlfSIpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task HandleTaskExceptionAsync()
{
    var task = Task.Run(() =&gt; { throw new InvalidOperationException(&quot;Task failed.&quot;); });

    try
    {
        await task;
    }
    catch
    {
        if (task.Exception != null)
        {
            foreach (var innerException in task.Exception.InnerExceptions)
            {
                Console.WriteLine($&quot;Caught an exception: {innerException.Message}&quot;);
            }
        }
    }
}</pre></div><div class='content'><p>In this example:</p>
<ul>
<li>A task is created that throws an exception.</li>
<li>The <code>catch</code> block checks the <code>Exception</code> property of the task and handles each inner exception.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Handling exceptions in async code is crucial for building robust and reliable applications. By understanding and applying the techniques discussed in this section, you can effectively manage errors in your asynchronous methods. Remember to:</p>
<ul>
<li>Use <code>try-catch</code> blocks to handle exceptions in async methods.</li>
<li>Propagate exceptions to higher levels when necessary.</li>
<li>Utilize <code>Task.WhenAll</code> and the <code>Exception</code> property of tasks for advanced exception handling scenarios.</li>
</ul>
<p>With these tools and techniques, you'll be well-equipped to handle exceptions in your C# async code, ensuring your applications run smoothly even when unexpected errors occur.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='async-await'>&#x25C4;Async and Await</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Handling Exceptions in Async Code</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-databases'>Introduction to Databases &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
