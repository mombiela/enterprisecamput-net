<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Management and Garbage Collection</title>

    <link rel="alternate" href="https://campusempresa.com/mod/csharp/06-04-memory-management-and-garbage-collection" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/csharp/06-04-memory-management-and-garbage-collection" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/csharp/06-04-memory-management-and-garbage-collection" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/csharp/06-04-memory-management-and-garbage-collection" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/csharp/06-04-memory-management-and-garbage-collection" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Programming Languages</a>
				 					<a href="/categ/frameworks">Frameworks and Libraries</a>
				 					<a href="/categ/tech-tools">Technical Tools</a>
				 					<a href="/categ/foundations">Theoretical Foundations</a>
				 					<a href="/categ/soft-skills">Social Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-03-dynamic-programming' title="Dynamic Programming">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Memory Management and Garbage Collection</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-05-multithreading-and-parallel-programming' title="Multithreading and Parallel Programming">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Memory management is a critical aspect of programming in C#. Understanding how memory is allocated, used, and freed is essential for writing efficient and effective applications. In this section, we will explore the concepts of memory management and garbage collection in C#.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'></div><h2><ol>
<li>Memory Allocation</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Stack Memory</strong>: Used for static memory allocation. It stores value types and references to objects.</li>
<li><strong>Heap Memory</strong>: Used for dynamic memory allocation. It stores objects and arrays.</li>
</ul>
</div><h2><ol start="2">
<li>Value Types vs. Reference Types</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Value Types</strong>: Stored in stack memory. Examples include <code>int</code>, <code>float</code>, <code>char</code>, and <code>struct</code>.</li>
<li><strong>Reference Types</strong>: Stored in heap memory. Examples include <code>class</code>, <code>array</code>, <code>delegate</code>, and <code>string</code>.</li>
</ul>
</div><h2><ol start="3">
<li>Garbage Collection</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Garbage Collector (GC)</strong>: An automatic memory management feature in C#. It reclaims memory occupied by objects that are no longer in use.</li>
<li><strong>Generations</strong>: The GC categorizes objects into three generations (0, 1, and 2) to optimize performance.
<ul>
<li><strong>Generation 0</strong>: Short-lived objects.</li>
<li><strong>Generation 1</strong>: Objects that survived one GC cycle.</li>
<li><strong>Generation 2</strong>: Long-lived objects.</li>
</ul>
</li>
</ul>
</div><h1><p>Practical Examples</p>
</h1>
<div class='content'></div><h2><p>Example 1: Value Types and Reference Types</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgU3lzdGVtOwoKY2xhc3MgUHJvZ3JhbQp7CiAgICBzdHJ1Y3QgVmFsdWVUeXBlRXhhbXBsZQogICAgewogICAgICAgIHB1YmxpYyBpbnQgeDsKICAgIH0KCiAgICBjbGFzcyBSZWZlcmVuY2VUeXBlRXhhbXBsZQogICAgewogICAgICAgIHB1YmxpYyBpbnQgeTsKICAgIH0KCiAgICBzdGF0aWMgdm9pZCBNYWluKCkKICAgIHsKICAgICAgICAvLyBWYWx1ZSB0eXBlCiAgICAgICAgVmFsdWVUeXBlRXhhbXBsZSB2YWx1ZVR5cGUgPSBuZXcgVmFsdWVUeXBlRXhhbXBsZSgpOwogICAgICAgIHZhbHVlVHlwZS54ID0gMTA7CiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoIlZhbHVlIFR5cGU6ICIgKyB2YWx1ZVR5cGUueCk7CgogICAgICAgIC8vIFJlZmVyZW5jZSB0eXBlCiAgICAgICAgUmVmZXJlbmNlVHlwZUV4YW1wbGUgcmVmZXJlbmNlVHlwZSA9IG5ldyBSZWZlcmVuY2VUeXBlRXhhbXBsZSgpOwogICAgICAgIHJlZmVyZW5jZVR5cGUueSA9IDIwOwogICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKCJSZWZlcmVuY2UgVHlwZTogIiArIHJlZmVyZW5jZVR5cGUueSk7CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using System;

class Program
{
    struct ValueTypeExample
    {
        public int x;
    }

    class ReferenceTypeExample
    {
        public int y;
    }

    static void Main()
    {
        // Value type
        ValueTypeExample valueType = new ValueTypeExample();
        valueType.x = 10;
        Console.WriteLine(&quot;Value Type: &quot; + valueType.x);

        // Reference type
        ReferenceTypeExample referenceType = new ReferenceTypeExample();
        referenceType.y = 20;
        Console.WriteLine(&quot;Reference Type: &quot; + referenceType.y);
    }
}</pre></div><div class='content'></div><h2><p>Example 2: Garbage Collection</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgU3lzdGVtOwoKY2xhc3MgUHJvZ3JhbQp7CiAgICBzdGF0aWMgdm9pZCBNYWluKCkKICAgIHsKICAgICAgICAvLyBDcmVhdGluZyBvYmplY3RzCiAgICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCAxMDAwOyBpKyspCiAgICAgICAgewogICAgICAgICAgICB2YXIgb2JqID0gbmV3IG9iamVjdCgpOwogICAgICAgIH0KCiAgICAgICAgLy8gRm9yY2luZyBnYXJiYWdlIGNvbGxlY3Rpb24KICAgICAgICBHQy5Db2xsZWN0KCk7CiAgICAgICAgR0MuV2FpdEZvclBlbmRpbmdGaW5hbGl6ZXJzKCk7CgogICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKCJHYXJiYWdlIENvbGxlY3Rpb24gY29tcGxldGVkLiIpOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using System;

class Program
{
    static void Main()
    {
        // Creating objects
        for (int i = 0; i &lt; 1000; i++)
        {
            var obj = new object();
        }

        // Forcing garbage collection
        GC.Collect();
        GC.WaitForPendingFinalizers();

        Console.WriteLine(&quot;Garbage Collection completed.&quot;);
    }
}</pre></div><div class='content'></div><h1><p>Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Understanding Memory Allocation</p>
</h2>
<div class='content'><p><strong>Task</strong>: Create a program that demonstrates the difference between value types and reference types in terms of memory allocation.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgU3lzdGVtOwoKY2xhc3MgTWVtb3J5QWxsb2NhdGlvbkRlbW8KewogICAgc3RydWN0IFZhbHVlVHlwZQogICAgewogICAgICAgIHB1YmxpYyBpbnQgYTsKICAgIH0KCiAgICBjbGFzcyBSZWZlcmVuY2VUeXBlCiAgICB7CiAgICAgICAgcHVibGljIGludCBiOwogICAgfQoKICAgIHN0YXRpYyB2b2lkIE1haW4oKQogICAgewogICAgICAgIFZhbHVlVHlwZSB2YWx1ZVR5cGUxID0gbmV3IFZhbHVlVHlwZSgpOwogICAgICAgIHZhbHVlVHlwZTEuYSA9IDU7CgogICAgICAgIFZhbHVlVHlwZSB2YWx1ZVR5cGUyID0gdmFsdWVUeXBlMTsKICAgICAgICB2YWx1ZVR5cGUyLmEgPSAxMDsKCiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoIlZhbHVlVHlwZTE6ICIgKyB2YWx1ZVR5cGUxLmEpOyAvLyBPdXRwdXQ6IDUKICAgICAgICBDb25zb2xlLldyaXRlTGluZSgiVmFsdWVUeXBlMjogIiArIHZhbHVlVHlwZTIuYSk7IC8vIE91dHB1dDogMTAKCiAgICAgICAgUmVmZXJlbmNlVHlwZSByZWZlcmVuY2VUeXBlMSA9IG5ldyBSZWZlcmVuY2VUeXBlKCk7CiAgICAgICAgcmVmZXJlbmNlVHlwZTEuYiA9IDE1OwoKICAgICAgICBSZWZlcmVuY2VUeXBlIHJlZmVyZW5jZVR5cGUyID0gcmVmZXJlbmNlVHlwZTE7CiAgICAgICAgcmVmZXJlbmNlVHlwZTIuYiA9IDIwOwoKICAgICAgICBDb25zb2xlLldyaXRlTGluZSgiUmVmZXJlbmNlVHlwZTE6ICIgKyByZWZlcmVuY2VUeXBlMS5iKTsgLy8gT3V0cHV0OiAyMAogICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKCJSZWZlcmVuY2VUeXBlMjogIiArIHJlZmVyZW5jZVR5cGUyLmIpOyAvLyBPdXRwdXQ6IDIwCiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using System;

class MemoryAllocationDemo
{
    struct ValueType
    {
        public int a;
    }

    class ReferenceType
    {
        public int b;
    }

    static void Main()
    {
        ValueType valueType1 = new ValueType();
        valueType1.a = 5;

        ValueType valueType2 = valueType1;
        valueType2.a = 10;

        Console.WriteLine(&quot;ValueType1: &quot; + valueType1.a); // Output: 5
        Console.WriteLine(&quot;ValueType2: &quot; + valueType2.a); // Output: 10

        ReferenceType referenceType1 = new ReferenceType();
        referenceType1.b = 15;

        ReferenceType referenceType2 = referenceType1;
        referenceType2.b = 20;

        Console.WriteLine(&quot;ReferenceType1: &quot; + referenceType1.b); // Output: 20
        Console.WriteLine(&quot;ReferenceType2: &quot; + referenceType2.b); // Output: 20
    }
}</pre></div><div class='content'></div><h2><p>Exercise 2: Forcing Garbage Collection</p>
</h2>
<div class='content'><p><strong>Task</strong>: Write a program that creates a large number of objects and then forces garbage collection. Observe the memory usage before and after garbage collection.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgU3lzdGVtOwoKY2xhc3MgR2FyYmFnZUNvbGxlY3Rpb25EZW1vCnsKICAgIHN0YXRpYyB2b2lkIE1haW4oKQogICAgewogICAgICAgIC8vIENyZWF0aW5nIGEgbGFyZ2UgbnVtYmVyIG9mIG9iamVjdHMKICAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IDEwMDAwMDsgaSsrKQogICAgICAgIHsKICAgICAgICAgICAgdmFyIG9iaiA9IG5ldyBvYmplY3QoKTsKICAgICAgICB9CgogICAgICAgIC8vIERpc3BsYXkgbWVtb3J5IHVzYWdlIGJlZm9yZSBnYXJiYWdlIGNvbGxlY3Rpb24KICAgICAgICBDb25zb2xlLldyaXRlTGluZSgiTWVtb3J5IHVzZWQgYmVmb3JlIEdDOiAiICsgR0MuR2V0VG90YWxNZW1vcnkoZmFsc2UpKTsKCiAgICAgICAgLy8gRm9yY2luZyBnYXJiYWdlIGNvbGxlY3Rpb24KICAgICAgICBHQy5Db2xsZWN0KCk7CiAgICAgICAgR0MuV2FpdEZvclBlbmRpbmdGaW5hbGl6ZXJzKCk7CgogICAgICAgIC8vIERpc3BsYXkgbWVtb3J5IHVzYWdlIGFmdGVyIGdhcmJhZ2UgY29sbGVjdGlvbgogICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKCJNZW1vcnkgdXNlZCBhZnRlciBHQzogIiArIEdDLkdldFRvdGFsTWVtb3J5KHRydWUpKTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using System;

class GarbageCollectionDemo
{
    static void Main()
    {
        // Creating a large number of objects
        for (int i = 0; i &lt; 100000; i++)
        {
            var obj = new object();
        }

        // Display memory usage before garbage collection
        Console.WriteLine(&quot;Memory used before GC: &quot; + GC.GetTotalMemory(false));

        // Forcing garbage collection
        GC.Collect();
        GC.WaitForPendingFinalizers();

        // Display memory usage after garbage collection
        Console.WriteLine(&quot;Memory used after GC: &quot; + GC.GetTotalMemory(true));
    }
}</pre></div><div class='content'></div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li>
<p><strong>Mistake</strong>: Assuming that the garbage collector will immediately free memory.</p>
<ul>
<li><strong>Tip</strong>: The garbage collector runs on its own schedule. Use <code>GC.Collect()</code> only for testing purposes, not in production code.</li>
</ul>
</li>
<li>
<p><strong>Mistake</strong>: Not understanding the difference between value types and reference types.</p>
<ul>
<li><strong>Tip</strong>: Remember that value types are stored in the stack and reference types in the heap. This affects how they are copied and managed.</li>
</ul>
</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered the basics of memory management and garbage collection in C#. We explored how memory is allocated for value types and reference types, and how the garbage collector works to reclaim memory. Understanding these concepts is crucial for writing efficient and effective C# applications. In the next section, we will delve into more advanced topics in C#.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-03-dynamic-programming' title="Dynamic Programming">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-05-multithreading-and-parallel-programming' title="Multithreading and Parallel Programming">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
