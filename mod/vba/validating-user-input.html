<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validating User Input</title>

    <link rel="alternate" href="https://campusempresa.com/mod/vba/validating-user-input" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/vba/validating-user-input" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/vba/validating-user-input" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/vba/validating-user-input" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/vba/validating-user-input" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='event-handling-in-user-forms'>&#x25C4;Event Handling in User Forms</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Validating User Input</a>
	</div>
	<div class='col-4 text-end'>
					<a href='advanced-user-form-techniques'>Advanced User Form Techniques &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Validating user input is a crucial aspect of programming, ensuring that the data entered by users is correct, complete, and within the expected format. In VBA (Visual Basic for Applications), input validation helps prevent errors and improve the robustness of your applications. This topic will guide you through the basics of validating user input in VBA, progressing to more advanced techniques.</p>
</div><h1>Why Validate User Input?</h1>
<div class='content'><ul>
<li><strong>Prevent Errors:</strong> Avoid runtime errors caused by invalid data.</li>
<li><strong>Improve Data Quality:</strong> Ensure data integrity and consistency.</li>
<li><strong>Enhance User Experience:</strong> Provide immediate feedback to users, guiding them to enter correct information.</li>
</ul>
</div><h1>Basic Input Validation</h1>
<div class='content'></div><h2>Using `IsNumeric` Function</h2>
<div class='content'><p>The <code>IsNumeric</code> function checks if a value can be evaluated as a number.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGltIHVzZXJJbnB1dCBBcyBTdHJpbmcKdXNlcklucHV0ID0gSW5wdXRCb3goIkVudGVyIGEgbnVtYmVyOiIpCgpJZiBJc051bWVyaWModXNlcklucHV0KSBUaGVuCiAgICBNc2dCb3ggIlZhbGlkIG51bWJlcjogIiAmIHVzZXJJbnB1dApFbHNlCiAgICBNc2dCb3ggIkludmFsaWQgaW5wdXQuIFBsZWFzZSBlbnRlciBhIG51bWJlci4iCkVuZCBJZg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dim userInput As String
userInput = InputBox(&quot;Enter a number:&quot;)

If IsNumeric(userInput) Then
    MsgBox &quot;Valid number: &quot; &amp; userInput
Else
    MsgBox &quot;Invalid input. Please enter a number.&quot;
End If</pre></div><div class='content'></div><h2>Checking for Empty Input</h2>
<div class='content'><p>Use the <code>Len</code> function to check if the input is empty.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGltIHVzZXJJbnB1dCBBcyBTdHJpbmcKdXNlcklucHV0ID0gSW5wdXRCb3goIkVudGVyIHlvdXIgbmFtZToiKQoKSWYgTGVuKHVzZXJJbnB1dCkgPSAwIFRoZW4KICAgIE1zZ0JveCAiSW5wdXQgY2Fubm90IGJlIGVtcHR5LiBQbGVhc2UgZW50ZXIgeW91ciBuYW1lLiIKRWxzZQogICAgTXNnQm94ICJIZWxsbywgIiAmIHVzZXJJbnB1dApFbmQgSWY="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dim userInput As String
userInput = InputBox(&quot;Enter your name:&quot;)

If Len(userInput) = 0 Then
    MsgBox &quot;Input cannot be empty. Please enter your name.&quot;
Else
    MsgBox &quot;Hello, &quot; &amp; userInput
End If</pre></div><div class='content'></div><h1>Intermediate Input Validation</h1>
<div class='content'></div><h2>Using `Like` Operator for Pattern Matching</h2>
<div class='content'><p>The <code>Like</code> operator allows you to check if a string matches a specific pattern.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGltIHVzZXJJbnB1dCBBcyBTdHJpbmcKdXNlcklucHV0ID0gSW5wdXRCb3goIkVudGVyIHlvdXIgZW1haWwgYWRkcmVzczoiKQoKSWYgdXNlcklucHV0IExpa2UgIipAKi4qIiBUaGVuCiAgICBNc2dCb3ggIlZhbGlkIGVtYWlsIGFkZHJlc3M6ICIgJiB1c2VySW5wdXQKRWxzZQogICAgTXNnQm94ICJJbnZhbGlkIGVtYWlsIGFkZHJlc3MuIFBsZWFzZSBlbnRlciBhIHZhbGlkIGVtYWlsLiIKRW5kIElm"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dim userInput As String
userInput = InputBox(&quot;Enter your email address:&quot;)

If userInput Like &quot;*@*.*&quot; Then
    MsgBox &quot;Valid email address: &quot; &amp; userInput
Else
    MsgBox &quot;Invalid email address. Please enter a valid email.&quot;
End If</pre></div><div class='content'></div><h2>Combining Multiple Checks</h2>
<div class='content'><p>You can combine multiple validation checks to ensure comprehensive input validation.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGltIHVzZXJJbnB1dCBBcyBTdHJpbmcKdXNlcklucHV0ID0gSW5wdXRCb3goIkVudGVyIHlvdXIgYWdlOiIpCgpJZiBMZW4odXNlcklucHV0KSA9IDAgVGhlbgogICAgTXNnQm94ICJJbnB1dCBjYW5ub3QgYmUgZW1wdHkuIFBsZWFzZSBlbnRlciB5b3VyIGFnZS4iCkVsc2VJZiBOb3QgSXNOdW1lcmljKHVzZXJJbnB1dCkgVGhlbgogICAgTXNnQm94ICJJbnZhbGlkIGlucHV0LiBQbGVhc2UgZW50ZXIgYSBudW1lcmljIHZhbHVlLiIKRWxzZUlmIENJbnQodXNlcklucHV0KSA8IDAgT3IgQ0ludCh1c2VySW5wdXQpID4gMTIwIFRoZW4KICAgIE1zZ0JveCAiSW52YWxpZCBhZ2UuIFBsZWFzZSBlbnRlciBhIHZhbHVlIGJldHdlZW4gMCBhbmQgMTIwLiIKRWxzZQogICAgTXNnQm94ICJWYWxpZCBhZ2U6ICIgJiB1c2VySW5wdXQKRW5kIElm"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dim userInput As String
userInput = InputBox(&quot;Enter your age:&quot;)

If Len(userInput) = 0 Then
    MsgBox &quot;Input cannot be empty. Please enter your age.&quot;
ElseIf Not IsNumeric(userInput) Then
    MsgBox &quot;Invalid input. Please enter a numeric value.&quot;
ElseIf CInt(userInput) &lt; 0 Or CInt(userInput) &gt; 120 Then
    MsgBox &quot;Invalid age. Please enter a value between 0 and 120.&quot;
Else
    MsgBox &quot;Valid age: &quot; &amp; userInput
End If</pre></div><div class='content'></div><h1>Advanced Input Validation</h1>
<div class='content'></div><h2>Using Custom Functions for Validation</h2>
<div class='content'><p>Create custom functions to encapsulate validation logic, making your code more modular and reusable.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnVuY3Rpb24gSXNWYWxpZEVtYWlsKGVtYWlsIEFzIFN0cmluZykgQXMgQm9vbGVhbgogICAgSXNWYWxpZEVtYWlsID0gZW1haWwgTGlrZSAiKkAqLioiCkVuZCBGdW5jdGlvbgoKU3ViIFZhbGlkYXRlRW1haWwoKQogICAgRGltIHVzZXJJbnB1dCBBcyBTdHJpbmcKICAgIHVzZXJJbnB1dCA9IElucHV0Qm94KCJFbnRlciB5b3VyIGVtYWlsIGFkZHJlc3M6IikKCiAgICBJZiBJc1ZhbGlkRW1haWwodXNlcklucHV0KSBUaGVuCiAgICAgICAgTXNnQm94ICJWYWxpZCBlbWFpbCBhZGRyZXNzOiAiICYgdXNlcklucHV0CiAgICBFbHNlCiAgICAgICAgTXNnQm94ICJJbnZhbGlkIGVtYWlsIGFkZHJlc3MuIFBsZWFzZSBlbnRlciBhIHZhbGlkIGVtYWlsLiIKICAgIEVuZCBJZgpFbmQgU3Vi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Function IsValidEmail(email As String) As Boolean
    IsValidEmail = email Like &quot;*@*.*&quot;
End Function

Sub ValidateEmail()
    Dim userInput As String
    userInput = InputBox(&quot;Enter your email address:&quot;)

    If IsValidEmail(userInput) Then
        MsgBox &quot;Valid email address: &quot; &amp; userInput
    Else
        MsgBox &quot;Invalid email address. Please enter a valid email.&quot;
    End If
End Sub</pre></div><div class='content'></div><h2>Using Regular Expressions</h2>
<div class='content'><p>For more complex patterns, use regular expressions with the <code>VbScript_RegExp_55</code> library.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIFZhbGlkYXRlUGhvbmVOdW1iZXIoKQogICAgRGltIHVzZXJJbnB1dCBBcyBTdHJpbmcKICAgIERpbSByZWdleCBBcyBPYmplY3QKICAgIFNldCByZWdleCA9IENyZWF0ZU9iamVjdCgiVkJTY3JpcHQuUmVnRXhwIikKICAgIAogICAgcmVnZXguUGF0dGVybiA9ICJeXGR7M30tXGR7M30tXGR7NH0kIgogICAgcmVnZXguSWdub3JlQ2FzZSA9IFRydWUKICAgIAogICAgdXNlcklucHV0ID0gSW5wdXRCb3goIkVudGVyIHlvdXIgcGhvbmUgbnVtYmVyIChYWFgtWFhYLVhYWFgpOiIpCiAgICAKICAgIElmIHJlZ2V4LlRlc3QodXNlcklucHV0KSBUaGVuCiAgICAgICAgTXNnQm94ICJWYWxpZCBwaG9uZSBudW1iZXI6ICIgJiB1c2VySW5wdXQKICAgIEVsc2UKICAgICAgICBNc2dCb3ggIkludmFsaWQgcGhvbmUgbnVtYmVyLiBQbGVhc2UgZW50ZXIgaW4gdGhlIGZvcm1hdCBYWFgtWFhYLVhYWFguIgogICAgRW5kIElmCkVuZCBTdWI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub ValidatePhoneNumber()
    Dim userInput As String
    Dim regex As Object
    Set regex = CreateObject(&quot;VBScript.RegExp&quot;)
    
    regex.Pattern = &quot;^\d{3}-\d{3}-\d{4}$&quot;
    regex.IgnoreCase = True
    
    userInput = InputBox(&quot;Enter your phone number (XXX-XXX-XXXX):&quot;)
    
    If regex.Test(userInput) Then
        MsgBox &quot;Valid phone number: &quot; &amp; userInput
    Else
        MsgBox &quot;Invalid phone number. Please enter in the format XXX-XXX-XXXX.&quot;
    End If
End Sub</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Validating user input is essential for creating reliable and user-friendly VBA applications. Starting with basic checks like <code>IsNumeric</code> and <code>Len</code>, you can progress to more sophisticated techniques such as pattern matching with the <code>Like</code> operator, custom validation functions, and regular expressions. By implementing robust input validation, you ensure that your applications handle user data correctly and efficiently.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='event-handling-in-user-forms'>&#x25C4;Event Handling in User Forms</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Validating User Input</a>
	</div>
	<div class='col-4 text-end'>
					<a href='advanced-user-form-techniques'>Advanced User Form Techniques &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
