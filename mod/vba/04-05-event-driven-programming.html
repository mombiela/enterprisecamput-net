<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event-Driven Programming</title>

    <link rel="alternate" href="https://campusempresa.com/mod/vba/04-05-event-driven-programming" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/vba/04-05-event-driven-programming" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/vba/04-05-event-driven-programming" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/vba/04-05-event-driven-programming" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/vba/04-05-event-driven-programming" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-04-working-with-userforms' title="Working with UserForms">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Event-Driven Programming</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-automating-word-vba' title="Automating Word with VBA">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Event-driven programming is a paradigm in which the flow of the program is determined by events such as user actions (mouse clicks, key presses), sensor outputs, or messages from other programs. In VBA, event-driven programming is particularly powerful when working with Excel, as it allows you to create interactive and responsive applications.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Events</strong>: Actions or occurrences that happen during the execution of a program that the program can respond to.</li>
<li><strong>Event Handlers</strong>: Special procedures that are executed in response to an event.</li>
<li><strong>Object Events</strong>: Events that are associated with Excel objects like Workbooks, Worksheets, and UserForms.</li>
</ol>
</div><h1>Common Events in Excel VBA</h1>
<div class='content'><table>
<thead>
<tr>
<th>Object</th>
<th>Event</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Workbook</td>
<td><code>Open</code></td>
<td>Triggered when a workbook is opened.</td>
</tr>
<tr>
<td>Workbook</td>
<td><code>BeforeClose</code></td>
<td>Triggered before a workbook is closed.</td>
</tr>
<tr>
<td>Worksheet</td>
<td><code>Change</code></td>
<td>Triggered when a cell value is changed.</td>
</tr>
<tr>
<td>Worksheet</td>
<td><code>SelectionChange</code></td>
<td>Triggered when the selection changes.</td>
</tr>
<tr>
<td>UserForm</td>
<td><code>Initialize</code></td>
<td>Triggered when a UserForm is initialized.</td>
</tr>
<tr>
<td>UserForm</td>
<td><code>Click</code></td>
<td>Triggered when a control on the UserForm is clicked.</td>
</tr>
</tbody>
</table>
</div><h1>Practical Example: Worksheet Change Event</h1>
<div class='content'><p>Let's create a simple example where we respond to a change in a worksheet cell.</p>
</div><h2>Step-by-Step Guide</h2>
<div class='content'><ol>
<li>
<p><strong>Open the VBA Editor</strong>:</p>
<ul>
<li>Press <code>Alt + F11</code> to open the VBA Editor.</li>
</ul>
</li>
<li>
<p><strong>Insert a New Module</strong>:</p>
<ul>
<li>In the Project Explorer, find the worksheet you want to work with (e.g., <code>Sheet1</code>).</li>
<li>Double-click on <code>Sheet1</code> to open its code window.</li>
</ul>
</li>
<li>
<p><strong>Write the Event Handler</strong>:</p>
<ul>
<li>In the code window, select <code>Worksheet</code> from the left dropdown and <code>Change</code> from the right dropdown. This will automatically create the <code>Worksheet_Change</code> event handler.</li>
</ul>
</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJpdmF0ZSBTdWIgV29ya3NoZWV0X0NoYW5nZShCeVZhbCBUYXJnZXQgQXMgUmFuZ2UpCiAgICAnIENoZWNrIGlmIHRoZSBjaGFuZ2VkIGNlbGwgaXMgaW4gY29sdW1uIEEKICAgIElmIE5vdCBJbnRlcnNlY3QoVGFyZ2V0LCBNZS5SYW5nZSgiQTpBIikpIElzIE5vdGhpbmcgVGhlbgogICAgICAgICcgRGlzcGxheSBhIG1lc3NhZ2UgYm94IHdpdGggdGhlIG5ldyB2YWx1ZQogICAgICAgIE1zZ0JveCAiWW91IGNoYW5nZWQgdGhlIHZhbHVlIGluIGNvbHVtbiBBIHRvOiAiICYgVGFyZ2V0LlZhbHVlCiAgICBFbmQgSWYKRW5kIFN1Yg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Private Sub Worksheet_Change(ByVal Target As Range)
    ' Check if the changed cell is in column A
    If Not Intersect(Target, Me.Range(&quot;A:A&quot;)) Is Nothing Then
        ' Display a message box with the new value
        MsgBox &quot;You changed the value in column A to: &quot; &amp; Target.Value
    End If
End Sub</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Private Sub Worksheet_Change(ByVal Target As Range)</strong>: This is the event handler for the <code>Change</code> event. <code>Target</code> represents the range of cells that were changed.</li>
<li><strong>If Not Intersect(Target, Me.Range(&quot;A:A&quot;)) Is Nothing Then</strong>: This checks if the changed cell is in column A.</li>
<li><strong>MsgBox &quot;You changed the value in column A to: &quot; &amp; Target.Value</strong>: Displays a message box with the new value of the changed cell.</li>
</ul>
</div><h2>Practical Exercise</h2>
<div class='content'><p><strong>Task</strong>: Create an event handler that changes the background color of any cell in column B to yellow when its value is changed.</p>
<ol>
<li>Open the VBA Editor (<code>Alt + F11</code>).</li>
<li>Double-click on <code>Sheet1</code> in the Project Explorer.</li>
<li>Write the following code in the <code>Sheet1</code> code window:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJpdmF0ZSBTdWIgV29ya3NoZWV0X0NoYW5nZShCeVZhbCBUYXJnZXQgQXMgUmFuZ2UpCiAgICAnIENoZWNrIGlmIHRoZSBjaGFuZ2VkIGNlbGwgaXMgaW4gY29sdW1uIEIKICAgIElmIE5vdCBJbnRlcnNlY3QoVGFyZ2V0LCBNZS5SYW5nZSgiQjpCIikpIElzIE5vdGhpbmcgVGhlbgogICAgICAgICcgQ2hhbmdlIHRoZSBiYWNrZ3JvdW5kIGNvbG9yIHRvIHllbGxvdwogICAgICAgIFRhcmdldC5JbnRlcmlvci5Db2xvciA9IFJHQigyNTUsIDI1NSwgMCkKICAgIEVuZCBJZgpFbmQgU3Vi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Private Sub Worksheet_Change(ByVal Target As Range)
    ' Check if the changed cell is in column B
    If Not Intersect(Target, Me.Range(&quot;B:B&quot;)) Is Nothing Then
        ' Change the background color to yellow
        Target.Interior.Color = RGB(255, 255, 0)
    End If
End Sub</pre></div><div class='content'></div><h2>Solution Explanation</h2>
<div class='content'><ul>
<li><strong>Target.Interior.Color = RGB(255, 255, 0)</strong>: This line changes the background color of the changed cell to yellow using the RGB color model.</li>
</ul>
</div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Forgetting to Check the Target Range</strong>: Always ensure you check if the <code>Target</code> is within the range you are interested in. This prevents your code from running unnecessarily.</li>
<li><strong>Using <code>Application.EnableEvents</code></strong>: If your event handler changes the cell value, it can trigger the event again, causing a loop. Use <code>Application.EnableEvents = False</code> to temporarily disable events if needed.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJpdmF0ZSBTdWIgV29ya3NoZWV0X0NoYW5nZShCeVZhbCBUYXJnZXQgQXMgUmFuZ2UpCiAgICBPbiBFcnJvciBHb1RvIENsZWFuVXAKICAgIEFwcGxpY2F0aW9uLkVuYWJsZUV2ZW50cyA9IEZhbHNlCiAgICAnIFlvdXIgY29kZSBoZXJlCkNsZWFuVXA6CiAgICBBcHBsaWNhdGlvbi5FbmFibGVFdmVudHMgPSBUcnVlCkVuZCBTdWI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Private Sub Worksheet_Change(ByVal Target As Range)
    On Error GoTo CleanUp
    Application.EnableEvents = False
    ' Your code here
CleanUp:
    Application.EnableEvents = True
End Sub</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Event-driven programming in VBA allows you to create dynamic and interactive Excel applications. By understanding and utilizing events and event handlers, you can respond to user actions and other occurrences in your workbook, making your applications more robust and user-friendly. In the next module, we will delve into automating other applications using VBA, expanding the scope of your automation capabilities.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-04-working-with-userforms' title="Working with UserForms">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-automating-word-vba' title="Automating Word with VBA">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
