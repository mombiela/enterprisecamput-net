<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project 5: Integrating VBA with Web Services</title>

    <link rel="alternate" href="https://campusempresa.com/mod/vba/project-5-integrating-vba-with-web-services" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/vba/project-5-integrating-vba-with-web-services" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/vba/project-5-integrating-vba-with-web-services" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/vba/project-5-integrating-vba-with-web-services" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/vba/project-5-integrating-vba-with-web-services" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='project-4-building-a-dashboard'>&#x25C4;Project 4: Building a Dashboard</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Project 5: Integrating VBA with Web Services</a>
	</div>
	<div class='col-4 text-end'>
					<a href='vba-best-practices'>VBA Best Practices &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this project, we will explore how to integrate VBA (Visual Basic for Applications) with web services. This is an advanced topic that will allow you to extend the capabilities of your VBA applications by interacting with online APIs to fetch or send data. By the end of this project, you will be able to:</p>
<ul>
<li>Understand the basics of web services and APIs.</li>
<li>Make HTTP requests from VBA.</li>
<li>Parse JSON responses.</li>
<li>Handle errors and exceptions in web service calls.</li>
</ul>
</div><h1>Understanding Web Services and APIs</h1>
<div class='content'><p>Before diving into the code, it's important to understand what web services and APIs are.</p>
<ul>
<li><strong>Web Services</strong>: These are services offered by an electronic device to another electronic device, communicating with each other via the World Wide Web.</li>
<li><strong>API (Application Programming Interface)</strong>: This is a set of rules that allows one piece of software application to interact with another.</li>
</ul>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>HTTP Methods</strong>: GET, POST, PUT, DELETE.</li>
<li><strong>Endpoints</strong>: URLs that provide access to the web service.</li>
<li><strong>Headers</strong>: Metadata sent with the request.</li>
<li><strong>JSON (JavaScript Object Notation)</strong>: A lightweight data-interchange format.</li>
</ul>
</div><h1>Making HTTP Requests from VBA</h1>
<div class='content'><p>To interact with web services, we need to make HTTP requests. VBA does not have built-in support for HTTP requests, so we will use the <code>MSXML2.XMLHTTP</code> object.</p>
</div><h2>Example: Making a GET Request</h2>
<div class='content'><p>Here is a simple example of making a GET request to a web service that returns JSON data.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEdldFJlcXVlc3RFeGFtcGxlKCkKICAgIERpbSBodHRwIEFzIE9iamVjdAogICAgRGltIHVybCBBcyBTdHJpbmcKICAgIERpbSByZXNwb25zZSBBcyBTdHJpbmcKICAgIAogICAgJyBDcmVhdGUgdGhlIFhNTEhUVFAgb2JqZWN0CiAgICBTZXQgaHR0cCA9IENyZWF0ZU9iamVjdCgiTVNYTUwyLlhNTEhUVFAiKQogICAgCiAgICAnIERlZmluZSB0aGUgVVJMIG9mIHRoZSB3ZWIgc2VydmljZQogICAgdXJsID0gImh0dHBzOi8vYXBpLmV4YW1wbGUuY29tL2RhdGEiCiAgICAKICAgICcgT3BlbiB0aGUgcmVxdWVzdAogICAgaHR0cC5PcGVuICJHRVQiLCB1cmwsIEZhbHNlCiAgICAKICAgICcgU2VuZCB0aGUgcmVxdWVzdAogICAgaHR0cC5TZW5kCiAgICAKICAgICcgR2V0IHRoZSByZXNwb25zZSB0ZXh0CiAgICByZXNwb25zZSA9IGh0dHAucmVzcG9uc2VUZXh0CiAgICAKICAgICcgT3V0cHV0IHRoZSByZXNwb25zZQogICAgTXNnQm94IHJlc3BvbnNlCkVuZCBTdWI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub GetRequestExample()
    Dim http As Object
    Dim url As String
    Dim response As String
    
    ' Create the XMLHTTP object
    Set http = CreateObject(&quot;MSXML2.XMLHTTP&quot;)
    
    ' Define the URL of the web service
    url = &quot;https://api.example.com/data&quot;
    
    ' Open the request
    http.Open &quot;GET&quot;, url, False
    
    ' Send the request
    http.Send
    
    ' Get the response text
    response = http.responseText
    
    ' Output the response
    MsgBox response
End Sub</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>CreateObject(&quot;MSXML2.XMLHTTP&quot;)</strong>: Creates an instance of the XMLHTTP object.</li>
<li><strong>http.Open &quot;GET&quot;, url, False</strong>: Initializes a GET request to the specified URL.</li>
<li><strong>http.Send</strong>: Sends the request to the server.</li>
<li><strong>http.responseText</strong>: Retrieves the response from the server.</li>
</ul>
</div><h1>Parsing JSON Responses</h1>
<div class='content'><p>Once we receive the response from the web service, it is often in JSON format. We need to parse this JSON to extract useful information.</p>
</div><h2>Example: Parsing JSON</h2>
<div class='content'><p>We will use the <code>JsonConverter</code> library to parse JSON in VBA. You can download this library from GitHub and import it into your VBA project.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIFBhcnNlSnNvbkV4YW1wbGUoKQogICAgRGltIGh0dHAgQXMgT2JqZWN0CiAgICBEaW0gdXJsIEFzIFN0cmluZwogICAgRGltIHJlc3BvbnNlIEFzIFN0cmluZwogICAgRGltIGpzb24gQXMgT2JqZWN0CiAgICBEaW0gZGF0YSBBcyBPYmplY3QKICAgIAogICAgJyBDcmVhdGUgdGhlIFhNTEhUVFAgb2JqZWN0CiAgICBTZXQgaHR0cCA9IENyZWF0ZU9iamVjdCgiTVNYTUwyLlhNTEhUVFAiKQogICAgCiAgICAnIERlZmluZSB0aGUgVVJMIG9mIHRoZSB3ZWIgc2VydmljZQogICAgdXJsID0gImh0dHBzOi8vYXBpLmV4YW1wbGUuY29tL2RhdGEiCiAgICAKICAgICcgT3BlbiB0aGUgcmVxdWVzdAogICAgaHR0cC5PcGVuICJHRVQiLCB1cmwsIEZhbHNlCiAgICAKICAgICcgU2VuZCB0aGUgcmVxdWVzdAogICAgaHR0cC5TZW5kCiAgICAKICAgICcgR2V0IHRoZSByZXNwb25zZSB0ZXh0CiAgICByZXNwb25zZSA9IGh0dHAucmVzcG9uc2VUZXh0CiAgICAKICAgICcgUGFyc2UgdGhlIEpTT04gcmVzcG9uc2UKICAgIFNldCBqc29uID0gSnNvbkNvbnZlcnRlci5QYXJzZUpzb24ocmVzcG9uc2UpCiAgICAKICAgICcgQWNjZXNzIGRhdGEgZnJvbSB0aGUgSlNPTiBvYmplY3QKICAgIFNldCBkYXRhID0ganNvbigia2V5IikKICAgIAogICAgJyBPdXRwdXQgdGhlIGRhdGEKICAgIE1zZ0JveCBkYXRhCkVuZCBTdWI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub ParseJsonExample()
    Dim http As Object
    Dim url As String
    Dim response As String
    Dim json As Object
    Dim data As Object
    
    ' Create the XMLHTTP object
    Set http = CreateObject(&quot;MSXML2.XMLHTTP&quot;)
    
    ' Define the URL of the web service
    url = &quot;https://api.example.com/data&quot;
    
    ' Open the request
    http.Open &quot;GET&quot;, url, False
    
    ' Send the request
    http.Send
    
    ' Get the response text
    response = http.responseText
    
    ' Parse the JSON response
    Set json = JsonConverter.ParseJson(response)
    
    ' Access data from the JSON object
    Set data = json(&quot;key&quot;)
    
    ' Output the data
    MsgBox data
End Sub</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>JsonConverter.ParseJson(response)</strong>: Parses the JSON response into a VBA object.</li>
<li><strong>json(&quot;key&quot;)</strong>: Accesses a specific value from the JSON object.</li>
</ul>
</div><h1>Handling Errors and Exceptions</h1>
<div class='content'><p>When working with web services, it's important to handle errors and exceptions gracefully.</p>
</div><h2>Example: Error Handling</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEdldFJlcXVlc3RXaXRoRXJyb3JIYW5kbGluZygpCiAgICBPbiBFcnJvciBHb1RvIEVycm9ySGFuZGxlcgogICAgCiAgICBEaW0gaHR0cCBBcyBPYmplY3QKICAgIERpbSB1cmwgQXMgU3RyaW5nCiAgICBEaW0gcmVzcG9uc2UgQXMgU3RyaW5nCiAgICAKICAgICcgQ3JlYXRlIHRoZSBYTUxIVFRQIG9iamVjdAogICAgU2V0IGh0dHAgPSBDcmVhdGVPYmplY3QoIk1TWE1MMi5YTUxIVFRQIikKICAgIAogICAgJyBEZWZpbmUgdGhlIFVSTCBvZiB0aGUgd2ViIHNlcnZpY2UKICAgIHVybCA9ICJodHRwczovL2FwaS5leGFtcGxlLmNvbS9kYXRhIgogICAgCiAgICAnIE9wZW4gdGhlIHJlcXVlc3QKICAgIGh0dHAuT3BlbiAiR0VUIiwgdXJsLCBGYWxzZQogICAgCiAgICAnIFNlbmQgdGhlIHJlcXVlc3QKICAgIGh0dHAuU2VuZAogICAgCiAgICAnIENoZWNrIGZvciBIVFRQIGVycm9ycwogICAgSWYgaHR0cC5TdGF0dXMgPD4gMjAwIFRoZW4KICAgICAgICBFcnIuUmFpc2UgdmJPYmplY3RFcnJvciArIDEsICJHZXRSZXF1ZXN0V2l0aEVycm9ySGFuZGxpbmciLCAiSFRUUCByZXF1ZXN0IGZhaWxlZCB3aXRoIHN0YXR1cyAiICYgaHR0cC5TdGF0dXMKICAgIEVuZCBJZgogICAgCiAgICAnIEdldCB0aGUgcmVzcG9uc2UgdGV4dAogICAgcmVzcG9uc2UgPSBodHRwLnJlc3BvbnNlVGV4dAogICAgCiAgICAnIE91dHB1dCB0aGUgcmVzcG9uc2UKICAgIE1zZ0JveCByZXNwb25zZQogICAgCiAgICBFeGl0IFN1YgogICAgCkVycm9ySGFuZGxlcjoKICAgIE1zZ0JveCAiQW4gZXJyb3Igb2NjdXJyZWQ6ICIgJiBFcnIuRGVzY3JpcHRpb24KRW5kIFN1Yg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub GetRequestWithErrorHandling()
    On Error GoTo ErrorHandler
    
    Dim http As Object
    Dim url As String
    Dim response As String
    
    ' Create the XMLHTTP object
    Set http = CreateObject(&quot;MSXML2.XMLHTTP&quot;)
    
    ' Define the URL of the web service
    url = &quot;https://api.example.com/data&quot;
    
    ' Open the request
    http.Open &quot;GET&quot;, url, False
    
    ' Send the request
    http.Send
    
    ' Check for HTTP errors
    If http.Status &lt;&gt; 200 Then
        Err.Raise vbObjectError + 1, &quot;GetRequestWithErrorHandling&quot;, &quot;HTTP request failed with status &quot; &amp; http.Status
    End If
    
    ' Get the response text
    response = http.responseText
    
    ' Output the response
    MsgBox response
    
    Exit Sub
    
ErrorHandler:
    MsgBox &quot;An error occurred: &quot; &amp; Err.Description
End Sub</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>On Error GoTo ErrorHandler</strong>: Directs VBA to the ErrorHandler label if an error occurs.</li>
<li><strong>http.Status</strong>: Checks the HTTP status code of the response.</li>
<li><strong>Err.Raise</strong>: Raises a custom error if the HTTP request fails.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Integrating VBA with web services can significantly enhance the functionality of your applications by allowing them to interact with online APIs. In this project, we covered:</p>
<ul>
<li>The basics of web services and APIs.</li>
<li>Making HTTP requests from VBA.</li>
<li>Parsing JSON responses.</li>
<li>Handling errors and exceptions.</li>
</ul>
<p>By mastering these techniques, you can create powerful VBA applications that leverage the vast amount of data and services available on the web.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='project-4-building-a-dashboard'>&#x25C4;Project 4: Building a Dashboard</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Project 5: Integrating VBA with Web Services</a>
	</div>
	<div class='col-4 text-end'>
					<a href='vba-best-practices'>VBA Best Practices &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
