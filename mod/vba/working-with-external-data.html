<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Working with External Data</title>

    <link rel="alternate" href="https://campusempresa.com/mod/vba/working-with-external-data" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/vba/working-with-external-data" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/vba/working-with-external-data" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/vba/working-with-external-data" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/vba/working-with-external-data" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='advanced-user-form-techniques'>&#x25C4;Advanced User Form Techniques</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Working with External Data</a>
	</div>
	<div class='col-4 text-end'>
					<a href='automating-tasks-with-vba'>Automating Tasks with VBA &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this module, we will explore how to work with external data in VBA (Visual Basic for Applications). This includes reading from and writing to external files such as text files, CSV files, and databases. By the end of this module, you will be able to automate data import/export tasks and interact with various data sources efficiently.</p>
</div><h1>Reading from External Files</h1>
<div class='content'></div><h2>Reading from Text Files</h2>
<div class='content'><p>Reading from text files is a common task in VBA. The following example demonstrates how to read data from a text file line by line.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIFJlYWRGcm9tVGV4dEZpbGUoKQogICAgRGltIGZpbGVQYXRoIEFzIFN0cmluZwogICAgRGltIGZpbGVOdW1iZXIgQXMgSW50ZWdlcgogICAgRGltIGxpbmUgQXMgU3RyaW5nCiAgICAKICAgIGZpbGVQYXRoID0gIkM6XHBhdGhcdG9ceW91clxmaWxlLnR4dCIKICAgIGZpbGVOdW1iZXIgPSBGcmVlRmlsZQogICAgCiAgICBPcGVuIGZpbGVQYXRoIEZvciBJbnB1dCBBcyAjZmlsZU51bWJlcgogICAgCiAgICBEbyBXaGlsZSBOb3QgRU9GKGZpbGVOdW1iZXIpCiAgICAgICAgTGluZSBJbnB1dCAjZmlsZU51bWJlciwgbGluZQogICAgICAgIERlYnVnLlByaW50IGxpbmUKICAgIExvb3AKICAgIAogICAgQ2xvc2UgI2ZpbGVOdW1iZXIKRW5kIFN1Yg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub ReadFromTextFile()
    Dim filePath As String
    Dim fileNumber As Integer
    Dim line As String
    
    filePath = &quot;C:\path\to\your\file.txt&quot;
    fileNumber = FreeFile
    
    Open filePath For Input As #fileNumber
    
    Do While Not EOF(fileNumber)
        Line Input #fileNumber, line
        Debug.Print line
    Loop
    
    Close #fileNumber
End Sub</pre></div><div class='content'><ul>
<li><strong>filePath</strong>: The path to the text file.</li>
<li><strong>fileNumber</strong>: A unique number assigned to the file.</li>
<li><strong>Line Input</strong>: Reads a line from the file.</li>
</ul>
</div><h2>Reading from CSV Files</h2>
<div class='content'><p>CSV files are commonly used for data exchange. The following example shows how to read data from a CSV file and populate it into an Excel worksheet.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIFJlYWRGcm9tQ1NWKCkKICAgIERpbSBmaWxlUGF0aCBBcyBTdHJpbmcKICAgIERpbSBmaWxlTnVtYmVyIEFzIEludGVnZXIKICAgIERpbSBsaW5lIEFzIFN0cmluZwogICAgRGltIGRhdGEgQXMgVmFyaWFudAogICAgRGltIHJvdyBBcyBJbnRlZ2VyCiAgICAKICAgIGZpbGVQYXRoID0gIkM6XHBhdGhcdG9ceW91clxmaWxlLmNzdiIKICAgIGZpbGVOdW1iZXIgPSBGcmVlRmlsZQogICAgcm93ID0gMQogICAgCiAgICBPcGVuIGZpbGVQYXRoIEZvciBJbnB1dCBBcyAjZmlsZU51bWJlcgogICAgCiAgICBEbyBXaGlsZSBOb3QgRU9GKGZpbGVOdW1iZXIpCiAgICAgICAgTGluZSBJbnB1dCAjZmlsZU51bWJlciwgbGluZQogICAgICAgIGRhdGEgPSBTcGxpdChsaW5lLCAiLCIpCiAgICAgICAgRm9yIGNvbCA9IDAgVG8gVUJvdW5kKGRhdGEpCiAgICAgICAgICAgIENlbGxzKHJvdywgY29sICsgMSkuVmFsdWUgPSBkYXRhKGNvbCkKICAgICAgICBOZXh0IGNvbAogICAgICAgIHJvdyA9IHJvdyArIDEKICAgIExvb3AKICAgIAogICAgQ2xvc2UgI2ZpbGVOdW1iZXIKRW5kIFN1Yg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub ReadFromCSV()
    Dim filePath As String
    Dim fileNumber As Integer
    Dim line As String
    Dim data As Variant
    Dim row As Integer
    
    filePath = &quot;C:\path\to\your\file.csv&quot;
    fileNumber = FreeFile
    row = 1
    
    Open filePath For Input As #fileNumber
    
    Do While Not EOF(fileNumber)
        Line Input #fileNumber, line
        data = Split(line, &quot;,&quot;)
        For col = 0 To UBound(data)
            Cells(row, col + 1).Value = data(col)
        Next col
        row = row + 1
    Loop
    
    Close #fileNumber
End Sub</pre></div><div class='content'><ul>
<li><strong>Split</strong>: Splits the line into an array based on the comma delimiter.</li>
</ul>
</div><h1>Writing to External Files</h1>
<div class='content'></div><h2>Writing to Text Files</h2>
<div class='content'><p>Writing data to a text file can be useful for logging or exporting data. Here is an example of how to write data to a text file.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIFdyaXRlVG9UZXh0RmlsZSgpCiAgICBEaW0gZmlsZVBhdGggQXMgU3RyaW5nCiAgICBEaW0gZmlsZU51bWJlciBBcyBJbnRlZ2VyCiAgICAKICAgIGZpbGVQYXRoID0gIkM6XHBhdGhcdG9ceW91clxvdXRwdXQudHh0IgogICAgZmlsZU51bWJlciA9IEZyZWVGaWxlCiAgICAKICAgIE9wZW4gZmlsZVBhdGggRm9yIE91dHB1dCBBcyAjZmlsZU51bWJlcgogICAgCiAgICBQcmludCAjZmlsZU51bWJlciwgIlRoaXMgaXMgYSBzYW1wbGUgdGV4dC4iCiAgICBQcmludCAjZmlsZU51bWJlciwgIldyaXRpbmcgdG8gYSB0ZXh0IGZpbGUgdXNpbmcgVkJBLiIKICAgIAogICAgQ2xvc2UgI2ZpbGVOdW1iZXIKRW5kIFN1Yg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub WriteToTextFile()
    Dim filePath As String
    Dim fileNumber As Integer
    
    filePath = &quot;C:\path\to\your\output.txt&quot;
    fileNumber = FreeFile
    
    Open filePath For Output As #fileNumber
    
    Print #fileNumber, &quot;This is a sample text.&quot;
    Print #fileNumber, &quot;Writing to a text file using VBA.&quot;
    
    Close #fileNumber
End Sub</pre></div><div class='content'><ul>
<li><strong>Print</strong>: Writes a line to the file.</li>
</ul>
</div><h2>Writing to CSV Files</h2>
<div class='content'><p>Exporting data to a CSV file is straightforward. The following example demonstrates how to write data from an Excel worksheet to a CSV file.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIFdyaXRlVG9DU1YoKQogICAgRGltIGZpbGVQYXRoIEFzIFN0cmluZwogICAgRGltIGZpbGVOdW1iZXIgQXMgSW50ZWdlcgogICAgRGltIHJvdyBBcyBJbnRlZ2VyCiAgICBEaW0gY29sIEFzIEludGVnZXIKICAgIERpbSBsaW5lIEFzIFN0cmluZwogICAgCiAgICBmaWxlUGF0aCA9ICJDOlxwYXRoXHRvXHlvdXJcb3V0cHV0LmNzdiIKICAgIGZpbGVOdW1iZXIgPSBGcmVlRmlsZQogICAgCiAgICBPcGVuIGZpbGVQYXRoIEZvciBPdXRwdXQgQXMgI2ZpbGVOdW1iZXIKICAgIAogICAgcm93ID0gMQogICAgRG8gV2hpbGUgQ2VsbHMocm93LCAxKS5WYWx1ZSA8PiAiIgogICAgICAgIGxpbmUgPSAiIgogICAgICAgIGNvbCA9IDEKICAgICAgICBEbyBXaGlsZSBDZWxscyhyb3csIGNvbCkuVmFsdWUgPD4gIiIKICAgICAgICAgICAgSWYgY29sID4gMSBUaGVuIGxpbmUgPSBsaW5lICYgIiwiCiAgICAgICAgICAgIGxpbmUgPSBsaW5lICYgQ2VsbHMocm93LCBjb2wpLlZhbHVlCiAgICAgICAgICAgIGNvbCA9IGNvbCArIDEKICAgICAgICBMb29wCiAgICAgICAgUHJpbnQgI2ZpbGVOdW1iZXIsIGxpbmUKICAgICAgICByb3cgPSByb3cgKyAxCiAgICBMb29wCiAgICAKICAgIENsb3NlICNmaWxlTnVtYmVyCkVuZCBTdWI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub WriteToCSV()
    Dim filePath As String
    Dim fileNumber As Integer
    Dim row As Integer
    Dim col As Integer
    Dim line As String
    
    filePath = &quot;C:\path\to\your\output.csv&quot;
    fileNumber = FreeFile
    
    Open filePath For Output As #fileNumber
    
    row = 1
    Do While Cells(row, 1).Value &lt;&gt; &quot;&quot;
        line = &quot;&quot;
        col = 1
        Do While Cells(row, col).Value &lt;&gt; &quot;&quot;
            If col &gt; 1 Then line = line &amp; &quot;,&quot;
            line = line &amp; Cells(row, col).Value
            col = col + 1
        Loop
        Print #fileNumber, line
        row = row + 1
    Loop
    
    Close #fileNumber
End Sub</pre></div><div class='content'></div><h1>Interacting with Databases</h1>
<div class='content'></div><h2>Connecting to a Database</h2>
<div class='content'><p>Connecting to a database allows you to read and write data directly. The following example demonstrates how to connect to an Access database using ADO (ActiveX Data Objects).</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIENvbm5lY3RUb0RhdGFiYXNlKCkKICAgIERpbSBjb25uIEFzIE9iamVjdAogICAgRGltIHJzIEFzIE9iamVjdAogICAgRGltIGNvbm5TdHIgQXMgU3RyaW5nCiAgICBEaW0gc3FsIEFzIFN0cmluZwogICAgCiAgICBjb25uU3RyID0gIlByb3ZpZGVyPU1pY3Jvc29mdC5BQ0UuT0xFREIuMTIuMDtEYXRhIFNvdXJjZT1DOlxwYXRoXHRvXHlvdXJcZGF0YWJhc2UuYWNjZGI7IgogICAgc3FsID0gIlNFTEVDVCAqIEZST00gVGFibGVOYW1lIgogICAgCiAgICBTZXQgY29ubiA9IENyZWF0ZU9iamVjdCgiQURPREIuQ29ubmVjdGlvbiIpCiAgICBjb25uLk9wZW4gY29ublN0cgogICAgCiAgICBTZXQgcnMgPSBDcmVhdGVPYmplY3QoIkFET0RCLlJlY29yZHNldCIpCiAgICBycy5PcGVuIHNxbCwgY29ubgogICAgCiAgICBEbyBXaGlsZSBOb3QgcnMuRU9GCiAgICAgICAgRGVidWcuUHJpbnQgcnMuRmllbGRzKCJGaWVsZE5hbWUiKS5WYWx1ZQogICAgICAgIHJzLk1vdmVOZXh0CiAgICBMb29wCiAgICAKICAgIHJzLkNsb3NlCiAgICBjb25uLkNsb3NlCkVuZCBTdWI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub ConnectToDatabase()
    Dim conn As Object
    Dim rs As Object
    Dim connStr As String
    Dim sql As String
    
    connStr = &quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\path\to\your\database.accdb;&quot;
    sql = &quot;SELECT * FROM TableName&quot;
    
    Set conn = CreateObject(&quot;ADODB.Connection&quot;)
    conn.Open connStr
    
    Set rs = CreateObject(&quot;ADODB.Recordset&quot;)
    rs.Open sql, conn
    
    Do While Not rs.EOF
        Debug.Print rs.Fields(&quot;FieldName&quot;).Value
        rs.MoveNext
    Loop
    
    rs.Close
    conn.Close
End Sub</pre></div><div class='content'><ul>
<li><strong>connStr</strong>: Connection string to the database.</li>
<li><strong>sql</strong>: SQL query to execute.</li>
<li><strong>ADODB.Connection</strong>: Object to manage the connection.</li>
<li><strong>ADODB.Recordset</strong>: Object to hold the query results.</li>
</ul>
</div><h2>Executing SQL Commands</h2>
<div class='content'><p>Executing SQL commands allows you to manipulate data in the database. The following example shows how to insert a new record into a table.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEluc2VydEludG9EYXRhYmFzZSgpCiAgICBEaW0gY29ubiBBcyBPYmplY3QKICAgIERpbSBjb25uU3RyIEFzIFN0cmluZwogICAgRGltIHNxbCBBcyBTdHJpbmcKICAgIAogICAgY29ublN0ciA9ICJQcm92aWRlcj1NaWNyb3NvZnQuQUNFLk9MRURCLjEyLjA7RGF0YSBTb3VyY2U9QzpccGF0aFx0b1x5b3VyXGRhdGFiYXNlLmFjY2RiOyIKICAgIHNxbCA9ICJJTlNFUlQgSU5UTyBUYWJsZU5hbWUgKEZpZWxkTmFtZSkgVkFMVUVTICgnU2FtcGxlRGF0YScpIgogICAgCiAgICBTZXQgY29ubiA9IENyZWF0ZU9iamVjdCgiQURPREIuQ29ubmVjdGlvbiIpCiAgICBjb25uLk9wZW4gY29ublN0cgogICAgCiAgICBjb25uLkV4ZWN1dGUgc3FsCiAgICAKICAgIGNvbm4uQ2xvc2UKRW5kIFN1Yg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub InsertIntoDatabase()
    Dim conn As Object
    Dim connStr As String
    Dim sql As String
    
    connStr = &quot;Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\path\to\your\database.accdb;&quot;
    sql = &quot;INSERT INTO TableName (FieldName) VALUES ('SampleData')&quot;
    
    Set conn = CreateObject(&quot;ADODB.Connection&quot;)
    conn.Open connStr
    
    conn.Execute sql
    
    conn.Close
End Sub</pre></div><div class='content'><ul>
<li><strong>INSERT INTO</strong>: SQL command to insert data.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this module, we covered various methods to work with external data in VBA, including reading from and writing to text and CSV files, as well as interacting with databases. These skills are essential for automating data processing tasks and integrating Excel with other data sources. Practice these examples and try to implement them in your projects to gain a deeper understanding.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='advanced-user-form-techniques'>&#x25C4;Advanced User Form Techniques</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Working with External Data</a>
	</div>
	<div class='col-4 text-end'>
					<a href='automating-tasks-with-vba'>Automating Tasks with VBA &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
