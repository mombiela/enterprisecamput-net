<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JWT (JSON Web Token) Authentication in Spring Boot</title>

    <link rel="alternate" href="https://campusempresa.com/mod/springboot/jwt-authentication" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/springboot/jwt-authentication" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/springboot/jwt-authentication" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/springboot/jwt-authentication" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/springboot/jwt-authentication" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='authentication-and-authorization'>&#x25C4;Authentication and Authorization</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">JWT (JSON Web Token) Authentication in Spring Boot</a>
	</div>
	<div class='col-4 text-end'>
					<a href='oauth2-and-openid-connect'>OAuth2 and OpenID Connect &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to JWT</h1>
<div class='content'><p>JWT (JSON Web Token) is a compact, URL-safe means of representing claims to be transferred between two parties. The claims in a JWT are encoded as a JSON object that is used as the payload of a JSON Web Signature (JWS) structure or as the plaintext of a JSON Web Encryption (JWE) structure, enabling the claims to be digitally signed or integrity protected with a Message Authentication Code (MAC) and/or encrypted.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Header</strong>: Contains metadata about the type of token and the algorithm used for signing.</li>
<li><strong>Payload</strong>: Contains the claims. This is where the user data is stored.</li>
<li><strong>Signature</strong>: Used to verify the token wasn't altered.</li>
</ul>
</div><h1>Setting Up Spring Boot for JWT</h1>
<div class='content'><p>To implement JWT authentication in a Spring Boot application, follow these steps:</p>
</div><h2>Dependencies</h2>
<div class='content'><p>Add the following dependencies to your <code>pom.xml</code> file:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGRlcGVuZGVuY3k+CiAgICA8Z3JvdXBJZD5vcmcuc3ByaW5nZnJhbWV3b3JrLmJvb3Q8L2dyb3VwSWQ+CiAgICA8YXJ0aWZhY3RJZD5zcHJpbmctYm9vdC1zdGFydGVyLXNlY3VyaXR5PC9hcnRpZmFjdElkPgo8L2RlcGVuZGVuY3k+CjxkZXBlbmRlbmN5PgogICAgPGdyb3VwSWQ+aW8uanNvbndlYnRva2VuPC9ncm91cElkPgogICAgPGFydGlmYWN0SWQ+amp3dDwvYXJ0aWZhY3RJZD4KICAgIDx2ZXJzaW9uPjAuOS4xPC92ZXJzaW9uPgo8L2RlcGVuZGVuY3k+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;
    &lt;artifactId&gt;jjwt&lt;/artifactId&gt;
    &lt;version&gt;0.9.1&lt;/version&gt;
&lt;/dependency&gt;</pre></div><div class='content'></div><h2>Configuration</h2>
<div class='content'><p>Create a configuration class to set up JWT authentication:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuY29udGV4dC5hbm5vdGF0aW9uLkJlYW47CmltcG9ydCBvcmcuc3ByaW5nZnJhbWV3b3JrLmNvbnRleHQuYW5ub3RhdGlvbi5Db25maWd1cmF0aW9uOwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5zZWN1cml0eS5jb25maWcuYW5ub3RhdGlvbi5hdXRoZW50aWNhdGlvbi5idWlsZGVycy5BdXRoZW50aWNhdGlvbk1hbmFnZXJCdWlsZGVyOwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5zZWN1cml0eS5jb25maWcuYW5ub3RhdGlvbi53ZWIuYnVpbGRlcnMuSHR0cFNlY3VyaXR5OwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5zZWN1cml0eS5jb25maWcuYW5ub3RhdGlvbi53ZWIuY29uZmlndXJhdGlvbi5FbmFibGVXZWJTZWN1cml0eTsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuc2VjdXJpdHkuY29uZmlnLmFubm90YXRpb24ud2ViLmNvbmZpZ3VyYXRpb24uV2ViU2VjdXJpdHlDb25maWd1cmVyQWRhcHRlcjsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuc2VjdXJpdHkuY3J5cHRvLmJjcnlwdC5CQ3J5cHRQYXNzd29yZEVuY29kZXI7CmltcG9ydCBvcmcuc3ByaW5nZnJhbWV3b3JrLnNlY3VyaXR5LmNyeXB0by5wYXNzd29yZC5QYXNzd29yZEVuY29kZXI7CgpAQ29uZmlndXJhdGlvbgpARW5hYmxlV2ViU2VjdXJpdHkKcHVibGljIGNsYXNzIFNlY3VyaXR5Q29uZmlnIGV4dGVuZHMgV2ViU2VjdXJpdHlDb25maWd1cmVyQWRhcHRlciB7CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBjb25maWd1cmUoSHR0cFNlY3VyaXR5IGh0dHApIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIGh0dHAuY3NyZigpLmRpc2FibGUoKQogICAgICAgICAgICAuYXV0aG9yaXplUmVxdWVzdHMoKQogICAgICAgICAgICAuYW50TWF0Y2hlcnMoIi9sb2dpbiIpLnBlcm1pdEFsbCgpCiAgICAgICAgICAgIC5hbnlSZXF1ZXN0KCkuYXV0aGVudGljYXRlZCgpOwogICAgfQoKICAgIEBCZWFuCiAgICBwdWJsaWMgUGFzc3dvcmRFbmNvZGVyIHBhc3N3b3JkRW5jb2RlcigpIHsKICAgICAgICByZXR1cm4gbmV3IEJDcnlwdFBhc3N3b3JkRW5jb2RlcigpOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
import org.springframework.security.crypto.password.PasswordEncoder;

@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http.csrf().disable()
            .authorizeRequests()
            .antMatchers(&quot;/login&quot;).permitAll()
            .anyRequest().authenticated();
    }

    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
}</pre></div><div class='content'></div><h1>Creating JWT Utility Class</h1>
<div class='content'><p>Create a utility class for generating and validating JWT tokens:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGlvLmpzb253ZWJ0b2tlbi5DbGFpbXM7CmltcG9ydCBpby5qc29ud2VidG9rZW4uSnd0czsKaW1wb3J0IGlvLmpzb253ZWJ0b2tlbi5TaWduYXR1cmVBbGdvcml0aG07CmltcG9ydCBvcmcuc3ByaW5nZnJhbWV3b3JrLnN0ZXJlb3R5cGUuQ29tcG9uZW50OwoKaW1wb3J0IGphdmEudXRpbC5EYXRlOwoKQENvbXBvbmVudApwdWJsaWMgY2xhc3MgSnd0VXRpbCB7CgogICAgcHJpdmF0ZSBTdHJpbmcgc2VjcmV0ID0gIm15U2VjcmV0S2V5IjsKCiAgICBwdWJsaWMgU3RyaW5nIGdlbmVyYXRlVG9rZW4oU3RyaW5nIHVzZXJuYW1lKSB7CiAgICAgICAgcmV0dXJuIEp3dHMuYnVpbGRlcigpCiAgICAgICAgICAgICAgICAuc2V0U3ViamVjdCh1c2VybmFtZSkKICAgICAgICAgICAgICAgIC5zZXRJc3N1ZWRBdChuZXcgRGF0ZSgpKQogICAgICAgICAgICAgICAgLnNldEV4cGlyYXRpb24obmV3IERhdGUoU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzKCkgKyAxMDAwICogNjAgKiA2MCAqIDEwKSkKICAgICAgICAgICAgICAgIC5zaWduV2l0aChTaWduYXR1cmVBbGdvcml0aG0uSFMyNTYsIHNlY3JldCkKICAgICAgICAgICAgICAgIC5jb21wYWN0KCk7CiAgICB9CgogICAgcHVibGljIENsYWltcyBleHRyYWN0Q2xhaW1zKFN0cmluZyB0b2tlbikgewogICAgICAgIHJldHVybiBKd3RzLnBhcnNlcigpCiAgICAgICAgICAgICAgICAuc2V0U2lnbmluZ0tleShzZWNyZXQpCiAgICAgICAgICAgICAgICAucGFyc2VDbGFpbXNKd3ModG9rZW4pCiAgICAgICAgICAgICAgICAuZ2V0Qm9keSgpOwogICAgfQoKICAgIHB1YmxpYyBib29sZWFuIHZhbGlkYXRlVG9rZW4oU3RyaW5nIHRva2VuLCBTdHJpbmcgdXNlcm5hbWUpIHsKICAgICAgICByZXR1cm4gdXNlcm5hbWUuZXF1YWxzKGV4dHJhY3RDbGFpbXModG9rZW4pLmdldFN1YmplY3QoKSkgJiYgIWlzVG9rZW5FeHBpcmVkKHRva2VuKTsKICAgIH0KCiAgICBwcml2YXRlIGJvb2xlYW4gaXNUb2tlbkV4cGlyZWQoU3RyaW5nIHRva2VuKSB7CiAgICAgICAgcmV0dXJuIGV4dHJhY3RDbGFpbXModG9rZW4pLmdldEV4cGlyYXRpb24oKS5iZWZvcmUobmV3IERhdGUoKSk7CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import io.jsonwebtoken.Claims;
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;
import org.springframework.stereotype.Component;

import java.util.Date;

@Component
public class JwtUtil {

    private String secret = &quot;mySecretKey&quot;;

    public String generateToken(String username) {
        return Jwts.builder()
                .setSubject(username)
                .setIssuedAt(new Date())
                .setExpiration(new Date(System.currentTimeMillis() + 1000 * 60 * 60 * 10))
                .signWith(SignatureAlgorithm.HS256, secret)
                .compact();
    }

    public Claims extractClaims(String token) {
        return Jwts.parser()
                .setSigningKey(secret)
                .parseClaimsJws(token)
                .getBody();
    }

    public boolean validateToken(String token, String username) {
        return username.equals(extractClaims(token).getSubject()) &amp;&amp; !isTokenExpired(token);
    }

    private boolean isTokenExpired(String token) {
        return extractClaims(token).getExpiration().before(new Date());
    }
}</pre></div><div class='content'></div><h1>Implementing Authentication</h1>
<div class='content'><p>Create a controller for handling authentication requests:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuYmVhbnMuZmFjdG9yeS5hbm5vdGF0aW9uLkF1dG93aXJlZDsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuc2VjdXJpdHkuYXV0aGVudGljYXRpb24uQXV0aGVudGljYXRpb25NYW5hZ2VyOwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5zZWN1cml0eS5hdXRoZW50aWNhdGlvbi5Vc2VybmFtZVBhc3N3b3JkQXV0aGVudGljYXRpb25Ub2tlbjsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuc2VjdXJpdHkuY29yZS5BdXRoZW50aWNhdGlvbjsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuc2VjdXJpdHkuY29yZS5BdXRoZW50aWNhdGlvbkV4Y2VwdGlvbjsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuc2VjdXJpdHkuY29yZS51c2VyZGV0YWlscy5Vc2VyRGV0YWlsczsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuc2VjdXJpdHkuY29yZS51c2VyZGV0YWlscy5Vc2VyRGV0YWlsc1NlcnZpY2U7CmltcG9ydCBvcmcuc3ByaW5nZnJhbWV3b3JrLndlYi5iaW5kLmFubm90YXRpb24uKjsKCkBSZXN0Q29udHJvbGxlcgpwdWJsaWMgY2xhc3MgQXV0aENvbnRyb2xsZXIgewoKICAgIEBBdXRvd2lyZWQKICAgIHByaXZhdGUgQXV0aGVudGljYXRpb25NYW5hZ2VyIGF1dGhlbnRpY2F0aW9uTWFuYWdlcjsKCiAgICBAQXV0b3dpcmVkCiAgICBwcml2YXRlIEp3dFV0aWwgand0VXRpbDsKCiAgICBAQXV0b3dpcmVkCiAgICBwcml2YXRlIFVzZXJEZXRhaWxzU2VydmljZSB1c2VyRGV0YWlsc1NlcnZpY2U7CgogICAgQFBvc3RNYXBwaW5nKCIvbG9naW4iKQogICAgcHVibGljIFN0cmluZyBjcmVhdGVUb2tlbihAUmVxdWVzdEJvZHkgQXV0aFJlcXVlc3QgYXV0aFJlcXVlc3QpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGF1dGhlbnRpY2F0aW9uTWFuYWdlci5hdXRoZW50aWNhdGUoCiAgICAgICAgICAgICAgICAgICAgbmV3IFVzZXJuYW1lUGFzc3dvcmRBdXRoZW50aWNhdGlvblRva2VuKGF1dGhSZXF1ZXN0LmdldFVzZXJuYW1lKCksIGF1dGhSZXF1ZXN0LmdldFBhc3N3b3JkKCkpCiAgICAgICAgICAgICk7CiAgICAgICAgfSBjYXRjaCAoQXV0aGVudGljYXRpb25FeGNlcHRpb24gZSkgewogICAgICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCJJbnZhbGlkIHVzZXJuYW1lIG9yIHBhc3N3b3JkIik7CiAgICAgICAgfQoKICAgICAgICBmaW5hbCBVc2VyRGV0YWlscyB1c2VyRGV0YWlscyA9IHVzZXJEZXRhaWxzU2VydmljZS5sb2FkVXNlckJ5VXNlcm5hbWUoYXV0aFJlcXVlc3QuZ2V0VXNlcm5hbWUoKSk7CiAgICAgICAgcmV0dXJuIGp3dFV0aWwuZ2VuZXJhdGVUb2tlbih1c2VyRGV0YWlscy5nZXRVc2VybmFtZSgpKTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.core.Authentication;
import org.springframework.security.core.AuthenticationException;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.web.bind.annotation.*;

@RestController
public class AuthController {

    @Autowired
    private AuthenticationManager authenticationManager;

    @Autowired
    private JwtUtil jwtUtil;

    @Autowired
    private UserDetailsService userDetailsService;

    @PostMapping(&quot;/login&quot;)
    public String createToken(@RequestBody AuthRequest authRequest) throws Exception {
        try {
            authenticationManager.authenticate(
                    new UsernamePasswordAuthenticationToken(authRequest.getUsername(), authRequest.getPassword())
            );
        } catch (AuthenticationException e) {
            throw new Exception(&quot;Invalid username or password&quot;);
        }

        final UserDetails userDetails = userDetailsService.loadUserByUsername(authRequest.getUsername());
        return jwtUtil.generateToken(userDetails.getUsername());
    }
}</pre></div><div class='content'></div><h2>AuthRequest Class</h2>
<div class='content'><p>Create a simple class to handle authentication requests:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIEF1dGhSZXF1ZXN0IHsKICAgIHByaXZhdGUgU3RyaW5nIHVzZXJuYW1lOwogICAgcHJpdmF0ZSBTdHJpbmcgcGFzc3dvcmQ7CgogICAgLy8gR2V0dGVycyBhbmQgU2V0dGVycwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class AuthRequest {
    private String username;
    private String password;

    // Getters and Setters
}</pre></div><div class='content'></div><h1>Securing Endpoints</h1>
<div class='content'><p>Update the <code>SecurityConfig</code> class to secure your endpoints:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QE92ZXJyaWRlCnByb3RlY3RlZCB2b2lkIGNvbmZpZ3VyZShIdHRwU2VjdXJpdHkgaHR0cCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICBodHRwLmNzcmYoKS5kaXNhYmxlKCkKICAgICAgICAuYXV0aG9yaXplUmVxdWVzdHMoKQogICAgICAgIC5hbnRNYXRjaGVycygiL2xvZ2luIikucGVybWl0QWxsKCkKICAgICAgICAuYW55UmVxdWVzdCgpLmF1dGhlbnRpY2F0ZWQoKQogICAgICAgIC5hbmQoKQogICAgICAgIC5hZGRGaWx0ZXJCZWZvcmUobmV3IEp3dFJlcXVlc3RGaWx0ZXIoand0VXRpbCwgdXNlckRldGFpbHNTZXJ2aWNlKSwgVXNlcm5hbWVQYXNzd29yZEF1dGhlbnRpY2F0aW9uRmlsdGVyLmNsYXNzKTsKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@Override
protected void configure(HttpSecurity http) throws Exception {
    http.csrf().disable()
        .authorizeRequests()
        .antMatchers(&quot;/login&quot;).permitAll()
        .anyRequest().authenticated()
        .and()
        .addFilterBefore(new JwtRequestFilter(jwtUtil, userDetailsService), UsernamePasswordAuthenticationFilter.class);
}</pre></div><div class='content'></div><h2>JwtRequestFilter Class</h2>
<div class='content'><p>Create a filter to intercept requests and validate the JWT token:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuYmVhbnMuZmFjdG9yeS5hbm5vdGF0aW9uLkF1dG93aXJlZDsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuc2VjdXJpdHkuY29yZS5jb250ZXh0LlNlY3VyaXR5Q29udGV4dEhvbGRlcjsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuc2VjdXJpdHkuY29yZS51c2VyZGV0YWlscy5Vc2VyRGV0YWlsczsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuc2VjdXJpdHkuY29yZS51c2VyZGV0YWlscy5Vc2VyRGV0YWlsc1NlcnZpY2U7CmltcG9ydCBvcmcuc3ByaW5nZnJhbWV3b3JrLnNlY3VyaXR5LndlYi5hdXRoZW50aWNhdGlvbi5XZWJBdXRoZW50aWNhdGlvbkRldGFpbHNTb3VyY2U7CmltcG9ydCBvcmcuc3ByaW5nZnJhbWV3b3JrLnN0ZXJlb3R5cGUuQ29tcG9uZW50OwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay53ZWIuZmlsdGVyLk9uY2VQZXJSZXF1ZXN0RmlsdGVyOwoKaW1wb3J0IGphdmF4LnNlcnZsZXQuRmlsdGVyQ2hhaW47CmltcG9ydCBqYXZheC5zZXJ2bGV0LlNlcnZsZXRFeGNlcHRpb247CmltcG9ydCBqYXZheC5zZXJ2bGV0Lmh0dHAuSHR0cFNlcnZsZXRSZXF1ZXN0OwppbXBvcnQgamF2YXguc2VydmxldC5odHRwLkh0dHBTZXJ2bGV0UmVzcG9uc2U7CmltcG9ydCBqYXZhLmlvLklPRXhjZXB0aW9uOwoKQENvbXBvbmVudApwdWJsaWMgY2xhc3MgSnd0UmVxdWVzdEZpbHRlciBleHRlbmRzIE9uY2VQZXJSZXF1ZXN0RmlsdGVyIHsKCiAgICBAQXV0b3dpcmVkCiAgICBwcml2YXRlIEp3dFV0aWwgand0VXRpbDsKCiAgICBAQXV0b3dpcmVkCiAgICBwcml2YXRlIFVzZXJEZXRhaWxzU2VydmljZSB1c2VyRGV0YWlsc1NlcnZpY2U7CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgdm9pZCBkb0ZpbHRlckludGVybmFsKEh0dHBTZXJ2bGV0UmVxdWVzdCByZXF1ZXN0LCBIdHRwU2VydmxldFJlc3BvbnNlIHJlc3BvbnNlLCBGaWx0ZXJDaGFpbiBjaGFpbikKICAgICAgICAgICAgdGhyb3dzIFNlcnZsZXRFeGNlcHRpb24sIElPRXhjZXB0aW9uIHsKCiAgICAgICAgZmluYWwgU3RyaW5nIGF1dGhvcml6YXRpb25IZWFkZXIgPSByZXF1ZXN0LmdldEhlYWRlcigiQXV0aG9yaXphdGlvbiIpOwoKICAgICAgICBTdHJpbmcgdXNlcm5hbWUgPSBudWxsOwogICAgICAgIFN0cmluZyBqd3QgPSBudWxsOwoKICAgICAgICBpZiAoYXV0aG9yaXphdGlvbkhlYWRlciAhPSBudWxsICYmIGF1dGhvcml6YXRpb25IZWFkZXIuc3RhcnRzV2l0aCgiQmVhcmVyICIpKSB7CiAgICAgICAgICAgIGp3dCA9IGF1dGhvcml6YXRpb25IZWFkZXIuc3Vic3RyaW5nKDcpOwogICAgICAgICAgICB1c2VybmFtZSA9IGp3dFV0aWwuZXh0cmFjdENsYWltcyhqd3QpLmdldFN1YmplY3QoKTsKICAgICAgICB9CgogICAgICAgIGlmICh1c2VybmFtZSAhPSBudWxsICYmIFNlY3VyaXR5Q29udGV4dEhvbGRlci5nZXRDb250ZXh0KCkuZ2V0QXV0aGVudGljYXRpb24oKSA9PSBudWxsKSB7CiAgICAgICAgICAgIFVzZXJEZXRhaWxzIHVzZXJEZXRhaWxzID0gdGhpcy51c2VyRGV0YWlsc1NlcnZpY2UubG9hZFVzZXJCeVVzZXJuYW1lKHVzZXJuYW1lKTsKCiAgICAgICAgICAgIGlmIChqd3RVdGlsLnZhbGlkYXRlVG9rZW4oand0LCB1c2VyRGV0YWlscy5nZXRVc2VybmFtZSgpKSkgewogICAgICAgICAgICAgICAgVXNlcm5hbWVQYXNzd29yZEF1dGhlbnRpY2F0aW9uVG9rZW4gdXNlcm5hbWVQYXNzd29yZEF1dGhlbnRpY2F0aW9uVG9rZW4gPSBuZXcgVXNlcm5hbWVQYXNzd29yZEF1dGhlbnRpY2F0aW9uVG9rZW4oCiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJEZXRhaWxzLCBudWxsLCB1c2VyRGV0YWlscy5nZXRBdXRob3JpdGllcygpKTsKICAgICAgICAgICAgICAgIHVzZXJuYW1lUGFzc3dvcmRBdXRoZW50aWNhdGlvblRva2VuCiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXREZXRhaWxzKG5ldyBXZWJBdXRoZW50aWNhdGlvbkRldGFpbHNTb3VyY2UoKS5idWlsZERldGFpbHMocmVxdWVzdCkpOwogICAgICAgICAgICAgICAgU2VjdXJpdHlDb250ZXh0SG9sZGVyLmdldENvbnRleHQoKS5zZXRBdXRoZW50aWNhdGlvbih1c2VybmFtZVBhc3N3b3JkQXV0aGVudGljYXRpb25Ub2tlbik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2hhaW4uZG9GaWx0ZXIocmVxdWVzdCwgcmVzcG9uc2UpOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.core.context.SecurityContextHolder;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.security.web.authentication.WebAuthenticationDetailsSource;
import org.springframework.stereotype.Component;
import org.springframework.web.filter.OncePerRequestFilter;

import javax.servlet.FilterChain;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@Component
public class JwtRequestFilter extends OncePerRequestFilter {

    @Autowired
    private JwtUtil jwtUtil;

    @Autowired
    private UserDetailsService userDetailsService;

    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain chain)
            throws ServletException, IOException {

        final String authorizationHeader = request.getHeader(&quot;Authorization&quot;);

        String username = null;
        String jwt = null;

        if (authorizationHeader != null &amp;&amp; authorizationHeader.startsWith(&quot;Bearer &quot;)) {
            jwt = authorizationHeader.substring(7);
            username = jwtUtil.extractClaims(jwt).getSubject();
        }

        if (username != null &amp;&amp; SecurityContextHolder.getContext().getAuthentication() == null) {
            UserDetails userDetails = this.userDetailsService.loadUserByUsername(username);

            if (jwtUtil.validateToken(jwt, userDetails.getUsername())) {
                UsernamePasswordAuthenticationToken usernamePasswordAuthenticationToken = new UsernamePasswordAuthenticationToken(
                        userDetails, null, userDetails.getAuthorities());
                usernamePasswordAuthenticationToken
                        .setDetails(new WebAuthenticationDetailsSource().buildDetails(request));
                SecurityContextHolder.getContext().setAuthentication(usernamePasswordAuthenticationToken);
            }
        }
        chain.doFilter(request, response);
    }
}</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this topic, we covered the basics of JWT and how to implement JWT authentication in a Spring Boot application. We started with the necessary dependencies, moved on to configuring Spring Security, and then created utility classes and filters to handle JWT tokens. By following these steps, you can secure your Spring Boot applications using JWT, ensuring that only authenticated users can access protected resources.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='authentication-and-authorization'>&#x25C4;Authentication and Authorization</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">JWT (JSON Web Token) Authentication in Spring Boot</a>
	</div>
	<div class='col-4 text-end'>
					<a href='oauth2-and-openid-connect'>OAuth2 and OpenID Connect &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
