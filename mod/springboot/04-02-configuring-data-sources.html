<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuring Data Sources</title>

    <link rel="alternate" href="https://campusempresa.com/mod/springboot/04-02-configuring-data-sources" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/springboot/04-02-configuring-data-sources" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/springboot/04-02-configuring-data-sources" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/springboot/04-02-configuring-data-sources" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/springboot/04-02-configuring-data-sources" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-01-introduction-spring-data-jpa' title="Introduction to Spring Data JPA">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Configuring Data Sources</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='04-03-creating-jpa-entities' title="Creating JPA Entities">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to configure data sources in a Spring Boot application. Configuring data sources is a crucial step in setting up your application to interact with a database. We will cover the following topics:</p>
<ol>
<li><strong>Introduction to Data Sources</strong></li>
<li><strong>Configuring Data Sources using <code>application.properties</code></strong></li>
<li><strong>Configuring Data Sources using Java Configuration</strong></li>
<li><strong>Using Multiple Data Sources</strong></li>
<li><strong>Practical Exercises</strong></li>
</ol>
</div><h1><ol>
<li>Introduction to Data Sources</li>
</ol>
</h1>
<div class='content'><p>A data source is a Java object that provides a connection to a database. In Spring Boot, data sources are typically configured using properties files or Java configuration classes. Spring Boot simplifies the process by providing auto-configuration for data sources.</p>
</div><h1><ol start="2">
<li>Configuring Data Sources using <code>application.properties</code></li>
</ol>
</h1>
<div class='content'><p>Spring Boot allows you to configure your data source directly in the <code>application.properties</code> file. Here is an example configuration for a MySQL database:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBhcHBsaWNhdGlvbi5wcm9wZXJ0aWVzCgojIERhdGFTb3VyY2Ugc2V0dGluZ3MKc3ByaW5nLmRhdGFzb3VyY2UudXJsPWpkYmM6bXlzcWw6Ly9sb2NhbGhvc3Q6MzMwNi9teWRhdGFiYXNlCnNwcmluZy5kYXRhc291cmNlLnVzZXJuYW1lPXJvb3QKc3ByaW5nLmRhdGFzb3VyY2UucGFzc3dvcmQ9c2VjcmV0CnNwcmluZy5kYXRhc291cmNlLmRyaXZlci1jbGFzcy1uYW1lPWNvbS5teXNxbC5jai5qZGJjLkRyaXZlcgoKIyBIaWJlcm5hdGUgc2V0dGluZ3MKc3ByaW5nLmpwYS5oaWJlcm5hdGUuZGRsLWF1dG89dXBkYXRlCnNwcmluZy5qcGEuc2hvdy1zcWw9dHJ1ZQpzcHJpbmcuanBhLnByb3BlcnRpZXMuaGliZXJuYXRlLmRpYWxlY3Q9b3JnLmhpYmVybmF0ZS5kaWFsZWN0Lk15U1FMNURpYWxlY3Q="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># application.properties

# DataSource settings
spring.datasource.url=jdbc:mysql://localhost:3306/mydatabase
spring.datasource.username=root
spring.datasource.password=secret
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# Hibernate settings
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL5Dialect</pre></div><div class='content'></div><h2><p>Explanation:</p>
</h2>
<div class='content'><ul>
<li><code>spring.datasource.url</code>: The JDBC URL of the database.</li>
<li><code>spring.datasource.username</code>: The username to connect to the database.</li>
<li><code>spring.datasource.password</code>: The password to connect to the database.</li>
<li><code>spring.datasource.driver-class-name</code>: The fully qualified name of the JDBC driver.</li>
<li><code>spring.jpa.hibernate.ddl-auto</code>: Specifies the action to be taken by Hibernate at startup for schema management.</li>
<li><code>spring.jpa.show-sql</code>: Enables logging of SQL statements.</li>
<li><code>spring.jpa.properties.hibernate.dialect</code>: Specifies the Hibernate dialect to use.</li>
</ul>
</div><h1><ol start="3">
<li>Configuring Data Sources using Java Configuration</li>
</ol>
</h1>
<div class='content'><p>Alternatively, you can configure your data source using a Java configuration class. This approach provides more flexibility and is useful for complex configurations.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuY29udGV4dC5hbm5vdGF0aW9uLkJlYW47CmltcG9ydCBvcmcuc3ByaW5nZnJhbWV3b3JrLmNvbnRleHQuYW5ub3RhdGlvbi5Db25maWd1cmF0aW9uOwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5ib290LmNvbnRleHQucHJvcGVydGllcy5Db25maWd1cmF0aW9uUHJvcGVydGllczsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuYm9vdC5qZGJjLkRhdGFTb3VyY2VCdWlsZGVyOwppbXBvcnQgamF2YXguc3FsLkRhdGFTb3VyY2U7CgpAQ29uZmlndXJhdGlvbgpwdWJsaWMgY2xhc3MgRGF0YVNvdXJjZUNvbmZpZyB7CgogICAgQEJlYW4KICAgIEBDb25maWd1cmF0aW9uUHJvcGVydGllcyhwcmVmaXggPSAic3ByaW5nLmRhdGFzb3VyY2UiKQogICAgcHVibGljIERhdGFTb3VyY2UgZGF0YVNvdXJjZSgpIHsKICAgICAgICByZXR1cm4gRGF0YVNvdXJjZUJ1aWxkZXIuY3JlYXRlKCkuYnVpbGQoKTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jdbc.DataSourceBuilder;
import javax.sql.DataSource;

@Configuration
public class DataSourceConfig {

    @Bean
    @ConfigurationProperties(prefix = &quot;spring.datasource&quot;)
    public DataSource dataSource() {
        return DataSourceBuilder.create().build();
    }
}</pre></div><div class='content'></div><h2><p>Explanation:</p>
</h2>
<div class='content'><ul>
<li><code>@Configuration</code>: Indicates that the class contains Spring configuration.</li>
<li><code>@Bean</code>: Marks a method as a bean producer.</li>
<li><code>@ConfigurationProperties(prefix = &quot;spring.datasource&quot;)</code>: Binds the properties prefixed with <code>spring.datasource</code> to the DataSource bean.</li>
</ul>
</div><h1><ol start="4">
<li>Using Multiple Data Sources</li>
</ol>
</h1>
<div class='content'><p>In some applications, you may need to connect to multiple databases. Spring Boot allows you to configure multiple data sources by defining multiple <code>DataSource</code> beans.</p>
</div><h2><p>Example Configuration:</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuYmVhbnMuZmFjdG9yeS5hbm5vdGF0aW9uLlF1YWxpZmllcjsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuYm9vdC5jb250ZXh0LnByb3BlcnRpZXMuQ29uZmlndXJhdGlvblByb3BlcnRpZXM7CmltcG9ydCBvcmcuc3ByaW5nZnJhbWV3b3JrLmJvb3QuamRiYy5EYXRhU291cmNlQnVpbGRlcjsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuY29udGV4dC5hbm5vdGF0aW9uLkJlYW47CmltcG9ydCBvcmcuc3ByaW5nZnJhbWV3b3JrLmNvbnRleHQuYW5ub3RhdGlvbi5Db25maWd1cmF0aW9uOwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5qZGJjLmNvcmUuSmRiY1RlbXBsYXRlOwoKaW1wb3J0IGphdmF4LnNxbC5EYXRhU291cmNlOwoKQENvbmZpZ3VyYXRpb24KcHVibGljIGNsYXNzIE11bHRpcGxlRGF0YVNvdXJjZUNvbmZpZyB7CgogICAgQEJlYW4obmFtZSA9ICJwcmltYXJ5RGF0YVNvdXJjZSIpCiAgICBAQ29uZmlndXJhdGlvblByb3BlcnRpZXMocHJlZml4ID0gInNwcmluZy5kYXRhc291cmNlLnByaW1hcnkiKQogICAgcHVibGljIERhdGFTb3VyY2UgcHJpbWFyeURhdGFTb3VyY2UoKSB7CiAgICAgICAgcmV0dXJuIERhdGFTb3VyY2VCdWlsZGVyLmNyZWF0ZSgpLmJ1aWxkKCk7CiAgICB9CgogICAgQEJlYW4obmFtZSA9ICJzZWNvbmRhcnlEYXRhU291cmNlIikKICAgIEBDb25maWd1cmF0aW9uUHJvcGVydGllcyhwcmVmaXggPSAic3ByaW5nLmRhdGFzb3VyY2Uuc2Vjb25kYXJ5IikKICAgIHB1YmxpYyBEYXRhU291cmNlIHNlY29uZGFyeURhdGFTb3VyY2UoKSB7CiAgICAgICAgcmV0dXJuIERhdGFTb3VyY2VCdWlsZGVyLmNyZWF0ZSgpLmJ1aWxkKCk7CiAgICB9CgogICAgQEJlYW4obmFtZSA9ICJwcmltYXJ5SmRiY1RlbXBsYXRlIikKICAgIHB1YmxpYyBKZGJjVGVtcGxhdGUgcHJpbWFyeUpkYmNUZW1wbGF0ZShAUXVhbGlmaWVyKCJwcmltYXJ5RGF0YVNvdXJjZSIpIERhdGFTb3VyY2UgZGF0YVNvdXJjZSkgewogICAgICAgIHJldHVybiBuZXcgSmRiY1RlbXBsYXRlKGRhdGFTb3VyY2UpOwogICAgfQoKICAgIEBCZWFuKG5hbWUgPSAic2Vjb25kYXJ5SmRiY1RlbXBsYXRlIikKICAgIHB1YmxpYyBKZGJjVGVtcGxhdGUgc2Vjb25kYXJ5SmRiY1RlbXBsYXRlKEBRdWFsaWZpZXIoInNlY29uZGFyeURhdGFTb3VyY2UiKSBEYXRhU291cmNlIGRhdGFTb3VyY2UpIHsKICAgICAgICByZXR1cm4gbmV3IEpkYmNUZW1wbGF0ZShkYXRhU291cmNlKTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.jdbc.DataSourceBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.jdbc.core.JdbcTemplate;

import javax.sql.DataSource;

@Configuration
public class MultipleDataSourceConfig {

    @Bean(name = &quot;primaryDataSource&quot;)
    @ConfigurationProperties(prefix = &quot;spring.datasource.primary&quot;)
    public DataSource primaryDataSource() {
        return DataSourceBuilder.create().build();
    }

    @Bean(name = &quot;secondaryDataSource&quot;)
    @ConfigurationProperties(prefix = &quot;spring.datasource.secondary&quot;)
    public DataSource secondaryDataSource() {
        return DataSourceBuilder.create().build();
    }

    @Bean(name = &quot;primaryJdbcTemplate&quot;)
    public JdbcTemplate primaryJdbcTemplate(@Qualifier(&quot;primaryDataSource&quot;) DataSource dataSource) {
        return new JdbcTemplate(dataSource);
    }

    @Bean(name = &quot;secondaryJdbcTemplate&quot;)
    public JdbcTemplate secondaryJdbcTemplate(@Qualifier(&quot;secondaryDataSource&quot;) DataSource dataSource) {
        return new JdbcTemplate(dataSource);
    }
}</pre></div><div class='content'></div><h2><p>Explanation:</p>
</h2>
<div class='content'><ul>
<li><code>@Qualifier</code>: Used to specify which bean to inject when multiple beans of the same type exist.</li>
<li><code>JdbcTemplate</code>: A Spring class that simplifies JDBC operations.</li>
</ul>
</div><h2><p><code>application.properties</code> Example:</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQcmltYXJ5IERhdGFTb3VyY2Ugc2V0dGluZ3MKc3ByaW5nLmRhdGFzb3VyY2UucHJpbWFyeS51cmw9amRiYzpteXNxbDovL2xvY2FsaG9zdDozMzA2L3ByaW1hcnlkYgpzcHJpbmcuZGF0YXNvdXJjZS5wcmltYXJ5LnVzZXJuYW1lPXJvb3QKc3ByaW5nLmRhdGFzb3VyY2UucHJpbWFyeS5wYXNzd29yZD1zZWNyZXQKc3ByaW5nLmRhdGFzb3VyY2UucHJpbWFyeS5kcml2ZXItY2xhc3MtbmFtZT1jb20ubXlzcWwuY2ouamRiYy5Ecml2ZXIKCiMgU2Vjb25kYXJ5IERhdGFTb3VyY2Ugc2V0dGluZ3MKc3ByaW5nLmRhdGFzb3VyY2Uuc2Vjb25kYXJ5LnVybD1qZGJjOm15c3FsOi8vbG9jYWxob3N0OjMzMDYvc2Vjb25kYXJ5ZGIKc3ByaW5nLmRhdGFzb3VyY2Uuc2Vjb25kYXJ5LnVzZXJuYW1lPXJvb3QKc3ByaW5nLmRhdGFzb3VyY2Uuc2Vjb25kYXJ5LnBhc3N3b3JkPXNlY3JldApzcHJpbmcuZGF0YXNvdXJjZS5zZWNvbmRhcnkuZHJpdmVyLWNsYXNzLW5hbWU9Y29tLm15c3FsLmNqLmpkYmMuRHJpdmVy"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Primary DataSource settings
spring.datasource.primary.url=jdbc:mysql://localhost:3306/primarydb
spring.datasource.primary.username=root
spring.datasource.primary.password=secret
spring.datasource.primary.driver-class-name=com.mysql.cj.jdbc.Driver

# Secondary DataSource settings
spring.datasource.secondary.url=jdbc:mysql://localhost:3306/secondarydb
spring.datasource.secondary.username=root
spring.datasource.secondary.password=secret
spring.datasource.secondary.driver-class-name=com.mysql.cj.jdbc.Driver</pre></div><div class='content'></div><h1><ol start="5">
<li>Practical Exercises</li>
</ol>
</h1>
<div class='content'></div><h2><p>Exercise 1: Configure a Single Data Source</p>
</h2>
<div class='content'><ol>
<li>Create a new Spring Boot project.</li>
<li>Add the necessary dependencies for MySQL.</li>
<li>Configure a single data source in <code>application.properties</code>.</li>
<li>Verify the configuration by creating a simple repository and performing a CRUD operation.</li>
</ol>
</div><h2><p>Solution:</p>
</h2>
<div class='content'><ol>
<li>Create a new Spring Boot project using Spring Initializr.</li>
<li>Add the following dependencies in <code>pom.xml</code>:
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;mysql&lt;/groupId&gt;
    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li>Configure the data source in <code>application.properties</code>:
<pre><code class="language-properties">spring.datasource.url=jdbc:mysql://localhost:3306/mydatabase
spring.datasource.username=root
spring.datasource.password=secret
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL5Dialect
</code></pre>
</li>
<li>Create a simple JPA entity and repository:
<pre><code class="language-java">@Entity
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private String name;
    // getters and setters
}

public interface UserRepository extends JpaRepository&lt;User, Long&gt; {
}
</code></pre>
</li>
<li>Perform a CRUD operation in a service or controller to verify the configuration.</li>
</ol>
</div><h2><p>Exercise 2: Configure Multiple Data Sources</p>
</h2>
<div class='content'><ol>
<li>Extend the previous exercise to configure a secondary data source.</li>
<li>Create a new repository that uses the secondary data source.</li>
<li>Perform a CRUD operation using both data sources.</li>
</ol>
</div><h2><p>Solution:</p>
</h2>
<div class='content'><ol>
<li>Follow the steps in the &quot;Using Multiple Data Sources&quot; section to configure multiple data sources.</li>
<li>Create a new repository for the secondary data source:
<pre><code class="language-java">@Entity
public class Product {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private String name;
    // getters and setters
}

public interface ProductRepository extends JpaRepository&lt;Product, Long&gt; {
}
</code></pre>
</li>
<li>Perform CRUD operations using both <code>UserRepository</code> and <code>ProductRepository</code>.</li>
</ol>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered how to configure data sources in a Spring Boot application using both <code>application.properties</code> and Java configuration. We also explored how to configure multiple data sources and provided practical exercises to reinforce the concepts. Understanding how to configure data sources is essential for building robust and scalable Spring Boot applications. In the next section, we will delve into creating JPA entities and using Spring Data repositories.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-01-introduction-spring-data-jpa' title="Introduction to Spring Data JPA">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='04-03-creating-jpa-entities' title="Creating JPA Entities">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
