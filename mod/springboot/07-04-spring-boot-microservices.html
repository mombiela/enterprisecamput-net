<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring Boot and Microservices</title>

    <link rel="alternate" href="https://campusempresa.com/mod/springboot/07-04-spring-boot-microservices" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/springboot/07-04-spring-boot-microservices" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/springboot/07-04-spring-boot-microservices" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/springboot/07-04-spring-boot-microservices" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/springboot/07-04-spring-boot-microservices" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-03-spring-boot-docker' title="Spring Boot with Docker">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Spring Boot and Microservices</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='08-01-introduction-deployment' title="Introduction to Deployment">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Microservices architecture is a design pattern that structures an application as a collection of loosely coupled services. Each service is fine-grained and the protocols are lightweight. This module will guide you through the process of building microservices using Spring Boot.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Microservices Architecture</strong>:</p>
<ul>
<li><strong>Definition</strong>: A method of developing software systems that tries to focus on building single-function modules with well-defined interfaces and operations.</li>
<li><strong>Benefits</strong>: Scalability, flexibility, and the ability to deploy services independently.</li>
<li><strong>Challenges</strong>: Complexity in management, inter-service communication, and data consistency.</li>
</ul>
</li>
<li>
<p><strong>Spring Boot for Microservices</strong>:</p>
<ul>
<li><strong>Spring Boot</strong>: Provides a robust framework to build microservices with ease.</li>
<li><strong>Spring Cloud</strong>: A suite of tools to manage microservices, including service discovery, configuration management, and circuit breakers.</li>
</ul>
</li>
</ol>
</div><h1><p>Building Microservices with Spring Boot</p>
</h1>
<div class='content'></div><h2><p>Step 1: Setting Up the Project</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Create a New Spring Boot Project</strong>:</p>
<ul>
<li>Use Spring Initializr (https://start.spring.io/) to generate a new project.</li>
<li>Select dependencies: Spring Web, Spring Boot DevTools, and Spring Data JPA.</li>
</ul>
</li>
<li>
<p><strong>Project Structure</strong>:</p>
<ul>
<li>The project structure will be similar to a standard Spring Boot application but will focus on modularity.</li>
</ul>
</li>
</ol>
</div><h2><p>Step 2: Creating a Simple Microservice</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Define the Entity</strong>:</p>
<pre><code class="language-java">@Entity
public class Product {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private String name;
    private double price;

    // Getters and Setters
}
</code></pre>
</li>
<li>
<p><strong>Create the Repository</strong>:</p>
<pre><code class="language-java">public interface ProductRepository extends JpaRepository&lt;Product, Long&gt; {
}
</code></pre>
</li>
<li>
<p><strong>Create the Service Layer</strong>:</p>
<pre><code class="language-java">@Service
public class ProductService {
    @Autowired
    private ProductRepository productRepository;

    public List&lt;Product&gt; getAllProducts() {
        return productRepository.findAll();
    }

    public Product getProductById(Long id) {
        return productRepository.findById(id).orElse(null);
    }

    public Product saveProduct(Product product) {
        return productRepository.save(product);
    }

    public void deleteProduct(Long id) {
        productRepository.deleteById(id);
    }
}
</code></pre>
</li>
<li>
<p><strong>Create the REST Controller</strong>:</p>
<pre><code class="language-java">@RestController
@RequestMapping(&quot;/products&quot;)
public class ProductController {
    @Autowired
    private ProductService productService;

    @GetMapping
    public List&lt;Product&gt; getAllProducts() {
        return productService.getAllProducts();
    }

    @GetMapping(&quot;/{id}&quot;)
    public Product getProductById(@PathVariable Long id) {
        return productService.getProductById(id);
    }

    @PostMapping
    public Product createProduct(@RequestBody Product product) {
        return productService.saveProduct(product);
    }

    @DeleteMapping(&quot;/{id}&quot;)
    public void deleteProduct(@PathVariable Long id) {
        productService.deleteProduct(id);
    }
}
</code></pre>
</li>
</ol>
</div><h2><p>Step 3: Service Discovery with Eureka</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Add Eureka Server Dependency</strong>:</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li>
<p><strong>Enable Eureka Server</strong>:</p>
<pre><code class="language-java">@SpringBootApplication
@EnableEurekaServer
public class EurekaServerApplication {
    public static void main(String[] args) {
        SpringApplication.run(EurekaServerApplication.class, args);
    }
}
</code></pre>
</li>
<li>
<p><strong>Configure Eureka Server</strong>:</p>
<pre><code class="language-yaml">server:
  port: 8761

eureka:
  client:
    register-with-eureka: false
    fetch-registry: false
  server:
    wait-time-in-ms-when-sync-empty: 0
</code></pre>
</li>
<li>
<p><strong>Add Eureka Client Dependency to Microservice</strong>:</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li>
<p><strong>Enable Eureka Client</strong>:</p>
<pre><code class="language-java">@SpringBootApplication
@EnableEurekaClient
public class ProductServiceApplication {
    public static void main(String[] args) {
        SpringApplication.run(ProductServiceApplication.class, args);
    }
}
</code></pre>
</li>
<li>
<p><strong>Configure Eureka Client</strong>:</p>
<pre><code class="language-yaml">eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/
</code></pre>
</li>
</ol>
</div><h2><p>Step 4: API Gateway with Spring Cloud Gateway</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Add Spring Cloud Gateway Dependency</strong>:</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li>
<p><strong>Configure Routes</strong>:</p>
<pre><code class="language-yaml">spring:
  cloud:
    gateway:
      routes:
        - id: product-service
          uri: lb://PRODUCT-SERVICE
          predicates:
            - Path=/products/**
</code></pre>
</li>
</ol>
</div><h2><p>Step 5: Centralized Configuration with Spring Cloud Config</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Add Spring Cloud Config Server Dependency</strong>:</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li>
<p><strong>Enable Config Server</strong>:</p>
<pre><code class="language-java">@SpringBootApplication
@EnableConfigServer
public class ConfigServerApplication {
    public static void main(String[] args) {
        SpringApplication.run(ConfigServerApplication.class, args);
    }
}
</code></pre>
</li>
<li>
<p><strong>Configure Config Server</strong>:</p>
<pre><code class="language-yaml">server:
  port: 8888

spring:
  cloud:
    config:
      server:
        git:
          uri: https://github.com/your-repo/config-repo
</code></pre>
</li>
<li>
<p><strong>Add Config Client Dependency to Microservice</strong>:</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li>
<p><strong>Configure Config Client</strong>:</p>
<pre><code class="language-yaml">spring:
  cloud:
    config:
      uri: http://localhost:8888
</code></pre>
</li>
</ol>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Create a Microservice for Order Management</p>
</h2>
<div class='content'><ol>
<li><strong>Create a new Spring Boot project for the Order Service</strong>.</li>
<li><strong>Define an <code>Order</code> entity with fields like <code>id</code>, <code>productId</code>, <code>quantity</code>, and <code>status</code></strong>.</li>
<li><strong>Create a repository, service, and REST controller for the Order entity</strong>.</li>
<li><strong>Register the Order Service with Eureka</strong>.</li>
<li><strong>Configure the API Gateway to route requests to the Order Service</strong>.</li>
<li><strong>Use Spring Cloud Config to manage the configuration of the Order Service</strong>.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Order Entity</strong>:</p>
<pre><code class="language-java">@Entity
public class Order {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    private Long productId;
    private int quantity;
    private String status;

    // Getters and Setters
}
</code></pre>
</li>
<li>
<p><strong>Order Repository</strong>:</p>
<pre><code class="language-java">public interface OrderRepository extends JpaRepository&lt;Order, Long&gt; {
}
</code></pre>
</li>
<li>
<p><strong>Order Service</strong>:</p>
<pre><code class="language-java">@Service
public class OrderService {
    @Autowired
    private OrderRepository orderRepository;

    public List&lt;Order&gt; getAllOrders() {
        return orderRepository.findAll();
    }

    public Order getOrderById(Long id) {
        return orderRepository.findById(id).orElse(null);
    }

    public Order saveOrder(Order order) {
        return orderRepository.save(order);
    }

    public void deleteOrder(Long id) {
        orderRepository.deleteById(id);
    }
}
</code></pre>
</li>
<li>
<p><strong>Order Controller</strong>:</p>
<pre><code class="language-java">@RestController
@RequestMapping(&quot;/orders&quot;)
public class OrderController {
    @Autowired
    private OrderService orderService;

    @GetMapping
    public List&lt;Order&gt; getAllOrders() {
        return orderService.getAllOrders();
    }

    @GetMapping(&quot;/{id}&quot;)
    public Order getOrderById(@PathVariable Long id) {
        return orderService.getOrderById(id);
    }

    @PostMapping
    public Order createOrder(@RequestBody Order order) {
        return orderService.saveOrder(order);
    }

    @DeleteMapping(&quot;/{id}&quot;)
    public void deleteOrder(@PathVariable Long id) {
        orderService.deleteOrder(id);
    }
}
</code></pre>
</li>
<li>
<p><strong>Eureka Client Configuration</strong>:</p>
<pre><code class="language-yaml">eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/
</code></pre>
</li>
<li>
<p><strong>API Gateway Configuration</strong>:</p>
<pre><code class="language-yaml">spring:
  cloud:
    gateway:
      routes:
        - id: order-service
          uri: lb://ORDER-SERVICE
          predicates:
            - Path=/orders/**
</code></pre>
</li>
<li>
<p><strong>Config Client Configuration</strong>:</p>
<pre><code class="language-yaml">spring:
  cloud:
    config:
      uri: http://localhost:8888
</code></pre>
</li>
</ol>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this module, you learned how to build microservices using Spring Boot. You explored the key concepts of microservices architecture, created a simple microservice, and integrated it with Eureka for service discovery. You also learned how to use Spring Cloud Gateway for API routing and Spring Cloud Config for centralized configuration management. By completing the practical exercise, you reinforced your understanding of these concepts and gained hands-on experience in building microservices.</p>
<p>Next, you will delve into deploying Spring Boot applications, where you will learn how to deploy your microservices to various platforms such as Heroku, AWS, and Kubernetes.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-03-spring-boot-docker' title="Spring Boot with Docker">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='08-01-introduction-deployment' title="Introduction to Deployment">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
