<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction to SQL in RPG</title>

    <link rel="alternate" href="https://campusempresa.com/mod/rpg/sql-in-rpg" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/rpg/sql-in-rpg" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/rpg/sql-in-rpg" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/rpg/sql-in-rpg" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/rpg/sql-in-rpg" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='binding-directories'>&#x25C4;Binding Directories</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Introduction to SQL in RPG</a>
	</div>
	<div class='col-4 text-end'>
					<a href='embedded-sql'>Embedded SQL &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Overview</h1>
<div class='content'><p>SQL (Structured Query Language) is a powerful tool for managing and manipulating databases. In the context of RPG (Report Program Generator), integrating SQL can significantly enhance data processing capabilities. This section will introduce you to the basics of using SQL within RPG programs.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Embedded SQL</strong>: SQL statements embedded directly within RPG code.</li>
<li><strong>SQL Precompilers</strong>: Tools that process embedded SQL statements before the RPG program is compiled.</li>
<li><strong>SQLCA (SQL Communication Area)</strong>: A structure used to handle SQL execution status and errors.</li>
<li><strong>CRUD Operations</strong>: Basic SQL operations - Create, Read, Update, Delete.</li>
</ul>
</div><h1>Setting Up SQL in RPG</h1>
<div class='content'><p>To use SQL in RPG, you need to ensure your environment is set up correctly:</p>
<ol>
<li><strong>Include SQL Precompiler</strong>: Ensure your RPG compiler supports SQL precompilation.</li>
<li><strong>Database Connection</strong>: Establish a connection to your database.</li>
</ol>
</div><h1>Basic SQL Operations in RPG</h1>
<div class='content'></div><h2>Selecting Data</h2>
<div class='content'><p>To retrieve data from a database, you use the <code>SELECT</code> statement.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLVMgQ3VzdG9tZXJOYW1lIENoYXIoNTApOwpFeGVjIFNRTAogICAgU0VMRUNUIE5hbWUgSU5UTyA6Q3VzdG9tZXJOYW1lCiAgICBGUk9NIEN1c3RvbWVycwogICAgV0hFUkUgQ3VzdG9tZXJJRCA9IDE7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-S CustomerName Char(50);
Exec SQL
    SELECT Name INTO :CustomerName
    FROM Customers
    WHERE CustomerID = 1;</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>Dcl-S CustomerName Char(50);</code>: Declares a variable to store the customer's name.</li>
<li><code>Exec SQL</code>: Indicates the start of an embedded SQL statement.</li>
<li><code>SELECT Name INTO :CustomerName</code>: Selects the <code>Name</code> field from the <code>Customers</code> table and stores it in the <code>CustomerName</code> variable.</li>
<li><code>WHERE CustomerID = 1;</code>: Specifies the condition to filter the data.</li>
</ul>
</li>
</ul>
</div><h2>Inserting Data</h2>
<div class='content'><p>To add new records to a table, use the <code>INSERT</code> statement.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLVMgQ3VzdG9tZXJJRCBJbnQoMTApOwpEY2wtUyBDdXN0b21lck5hbWUgQ2hhcig1MCk7CkN1c3RvbWVySUQgPSAyOwpDdXN0b21lck5hbWUgPSAnSm9obiBEb2UnOwoKRXhlYyBTUUwKICAgIElOU0VSVCBJTlRPIEN1c3RvbWVycyAoQ3VzdG9tZXJJRCwgTmFtZSkKICAgIFZBTFVFUyAoOkN1c3RvbWVySUQsIDpDdXN0b21lck5hbWUpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-S CustomerID Int(10);
Dcl-S CustomerName Char(50);
CustomerID = 2;
CustomerName = 'John Doe';

Exec SQL
    INSERT INTO Customers (CustomerID, Name)
    VALUES (:CustomerID, :CustomerName);</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>Dcl-S CustomerID Int(10);</code>: Declares a variable for the customer ID.</li>
<li><code>Dcl-S CustomerName Char(50);</code>: Declares a variable for the customer's name.</li>
<li><code>CustomerID = 2;</code>: Assigns a value to the <code>CustomerID</code> variable.</li>
<li><code>CustomerName = 'John Doe';</code>: Assigns a value to the <code>CustomerName</code> variable.</li>
<li><code>INSERT INTO Customers (CustomerID, Name)</code>: Specifies the table and columns to insert data into.</li>
<li><code>VALUES (:CustomerID, :CustomerName);</code>: Provides the values to be inserted.</li>
</ul>
</li>
</ul>
</div><h2>Updating Data</h2>
<div class='content'><p>To modify existing records, use the <code>UPDATE</code> statement.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLVMgQ3VzdG9tZXJJRCBJbnQoMTApOwpEY2wtUyBOZXdOYW1lIENoYXIoNTApOwpDdXN0b21lcklEID0gMjsKTmV3TmFtZSA9ICdKYW5lIERvZSc7CgpFeGVjIFNRTAogICAgVVBEQVRFIEN1c3RvbWVycwogICAgU0VUIE5hbWUgPSA6TmV3TmFtZQogICAgV0hFUkUgQ3VzdG9tZXJJRCA9IDpDdXN0b21lcklEOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-S CustomerID Int(10);
Dcl-S NewName Char(50);
CustomerID = 2;
NewName = 'Jane Doe';

Exec SQL
    UPDATE Customers
    SET Name = :NewName
    WHERE CustomerID = :CustomerID;</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>Dcl-S CustomerID Int(10);</code>: Declares a variable for the customer ID.</li>
<li><code>Dcl-S NewName Char(50);</code>: Declares a variable for the new name.</li>
<li><code>CustomerID = 2;</code>: Assigns a value to the <code>CustomerID</code> variable.</li>
<li><code>NewName = 'Jane Doe';</code>: Assigns a value to the <code>NewName</code> variable.</li>
<li><code>UPDATE Customers</code>: Specifies the table to update.</li>
<li><code>SET Name = :NewName</code>: Sets the new value for the <code>Name</code> column.</li>
<li><code>WHERE CustomerID = :CustomerID;</code>: Specifies the condition to identify the record to update.</li>
</ul>
</li>
</ul>
</div><h2>Deleting Data</h2>
<div class='content'><p>To remove records from a table, use the <code>DELETE</code> statement.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLVMgQ3VzdG9tZXJJRCBJbnQoMTApOwpDdXN0b21lcklEID0gMjsKCkV4ZWMgU1FMCiAgICBERUxFVEUgRlJPTSBDdXN0b21lcnMKICAgIFdIRVJFIEN1c3RvbWVySUQgPSA6Q3VzdG9tZXJJRDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-S CustomerID Int(10);
CustomerID = 2;

Exec SQL
    DELETE FROM Customers
    WHERE CustomerID = :CustomerID;</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>Dcl-S CustomerID Int(10);</code>: Declares a variable for the customer ID.</li>
<li><code>CustomerID = 2;</code>: Assigns a value to the <code>CustomerID</code> variable.</li>
<li><code>DELETE FROM Customers</code>: Specifies the table to delete from.</li>
<li><code>WHERE CustomerID = :CustomerID;</code>: Specifies the condition to identify the record to delete.</li>
</ul>
</li>
</ul>
</div><h1>Error Handling with SQLCA</h1>
<div class='content'><p>SQLCA (SQL Communication Area) is used to handle errors and status information for SQL operations.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLURTIFNRTENBOwogIFNRTENPREUgSW50KDEwKTsKICBTUUxTVEFURSBDaGFyKDUpOwpFbmQtRFM7CgpFeGVjIFNRTAogICAgU0VMRUNUIE5hbWUgSU5UTyA6Q3VzdG9tZXJOYW1lCiAgICBGUk9NIEN1c3RvbWVycwogICAgV0hFUkUgQ3VzdG9tZXJJRCA9IDE7CgpJZiBTUUxDQS5TUUxDT0RFIDw+IDA7CiAgLy8gSGFuZGxlIGVycm9yCiAgRHNwbHkgKCdFcnJvcjogJyArICVDaGFyKFNRTENBLlNRTENPREUpKTsKRW5kSWY7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-DS SQLCA;
  SQLCODE Int(10);
  SQLSTATE Char(5);
End-DS;

Exec SQL
    SELECT Name INTO :CustomerName
    FROM Customers
    WHERE CustomerID = 1;

If SQLCA.SQLCODE &lt;&gt; 0;
  // Handle error
  Dsply ('Error: ' + %Char(SQLCA.SQLCODE));
EndIf;</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>Dcl-DS SQLCA;</code>: Declares the SQLCA data structure.</li>
<li><code>SQLCODE Int(10);</code>: Declares a variable to store the SQL return code.</li>
<li><code>SQLSTATE Char(5);</code>: Declares a variable to store the SQL state.</li>
<li><code>If SQLCA.SQLCODE &lt;&gt; 0;</code>: Checks if there was an error during the SQL operation.</li>
<li><code>Dsply ('Error: ' + %Char(SQLCA.SQLCODE));</code>: Displays the error code.</li>
</ul>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Integrating SQL with RPG can greatly enhance your ability to manage and manipulate data within your applications. By understanding and utilizing basic SQL operations such as <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, and <code>DELETE</code>, you can perform a wide range of data processing tasks. Additionally, handling errors using SQLCA ensures your programs can gracefully manage and respond to issues that arise during SQL execution.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='binding-directories'>&#x25C4;Binding Directories</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Introduction to SQL in RPG</a>
	</div>
	<div class='col-4 text-end'>
					<a href='embedded-sql'>Embedded SQL &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
