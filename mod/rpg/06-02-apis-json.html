<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APIs and JSON</title>

    <link rel="alternate" href="https://campusempresa.com/mod/rpg/06-02-apis-json" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/rpg/06-02-apis-json" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/rpg/06-02-apis-json" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/rpg/06-02-apis-json" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/rpg/06-02-apis-json" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='06-01-web-services' title="Web Services">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">APIs and JSON</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-03-xml-handling' title="XML Handling">Next &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this module, we will explore how to integrate RPG with modern technologies, focusing on APIs and JSON. Understanding these concepts is crucial for developing applications that can communicate with other systems and services over the web.</p>
</div><h1>What is an API?</h1>
<div class='content'><p>An API (Application Programming Interface) is a set of rules and protocols for building and interacting with software applications. APIs allow different software systems to communicate with each other.</p>
</div><h2>Key Concepts:</h2>
<div class='content'><ul>
<li><strong>Endpoints</strong>: Specific URLs where API services are accessed.</li>
<li><strong>HTTP Methods</strong>: Common methods include GET, POST, PUT, DELETE.</li>
<li><strong>Request and Response</strong>: Data sent to and received from the API.</li>
</ul>
</div><h1>What is JSON?</h1>
<div class='content'><p>JSON (JavaScript Object Notation) is a lightweight data interchange format that is easy for humans to read and write and easy for machines to parse and generate.</p>
</div><h2>JSON Structure:</h2>
<div class='content'><ul>
<li><strong>Objects</strong>: Enclosed in curly braces <code>{}</code> and contain key-value pairs.</li>
<li><strong>Arrays</strong>: Enclosed in square brackets <code>[]</code> and contain a list of values.</li>
<li><strong>Values</strong>: Can be strings, numbers, objects, arrays, true, false, or null.</li>
</ul>
</div><h2>Example JSON:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJuYW1lIjogIkpvaG4gRG9lIiwKICAiYWdlIjogMzAsCiAgImlzRW1wbG95ZWUiOiB0cnVlLAogICJza2lsbHMiOiBbIlJQRyIsICJTUUwiLCAiSmF2YSJdLAogICJhZGRyZXNzIjogewogICAgInN0cmVldCI6ICIxMjMgTWFpbiBTdCIsCiAgICAiY2l0eSI6ICJBbnl0b3duIiwKICAgICJ6aXBjb2RlIjogIjEyMzQ1IgogIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;name&quot;: &quot;John Doe&quot;,
  &quot;age&quot;: 30,
  &quot;isEmployee&quot;: true,
  &quot;skills&quot;: [&quot;RPG&quot;, &quot;SQL&quot;, &quot;Java&quot;],
  &quot;address&quot;: {
    &quot;street&quot;: &quot;123 Main St&quot;,
    &quot;city&quot;: &quot;Anytown&quot;,
    &quot;zipcode&quot;: &quot;12345&quot;
  }
}</pre></div><div class='content'></div><h1>Using APIs in RPG</h1>
<div class='content'><p>To interact with APIs in RPG, you typically use HTTP functions to send requests and handle responses. Let's go through a practical example.</p>
</div><h2>Example: Fetching Data from an API</h2>
<div class='content'><p>We'll use a simple public API to fetch user data.</p>
</div><h2>Step-by-Step Guide:</h2>
<div class='content'><ol>
<li>
<p><strong>Define the API Endpoint</strong>:</p>
<pre><code class="language-rpg">Dcl-S apiUrl Varchar(256) Inz('https://jsonplaceholder.typicode.com/users/1');
</code></pre>
</li>
<li>
<p><strong>Send HTTP GET Request</strong>:</p>
<pre><code class="language-rpg">Dcl-S httpResponse Varchar(32767);
Dcl-S httpStatus Int(10);

// Use HTTP API to send GET request
httpStatus = http_url_get(apiUrl: httpResponse);
</code></pre>
</li>
<li>
<p><strong>Check Response Status</strong>:</p>
<pre><code class="language-rpg">If httpStatus = 200;
   // Successful response
   Dsply httpResponse;
Else;
   // Handle error
   Dsply 'Error fetching data';
EndIf;
</code></pre>
</li>
</ol>
</div><h2>Parsing JSON in RPG</h2>
<div class='content'><p>To parse JSON data in RPG, you can use the JSON_TABLE function or a JSON parsing library.</p>
</div><h2>Example: Parsing JSON Response</h2>
<div class='content'><p>Assume the response is:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJpZCI6IDEsCiAgIm5hbWUiOiAiTGVhbm5lIEdyYWhhbSIsCiAgInVzZXJuYW1lIjogIkJyZXQiLAogICJlbWFpbCI6ICJTaW5jZXJlQGFwcmlsLmJpeiIKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;id&quot;: 1,
  &quot;name&quot;: &quot;Leanne Graham&quot;,
  &quot;username&quot;: &quot;Bret&quot;,
  &quot;email&quot;: &quot;Sincere@april.biz&quot;
}</pre></div><div class='content'></div><h2>Step-by-Step Guide:</h2>
<div class='content'><ol>
<li>
<p><strong>Define Data Structure for JSON</strong>:</p>
<pre><code class="language-rpg">Dcl-Ds userData Qualified;
   id Int(10);
   name Varchar(50);
   username Varchar(50);
   email Varchar(50);
End-Ds;
</code></pre>
</li>
<li>
<p><strong>Parse JSON Response</strong>:</p>
<pre><code class="language-rpg">// Assuming a JSON parsing procedure 'parseJson' is available
parseJson(httpResponse: userData);
</code></pre>
</li>
<li>
<p><strong>Access Parsed Data</strong>:</p>
<pre><code class="language-rpg">Dsply userData.name; // Displays &quot;Leanne Graham&quot;
</code></pre>
</li>
</ol>
</div><h1>Practical Exercise</h1>
<h2>Task:</h2>
<div class='content'><p>Write an RPG program that fetches a list of users from the API <code>https://jsonplaceholder.typicode.com/users</code> and displays the name and email of each user.</p>
</div><h2>Solution:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLVMgYXBpVXJsIFZhcmNoYXIoMjU2KSBJbnooJ2h0dHBzOi8vanNvbnBsYWNlaG9sZGVyLnR5cGljb2RlLmNvbS91c2VycycpOwpEY2wtUyBodHRwUmVzcG9uc2UgVmFyY2hhcigzMjc2Nyk7CkRjbC1TIGh0dHBTdGF0dXMgSW50KDEwKTsKCi8vIERlZmluZSBkYXRhIHN0cnVjdHVyZSBmb3IgdXNlcgpEY2wtRHMgdXNlciBRdWFsaWZpZWQ7CiAgIGlkIEludCgxMCk7CiAgIG5hbWUgVmFyY2hhcig1MCk7CiAgIHVzZXJuYW1lIFZhcmNoYXIoNTApOwogICBlbWFpbCBWYXJjaGFyKDUwKTsKRW5kLURzOwoKLy8gRGVmaW5lIGFycmF5IHRvIGhvbGQgdXNlcnMKRGNsLVMgdXNlcnMgTGlrZURzKHVzZXIpIERpbSgxMCk7CgovLyBTZW5kIEhUVFAgR0VUIHJlcXVlc3QKaHR0cFN0YXR1cyA9IGh0dHBfdXJsX2dldChhcGlVcmw6IGh0dHBSZXNwb25zZSk7CgpJZiBodHRwU3RhdHVzID0gMjAwOwogICAvLyBQYXJzZSBKU09OIHJlc3BvbnNlIGludG8gdXNlcnMgYXJyYXkKICAgcGFyc2VKc29uKGh0dHBSZXNwb25zZTogdXNlcnMpOwoKICAgLy8gRGlzcGxheSB1c2VyIG5hbWVzIGFuZCBlbWFpbHMKICAgRm9yIGkgPSAxIHRvICVFbGVtKHVzZXJzKTsKICAgICAgRHNwbHkgdXNlcnMoaSkubmFtZSArICcgLSAnICsgdXNlcnMoaSkuZW1haWw7CiAgIEVuZEZvcjsKRWxzZTsKICAgRHNwbHkgJ0Vycm9yIGZldGNoaW5nIGRhdGEnOwpFbmRJZjs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-S apiUrl Varchar(256) Inz('https://jsonplaceholder.typicode.com/users');
Dcl-S httpResponse Varchar(32767);
Dcl-S httpStatus Int(10);

// Define data structure for user
Dcl-Ds user Qualified;
   id Int(10);
   name Varchar(50);
   username Varchar(50);
   email Varchar(50);
End-Ds;

// Define array to hold users
Dcl-S users LikeDs(user) Dim(10);

// Send HTTP GET request
httpStatus = http_url_get(apiUrl: httpResponse);

If httpStatus = 200;
   // Parse JSON response into users array
   parseJson(httpResponse: users);

   // Display user names and emails
   For i = 1 to %Elem(users);
      Dsply users(i).name + ' - ' + users(i).email;
   EndFor;
Else;
   Dsply 'Error fetching data';
EndIf;</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Incorrect URL</strong>: Ensure the API endpoint URL is correct.</li>
<li><strong>HTTP Methods</strong>: Use the correct HTTP method (GET, POST, etc.) as required by the API.</li>
<li><strong>Error Handling</strong>: Always check the response status and handle errors appropriately.</li>
<li><strong>JSON Parsing</strong>: Ensure the JSON structure matches the data structure in your RPG program.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we learned about APIs and JSON, how to send HTTP requests from RPG, and how to parse JSON responses. These skills are essential for integrating RPG applications with modern web services and external systems. In the next module, we will explore XML handling, another important data interchange format.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-01-web-services' title="Web Services">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-03-xml-handling' title="XML Handling">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
