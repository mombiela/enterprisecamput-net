<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Access</title>

    <link rel="alternate" href="https://campusempresa.com/mod/rpg/03-02-database-access" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/rpg/03-02-database-access" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/rpg/03-02-database-access" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/rpg/03-02-database-access" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/rpg/03-02-database-access" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='03-01-file-handling' title="File Handling">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Database Access</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-03-data-structures' title="Data Structures">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to access and manipulate databases using RPG. This is a crucial skill for any RPG programmer, as most business applications require interaction with databases to store and retrieve data.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Database Terminology</strong></p>
<ul>
<li><strong>Table</strong>: A collection of related data entries.</li>
<li><strong>Row</strong>: A single record in a table.</li>
<li><strong>Column</strong>: A single field in a table.</li>
<li><strong>Primary Key</strong>: A unique identifier for a row in a table.</li>
<li><strong>Foreign Key</strong>: A field in a table that links to the primary key of another table.</li>
</ul>
</li>
<li>
<p><strong>SQL (Structured Query Language)</strong></p>
<ul>
<li><strong>SELECT</strong>: Retrieve data from a database.</li>
<li><strong>INSERT</strong>: Add new data to a database.</li>
<li><strong>UPDATE</strong>: Modify existing data in a database.</li>
<li><strong>DELETE</strong>: Remove data from a database.</li>
</ul>
</li>
<li>
<p><strong>Embedded SQL in RPG</strong></p>
<ul>
<li>Using SQL statements directly within RPG code.</li>
</ul>
</li>
</ol>
</div><h1><p>Setting Up Database Access</p>
</h1>
<div class='content'><p>Before you can access a database, you need to ensure that your development environment is properly configured. This typically involves setting up a connection to the database and ensuring that you have the necessary permissions.</p>
</div><h2><p>Example: Connecting to a Database</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RENMLVMgZGJOYW1lIENIQVIoMTApIElOWignTVlEQicpOwpEQ0wtUyB1c2VyTmFtZSBDSEFSKDEwKSBJTlooJ1VTRVInKTsKRENMLVMgcGFzc3dvcmQgQ0hBUigxMCkgSU5aKCdQQVNTV09SRCcpOwoKRVhFQyBTUUwgQ09OTkVDVCBUTyA6ZGJOYW1lIFVTRVIgOnVzZXJOYW1lIFVTSU5HIDpwYXNzd29yZDsKSUYgU1FMQ09ERSA8PiAwOwogIC8vIEhhbmRsZSBjb25uZWN0aW9uIGVycm9yCkVORElGOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DCL-S dbName CHAR(10) INZ('MYDB');
DCL-S userName CHAR(10) INZ('USER');
DCL-S password CHAR(10) INZ('PASSWORD');

EXEC SQL CONNECT TO :dbName USER :userName USING :password;
IF SQLCODE &lt;&gt; 0;
  // Handle connection error
ENDIF;</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><code>DCL-S</code>: Declares a standalone variable.</li>
<li><code>INZ</code>: Initializes the variable with a value.</li>
<li><code>EXEC SQL CONNECT</code>: Connects to the specified database using the provided username and password.</li>
<li><code>SQLCODE</code>: A variable that holds the status of the last executed SQL statement. A value of 0 indicates success.</li>
</ul>
</div><h1><p>Retrieving Data</p>
</h1>
<div class='content'><p>To retrieve data from a database, you use the <code>SELECT</code> statement. This can be embedded directly in your RPG code.</p>
</div><h2><p>Example: Retrieving Data</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RENMLVMgY3VzdG9tZXJJZCBDSEFSKDEwKTsKRENMLVMgY3VzdG9tZXJOYW1lIENIQVIoNTApOwoKRVhFQyBTUUwKICBTRUxFQ1QgbmFtZSBJTlRPIDpjdXN0b21lck5hbWUKICBGUk9NIGN1c3RvbWVycwogIFdIRVJFIGlkID0gOmN1c3RvbWVySWQ7CgpJRiBTUUxDT0RFIDw+IDA7CiAgLy8gSGFuZGxlIHJldHJpZXZhbCBlcnJvcgpFTkRJRjs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DCL-S customerId CHAR(10);
DCL-S customerName CHAR(50);

EXEC SQL
  SELECT name INTO :customerName
  FROM customers
  WHERE id = :customerId;

IF SQLCODE &lt;&gt; 0;
  // Handle retrieval error
ENDIF;</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><code>SELECT name INTO :customerName</code>: Retrieves the <code>name</code> field from the <code>customers</code> table and stores it in the <code>customerName</code> variable.</li>
<li><code>WHERE id = :customerId</code>: Specifies the condition to match the <code>id</code> field with the <code>customerId</code> variable.</li>
</ul>
</div><h1><p>Inserting Data</p>
</h1>
<div class='content'><p>To add new data to a database, you use the <code>INSERT</code> statement.</p>
</div><h2><p>Example: Inserting Data</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RENMLVMgbmV3Q3VzdG9tZXJJZCBDSEFSKDEwKSBJTlooJ0NVU1QxMjMnKTsKRENMLVMgbmV3Q3VzdG9tZXJOYW1lIENIQVIoNTApIElOWignSm9obiBEb2UnKTsKCkVYRUMgU1FMCiAgSU5TRVJUIElOVE8gY3VzdG9tZXJzIChpZCwgbmFtZSkKICBWQUxVRVMgKDpuZXdDdXN0b21lcklkLCA6bmV3Q3VzdG9tZXJOYW1lKTsKCklGIFNRTENPREUgPD4gMDsKICAvLyBIYW5kbGUgaW5zZXJ0aW9uIGVycm9yCkVORElGOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DCL-S newCustomerId CHAR(10) INZ('CUST123');
DCL-S newCustomerName CHAR(50) INZ('John Doe');

EXEC SQL
  INSERT INTO customers (id, name)
  VALUES (:newCustomerId, :newCustomerName);

IF SQLCODE &lt;&gt; 0;
  // Handle insertion error
ENDIF;</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><code>INSERT INTO customers (id, name)</code>: Specifies the table and columns to insert data into.</li>
<li><code>VALUES (:newCustomerId, :newCustomerName)</code>: Provides the values to be inserted.</li>
</ul>
</div><h1><p>Updating Data</p>
</h1>
<div class='content'><p>To modify existing data in a database, you use the <code>UPDATE</code> statement.</p>
</div><h2><p>Example: Updating Data</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RENMLVMgdXBkYXRlQ3VzdG9tZXJJZCBDSEFSKDEwKSBJTlooJ0NVU1QxMjMnKTsKRENMLVMgbmV3Q3VzdG9tZXJOYW1lIENIQVIoNTApIElOWignSmFuZSBEb2UnKTsKCkVYRUMgU1FMCiAgVVBEQVRFIGN1c3RvbWVycwogIFNFVCBuYW1lID0gOm5ld0N1c3RvbWVyTmFtZQogIFdIRVJFIGlkID0gOnVwZGF0ZUN1c3RvbWVySWQ7CgpJRiBTUUxDT0RFIDw+IDA7CiAgLy8gSGFuZGxlIHVwZGF0ZSBlcnJvcgpFTkRJRjs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DCL-S updateCustomerId CHAR(10) INZ('CUST123');
DCL-S newCustomerName CHAR(50) INZ('Jane Doe');

EXEC SQL
  UPDATE customers
  SET name = :newCustomerName
  WHERE id = :updateCustomerId;

IF SQLCODE &lt;&gt; 0;
  // Handle update error
ENDIF;</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><code>UPDATE customers SET name = :newCustomerName</code>: Specifies the table and column to update.</li>
<li><code>WHERE id = :updateCustomerId</code>: Specifies the condition to match the <code>id</code> field with the <code>updateCustomerId</code> variable.</li>
</ul>
</div><h1><p>Deleting Data</p>
</h1>
<div class='content'><p>To remove data from a database, you use the <code>DELETE</code> statement.</p>
</div><h2><p>Example: Deleting Data</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RENMLVMgZGVsZXRlQ3VzdG9tZXJJZCBDSEFSKDEwKSBJTlooJ0NVU1QxMjMnKTsKCkVYRUMgU1FMCiAgREVMRVRFIEZST00gY3VzdG9tZXJzCiAgV0hFUkUgaWQgPSA6ZGVsZXRlQ3VzdG9tZXJJZDsKCklGIFNRTENPREUgPD4gMDsKICAvLyBIYW5kbGUgZGVsZXRpb24gZXJyb3IKRU5ESUY7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DCL-S deleteCustomerId CHAR(10) INZ('CUST123');

EXEC SQL
  DELETE FROM customers
  WHERE id = :deleteCustomerId;

IF SQLCODE &lt;&gt; 0;
  // Handle deletion error
ENDIF;</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><code>DELETE FROM customers WHERE id = :deleteCustomerId</code>: Specifies the table and condition to delete the matching row.</li>
</ul>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Task</p>
</h2>
<div class='content'><ol>
<li>Connect to a database.</li>
<li>Insert a new customer record.</li>
<li>Retrieve the newly inserted customer record.</li>
<li>Update the customer's name.</li>
<li>Delete the customer record.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RENMLVMgZGJOYW1lIENIQVIoMTApIElOWignTVlEQicpOwpEQ0wtUyB1c2VyTmFtZSBDSEFSKDEwKSBJTlooJ1VTRVInKTsKRENMLVMgcGFzc3dvcmQgQ0hBUigxMCkgSU5aKCdQQVNTV09SRCcpOwpEQ0wtUyBuZXdDdXN0b21lcklkIENIQVIoMTApIElOWignQ1VTVDEyMycpOwpEQ0wtUyBuZXdDdXN0b21lck5hbWUgQ0hBUig1MCkgSU5aKCdKb2huIERvZScpOwpEQ0wtUyB1cGRhdGVkQ3VzdG9tZXJOYW1lIENIQVIoNTApIElOWignSmFuZSBEb2UnKTsKRENMLVMgcmV0cmlldmVkQ3VzdG9tZXJOYW1lIENIQVIoNTApOwoKLy8gQ29ubmVjdCB0byB0aGUgZGF0YWJhc2UKRVhFQyBTUUwgQ09OTkVDVCBUTyA6ZGJOYW1lIFVTRVIgOnVzZXJOYW1lIFVTSU5HIDpwYXNzd29yZDsKSUYgU1FMQ09ERSA8PiAwOwogIC8vIEhhbmRsZSBjb25uZWN0aW9uIGVycm9yCiAgUkVUVVJOOwpFTkRJRjsKCi8vIEluc2VydCBhIG5ldyBjdXN0b21lcgpFWEVDIFNRTAogIElOU0VSVCBJTlRPIGN1c3RvbWVycyAoaWQsIG5hbWUpCiAgVkFMVUVTICg6bmV3Q3VzdG9tZXJJZCwgOm5ld0N1c3RvbWVyTmFtZSk7CklGIFNRTENPREUgPD4gMDsKICAvLyBIYW5kbGUgaW5zZXJ0aW9uIGVycm9yCiAgUkVUVVJOOwpFTkRJRjsKCi8vIFJldHJpZXZlIHRoZSBuZXdseSBpbnNlcnRlZCBjdXN0b21lcgpFWEVDIFNRTAogIFNFTEVDVCBuYW1lIElOVE8gOnJldHJpZXZlZEN1c3RvbWVyTmFtZQogIEZST00gY3VzdG9tZXJzCiAgV0hFUkUgaWQgPSA6bmV3Q3VzdG9tZXJJZDsKSUYgU1FMQ09ERSA8PiAwOwogIC8vIEhhbmRsZSByZXRyaWV2YWwgZXJyb3IKICBSRVRVUk47CkVORElGOwoKLy8gVXBkYXRlIHRoZSBjdXN0b21lcidzIG5hbWUKRVhFQyBTUUwKICBVUERBVEUgY3VzdG9tZXJzCiAgU0VUIG5hbWUgPSA6dXBkYXRlZEN1c3RvbWVyTmFtZQogIFdIRVJFIGlkID0gOm5ld0N1c3RvbWVySWQ7CklGIFNRTENPREUgPD4gMDsKICAvLyBIYW5kbGUgdXBkYXRlIGVycm9yCiAgUkVUVVJOOwpFTkRJRjsKCi8vIERlbGV0ZSB0aGUgY3VzdG9tZXIgcmVjb3JkCkVYRUMgU1FMCiAgREVMRVRFIEZST00gY3VzdG9tZXJzCiAgV0hFUkUgaWQgPSA6bmV3Q3VzdG9tZXJJZDsKSUYgU1FMQ09ERSA8PiAwOwogIC8vIEhhbmRsZSBkZWxldGlvbiBlcnJvcgogIFJFVFVSTjsKRU5ESUY7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DCL-S dbName CHAR(10) INZ('MYDB');
DCL-S userName CHAR(10) INZ('USER');
DCL-S password CHAR(10) INZ('PASSWORD');
DCL-S newCustomerId CHAR(10) INZ('CUST123');
DCL-S newCustomerName CHAR(50) INZ('John Doe');
DCL-S updatedCustomerName CHAR(50) INZ('Jane Doe');
DCL-S retrievedCustomerName CHAR(50);

// Connect to the database
EXEC SQL CONNECT TO :dbName USER :userName USING :password;
IF SQLCODE &lt;&gt; 0;
  // Handle connection error
  RETURN;
ENDIF;

// Insert a new customer
EXEC SQL
  INSERT INTO customers (id, name)
  VALUES (:newCustomerId, :newCustomerName);
IF SQLCODE &lt;&gt; 0;
  // Handle insertion error
  RETURN;
ENDIF;

// Retrieve the newly inserted customer
EXEC SQL
  SELECT name INTO :retrievedCustomerName
  FROM customers
  WHERE id = :newCustomerId;
IF SQLCODE &lt;&gt; 0;
  // Handle retrieval error
  RETURN;
ENDIF;

// Update the customer's name
EXEC SQL
  UPDATE customers
  SET name = :updatedCustomerName
  WHERE id = :newCustomerId;
IF SQLCODE &lt;&gt; 0;
  // Handle update error
  RETURN;
ENDIF;

// Delete the customer record
EXEC SQL
  DELETE FROM customers
  WHERE id = :newCustomerId;
IF SQLCODE &lt;&gt; 0;
  // Handle deletion error
  RETURN;
ENDIF;</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li>The solution follows the steps outlined in the task, demonstrating how to connect to a database, insert, retrieve, update, and delete a record.</li>
</ul>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Forgetting to check <code>SQLCODE</code></strong>: Always check <code>SQLCODE</code> after executing an SQL statement to handle any errors.</li>
<li><strong>Incorrect variable types</strong>: Ensure that the RPG variables match the data types of the database fields.</li>
<li><strong>Not closing the connection</strong>: Remember to close the database connection when done to free up resources.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, you learned how to access and manipulate databases using RPG. You covered the basics of connecting to a database, and performing CRUD (Create, Read, Update, Delete) operations. These skills are essential for developing robust business applications. In the next section, we will delve into data structures, which will further enhance your ability to manage and manipulate data efficiently.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='03-01-file-handling' title="File Handling">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-03-data-structures' title="Data Structures">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
