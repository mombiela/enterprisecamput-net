<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XML Handling</title>

    <link rel="alternate" href="https://campusempresa.com/mod/rpg/06-03-xml-handling" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/rpg/06-03-xml-handling" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/rpg/06-03-xml-handling" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/rpg/06-03-xml-handling" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/rpg/06-03-xml-handling" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='06-02-apis-json' title="APIs and JSON">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">XML Handling</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-04-interfacing-other-languages' title="Interfacing with Other Languages">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this module, we will explore how to handle XML data in RPG programming. XML (eXtensible Markup Language) is a widely-used format for data representation and exchange. Understanding how to parse, generate, and manipulate XML data is crucial for integrating RPG applications with other systems and technologies.</p>
</div><h1>Objectives</h1>
<div class='content'><p>By the end of this module, you will:</p>
<ul>
<li>Understand the basics of XML.</li>
<li>Learn how to parse XML data in RPG.</li>
<li>Learn how to generate XML data in RPG.</li>
<li>Work with practical examples and exercises to reinforce your understanding.</li>
</ul>
</div><h1>What is XML?</h1>
<div class='content'><p>XML stands for eXtensible Markup Language. It is a markup language much like HTML but is designed to store and transport data. XML is both human-readable and machine-readable, making it an ideal format for data interchange.</p>
</div><h2>Key Features of XML:</h2>
<div class='content'><ul>
<li><strong>Self-descriptive:</strong> XML documents contain metadata that describes the data.</li>
<li><strong>Hierarchical structure:</strong> Data is organized in a tree-like structure.</li>
<li><strong>Platform-independent:</strong> XML can be used across different systems and platforms.</li>
<li><strong>Extensible:</strong> Users can define their own tags and structure.</li>
</ul>
</div><h2>Example of an XML Document:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGludmVudG9yeT4KICAgIDxpdGVtPgogICAgICAgIDxpZD4xPC9pZD4KICAgICAgICA8bmFtZT5XaWRnZXQ8L25hbWU+CiAgICAgICAgPHF1YW50aXR5PjEwMDwvcXVhbnRpdHk+CiAgICAgICAgPHByaWNlPjkuOTk8L3ByaWNlPgogICAgPC9pdGVtPgogICAgPGl0ZW0+CiAgICAgICAgPGlkPjI8L2lkPgogICAgICAgIDxuYW1lPkdhZGdldDwvbmFtZT4KICAgICAgICA8cXVhbnRpdHk+NTA8L3F1YW50aXR5PgogICAgICAgIDxwcmljZT4xOS45OTwvcHJpY2U+CiAgICA8L2l0ZW0+CjwvaW52ZW50b3J5Pg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;inventory&gt;
    &lt;item&gt;
        &lt;id&gt;1&lt;/id&gt;
        &lt;name&gt;Widget&lt;/name&gt;
        &lt;quantity&gt;100&lt;/quantity&gt;
        &lt;price&gt;9.99&lt;/price&gt;
    &lt;/item&gt;
    &lt;item&gt;
        &lt;id&gt;2&lt;/id&gt;
        &lt;name&gt;Gadget&lt;/name&gt;
        &lt;quantity&gt;50&lt;/quantity&gt;
        &lt;price&gt;19.99&lt;/price&gt;
    &lt;/item&gt;
&lt;/inventory&gt;</pre></div><div class='content'></div><h1>Parsing XML in RPG</h1>
<div class='content'><p>Parsing XML involves reading an XML document and extracting the data. In RPG, we can use the XML-INTO opcode to parse XML data into a data structure.</p>
</div><h2>Example: Parsing XML Data</h2>
<div class='content'><p>Let's parse the example XML document into an RPG data structure.</p>
</div><h2>Step-by-Step Explanation:</h2>
<div class='content'><ol>
<li>
<p><strong>Define the Data Structure:</strong></p>
<pre><code class="language-rpg">Dcl-Ds Item Qualified;
    id       Int(10);
    name     Char(20);
    quantity Int(10);
    price    Packed(7:2);
End-Ds;

Dcl-Ds Inventory Qualified;
    item     LikeDs(Item) Dim(100);
End-Ds;
</code></pre>
</li>
<li>
<p><strong>XML Data:</strong></p>
<pre><code class="language-rpg">Dcl-S xmlData Char(1000);
xmlData = '&lt;inventory&gt;
              &lt;item&gt;
                  &lt;id&gt;1&lt;/id&gt;
                  &lt;name&gt;Widget&lt;/name&gt;
                  &lt;quantity&gt;100&lt;/quantity&gt;
                  &lt;price&gt;9.99&lt;/price&gt;
              &lt;/item&gt;
              &lt;item&gt;
                  &lt;id&gt;2&lt;/id&gt;
                  &lt;name&gt;Gadget&lt;/name&gt;
                  &lt;quantity&gt;50&lt;/quantity&gt;
                  &lt;price&gt;19.99&lt;/price&gt;
              &lt;/item&gt;
           &lt;/inventory&gt;';
</code></pre>
</li>
<li>
<p><strong>Parse the XML Data:</strong></p>
<pre><code class="language-rpg">Xml-Into Inventory %Xml(xmlData: 'case=any');
</code></pre>
</li>
<li>
<p><strong>Access the Parsed Data:</strong></p>
<pre><code class="language-rpg">Dcl-S i Int(10);
For i = 1 to %Elem(Inventory.item);
    If Inventory.item(i).id &lt;&gt; 0;
        Dsply ('ID: ' + %Char(Inventory.item(i).id));
        Dsply ('Name: ' + Inventory.item(i).name);
        Dsply ('Quantity: ' + %Char(Inventory.item(i).quantity));
        Dsply ('Price: ' + %Char(Inventory.item(i).price));
    EndIf;
EndFor;
</code></pre>
</li>
</ol>
</div><h2>Explanation:</h2>
<div class='content'><ul>
<li><strong>Data Structure Definition:</strong> We define a data structure <code>Item</code> to represent each item and an array <code>Inventory</code> to hold multiple items.</li>
<li><strong>XML Data:</strong> We store the XML data in a character variable <code>xmlData</code>.</li>
<li><strong>XML-INTO Opcode:</strong> We use the <code>XML-INTO</code> opcode to parse the XML data into the <code>Inventory</code> data structure.</li>
<li><strong>Accessing Data:</strong> We loop through the <code>Inventory</code> array and display the parsed data.</li>
</ul>
</div><h1>Generating XML in RPG</h1>
<div class='content'><p>Generating XML involves creating an XML document from RPG data structures. We can use the <code>XML-SAX</code> opcode to generate XML data.</p>
</div><h2>Example: Generating XML Data</h2>
<div class='content'><p>Let's generate an XML document from an RPG data structure.</p>
</div><h2>Step-by-Step Explanation:</h2>
<div class='content'><ol>
<li>
<p><strong>Define the Data Structure:</strong></p>
<pre><code class="language-rpg">Dcl-Ds Item Qualified;
    id       Int(10);
    name     Char(20);
    quantity Int(10);
    price    Packed(7:2);
End-Ds;

Dcl-Ds Inventory Qualified;
    item     LikeDs(Item) Dim(2);
End-Ds;
</code></pre>
</li>
<li>
<p><strong>Populate the Data Structure:</strong></p>
<pre><code class="language-rpg">Inventory.item(1).id = 1;
Inventory.item(1).name = 'Widget';
Inventory.item(1).quantity = 100;
Inventory.item(1).price = 9.99;

Inventory.item(2).id = 2;
Inventory.item(2).name = 'Gadget';
Inventory.item(2).quantity = 50;
Inventory.item(2).price = 19.99;
</code></pre>
</li>
<li>
<p><strong>Generate XML Data:</strong></p>
<pre><code class="language-rpg">Dcl-S xmlData Char(1000);
Dcl-S xmlLength Int(10);

xmlLength = %Len(xmlData);

Xml-Sax %Handler('MySaxHandler') %Data(xmlData: xmlLength);

Dcl-Proc MySaxHandler;
    Dcl-Pi *N;
        eventType Int(10);
        eventData Pointer;
    End-Pi;

    Select;
        When eventType = XML_START_DOCUMENT;
            xmlData = '&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;';
        When eventType = XML_START_ELEMENT;
            xmlData += '&lt;' + %Str(eventData) + '&gt;';
        When eventType = XML_END_ELEMENT;
            xmlData += '&lt;/' + %Str(eventData) + '&gt;';
        When eventType = XML_CHARACTERS;
            xmlData += %Str(eventData);
    EndSelect;
End-Proc;
</code></pre>
</li>
</ol>
</div><h2>Explanation:</h2>
<div class='content'><ul>
<li><strong>Data Structure Definition:</strong> We define a data structure <code>Item</code> to represent each item and an array <code>Inventory</code> to hold multiple items.</li>
<li><strong>Populate Data Structure:</strong> We populate the <code>Inventory</code> data structure with sample data.</li>
<li><strong>XML-SAX Opcode:</strong> We use the <code>XML-SAX</code> opcode to generate XML data. The <code>MySaxHandler</code> procedure handles the SAX events to construct the XML document.</li>
</ul>
</div><h1>Practical Exercise</h1>
<h2>Exercise: Parse and Generate XML</h2>
<div class='content'><ol>
<li>
<p><strong>Task:</strong> Write an RPG program to parse the following XML data and then generate an XML document from the parsed data.</p>
<pre><code class="language-xml">&lt;library&gt;
    &lt;book&gt;
        &lt;title&gt;The Great Gatsby&lt;/title&gt;
        &lt;author&gt;F. Scott Fitzgerald&lt;/author&gt;
        &lt;year&gt;1925&lt;/year&gt;
    &lt;/book&gt;
    &lt;book&gt;
        &lt;title&gt;1984&lt;/title&gt;
        &lt;author&gt;George Orwell&lt;/author&gt;
        &lt;year&gt;1949&lt;/year&gt;
    &lt;/book&gt;
&lt;/library&gt;
</code></pre>
</li>
<li>
<p><strong>Steps:</strong></p>
<ul>
<li>Define the data structures to represent the XML data.</li>
<li>Parse the XML data into the data structures.</li>
<li>Generate an XML document from the parsed data.</li>
</ul>
</li>
</ol>
</div><h2>Solution:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLURzIEJvb2sgUXVhbGlmaWVkOwogICAgdGl0bGUgIENoYXIoNTApOwogICAgYXV0aG9yIENoYXIoNTApOwogICAgeWVhciAgIEludCgxMCk7CkVuZC1EczsKCkRjbC1EcyBMaWJyYXJ5IFF1YWxpZmllZDsKICAgIGJvb2sgTGlrZURzKEJvb2spIERpbSgxMDApOwpFbmQtRHM7CgpEY2wtUyB4bWxEYXRhIENoYXIoMTAwMCk7CnhtbERhdGEgPSAnPGxpYnJhcnk+CiAgICAgICAgICAgICAgPGJvb2s+CiAgICAgICAgICAgICAgICAgIDx0aXRsZT5UaGUgR3JlYXQgR2F0c2J5PC90aXRsZT4KICAgICAgICAgICAgICAgICAgPGF1dGhvcj5GLiBTY290dCBGaXR6Z2VyYWxkPC9hdXRob3I+CiAgICAgICAgICAgICAgICAgIDx5ZWFyPjE5MjU8L3llYXI+CiAgICAgICAgICAgICAgPC9ib29rPgogICAgICAgICAgICAgIDxib29rPgogICAgICAgICAgICAgICAgICA8dGl0bGU+MTk4NDwvdGl0bGU+CiAgICAgICAgICAgICAgICAgIDxhdXRob3I+R2VvcmdlIE9yd2VsbDwvYXV0aG9yPgogICAgICAgICAgICAgICAgICA8eWVhcj4xOTQ5PC95ZWFyPgogICAgICAgICAgICAgIDwvYm9vaz4KICAgICAgICAgICA8L2xpYnJhcnk+JzsKClhtbC1JbnRvIExpYnJhcnkgJVhtbCh4bWxEYXRhOiAnY2FzZT1hbnknKTsKCkRjbC1TIGkgSW50KDEwKTsKRm9yIGkgPSAxIHRvICVFbGVtKExpYnJhcnkuYm9vayk7CiAgICBJZiBMaWJyYXJ5LmJvb2soaSkudGl0bGUgPD4gJyc7CiAgICAgICAgRHNwbHkgKCdUaXRsZTogJyArIExpYnJhcnkuYm9vayhpKS50aXRsZSk7CiAgICAgICAgRHNwbHkgKCdBdXRob3I6ICcgKyBMaWJyYXJ5LmJvb2soaSkuYXV0aG9yKTsKICAgICAgICBEc3BseSAoJ1llYXI6ICcgKyAlQ2hhcihMaWJyYXJ5LmJvb2soaSkueWVhcikpOwogICAgRW5kSWY7CkVuZEZvcjsKCkRjbC1TIHhtbE91dHB1dCBDaGFyKDEwMDApOwpEY2wtUyB4bWxMZW5ndGggSW50KDEwKTsKCnhtbExlbmd0aCA9ICVMZW4oeG1sT3V0cHV0KTsKClhtbC1TYXggJUhhbmRsZXIoJ015U2F4SGFuZGxlcicpICVEYXRhKHhtbE91dHB1dDogeG1sTGVuZ3RoKTsKCkRjbC1Qcm9jIE15U2F4SGFuZGxlcjsKICAgIERjbC1QaSAqTjsKICAgICAgICBldmVudFR5cGUgSW50KDEwKTsKICAgICAgICBldmVudERhdGEgUG9pbnRlcjsKICAgIEVuZC1QaTsKCiAgICBTZWxlY3Q7CiAgICAgICAgV2hlbiBldmVudFR5cGUgPSBYTUxfU1RBUlRfRE9DVU1FTlQ7CiAgICAgICAgICAgIHhtbE91dHB1dCA9ICc8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJVVEYtOCI/Pic7CiAgICAgICAgV2hlbiBldmVudFR5cGUgPSBYTUxfU1RBUlRfRUxFTUVOVDsKICAgICAgICAgICAgeG1sT3V0cHV0ICs9ICc8JyArICVTdHIoZXZlbnREYXRhKSArICc+JzsKICAgICAgICBXaGVuIGV2ZW50VHlwZSA9IFhNTF9FTkRfRUxFTUVOVDsKICAgICAgICAgICAgeG1sT3V0cHV0ICs9ICc8LycgKyAlU3RyKGV2ZW50RGF0YSkgKyAnPic7CiAgICAgICAgV2hlbiBldmVudFR5cGUgPSBYTUxfQ0hBUkFDVEVSUzsKICAgICAgICAgICAgeG1sT3V0cHV0ICs9ICVTdHIoZXZlbnREYXRhKTsKICAgIEVuZFNlbGVjdDsKRW5kLVByb2M7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-Ds Book Qualified;
    title  Char(50);
    author Char(50);
    year   Int(10);
End-Ds;

Dcl-Ds Library Qualified;
    book LikeDs(Book) Dim(100);
End-Ds;

Dcl-S xmlData Char(1000);
xmlData = '&lt;library&gt;
              &lt;book&gt;
                  &lt;title&gt;The Great Gatsby&lt;/title&gt;
                  &lt;author&gt;F. Scott Fitzgerald&lt;/author&gt;
                  &lt;year&gt;1925&lt;/year&gt;
              &lt;/book&gt;
              &lt;book&gt;
                  &lt;title&gt;1984&lt;/title&gt;
                  &lt;author&gt;George Orwell&lt;/author&gt;
                  &lt;year&gt;1949&lt;/year&gt;
              &lt;/book&gt;
           &lt;/library&gt;';

Xml-Into Library %Xml(xmlData: 'case=any');

Dcl-S i Int(10);
For i = 1 to %Elem(Library.book);
    If Library.book(i).title &lt;&gt; '';
        Dsply ('Title: ' + Library.book(i).title);
        Dsply ('Author: ' + Library.book(i).author);
        Dsply ('Year: ' + %Char(Library.book(i).year));
    EndIf;
EndFor;

Dcl-S xmlOutput Char(1000);
Dcl-S xmlLength Int(10);

xmlLength = %Len(xmlOutput);

Xml-Sax %Handler('MySaxHandler') %Data(xmlOutput: xmlLength);

Dcl-Proc MySaxHandler;
    Dcl-Pi *N;
        eventType Int(10);
        eventData Pointer;
    End-Pi;

    Select;
        When eventType = XML_START_DOCUMENT;
            xmlOutput = '&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;';
        When eventType = XML_START_ELEMENT;
            xmlOutput += '&lt;' + %Str(eventData) + '&gt;';
        When eventType = XML_END_ELEMENT;
            xmlOutput += '&lt;/' + %Str(eventData) + '&gt;';
        When eventType = XML_CHARACTERS;
            xmlOutput += %Str(eventData);
    EndSelect;
End-Proc;</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><strong>Data Structure Definition:</strong> We define data structures <code>Book</code> and <code>Library</code> to represent the XML data.</li>
<li><strong>Parse XML Data:</strong> We use the <code>XML-INTO</code> opcode to parse the XML data into the <code>Library</code> data structure.</li>
<li><strong>Display Parsed Data:</strong> We loop through the <code>Library</code> array and display the parsed data.</li>
<li><strong>Generate XML Data:</strong> We use the <code>XML-SAX</code> opcode to generate XML data from the parsed data.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this module, we learned how to handle XML data in RPG programming. We covered the basics of XML, how to parse XML data using the <code>XML-INTO</code> opcode, and how to generate XML data using the <code>XML-SAX</code> opcode. We also worked through practical examples and exercises to reinforce our understanding. In the next module, we will explore how to interface RPG with other programming languages.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-02-apis-json' title="APIs and JSON">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-04-interfacing-other-languages' title="Interfacing with Other Languages">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
