<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction to CNNs</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pytorch/04-01-introduction-to-cnns" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pytorch/04-01-introduction-to-cnns" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pytorch/04-01-introduction-to-cnns" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=2" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/pytorch/04-01-introduction-to-cnns" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/pytorch/04-01-introduction-to-cnns" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Programming Languages</a>
				 					<a href="/categ/frameworks">Frameworks and Libraries</a>
				 					<a href="/categ/tech-tools">Technical Tools</a>
				 					<a href="/categ/foundations">Theoretical Foundations</a>
				 					<a href="/categ/soft-skills">Social Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-04-saving-loading-models' title="Saving and Loading Models">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Introduction to CNNs</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-02-building-cnn-from-scratch' title="Building a CNN from Scratch">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Convolutional Neural Networks (CNNs) are a class of deep neural networks that have proven highly effective for tasks involving image and video recognition, classification, and segmentation. In this section, we will cover the fundamental concepts of CNNs, their architecture, and how they differ from traditional neural networks.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'></div><h2><ol>
<li>Convolutional Layers</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Convolution Operation</strong>: The core building block of a CNN. It involves a filter (or kernel) sliding over the input data to produce a feature map.</li>
<li><strong>Filters/Kernels</strong>: Small matrices used to detect specific features such as edges, textures, or patterns in the input data.</li>
<li><strong>Stride</strong>: The number of pixels by which the filter moves over the input matrix.</li>
<li><strong>Padding</strong>: Adding extra pixels around the input matrix to control the spatial dimensions of the output feature map.</li>
</ul>
</div><h2><ol start="2">
<li>Pooling Layers</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Purpose</strong>: To reduce the spatial dimensions of the feature maps, thereby decreasing the computational load and controlling overfitting.</li>
<li><strong>Types</strong>:
<ul>
<li><strong>Max Pooling</strong>: Takes the maximum value from a patch of the feature map.</li>
<li><strong>Average Pooling</strong>: Takes the average value from a patch of the feature map.</li>
</ul>
</li>
</ul>
</div><h2><ol start="3">
<li>Fully Connected Layers</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Role</strong>: To combine the features extracted by convolutional and pooling layers and make final predictions.</li>
<li><strong>Structure</strong>: Similar to traditional neural networks, where each neuron is connected to every neuron in the previous layer.</li>
</ul>
</div><h2><ol start="4">
<li>Activation Functions</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Commonly Used</strong>: ReLU (Rectified Linear Unit) is the most commonly used activation function in CNNs due to its ability to introduce non-linearity and improve training speed.</li>
</ul>
</div><h1><p>CNN Architecture</p>
</h1>
<div class='content'><p>A typical CNN architecture consists of a series of convolutional and pooling layers followed by one or more fully connected layers. Here is a simple example:</p>
<ol>
<li><strong>Input Layer</strong>: Raw image data (e.g., 32x32x3 for a color image).</li>
<li><strong>Convolutional Layer</strong>: Applies multiple filters to the input image to produce feature maps.</li>
<li><strong>Activation Layer</strong>: Applies an activation function like ReLU to introduce non-linearity.</li>
<li><strong>Pooling Layer</strong>: Reduces the spatial dimensions of the feature maps.</li>
<li><strong>Fully Connected Layer</strong>: Flattens the feature maps and connects to the output layer.</li>
<li><strong>Output Layer</strong>: Produces the final classification or regression output.</li>
</ol>
</div><h1><p>Practical Example</p>
</h1>
<div class='content'><p>Let's implement a simple CNN using PyTorch to classify images from the CIFAR-10 dataset.</p>
</div><h2><p>Step 1: Import Libraries</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubiBhcyBubgppbXBvcnQgdG9yY2gub3B0aW0gYXMgb3B0aW0KaW1wb3J0IHRvcmNodmlzaW9uCmltcG9ydCB0b3JjaHZpc2lvbi50cmFuc2Zvcm1zIGFzIHRyYW5zZm9ybXM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch
import torch.nn as nn
import torch.optim as optim
import torchvision
import torchvision.transforms as transforms</pre></div><div class='content'></div><h2><p>Step 2: Load and Preprocess Data</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEZWZpbmUgdHJhbnNmb3JtYXRpb25zIGZvciB0aGUgdHJhaW5pbmcgYW5kIHRlc3Qgc2V0cwp0cmFuc2Zvcm0gPSB0cmFuc2Zvcm1zLkNvbXBvc2UoWwogICAgdHJhbnNmb3Jtcy5Ub1RlbnNvcigpLAogICAgdHJhbnNmb3Jtcy5Ob3JtYWxpemUoKDAuNSwgMC41LCAwLjUpLCAoMC41LCAwLjUsIDAuNSkpCl0pCgojIExvYWQgdGhlIENJRkFSLTEwIGRhdGFzZXQKdHJhaW5zZXQgPSB0b3JjaHZpc2lvbi5kYXRhc2V0cy5DSUZBUjEwKHJvb3Q9Jy4vZGF0YScsIHRyYWluPVRydWUsIGRvd25sb2FkPVRydWUsIHRyYW5zZm9ybT10cmFuc2Zvcm0pCnRyYWlubG9hZGVyID0gdG9yY2gudXRpbHMuZGF0YS5EYXRhTG9hZGVyKHRyYWluc2V0LCBiYXRjaF9zaXplPTEwMCwgc2h1ZmZsZT1UcnVlLCBudW1fd29ya2Vycz0yKQoKdGVzdHNldCA9IHRvcmNodmlzaW9uLmRhdGFzZXRzLkNJRkFSMTAocm9vdD0nLi9kYXRhJywgdHJhaW49RmFsc2UsIGRvd25sb2FkPVRydWUsIHRyYW5zZm9ybT10cmFuc2Zvcm0pCnRlc3Rsb2FkZXIgPSB0b3JjaC51dGlscy5kYXRhLkRhdGFMb2FkZXIodGVzdHNldCwgYmF0Y2hfc2l6ZT0xMDAsIHNodWZmbGU9RmFsc2UsIG51bV93b3JrZXJzPTIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Define transformations for the training and test sets
transform = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))
])

# Load the CIFAR-10 dataset
trainset = torchvision.datasets.CIFAR10(root='./data', train=True, download=True, transform=transform)
trainloader = torch.utils.data.DataLoader(trainset, batch_size=100, shuffle=True, num_workers=2)

testset = torchvision.datasets.CIFAR10(root='./data', train=False, download=True, transform=transform)
testloader = torch.utils.data.DataLoader(testset, batch_size=100, shuffle=False, num_workers=2)</pre></div><div class='content'></div><h2><p>Step 3: Define the CNN Model</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgU2ltcGxlQ05OKG5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc3VwZXIoU2ltcGxlQ05OLCBzZWxmKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5jb252MSA9IG5uLkNvbnYyZCgzLCA2LCA1KSAgIyAzIGlucHV0IGNoYW5uZWxzLCA2IG91dHB1dCBjaGFubmVscywgNXg1IGtlcm5lbAogICAgICAgIHNlbGYucG9vbCA9IG5uLk1heFBvb2wyZCgyLCAyKSAgICMgMngyIHBvb2xpbmcKICAgICAgICBzZWxmLmNvbnYyID0gbm4uQ29udjJkKDYsIDE2LCA1KSAjIDYgaW5wdXQgY2hhbm5lbHMsIDE2IG91dHB1dCBjaGFubmVscywgNXg1IGtlcm5lbAogICAgICAgIHNlbGYuZmMxID0gbm4uTGluZWFyKDE2ICogNSAqIDUsIDEyMCkgIyBGdWxseSBjb25uZWN0ZWQgbGF5ZXIKICAgICAgICBzZWxmLmZjMiA9IG5uLkxpbmVhcigxMjAsIDg0KQogICAgICAgIHNlbGYuZmMzID0gbm4uTGluZWFyKDg0LCAxMCkgICAgICMgMTAgb3V0cHV0IGNsYXNzZXMgKENJRkFSLTEwKQoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgpOgogICAgICAgIHggPSBzZWxmLnBvb2woRi5yZWx1KHNlbGYuY29udjEoeCkpKQogICAgICAgIHggPSBzZWxmLnBvb2woRi5yZWx1KHNlbGYuY29udjIoeCkpKQogICAgICAgIHggPSB4LnZpZXcoLTEsIDE2ICogNSAqIDUpICAjIEZsYXR0ZW4gdGhlIHRlbnNvcgogICAgICAgIHggPSBGLnJlbHUoc2VsZi5mYzEoeCkpCiAgICAgICAgeCA9IEYucmVsdShzZWxmLmZjMih4KSkKICAgICAgICB4ID0gc2VsZi5mYzMoeCkKICAgICAgICByZXR1cm4geAoKbmV0ID0gU2ltcGxlQ05OKCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class SimpleCNN(nn.Module):
    def __init__(self):
        super(SimpleCNN, self).__init__()
        self.conv1 = nn.Conv2d(3, 6, 5)  # 3 input channels, 6 output channels, 5x5 kernel
        self.pool = nn.MaxPool2d(2, 2)   # 2x2 pooling
        self.conv2 = nn.Conv2d(6, 16, 5) # 6 input channels, 16 output channels, 5x5 kernel
        self.fc1 = nn.Linear(16 * 5 * 5, 120) # Fully connected layer
        self.fc2 = nn.Linear(120, 84)
        self.fc3 = nn.Linear(84, 10)     # 10 output classes (CIFAR-10)

    def forward(self, x):
        x = self.pool(F.relu(self.conv1(x)))
        x = self.pool(F.relu(self.conv2(x)))
        x = x.view(-1, 16 * 5 * 5)  # Flatten the tensor
        x = F.relu(self.fc1(x))
        x = F.relu(self.fc2(x))
        x = self.fc3(x)
        return x

net = SimpleCNN()</pre></div><div class='content'></div><h2><p>Step 4: Define Loss Function and Optimizer</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y3JpdGVyaW9uID0gbm4uQ3Jvc3NFbnRyb3B5TG9zcygpCm9wdGltaXplciA9IG9wdGltLlNHRChuZXQucGFyYW1ldGVycygpLCBscj0wLjAwMSwgbW9tZW50dW09MC45KQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>criterion = nn.CrossEntropyLoss()
optimizer = optim.SGD(net.parameters(), lr=0.001, momentum=0.9)</pre></div><div class='content'></div><h2><p>Step 5: Train the Model</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Zm9yIGVwb2NoIGluIHJhbmdlKDIpOiAgIyBMb29wIG92ZXIgdGhlIGRhdGFzZXQgbXVsdGlwbGUgdGltZXMKICAgIHJ1bm5pbmdfbG9zcyA9IDAuMAogICAgZm9yIGksIGRhdGEgaW4gZW51bWVyYXRlKHRyYWlubG9hZGVyLCAwKToKICAgICAgICBpbnB1dHMsIGxhYmVscyA9IGRhdGEKCiAgICAgICAgb3B0aW1pemVyLnplcm9fZ3JhZCgpICAjIFplcm8gdGhlIHBhcmFtZXRlciBncmFkaWVudHMKCiAgICAgICAgb3V0cHV0cyA9IG5ldChpbnB1dHMpICAjIEZvcndhcmQgcGFzcwogICAgICAgIGxvc3MgPSBjcml0ZXJpb24ob3V0cHV0cywgbGFiZWxzKSAgIyBDb21wdXRlIGxvc3MKICAgICAgICBsb3NzLmJhY2t3YXJkKCkgICMgQmFja3dhcmQgcGFzcwogICAgICAgIG9wdGltaXplci5zdGVwKCkgICMgT3B0aW1pemUgdGhlIHdlaWdodHMKCiAgICAgICAgcnVubmluZ19sb3NzICs9IGxvc3MuaXRlbSgpCiAgICAgICAgaWYgaSAlIDEwMCA9PSA5OTogICMgUHJpbnQgZXZlcnkgMTAwIG1pbmktYmF0Y2hlcwogICAgICAgICAgICBwcmludChmJ1tFcG9jaCB7ZXBvY2ggKyAxfSwgQmF0Y2gge2kgKyAxfV0gbG9zczoge3J1bm5pbmdfbG9zcyAvIDEwMDouM2Z9JykKICAgICAgICAgICAgcnVubmluZ19sb3NzID0gMC4wCgpwcmludCgnRmluaXNoZWQgVHJhaW5pbmcnKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>for epoch in range(2):  # Loop over the dataset multiple times
    running_loss = 0.0
    for i, data in enumerate(trainloader, 0):
        inputs, labels = data

        optimizer.zero_grad()  # Zero the parameter gradients

        outputs = net(inputs)  # Forward pass
        loss = criterion(outputs, labels)  # Compute loss
        loss.backward()  # Backward pass
        optimizer.step()  # Optimize the weights

        running_loss += loss.item()
        if i % 100 == 99:  # Print every 100 mini-batches
            print(f'[Epoch {epoch + 1}, Batch {i + 1}] loss: {running_loss / 100:.3f}')
            running_loss = 0.0

print('Finished Training')</pre></div><div class='content'></div><h2><p>Step 6: Test the Model</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29ycmVjdCA9IDAKdG90YWwgPSAwCndpdGggdG9yY2gubm9fZ3JhZCgpOgogICAgZm9yIGRhdGEgaW4gdGVzdGxvYWRlcjoKICAgICAgICBpbWFnZXMsIGxhYmVscyA9IGRhdGEKICAgICAgICBvdXRwdXRzID0gbmV0KGltYWdlcykKICAgICAgICBfLCBwcmVkaWN0ZWQgPSB0b3JjaC5tYXgob3V0cHV0cy5kYXRhLCAxKQogICAgICAgIHRvdGFsICs9IGxhYmVscy5zaXplKDApCiAgICAgICAgY29ycmVjdCArPSAocHJlZGljdGVkID09IGxhYmVscykuc3VtKCkuaXRlbSgpCgpwcmludChmJ0FjY3VyYWN5IG9mIHRoZSBuZXR3b3JrIG9uIHRoZSAxMDAwMCB0ZXN0IGltYWdlczogezEwMCAqIGNvcnJlY3QgLyB0b3RhbDouMmZ9JScp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>correct = 0
total = 0
with torch.no_grad():
    for data in testloader:
        images, labels = data
        outputs = net(images)
        _, predicted = torch.max(outputs.data, 1)
        total += labels.size(0)
        correct += (predicted == labels).sum().item()

print(f'Accuracy of the network on the 10000 test images: {100 * correct / total:.2f}%')</pre></div><div class='content'></div><h1><p>Summary</p>
</h1>
<div class='content'><p>In this section, we introduced the fundamental concepts of Convolutional Neural Networks (CNNs), including convolutional layers, pooling layers, and fully connected layers. We also implemented a simple CNN using PyTorch to classify images from the CIFAR-10 dataset. This example provided a hands-on understanding of how CNNs work and how to build and train them using PyTorch.</p>
<p>In the next section, we will delve deeper into building a CNN from scratch, exploring more complex architectures and techniques to improve performance.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-04-saving-loading-models' title="Saving and Loading Models">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-02-building-cnn-from-scratch' title="Building a CNN from Scratch">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
