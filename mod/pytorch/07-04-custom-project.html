<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Project</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pytorch/07-04-custom-project" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pytorch/07-04-custom-project" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pytorch/07-04-custom-project" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/pytorch/07-04-custom-project" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/pytorch/07-04-custom-project" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-03-time-series-forecasting-project' title="Time Series Forecasting Project">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Custom Project</h2></a>
			</div>
	<div class='col-2 text-end'>
			</div>
</div>
<div class='content'><p>In this final module, you will apply everything you've learned throughout the course to create a custom project of your choice. This project will help you solidify your understanding of PyTorch and demonstrate your ability to build and train neural networks for real-world applications.</p>
</div><h1>Project Planning</h1>
<div class='content'></div><h2>1. Define the Problem</h2>
<div class='content'><ul>
<li><strong>Objective</strong>: Clearly state the problem you want to solve.</li>
<li><strong>Data</strong>: Identify the dataset you will use. Ensure it is relevant to your problem.</li>
<li><strong>Outcome</strong>: Define what success looks like for your project. What metrics will you use to evaluate your model?</li>
</ul>
</div><h2>2. Data Collection and Preprocessing</h2>
<div class='content'><ul>
<li><strong>Data Sources</strong>: List the sources from where you will collect your data.</li>
<li><strong>Data Cleaning</strong>: Describe the steps you will take to clean and preprocess the data.</li>
<li><strong>Data Augmentation</strong>: If applicable, explain how you will augment your data to improve model performance.</li>
</ul>
</div><h2>3. Model Selection</h2>
<div class='content'><ul>
<li><strong>Model Type</strong>: Choose the type of neural network that best suits your problem (e.g., CNN, RNN, GAN).</li>
<li><strong>Architecture</strong>: Outline the architecture of your model, including the number of layers, types of layers, and activation functions.</li>
</ul>
</div><h2>4. Training and Evaluation</h2>
<div class='content'><ul>
<li><strong>Training Loop</strong>: Describe the training loop, including the loss function and optimizer you will use.</li>
<li><strong>Validation</strong>: Explain how you will validate your model during training.</li>
<li><strong>Testing</strong>: Describe how you will test your model and the metrics you will use to evaluate its performance.</li>
</ul>
</div><h2>5. Deployment</h2>
<div class='content'><ul>
<li><strong>Deployment Strategy</strong>: If applicable, describe how you will deploy your model for real-world use.</li>
<li><strong>Tools and Platforms</strong>: List the tools and platforms you will use for deployment (e.g., Flask, AWS, Heroku).</li>
</ul>
</div><h1>Example Project: Image Classification</h1>
<div class='content'></div><h2>1. Define the Problem</h2>
<div class='content'><ul>
<li><strong>Objective</strong>: Classify images of handwritten digits (0-9) from the MNIST dataset.</li>
<li><strong>Data</strong>: Use the MNIST dataset, which contains 60,000 training images and 10,000 test images.</li>
<li><strong>Outcome</strong>: Achieve an accuracy of at least 98% on the test set.</li>
</ul>
</div><h2>2. Data Collection and Preprocessing</h2>
<div class='content'><ul>
<li><strong>Data Sources</strong>: The MNIST dataset is available through PyTorch's <code>torchvision</code> library.</li>
<li><strong>Data Cleaning</strong>: Normalize the pixel values to be between 0 and 1.</li>
<li><strong>Data Augmentation</strong>: Apply random rotations and shifts to the training images.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaHZpc2lvbgppbXBvcnQgdG9yY2h2aXNpb24udHJhbnNmb3JtcyBhcyB0cmFuc2Zvcm1zCgojIERlZmluZSB0cmFuc2Zvcm1hdGlvbnMKdHJhbnNmb3JtID0gdHJhbnNmb3Jtcy5Db21wb3NlKFsKICAgIHRyYW5zZm9ybXMuVG9UZW5zb3IoKSwKICAgIHRyYW5zZm9ybXMuTm9ybWFsaXplKCgwLjUsKSwgKDAuNSwpKSwKICAgIHRyYW5zZm9ybXMuUmFuZG9tUm90YXRpb24oMTApLAogICAgdHJhbnNmb3Jtcy5SYW5kb21BZmZpbmUoMCwgdHJhbnNsYXRlPSgwLjEsIDAuMSkpCl0pCgojIExvYWQgdGhlIGRhdGFzZXQKdHJhaW5zZXQgPSB0b3JjaHZpc2lvbi5kYXRhc2V0cy5NTklTVChyb290PScuL2RhdGEnLCB0cmFpbj1UcnVlLCBkb3dubG9hZD1UcnVlLCB0cmFuc2Zvcm09dHJhbnNmb3JtKQp0cmFpbmxvYWRlciA9IHRvcmNoLnV0aWxzLmRhdGEuRGF0YUxvYWRlcih0cmFpbnNldCwgYmF0Y2hfc2l6ZT02NCwgc2h1ZmZsZT1UcnVlKQoKdGVzdHNldCA9IHRvcmNodmlzaW9uLmRhdGFzZXRzLk1OSVNUKHJvb3Q9Jy4vZGF0YScsIHRyYWluPUZhbHNlLCBkb3dubG9hZD1UcnVlLCB0cmFuc2Zvcm09dHJhbnNmb3JtKQp0ZXN0bG9hZGVyID0gdG9yY2gudXRpbHMuZGF0YS5EYXRhTG9hZGVyKHRlc3RzZXQsIGJhdGNoX3NpemU9NjQsIHNodWZmbGU9RmFsc2Up"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch
import torchvision
import torchvision.transforms as transforms

# Define transformations
transform = transforms.Compose([
    transforms.ToTensor(),
    transforms.Normalize((0.5,), (0.5,)),
    transforms.RandomRotation(10),
    transforms.RandomAffine(0, translate=(0.1, 0.1))
])

# Load the dataset
trainset = torchvision.datasets.MNIST(root='./data', train=True, download=True, transform=transform)
trainloader = torch.utils.data.DataLoader(trainset, batch_size=64, shuffle=True)

testset = torchvision.datasets.MNIST(root='./data', train=False, download=True, transform=transform)
testloader = torch.utils.data.DataLoader(testset, batch_size=64, shuffle=False)</pre></div><div class='content'></div><h2>3. Model Selection</h2>
<div class='content'><ul>
<li><strong>Model Type</strong>: Convolutional Neural Network (CNN)</li>
<li><strong>Architecture</strong>: Two convolutional layers followed by two fully connected layers.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoLm5uIGFzIG5uCmltcG9ydCB0b3JjaC5ubi5mdW5jdGlvbmFsIGFzIEYKCmNsYXNzIE5ldChubi5Nb2R1bGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHN1cGVyKE5ldCwgc2VsZikuX19pbml0X18oKQogICAgICAgIHNlbGYuY29udjEgPSBubi5Db252MmQoMSwgMzIsIDMsIDEpCiAgICAgICAgc2VsZi5jb252MiA9IG5uLkNvbnYyZCgzMiwgNjQsIDMsIDEpCiAgICAgICAgc2VsZi5mYzEgPSBubi5MaW5lYXIoMTIqMTIqNjQsIDEyOCkKICAgICAgICBzZWxmLmZjMiA9IG5uLkxpbmVhcigxMjgsIDEwKQoKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgpOgogICAgICAgIHggPSBGLnJlbHUoc2VsZi5jb252MSh4KSkKICAgICAgICB4ID0gRi5tYXhfcG9vbDJkKHgsIDIsIDIpCiAgICAgICAgeCA9IEYucmVsdShzZWxmLmNvbnYyKHgpKQogICAgICAgIHggPSBGLm1heF9wb29sMmQoeCwgMiwgMikKICAgICAgICB4ID0geC52aWV3KC0xLCAxMioxMio2NCkKICAgICAgICB4ID0gRi5yZWx1KHNlbGYuZmMxKHgpKQogICAgICAgIHggPSBzZWxmLmZjMih4KQogICAgICAgIHJldHVybiBGLmxvZ19zb2Z0bWF4KHgsIGRpbT0xKQoKbmV0ID0gTmV0KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch.nn as nn
import torch.nn.functional as F

class Net(nn.Module):
    def __init__(self):
        super(Net, self).__init__()
        self.conv1 = nn.Conv2d(1, 32, 3, 1)
        self.conv2 = nn.Conv2d(32, 64, 3, 1)
        self.fc1 = nn.Linear(12*12*64, 128)
        self.fc2 = nn.Linear(128, 10)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        x = F.max_pool2d(x, 2, 2)
        x = F.relu(self.conv2(x))
        x = F.max_pool2d(x, 2, 2)
        x = x.view(-1, 12*12*64)
        x = F.relu(self.fc1(x))
        x = self.fc2(x)
        return F.log_softmax(x, dim=1)

net = Net()</pre></div><div class='content'></div><h2>4. Training and Evaluation</h2>
<div class='content'><ul>
<li><strong>Training Loop</strong>: Use Cross-Entropy Loss and Adam optimizer.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoLm9wdGltIGFzIG9wdGltCgpjcml0ZXJpb24gPSBubi5Dcm9zc0VudHJvcHlMb3NzKCkKb3B0aW1pemVyID0gb3B0aW0uQWRhbShuZXQucGFyYW1ldGVycygpLCBscj0wLjAwMSkKCiMgVHJhaW5pbmcgbG9vcApmb3IgZXBvY2ggaW4gcmFuZ2UoMTApOgogICAgcnVubmluZ19sb3NzID0gMC4wCiAgICBmb3IgaSwgZGF0YSBpbiBlbnVtZXJhdGUodHJhaW5sb2FkZXIsIDApOgogICAgICAgIGlucHV0cywgbGFiZWxzID0gZGF0YQogICAgICAgIG9wdGltaXplci56ZXJvX2dyYWQoKQogICAgICAgIG91dHB1dHMgPSBuZXQoaW5wdXRzKQogICAgICAgIGxvc3MgPSBjcml0ZXJpb24ob3V0cHV0cywgbGFiZWxzKQogICAgICAgIGxvc3MuYmFja3dhcmQoKQogICAgICAgIG9wdGltaXplci5zdGVwKCkKICAgICAgICBydW5uaW5nX2xvc3MgKz0gbG9zcy5pdGVtKCkKICAgICAgICBpZiBpICUgMTAwID09IDk5OgogICAgICAgICAgICBwcmludChmJ1tFcG9jaCB7ZXBvY2ggKyAxfSwgQmF0Y2gge2kgKyAxfV0gbG9zczoge3J1bm5pbmdfbG9zcyAvIDEwMDouM2Z9JykKICAgICAgICAgICAgcnVubmluZ19sb3NzID0gMC4wCgpwcmludCgnRmluaXNoZWQgVHJhaW5pbmcnKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch.optim as optim

criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(net.parameters(), lr=0.001)

# Training loop
for epoch in range(10):
    running_loss = 0.0
    for i, data in enumerate(trainloader, 0):
        inputs, labels = data
        optimizer.zero_grad()
        outputs = net(inputs)
        loss = criterion(outputs, labels)
        loss.backward()
        optimizer.step()
        running_loss += loss.item()
        if i % 100 == 99:
            print(f'[Epoch {epoch + 1}, Batch {i + 1}] loss: {running_loss / 100:.3f}')
            running_loss = 0.0

print('Finished Training')</pre></div><div class='content'><ul>
<li><strong>Validation and Testing</strong>: Evaluate the model on the test set.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29ycmVjdCA9IDAKdG90YWwgPSAwCndpdGggdG9yY2gubm9fZ3JhZCgpOgogICAgZm9yIGRhdGEgaW4gdGVzdGxvYWRlcjoKICAgICAgICBpbWFnZXMsIGxhYmVscyA9IGRhdGEKICAgICAgICBvdXRwdXRzID0gbmV0KGltYWdlcykKICAgICAgICBfLCBwcmVkaWN0ZWQgPSB0b3JjaC5tYXgob3V0cHV0cy5kYXRhLCAxKQogICAgICAgIHRvdGFsICs9IGxhYmVscy5zaXplKDApCiAgICAgICAgY29ycmVjdCArPSAocHJlZGljdGVkID09IGxhYmVscykuc3VtKCkuaXRlbSgpCgpwcmludChmJ0FjY3VyYWN5IG9mIHRoZSBuZXR3b3JrIG9uIHRoZSAxMDAwMCB0ZXN0IGltYWdlczogezEwMCAqIGNvcnJlY3QgLyB0b3RhbDouMmZ9JScp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>correct = 0
total = 0
with torch.no_grad():
    for data in testloader:
        images, labels = data
        outputs = net(images)
        _, predicted = torch.max(outputs.data, 1)
        total += labels.size(0)
        correct += (predicted == labels).sum().item()

print(f'Accuracy of the network on the 10000 test images: {100 * correct / total:.2f}%')</pre></div><div class='content'></div><h2>5. Deployment</h2>
<div class='content'><ul>
<li><strong>Deployment Strategy</strong>: Deploy the model as a web service using Flask.</li>
<li><strong>Tools and Platforms</strong>: Use Flask for the web service and deploy on Heroku.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QsIGpzb25pZnkKaW1wb3J0IHRvcmNoCgphcHAgPSBGbGFzayhfX25hbWVfXykKCkBhcHAucm91dGUoJy9wcmVkaWN0JywgbWV0aG9kcz1bJ1BPU1QnXSkKZGVmIHByZWRpY3QoKToKICAgIGRhdGEgPSByZXF1ZXN0LmdldF9qc29uKGZvcmNlPVRydWUpCiAgICBpbWFnZSA9IHRvcmNoLnRlbnNvcihkYXRhWydpbWFnZSddKS5mbG9hdCgpLnVuc3F1ZWV6ZSgwKS51bnNxdWVlemUoMCkKICAgIG91dHB1dCA9IG5ldChpbWFnZSkKICAgIF8sIHByZWRpY3RlZCA9IHRvcmNoLm1heChvdXRwdXQuZGF0YSwgMSkKICAgIHJldHVybiBqc29uaWZ5KHsncHJlZGljdGlvbic6IHByZWRpY3RlZC5pdGVtKCl9KQoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIGFwcC5ydW4oZGVidWc9VHJ1ZSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, request, jsonify
import torch

app = Flask(__name__)

@app.route('/predict', methods=['POST'])
def predict():
    data = request.get_json(force=True)
    image = torch.tensor(data['image']).float().unsqueeze(0).unsqueeze(0)
    output = net(image)
    _, predicted = torch.max(output.data, 1)
    return jsonify({'prediction': predicted.item()})

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Congratulations! You have successfully completed the custom project module. By now, you should have a solid understanding of how to apply PyTorch to solve real-world problems. This project has allowed you to practice data preprocessing, model building, training, evaluation, and deployment. Keep experimenting with different datasets and models to further enhance your skills. Happy coding!</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-03-time-series-forecasting-project' title="Time Series Forecasting Project">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
