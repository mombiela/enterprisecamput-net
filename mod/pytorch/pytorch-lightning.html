<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PyTorch Lightning</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pytorch/pytorch-lightning" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pytorch/pytorch-lightning" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pytorch/pytorch-lightning" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/pytorch/pytorch-lightning" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/pytorch/pytorch-lightning" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='extending-autograd'>&#x25C4;Extending Autograd</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">PyTorch Lightning</a>
	</div>
	<div class='col-4 text-end'>
					<a href='torchvision'>TorchVision &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to PyTorch Lightning</h1>
<div class='content'><p>PyTorch Lightning is a lightweight PyTorch wrapper for high-performance AI research. It helps to organize PyTorch code, making it more readable and scalable while reducing boilerplate code.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>LightningModule</strong>: A subclass of <code>torch.nn.Module</code> that organizes your PyTorch code into specific sections.</li>
<li><strong>Trainer</strong>: A class that handles the training loop, validation, and testing.</li>
<li><strong>DataModule</strong>: A class that encapsulates all data-related operations, such as loading, preprocessing, and splitting datasets.</li>
</ul>
</div><h1>Setting Up PyTorch Lightning</h1>
<div class='content'><p>To get started with PyTorch Lightning, you need to install it. You can do this using pip:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgcHl0b3JjaC1saWdodG5pbmc="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install pytorch-lightning</pre></div><div class='content'></div><h1>LightningModule</h1>
<div class='content'><p>The <code>LightningModule</code> is the core component where you define your model, training, validation, and testing steps.</p>
</div><h2>Example: Creating a Simple LightningModule</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHB5dG9yY2hfbGlnaHRuaW5nIGFzIHBsCmltcG9ydCB0b3JjaApmcm9tIHRvcmNoIGltcG9ydCBubgpmcm9tIHRvcmNoLm9wdGltIGltcG9ydCBBZGFtCgpjbGFzcyBTaW1wbGVNb2RlbChwbC5MaWdodG5pbmdNb2R1bGUpOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHN1cGVyKFNpbXBsZU1vZGVsLCBzZWxmKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5sYXllciA9IG5uLkxpbmVhcigyOCAqIDI4LCAxMCkKCiAgICBkZWYgZm9yd2FyZChzZWxmLCB4KToKICAgICAgICByZXR1cm4gc2VsZi5sYXllcih4LnZpZXcoeC5zaXplKDApLCAtMSkpCgogICAgZGVmIHRyYWluaW5nX3N0ZXAoc2VsZiwgYmF0Y2gsIGJhdGNoX2lkeCk6CiAgICAgICAgeCwgeSA9IGJhdGNoCiAgICAgICAgbG9naXRzID0gc2VsZi5mb3J3YXJkKHgpCiAgICAgICAgbG9zcyA9IG5uLmZ1bmN0aW9uYWwuY3Jvc3NfZW50cm9weShsb2dpdHMsIHkpCiAgICAgICAgcmV0dXJuIGxvc3MKCiAgICBkZWYgY29uZmlndXJlX29wdGltaXplcnMoc2VsZik6CiAgICAgICAgcmV0dXJuIEFkYW0oc2VsZi5wYXJhbWV0ZXJzKCksIGxyPTFlLTMp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import pytorch_lightning as pl
import torch
from torch import nn
from torch.optim import Adam

class SimpleModel(pl.LightningModule):
    def __init__(self):
        super(SimpleModel, self).__init__()
        self.layer = nn.Linear(28 * 28, 10)

    def forward(self, x):
        return self.layer(x.view(x.size(0), -1))

    def training_step(self, batch, batch_idx):
        x, y = batch
        logits = self.forward(x)
        loss = nn.functional.cross_entropy(logits, y)
        return loss

    def configure_optimizers(self):
        return Adam(self.parameters(), lr=1e-3)</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong><code>__init__</code></strong>: Initialize the model layers.</li>
<li><strong><code>forward</code></strong>: Define the forward pass.</li>
<li><strong><code>training_step</code></strong>: Define the training loop logic.</li>
<li><strong><code>configure_optimizers</code></strong>: Define the optimizer.</li>
</ul>
</div><h1>Trainer</h1>
<div class='content'><p>The <code>Trainer</code> class automates the training loop, validation, and testing.</p>
</div><h2>Example: Using the Trainer</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXRvcmNoX2xpZ2h0bmluZyBpbXBvcnQgVHJhaW5lcgpmcm9tIHRvcmNoLnV0aWxzLmRhdGEgaW1wb3J0IERhdGFMb2FkZXIsIHJhbmRvbV9zcGxpdApmcm9tIHRvcmNodmlzaW9uLmRhdGFzZXRzIGltcG9ydCBNTklTVApmcm9tIHRvcmNodmlzaW9uLnRyYW5zZm9ybXMgaW1wb3J0IFRvVGVuc29yCgojIExvYWQgZGF0YQpkYXRhc2V0ID0gTU5JU1QoJycsIHRyYWluPVRydWUsIGRvd25sb2FkPVRydWUsIHRyYW5zZm9ybT1Ub1RlbnNvcigpKQp0cmFpbiwgdmFsID0gcmFuZG9tX3NwbGl0KGRhdGFzZXQsIFs1NTAwMCwgNTAwMF0pCnRyYWluX2xvYWRlciA9IERhdGFMb2FkZXIodHJhaW4sIGJhdGNoX3NpemU9MzIpCnZhbF9sb2FkZXIgPSBEYXRhTG9hZGVyKHZhbCwgYmF0Y2hfc2l6ZT0zMikKCiMgSW5pdGlhbGl6ZSBtb2RlbAptb2RlbCA9IFNpbXBsZU1vZGVsKCkKCiMgSW5pdGlhbGl6ZSB0cmFpbmVyCnRyYWluZXIgPSBUcmFpbmVyKG1heF9lcG9jaHM9NSkKCiMgVHJhaW4gdGhlIG1vZGVsCnRyYWluZXIuZml0KG1vZGVsLCB0cmFpbl9sb2FkZXIsIHZhbF9sb2FkZXIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pytorch_lightning import Trainer
from torch.utils.data import DataLoader, random_split
from torchvision.datasets import MNIST
from torchvision.transforms import ToTensor

# Load data
dataset = MNIST('', train=True, download=True, transform=ToTensor())
train, val = random_split(dataset, [55000, 5000])
train_loader = DataLoader(train, batch_size=32)
val_loader = DataLoader(val, batch_size=32)

# Initialize model
model = SimpleModel()

# Initialize trainer
trainer = Trainer(max_epochs=5)

# Train the model
trainer.fit(model, train_loader, val_loader)</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>DataLoader</strong>: Used to load and preprocess the dataset.</li>
<li><strong>Trainer</strong>: Handles the training process.</li>
<li><strong><code>trainer.fit</code></strong>: Trains the model using the provided data loaders.</li>
</ul>
</div><h1>DataModule</h1>
<div class='content'><p>The <code>DataModule</code> class encapsulates all data-related operations, making it easier to manage data loading and preprocessing.</p>
</div><h2>Example: Creating a DataModule</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXRvcmNoX2xpZ2h0bmluZyBpbXBvcnQgTGlnaHRuaW5nRGF0YU1vZHVsZQpmcm9tIHRvcmNodmlzaW9uLmRhdGFzZXRzIGltcG9ydCBNTklTVApmcm9tIHRvcmNodmlzaW9uLnRyYW5zZm9ybXMgaW1wb3J0IFRvVGVuc29yCmZyb20gdG9yY2gudXRpbHMuZGF0YSBpbXBvcnQgRGF0YUxvYWRlciwgcmFuZG9tX3NwbGl0CgpjbGFzcyBNTklTVERhdGFNb2R1bGUoTGlnaHRuaW5nRGF0YU1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgYmF0Y2hfc2l6ZT0zMik6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi5iYXRjaF9zaXplID0gYmF0Y2hfc2l6ZQoKICAgIGRlZiBwcmVwYXJlX2RhdGEoc2VsZik6CiAgICAgICAgTU5JU1QoJycsIHRyYWluPVRydWUsIGRvd25sb2FkPVRydWUpCgogICAgZGVmIHNldHVwKHNlbGYsIHN0YWdlPU5vbmUpOgogICAgICAgIGRhdGFzZXQgPSBNTklTVCgnJywgdHJhaW49VHJ1ZSwgdHJhbnNmb3JtPVRvVGVuc29yKCkpCiAgICAgICAgc2VsZi50cmFpbiwgc2VsZi52YWwgPSByYW5kb21fc3BsaXQoZGF0YXNldCwgWzU1MDAwLCA1MDAwXSkKCiAgICBkZWYgdHJhaW5fZGF0YWxvYWRlcihzZWxmKToKICAgICAgICByZXR1cm4gRGF0YUxvYWRlcihzZWxmLnRyYWluLCBiYXRjaF9zaXplPXNlbGYuYmF0Y2hfc2l6ZSkKCiAgICBkZWYgdmFsX2RhdGFsb2FkZXIoc2VsZik6CiAgICAgICAgcmV0dXJuIERhdGFMb2FkZXIoc2VsZi52YWwsIGJhdGNoX3NpemU9c2VsZi5iYXRjaF9zaXplKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pytorch_lightning import LightningDataModule
from torchvision.datasets import MNIST
from torchvision.transforms import ToTensor
from torch.utils.data import DataLoader, random_split

class MNISTDataModule(LightningDataModule):
    def __init__(self, batch_size=32):
        super().__init__()
        self.batch_size = batch_size

    def prepare_data(self):
        MNIST('', train=True, download=True)

    def setup(self, stage=None):
        dataset = MNIST('', train=True, transform=ToTensor())
        self.train, self.val = random_split(dataset, [55000, 5000])

    def train_dataloader(self):
        return DataLoader(self.train, batch_size=self.batch_size)

    def val_dataloader(self):
        return DataLoader(self.val, batch_size=self.batch_size)</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong><code>prepare_data</code></strong>: Download or prepare data.</li>
<li><strong><code>setup</code></strong>: Split the dataset into training and validation sets.</li>
<li><strong><code>train_dataloader</code></strong>: Return the training data loader.</li>
<li><strong><code>val_dataloader</code></strong>: Return the validation data loader.</li>
</ul>
</div><h1>Advanced Features</h1>
<div class='content'><p>PyTorch Lightning also provides advanced features such as:</p>
<ul>
<li><strong>Callbacks</strong>: Custom hooks that can be used to execute code at specific points during training.</li>
<li><strong>Loggers</strong>: Integrate with logging frameworks like TensorBoard, MLflow, etc.</li>
<li><strong>Distributed Training</strong>: Easily scale your training to multiple GPUs or nodes.</li>
</ul>
</div><h2>Example: Using Callbacks</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXRvcmNoX2xpZ2h0bmluZy5jYWxsYmFja3MgaW1wb3J0IE1vZGVsQ2hlY2twb2ludAoKY2hlY2twb2ludF9jYWxsYmFjayA9IE1vZGVsQ2hlY2twb2ludCgKICAgIG1vbml0b3I9J3ZhbF9sb3NzJywKICAgIGRpcnBhdGg9J215L3BhdGgvJywKICAgIGZpbGVuYW1lPSdzYW1wbGUte2Vwb2NoOjAyZH0te3ZhbF9sb3NzOi4yZn0nLAogICAgc2F2ZV90b3Bfaz0zLAogICAgbW9kZT0nbWluJywKKQoKdHJhaW5lciA9IFRyYWluZXIoY2FsbGJhY2tzPVtjaGVja3BvaW50X2NhbGxiYWNrXSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pytorch_lightning.callbacks import ModelCheckpoint

checkpoint_callback = ModelCheckpoint(
    monitor='val_loss',
    dirpath='my/path/',
    filename='sample-{epoch:02d}-{val_loss:.2f}',
    save_top_k=3,
    mode='min',
)

trainer = Trainer(callbacks=[checkpoint_callback])</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>ModelCheckpoint</strong>: Save the model checkpoints based on validation loss.</li>
<li><strong><code>callbacks</code></strong>: Pass the callback to the Trainer.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>PyTorch Lightning simplifies the process of building and training PyTorch models by organizing code into reusable components. It reduces boilerplate code and provides advanced features like callbacks, loggers, and distributed training, making it a powerful tool for both beginners and advanced users.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='extending-autograd'>&#x25C4;Extending Autograd</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">PyTorch Lightning</a>
	</div>
	<div class='col-4 text-end'>
					<a href='torchvision'>TorchVision &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
