<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creating a Simple Neural Network</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pytorch/creating-a-simple-neural-network" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pytorch/creating-a-simple-neural-network" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pytorch/creating-a-simple-neural-network" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/pytorch/creating-a-simple-neural-network" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/pytorch/creating-a-simple-neural-network" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-neural-networks'>&#x25C4;Introduction to Neural Networks</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Creating a Simple Neural Network</a>
	</div>
	<div class='col-4 text-end'>
					<a href='activation-functions'>Activation Functions &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will learn how to create a simple neural network using PyTorch. This will include setting up the environment, understanding the basic building blocks of neural networks, and implementing a simple neural network from scratch.</p>
</div><h1>Setting Up the Environment</h1>
<div class='content'><p>Before we start coding, we need to set up our environment to use PyTorch.</p>
<ol>
<li>
<p><strong>Install PyTorch</strong>: Follow the instructions on the <a href="https://pytorch.org/get-started/locally/">official PyTorch website</a> to install PyTorch.</p>
</li>
<li>
<p><strong>Verify Installation</strong>: Open a Python interpreter and run the following commands to ensure PyTorch is installed correctly:</p>
<pre><code class="language-python">import torch
print(torch.__version__)
</code></pre>
</li>
</ol>
</div><h1>Understanding the Basic Building Blocks</h1>
<div class='content'><p>Before diving into the code, let's understand the basic components of a neural network in PyTorch.</p>
<ul>
<li><strong>Tensors</strong>: The fundamental building block in PyTorch, similar to NumPy arrays but with GPU support.</li>
<li><strong>Autograd</strong>: PyTorch's automatic differentiation library that helps in computing gradients.</li>
<li><strong>Neural Network Module (<code>torch.nn</code>)</strong>: Contains classes and functions to build neural networks.</li>
<li><strong>Optimizers (<code>torch.optim</code>)</strong>: Used to update the weights of the network based on the computed gradients.</li>
<li><strong>Loss Functions</strong>: Measure how well the neural network is performing.</li>
</ul>
</div><h1>Implementing a Simple Neural Network</h1>
<div class='content'><p>Let's implement a simple neural network to classify handwritten digits from the MNIST dataset.</p>
</div><h2>Step 1: Import Libraries</h2>
<div class='content'><p>First, import the necessary libraries.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubiBhcyBubgppbXBvcnQgdG9yY2gub3B0aW0gYXMgb3B0aW0KaW1wb3J0IHRvcmNodmlzaW9uCmltcG9ydCB0b3JjaHZpc2lvbi50cmFuc2Zvcm1zIGFzIHRyYW5zZm9ybXM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch
import torch.nn as nn
import torch.optim as optim
import torchvision
import torchvision.transforms as transforms</pre></div><div class='content'></div><h2>Step 2: Load and Preprocess the Data</h2>
<div class='content'><p>Load the MNIST dataset and apply necessary transformations.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJhbnNmb3JtID0gdHJhbnNmb3Jtcy5Db21wb3NlKFt0cmFuc2Zvcm1zLlRvVGVuc29yKCksIHRyYW5zZm9ybXMuTm9ybWFsaXplKCgwLjUsKSwgKDAuNSwpKV0pCgp0cmFpbnNldCA9IHRvcmNodmlzaW9uLmRhdGFzZXRzLk1OSVNUKHJvb3Q9Jy4vZGF0YScsIHRyYWluPVRydWUsIGRvd25sb2FkPVRydWUsIHRyYW5zZm9ybT10cmFuc2Zvcm0pCnRyYWlubG9hZGVyID0gdG9yY2gudXRpbHMuZGF0YS5EYXRhTG9hZGVyKHRyYWluc2V0LCBiYXRjaF9zaXplPTY0LCBzaHVmZmxlPVRydWUpCgp0ZXN0c2V0ID0gdG9yY2h2aXNpb24uZGF0YXNldHMuTU5JU1Qocm9vdD0nLi9kYXRhJywgdHJhaW49RmFsc2UsIGRvd25sb2FkPVRydWUsIHRyYW5zZm9ybT10cmFuc2Zvcm0pCnRlc3Rsb2FkZXIgPSB0b3JjaC51dGlscy5kYXRhLkRhdGFMb2FkZXIodGVzdHNldCwgYmF0Y2hfc2l6ZT02NCwgc2h1ZmZsZT1GYWxzZSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>transform = transforms.Compose([transforms.ToTensor(), transforms.Normalize((0.5,), (0.5,))])

trainset = torchvision.datasets.MNIST(root='./data', train=True, download=True, transform=transform)
trainloader = torch.utils.data.DataLoader(trainset, batch_size=64, shuffle=True)

testset = torchvision.datasets.MNIST(root='./data', train=False, download=True, transform=transform)
testloader = torch.utils.data.DataLoader(testset, batch_size=64, shuffle=False)</pre></div><div class='content'></div><h2>Step 3: Define the Neural Network</h2>
<div class='content'><p>Define a simple neural network with one hidden layer.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgU2ltcGxlTk4obm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcihTaW1wbGVOTiwgc2VsZikuX19pbml0X18oKQogICAgICAgIHNlbGYuZmMxID0gbm4uTGluZWFyKDI4ICogMjgsIDEyOCkgICMgSW5wdXQgbGF5ZXIgdG8gaGlkZGVuIGxheWVyCiAgICAgICAgc2VsZi5mYzIgPSBubi5MaW5lYXIoMTI4LCAxMCkgICAgICAgIyBIaWRkZW4gbGF5ZXIgdG8gb3V0cHV0IGxheWVyCgogICAgZGVmIGZvcndhcmQoc2VsZiwgeCk6CiAgICAgICAgeCA9IHgudmlldygtMSwgMjggKiAyOCkgICMgRmxhdHRlbiB0aGUgaW5wdXQKICAgICAgICB4ID0gdG9yY2gucmVsdShzZWxmLmZjMSh4KSkKICAgICAgICB4ID0gc2VsZi5mYzIoeCkKICAgICAgICByZXR1cm4geAoKbmV0ID0gU2ltcGxlTk4oKQpwcmludChuZXQp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class SimpleNN(nn.Module):
    def __init__(self):
        super(SimpleNN, self).__init__()
        self.fc1 = nn.Linear(28 * 28, 128)  # Input layer to hidden layer
        self.fc2 = nn.Linear(128, 10)       # Hidden layer to output layer

    def forward(self, x):
        x = x.view(-1, 28 * 28)  # Flatten the input
        x = torch.relu(self.fc1(x))
        x = self.fc2(x)
        return x

net = SimpleNN()
print(net)</pre></div><div class='content'></div><h2>Step 4: Define the Loss Function and Optimizer</h2>
<div class='content'><p>Use Cross-Entropy Loss and Stochastic Gradient Descent (SGD) optimizer.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y3JpdGVyaW9uID0gbm4uQ3Jvc3NFbnRyb3B5TG9zcygpCm9wdGltaXplciA9IG9wdGltLlNHRChuZXQucGFyYW1ldGVycygpLCBscj0wLjAxLCBtb21lbnR1bT0wLjkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>criterion = nn.CrossEntropyLoss()
optimizer = optim.SGD(net.parameters(), lr=0.01, momentum=0.9)</pre></div><div class='content'></div><h2>Step 5: Train the Neural Network</h2>
<div class='content'><p>Train the network for a few epochs.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Zm9yIGVwb2NoIGluIHJhbmdlKDUpOiAgIyBMb29wIG92ZXIgdGhlIGRhdGFzZXQgbXVsdGlwbGUgdGltZXMKICAgIHJ1bm5pbmdfbG9zcyA9IDAuMAogICAgZm9yIGksIGRhdGEgaW4gZW51bWVyYXRlKHRyYWlubG9hZGVyLCAwKToKICAgICAgICBpbnB1dHMsIGxhYmVscyA9IGRhdGEKCiAgICAgICAgb3B0aW1pemVyLnplcm9fZ3JhZCgpICAjIFplcm8gdGhlIHBhcmFtZXRlciBncmFkaWVudHMKCiAgICAgICAgb3V0cHV0cyA9IG5ldChpbnB1dHMpICAjIEZvcndhcmQgcGFzcwogICAgICAgIGxvc3MgPSBjcml0ZXJpb24ob3V0cHV0cywgbGFiZWxzKSAgIyBDb21wdXRlIGxvc3MKICAgICAgICBsb3NzLmJhY2t3YXJkKCkgICMgQmFja3dhcmQgcGFzcwogICAgICAgIG9wdGltaXplci5zdGVwKCkgICMgT3B0aW1pemUgdGhlIHdlaWdodHMKCiAgICAgICAgcnVubmluZ19sb3NzICs9IGxvc3MuaXRlbSgpCiAgICAgICAgaWYgaSAlIDEwMCA9PSA5OTogICMgUHJpbnQgZXZlcnkgMTAwIG1pbmktYmF0Y2hlcwogICAgICAgICAgICBwcmludChmJ1tFcG9jaCB7ZXBvY2ggKyAxfSwgQmF0Y2gge2kgKyAxfV0gbG9zczoge3J1bm5pbmdfbG9zcyAvIDEwMDouM2Z9JykKICAgICAgICAgICAgcnVubmluZ19sb3NzID0gMC4wCgpwcmludCgnRmluaXNoZWQgVHJhaW5pbmcnKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>for epoch in range(5):  # Loop over the dataset multiple times
    running_loss = 0.0
    for i, data in enumerate(trainloader, 0):
        inputs, labels = data

        optimizer.zero_grad()  # Zero the parameter gradients

        outputs = net(inputs)  # Forward pass
        loss = criterion(outputs, labels)  # Compute loss
        loss.backward()  # Backward pass
        optimizer.step()  # Optimize the weights

        running_loss += loss.item()
        if i % 100 == 99:  # Print every 100 mini-batches
            print(f'[Epoch {epoch + 1}, Batch {i + 1}] loss: {running_loss / 100:.3f}')
            running_loss = 0.0

print('Finished Training')</pre></div><div class='content'></div><h2>Step 6: Evaluate the Neural Network</h2>
<div class='content'><p>Evaluate the performance of the trained network on the test dataset.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29ycmVjdCA9IDAKdG90YWwgPSAwCndpdGggdG9yY2gubm9fZ3JhZCgpOgogICAgZm9yIGRhdGEgaW4gdGVzdGxvYWRlcjoKICAgICAgICBpbWFnZXMsIGxhYmVscyA9IGRhdGEKICAgICAgICBvdXRwdXRzID0gbmV0KGltYWdlcykKICAgICAgICBfLCBwcmVkaWN0ZWQgPSB0b3JjaC5tYXgob3V0cHV0cy5kYXRhLCAxKQogICAgICAgIHRvdGFsICs9IGxhYmVscy5zaXplKDApCiAgICAgICAgY29ycmVjdCArPSAocHJlZGljdGVkID09IGxhYmVscykuc3VtKCkuaXRlbSgpCgpwcmludChmJ0FjY3VyYWN5IG9mIHRoZSBuZXR3b3JrIG9uIHRoZSAxMDAwMCB0ZXN0IGltYWdlczogezEwMCAqIGNvcnJlY3QgLyB0b3RhbDouMmZ9JScp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>correct = 0
total = 0
with torch.no_grad():
    for data in testloader:
        images, labels = data
        outputs = net(images)
        _, predicted = torch.max(outputs.data, 1)
        total += labels.size(0)
        correct += (predicted == labels).sum().item()

print(f'Accuracy of the network on the 10000 test images: {100 * correct / total:.2f}%')</pre></div><div class='content'></div><h1>Summary</h1>
<div class='content'><p>In this section, we have covered the basics of creating a simple neural network using PyTorch. We started by setting up the environment, understanding the basic components, and then implemented a simple neural network to classify handwritten digits from the MNIST dataset. We also trained and evaluated the network to measure its performance. This foundational knowledge will be crucial as we move on to more advanced topics in PyTorch.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-neural-networks'>&#x25C4;Introduction to Neural Networks</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Creating a Simple Neural Network</a>
	</div>
	<div class='col-4 text-end'>
					<a href='activation-functions'>Activation Functions &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
