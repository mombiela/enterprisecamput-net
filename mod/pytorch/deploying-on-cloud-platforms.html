<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deploying on Cloud Platforms</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pytorch/deploying-on-cloud-platforms" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pytorch/deploying-on-cloud-platforms" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pytorch/deploying-on-cloud-platforms" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/pytorch/deploying-on-cloud-platforms" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/pytorch/deploying-on-cloud-platforms" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='optimizing-for-inference'>&#x25C4;Optimizing for Inference</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Deploying on Cloud Platforms</a>
	</div>
	<div class='col-4 text-end'>
					<a href='image-classification-project'>Image Classification Project &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Deploying PyTorch models on cloud platforms is a crucial skill for making your machine learning applications accessible and scalable. This section will guide you through the process of deploying PyTorch models on popular cloud platforms, covering both beginner and advanced topics.</p>
</div><h1>Introduction to Cloud Deployment</h1>
<div class='content'><ul>
<li>
<p><strong>What is Cloud Deployment?</strong></p>
<ul>
<li>Cloud deployment involves hosting your application or model on a cloud service provider, making it accessible over the internet.</li>
<li>Benefits include scalability, reliability, and ease of access.</li>
</ul>
</li>
<li>
<p><strong>Popular Cloud Platforms</strong></p>
<ul>
<li>Amazon Web Services (AWS)</li>
<li>Google Cloud Platform (GCP)</li>
<li>Microsoft Azure</li>
</ul>
</li>
</ul>
</div><h1>Setting Up Your Environment</h1>
<div class='content'><p>Before deploying your PyTorch model, you need to set up your environment on the chosen cloud platform.</p>
</div><h2>AWS Setup</h2>
<div class='content'><ul>
<li>
<p><strong>Creating an AWS Account</strong></p>
<ul>
<li>Sign up for an AWS account at <a href="https://aws.amazon.com/">aws.amazon.com</a>.</li>
</ul>
</li>
<li>
<p><strong>Setting Up IAM Roles</strong></p>
<ul>
<li>Create IAM roles to manage permissions securely.</li>
</ul>
</li>
<li>
<p><strong>Launching an EC2 Instance</strong></p>
<ul>
<li>Choose an appropriate instance type (e.g., t2.micro for small applications).</li>
<li>Configure security groups to allow SSH and HTTP/HTTPS access.</li>
</ul>
</li>
</ul>
</div><h2>GCP Setup</h2>
<div class='content'><ul>
<li>
<p><strong>Creating a GCP Account</strong></p>
<ul>
<li>Sign up for a GCP account at <a href="https://cloud.google.com/">cloud.google.com</a>.</li>
</ul>
</li>
<li>
<p><strong>Setting Up IAM Roles</strong></p>
<ul>
<li>Create IAM roles to manage permissions securely.</li>
</ul>
</li>
<li>
<p><strong>Launching a Compute Engine Instance</strong></p>
<ul>
<li>Choose an appropriate machine type (e.g., n1-standard-1 for small applications).</li>
<li>Configure firewall rules to allow SSH and HTTP/HTTPS access.</li>
</ul>
</li>
</ul>
</div><h2>Azure Setup</h2>
<div class='content'><ul>
<li>
<p><strong>Creating an Azure Account</strong></p>
<ul>
<li>Sign up for an Azure account at <a href="https://azure.microsoft.com/">azure.microsoft.com</a>.</li>
</ul>
</li>
<li>
<p><strong>Setting Up IAM Roles</strong></p>
<ul>
<li>Create IAM roles to manage permissions securely.</li>
</ul>
</li>
<li>
<p><strong>Launching a Virtual Machine</strong></p>
<ul>
<li>Choose an appropriate VM size (e.g., B1s for small applications).</li>
<li>Configure network security groups to allow SSH and HTTP/HTTPS access.</li>
</ul>
</li>
</ul>
</div><h1>Deploying a PyTorch Model</h1>
<div class='content'></div><h2>Preparing Your Model</h2>
<div class='content'><ul>
<li>
<p><strong>Saving the Model</strong></p>
<ul>
<li>Save your trained PyTorch model using <code>torch.save()</code>.</li>
</ul>
<pre><code class="language-python">import torch
import torchvision.models as models

model = models.resnet18(pretrained=True)
torch.save(model.state_dict(), 'model.pth')
</code></pre>
</li>
<li>
<p><strong>Loading the Model</strong></p>
<ul>
<li>Load the model in your deployment script.</li>
</ul>
<pre><code class="language-python">model = models.resnet18()
model.load_state_dict(torch.load('model.pth'))
model.eval()
</code></pre>
</li>
</ul>
</div><h2>Creating a Flask API</h2>
<div class='content'><ul>
<li>
<p><strong>Setting Up Flask</strong></p>
<ul>
<li>Install Flask using pip.</li>
</ul>
<pre><code class="language-bash">pip install flask
</code></pre>
</li>
<li>
<p><strong>Creating the API</strong></p>
<ul>
<li>Create a simple Flask API to serve your model.</li>
</ul>
<pre><code class="language-python">from flask import Flask, request, jsonify
import torch
import torchvision.transforms as transforms
from PIL import Image

app = Flask(__name__)

model = models.resnet18()
model.load_state_dict(torch.load('model.pth'))
model.eval()

def transform_image(image_bytes):
    my_transforms = transforms.Compose([transforms.Resize(255),
                                        transforms.CenterCrop(224),
                                        transforms.ToTensor(),
                                        transforms.Normalize(
                                            [0.485, 0.456, 0.406], 
                                            [0.229, 0.224, 0.225])])
    image = Image.open(io.BytesIO(image_bytes))
    return my_transforms(image).unsqueeze(0)

@app.route('/predict', methods=['POST'])
def predict():
    if request.method == 'POST':
        file = request.files['file']
        img_bytes = file.read()
        tensor = transform_image(img_bytes)
        outputs = model(tensor)
        _, y_hat = outputs.max(1)
        return jsonify({'prediction': y_hat.item()})

if __name__ == '__main__':
    app.run()
</code></pre>
</li>
</ul>
</div><h2>Deploying the Flask API</h2>
<div class='content'><h4>AWS</h4>
<ul>
<li>
<p><strong>Using Elastic Beanstalk</strong></p>
<ul>
<li>Package your Flask application.</li>
<li>Deploy using Elastic Beanstalk CLI.</li>
</ul>
<pre><code class="language-bash">eb init -p python-3.7 my-flask-app
eb create my-flask-env
</code></pre>
</li>
</ul>
<h4>GCP</h4>
<ul>
<li>
<p><strong>Using Google App Engine</strong></p>
<ul>
<li>Create an <code>app.yaml</code> file for configuration.</li>
<li>Deploy using the gcloud CLI.</li>
</ul>
<pre><code class="language-yaml">runtime: python37
</code></pre>
<pre><code class="language-bash">gcloud app deploy
</code></pre>
</li>
</ul>
<h4>Azure</h4>
<ul>
<li>
<p><strong>Using Azure App Service</strong></p>
<ul>
<li>Create an App Service plan.</li>
<li>Deploy using the Azure CLI.</li>
</ul>
<pre><code class="language-bash">az webapp up --name my-flask-app --resource-group myResourceGroup --plan myAppServicePlan
</code></pre>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Deploying PyTorch models on cloud platforms involves several steps, from setting up your environment to creating and deploying a Flask API. By following this guide, you should be able to deploy your models on AWS, GCP, or Azure, making them accessible and scalable. This skill is essential for bringing your machine learning applications to production and making them available to users worldwide.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='optimizing-for-inference'>&#x25C4;Optimizing for Inference</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Deploying on Cloud Platforms</a>
	</div>
	<div class='col-4 text-end'>
					<a href='image-classification-project'>Image Classification Project &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
