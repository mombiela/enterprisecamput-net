<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Loading and Preprocessing</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pytorch/data-loading-and-preprocessing" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pytorch/data-loading-and-preprocessing" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pytorch/data-loading-and-preprocessing" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/pytorch/data-loading-and-preprocessing" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/pytorch/data-loading-and-preprocessing" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='loss-functions-and-optimization'>&#x25C4;Loss Functions and Optimization</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Data Loading and Preprocessing</a>
	</div>
	<div class='col-4 text-end'>
					<a href='training-loop-basics'>Training Loop Basics &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Data loading and preprocessing are crucial steps in any machine learning pipeline. In this section, we will cover how to efficiently load and preprocess data using PyTorch. This includes understanding datasets, data loaders, and various preprocessing techniques.</p>
</div><h1>Introduction to Data Loading</h1>
<div class='content'><p>In PyTorch, data loading is handled by the <code>torch.utils.data</code> module. This module provides two main classes:</p>
<ul>
<li><code>Dataset</code>: A class representing a dataset.</li>
<li><code>DataLoader</code>: A class that loads data from a <code>Dataset</code> and provides an iterable over the dataset.</li>
</ul>
</div><h2>Dataset Class</h2>
<div class='content'><p>The <code>Dataset</code> class is an abstract class representing a dataset. To create a custom dataset, you need to subclass <code>Dataset</code> and override the following methods:</p>
<ul>
<li><code>__len__</code>: Returns the size of the dataset.</li>
<li><code>__getitem__</code>: Retrieves a sample from the dataset at the given index.</li>
</ul>
<h4>Example: Custom Dataset</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoCmZyb20gdG9yY2gudXRpbHMuZGF0YSBpbXBvcnQgRGF0YXNldAoKY2xhc3MgQ3VzdG9tRGF0YXNldChEYXRhc2V0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBkYXRhLCBsYWJlbHMpOgogICAgICAgIHNlbGYuZGF0YSA9IGRhdGEKICAgICAgICBzZWxmLmxhYmVscyA9IGxhYmVscwoKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiBsZW4oc2VsZi5kYXRhKQoKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBpZHgpOgogICAgICAgIHNhbXBsZSA9IHsnZGF0YSc6IHNlbGYuZGF0YVtpZHhdLCAnbGFiZWwnOiBzZWxmLmxhYmVsc1tpZHhdfQogICAgICAgIHJldHVybiBzYW1wbGUKCiMgRXhhbXBsZSB1c2FnZQpkYXRhID0gdG9yY2gucmFuZG4oMTAwLCAzLCAzMiwgMzIpICAjIDEwMCBzYW1wbGVzIG9mIDN4MzJ4MzIgaW1hZ2VzCmxhYmVscyA9IHRvcmNoLnJhbmRpbnQoMCwgMTAsICgxMDAsKSkgICMgMTAwIGxhYmVscyBmb3IgMTAgY2xhc3NlcwoKZGF0YXNldCA9IEN1c3RvbURhdGFzZXQoZGF0YSwgbGFiZWxzKQpwcmludChsZW4oZGF0YXNldCkpICAjIE91dHB1dDogMTAwCnByaW50KGRhdGFzZXRbMF0pICAjIE91dHB1dDogeydkYXRhJzogdGVuc29yKC4uLiksICdsYWJlbCc6IHRlbnNvciguLi4pfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch
from torch.utils.data import Dataset

class CustomDataset(Dataset):
    def __init__(self, data, labels):
        self.data = data
        self.labels = labels

    def __len__(self):
        return len(self.data)

    def __getitem__(self, idx):
        sample = {'data': self.data[idx], 'label': self.labels[idx]}
        return sample

# Example usage
data = torch.randn(100, 3, 32, 32)  # 100 samples of 3x32x32 images
labels = torch.randint(0, 10, (100,))  # 100 labels for 10 classes

dataset = CustomDataset(data, labels)
print(len(dataset))  # Output: 100
print(dataset[0])  # Output: {'data': tensor(...), 'label': tensor(...)}</pre></div><div class='content'></div><h2>DataLoader Class</h2>
<div class='content'><p>The <code>DataLoader</code> class provides an iterable over a dataset with support for batching, shuffling, and parallel data loading.</p>
<h4>Example: Using DataLoader</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSB0b3JjaC51dGlscy5kYXRhIGltcG9ydCBEYXRhTG9hZGVyCgpkYXRhbG9hZGVyID0gRGF0YUxvYWRlcihkYXRhc2V0LCBiYXRjaF9zaXplPTQsIHNodWZmbGU9VHJ1ZSwgbnVtX3dvcmtlcnM9MikKCmZvciBiYXRjaCBpbiBkYXRhbG9hZGVyOgogICAgcHJpbnQoYmF0Y2hbJ2RhdGEnXS5zaGFwZSwgYmF0Y2hbJ2xhYmVsJ10p"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from torch.utils.data import DataLoader

dataloader = DataLoader(dataset, batch_size=4, shuffle=True, num_workers=2)

for batch in dataloader:
    print(batch['data'].shape, batch['label'])</pre></div><div class='content'></div><h1>Preprocessing Techniques</h1>
<div class='content'><p>Preprocessing is essential to ensure that the data is in the right format and normalized for training. PyTorch provides several utilities for preprocessing, especially for image data.</p>
</div><h2>Common Preprocessing Steps</h2>
<div class='content'><ul>
<li><strong>Normalization</strong>: Adjusting the range of pixel values.</li>
<li><strong>Resizing</strong>: Changing the dimensions of images.</li>
<li><strong>Data Augmentation</strong>: Techniques like flipping, rotation, and cropping to artificially increase the size of the dataset.</li>
</ul>
</div><h2>Using `torchvision.transforms`</h2>
<div class='content'><p>The <code>torchvision.transforms</code> module provides several common preprocessing operations.</p>
<h4>Example: Image Preprocessing</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSB0b3JjaHZpc2lvbiBpbXBvcnQgdHJhbnNmb3Jtcwpmcm9tIFBJTCBpbXBvcnQgSW1hZ2UKCiMgRGVmaW5lIGEgc2VyaWVzIG9mIHRyYW5zZm9ybWF0aW9ucwp0cmFuc2Zvcm0gPSB0cmFuc2Zvcm1zLkNvbXBvc2UoWwogICAgdHJhbnNmb3Jtcy5SZXNpemUoKDEyOCwgMTI4KSksCiAgICB0cmFuc2Zvcm1zLlJhbmRvbUhvcml6b250YWxGbGlwKCksCiAgICB0cmFuc2Zvcm1zLlRvVGVuc29yKCksCiAgICB0cmFuc2Zvcm1zLk5vcm1hbGl6ZShtZWFuPVswLjQ4NSwgMC40NTYsIDAuNDA2XSwgc3RkPVswLjIyOSwgMC4yMjQsIDAuMjI1XSkKXSkKCiMgTG9hZCBhbiBpbWFnZQppbWFnZSA9IEltYWdlLm9wZW4oJ3BhdGgvdG8vaW1hZ2UuanBnJykKCiMgQXBwbHkgdHJhbnNmb3JtYXRpb25zCnRyYW5zZm9ybWVkX2ltYWdlID0gdHJhbnNmb3JtKGltYWdlKQpwcmludCh0cmFuc2Zvcm1lZF9pbWFnZS5zaGFwZSkgICMgT3V0cHV0OiB0b3JjaC5TaXplKFszLCAxMjgsIDEyOF0p"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from torchvision import transforms
from PIL import Image

# Define a series of transformations
transform = transforms.Compose([
    transforms.Resize((128, 128)),
    transforms.RandomHorizontalFlip(),
    transforms.ToTensor(),
    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
])

# Load an image
image = Image.open('path/to/image.jpg')

# Apply transformations
transformed_image = transform(image)
print(transformed_image.shape)  # Output: torch.Size([3, 128, 128])</pre></div><div class='content'></div><h2>Integrating Transforms with Dataset</h2>
<div class='content'><p>You can integrate these transformations directly into your custom dataset.</p>
<h4>Example: Custom Dataset with Transforms</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgQ3VzdG9tRGF0YXNldChEYXRhc2V0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBkYXRhLCBsYWJlbHMsIHRyYW5zZm9ybT1Ob25lKToKICAgICAgICBzZWxmLmRhdGEgPSBkYXRhCiAgICAgICAgc2VsZi5sYWJlbHMgPSBsYWJlbHMKICAgICAgICBzZWxmLnRyYW5zZm9ybSA9IHRyYW5zZm9ybQoKICAgIGRlZiBfX2xlbl9fKHNlbGYpOgogICAgICAgIHJldHVybiBsZW4oc2VsZi5kYXRhKQoKICAgIGRlZiBfX2dldGl0ZW1fXyhzZWxmLCBpZHgpOgogICAgICAgIHNhbXBsZSA9IHsnZGF0YSc6IHNlbGYuZGF0YVtpZHhdLCAnbGFiZWwnOiBzZWxmLmxhYmVsc1tpZHhdfQogICAgICAgIGlmIHNlbGYudHJhbnNmb3JtOgogICAgICAgICAgICBzYW1wbGVbJ2RhdGEnXSA9IHNlbGYudHJhbnNmb3JtKHNhbXBsZVsnZGF0YSddKQogICAgICAgIHJldHVybiBzYW1wbGUKCiMgRXhhbXBsZSB1c2FnZQp0cmFuc2Zvcm0gPSB0cmFuc2Zvcm1zLkNvbXBvc2UoWwogICAgdHJhbnNmb3Jtcy5SZXNpemUoKDEyOCwgMTI4KSksCiAgICB0cmFuc2Zvcm1zLlRvVGVuc29yKCksCiAgICB0cmFuc2Zvcm1zLk5vcm1hbGl6ZShtZWFuPVswLjQ4NSwgMC40NTYsIDAuNDA2XSwgc3RkPVswLjIyOSwgMC4yMjQsIDAuMjI1XSkKXSkKCmRhdGFzZXQgPSBDdXN0b21EYXRhc2V0KGRhdGEsIGxhYmVscywgdHJhbnNmb3JtPXRyYW5zZm9ybSkKZGF0YWxvYWRlciA9IERhdGFMb2FkZXIoZGF0YXNldCwgYmF0Y2hfc2l6ZT00LCBzaHVmZmxlPVRydWUsIG51bV93b3JrZXJzPTIpCgpmb3IgYmF0Y2ggaW4gZGF0YWxvYWRlcjoKICAgIHByaW50KGJhdGNoWydkYXRhJ10uc2hhcGUsIGJhdGNoWydsYWJlbCddKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class CustomDataset(Dataset):
    def __init__(self, data, labels, transform=None):
        self.data = data
        self.labels = labels
        self.transform = transform

    def __len__(self):
        return len(self.data)

    def __getitem__(self, idx):
        sample = {'data': self.data[idx], 'label': self.labels[idx]}
        if self.transform:
            sample['data'] = self.transform(sample['data'])
        return sample

# Example usage
transform = transforms.Compose([
    transforms.Resize((128, 128)),
    transforms.ToTensor(),
    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
])

dataset = CustomDataset(data, labels, transform=transform)
dataloader = DataLoader(dataset, batch_size=4, shuffle=True, num_workers=2)

for batch in dataloader:
    print(batch['data'].shape, batch['label'])</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the basics of data loading and preprocessing in PyTorch. We learned how to create custom datasets using the <code>Dataset</code> class, how to use the <code>DataLoader</code> class to load data efficiently, and how to apply common preprocessing techniques using <code>torchvision.transforms</code>. These skills are fundamental for preparing data for training machine learning models in PyTorch.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='loss-functions-and-optimization'>&#x25C4;Loss Functions and Optimization</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Data Loading and Preprocessing</a>
	</div>
	<div class='col-4 text-end'>
					<a href='training-loop-basics'>Training Loop Basics &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
