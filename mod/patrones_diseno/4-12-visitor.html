<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Software Design Patterns Course</title>

    <link rel="alternate" href="https://campusempresa.com/mod/patrones_diseno/4-12-visitor" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/patrones_diseno/4-12-visitor" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/patrones_diseno/4-12-visitor" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/patrones_diseno/4-12-visitor" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/patrones_diseno/4-12-visitor" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='4-11-template-method'>&#x25C4;Template Method</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Software Design Patterns Course</a>
	</div>
	<div class='col-4 text-end'>
					<a href='5-1-select-pattern'>How to Select the Right Pattern &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Module 4: Behavioral Patterns</h1>
<div class='content'></div><h2>Visitor Pattern</h2>
<div class='content'><h4>What is the Visitor Pattern?</h4>
<p>The Visitor Pattern is a behavioral design pattern that allows you to add further operations to objects without having to modify them. It involves creating a visitor class that changes the executing algorithm of an element class. By using this pattern, you can separate algorithms from the objects on which they operate.</p>
<h4>Key Concepts</h4>
<ol>
<li><strong>Visitor Interface</strong>: Declares a visit operation for each type of concrete element in the object structure.</li>
<li><strong>Concrete Visitor</strong>: Implements the operations declared in the Visitor interface.</li>
<li><strong>Element Interface</strong>: Declares an accept method that takes a visitor as an argument.</li>
<li><strong>Concrete Element</strong>: Implements the accept method, which calls the visitor's method corresponding to the element's class.</li>
<li><strong>Object Structure</strong>: A collection of elements that can be iterated over, allowing the visitor to visit each element.</li>
</ol>
<h4>Structure</h4>
<p>Here is a basic UML diagram for the Visitor Pattern:</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Visitor</td>
<td>Declares a visit operation for each type of concrete element.</td>
</tr>
<tr>
<td>ConcreteVisitor</td>
<td>Implements the operations declared in the Visitor interface.</td>
</tr>
<tr>
<td>Element</td>
<td>Declares an accept method that takes a visitor as an argument.</td>
</tr>
<tr>
<td>ConcreteElement</td>
<td>Implements the accept method, which calls the visitor's method.</td>
</tr>
<tr>
<td>ObjectStructure</td>
<td>Can enumerate its elements and provide a high-level interface to allow the visitor to visit its elements.</td>
</tr>
</tbody>
</table>
<h4>Example</h4>
<p>Let's consider a simple example where we have different types of items in a shopping cart, and we want to calculate the total price using the Visitor Pattern.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBhYmMgaW1wb3J0IEFCQywgYWJzdHJhY3RtZXRob2QKCiMgVmlzaXRvciBJbnRlcmZhY2UKY2xhc3MgU2hvcHBpbmdDYXJ0VmlzaXRvcihBQkMpOgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgdmlzaXRfYm9vayhzZWxmLCBib29rKToKICAgICAgICBwYXNzCgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgdmlzaXRfZnJ1aXQoc2VsZiwgZnJ1aXQpOgogICAgICAgIHBhc3MKCiMgQ29uY3JldGUgVmlzaXRvcgpjbGFzcyBTaG9wcGluZ0NhcnRWaXNpdG9ySW1wbChTaG9wcGluZ0NhcnRWaXNpdG9yKToKICAgIGRlZiB2aXNpdF9ib29rKHNlbGYsIGJvb2spOgogICAgICAgIGNvc3QgPSBib29rLnByaWNlCiAgICAgICAgcHJpbnQoZiJCb29rIElTQk46IHtib29rLmlzYm59LCBDb3N0OiB7Y29zdH0iKQogICAgICAgIHJldHVybiBjb3N0CgogICAgZGVmIHZpc2l0X2ZydWl0KHNlbGYsIGZydWl0KToKICAgICAgICBjb3N0ID0gZnJ1aXQucHJpY2VfcGVyX2tnICogZnJ1aXQud2VpZ2h0CiAgICAgICAgcHJpbnQoZiJGcnVpdDoge2ZydWl0Lm5hbWV9LCBDb3N0OiB7Y29zdH0iKQogICAgICAgIHJldHVybiBjb3N0CgojIEVsZW1lbnQgSW50ZXJmYWNlCmNsYXNzIEl0ZW1FbGVtZW50KEFCQyk6CiAgICBAYWJzdHJhY3RtZXRob2QKICAgIGRlZiBhY2NlcHQoc2VsZiwgdmlzaXRvcik6CiAgICAgICAgcGFzcwoKIyBDb25jcmV0ZSBFbGVtZW50cwpjbGFzcyBCb29rKEl0ZW1FbGVtZW50KToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBwcmljZSwgaXNibik6CiAgICAgICAgc2VsZi5wcmljZSA9IHByaWNlCiAgICAgICAgc2VsZi5pc2JuID0gaXNibgoKICAgIGRlZiBhY2NlcHQoc2VsZiwgdmlzaXRvcik6CiAgICAgICAgcmV0dXJuIHZpc2l0b3IudmlzaXRfYm9vayhzZWxmKQoKY2xhc3MgRnJ1aXQoSXRlbUVsZW1lbnQpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHByaWNlX3Blcl9rZywgd2VpZ2h0LCBuYW1lKToKICAgICAgICBzZWxmLnByaWNlX3Blcl9rZyA9IHByaWNlX3Blcl9rZwogICAgICAgIHNlbGYud2VpZ2h0ID0gd2VpZ2h0CiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQoKICAgIGRlZiBhY2NlcHQoc2VsZiwgdmlzaXRvcik6CiAgICAgICAgcmV0dXJuIHZpc2l0b3IudmlzaXRfZnJ1aXQoc2VsZikKCiMgT2JqZWN0IFN0cnVjdHVyZQpjbGFzcyBTaG9wcGluZ0NhcnQ6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi5pdGVtcyA9IFtdCgogICAgZGVmIGFkZF9pdGVtKHNlbGYsIGl0ZW0pOgogICAgICAgIHNlbGYuaXRlbXMuYXBwZW5kKGl0ZW0pCgogICAgZGVmIGNhbGN1bGF0ZV90b3RhbChzZWxmKToKICAgICAgICB2aXNpdG9yID0gU2hvcHBpbmdDYXJ0VmlzaXRvckltcGwoKQogICAgICAgIHRvdGFsID0gMAogICAgICAgIGZvciBpdGVtIGluIHNlbGYuaXRlbXM6CiAgICAgICAgICAgIHRvdGFsICs9IGl0ZW0uYWNjZXB0KHZpc2l0b3IpCiAgICAgICAgcmV0dXJuIHRvdGFsCgojIENsaWVudCBDb2RlCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBjYXJ0ID0gU2hvcHBpbmdDYXJ0KCkKICAgIGNhcnQuYWRkX2l0ZW0oQm9vaygyMCwgIjEyMzQiKSkKICAgIGNhcnQuYWRkX2l0ZW0oRnJ1aXQoMTAsIDIsICJCYW5hbmEiKSkKICAgIGNhcnQuYWRkX2l0ZW0oRnJ1aXQoNSwgNSwgIkFwcGxlIikpCgogICAgdG90YWwgPSBjYXJ0LmNhbGN1bGF0ZV90b3RhbCgpCiAgICBwcmludChmIlRvdGFsIENvc3Q6IHt0b3RhbH0iKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from abc import ABC, abstractmethod

# Visitor Interface
class ShoppingCartVisitor(ABC):
    @abstractmethod
    def visit_book(self, book):
        pass

    @abstractmethod
    def visit_fruit(self, fruit):
        pass

# Concrete Visitor
class ShoppingCartVisitorImpl(ShoppingCartVisitor):
    def visit_book(self, book):
        cost = book.price
        print(f&quot;Book ISBN: {book.isbn}, Cost: {cost}&quot;)
        return cost

    def visit_fruit(self, fruit):
        cost = fruit.price_per_kg * fruit.weight
        print(f&quot;Fruit: {fruit.name}, Cost: {cost}&quot;)
        return cost

# Element Interface
class ItemElement(ABC):
    @abstractmethod
    def accept(self, visitor):
        pass

# Concrete Elements
class Book(ItemElement):
    def __init__(self, price, isbn):
        self.price = price
        self.isbn = isbn

    def accept(self, visitor):
        return visitor.visit_book(self)

class Fruit(ItemElement):
    def __init__(self, price_per_kg, weight, name):
        self.price_per_kg = price_per_kg
        self.weight = weight
        self.name = name

    def accept(self, visitor):
        return visitor.visit_fruit(self)

# Object Structure
class ShoppingCart:
    def __init__(self):
        self.items = []

    def add_item(self, item):
        self.items.append(item)

    def calculate_total(self):
        visitor = ShoppingCartVisitorImpl()
        total = 0
        for item in self.items:
            total += item.accept(visitor)
        return total

# Client Code
if __name__ == &quot;__main__&quot;:
    cart = ShoppingCart()
    cart.add_item(Book(20, &quot;1234&quot;))
    cart.add_item(Fruit(10, 2, &quot;Banana&quot;))
    cart.add_item(Fruit(5, 5, &quot;Apple&quot;))

    total = cart.calculate_total()
    print(f&quot;Total Cost: {total}&quot;)</pre></div><div class='content'><h4>Explanation</h4>
<ol>
<li><strong>Visitor Interface</strong>: <code>ShoppingCartVisitor</code> declares methods for visiting different types of items.</li>
<li><strong>Concrete Visitor</strong>: <code>ShoppingCartVisitorImpl</code> implements the visit methods for <code>Book</code> and <code>Fruit</code>.</li>
<li><strong>Element Interface</strong>: <code>ItemElement</code> declares the <code>accept</code> method.</li>
<li><strong>Concrete Elements</strong>: <code>Book</code> and <code>Fruit</code> implement the <code>accept</code> method, which calls the appropriate visit method on the visitor.</li>
<li><strong>Object Structure</strong>: <code>ShoppingCart</code> holds a collection of items and uses the visitor to calculate the total cost.</li>
</ol>
<h4>Advantages and Disadvantages</h4>
<p><strong>Advantages:</strong></p>
<ul>
<li><strong>Separation of Concerns</strong>: Operations can be added without modifying the elements.</li>
<li><strong>Open/Closed Principle</strong>: Elements are open for extension but closed for modification.</li>
<li><strong>Flexibility</strong>: New operations can be added easily by creating new visitors.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li><strong>Complexity</strong>: Can increase the complexity of the code.</li>
<li><strong>Circular Dependency</strong>: Elements need to know about the visitor and vice versa.</li>
<li><strong>Maintenance</strong>: Adding new element types requires changes to the visitor interface and all its implementations.</li>
</ul>
<h4>Conclusion</h4>
<p>The Visitor Pattern is a powerful tool for scenarios where you need to perform operations on a collection of objects without changing their classes. It promotes the open/closed principle and allows for easy addition of new operations. However, it can introduce complexity and circular dependencies, so it should be used judiciously.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='4-11-template-method'>&#x25C4;Template Method</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Software Design Patterns Course</a>
	</div>
	<div class='col-4 text-end'>
					<a href='5-1-select-pattern'>How to Select the Right Pattern &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
