<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Replication</title>

    <link rel="alternate" href="https://campusempresa.com/mod/arquitecturas_distribuidas/03-03-replicacion-datos" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/arquitecturas_distribuidas/03-03-replicacio-dades" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/arquitecturas_distribuidas/03-03-data-replication" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/arquitecturas_distribuidas/03-03-replicacion-datos" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/arquitecturas_distribuidas/03-03-replicacio-dades" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='03-02-consensus-algorithms' title="Consensus Algorithms">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Data Replication</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='04-01-file-systems' title="Distributed File Systems">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Data replication is a critical concept in distributed systems, ensuring data availability, reliability, and fault tolerance. This section will cover the fundamental principles of data replication, various replication strategies, and practical examples to illustrate these concepts.</p>
</div><h1><p>Key Concepts of Data Replication</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Definition</strong>:</p>
<ul>
<li>Data replication involves copying data from one location to another to ensure consistency and availability across a distributed system.</li>
</ul>
</li>
<li>
<p><strong>Objectives</strong>:</p>
<ul>
<li><strong>Availability</strong>: Ensuring data is accessible even if some nodes fail.</li>
<li><strong>Fault Tolerance</strong>: Maintaining system functionality despite failures.</li>
<li><strong>Load Balancing</strong>: Distributing data access load across multiple nodes.</li>
<li><strong>Performance</strong>: Reducing latency by placing data closer to where it is needed.</li>
</ul>
</li>
</ol>
</div><h1><p>Types of Data Replication</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Synchronous Replication</strong>:</p>
<ul>
<li>Data is copied to replicas simultaneously with the primary data write.</li>
<li>Ensures strong consistency but can introduce latency.</li>
<li>Example: Financial transaction systems where consistency is critical.</li>
</ul>
</li>
<li>
<p><strong>Asynchronous Replication</strong>:</p>
<ul>
<li>Data is copied to replicas after the primary data write is complete.</li>
<li>Provides better performance and lower latency but may lead to eventual consistency.</li>
<li>Example: Social media updates where slight delays are acceptable.</li>
</ul>
</li>
<li>
<p><strong>Semi-Synchronous Replication</strong>:</p>
<ul>
<li>A hybrid approach where data is written to a subset of replicas synchronously and the rest asynchronously.</li>
<li>Balances between consistency and performance.</li>
</ul>
</li>
</ol>
</div><h1><p>Replication Strategies</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Master-Slave Replication</strong>:</p>
<ul>
<li>One master node handles all write operations, and slave nodes replicate the data.</li>
<li>Slaves can handle read operations, improving read performance.</li>
<li>Example: MySQL replication.</li>
</ul>
</li>
<li>
<p><strong>Multi-Master Replication</strong>:</p>
<ul>
<li>Multiple nodes can handle write operations, and data is replicated among all masters.</li>
<li>Provides high availability and fault tolerance but requires conflict resolution mechanisms.</li>
<li>Example: Cassandra database.</li>
</ul>
</li>
<li>
<p><strong>Quorum-Based Replication</strong>:</p>
<ul>
<li>A majority (quorum) of nodes must agree on a data write before it is considered committed.</li>
<li>Ensures consistency and fault tolerance.</li>
<li>Example: Apache ZooKeeper.</li>
</ul>
</li>
</ol>
</div><h1><p>Practical Example: Implementing Data Replication in a Distributed Database</p>
</h1>
<div class='content'><p>Let's consider a simple example of implementing master-slave replication in a distributed database using Python and a hypothetical database library.</p>
</div><h2><p>Code Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgRGF0YWJhc2VOb2RlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG5vZGVfaWQpOgogICAgICAgIHNlbGYubm9kZV9pZCA9IG5vZGVfaWQKICAgICAgICBzZWxmLmRhdGEgPSB7fQogICAgICAgIHNlbGYuaXNfbWFzdGVyID0gRmFsc2UKCiAgICBkZWYgd3JpdGVfZGF0YShzZWxmLCBrZXksIHZhbHVlKToKICAgICAgICBpZiBzZWxmLmlzX21hc3RlcjoKICAgICAgICAgICAgc2VsZi5kYXRhW2tleV0gPSB2YWx1ZQogICAgICAgICAgICBzZWxmLnJlcGxpY2F0ZV9kYXRhKGtleSwgdmFsdWUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKCJXcml0ZSBvcGVyYXRpb24gbm90IGFsbG93ZWQgb24gc2xhdmUgbm9kZSIpCgogICAgZGVmIHJlYWRfZGF0YShzZWxmLCBrZXkpOgogICAgICAgIHJldHVybiBzZWxmLmRhdGEuZ2V0KGtleSwgTm9uZSkKCiAgICBkZWYgcmVwbGljYXRlX2RhdGEoc2VsZiwga2V5LCB2YWx1ZSk6CiAgICAgICAgZm9yIG5vZGUgaW4gY2x1c3RlcjoKICAgICAgICAgICAgaWYgbm9kZS5ub2RlX2lkICE9IHNlbGYubm9kZV9pZDoKICAgICAgICAgICAgICAgIG5vZGUuZGF0YVtrZXldID0gdmFsdWUKCiMgSW5pdGlhbGl6ZSBjbHVzdGVyIG5vZGVzCm1hc3Rlcl9ub2RlID0gRGF0YWJhc2VOb2RlKG5vZGVfaWQ9MSkKbWFzdGVyX25vZGUuaXNfbWFzdGVyID0gVHJ1ZQpzbGF2ZV9ub2RlXzEgPSBEYXRhYmFzZU5vZGUobm9kZV9pZD0yKQpzbGF2ZV9ub2RlXzIgPSBEYXRhYmFzZU5vZGUobm9kZV9pZD0zKQoKIyBDbHVzdGVyIG9mIG5vZGVzCmNsdXN0ZXIgPSBbbWFzdGVyX25vZGUsIHNsYXZlX25vZGVfMSwgc2xhdmVfbm9kZV8yXQoKIyBXcml0ZSBkYXRhIHRvIG1hc3RlciBub2RlCm1hc3Rlcl9ub2RlLndyaXRlX2RhdGEoJ3VzZXIxJywgJ0FsaWNlJykKCiMgUmVhZCBkYXRhIGZyb20gc2xhdmUgbm9kZXMKcHJpbnQoc2xhdmVfbm9kZV8xLnJlYWRfZGF0YSgndXNlcjEnKSkgICMgT3V0cHV0OiBBbGljZQpwcmludChzbGF2ZV9ub2RlXzIucmVhZF9kYXRhKCd1c2VyMScpKSAgIyBPdXRwdXQ6IEFsaWNl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class DatabaseNode:
    def __init__(self, node_id):
        self.node_id = node_id
        self.data = {}
        self.is_master = False

    def write_data(self, key, value):
        if self.is_master:
            self.data[key] = value
            self.replicate_data(key, value)
        else:
            raise Exception(&quot;Write operation not allowed on slave node&quot;)

    def read_data(self, key):
        return self.data.get(key, None)

    def replicate_data(self, key, value):
        for node in cluster:
            if node.node_id != self.node_id:
                node.data[key] = value

# Initialize cluster nodes
master_node = DatabaseNode(node_id=1)
master_node.is_master = True
slave_node_1 = DatabaseNode(node_id=2)
slave_node_2 = DatabaseNode(node_id=3)

# Cluster of nodes
cluster = [master_node, slave_node_1, slave_node_2]

# Write data to master node
master_node.write_data('user1', 'Alice')

# Read data from slave nodes
print(slave_node_1.read_data('user1'))  # Output: Alice
print(slave_node_2.read_data('user1'))  # Output: Alice</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>DatabaseNode Class</strong>: Represents a node in the distributed database.</li>
<li><strong>write_data Method</strong>: Allows writing data only on the master node and replicates it to slave nodes.</li>
<li><strong>read_data Method</strong>: Allows reading data from any node.</li>
<li><strong>replicate_data Method</strong>: Replicates data to all other nodes in the cluster.</li>
</ul>
</div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Implement Asynchronous Replication</p>
</h2>
<div class='content'><p>Modify the above code to implement asynchronous replication, where data is replicated to slave nodes after a delay.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRpbWUKaW1wb3J0IHRocmVhZGluZwoKY2xhc3MgRGF0YWJhc2VOb2RlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIG5vZGVfaWQpOgogICAgICAgIHNlbGYubm9kZV9pZCA9IG5vZGVfaWQKICAgICAgICBzZWxmLmRhdGEgPSB7fQogICAgICAgIHNlbGYuaXNfbWFzdGVyID0gRmFsc2UKCiAgICBkZWYgd3JpdGVfZGF0YShzZWxmLCBrZXksIHZhbHVlKToKICAgICAgICBpZiBzZWxmLmlzX21hc3RlcjoKICAgICAgICAgICAgc2VsZi5kYXRhW2tleV0gPSB2YWx1ZQogICAgICAgICAgICB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1zZWxmLnJlcGxpY2F0ZV9kYXRhLCBhcmdzPShrZXksIHZhbHVlKSkuc3RhcnQoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHJhaXNlIEV4Y2VwdGlvbigiV3JpdGUgb3BlcmF0aW9uIG5vdCBhbGxvd2VkIG9uIHNsYXZlIG5vZGUiKQoKICAgIGRlZiByZWFkX2RhdGEoc2VsZiwga2V5KToKICAgICAgICByZXR1cm4gc2VsZi5kYXRhLmdldChrZXksIE5vbmUpCgogICAgZGVmIHJlcGxpY2F0ZV9kYXRhKHNlbGYsIGtleSwgdmFsdWUpOgogICAgICAgIHRpbWUuc2xlZXAoMikgICMgU2ltdWxhdGUgZGVsYXkKICAgICAgICBmb3Igbm9kZSBpbiBjbHVzdGVyOgogICAgICAgICAgICBpZiBub2RlLm5vZGVfaWQgIT0gc2VsZi5ub2RlX2lkOgogICAgICAgICAgICAgICAgbm9kZS5kYXRhW2tleV0gPSB2YWx1ZQoKIyBJbml0aWFsaXplIGNsdXN0ZXIgbm9kZXMKbWFzdGVyX25vZGUgPSBEYXRhYmFzZU5vZGUobm9kZV9pZD0xKQptYXN0ZXJfbm9kZS5pc19tYXN0ZXIgPSBUcnVlCnNsYXZlX25vZGVfMSA9IERhdGFiYXNlTm9kZShub2RlX2lkPTIpCnNsYXZlX25vZGVfMiA9IERhdGFiYXNlTm9kZShub2RlX2lkPTMpCgojIENsdXN0ZXIgb2Ygbm9kZXMKY2x1c3RlciA9IFttYXN0ZXJfbm9kZSwgc2xhdmVfbm9kZV8xLCBzbGF2ZV9ub2RlXzJdCgojIFdyaXRlIGRhdGEgdG8gbWFzdGVyIG5vZGUKbWFzdGVyX25vZGUud3JpdGVfZGF0YSgndXNlcjEnLCAnQWxpY2UnKQoKIyBSZWFkIGRhdGEgZnJvbSBzbGF2ZSBub2RlcyBhZnRlciBkZWxheQp0aW1lLnNsZWVwKDMpCnByaW50KHNsYXZlX25vZGVfMS5yZWFkX2RhdGEoJ3VzZXIxJykpICAjIE91dHB1dDogQWxpY2UKcHJpbnQoc2xhdmVfbm9kZV8yLnJlYWRfZGF0YSgndXNlcjEnKSkgICMgT3V0cHV0OiBBbGljZQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import time
import threading

class DatabaseNode:
    def __init__(self, node_id):
        self.node_id = node_id
        self.data = {}
        self.is_master = False

    def write_data(self, key, value):
        if self.is_master:
            self.data[key] = value
            threading.Thread(target=self.replicate_data, args=(key, value)).start()
        else:
            raise Exception(&quot;Write operation not allowed on slave node&quot;)

    def read_data(self, key):
        return self.data.get(key, None)

    def replicate_data(self, key, value):
        time.sleep(2)  # Simulate delay
        for node in cluster:
            if node.node_id != self.node_id:
                node.data[key] = value

# Initialize cluster nodes
master_node = DatabaseNode(node_id=1)
master_node.is_master = True
slave_node_1 = DatabaseNode(node_id=2)
slave_node_2 = DatabaseNode(node_id=3)

# Cluster of nodes
cluster = [master_node, slave_node_1, slave_node_2]

# Write data to master node
master_node.write_data('user1', 'Alice')

# Read data from slave nodes after delay
time.sleep(3)
print(slave_node_1.read_data('user1'))  # Output: Alice
print(slave_node_2.read_data('user1'))  # Output: Alice</pre></div><div class='content'></div><h2><p>Solution Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>Threading</strong>: Used to simulate asynchronous replication by running the <code>replicate_data</code> method in a separate thread.</li>
<li><strong>Delay</strong>: Introduced a delay using <code>time.sleep</code> to simulate the asynchronous nature of replication.</li>
</ul>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Consistency vs. Performance</strong>:</p>
<ul>
<li>Understand the trade-offs between consistency and performance when choosing a replication strategy.</li>
<li>Synchronous replication ensures consistency but can be slower, while asynchronous replication is faster but may lead to eventual consistency.</li>
</ul>
</li>
<li>
<p><strong>Conflict Resolution</strong>:</p>
<ul>
<li>In multi-master replication, conflicts can arise when multiple nodes write to the same data simultaneously. Implement conflict resolution mechanisms to handle such scenarios.</li>
</ul>
</li>
<li>
<p><strong>Network Partitions</strong>:</p>
<ul>
<li>Be aware of network partitions and their impact on data replication. Use quorum-based replication to ensure data consistency during partitions.</li>
</ul>
</li>
</ol>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Data replication is a fundamental aspect of distributed systems, ensuring data availability, fault tolerance, and performance. By understanding different replication strategies and their trade-offs, you can design robust and efficient distributed systems. In the next section, we will explore distributed storage systems, which build upon the concepts of data replication to provide scalable and reliable storage solutions.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='03-02-consensus-algorithms' title="Consensus Algorithms">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='04-01-file-systems' title="Distributed File Systems">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
