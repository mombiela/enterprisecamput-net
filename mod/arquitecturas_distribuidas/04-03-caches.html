<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Distributed Caches</title>

    <link rel="alternate" href="https://campusempresa.com/mod/arquitecturas_distribuidas/04-03-caches" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/arquitecturas_distribuidas/04-03-caches" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/arquitecturas_distribuidas/04-03-caches" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/arquitecturas_distribuidas/04-03-caches" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/arquitecturas_distribuidas/04-03-caches" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-02-databases' title="Distributed Databases">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Distributed Caches</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-mapreduce-hadoop' title="MapReduce and Hadoop">Next &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Distributed caches are a critical component in modern distributed systems, providing a mechanism to store and retrieve data quickly across multiple nodes. They help improve the performance and scalability of applications by reducing the load on databases and ensuring faster access to frequently used data.</p>
</div><h1>Key Concepts</h1>
<div class='content'></div><h2>What is a Distributed Cache?</h2>
<div class='content'><p>A distributed cache is a cache that spans multiple servers or nodes, allowing data to be stored and accessed from multiple locations. This setup helps in balancing the load and provides redundancy, ensuring high availability and fault tolerance.</p>
</div><h2>Why Use Distributed Caches?</h2>
<div class='content'><ul>
<li><strong>Performance Improvement</strong>: Reduces latency by storing frequently accessed data closer to the application.</li>
<li><strong>Scalability</strong>: Can handle increased load by distributing data across multiple nodes.</li>
<li><strong>Fault Tolerance</strong>: Provides redundancy, ensuring data availability even if some nodes fail.</li>
<li><strong>Load Reduction</strong>: Decreases the load on the primary database by caching frequently accessed data.</li>
</ul>
</div><h1>Common Distributed Cache Systems</h1>
<div class='content'><ul>
<li><strong>Redis</strong>: An in-memory data structure store, used as a database, cache, and message broker.</li>
<li><strong>Memcached</strong>: A high-performance, distributed memory object caching system.</li>
<li><strong>Hazelcast</strong>: An in-memory data grid that provides distributed caching and computing.</li>
</ul>
</div><h1>Architecture of Distributed Caches</h1>
<div class='content'></div><h2>Basic Architecture</h2>
<div class='content'><ol>
<li><strong>Clients</strong>: Applications that request data from the cache.</li>
<li><strong>Cache Nodes</strong>: Servers that store the cached data.</li>
<li><strong>Data Store</strong>: The primary database or data source.</li>
</ol>
</div><h2>Data Distribution</h2>
<div class='content'><p>Data in a distributed cache is typically partitioned across multiple nodes using techniques like consistent hashing to ensure even distribution and efficient retrieval.</p>
</div><h2>Replication</h2>
<div class='content'><p>To ensure high availability and fault tolerance, data can be replicated across multiple nodes. This replication can be synchronous or asynchronous.</p>
</div><h2>Eviction Policies</h2>
<div class='content'><p>Distributed caches use various eviction policies to manage the cache size and ensure that the most relevant data is stored:</p>
<ul>
<li><strong>Least Recently Used (LRU)</strong>: Removes the least recently accessed items first.</li>
<li><strong>Least Frequently Used (LFU)</strong>: Removes the least frequently accessed items first.</li>
<li><strong>Time-to-Live (TTL)</strong>: Removes items after a certain period.</li>
</ul>
</div><h1>Practical Example: Using Redis as a Distributed Cache</h1>
<div class='content'></div><h2>Setting Up Redis</h2>
<div class='content'><ol>
<li>
<p><strong>Install Redis</strong>:</p>
<pre><code class="language-bash">sudo apt-get update
sudo apt-get install redis-server
</code></pre>
</li>
<li>
<p><strong>Start Redis Server</strong>:</p>
<pre><code class="language-bash">sudo service redis-server start
</code></pre>
</li>
</ol>
</div><h2>Basic Operations with Redis</h2>
<div class='content'><ol>
<li>
<p><strong>Connecting to Redis</strong>:</p>
<pre><code class="language-python">import redis

# Connect to the Redis server
client = redis.StrictRedis(host='localhost', port=6379, db=0)
</code></pre>
</li>
<li>
<p><strong>Storing Data</strong>:</p>
<pre><code class="language-python"># Set a key-value pair
client.set('key', 'value')
</code></pre>
</li>
<li>
<p><strong>Retrieving Data</strong>:</p>
<pre><code class="language-python"># Get the value of a key
value = client.get('key')
print(value)  # Output: b'value'
</code></pre>
</li>
<li>
<p><strong>Deleting Data</strong>:</p>
<pre><code class="language-python"># Delete a key
client.delete('key')
</code></pre>
</li>
</ol>
</div><h2>Example: Caching Database Query Results</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHJlZGlzCmltcG9ydCB0aW1lCgojIENvbm5lY3QgdG8gUmVkaXMKY2FjaGUgPSByZWRpcy5TdHJpY3RSZWRpcyhob3N0PSdsb2NhbGhvc3QnLCBwb3J0PTYzNzksIGRiPTApCgpkZWYgZ2V0X2RhdGFfZnJvbV9kYihxdWVyeSk6CiAgICAjIFNpbXVsYXRlIGEgZGF0YWJhc2UgcXVlcnkKICAgIHRpbWUuc2xlZXAoMikKICAgIHJldHVybiBmIlJlc3VsdCBmb3Ige3F1ZXJ5fSIKCmRlZiBnZXRfZGF0YShxdWVyeSk6CiAgICAjIENoZWNrIGlmIHRoZSByZXN1bHQgaXMgaW4gdGhlIGNhY2hlCiAgICBjYWNoZWRfcmVzdWx0ID0gY2FjaGUuZ2V0KHF1ZXJ5KQogICAgaWYgY2FjaGVkX3Jlc3VsdDoKICAgICAgICBwcmludCgiQ2FjaGUgaGl0IikKICAgICAgICByZXR1cm4gY2FjaGVkX3Jlc3VsdC5kZWNvZGUoJ3V0Zi04JykKICAgIAogICAgIyBJZiBub3QgaW4gY2FjaGUsIHF1ZXJ5IHRoZSBkYXRhYmFzZQogICAgcHJpbnQoIkNhY2hlIG1pc3MiKQogICAgcmVzdWx0ID0gZ2V0X2RhdGFfZnJvbV9kYihxdWVyeSkKICAgIAogICAgIyBTdG9yZSB0aGUgcmVzdWx0IGluIHRoZSBjYWNoZQogICAgY2FjaGUuc2V0KHF1ZXJ5LCByZXN1bHQsIGV4PTYwKSAgIyBTZXQgYSBUVEwgb2YgNjAgc2Vjb25kcwogICAgcmV0dXJuIHJlc3VsdAoKIyBFeGFtcGxlIHVzYWdlCnF1ZXJ5ID0gIlNFTEVDVCAqIEZST00gdXNlcnMgV0hFUkUgaWQ9MSIKcmVzdWx0ID0gZ2V0X2RhdGEocXVlcnkpCnByaW50KHJlc3VsdCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import redis
import time

# Connect to Redis
cache = redis.StrictRedis(host='localhost', port=6379, db=0)

def get_data_from_db(query):
    # Simulate a database query
    time.sleep(2)
    return f&quot;Result for {query}&quot;

def get_data(query):
    # Check if the result is in the cache
    cached_result = cache.get(query)
    if cached_result:
        print(&quot;Cache hit&quot;)
        return cached_result.decode('utf-8')
    
    # If not in cache, query the database
    print(&quot;Cache miss&quot;)
    result = get_data_from_db(query)
    
    # Store the result in the cache
    cache.set(query, result, ex=60)  # Set a TTL of 60 seconds
    return result

# Example usage
query = &quot;SELECT * FROM users WHERE id=1&quot;
result = get_data(query)
print(result)</pre></div><div class='content'></div><h1>Exercises</h1>
<div class='content'></div><h2>Exercise 1: Basic Redis Operations</h2>
<div class='content'><ol>
<li><strong>Task</strong>: Connect to a Redis server and perform basic operations (set, get, delete).</li>
<li><strong>Solution</strong>:
<pre><code class="language-python">import redis

# Connect to Redis
client = redis.StrictRedis(host='localhost', port=6379, db=0)

# Set a key-value pair
client.set('name', 'Alice')

# Get the value of the key
name = client.get('name')
print(name)  # Output: b'Alice'

# Delete the key
client.delete('name')
</code></pre>
</li>
</ol>
</div><h2>Exercise 2: Implementing a Simple Cache</h2>
<div class='content'><ol>
<li><strong>Task</strong>: Implement a simple cache using Redis to store and retrieve the results of a function.</li>
<li><strong>Solution</strong>:
<pre><code class="language-python">import redis
import time

# Connect to Redis
cache = redis.StrictRedis(host='localhost', port=6379, db=0)

def expensive_function(param):
    time.sleep(2)  # Simulate a time-consuming operation
    return f&quot;Result for {param}&quot;

def cached_function(param):
    # Check if the result is in the cache
    cached_result = cache.get(param)
    if cached_result:
        print(&quot;Cache hit&quot;)
        return cached_result.decode('utf-8')

    # If not in cache, call the expensive function
    print(&quot;Cache miss&quot;)
    result = expensive_function(param)

    # Store the result in the cache
    cache.set(param, result, ex=60)  # Set a TTL of 60 seconds
    return result

# Example usage
param = &quot;test&quot;
result = cached_function(param)
print(result)
</code></pre>
</li>
</ol>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we explored the concept of distributed caches, their architecture, and their benefits. We also looked at practical examples using Redis to demonstrate how distributed caches can be implemented and used in real-world applications. By understanding and leveraging distributed caches, you can significantly improve the performance and scalability of your distributed systems.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-02-databases' title="Distributed Databases">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-mapreduce-hadoop' title="MapReduce and Hadoop">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
