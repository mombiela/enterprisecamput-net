<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication and Authorization</title>

    <link rel="alternate" href="https://campusempresa.com/mod/arquitecturas_distribuidas/06-01-autenticacion-autorizacion" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/arquitecturas_distribuidas/06-01-autenticacio-autoritzacio" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/arquitecturas_distribuidas/06-01-authentication-authorization" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/arquitecturas_distribuidas/06-01-autenticacion-autorizacion" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/arquitecturas_distribuidas/06-01-autenticacio-autoritzacio" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-03-stream-processing' title="Data Stream Processing">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Authentication and Authorization</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-02-encryption-protection' title="Encryption and Data Protection">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1><p>Introduction</p>
</h1>
<div class='content'><p>In distributed systems, ensuring that only authorized users and services can access resources is crucial for maintaining security and integrity. This module covers the fundamental concepts of authentication and authorization, their importance, and how they are implemented in distributed systems.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'></div><h2><p>Authentication</p>
</h2>
<div class='content'><p>Authentication is the process of verifying the identity of a user or service. It ensures that the entity requesting access is who it claims to be.</p>
<ul>
<li><strong>User Authentication</strong>: Verifying the identity of a user through credentials such as usernames and passwords, biometrics, or multi-factor authentication (MFA).</li>
<li><strong>Service Authentication</strong>: Verifying the identity of a service or application, often through API keys, tokens, or certificates.</li>
</ul>
</div><h2><p>Authorization</p>
</h2>
<div class='content'><p>Authorization is the process of determining whether an authenticated entity has permission to access a resource or perform an action.</p>
<ul>
<li><strong>Access Control</strong>: Mechanisms that enforce what authenticated users or services can do. Common models include Role-Based Access Control (RBAC) and Attribute-Based Access Control (ABAC).</li>
<li><strong>Permissions</strong>: Specific rights granted to users or services, such as read, write, or execute permissions.</li>
</ul>
</div><h1><p>Authentication Methods</p>
</h1>
<div class='content'></div><h2><p>Password-Based Authentication</p>
</h2>
<div class='content'><p>The most common form of authentication where users provide a username and password.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VXNlcm5hbWU6IGpvaG5kb2UKUGFzc3dvcmQ6ICoq"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Username: johndoe
Password: <strong></strong>**</pre></div><div class='content'><p><strong>Pros</strong>:</p>
<ul>
<li>Simple and widely understood.</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li>Vulnerable to attacks such as brute force, phishing, and password reuse.</li>
</ul>
</div><h2><p>Multi-Factor Authentication (MFA)</p>
</h2>
<div class='content'><p>Combines two or more authentication factors:</p>
<ol>
<li>Something you know (password).</li>
<li>Something you have (smartphone, token).</li>
<li>Something you are (biometrics).</li>
</ol>
<p><strong>Example</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("MS4gRW50ZXIgcGFzc3dvcmQuCjIuIEVudGVyIGNvZGUgc2VudCB0byB5b3VyIG1vYmlsZSBkZXZpY2Uu"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>1. Enter password.
2. Enter code sent to your mobile device.</pre></div><div class='content'><p><strong>Pros</strong>:</p>
<ul>
<li>Significantly increases security.</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li>Can be inconvenient for users.</li>
</ul>
</div><h2><p>Token-Based Authentication</p>
</h2>
<div class='content'><p>Uses tokens (e.g., JWT - JSON Web Tokens) to authenticate users and services.</p>
<p><strong>Example</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJ0b2tlbiI6ICJleUpoYkdjaU9pSklVekkxTmlJc0luUjVjQ0k2SWtwWFZDSjkuLi4iCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;token&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&quot;
}</pre></div><div class='content'><p><strong>Pros</strong>:</p>
<ul>
<li>Stateless and scalable.</li>
<li>Can be used across different domains.</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li>Token management can be complex.</li>
</ul>
</div><h1><p>Authorization Methods</p>
</h1>
<div class='content'></div><h2><p>Role-Based Access Control (RBAC)</p>
</h2>
<div class='content'><p>Users are assigned roles, and roles are granted permissions.</p>
<p><strong>Example</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Um9sZTogQWRtaW4KUGVybWlzc2lvbnM6IFtyZWFkLCB3cml0ZSwgZGVsZXRlXQoKUm9sZTogVXNlcgpQZXJtaXNzaW9uczogW3JlYWRd"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Role: Admin
Permissions: [read, write, delete]

Role: User
Permissions: [read]</pre></div><div class='content'><p><strong>Pros</strong>:</p>
<ul>
<li>Simplifies management of permissions.</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li>Can become complex in large systems with many roles.</li>
</ul>
</div><h2><p>Attribute-Based Access Control (ABAC)</p>
</h2>
<div class='content'><p>Access decisions are based on attributes of the user, resource, and environment.</p>
<p><strong>Example</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VXNlciBBdHRyaWJ1dGU6IERlcGFydG1lbnQgPSBTYWxlcwpSZXNvdXJjZSBBdHRyaWJ1dGU6IERvY3VtZW50IFR5cGUgPSBTYWxlcyBSZXBvcnQKRW52aXJvbm1lbnQgQXR0cmlidXRlOiBUaW1lID0gQnVzaW5lc3MgSG91cnM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>User Attribute: Department = Sales
Resource Attribute: Document Type = Sales Report
Environment Attribute: Time = Business Hours</pre></div><div class='content'><p><strong>Pros</strong>:</p>
<ul>
<li>Highly flexible and fine-grained control.</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li>More complex to implement and manage.</li>
</ul>
</div><h1><p>Practical Example: Implementing JWT Authentication</p>
</h1>
<div class='content'></div><h2><p>Step 1: User Login</p>
</h2>
<div class='content'><ol>
<li>User sends a login request with credentials.</li>
<li>Server verifies credentials.</li>
<li>Server generates a JWT and sends it to the user.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGp3dAppbXBvcnQgZGF0ZXRpbWUKCmRlZiBnZW5lcmF0ZV9qd3QodXNlcl9pZCk6CiAgICBwYXlsb2FkID0gewogICAgICAgICd1c2VyX2lkJzogdXNlcl9pZCwKICAgICAgICAnZXhwJzogZGF0ZXRpbWUuZGF0ZXRpbWUudXRjbm93KCkgKyBkYXRldGltZS50aW1lZGVsdGEoaG91cnM9MSkKICAgIH0KICAgIHRva2VuID0gand0LmVuY29kZShwYXlsb2FkLCAnc2VjcmV0X2tleScsIGFsZ29yaXRobT0nSFMyNTYnKQogICAgcmV0dXJuIHRva2Vu"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import jwt
import datetime

def generate_jwt(user_id):
    payload = {
        'user_id': user_id,
        'exp': datetime.datetime.utcnow() + datetime.timedelta(hours=1)
    }
    token = jwt.encode(payload, 'secret_key', algorithm='HS256')
    return token</pre></div><div class='content'></div><h2><p>Step 2: Accessing a Protected Resource</p>
</h2>
<div class='content'><ol>
<li>User sends a request with the JWT in the Authorization header.</li>
<li>Server verifies the JWT.</li>
<li>If valid, server grants access to the resource.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgcmVxdWVzdCwganNvbmlmeQoKZGVmIHByb3RlY3RlZF9yb3V0ZSgpOgogICAgdG9rZW4gPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdBdXRob3JpemF0aW9uJykuc3BsaXQoKVsxXQogICAgdHJ5OgogICAgICAgIHBheWxvYWQgPSBqd3QuZGVjb2RlKHRva2VuLCAnc2VjcmV0X2tleScsIGFsZ29yaXRobXM9WydIUzI1NiddKQogICAgICAgIHVzZXJfaWQgPSBwYXlsb2FkWyd1c2VyX2lkJ10KICAgICAgICAjIFByb2NlZWQgd2l0aCBhY2Nlc3NpbmcgdGhlIHJlc291cmNlCiAgICAgICAgcmV0dXJuIGpzb25pZnkoeydtZXNzYWdlJzogJ0FjY2VzcyBncmFudGVkJ30pCiAgICBleGNlcHQgand0LkV4cGlyZWRTaWduYXR1cmVFcnJvcjoKICAgICAgICByZXR1cm4ganNvbmlmeSh7J21lc3NhZ2UnOiAnVG9rZW4gaGFzIGV4cGlyZWQnfSksIDQwMQogICAgZXhjZXB0IGp3dC5JbnZhbGlkVG9rZW5FcnJvcjoKICAgICAgICByZXR1cm4ganNvbmlmeSh7J21lc3NhZ2UnOiAnSW52YWxpZCB0b2tlbid9KSwgNDAx"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import request, jsonify

def protected_route():
    token = request.headers.get('Authorization').split()[1]
    try:
        payload = jwt.decode(token, 'secret_key', algorithms=['HS256'])
        user_id = payload['user_id']
        # Proceed with accessing the resource
        return jsonify({'message': 'Access granted'})
    except jwt.ExpiredSignatureError:
        return jsonify({'message': 'Token has expired'}), 401
    except jwt.InvalidTokenError:
        return jsonify({'message': 'Invalid token'}), 401</pre></div><div class='content'></div><h1><p>Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Implement Basic Authentication</p>
</h2>
<div class='content'><p>Create a simple authentication system where users can register and login using a username and password. Store user credentials securely using hashing.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGhhc2hsaWIKCnVzZXJzID0ge30KCmRlZiByZWdpc3Rlcih1c2VybmFtZSwgcGFzc3dvcmQpOgogICAgaGFzaGVkX3Bhc3N3b3JkID0gaGFzaGxpYi5zaGEyNTYocGFzc3dvcmQuZW5jb2RlKCkpLmhleGRpZ2VzdCgpCiAgICB1c2Vyc1t1c2VybmFtZV0gPSBoYXNoZWRfcGFzc3dvcmQKCmRlZiBsb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpOgogICAgaGFzaGVkX3Bhc3N3b3JkID0gaGFzaGxpYi5zaGEyNTYocGFzc3dvcmQuZW5jb2RlKCkpLmhleGRpZ2VzdCgpCiAgICBpZiB1c2Vycy5nZXQodXNlcm5hbWUpID09IGhhc2hlZF9wYXNzd29yZDoKICAgICAgICByZXR1cm4gIkxvZ2luIHN1Y2Nlc3NmdWwiCiAgICBlbHNlOgogICAgICAgIHJldHVybiAiSW52YWxpZCBjcmVkZW50aWFscyIKCiMgUmVnaXN0ZXIgYSB1c2VyCnJlZ2lzdGVyKCdqb2huZG9lJywgJ3Bhc3N3b3JkMTIzJykKCiMgQXR0ZW1wdCB0byBsb2dpbgpwcmludChsb2dpbignam9obmRvZScsICdwYXNzd29yZDEyMycpKSAgIyBPdXRwdXQ6IExvZ2luIHN1Y2Nlc3NmdWwKcHJpbnQobG9naW4oJ2pvaG5kb2UnLCAnd3JvbmdwYXNzd29yZCcpKSAgIyBPdXRwdXQ6IEludmFsaWQgY3JlZGVudGlhbHM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import hashlib

users = {}

def register(username, password):
    hashed_password = hashlib.sha256(password.encode()).hexdigest()
    users[username] = hashed_password

def login(username, password):
    hashed_password = hashlib.sha256(password.encode()).hexdigest()
    if users.get(username) == hashed_password:
        return &quot;Login successful&quot;
    else:
        return &quot;Invalid credentials&quot;

# Register a user
register('johndoe', 'password123')

# Attempt to login
print(login('johndoe', 'password123'))  # Output: Login successful
print(login('johndoe', 'wrongpassword'))  # Output: Invalid credentials</pre></div><div class='content'></div><h2><p>Exercise 2: Implement Role-Based Access Control</p>
</h2>
<div class='content'><p>Extend the basic authentication system to include roles and permissions. Implement a function to check if a user has a specific permission.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cm9sZXMgPSB7CiAgICAnYWRtaW4nOiBbJ3JlYWQnLCAnd3JpdGUnLCAnZGVsZXRlJ10sCiAgICAndXNlcic6IFsncmVhZCddCn0KCnVzZXJfcm9sZXMgPSB7CiAgICAnam9obmRvZSc6ICdhZG1pbicsCiAgICAnamFuZWRvZSc6ICd1c2VyJwp9CgpkZWYgaGFzX3Blcm1pc3Npb24odXNlcm5hbWUsIHBlcm1pc3Npb24pOgogICAgcm9sZSA9IHVzZXJfcm9sZXMuZ2V0KHVzZXJuYW1lKQogICAgaWYgcm9sZSBhbmQgcGVybWlzc2lvbiBpbiByb2xlcy5nZXQocm9sZSwgW10pOgogICAgICAgIHJldHVybiBUcnVlCiAgICByZXR1cm4gRmFsc2UKCiMgQ2hlY2sgcGVybWlzc2lvbnMKcHJpbnQoaGFzX3Blcm1pc3Npb24oJ2pvaG5kb2UnLCAnZGVsZXRlJykpICAjIE91dHB1dDogVHJ1ZQpwcmludChoYXNfcGVybWlzc2lvbignamFuZWRvZScsICdkZWxldGUnKSkgICMgT3V0cHV0OiBGYWxzZQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>roles = {
    'admin': ['read', 'write', 'delete'],
    'user': ['read']
}

user_roles = {
    'johndoe': 'admin',
    'janedoe': 'user'
}

def has_permission(username, permission):
    role = user_roles.get(username)
    if role and permission in roles.get(role, []):
        return True
    return False

# Check permissions
print(has_permission('johndoe', 'delete'))  # Output: True
print(has_permission('janedoe', 'delete'))  # Output: False</pre></div><div class='content'></div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Storing Plain Text Passwords</strong>: Always hash passwords before storing them.</li>
<li><strong>Ignoring Token Expiry</strong>: Ensure tokens have an expiry time to reduce the risk of misuse.</li>
<li><strong>Overcomplicating Access Control</strong>: Start with simple models like RBAC and evolve as needed.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Authentication and authorization are critical components of distributed systems security. Understanding and implementing these concepts correctly ensures that only authorized users and services can access resources, maintaining the system's integrity and security. In the next module, we will delve into encryption and data protection to further enhance the security of distributed systems.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-03-stream-processing' title="Data Stream Processing">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-02-encryption-protection' title="Encryption and Data Protection">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
