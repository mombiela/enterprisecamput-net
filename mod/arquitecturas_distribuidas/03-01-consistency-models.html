<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consistency Models</title>

    <link rel="alternate" href="https://campusempresa.com/mod/arquitecturas_distribuidas/03-01-modelos-consistencia" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/arquitecturas_distribuidas/03-01-models-consistencia" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/arquitecturas_distribuidas/03-01-consistency-models" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/arquitecturas_distribuidas/03-01-modelos-consistencia" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/arquitecturas_distribuidas/03-01-models-consistencia" class="px-2">CA</a>
					</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='02-03-messaging-queues' title="Messaging and Message Queues">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Consistency Models</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='03-02-consensus-algorithms' title="Consensus Algorithms">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Consistency models are crucial in distributed systems as they define the rules for how data is read and written across multiple nodes. Understanding these models helps in designing systems that balance performance, reliability, and correctness. In this section, we will explore different consistency models, their characteristics, and their trade-offs.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Consistency</strong>: Ensures that all nodes in a distributed system reflect the same data at any given time.</li>
<li><strong>Availability</strong>: The system's ability to respond to read and write requests.</li>
<li><strong>Partition Tolerance</strong>: The system's ability to continue operating despite network partitions.</li>
</ol>
</div><h1><p>Types of Consistency Models</p>
</h1>
<div class='content'></div><h2><ol>
<li>Strong Consistency</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: Ensures that any read operation returns the most recent write for a given piece of data.</li>
<li><strong>Characteristics</strong>:
<ul>
<li>All nodes see the same data at the same time.</li>
<li>Often implemented using techniques like two-phase commit or Paxos.</li>
</ul>
</li>
<li><strong>Trade-offs</strong>:
<ul>
<li>High latency due to synchronization overhead.</li>
<li>Lower availability during network partitions.</li>
</ul>
</li>
</ul>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQc2V1ZG8tY29kZSBmb3IgYSBzdHJvbmdseSBjb25zaXN0ZW50IHN5c3RlbQpjbGFzcyBTdHJvbmdDb25zaXN0ZW5jeToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLmRhdGEgPSB7fQogICAgICAgIHNlbGYubG9jayA9IHRocmVhZGluZy5Mb2NrKCkKCiAgICBkZWYgd3JpdGUoc2VsZiwga2V5LCB2YWx1ZSk6CiAgICAgICAgd2l0aCBzZWxmLmxvY2s6CiAgICAgICAgICAgIHNlbGYuZGF0YVtrZXldID0gdmFsdWUKCiAgICBkZWYgcmVhZChzZWxmLCBrZXkpOgogICAgICAgIHdpdGggc2VsZi5sb2NrOgogICAgICAgICAgICByZXR1cm4gc2VsZi5kYXRhLmdldChrZXkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Pseudo-code for a strongly consistent system
class StrongConsistency:
    def __init__(self):
        self.data = {}
        self.lock = threading.Lock()

    def write(self, key, value):
        with self.lock:
            self.data[key] = value

    def read(self, key):
        with self.lock:
            return self.data.get(key)</pre></div><div class='content'></div><h2><ol start="2">
<li>Eventual Consistency</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: Guarantees that, given enough time, all nodes will converge to the same value.</li>
<li><strong>Characteristics</strong>:
<ul>
<li>Allows for temporary inconsistencies.</li>
<li>Suitable for systems where high availability is crucial.</li>
</ul>
</li>
<li><strong>Trade-offs</strong>:
<ul>
<li>Potential for stale reads.</li>
<li>Requires conflict resolution mechanisms.</li>
</ul>
</li>
</ul>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQc2V1ZG8tY29kZSBmb3IgYW4gZXZlbnR1YWxseSBjb25zaXN0ZW50IHN5c3RlbQpjbGFzcyBFdmVudHVhbGx5Q29uc2lzdGVudDoKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLmRhdGEgPSB7fQogICAgICAgIHNlbGYucmVwbGljYV9kYXRhID0ge30KCiAgICBkZWYgd3JpdGUoc2VsZiwga2V5LCB2YWx1ZSk6CiAgICAgICAgc2VsZi5kYXRhW2tleV0gPSB2YWx1ZQogICAgICAgIHNlbGYucmVwbGljYXRlKGtleSwgdmFsdWUpCgogICAgZGVmIHJlYWQoc2VsZiwga2V5KToKICAgICAgICByZXR1cm4gc2VsZi5kYXRhLmdldChrZXkpCgogICAgZGVmIHJlcGxpY2F0ZShzZWxmLCBrZXksIHZhbHVlKToKICAgICAgICAjIFNpbXVsYXRlIHJlcGxpY2F0aW9uIGRlbGF5CiAgICAgICAgdGltZS5zbGVlcChyYW5kb20udW5pZm9ybSgwLjEsIDEuMCkpCiAgICAgICAgc2VsZi5yZXBsaWNhX2RhdGFba2V5XSA9IHZhbHVl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Pseudo-code for an eventually consistent system
class EventuallyConsistent:
    def __init__(self):
        self.data = {}
        self.replica_data = {}

    def write(self, key, value):
        self.data[key] = value
        self.replicate(key, value)

    def read(self, key):
        return self.data.get(key)

    def replicate(self, key, value):
        # Simulate replication delay
        time.sleep(random.uniform(0.1, 1.0))
        self.replica_data[key] = value</pre></div><div class='content'></div><h2><ol start="3">
<li>Causal Consistency</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: Ensures that operations that are causally related are seen by all nodes in the same order.</li>
<li><strong>Characteristics</strong>:
<ul>
<li>Captures the cause-effect relationship between operations.</li>
<li>More relaxed than strong consistency but stronger than eventual consistency.</li>
</ul>
</li>
<li><strong>Trade-offs</strong>:
<ul>
<li>Requires tracking dependencies between operations.</li>
<li>Increased complexity in implementation.</li>
</ul>
</li>
</ul>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQc2V1ZG8tY29kZSBmb3IgYSBjYXVzYWxseSBjb25zaXN0ZW50IHN5c3RlbQpjbGFzcyBDYXVzYWxDb25zaXN0ZW5jeToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLmRhdGEgPSB7fQogICAgICAgIHNlbGYuZGVwZW5kZW5jeV9ncmFwaCA9IHt9CgogICAgZGVmIHdyaXRlKHNlbGYsIGtleSwgdmFsdWUsIGRlcGVuZGVuY2llcyk6CiAgICAgICAgc2VsZi5kYXRhW2tleV0gPSB2YWx1ZQogICAgICAgIHNlbGYuZGVwZW5kZW5jeV9ncmFwaFtrZXldID0gZGVwZW5kZW5jaWVzCgogICAgZGVmIHJlYWQoc2VsZiwga2V5KToKICAgICAgICByZXR1cm4gc2VsZi5kYXRhLmdldChrZXkpCgogICAgZGVmIGNoZWNrX2RlcGVuZGVuY2llcyhzZWxmLCBrZXkpOgogICAgICAgICMgRW5zdXJlIGFsbCBkZXBlbmRlbmNpZXMgYXJlIG1ldCBiZWZvcmUgYXBwbHlpbmcgdGhlIHdyaXRlCiAgICAgICAgZm9yIGRlcCBpbiBzZWxmLmRlcGVuZGVuY3lfZ3JhcGguZ2V0KGtleSwgW10pOgogICAgICAgICAgICBpZiBkZXAgbm90IGluIHNlbGYuZGF0YToKICAgICAgICAgICAgICAgIHJldHVybiBGYWxzZQogICAgICAgIHJldHVybiBUcnVl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Pseudo-code for a causally consistent system
class CausalConsistency:
    def __init__(self):
        self.data = {}
        self.dependency_graph = {}

    def write(self, key, value, dependencies):
        self.data[key] = value
        self.dependency_graph[key] = dependencies

    def read(self, key):
        return self.data.get(key)

    def check_dependencies(self, key):
        # Ensure all dependencies are met before applying the write
        for dep in self.dependency_graph.get(key, []):
            if dep not in self.data:
                return False
        return True</pre></div><div class='content'></div><h2><ol start="4">
<li>Read-Your-Writes Consistency</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: Guarantees that once a write is performed, the same client will always see that write in subsequent reads.</li>
<li><strong>Characteristics</strong>:
<ul>
<li>Ensures a consistent view for individual clients.</li>
<li>Useful in interactive applications.</li>
</ul>
</li>
<li><strong>Trade-offs</strong>:
<ul>
<li>Does not guarantee global consistency.</li>
<li>May require session tracking.</li>
</ul>
</li>
</ul>
<h4>Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQc2V1ZG8tY29kZSBmb3IgcmVhZC15b3VyLXdyaXRlcyBjb25zaXN0ZW5jeQpjbGFzcyBSZWFkWW91cldyaXRlc0NvbnNpc3RlbmN5OgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuZGF0YSA9IHt9CiAgICAgICAgc2VsZi5jbGllbnRfdmlld3MgPSB7fQoKICAgIGRlZiB3cml0ZShzZWxmLCBjbGllbnRfaWQsIGtleSwgdmFsdWUpOgogICAgICAgIHNlbGYuZGF0YVtrZXldID0gdmFsdWUKICAgICAgICBpZiBjbGllbnRfaWQgbm90IGluIHNlbGYuY2xpZW50X3ZpZXdzOgogICAgICAgICAgICBzZWxmLmNsaWVudF92aWV3c1tjbGllbnRfaWRdID0ge30KICAgICAgICBzZWxmLmNsaWVudF92aWV3c1tjbGllbnRfaWRdW2tleV0gPSB2YWx1ZQoKICAgIGRlZiByZWFkKHNlbGYsIGNsaWVudF9pZCwga2V5KToKICAgICAgICBpZiBjbGllbnRfaWQgaW4gc2VsZi5jbGllbnRfdmlld3MgYW5kIGtleSBpbiBzZWxmLmNsaWVudF92aWV3c1tjbGllbnRfaWRdOgogICAgICAgICAgICByZXR1cm4gc2VsZi5jbGllbnRfdmlld3NbY2xpZW50X2lkXVtrZXldCiAgICAgICAgcmV0dXJuIHNlbGYuZGF0YS5nZXQoa2V5KQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Pseudo-code for read-your-writes consistency
class ReadYourWritesConsistency:
    def __init__(self):
        self.data = {}
        self.client_views = {}

    def write(self, client_id, key, value):
        self.data[key] = value
        if client_id not in self.client_views:
            self.client_views[client_id] = {}
        self.client_views[client_id][key] = value

    def read(self, client_id, key):
        if client_id in self.client_views and key in self.client_views[client_id]:
            return self.client_views[client_id][key]
        return self.data.get(key)</pre></div><div class='content'></div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Implementing Strong Consistency</p>
</h2>
<div class='content'><p>Implement a simple key-value store that ensures strong consistency using locks.</p>
<h4>Solution</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRocmVhZGluZwoKY2xhc3MgU3Ryb25nQ29uc2lzdGVuY3lLVlN0b3JlOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuZGF0YSA9IHt9CiAgICAgICAgc2VsZi5sb2NrID0gdGhyZWFkaW5nLkxvY2soKQoKICAgIGRlZiB3cml0ZShzZWxmLCBrZXksIHZhbHVlKToKICAgICAgICB3aXRoIHNlbGYubG9jazoKICAgICAgICAgICAgc2VsZi5kYXRhW2tleV0gPSB2YWx1ZQoKICAgIGRlZiByZWFkKHNlbGYsIGtleSk6CiAgICAgICAgd2l0aCBzZWxmLmxvY2s6CiAgICAgICAgICAgIHJldHVybiBzZWxmLmRhdGEuZ2V0KGtleSkKCiMgVGVzdCB0aGUgaW1wbGVtZW50YXRpb24Kc3RvcmUgPSBTdHJvbmdDb25zaXN0ZW5jeUtWU3RvcmUoKQpzdG9yZS53cml0ZSgnYScsIDEpCnByaW50KHN0b3JlLnJlYWQoJ2EnKSkgICMgT3V0cHV0OiAx"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import threading

class StrongConsistencyKVStore:
    def __init__(self):
        self.data = {}
        self.lock = threading.Lock()

    def write(self, key, value):
        with self.lock:
            self.data[key] = value

    def read(self, key):
        with self.lock:
            return self.data.get(key)

# Test the implementation
store = StrongConsistencyKVStore()
store.write('a', 1)
print(store.read('a'))  # Output: 1</pre></div><div class='content'></div><h2><p>Exercise 2: Simulating Eventual Consistency</p>
</h2>
<div class='content'><p>Create a key-value store that simulates eventual consistency by introducing a delay in replication.</p>
<h4>Solution</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRpbWUKaW1wb3J0IHJhbmRvbQoKY2xhc3MgRXZlbnR1YWxseUNvbnNpc3RlbnRLVlN0b3JlOgogICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuZGF0YSA9IHt9CiAgICAgICAgc2VsZi5yZXBsaWNhX2RhdGEgPSB7fQoKICAgIGRlZiB3cml0ZShzZWxmLCBrZXksIHZhbHVlKToKICAgICAgICBzZWxmLmRhdGFba2V5XSA9IHZhbHVlCiAgICAgICAgc2VsZi5yZXBsaWNhdGUoa2V5LCB2YWx1ZSkKCiAgICBkZWYgcmVhZChzZWxmLCBrZXkpOgogICAgICAgIHJldHVybiBzZWxmLmRhdGEuZ2V0KGtleSkKCiAgICBkZWYgcmVwbGljYXRlKHNlbGYsIGtleSwgdmFsdWUpOgogICAgICAgICMgU2ltdWxhdGUgcmVwbGljYXRpb24gZGVsYXkKICAgICAgICB0aW1lLnNsZWVwKHJhbmRvbS51bmlmb3JtKDAuMSwgMS4wKSkKICAgICAgICBzZWxmLnJlcGxpY2FfZGF0YVtrZXldID0gdmFsdWUKCiMgVGVzdCB0aGUgaW1wbGVtZW50YXRpb24Kc3RvcmUgPSBFdmVudHVhbGx5Q29uc2lzdGVudEtWU3RvcmUoKQpzdG9yZS53cml0ZSgnYScsIDEpCnByaW50KHN0b3JlLnJlYWQoJ2EnKSkgICMgT3V0cHV0OiAx"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import time
import random

class EventuallyConsistentKVStore:
    def __init__(self):
        self.data = {}
        self.replica_data = {}

    def write(self, key, value):
        self.data[key] = value
        self.replicate(key, value)

    def read(self, key):
        return self.data.get(key)

    def replicate(self, key, value):
        # Simulate replication delay
        time.sleep(random.uniform(0.1, 1.0))
        self.replica_data[key] = value

# Test the implementation
store = EventuallyConsistentKVStore()
store.write('a', 1)
print(store.read('a'))  # Output: 1</pre></div><div class='content'></div><h1><p>Summary</p>
</h1>
<div class='content'><p>In this section, we explored various consistency models used in distributed systems, including strong consistency, eventual consistency, causal consistency, and read-your-writes consistency. Each model has its own characteristics and trade-offs, making them suitable for different types of applications. Understanding these models is essential for designing distributed systems that balance performance, reliability, and correctness.</p>
<p>Next, we will delve into consensus algorithms, which are fundamental for achieving agreement among distributed nodes.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='02-03-messaging-queues' title="Messaging and Message Queues">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='03-02-consensus-algorithms' title="Consensus Algorithms">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
