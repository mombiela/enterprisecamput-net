<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auditing and Logging in PostgreSQL</title>

    <link rel="alternate" href="https://campusempresa.com/mod/postgresql/auditing-and-logging" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/postgresql/auditing-and-logging" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/postgresql/auditing-and-logging" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/postgresql/auditing-and-logging" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/postgresql/auditing-and-logging" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='data-encryption'>&#x25C4;Data Encryption</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Auditing and Logging in PostgreSQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='extensions-and-modules'>Extensions and Modules &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Auditing and logging are crucial components in database management, providing insights into database activities and helping in troubleshooting, performance tuning, and security monitoring. This section will guide you through the basics to advanced techniques for auditing and logging in PostgreSQL.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Logging</strong>: Recording database events, errors, and other significant activities.</li>
<li><strong>Auditing</strong>: Tracking specific actions performed on the database, often for security and compliance purposes.</li>
</ul>
</div><h1>PostgreSQL Logging</h1>
<div class='content'></div><h2>Configuring Logging</h2>
<div class='content'><p>PostgreSQL uses the <code>postgresql.conf</code> file to configure logging. Key parameters include:</p>
<ul>
<li><code>log_destination</code>: Defines where to send log output (e.g., <code>stderr</code>, <code>csvlog</code>, <code>syslog</code>).</li>
<li><code>logging_collector</code>: Enables the collection of log messages into log files.</li>
<li><code>log_directory</code>: Specifies the directory where log files will be stored.</li>
<li><code>log_filename</code>: Defines the naming pattern for log files.</li>
<li><code>log_statement</code>: Controls which SQL statements are logged (<code>none</code>, <code>ddl</code>, <code>mod</code>, <code>all</code>).</li>
</ul>
<p>Example configuration in <code>postgresql.conf</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bG9nX2Rlc3RpbmF0aW9uID0gJ3N0ZGVycicKbG9nZ2luZ19jb2xsZWN0b3IgPSBvbgpsb2dfZGlyZWN0b3J5ID0gJ3BnX2xvZycKbG9nX2ZpbGVuYW1lID0gJ3Bvc3RncmVzcWwtJVktJW0tJWRfJUglTSVTLmxvZycKbG9nX3N0YXRlbWVudCA9ICdhbGwn"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>log_destination = 'stderr'
logging_collector = on
log_directory = 'pg_log'
log_filename = 'postgresql-%Y-%m-%d_%H%M%S.log'
log_statement = 'all'</pre></div><div class='content'></div><h2>Log Levels</h2>
<div class='content'><p>PostgreSQL supports various log levels:</p>
<ul>
<li><code>DEBUG</code></li>
<li><code>INFO</code></li>
<li><code>NOTICE</code></li>
<li><code>WARNING</code></li>
<li><code>ERROR</code></li>
<li><code>LOG</code></li>
<li><code>FATAL</code></li>
<li><code>PANIC</code></li>
</ul>
<p>Example of setting log level:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bG9nX21pbl9tZXNzYWdlcyA9ICdXQVJOSU5HJw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>log_min_messages = 'WARNING'</pre></div><div class='content'></div><h2>Log Rotation</h2>
<div class='content'><p>Log rotation helps manage log file sizes and ensures logs are archived appropriately.</p>
<ul>
<li><code>log_rotation_age</code>: Maximum age of a log file before it is rotated.</li>
<li><code>log_rotation_size</code>: Maximum size of a log file before it is rotated.</li>
</ul>
<p>Example configuration:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bG9nX3JvdGF0aW9uX2FnZSA9IDFkCmxvZ19yb3RhdGlvbl9zaXplID0gMTBNQg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>log_rotation_age = 1d
log_rotation_size = 10MB</pre></div><div class='content'></div><h1>PostgreSQL Auditing</h1>
<div class='content'></div><h2>Using `pgAudit`</h2>
<div class='content'><p><code>pgAudit</code> (PostgreSQL Audit) is an extension that provides detailed session and object audit logging.</p>
<ul>
<li><strong>Installation</strong>: Ensure <code>pgAudit</code> is installed and configured.</li>
<li><strong>Configuration</strong>: Enable <code>pgAudit</code> in <code>postgresql.conf</code>.</li>
</ul>
<p>Example configuration:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2hhcmVkX3ByZWxvYWRfbGlicmFyaWVzID0gJ3BnYXVkaXQnCnBnYXVkaXQubG9nID0gJ2FsbCc="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>shared_preload_libraries = 'pgaudit'
pgaudit.log = 'all'</pre></div><div class='content'></div><h2>Auditing Specific Actions</h2>
<div class='content'><p>You can configure <code>pgAudit</code> to log specific types of actions:</p>
<ul>
<li><code>READ</code>: Logs SELECT statements.</li>
<li><code>WRITE</code>: Logs INSERT, UPDATE, DELETE, and TRUNCATE statements.</li>
<li><code>FUNCTION</code>: Logs function calls.</li>
<li><code>ROLE</code>: Logs role and permission changes.</li>
</ul>
<p>Example configuration:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGdhdWRpdC5sb2cgPSAncmVhZCwgd3JpdGUn"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pgaudit.log = 'read, write'</pre></div><div class='content'></div><h2>Example: Auditing Table Access</h2>
<div class='content'><p>To audit access to a specific table:</p>
<ol>
<li>
<p>Create the table:</p>
<pre><code class="language-sql">CREATE TABLE sensitive_data (
    id SERIAL PRIMARY KEY,
    info TEXT
);
</code></pre>
</li>
<li>
<p>Configure <code>pgAudit</code> to log access:</p>
<pre><code class="language-plaintext">pgaudit.log = 'read, write'
</code></pre>
</li>
<li>
<p>Perform operations and check logs:</p>
<pre><code class="language-sql">INSERT INTO sensitive_data (info) VALUES ('Confidential');
SELECT * FROM sensitive_data;
</code></pre>
</li>
</ol>
<p>Logs will capture these operations, providing an audit trail.</p>
</div><h1>Conclusion</h1>
<div class='content'><p>Auditing and logging in PostgreSQL are essential for maintaining database security, performance, and compliance. By configuring logging settings and using tools like <code>pgAudit</code>, you can gain valuable insights into database activities and ensure that all critical actions are tracked and recorded. This knowledge is fundamental for both database administrators and developers to effectively manage and secure PostgreSQL databases.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='data-encryption'>&#x25C4;Data Encryption</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Auditing and Logging in PostgreSQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='extensions-and-modules'>Extensions and Modules &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
