<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PL/pgSQL and Other Procedural Languages</title>

    <link rel="alternate" href="https://campusempresa.com/mod/postgresql/09-04-plpgsql-and-other-procedural-languages" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/postgresql/09-04-plpgsql-and-other-procedural-languages" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/postgresql/09-04-plpgsql-and-other-procedural-languages" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/postgresql/09-04-plpgsql-and-other-procedural-languages" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/postgresql/09-04-plpgsql-and-other-procedural-languages" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='09-03-foreign-data-wrappers' title="Foreign Data Wrappers">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">PL/pgSQL and Other Procedural Languages</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='10-01-e-commerce-database-design' title="E-commerce Database Design">Next &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this module, we will explore PL/pgSQL, the procedural language for PostgreSQL, and other procedural languages supported by PostgreSQL. Procedural languages allow you to write complex logic directly within the database, enabling more efficient data processing and manipulation.</p>
</div><h1>What is PL/pgSQL?</h1>
<div class='content'><p>PL/pgSQL (Procedural Language/PostgreSQL) is a procedural language supported by PostgreSQL that allows you to write functions and trigger procedures. It extends SQL with control structures such as loops and conditional statements, making it possible to perform more complex operations.</p>
</div><h2>Key Features of PL/pgSQL:</h2>
<div class='content'><ul>
<li><strong>Control Structures</strong>: IF statements, loops, and other control structures.</li>
<li><strong>Error Handling</strong>: Exception handling to manage errors gracefully.</li>
<li><strong>Performance</strong>: Functions written in PL/pgSQL can be more efficient than equivalent SQL queries.</li>
<li><strong>Integration</strong>: Seamless integration with SQL, allowing you to use SQL within PL/pgSQL functions.</li>
</ul>
</div><h1>Creating a PL/pgSQL Function</h1>
<div class='content'><p>Let's start with a simple example of creating a PL/pgSQL function.</p>
</div><h2>Example: Creating a Function to Calculate Factorial</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgRlVOQ1RJT04gY2FsY3VsYXRlX2ZhY3RvcmlhbChuIElOVEVHRVIpClJFVFVSTlMgSU5URUdFUiBBUyAkJApERUNMQVJFCiAgICByZXN1bHQgSU5URUdFUiA6PSAxOwpCRUdJTgogICAgSUYgbiA8IDAgVEhFTgogICAgICAgIFJBSVNFIEVYQ0VQVElPTiAnSW5wdXQgbXVzdCBiZSBhIG5vbi1uZWdhdGl2ZSBpbnRlZ2VyJzsKICAgIEVORCBJRjsKICAgIEZPUiBpIElOIDEuLm4gTE9PUAogICAgICAgIHJlc3VsdCA6PSByZXN1bHQgKiBpOwogICAgRU5EIExPT1A7CiAgICBSRVRVUk4gcmVzdWx0OwpFTkQ7CiQkIExBTkdVQUdFIHBscGdzcWw7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE FUNCTION calculate_factorial(n INTEGER)
RETURNS INTEGER AS $$
DECLARE
    result INTEGER := 1;
BEGIN
    IF n &lt; 0 THEN
        RAISE EXCEPTION 'Input must be a non-negative integer';
    END IF;
    FOR i IN 1..n LOOP
        result := result * i;
    END LOOP;
    RETURN result;
END;
$$ LANGUAGE plpgsql;</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><strong>CREATE OR REPLACE FUNCTION</strong>: Defines a new function or replaces an existing one.</li>
<li><strong>RETURNS INTEGER</strong>: Specifies the return type of the function.</li>
<li><strong>DECLARE</strong>: Section to declare local variables.</li>
<li><strong>BEGIN...END</strong>: Block that contains the function's logic.</li>
<li><strong>RAISE EXCEPTION</strong>: Used for error handling.</li>
<li><strong>FOR...LOOP</strong>: Loop structure to iterate from 1 to n.</li>
</ul>
</div><h1>Using the Function</h1>
<div class='content'><p>You can call the function like this:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGNhbGN1bGF0ZV9mYWN0b3JpYWwoNSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT calculate_factorial(5);</pre></div><div class='content'><p>This will return <code>120</code>, which is the factorial of 5.</p>
</div><h1>Other Procedural Languages in PostgreSQL</h1>
<div class='content'><p>PostgreSQL supports several other procedural languages, including:</p>
</div><h2>PL/Perl</h2>
<div class='content'><p>PL/Perl allows you to write functions in Perl. It is useful for leveraging Perl's text processing capabilities.</p>
<h4>Example: Simple PL/Perl Function</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgRlVOQ1RJT04gaGVsbG9fcGVybChuYW1lIFRFWFQpClJFVFVSTlMgVEVYVCBBUyAkJAogICAgcmV0dXJuICJIZWxsbywgJG5hbWUhIjsKJCQgTEFOR1VBR0UgcGxwZXJsOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE FUNCTION hello_perl(name TEXT)
RETURNS TEXT AS $$
    return &quot;Hello, $name!&quot;;
$$ LANGUAGE plperl;</pre></div><div class='content'></div><h2>PL/Python</h2>
<div class='content'><p>PL/Python allows you to write functions in Python. It is useful for complex data analysis and manipulation.</p>
<h4>Example: Simple PL/Python Function</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgRlVOQ1RJT04gaGVsbG9fcHl0aG9uKG5hbWUgVEVYVCkKUkVUVVJOUyBURVhUIEFTICQkCiAgICByZXR1cm4gIkhlbGxvLCAiICsgbmFtZSArICIhIjsKJCQgTEFOR1VBR0UgcGxweXRob251Ow=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE FUNCTION hello_python(name TEXT)
RETURNS TEXT AS $$
    return &quot;Hello, &quot; + name + &quot;!&quot;;
$$ LANGUAGE plpythonu;</pre></div><div class='content'></div><h2>PL/Tcl</h2>
<div class='content'><p>PL/Tcl allows you to write functions in Tcl. It is useful for those familiar with the Tcl scripting language.</p>
<h4>Example: Simple PL/Tcl Function</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgRlVOQ1RJT04gaGVsbG9fdGNsKG5hbWUgVEVYVCkKUkVUVVJOUyBURVhUIEFTICQkCiAgICByZXR1cm4gIkhlbGxvLCAkbmFtZSEiOwokJCBMQU5HVUFHRSBwbHRjbDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE FUNCTION hello_tcl(name TEXT)
RETURNS TEXT AS $$
    return &quot;Hello, $name!&quot;;
$$ LANGUAGE pltcl;</pre></div><div class='content'></div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Create a PL/pgSQL Function to Calculate Fibonacci Sequence</h2>
<div class='content'><ol>
<li><strong>Objective</strong>: Write a PL/pgSQL function that calculates the nth Fibonacci number.</li>
<li><strong>Function Name</strong>: <code>calculate_fibonacci</code></li>
<li><strong>Input</strong>: An integer <code>n</code></li>
<li><strong>Output</strong>: The nth Fibonacci number</li>
</ol>
</div><h2>Solution:</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgRlVOQ1RJT04gY2FsY3VsYXRlX2ZpYm9uYWNjaShuIElOVEVHRVIpClJFVFVSTlMgSU5URUdFUiBBUyAkJApERUNMQVJFCiAgICBhIElOVEVHRVIgOj0gMDsKICAgIGIgSU5URUdFUiA6PSAxOwogICAgdGVtcCBJTlRFR0VSOwpCRUdJTgogICAgSUYgbiA8IDAgVEhFTgogICAgICAgIFJBSVNFIEVYQ0VQVElPTiAnSW5wdXQgbXVzdCBiZSBhIG5vbi1uZWdhdGl2ZSBpbnRlZ2VyJzsKICAgIEVORCBJRjsKICAgIEZPUiBpIElOIDEuLm4gTE9PUAogICAgICAgIHRlbXAgOj0gYTsKICAgICAgICBhIDo9IGI7CiAgICAgICAgYiA6PSB0ZW1wICsgYjsKICAgIEVORCBMT09QOwogICAgUkVUVVJOIGE7CkVORDsKJCQgTEFOR1VBR0UgcGxwZ3NxbDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE FUNCTION calculate_fibonacci(n INTEGER)
RETURNS INTEGER AS $$
DECLARE
    a INTEGER := 0;
    b INTEGER := 1;
    temp INTEGER;
BEGIN
    IF n &lt; 0 THEN
        RAISE EXCEPTION 'Input must be a non-negative integer';
    END IF;
    FOR i IN 1..n LOOP
        temp := a;
        a := b;
        b := temp + b;
    END LOOP;
    RETURN a;
END;
$$ LANGUAGE plpgsql;</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><strong>Variables</strong>: <code>a</code> and <code>b</code> are used to store the Fibonacci sequence values.</li>
<li><strong>Loop</strong>: Iterates from 1 to n to calculate the Fibonacci number.</li>
</ul>
</div><h2>Testing the Function:</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGNhbGN1bGF0ZV9maWJvbmFjY2koMTApOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT calculate_fibonacci(10);</pre></div><div class='content'><p>This will return <code>55</code>, which is the 10th Fibonacci number.</p>
</div><h1>Conclusion</h1>
<div class='content'><p>In this module, we covered the basics of PL/pgSQL and other procedural languages supported by PostgreSQL. We learned how to create functions using PL/pgSQL and explored examples of PL/Perl, PL/Python, and PL/Tcl. Procedural languages in PostgreSQL provide powerful tools for writing complex logic directly within the database, enhancing performance and efficiency.</p>
<p>Next, we will delve into more advanced features and tools in PostgreSQL, such as PostGIS for geospatial data and full-text search capabilities.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='09-03-foreign-data-wrappers' title="Foreign Data Wrappers">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='10-01-e-commerce-database-design' title="E-commerce Database Design">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
