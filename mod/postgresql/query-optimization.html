<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Query Optimization in PostgreSQL</title>

    <link rel="alternate" href="https://campusempresa.com/mod/postgresql/query-optimization" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/postgresql/query-optimization" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/postgresql/query-optimization" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/postgresql/query-optimization" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/postgresql/query-optimization" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='creating-and-managing-indexes'>&#x25C4;Creating and Managing Indexes</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Query Optimization in PostgreSQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='analyzing-query-performance'>Analyzing Query Performance &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Query Optimization</h1>
<div class='content'><p>Query optimization is a crucial aspect of database management that ensures your queries run efficiently. In PostgreSQL, the query optimizer plays a vital role in determining the most efficient way to execute a query.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Query Planner</strong>: The component of PostgreSQL that determines the most efficient way to execute a query.</li>
<li><strong>Execution Plan</strong>: The strategy chosen by the query planner to execute a query.</li>
<li><strong>Cost-Based Optimization</strong>: PostgreSQL uses a cost-based optimizer that assigns a cost to different execution plans and chooses the one with the lowest cost.</li>
<li><strong>Indexes</strong>: Data structures that improve the speed of data retrieval operations on a database table.</li>
</ul>
</div><h1>Understanding the Query Planner</h1>
<div class='content'><p>The query planner analyzes different possible execution plans and selects the one with the lowest estimated cost.</p>
</div><h2>Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhQTEFJTiBTRUxFQ1QgKiBGUk9NIGVtcGxveWVlcyBXSEVSRSBkZXBhcnRtZW50ID0gJ1NhbGVzJzs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXPLAIN SELECT * FROM employees WHERE department = 'Sales';</pre></div><div class='content'><ul>
<li><code>EXPLAIN</code> is used to display the execution plan of a query without actually executing it.</li>
<li>The output will show the steps PostgreSQL will take to execute the query.</li>
</ul>
</div><h1>Using Indexes</h1>
<div class='content'><p>Indexes are essential for optimizing query performance. They allow the database to find rows more quickly than scanning the entire table.</p>
</div><h2>Creating an Index</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIElOREVYIGlkeF9kZXBhcnRtZW50IE9OIGVtcGxveWVlcyhkZXBhcnRtZW50KTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE INDEX idx_department ON employees(department);</pre></div><div class='content'><ul>
<li>This command creates an index on the <code>department</code> column of the <code>employees</code> table.</li>
<li>After creating the index, queries filtering by <code>department</code> will be faster.</li>
</ul>
</div><h2>Example with Index</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhQTEFJTiBTRUxFQ1QgKiBGUk9NIGVtcGxveWVlcyBXSEVSRSBkZXBhcnRtZW50ID0gJ1NhbGVzJzs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXPLAIN SELECT * FROM employees WHERE department = 'Sales';</pre></div><div class='content'><ul>
<li>After creating the index, the execution plan should show that the index is being used.</li>
</ul>
</div><h1>Analyzing Execution Plans</h1>
<div class='content'><p>Understanding the output of <code>EXPLAIN</code> is crucial for optimizing queries.</p>
</div><h2>Example Output</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U2VxIFNjYW4gb24gZW1wbG95ZWVzICAoY29zdD0wLjAwLi4zNS41MCByb3dzPTUgd2lkdGg9MTAwKQogIEZpbHRlcjogKGRlcGFydG1lbnQgPSAnU2FsZXMnOjp0ZXh0KQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Seq Scan on employees  (cost=0.00..35.50 rows=5 width=100)
  Filter: (department = 'Sales'::text)</pre></div><div class='content'><ul>
<li><strong>Seq Scan</strong>: Indicates a sequential scan, which means the database is scanning the entire table.</li>
<li><strong>Cost</strong>: The estimated cost of the query. Lower costs are better.</li>
<li><strong>Rows</strong>: The estimated number of rows that will be returned.</li>
<li><strong>Width</strong>: The average width of the rows in bytes.</li>
</ul>
</div><h2>Improved Execution Plan with Index</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW5kZXggU2NhbiB1c2luZyBpZHhfZGVwYXJ0bWVudCBvbiBlbXBsb3llZXMgIChjb3N0PTAuMTUuLjguMjAgcm93cz01IHdpZHRoPTEwMCkKICBJbmRleCBDb25kOiAoZGVwYXJ0bWVudCA9ICdTYWxlcyc6OnRleHQp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Index Scan using idx_department on employees  (cost=0.15..8.20 rows=5 width=100)
  Index Cond: (department = 'Sales'::text)</pre></div><div class='content'><ul>
<li><strong>Index Scan</strong>: Indicates that the index is being used, which is generally faster than a sequential scan.</li>
</ul>
</div><h1>Optimizing Joins</h1>
<div class='content'><p>Joins can be expensive operations, and optimizing them is crucial for performance.</p>
</div><h2>Types of Joins</h2>
<div class='content'><ul>
<li><strong>Nested Loop Join</strong>: Suitable for small datasets.</li>
<li><strong>Hash Join</strong>: Efficient for larger datasets.</li>
<li><strong>Merge Join</strong>: Useful when both datasets are sorted.</li>
</ul>
</div><h2>Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhQTEFJTiBTRUxFQ1QgZS5uYW1lLCBkLm5hbWUgCkZST00gZW1wbG95ZWVzIGUgCkpPSU4gZGVwYXJ0bWVudHMgZCBPTiBlLmRlcGFydG1lbnRfaWQgPSBkLmlkOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXPLAIN SELECT e.name, d.name 
FROM employees e 
JOIN departments d ON e.department_id = d.id;</pre></div><div class='content'><ul>
<li>The execution plan will show the type of join used and its cost.</li>
</ul>
</div><h1>Using `ANALYZE` for Better Statistics</h1>
<div class='content'><p>PostgreSQL uses statistics to make decisions about execution plans. Keeping these statistics up-to-date is essential.</p>
</div><h2>Running `ANALYZE`</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QU5BTFlaRSBlbXBsb3llZXM7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ANALYZE employees;</pre></div><div class='content'><ul>
<li>This command updates the statistics for the <code>employees</code> table, helping the query planner make better decisions.</li>
</ul>
</div><h1>Advanced Query Optimization Techniques</h1>
<div class='content'><p>For advanced users, there are several techniques to further optimize queries.</p>
</div><h2>Partitioning</h2>
<div class='content'><p>Partitioning a large table into smaller, more manageable pieces can improve performance.</p>
</div><h2>Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFRBQkxFIGVtcGxveWVlc18yMDIzIFBBUlRJVElPTiBPRiBlbXBsb3llZXMgCkZPUiBWQUxVRVMgRlJPTSAoJzIwMjMtMDEtMDEnKSBUTyAoJzIwMjMtMTItMzEnKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE TABLE employees_2023 PARTITION OF employees 
FOR VALUES FROM ('2023-01-01') TO ('2023-12-31');</pre></div><div class='content'><ul>
<li>This command creates a partition for the <code>employees</code> table for the year 2023.</li>
</ul>
</div><h2>Using `VACUUM`</h2>
<div class='content'><p>Regularly running <code>VACUUM</code> helps in reclaiming storage and updating statistics.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VkFDVVVNIEZVTEwgZW1wbG95ZWVzOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>VACUUM FULL employees;</pre></div><div class='content'><ul>
<li>This command reclaims storage and updates statistics for the <code>employees</code> table.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Query optimization in PostgreSQL involves understanding and utilizing the query planner, creating and using indexes, analyzing execution plans, optimizing joins, and maintaining up-to-date statistics. By following these practices, you can ensure that your queries run efficiently, making the most of PostgreSQL's powerful capabilities.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='creating-and-managing-indexes'>&#x25C4;Creating and Managing Indexes</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Query Optimization in PostgreSQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='analyzing-query-performance'>Analyzing Query Performance &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
