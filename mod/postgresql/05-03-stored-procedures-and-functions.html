<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    <title>Stored Procedures and Functions</title>

    <link rel="alternate" href="https://campusempresa.com/mod/postgresql/05-03-stored-procedures-and-functions" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/postgresql/05-03-stored-procedures-and-functions" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/postgresql/05-03-stored-procedures-and-functions" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>var DEVELOP = window.location.href.indexOf("localhost")!=-1 && true;</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/postgresql/05-03-stored-procedures-and-functions" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/postgresql/05-03-stored-procedures-and-functions" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col" id="left_menu">
					<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

			</div>
		</div>
	</div>
</div>

<!--  
<div class="top-bar container-fluid">
	<div class="container-xxl">
		<nav class="navbar navbar-expand-md p-0">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<div class="navbar-nav me-auto">
							<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

					</div>
				</div>			
							</div>
		</nav>
	</div>
</div>
 -->				<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-02-triggers' title="Triggers">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<h2 style="text-decoration:underline">Stored Procedures and Functions</h2>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-04-transactions-and-concurrency' title="Transactions and Concurrency">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Stored procedures and functions are essential components in PostgreSQL that allow you to encapsulate complex logic within the database. They help in improving performance, maintaining consistency, and reusing code. This section will cover the basics of creating and using stored procedures and functions in PostgreSQL.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li>
<p><strong>Stored Procedures</strong>:</p>
<ul>
<li>A stored procedure is a set of SQL statements that can be executed as a single unit.</li>
<li>They can perform operations such as data manipulation, control flow, and error handling.</li>
<li>Stored procedures do not return a value.</li>
</ul>
</li>
<li>
<p><strong>Functions</strong>:</p>
<ul>
<li>Functions are similar to stored procedures but are designed to return a value.</li>
<li>They can be used in SQL queries, allowing for more flexible and reusable code.</li>
</ul>
</li>
</ol>
</div><h1>Creating Stored Procedures</h1>
<div class='content'></div><h2>Syntax</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSBwcm9jZWR1cmVfbmFtZSAocGFyYW1ldGVyX2xpc3QpCkxBTkdVQUdFIHBscGdzcWwKQVMgJCQKQkVHSU4KICAgIC0tIFByb2NlZHVyZSBsb2dpYyBoZXJlCkVORDsKJCQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE procedure_name (parameter_list)
LANGUAGE plpgsql
AS $$
BEGIN
    -- Procedure logic here
END;
$$;</pre></div><div class='content'></div><h2>Example</h2>
<div class='content'><p>Let's create a stored procedure that inserts a new record into a table called <code>employees</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSBhZGRfZW1wbG95ZWUoCiAgICBlbXBfbmFtZSBWQVJDSEFSLAogICAgZW1wX3Bvc2l0aW9uIFZBUkNIQVIsCiAgICBlbXBfc2FsYXJ5IE5VTUVSSUMKKQpMQU5HVUFHRSBwbHBnc3FsCkFTICQkCkJFR0lOCiAgICBJTlNFUlQgSU5UTyBlbXBsb3llZXMgKG5hbWUsIHBvc2l0aW9uLCBzYWxhcnkpCiAgICBWQUxVRVMgKGVtcF9uYW1lLCBlbXBfcG9zaXRpb24sIGVtcF9zYWxhcnkpOwpFTkQ7CiQkOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE add_employee(
    emp_name VARCHAR,
    emp_position VARCHAR,
    emp_salary NUMERIC
)
LANGUAGE plpgsql
AS $$
BEGIN
    INSERT INTO employees (name, position, salary)
    VALUES (emp_name, emp_position, emp_salary);
END;
$$;</pre></div><div class='content'></div><h2>Executing Stored Procedures</h2>
<div class='content'><p>To execute a stored procedure, use the <code>CALL</code> statement.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q0FMTCBhZGRfZW1wbG95ZWUoJ0pvaG4gRG9lJywgJ1NvZnR3YXJlIEVuZ2luZWVyJywgNzUwMDApOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CALL add_employee('John Doe', 'Software Engineer', 75000);</pre></div><div class='content'></div><h1>Creating Functions</h1>
<div class='content'></div><h2>Syntax</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIGZ1bmN0aW9uX25hbWUgKHBhcmFtZXRlcl9saXN0KQpSRVRVUk5TIHJldHVybl90eXBlCkxBTkdVQUdFIHBscGdzcWwKQVMgJCQKQkVHSU4KICAgIC0tIEZ1bmN0aW9uIGxvZ2ljIGhlcmUKICAgIFJFVFVSTiBzb21lX3ZhbHVlOwpFTkQ7CiQkOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION function_name (parameter_list)
RETURNS return_type
LANGUAGE plpgsql
AS $$
BEGIN
    -- Function logic here
    RETURN some_value;
END;
$$;</pre></div><div class='content'></div><h2>Example</h2>
<div class='content'><p>Let's create a function that calculates the annual salary of an employee based on their monthly salary.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIGNhbGN1bGF0ZV9hbm51YWxfc2FsYXJ5KG1vbnRobHlfc2FsYXJ5IE5VTUVSSUMpClJFVFVSTlMgTlVNRVJJQwpMQU5HVUFHRSBwbHBnc3FsCkFTICQkCkJFR0lOCiAgICBSRVRVUk4gbW9udGhseV9zYWxhcnkgKiAxMjsKRU5EOwokJDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION calculate_annual_salary(monthly_salary NUMERIC)
RETURNS NUMERIC
LANGUAGE plpgsql
AS $$
BEGIN
    RETURN monthly_salary * 12;
END;
$$;</pre></div><div class='content'></div><h2>Using Functions</h2>
<div class='content'><p>Functions can be used in SQL queries. For example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGNhbGN1bGF0ZV9hbm51YWxfc2FsYXJ5KDUwMDApOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT calculate_annual_salary(5000);</pre></div><div class='content'></div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Create a Stored Procedure</h2>
<div class='content'><p><strong>Task</strong>: Create a stored procedure named <code>update_employee_salary</code> that updates the salary of an employee based on their ID.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSB1cGRhdGVfZW1wbG95ZWVfc2FsYXJ5KAogICAgZW1wX2lkIElOVCwKICAgIG5ld19zYWxhcnkgTlVNRVJJQwopCkxBTkdVQUdFIHBscGdzcWwKQVMgJCQKQkVHSU4KICAgIFVQREFURSBlbXBsb3llZXMKICAgIFNFVCBzYWxhcnkgPSBuZXdfc2FsYXJ5CiAgICBXSEVSRSBpZCA9IGVtcF9pZDsKRU5EOwokJDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE update_employee_salary(
    emp_id INT,
    new_salary NUMERIC
)
LANGUAGE plpgsql
AS $$
BEGIN
    UPDATE employees
    SET salary = new_salary
    WHERE id = emp_id;
END;
$$;</pre></div><div class='content'><p><strong>Execution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q0FMTCB1cGRhdGVfZW1wbG95ZWVfc2FsYXJ5KDEsIDgwMDAwKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CALL update_employee_salary(1, 80000);</pre></div><div class='content'></div><h2>Exercise 2: Create a Function</h2>
<div class='content'><p><strong>Task</strong>: Create a function named <code>get_employee_position</code> that returns the position of an employee based on their ID.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIEZVTkNUSU9OIGdldF9lbXBsb3llZV9wb3NpdGlvbihlbXBfaWQgSU5UKQpSRVRVUk5TIFZBUkNIQVIKTEFOR1VBR0UgcGxwZ3NxbApBUyAkJApERUNMQVJFCiAgICBlbXBfcG9zaXRpb24gVkFSQ0hBUjsKQkVHSU4KICAgIFNFTEVDVCBwb3NpdGlvbiBJTlRPIGVtcF9wb3NpdGlvbgogICAgRlJPTSBlbXBsb3llZXMKICAgIFdIRVJFIGlkID0gZW1wX2lkOwogICAgCiAgICBSRVRVUk4gZW1wX3Bvc2l0aW9uOwpFTkQ7CiQkOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE FUNCTION get_employee_position(emp_id INT)
RETURNS VARCHAR
LANGUAGE plpgsql
AS $$
DECLARE
    emp_position VARCHAR;
BEGIN
    SELECT position INTO emp_position
    FROM employees
    WHERE id = emp_id;
    
    RETURN emp_position;
END;
$$;</pre></div><div class='content'><p><strong>Usage</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGdldF9lbXBsb3llZV9wb3NpdGlvbigxKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT get_employee_position(1);</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Syntax Errors</strong>: Ensure that the syntax is correct, especially the use of <code>$$</code> to delimit the procedure or function body.</li>
<li><strong>Parameter Types</strong>: Make sure the parameter types match the data types in the table.</li>
<li><strong>Error Handling</strong>: Consider adding error handling within your procedures and functions to manage exceptions gracefully.</li>
<li><strong>Testing</strong>: Always test your stored procedures and functions with different inputs to ensure they work as expected.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, you learned how to create and use stored procedures and functions in PostgreSQL. These tools are powerful for encapsulating complex logic, improving performance, and maintaining consistency in your database operations. Practice creating and using stored procedures and functions to become proficient in managing database logic within PostgreSQL.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-02-triggers' title="Triggers">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-04-transactions-and-concurrency' title="Transactions and Concurrency">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
	     crossorigin="anonymous"></script>
	<!-- enterprise_campus -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-0611338592562725"
	     data-ad-slot="6914733106"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
	     (adsbygoogle = window.adsbygoogle || []).push({});
	</script>
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>PostgreSQL Course</h1>
<h2>Module 1: Introduction to PostgreSQL</h2>
<ul>
<li><a href="01-01-what-is-postgresql">What is PostgreSQL?</a></li>
<li><a href="01-02-installing-postgresql">Installing PostgreSQL</a></li>
<li><a href="01-03-basic-sql-concepts">Basic SQL Concepts</a></li>
<li><a href="01-04-connecting-to-postgresql">Connecting to PostgreSQL</a></li>
</ul>
<h2>Module 2: Basic SQL Operations</h2>
<ul>
<li><a href="02-01-creating-databases-and-tables">Creating Databases and Tables</a></li>
<li><a href="02-02-inserting-data">Inserting Data</a></li>
<li><a href="02-03-querying-data">Querying Data</a></li>
<li><a href="02-04-updating-data">Updating Data</a></li>
<li><a href="02-05-deleting-data">Deleting Data</a></li>
</ul>
<h2>Module 3: Advanced SQL Queries</h2>
<ul>
<li><a href="03-01-joins">Joins</a></li>
<li><a href="03-02-subqueries">Subqueries</a></li>
<li><a href="03-03-aggregate-functions">Aggregate Functions</a></li>
<li><a href="03-04-window-functions">Window Functions</a></li>
<li><a href="03-05-common-table-expressions">Common Table Expressions (CTEs)</a></li>
</ul>
<h2>Module 4: Database Design and Normalization</h2>
<ul>
<li><a href="04-01-database-design-principles">Database Design Principles</a></li>
<li><a href="04-02-normalization">Normalization</a></li>
<li><a href="04-03-primary-and-foreign-keys">Primary and Foreign Keys</a></li>
<li><a href="04-04-indexes">Indexes</a></li>
</ul>
<h2>Module 5: Advanced PostgreSQL Features</h2>
<ul>
<li><a href="05-01-views">Views</a></li>
<li><a href="05-02-triggers">Triggers</a></li>
<li><a href="05-03-stored-procedures-and-functions">Stored Procedures and Functions</a></li>
<li><a href="05-04-transactions-and-concurrency">Transactions and Concurrency</a></li>
</ul>
<h2>Module 6: Performance Tuning and Optimization</h2>
<ul>
<li><a href="06-01-query-optimization">Query Optimization</a></li>
<li><a href="06-02-indexing-strategies">Indexing Strategies</a></li>
<li><a href="06-03-analyzing-query-performance">Analyzing Query Performance</a></li>
<li><a href="06-04-vacuuming-and-maintenance">Vacuuming and Maintenance</a></li>
</ul>
<h2>Module 7: Security and User Management</h2>
<ul>
<li><a href="07-01-user-roles-and-permissions">User Roles and Permissions</a></li>
<li><a href="07-02-authentication-methods">Authentication Methods</a></li>
<li><a href="07-03-data-encryption">Data Encryption</a></li>
<li><a href="07-04-backup-and-restore">Backup and Restore</a></li>
</ul>
<h2>Module 8: Working with JSON and NoSQL Features</h2>
<ul>
<li><a href="08-01-json-data-types">JSON Data Types</a></li>
<li><a href="08-02-json-functions-and-operators">JSON Functions and Operators</a></li>
<li><a href="08-03-using-postgresql-as-nosql">Using PostgreSQL as a NoSQL Database</a></li>
</ul>
<h2>Module 9: Extensions and Advanced Tools</h2>
<ul>
<li><a href="09-01-postgis-for-geospatial-data">PostGIS for Geospatial Data</a></li>
<li><a href="09-02-full-text-search">Full-Text Search</a></li>
<li><a href="09-03-foreign-data-wrappers">Foreign Data Wrappers</a></li>
<li><a href="09-04-plpgsql-and-other-procedural-languages">PL/pgSQL and Other Procedural Languages</a></li>
</ul>
<h2>Module 10: Case Studies and Real-World Applications</h2>
<ul>
<li><a href="10-01-e-commerce-database-design">E-commerce Database Design</a></li>
<li><a href="10-02-data-warehousing-with-postgresql">Data Warehousing with PostgreSQL</a></li>
<li><a href="10-03-handling-big-data">Handling Big Data</a></li>
<li><a href="10-04-postgresql-in-microservices-architecture">PostgreSQL in Microservices Architecture</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
