<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Generative Adversarial Networks (GAN)</title>

    <link rel="alternate" href="https://campusempresa.com/mod/deep_learning/05-01-redes-generativas-adversariales" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/deep_learning/05-01-redes-generativas-adversariales" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/deep_learning/05-01-generative-adversarial-networks" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=3" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/deep_learning/05-01-redes-generativas-adversariales" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/deep_learning/05-01-redes-generativas-adversariales" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>Building today's and tomorrow's society</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Languages</a>
				 					<a href="/categ/frameworks">Frameworks</a>
				 					<a href="/categ/tech-tools">Tools</a>
				 					<a href="/categ/foundations">Foundations</a>
				 					<a href="/categ/soft-skills">Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-04-sequences-time-series' title="Sequences and Time Series">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Generative Adversarial Networks (GAN)</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-02-autoencoders' title="Autoencoders">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Generative Adversarial Networks (GANs) are a class of machine learning frameworks designed by Ian Goodfellow and his colleagues in 2014. GANs consist of two neural networks, the generator and the discriminator, which compete against each other in a zero-sum game. This competition drives both networks to improve their performance, resulting in the generation of highly realistic data.</p>
</div><h1><p>Key Concepts of GANs</p>
</h1>
<div class='content'></div><h2><ol>
<li>Generator</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Purpose</strong>: The generator's goal is to create data that is indistinguishable from real data.</li>
<li><strong>Input</strong>: Random noise (usually a vector of random numbers).</li>
<li><strong>Output</strong>: Synthetic data (e.g., images, text).</li>
</ul>
</div><h2><ol start="2">
<li>Discriminator</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Purpose</strong>: The discriminator's goal is to distinguish between real data and data generated by the generator.</li>
<li><strong>Input</strong>: Either real data or synthetic data from the generator.</li>
<li><strong>Output</strong>: A probability score indicating the likelihood that the input data is real.</li>
</ul>
</div><h2><ol start="3">
<li>Adversarial Training</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Process</strong>: The generator and discriminator are trained simultaneously. The generator tries to fool the discriminator by producing realistic data, while the discriminator tries to correctly identify real versus fake data.</li>
<li><strong>Loss Functions</strong>:
<ul>
<li><strong>Generator Loss</strong>: Measures how well the generator is at fooling the discriminator.</li>
<li><strong>Discriminator Loss</strong>: Measures how well the discriminator is at distinguishing real data from fake data.</li>
</ul>
</li>
</ul>
</div><h1><p>GAN Architecture</p>
</h1>
<div class='content'><p>The basic architecture of a GAN involves the following steps:</p>
<ol>
<li><strong>Generator Network</strong>: Takes a random noise vector as input and generates synthetic data.</li>
<li><strong>Discriminator Network</strong>: Takes both real data and synthetic data as input and outputs a probability score.</li>
<li><strong>Training Loop</strong>:
<ul>
<li>Train the discriminator on real and fake data.</li>
<li>Train the generator to produce data that the discriminator classifies as real.</li>
</ul>
</li>
</ol>
</div><h2><p>Example GAN Architecture</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmxheWVycyBpbXBvcnQgRGVuc2UsIFJlc2hhcGUsIEZsYXR0ZW4sIExlYWt5UmVMVQpmcm9tIHRlbnNvcmZsb3cua2VyYXMubW9kZWxzIGltcG9ydCBTZXF1ZW50aWFsCgojIEdlbmVyYXRvciBNb2RlbApkZWYgYnVpbGRfZ2VuZXJhdG9yKCk6CiAgICBtb2RlbCA9IFNlcXVlbnRpYWwoKQogICAgbW9kZWwuYWRkKERlbnNlKDI1NiwgaW5wdXRfZGltPTEwMCkpCiAgICBtb2RlbC5hZGQoTGVha3lSZUxVKGFscGhhPTAuMikpCiAgICBtb2RlbC5hZGQoRGVuc2UoNTEyKSkKICAgIG1vZGVsLmFkZChMZWFreVJlTFUoYWxwaGE9MC4yKSkKICAgIG1vZGVsLmFkZChEZW5zZSgxMDI0KSkKICAgIG1vZGVsLmFkZChMZWFreVJlTFUoYWxwaGE9MC4yKSkKICAgIG1vZGVsLmFkZChEZW5zZSgyOCAqIDI4ICogMSwgYWN0aXZhdGlvbj0ndGFuaCcpKQogICAgbW9kZWwuYWRkKFJlc2hhcGUoKDI4LCAyOCwgMSkpKQogICAgcmV0dXJuIG1vZGVsCgojIERpc2NyaW1pbmF0b3IgTW9kZWwKZGVmIGJ1aWxkX2Rpc2NyaW1pbmF0b3IoKToKICAgIG1vZGVsID0gU2VxdWVudGlhbCgpCiAgICBtb2RlbC5hZGQoRmxhdHRlbihpbnB1dF9zaGFwZT0oMjgsIDI4LCAxKSkpCiAgICBtb2RlbC5hZGQoRGVuc2UoNTEyKSkKICAgIG1vZGVsLmFkZChMZWFreVJlTFUoYWxwaGE9MC4yKSkKICAgIG1vZGVsLmFkZChEZW5zZSgyNTYpKQogICAgbW9kZWwuYWRkKExlYWt5UmVMVShhbHBoYT0wLjIpKQogICAgbW9kZWwuYWRkKERlbnNlKDEsIGFjdGl2YXRpb249J3NpZ21vaWQnKSkKICAgIHJldHVybiBtb2RlbAoKIyBCdWlsZCBhbmQgY29tcGlsZSB0aGUgbW9kZWxzCmdlbmVyYXRvciA9IGJ1aWxkX2dlbmVyYXRvcigpCmRpc2NyaW1pbmF0b3IgPSBidWlsZF9kaXNjcmltaW5hdG9yKCkKZGlzY3JpbWluYXRvci5jb21waWxlKGxvc3M9J2JpbmFyeV9jcm9zc2VudHJvcHknLCBvcHRpbWl6ZXI9J2FkYW0nLCBtZXRyaWNzPVsnYWNjdXJhY3knXSkKCiMgQ29tYmluZWQgTW9kZWwKZGlzY3JpbWluYXRvci50cmFpbmFibGUgPSBGYWxzZQpnYW5faW5wdXQgPSB0Zi5rZXJhcy5JbnB1dChzaGFwZT0oMTAwLCkpCmdlbmVyYXRlZF9pbWFnZSA9IGdlbmVyYXRvcihnYW5faW5wdXQpCmdhbl9vdXRwdXQgPSBkaXNjcmltaW5hdG9yKGdlbmVyYXRlZF9pbWFnZSkKZ2FuID0gdGYua2VyYXMuTW9kZWwoZ2FuX2lucHV0LCBnYW5fb3V0cHV0KQpnYW4uY29tcGlsZShsb3NzPSdiaW5hcnlfY3Jvc3NlbnRyb3B5Jywgb3B0aW1pemVyPSdhZGFtJyk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras.layers import Dense, Reshape, Flatten, LeakyReLU
from tensorflow.keras.models import Sequential

# Generator Model
def build_generator():
    model = Sequential()
    model.add(Dense(256, input_dim=100))
    model.add(LeakyReLU(alpha=0.2))
    model.add(Dense(512))
    model.add(LeakyReLU(alpha=0.2))
    model.add(Dense(1024))
    model.add(LeakyReLU(alpha=0.2))
    model.add(Dense(28 * 28 * 1, activation='tanh'))
    model.add(Reshape((28, 28, 1)))
    return model

# Discriminator Model
def build_discriminator():
    model = Sequential()
    model.add(Flatten(input_shape=(28, 28, 1)))
    model.add(Dense(512))
    model.add(LeakyReLU(alpha=0.2))
    model.add(Dense(256))
    model.add(LeakyReLU(alpha=0.2))
    model.add(Dense(1, activation='sigmoid'))
    return model

# Build and compile the models
generator = build_generator()
discriminator = build_discriminator()
discriminator.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])

# Combined Model
discriminator.trainable = False
gan_input = tf.keras.Input(shape=(100,))
generated_image = generator(gan_input)
gan_output = discriminator(generated_image)
gan = tf.keras.Model(gan_input, gan_output)
gan.compile(loss='binary_crossentropy', optimizer='adam')</pre></div><div class='content'></div><h2><p>Training the GAN</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCgojIExvYWQgYW5kIHByZXByb2Nlc3MgdGhlIGRhdGEKKFhfdHJhaW4sIF8pLCAoXywgXykgPSB0Zi5rZXJhcy5kYXRhc2V0cy5tbmlzdC5sb2FkX2RhdGEoKQpYX3RyYWluID0gWF90cmFpbiAvIDEyNy41IC0gMS4wICAjIE5vcm1hbGl6ZSB0byBbLTEsIDFdClhfdHJhaW4gPSBucC5leHBhbmRfZGltcyhYX3RyYWluLCBheGlzPTMpCgojIFRyYWluaW5nIHBhcmFtZXRlcnMKZXBvY2hzID0gMTAwMDAKYmF0Y2hfc2l6ZSA9IDY0CmhhbGZfYmF0Y2ggPSBiYXRjaF9zaXplIC8vIDIKCmZvciBlcG9jaCBpbiByYW5nZShlcG9jaHMpOgogICAgIyBUcmFpbiBEaXNjcmltaW5hdG9yCiAgICBpZHggPSBucC5yYW5kb20ucmFuZGludCgwLCBYX3RyYWluLnNoYXBlWzBdLCBoYWxmX2JhdGNoKQogICAgcmVhbF9pbWFnZXMgPSBYX3RyYWluW2lkeF0KICAgIG5vaXNlID0gbnAucmFuZG9tLm5vcm1hbCgwLCAxLCAoaGFsZl9iYXRjaCwgMTAwKSkKICAgIGZha2VfaW1hZ2VzID0gZ2VuZXJhdG9yLnByZWRpY3Qobm9pc2UpCiAgICAKICAgIGRfbG9zc19yZWFsID0gZGlzY3JpbWluYXRvci50cmFpbl9vbl9iYXRjaChyZWFsX2ltYWdlcywgbnAub25lcygoaGFsZl9iYXRjaCwgMSkpKQogICAgZF9sb3NzX2Zha2UgPSBkaXNjcmltaW5hdG9yLnRyYWluX29uX2JhdGNoKGZha2VfaW1hZ2VzLCBucC56ZXJvcygoaGFsZl9iYXRjaCwgMSkpKQogICAgZF9sb3NzID0gMC41ICogbnAuYWRkKGRfbG9zc19yZWFsLCBkX2xvc3NfZmFrZSkKICAgIAogICAgIyBUcmFpbiBHZW5lcmF0b3IKICAgIG5vaXNlID0gbnAucmFuZG9tLm5vcm1hbCgwLCAxLCAoYmF0Y2hfc2l6ZSwgMTAwKSkKICAgIHZhbGlkX3kgPSBucC5hcnJheShbMV0gKiBiYXRjaF9zaXplKQogICAgZ19sb3NzID0gZ2FuLnRyYWluX29uX2JhdGNoKG5vaXNlLCB2YWxpZF95KQogICAgCiAgICAjIFByaW50IHRoZSBwcm9ncmVzcwogICAgaWYgZXBvY2ggJSAxMDAwID09IDA6CiAgICAgICAgcHJpbnQoZiJ7ZXBvY2h9IFtEIGxvc3M6IHtkX2xvc3NbMF19LCBhY2MuOiB7MTAwKmRfbG9zc1sxXX0lXSBbRyBsb3NzOiB7Z19sb3NzfV0iKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np

# Load and preprocess the data
(X_train, _), (_, _) = tf.keras.datasets.mnist.load_data()
X_train = X_train / 127.5 - 1.0  # Normalize to [-1, 1]
X_train = np.expand_dims(X_train, axis=3)

# Training parameters
epochs = 10000
batch_size = 64
half_batch = batch_size // 2

for epoch in range(epochs):
    # Train Discriminator
    idx = np.random.randint(0, X_train.shape[0], half_batch)
    real_images = X_train[idx]
    noise = np.random.normal(0, 1, (half_batch, 100))
    fake_images = generator.predict(noise)
    
    d_loss_real = discriminator.train_on_batch(real_images, np.ones((half_batch, 1)))
    d_loss_fake = discriminator.train_on_batch(fake_images, np.zeros((half_batch, 1)))
    d_loss = 0.5 * np.add(d_loss_real, d_loss_fake)
    
    # Train Generator
    noise = np.random.normal(0, 1, (batch_size, 100))
    valid_y = np.array([1] * batch_size)
    g_loss = gan.train_on_batch(noise, valid_y)
    
    # Print the progress
    if epoch % 1000 == 0:
        print(f&quot;{epoch} [D loss: {d_loss[0]}, acc.: {100*d_loss[1]}%] [G loss: {g_loss}]&quot;)</pre></div><div class='content'></div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Implement a Simple GAN</p>
</h2>
<div class='content'><p><strong>Objective</strong>: Implement a simple GAN to generate handwritten digits similar to the MNIST dataset.</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Build the generator and discriminator models.</li>
<li>Compile the discriminator.</li>
<li>Combine the models to form the GAN.</li>
<li>Train the GAN on the MNIST dataset.</li>
</ol>
<p><strong>Solution</strong>:
Refer to the example GAN architecture and training code provided above. Use the provided code as a template to build and train your GAN.</p>
</div><h2><p>Common Mistakes and Tips</p>
</h2>
<div class='content'><ul>
<li><strong>Unstable Training</strong>: GANs can be notoriously difficult to train. If the generator or discriminator loss oscillates wildly, consider using techniques like learning rate decay, batch normalization, or gradient clipping.</li>
<li><strong>Mode Collapse</strong>: This occurs when the generator produces limited varieties of outputs. To mitigate this, try using techniques like minibatch discrimination or unrolled GANs.</li>
<li><strong>Hyperparameter Tuning</strong>: The performance of GANs is highly sensitive to hyperparameters. Experiment with different learning rates, batch sizes, and network architectures.</li>
</ul>
</div><h1><p>Summary</p>
</h1>
<div class='content'><p>In this section, we covered the fundamental concepts of Generative Adversarial Networks (GANs), including the roles of the generator and discriminator, the adversarial training process, and the architecture of a simple GAN. We also provided a practical example and exercise to help solidify your understanding. GANs are a powerful tool in deep learning, capable of generating highly realistic data, and are widely used in various applications such as image generation, text generation, and more.</p>
<p>In the next section, we will explore Autoencoders, another type of neural network used for unsupervised learning and data compression.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-04-sequences-time-series' title="Sequences and Time Series">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-02-autoencoders' title="Autoencoders">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
