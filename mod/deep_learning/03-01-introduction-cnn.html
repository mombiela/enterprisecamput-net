<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction to CNN</title>

    <link rel="alternate" href="https://campusempresa.com/mod/deep_learning/03-01-introduccion-cnn" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/deep_learning/03-01-introduccion-cnn" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/deep_learning/03-01-introduction-cnn" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/deep_learning/03-01-introduccion-cnn" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/deep_learning/03-01-introduccion-cnn" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Programming Languages</a>
				 					<a href="/categ/frameworks">Frameworks and Libraries</a>
				 					<a href="/categ/tech-tools">Technical Tools</a>
				 					<a href="/categ/foundations">Theoretical Foundations</a>
				 					<a href="/categ/soft-skills">Social Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='02-04-optimization-loss-function' title="Optimization and Loss Function">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Introduction to CNN</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='03-02-convolutional-pooling-layers' title="Convolutional and Pooling Layers">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1><p>What is a Convolutional Neural Network (CNN)?</p>
</h1>
<div class='content'><p>A Convolutional Neural Network (CNN) is a class of deep neural networks, most commonly applied to analyzing visual imagery. CNNs are designed to automatically and adaptively learn spatial hierarchies of features through backpropagation by using multiple building blocks, such as convolution layers, pooling layers, and fully connected layers.</p>
</div><h2><p>Key Concepts of CNN</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Convolutional Layers</strong>:</p>
<ul>
<li>These layers apply a convolution operation to the input, passing the result to the next layer.</li>
<li>Convolutional layers are composed of a set of learnable filters (kernels) that slide over the input data to produce feature maps.</li>
</ul>
</li>
<li>
<p><strong>Pooling Layers</strong>:</p>
<ul>
<li>Pooling (or subsampling) layers reduce the spatial dimensions (width and height) of the input volume.</li>
<li>Common types of pooling are max pooling and average pooling.</li>
</ul>
</li>
<li>
<p><strong>Fully Connected Layers</strong>:</p>
<ul>
<li>These layers are similar to the layers in a traditional neural network where each neuron is connected to every neuron in the previous layer.</li>
<li>They are used to combine the features learned by convolutional and pooling layers to make final predictions.</li>
</ul>
</li>
</ol>
</div><h2><p>Structure of a CNN</p>
</h2>
<div class='content'><p>A typical CNN architecture consists of a series of convolutional and pooling layers, followed by one or more fully connected layers. Here is a simplified structure:</p>
<ol>
<li><strong>Input Layer</strong>: The raw pixel values of the image.</li>
<li><strong>Convolutional Layer</strong>: Applies a set of filters to the input image to create feature maps.</li>
<li><strong>Activation Function (ReLU)</strong>: Applies a non-linear activation function to increase the network's capacity to learn complex patterns.</li>
<li><strong>Pooling Layer</strong>: Reduces the dimensionality of the feature maps.</li>
<li><strong>Fully Connected Layer</strong>: Combines the features to classify the input image.</li>
</ol>
</div><h2><p>Example of a Simple CNN</p>
</h2>
<div class='content'><p>Below is an example of a simple CNN implemented in Python using the Keras library:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLm1vZGVscyBpbXBvcnQgU2VxdWVudGlhbApmcm9tIHRlbnNvcmZsb3cua2VyYXMubGF5ZXJzIGltcG9ydCBDb252MkQsIE1heFBvb2xpbmcyRCwgRmxhdHRlbiwgRGVuc2UKCiMgSW5pdGlhbGl6ZSB0aGUgbW9kZWwKbW9kZWwgPSBTZXF1ZW50aWFsKCkKCiMgQWRkIGEgY29udm9sdXRpb25hbCBsYXllciB3aXRoIDMyIGZpbHRlcnMsIGEga2VybmVsIHNpemUgb2YgM3gzLCBhbmQgUmVMVSBhY3RpdmF0aW9uCm1vZGVsLmFkZChDb252MkQoMzIsICgzLCAzKSwgYWN0aXZhdGlvbj0ncmVsdScsIGlucHV0X3NoYXBlPSg2NCwgNjQsIDMpKSkKCiMgQWRkIGEgbWF4IHBvb2xpbmcgbGF5ZXIgd2l0aCBhIHBvb2wgc2l6ZSBvZiAyeDIKbW9kZWwuYWRkKE1heFBvb2xpbmcyRChwb29sX3NpemU9KDIsIDIpKSkKCiMgQWRkIGFub3RoZXIgY29udm9sdXRpb25hbCBsYXllciB3aXRoIDY0IGZpbHRlcnMKbW9kZWwuYWRkKENvbnYyRCg2NCwgKDMsIDMpLCBhY3RpdmF0aW9uPSdyZWx1JykpCgojIEFkZCBhbm90aGVyIG1heCBwb29saW5nIGxheWVyCm1vZGVsLmFkZChNYXhQb29saW5nMkQocG9vbF9zaXplPSgyLCAyKSkpCgojIEZsYXR0ZW4gdGhlIGZlYXR1cmUgbWFwcyB0byBhIDFEIHZlY3Rvcgptb2RlbC5hZGQoRmxhdHRlbigpKQoKIyBBZGQgYSBmdWxseSBjb25uZWN0ZWQgbGF5ZXIgd2l0aCAxMjggdW5pdHMgYW5kIFJlTFUgYWN0aXZhdGlvbgptb2RlbC5hZGQoRGVuc2UoMTI4LCBhY3RpdmF0aW9uPSdyZWx1JykpCgojIEFkZCB0aGUgb3V0cHV0IGxheWVyIHdpdGggYSBzb2Z0bWF4IGFjdGl2YXRpb24gZm9yIGNsYXNzaWZpY2F0aW9uCm1vZGVsLmFkZChEZW5zZSgxMCwgYWN0aXZhdGlvbj0nc29mdG1heCcpKQoKIyBDb21waWxlIHRoZSBtb2RlbAptb2RlbC5jb21waWxlKG9wdGltaXplcj0nYWRhbScsIGxvc3M9J2NhdGVnb3JpY2FsX2Nyb3NzZW50cm9weScsIG1ldHJpY3M9WydhY2N1cmFjeSddKQoKIyBTdW1tYXJ5IG9mIHRoZSBtb2RlbAptb2RlbC5zdW1tYXJ5KCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv2D, MaxPooling2D, Flatten, Dense

# Initialize the model
model = Sequential()

# Add a convolutional layer with 32 filters, a kernel size of 3x3, and ReLU activation
model.add(Conv2D(32, (3, 3), activation='relu', input_shape=(64, 64, 3)))

# Add a max pooling layer with a pool size of 2x2
model.add(MaxPooling2D(pool_size=(2, 2)))

# Add another convolutional layer with 64 filters
model.add(Conv2D(64, (3, 3), activation='relu'))

# Add another max pooling layer
model.add(MaxPooling2D(pool_size=(2, 2)))

# Flatten the feature maps to a 1D vector
model.add(Flatten())

# Add a fully connected layer with 128 units and ReLU activation
model.add(Dense(128, activation='relu'))

# Add the output layer with a softmax activation for classification
model.add(Dense(10, activation='softmax'))

# Compile the model
model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])

# Summary of the model
model.summary()</pre></div><div class='content'></div><h2><p>Explanation of the Code</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Conv2D Layer</strong>:</p>
<ul>
<li><code>32</code> filters of size <code>3x3</code> are applied to the input image.</li>
<li><code>activation='relu'</code> applies the ReLU activation function.</li>
<li><code>input_shape=(64, 64, 3)</code> specifies the input shape of the images (64x64 pixels with 3 color channels).</li>
</ul>
</li>
<li>
<p><strong>MaxPooling2D Layer</strong>:</p>
<ul>
<li><code>pool_size=(2, 2)</code> reduces the spatial dimensions by taking the maximum value in each <code>2x2</code> block.</li>
</ul>
</li>
<li>
<p><strong>Flatten Layer</strong>:</p>
<ul>
<li>Converts the 2D feature maps into a 1D vector to be fed into the fully connected layers.</li>
</ul>
</li>
<li>
<p><strong>Dense Layer</strong>:</p>
<ul>
<li><code>128</code> units with ReLU activation function.</li>
<li>The final <code>Dense</code> layer has <code>10</code> units with a softmax activation function for multi-class classification.</li>
</ul>
</li>
</ol>
</div><h2><p>Practical Exercise</p>
</h2>
<div class='content'><p><strong>Exercise</strong>: Implement a CNN to classify images from the CIFAR-10 dataset.</p>
<ol>
<li>Load the CIFAR-10 dataset.</li>
<li>Preprocess the data (normalize the pixel values).</li>
<li>Build a CNN model similar to the example above.</li>
<li>Train the model on the training data.</li>
<li>Evaluate the model on the test data.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmRhdGFzZXRzIGltcG9ydCBjaWZhcjEwCmZyb20gdGVuc29yZmxvdy5rZXJhcy51dGlscyBpbXBvcnQgdG9fY2F0ZWdvcmljYWwKCiMgTG9hZCB0aGUgQ0lGQVItMTAgZGF0YXNldAooeF90cmFpbiwgeV90cmFpbiksICh4X3Rlc3QsIHlfdGVzdCkgPSBjaWZhcjEwLmxvYWRfZGF0YSgpCgojIE5vcm1hbGl6ZSB0aGUgcGl4ZWwgdmFsdWVzCnhfdHJhaW4gPSB4X3RyYWluLmFzdHlwZSgnZmxvYXQzMicpIC8gMjU1LjAKeF90ZXN0ID0geF90ZXN0LmFzdHlwZSgnZmxvYXQzMicpIC8gMjU1LjAKCiMgQ29udmVydCBsYWJlbHMgdG8gb25lLWhvdCBlbmNvZGluZwp5X3RyYWluID0gdG9fY2F0ZWdvcmljYWwoeV90cmFpbiwgMTApCnlfdGVzdCA9IHRvX2NhdGVnb3JpY2FsKHlfdGVzdCwgMTApCgojIEluaXRpYWxpemUgdGhlIG1vZGVsCm1vZGVsID0gU2VxdWVudGlhbCgpCgojIEFkZCBjb252b2x1dGlvbmFsIGFuZCBwb29saW5nIGxheWVycwptb2RlbC5hZGQoQ29udjJEKDMyLCAoMywgMyksIGFjdGl2YXRpb249J3JlbHUnLCBpbnB1dF9zaGFwZT0oMzIsIDMyLCAzKSkpCm1vZGVsLmFkZChNYXhQb29saW5nMkQocG9vbF9zaXplPSgyLCAyKSkpCm1vZGVsLmFkZChDb252MkQoNjQsICgzLCAzKSwgYWN0aXZhdGlvbj0ncmVsdScpKQptb2RlbC5hZGQoTWF4UG9vbGluZzJEKHBvb2xfc2l6ZT0oMiwgMikpKQptb2RlbC5hZGQoRmxhdHRlbigpKQptb2RlbC5hZGQoRGVuc2UoMTI4LCBhY3RpdmF0aW9uPSdyZWx1JykpCm1vZGVsLmFkZChEZW5zZSgxMCwgYWN0aXZhdGlvbj0nc29mdG1heCcpKQoKIyBDb21waWxlIHRoZSBtb2RlbAptb2RlbC5jb21waWxlKG9wdGltaXplcj0nYWRhbScsIGxvc3M9J2NhdGVnb3JpY2FsX2Nyb3NzZW50cm9weScsIG1ldHJpY3M9WydhY2N1cmFjeSddKQoKIyBUcmFpbiB0aGUgbW9kZWwKbW9kZWwuZml0KHhfdHJhaW4sIHlfdHJhaW4sIGVwb2Nocz0xMCwgYmF0Y2hfc2l6ZT0zMiwgdmFsaWRhdGlvbl9kYXRhPSh4X3Rlc3QsIHlfdGVzdCkpCgojIEV2YWx1YXRlIHRoZSBtb2RlbApsb3NzLCBhY2N1cmFjeSA9IG1vZGVsLmV2YWx1YXRlKHhfdGVzdCwgeV90ZXN0KQpwcmludChmJ1Rlc3QgYWNjdXJhY3k6IHthY2N1cmFjeTouMmZ9Jyk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras.datasets import cifar10
from tensorflow.keras.utils import to_categorical

# Load the CIFAR-10 dataset
(x_train, y_train), (x_test, y_test) = cifar10.load_data()

# Normalize the pixel values
x_train = x_train.astype('float32') / 255.0
x_test = x_test.astype('float32') / 255.0

# Convert labels to one-hot encoding
y_train = to_categorical(y_train, 10)
y_test = to_categorical(y_test, 10)

# Initialize the model
model = Sequential()

# Add convolutional and pooling layers
model.add(Conv2D(32, (3, 3), activation='relu', input_shape=(32, 32, 3)))
model.add(MaxPooling2D(pool_size=(2, 2)))
model.add(Conv2D(64, (3, 3), activation='relu'))
model.add(MaxPooling2D(pool_size=(2, 2)))
model.add(Flatten())
model.add(Dense(128, activation='relu'))
model.add(Dense(10, activation='softmax'))

# Compile the model
model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])

# Train the model
model.fit(x_train, y_train, epochs=10, batch_size=32, validation_data=(x_test, y_test))

# Evaluate the model
loss, accuracy = model.evaluate(x_test, y_test)
print(f'Test accuracy: {accuracy:.2f}')</pre></div><div class='content'></div><h2><p>Common Mistakes and Tips</p>
</h2>
<div class='content'><ul>
<li><strong>Overfitting</strong>: Ensure you have enough data or use techniques like dropout and data augmentation to prevent overfitting.</li>
<li><strong>Learning Rate</strong>: Choosing an appropriate learning rate is crucial. Too high can cause the model to converge too quickly to a suboptimal solution, and too low can make the training process very slow.</li>
<li><strong>Batch Size</strong>: Experiment with different batch sizes to find the optimal one for your dataset and model.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we introduced Convolutional Neural Networks (CNNs), discussed their key components, and provided a practical example of building a simple CNN using Keras. We also included an exercise to implement a CNN for classifying images from the CIFAR-10 dataset. Understanding CNNs is fundamental for tackling various computer vision tasks, and this knowledge will be built upon in the subsequent modules.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='02-04-optimization-loss-function' title="Optimization and Loss Function">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='03-02-convolutional-pooling-layers' title="Convolutional and Pooling Layers">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
