<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project 3: Anomaly Detection with Autoencoders</title>

    <link rel="alternate" href="https://campusempresa.com/mod/deep_learning/proyecto-deteccion-anomalias-autoencoders" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/deep_learning/proyecto-deteccion-anomalias-autoencoders" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/deep_learning/proyecto-deteccion-anomalias-autoencoders" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/deep_learning/proyecto-deteccion-anomalias-autoencoders" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/deep_learning/proyecto-deteccion-anomalias-autoencoders" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this project, we will explore how to use autoencoders, a class of neural networks, for anomaly detection in data. Autoencoders are especially useful for this task due to their ability to learn compressed representations of data and reconstruct them. Anomalies can be identified as those data points that the autoencoder cannot reconstruct adequately.</p>
</div><h1>Project Objectives</h1>
<div class='content'><ul>
<li>Understand the concept of autoencoders and their architecture.</li>
<li>Implement an autoencoder using a deep learning library (TensorFlow/Keras).</li>
<li>Apply the autoencoder to detect anomalies in a dataset.</li>
<li>Evaluate the performance of the anomaly detection model.</li>
</ul>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Autoencoders</strong>: Neural networks designed to learn an efficient representation (encoding) of a dataset, typically for dimensionality reduction or anomaly detection.</li>
<li><strong>Encoder</strong>: Part of the autoencoder that reduces the dimensionality of the input data.</li>
<li><strong>Decoder</strong>: Part of the autoencoder that reconstructs the data from the compressed representation.</li>
<li><strong>Reconstruction Loss</strong>: Metric that measures the difference between the original data and the data reconstructed by the autoencoder.</li>
</ul>
</div><h1>Autoencoder Architecture</h1>
<div class='content'><p>A typical autoencoder consists of two main parts:</p>
<ol>
<li>
<p><strong>Encoder</strong>:</p>
<ul>
<li>Reduces the dimensionality of the input data.</li>
<li>Composed of dense (fully connected) or convolutional layers.</li>
</ul>
</li>
<li>
<p><strong>Decoder</strong>:</p>
<ul>
<li>Reconstructs the data from the compressed representation.</li>
<li>Composed of dense or convolutional layers that &quot;undo&quot; the compression performed by the encoder.</li>
</ul>
</li>
</ol>
</div><h2>Example Architecture</h2>
<div class='content'><p>| Part        | Layer Type         | Input Dimensions       | Output Dimensions      |
|-------------|--------------------|------------------------|------------------------|
| Encoder     | Dense              | 784                    | 128                    |
| Encoder     | Dense              | 128                    | 64                     |
| Encoder     | Dense              | 64                     | 32                     |
| Decoder     | Dense              | 32                     | 64                     |
| Decoder     | Dense              | 64                     | 128                    |
| Decoder     | Dense              | 128                    | 784                    |</p>
</div><h1>Autoencoder Implementation</h1>
<div class='content'></div><h2>Step 1: Import Necessary Libraries</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCB0ZW5zb3JmbG93IGFzIHRmCmZyb20gdGVuc29yZmxvdy5rZXJhcy5tb2RlbHMgaW1wb3J0IE1vZGVsCmZyb20gdGVuc29yZmxvdy5rZXJhcy5sYXllcnMgaW1wb3J0IElucHV0LCBEZW5zZQpmcm9tIHRlbnNvcmZsb3cua2VyYXMuZGF0YXNldHMgaW1wb3J0IG1uaXN0"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np
import tensorflow as tf
from tensorflow.keras.models import Model
from tensorflow.keras.layers import Input, Dense
from tensorflow.keras.datasets import mnist</pre></div><div class='content'></div><h2>Step 2: Prepare the Data</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMb2FkIHRoZSBNTklTVCBkYXRhc2V0Cih4X3RyYWluLCBfKSwgKHhfdGVzdCwgXykgPSBtbmlzdC5sb2FkX2RhdGEoKQoKIyBOb3JtYWxpemUgdGhlIGRhdGEKeF90cmFpbiA9IHhfdHJhaW4uYXN0eXBlKCdmbG9hdDMyJykgLyAyNTUuCnhfdGVzdCA9IHhfdGVzdC5hc3R5cGUoJ2Zsb2F0MzInKSAvIDI1NS4KCiMgRmxhdHRlbiB0aGUgaW1hZ2VzICgyOHgyOCkgdG8gdmVjdG9ycyBvZiA3ODQgZWxlbWVudHMKeF90cmFpbiA9IHhfdHJhaW4ucmVzaGFwZSgobGVuKHhfdHJhaW4pLCBucC5wcm9kKHhfdHJhaW4uc2hhcGVbMTpdKSkpCnhfdGVzdCA9IHhfdGVzdC5yZXNoYXBlKChsZW4oeF90ZXN0KSwgbnAucHJvZCh4X3Rlc3Quc2hhcGVbMTpdKSkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Load the MNIST dataset
(x_train, _), (x_test, _) = mnist.load_data()

# Normalize the data
x_train = x_train.astype('float32') / 255.
x_test = x_test.astype('float32') / 255.

# Flatten the images (28x28) to vectors of 784 elements
x_train = x_train.reshape((len(x_train), np.prod(x_train.shape[1:])))
x_test = x_test.reshape((len(x_test), np.prod(x_test.shape[1:])))</pre></div><div class='content'></div><h2>Step 3: Define the Autoencoder Architecture</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEZWZpbmUgdGhlIGlucHV0IHNpemUKaW5wdXRfZGltID0geF90cmFpbi5zaGFwZVsxXQoKIyBEZWZpbmUgdGhlIGVuY29kZXIKaW5wdXRfbGF5ZXIgPSBJbnB1dChzaGFwZT0oaW5wdXRfZGltLCkpCmVuY29kZXIgPSBEZW5zZSgxMjgsIGFjdGl2YXRpb249J3JlbHUnKShpbnB1dF9sYXllcikKZW5jb2RlciA9IERlbnNlKDY0LCBhY3RpdmF0aW9uPSdyZWx1JykoZW5jb2RlcikKZW5jb2RlciA9IERlbnNlKDMyLCBhY3RpdmF0aW9uPSdyZWx1JykoZW5jb2RlcikKCiMgRGVmaW5lIHRoZSBkZWNvZGVyCmRlY29kZXIgPSBEZW5zZSg2NCwgYWN0aXZhdGlvbj0ncmVsdScpKGVuY29kZXIpCmRlY29kZXIgPSBEZW5zZSgxMjgsIGFjdGl2YXRpb249J3JlbHUnKShkZWNvZGVyKQpkZWNvZGVyID0gRGVuc2UoaW5wdXRfZGltLCBhY3RpdmF0aW9uPSdzaWdtb2lkJykoZGVjb2RlcikKCiMgQ3JlYXRlIHRoZSBhdXRvZW5jb2RlciBtb2RlbAphdXRvZW5jb2RlciA9IE1vZGVsKGlucHV0cz1pbnB1dF9sYXllciwgb3V0cHV0cz1kZWNvZGVyKQphdXRvZW5jb2Rlci5jb21waWxlKG9wdGltaXplcj0nYWRhbScsIGxvc3M9J2JpbmFyeV9jcm9zc2VudHJvcHknKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Define the input size
input_dim = x_train.shape[1]

# Define the encoder
input_layer = Input(shape=(input_dim,))
encoder = Dense(128, activation='relu')(input_layer)
encoder = Dense(64, activation='relu')(encoder)
encoder = Dense(32, activation='relu')(encoder)

# Define the decoder
decoder = Dense(64, activation='relu')(encoder)
decoder = Dense(128, activation='relu')(decoder)
decoder = Dense(input_dim, activation='sigmoid')(decoder)

# Create the autoencoder model
autoencoder = Model(inputs=input_layer, outputs=decoder)
autoencoder.compile(optimizer='adam', loss='binary_crossentropy')</pre></div><div class='content'></div><h2>Step 4: Train the Autoencoder</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXV0b2VuY29kZXIuZml0KHhfdHJhaW4sIHhfdHJhaW4sCiAgICAgICAgICAgICAgICBlcG9jaHM9NTAsCiAgICAgICAgICAgICAgICBiYXRjaF9zaXplPTI1NiwKICAgICAgICAgICAgICAgIHNodWZmbGU9VHJ1ZSwKICAgICAgICAgICAgICAgIHZhbGlkYXRpb25fZGF0YT0oeF90ZXN0LCB4X3Rlc3QpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>autoencoder.fit(x_train, x_train,
                epochs=50,
                batch_size=256,
                shuffle=True,
                validation_data=(x_test, x_test))</pre></div><div class='content'></div><h2>Step 5: Evaluate the Model and Detect Anomalies</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBHZXQgdGhlIHJlY29uc3RydWN0aW9ucyBvZiB0aGUgdGVzdCBzZXQKcmVjb25zdHJ1Y3Rpb25zID0gYXV0b2VuY29kZXIucHJlZGljdCh4X3Rlc3QpCgojIENhbGN1bGF0ZSB0aGUgcmVjb25zdHJ1Y3Rpb24gbG9zcwpyZWNvbnN0cnVjdGlvbl9sb3NzID0gbnAubWVhbihucC5zcXVhcmUoeF90ZXN0IC0gcmVjb25zdHJ1Y3Rpb25zKSwgYXhpcz0xKQoKIyBEZWZpbmUgYSB0aHJlc2hvbGQgZm9yIGFub21hbHkgZGV0ZWN0aW9uCnRocmVzaG9sZCA9IG5wLnBlcmNlbnRpbGUocmVjb25zdHJ1Y3Rpb25fbG9zcywgOTUpCgojIElkZW50aWZ5IHRoZSBhbm9tYWxpZXMKYW5vbWFsaWVzID0gcmVjb25zdHJ1Y3Rpb25fbG9zcyA+IHRocmVzaG9sZAoKcHJpbnQoZidOdW1iZXIgb2YgYW5vbWFsaWVzIGRldGVjdGVkOiB7bnAuc3VtKGFub21hbGllcyl9Jyk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Get the reconstructions of the test set
reconstructions = autoencoder.predict(x_test)

# Calculate the reconstruction loss
reconstruction_loss = np.mean(np.square(x_test - reconstructions), axis=1)

# Define a threshold for anomaly detection
threshold = np.percentile(reconstruction_loss, 95)

# Identify the anomalies
anomalies = reconstruction_loss &gt; threshold

print(f'Number of anomalies detected: {np.sum(anomalies)}')</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this project, we have learned how to use autoencoders for anomaly detection. We covered everything from defining the autoencoder architecture to its implementation and evaluation. Autoencoders are a powerful tool in the field of deep learning, especially for anomaly detection tasks, where they can identify data that does not fit the patterns learned during training.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
