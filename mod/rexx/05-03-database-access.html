<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Access with REXX</title>

    <link rel="alternate" href="https://campusempresa.com/mod/rexx/05-03-database-access" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/rexx/05-03-database-access" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/rexx/05-03-database-access" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/rexx/05-03-database-access" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/rexx/05-03-database-access" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-creating-utilities' title="Creating REXX Utilities">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Database Access with REXX</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-web-programming' title="Web Programming with REXX">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to access and manipulate databases using REXX. This is an essential skill for creating applications that require data storage and retrieval. We will cover the following topics:</p>
<ol>
<li><strong>Introduction to Database Access</strong></li>
<li><strong>Setting Up the Environment</strong></li>
<li><strong>Connecting to a Database</strong></li>
<li><strong>Executing SQL Queries</strong></li>
<li><strong>Handling Query Results</strong></li>
<li><strong>Error Handling in Database Operations</strong></li>
<li><strong>Practical Exercises</strong></li>
</ol>
</div><h1>1. Introduction to Database Access</h1>
<div class='content'><p>REXX can interact with databases using various interfaces and drivers. The most common method is through ODBC (Open Database Connectivity), which allows REXX to connect to different database management systems (DBMS) like MySQL, PostgreSQL, SQL Server, and others.</p>
</div><h1>2. Setting Up the Environment</h1>
<div class='content'><p>Before you can access a database, you need to set up your environment:</p>
<ol>
<li><strong>Install ODBC Drivers</strong>: Ensure that the ODBC drivers for your specific DBMS are installed on your system.</li>
<li><strong>Configure ODBC Data Source</strong>: Set up an ODBC Data Source Name (DSN) that points to your database.</li>
</ol>
</div><h2>Example: Setting Up ODBC for MySQL</h2>
<div class='content'><ol>
<li><strong>Install MySQL ODBC Driver</strong>: Download and install the MySQL ODBC driver from the MySQL website.</li>
<li><strong>Configure DSN</strong>:
<ul>
<li>Open ODBC Data Source Administrator.</li>
<li>Add a new DSN for MySQL.</li>
<li>Provide the necessary connection details (server, database, user, password).</li>
</ul>
</li>
</ol>
</div><h1>3. Connecting to a Database</h1>
<div class='content'><p>To connect to a database in REXX, you will use the <code>SQLConnect</code> function. Here is a basic example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogUkVYWCBzY3JpcHQgdG8gY29ubmVjdCB0byBhIGRhdGFiYXNlICovCmRzbiA9ICJNeURhdGFTb3VyY2UiCnVzZXIgPSAidXNlcm5hbWUiCnBhc3N3b3JkID0gInBhc3N3b3JkIgoKY2FsbCBTUUxDb25uZWN0IGRzbiwgdXNlciwgcGFzc3dvcmQKCmlmIFNRTENPREUgPSAwIHRoZW4KICAgIHNheSAiQ29ubmVjdGlvbiBzdWNjZXNzZnVsISIKZWxzZQogICAgc2F5ICJDb25uZWN0aW9uIGZhaWxlZC4gU1FMQ09ERToiIFNRTENPREU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* REXX script to connect to a database */
dsn = &quot;MyDataSource&quot;
user = &quot;username&quot;
password = &quot;password&quot;

call SQLConnect dsn, user, password

if SQLCODE = 0 then
    say &quot;Connection successful!&quot;
else
    say &quot;Connection failed. SQLCODE:&quot; SQLCODE</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><code>dsn</code>, <code>user</code>, and <code>password</code> are variables holding the connection details.</li>
<li><code>SQLConnect</code> is a function that attempts to connect to the database using the provided details.</li>
<li><code>SQLCODE</code> is a variable that holds the result of the connection attempt (0 indicates success).</li>
</ul>
</div><h1>4. Executing SQL Queries</h1>
<div class='content'><p>Once connected, you can execute SQL queries using the <code>SQLExecDirect</code> function. Here is an example of executing a simple SELECT query:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogUkVYWCBzY3JpcHQgdG8gZXhlY3V0ZSBhIFNFTEVDVCBxdWVyeSAqLwpxdWVyeSA9ICJTRUxFQ1QgKiBGUk9NIGVtcGxveWVlcyIKCmNhbGwgU1FMRXhlY0RpcmVjdCBxdWVyeQoKaWYgU1FMQ09ERSA9IDAgdGhlbgogICAgc2F5ICJRdWVyeSBleGVjdXRlZCBzdWNjZXNzZnVsbHkhIgplbHNlCiAgICBzYXkgIlF1ZXJ5IGV4ZWN1dGlvbiBmYWlsZWQuIFNRTENPREU6IiBTUUxDT0RF"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* REXX script to execute a SELECT query */
query = &quot;SELECT * FROM employees&quot;

call SQLExecDirect query

if SQLCODE = 0 then
    say &quot;Query executed successfully!&quot;
else
    say &quot;Query execution failed. SQLCODE:&quot; SQLCODE</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><code>query</code> holds the SQL statement to be executed.</li>
<li><code>SQLExecDirect</code> executes the SQL statement.</li>
<li><code>SQLCODE</code> indicates the success or failure of the query execution.</li>
</ul>
</div><h1>5. Handling Query Results</h1>
<div class='content'><p>To handle the results of a query, you will use the <code>SQLFetch</code> and <code>SQLGetData</code> functions. Here is an example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogUkVYWCBzY3JpcHQgdG8gZmV0Y2ggYW5kIGRpc3BsYXkgcXVlcnkgcmVzdWx0cyAqLwpxdWVyeSA9ICJTRUxFQ1QgaWQsIG5hbWUgRlJPTSBlbXBsb3llZXMiCgpjYWxsIFNRTEV4ZWNEaXJlY3QgcXVlcnkKCmlmIFNRTENPREUgPSAwIHRoZW4KICAgIGRvIHdoaWxlIFNRTEZldGNoKCkgPSAwCiAgICAgICAgY2FsbCBTUUxHZXREYXRhIDEsIGlkCiAgICAgICAgY2FsbCBTUUxHZXREYXRhIDIsIG5hbWUKICAgICAgICBzYXkgIklEOiIgaWQgIk5hbWU6IiBuYW1lCiAgICBlbmQKZWxzZQogICAgc2F5ICJRdWVyeSBleGVjdXRpb24gZmFpbGVkLiBTUUxDT0RFOiIgU1FMQ09ERQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* REXX script to fetch and display query results */
query = &quot;SELECT id, name FROM employees&quot;

call SQLExecDirect query

if SQLCODE = 0 then
    do while SQLFetch() = 0
        call SQLGetData 1, id
        call SQLGetData 2, name
        say &quot;ID:&quot; id &quot;Name:&quot; name
    end
else
    say &quot;Query execution failed. SQLCODE:&quot; SQLCODE</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><code>SQLFetch</code> retrieves the next row of the result set.</li>
<li><code>SQLGetData</code> retrieves the data from the specified column (1 for <code>id</code>, 2 for <code>name</code>).</li>
<li>The loop continues until all rows are fetched.</li>
</ul>
</div><h1>6. Error Handling in Database Operations</h1>
<div class='content'><p>Proper error handling is crucial in database operations. Always check the <code>SQLCODE</code> after each database operation to ensure it was successful. Here is an example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogUkVYWCBzY3JpcHQgd2l0aCBlcnJvciBoYW5kbGluZyAqLwpxdWVyeSA9ICJTRUxFQ1QgKiBGUk9NIGVtcGxveWVlcyIKCmNhbGwgU1FMRXhlY0RpcmVjdCBxdWVyeQoKaWYgU1FMQ09ERSBcPSAwIHRoZW4KICAgIGRvCiAgICAgICAgc2F5ICJFcnJvciBleGVjdXRpbmcgcXVlcnkuIFNRTENPREU6IiBTUUxDT0RFCiAgICAgICAgZXhpdAogICAgZW5kCgpkbyB3aGlsZSBTUUxGZXRjaCgpID0gMAogICAgY2FsbCBTUUxHZXREYXRhIDEsIGlkCiAgICBjYWxsIFNRTEdldERhdGEgMiwgbmFtZQogICAgc2F5ICJJRDoiIGlkICJOYW1lOiIgbmFtZQplbmQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* REXX script with error handling */
query = &quot;SELECT * FROM employees&quot;

call SQLExecDirect query

if SQLCODE \= 0 then
    do
        say &quot;Error executing query. SQLCODE:&quot; SQLCODE
        exit
    end

do while SQLFetch() = 0
    call SQLGetData 1, id
    call SQLGetData 2, name
    say &quot;ID:&quot; id &quot;Name:&quot; name
end</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li>The script checks <code>SQLCODE</code> after executing the query.</li>
<li>If <code>SQLCODE</code> is not 0, an error message is displayed, and the script exits.</li>
</ul>
</div><h1>7. Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Connect to a Database</h2>
<div class='content'><p><strong>Task</strong>: Write a REXX script to connect to a database using your DSN, username, and password. Display a success or failure message based on the connection result.</p>
</div><h2>Solution:</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogUkVYWCBzY3JpcHQgdG8gY29ubmVjdCB0byBhIGRhdGFiYXNlICovCmRzbiA9ICJNeURhdGFTb3VyY2UiCnVzZXIgPSAidXNlcm5hbWUiCnBhc3N3b3JkID0gInBhc3N3b3JkIgoKY2FsbCBTUUxDb25uZWN0IGRzbiwgdXNlciwgcGFzc3dvcmQKCmlmIFNRTENPREUgPSAwIHRoZW4KICAgIHNheSAiQ29ubmVjdGlvbiBzdWNjZXNzZnVsISIKZWxzZQogICAgc2F5ICJDb25uZWN0aW9uIGZhaWxlZC4gU1FMQ09ERToiIFNRTENPREU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* REXX script to connect to a database */
dsn = &quot;MyDataSource&quot;
user = &quot;username&quot;
password = &quot;password&quot;

call SQLConnect dsn, user, password

if SQLCODE = 0 then
    say &quot;Connection successful!&quot;
else
    say &quot;Connection failed. SQLCODE:&quot; SQLCODE</pre></div><div class='content'></div><h2>Exercise 2: Execute a SELECT Query</h2>
<div class='content'><p><strong>Task</strong>: Write a REXX script to execute a SELECT query that retrieves all rows from a table named <code>products</code>. Display the results.</p>
</div><h2>Solution:</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogUkVYWCBzY3JpcHQgdG8gZXhlY3V0ZSBhIFNFTEVDVCBxdWVyeSBhbmQgZGlzcGxheSByZXN1bHRzICovCnF1ZXJ5ID0gIlNFTEVDVCAqIEZST00gcHJvZHVjdHMiCgpjYWxsIFNRTEV4ZWNEaXJlY3QgcXVlcnkKCmlmIFNRTENPREUgPSAwIHRoZW4KICAgIGRvIHdoaWxlIFNRTEZldGNoKCkgPSAwCiAgICAgICAgY2FsbCBTUUxHZXREYXRhIDEsIHByb2R1Y3RfaWQKICAgICAgICBjYWxsIFNRTEdldERhdGEgMiwgcHJvZHVjdF9uYW1lCiAgICAgICAgY2FsbCBTUUxHZXREYXRhIDMsIHByaWNlCiAgICAgICAgc2F5ICJQcm9kdWN0IElEOiIgcHJvZHVjdF9pZCAiTmFtZToiIHByb2R1Y3RfbmFtZSAiUHJpY2U6IiBwcmljZQogICAgZW5kCmVsc2UKICAgIHNheSAiUXVlcnkgZXhlY3V0aW9uIGZhaWxlZC4gU1FMQ09ERToiIFNRTENPREU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* REXX script to execute a SELECT query and display results */
query = &quot;SELECT * FROM products&quot;

call SQLExecDirect query

if SQLCODE = 0 then
    do while SQLFetch() = 0
        call SQLGetData 1, product_id
        call SQLGetData 2, product_name
        call SQLGetData 3, price
        say &quot;Product ID:&quot; product_id &quot;Name:&quot; product_name &quot;Price:&quot; price
    end
else
    say &quot;Query execution failed. SQLCODE:&quot; SQLCODE</pre></div><div class='content'></div><h2>Exercise 3: Error Handling</h2>
<div class='content'><p><strong>Task</strong>: Modify the script from Exercise 2 to include error handling. Ensure that any errors during query execution or fetching results are properly handled and displayed.</p>
</div><h2>Solution:</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogUkVYWCBzY3JpcHQgd2l0aCBlcnJvciBoYW5kbGluZyBmb3IgU0VMRUNUIHF1ZXJ5ICovCnF1ZXJ5ID0gIlNFTEVDVCAqIEZST00gcHJvZHVjdHMiCgpjYWxsIFNRTEV4ZWNEaXJlY3QgcXVlcnkKCmlmIFNRTENPREUgXD0gMCB0aGVuCiAgICBkbwogICAgICAgIHNheSAiRXJyb3IgZXhlY3V0aW5nIHF1ZXJ5LiBTUUxDT0RFOiIgU1FMQ09ERQogICAgICAgIGV4aXQKICAgIGVuZAoKZG8gd2hpbGUgU1FMRmV0Y2goKSA9IDAKICAgIGNhbGwgU1FMR2V0RGF0YSAxLCBwcm9kdWN0X2lkCiAgICBjYWxsIFNRTEdldERhdGEgMiwgcHJvZHVjdF9uYW1lCiAgICBjYWxsIFNRTEdldERhdGEgMywgcHJpY2UKICAgIHNheSAiUHJvZHVjdCBJRDoiIHByb2R1Y3RfaWQgIk5hbWU6IiBwcm9kdWN0X25hbWUgIlByaWNlOiIgcHJpY2UKZW5k"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* REXX script with error handling for SELECT query */
query = &quot;SELECT * FROM products&quot;

call SQLExecDirect query

if SQLCODE \= 0 then
    do
        say &quot;Error executing query. SQLCODE:&quot; SQLCODE
        exit
    end

do while SQLFetch() = 0
    call SQLGetData 1, product_id
    call SQLGetData 2, product_name
    call SQLGetData 3, price
    say &quot;Product ID:&quot; product_id &quot;Name:&quot; product_name &quot;Price:&quot; price
end</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, you learned how to access and manipulate databases using REXX. You covered setting up the environment, connecting to a database, executing SQL queries, handling query results, and implementing error handling. These skills are essential for creating robust applications that interact with databases. In the next section, you will learn about web programming with REXX, which will further expand your ability to create dynamic and interactive applications.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-creating-utilities' title="Creating REXX Utilities">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-web-programming' title="Web Programming with REXX">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
