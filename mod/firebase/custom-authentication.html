<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Authentication in Firebase</title>

    <link rel="alternate" href="https://campusempresa.com/mod/firebase/custom-authentication" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/firebase/custom-authentication" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/firebase/custom-authentication" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/firebase/custom-authentication" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/firebase/custom-authentication" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='anonymous-authentication'>&#x25C4;Anonymous Authentication</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Custom Authentication in Firebase</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-firestore'>Introduction to Firestore &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Firebase Authentication provides backend services to help authenticate users in your app. While Firebase offers several built-in authentication methods, there are cases where you need more control over the authentication process. This is where custom authentication comes in.</p>
</div><h1>Introduction to Custom Authentication</h1>
<div class='content'><p>Custom Authentication allows you to integrate your own authentication system with Firebase. This means you can use your existing user database, third-party authentication providers, or any other method to authenticate users.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Custom Token</strong>: A JWT (JSON Web Token) that you generate on your server to authenticate users.</li>
<li><strong>Firebase Admin SDK</strong>: A set of server libraries that help you generate custom tokens.</li>
<li><strong>Client SDK</strong>: Firebase SDK used on the client side to authenticate users with the custom token.</li>
</ul>
</div><h1>Setting Up Firebase Admin SDK</h1>
<div class='content'><p>To generate custom tokens, you need to set up the Firebase Admin SDK in your server environment.</p>
</div><h2>Steps to Set Up Firebase Admin SDK</h2>
<div class='content'><ol>
<li>
<p><strong>Install the Firebase Admin SDK</strong>:</p>
<pre><code class="language-bash">npm install firebase-admin --save
</code></pre>
</li>
<li>
<p><strong>Initialize the SDK</strong>:</p>
<pre><code class="language-javascript">const admin = require('firebase-admin');
const serviceAccount = require('path/to/serviceAccountKey.json');

admin.initializeApp({
  credential: admin.credential.cert(serviceAccount)
});
</code></pre>
</li>
<li>
<p><strong>Generate a Custom Token</strong>:</p>
<pre><code class="language-javascript">const uid = 'some-unique-identifier';

admin.auth().createCustomToken(uid)
  .then((customToken) =&gt; {
    // Send token back to client
  })
  .catch((error) =&gt; {
    console.log('Error creating custom token:', error);
  });
</code></pre>
</li>
</ol>
</div><h1>Authenticating Users with Custom Tokens</h1>
<div class='content'><p>Once you have generated a custom token on your server, you need to send it to the client and use it to authenticate with Firebase.</p>
</div><h2>Steps to Authenticate with Custom Tokens</h2>
<div class='content'><ol>
<li>
<p><strong>Receive the Custom Token on the Client</strong>:</p>
<pre><code class="language-javascript">// Assume you received the custom token from your server
const customToken = 'YOUR_CUSTOM_TOKEN';
</code></pre>
</li>
<li>
<p><strong>Sign In with the Custom Token</strong>:</p>
<pre><code class="language-javascript">firebase.auth().signInWithCustomToken(customToken)
  .then((userCredential) =&gt; {
    // User is signed in
    console.log('User signed in:', userCredential.user);
  })
  .catch((error) =&gt; {
    console.log('Error signing in with custom token:', error);
  });
</code></pre>
</li>
</ol>
</div><h1>Advanced Custom Authentication Scenarios</h1>
<div class='content'></div><h2>Using Third-Party Authentication Providers</h2>
<div class='content'><p>You can integrate third-party authentication providers like OAuth, SAML, or any other provider with Firebase Custom Authentication.</p>
<h4>Example: Integrating OAuth</h4>
<ol>
<li>
<p><strong>Authenticate with OAuth Provider</strong>:</p>
<pre><code class="language-javascript">// Example using OAuth2.0
const oauth2Client = new OAuth2Client(CLIENT_ID, CLIENT_SECRET, REDIRECT_URI);
const { tokens } = await oauth2Client.getToken(code);
oauth2Client.setCredentials(tokens);
</code></pre>
</li>
<li>
<p><strong>Generate Custom Token with OAuth UID</strong>:</p>
<pre><code class="language-javascript">const uid = 'oauth-unique-identifier';

admin.auth().createCustomToken(uid)
  .then((customToken) =&gt; {
    // Send token back to client
  })
  .catch((error) =&gt; {
    console.log('Error creating custom token:', error);
  });
</code></pre>
</li>
</ol>
</div><h2>Custom Claims</h2>
<div class='content'><p>Custom claims allow you to add additional information to the user's ID token, which can be used to control access to different parts of your app.</p>
<h4>Adding Custom Claims</h4>
<ol>
<li>
<p><strong>Set Custom Claims</strong>:</p>
<pre><code class="language-javascript">const uid = 'some-unique-identifier';
const customClaims = {
  admin: true,
  premiumAccount: true
};

admin.auth().setCustomUserClaims(uid, customClaims)
  .then(() =&gt; {
    // The new custom claims will propagate to the user's ID token the next time a new one is issued.
  })
  .catch((error) =&gt; {
    console.log('Error setting custom claims:', error);
  });
</code></pre>
</li>
<li>
<p><strong>Access Custom Claims on the Client</strong>:</p>
<pre><code class="language-javascript">firebase.auth().currentUser.getIdTokenResult()
  .then((idTokenResult) =&gt; {
    // Confirm the user is an Admin.
    if (!!idTokenResult.claims.admin) {
      console.log('User is an admin');
    }
  })
  .catch((error) =&gt; {
    console.log('Error getting ID token result:', error);
  });
</code></pre>
</li>
</ol>
</div><h1>Conclusion</h1>
<div class='content'><p>Custom Authentication in Firebase provides the flexibility to integrate your own authentication system, use third-party providers, and add custom claims to control access within your app. By understanding how to generate and use custom tokens, you can leverage Firebase's powerful authentication features while maintaining control over your user authentication process.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='anonymous-authentication'>&#x25C4;Anonymous Authentication</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Custom Authentication in Firebase</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-firestore'>Introduction to Firestore &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
