<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Handling Notifications</title>

    <link rel="alternate" href="https://campusempresa.com/mod/firebase/06-03-handling-notifications" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/firebase/06-03-handling-notifications" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/firebase/06-03-handling-notifications" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/firebase/06-03-handling-notifications" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/firebase/06-03-handling-notifications" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Programming Languages</a>
				 					<a href="/categ/frameworks">Frameworks and Libraries</a>
				 					<a href="/categ/tech-tools">Technical Tools</a>
				 					<a href="/categ/foundations">Theoretical Foundations</a>
				 					<a href="/categ/soft-skills">Social Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-02-sending-notifications' title="Sending Notifications">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Handling Notifications</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-04-advanced-messaging-features' title="Advanced Messaging Features">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to handle notifications in a Firebase-enabled application. Handling notifications effectively ensures that users receive timely and relevant information, enhancing their overall experience with your app.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Notification Types</strong>:</p>
<ul>
<li><strong>Foreground Notifications</strong>: Notifications received while the app is in the foreground.</li>
<li><strong>Background Notifications</strong>: Notifications received while the app is in the background or closed.</li>
</ul>
</li>
<li>
<p><strong>Notification Payload</strong>:</p>
<ul>
<li><strong>Notification Messages</strong>: Automatically displayed by the device's system UI.</li>
<li><strong>Data Messages</strong>: Handled by the app's code, providing more flexibility.</li>
</ul>
</li>
<li>
<p><strong>Notification Channels</strong> (Android only): Used to categorize notifications and manage their behavior.</p>
</li>
</ol>
</div><h1><p>Handling Foreground Notifications</p>
</h1>
<div class='content'><p>When your app is in the foreground, you need to handle notifications manually to display them to the user. This can be done using Firebase Cloud Messaging (FCM) service.</p>
</div><h2><p>Example: Handling Foreground Notifications in Android</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIE15RmlyZWJhc2VNZXNzYWdpbmdTZXJ2aWNlIGV4dGVuZHMgRmlyZWJhc2VNZXNzYWdpbmdTZXJ2aWNlIHsKCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIG9uTWVzc2FnZVJlY2VpdmVkKFJlbW90ZU1lc3NhZ2UgcmVtb3RlTWVzc2FnZSkgewogICAgICAgIC8vIENoZWNrIGlmIHRoZSBtZXNzYWdlIGNvbnRhaW5zIGEgbm90aWZpY2F0aW9uIHBheWxvYWQuCiAgICAgICAgaWYgKHJlbW90ZU1lc3NhZ2UuZ2V0Tm90aWZpY2F0aW9uKCkgIT0gbnVsbCkgewogICAgICAgICAgICAvLyBEaXNwbGF5IHRoZSBub3RpZmljYXRpb24KICAgICAgICAgICAgc2hvd05vdGlmaWNhdGlvbihyZW1vdGVNZXNzYWdlLmdldE5vdGlmaWNhdGlvbigpLmdldFRpdGxlKCksIHJlbW90ZU1lc3NhZ2UuZ2V0Tm90aWZpY2F0aW9uKCkuZ2V0Qm9keSgpKTsKICAgICAgICB9CgogICAgICAgIC8vIENoZWNrIGlmIHRoZSBtZXNzYWdlIGNvbnRhaW5zIGEgZGF0YSBwYXlsb2FkLgogICAgICAgIGlmIChyZW1vdGVNZXNzYWdlLmdldERhdGEoKS5zaXplKCkgPiAwKSB7CiAgICAgICAgICAgIC8vIEhhbmRsZSB0aGUgZGF0YSBtZXNzYWdlCiAgICAgICAgICAgIGhhbmRsZURhdGFNZXNzYWdlKHJlbW90ZU1lc3NhZ2UuZ2V0RGF0YSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIHNob3dOb3RpZmljYXRpb24oU3RyaW5nIHRpdGxlLCBTdHJpbmcgbWVzc2FnZUJvZHkpIHsKICAgICAgICBOb3RpZmljYXRpb25Db21wYXQuQnVpbGRlciBub3RpZmljYXRpb25CdWlsZGVyID0gbmV3IE5vdGlmaWNhdGlvbkNvbXBhdC5CdWlsZGVyKHRoaXMsICJkZWZhdWx0X2NoYW5uZWxfaWQiKQogICAgICAgICAgICAgICAgLnNldFNtYWxsSWNvbihSLmRyYXdhYmxlLmljX25vdGlmaWNhdGlvbikKICAgICAgICAgICAgICAgIC5zZXRDb250ZW50VGl0bGUodGl0bGUpCiAgICAgICAgICAgICAgICAuc2V0Q29udGVudFRleHQobWVzc2FnZUJvZHkpCiAgICAgICAgICAgICAgICAuc2V0QXV0b0NhbmNlbCh0cnVlKQogICAgICAgICAgICAgICAgLnNldFByaW9yaXR5KE5vdGlmaWNhdGlvbkNvbXBhdC5QUklPUklUWV9ISUdIKTsKCiAgICAgICAgTm90aWZpY2F0aW9uTWFuYWdlciBub3RpZmljYXRpb25NYW5hZ2VyID0gKE5vdGlmaWNhdGlvbk1hbmFnZXIpIGdldFN5c3RlbVNlcnZpY2UoQ29udGV4dC5OT1RJRklDQVRJT05fU0VSVklDRSk7CiAgICAgICAgbm90aWZpY2F0aW9uTWFuYWdlci5ub3RpZnkoMCwgbm90aWZpY2F0aW9uQnVpbGRlci5idWlsZCgpKTsKICAgIH0KCiAgICBwcml2YXRlIHZvaWQgaGFuZGxlRGF0YU1lc3NhZ2UoTWFwPFN0cmluZywgU3RyaW5nPiBkYXRhKSB7CiAgICAgICAgLy8gUHJvY2VzcyB0aGUgZGF0YSBtZXNzYWdlCiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class MyFirebaseMessagingService extends FirebaseMessagingService {

    @Override
    public void onMessageReceived(RemoteMessage remoteMessage) {
        // Check if the message contains a notification payload.
        if (remoteMessage.getNotification() != null) {
            // Display the notification
            showNotification(remoteMessage.getNotification().getTitle(), remoteMessage.getNotification().getBody());
        }

        // Check if the message contains a data payload.
        if (remoteMessage.getData().size() &gt; 0) {
            // Handle the data message
            handleDataMessage(remoteMessage.getData());
        }
    }

    private void showNotification(String title, String messageBody) {
        NotificationCompat.Builder notificationBuilder = new NotificationCompat.Builder(this, &quot;default_channel_id&quot;)
                .setSmallIcon(R.drawable.ic_notification)
                .setContentTitle(title)
                .setContentText(messageBody)
                .setAutoCancel(true)
                .setPriority(NotificationCompat.PRIORITY_HIGH);

        NotificationManager notificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
        notificationManager.notify(0, notificationBuilder.build());
    }

    private void handleDataMessage(Map&lt;String, String&gt; data) {
        // Process the data message
    }
}</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>onMessageReceived</strong>: This method is called when a message is received. It checks if the message contains a notification payload or a data payload.</li>
<li><strong>showNotification</strong>: This method creates and displays a notification using the NotificationCompat.Builder.</li>
<li><strong>handleDataMessage</strong>: This method processes the data payload.</li>
</ul>
</div><h1><p>Handling Background Notifications</p>
</h1>
<div class='content'><p>When your app is in the background, the system automatically handles notification messages and displays them in the notification tray. However, data messages need to be handled by your app.</p>
</div><h2><p>Example: Handling Background Notifications in Android</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIE15RmlyZWJhc2VNZXNzYWdpbmdTZXJ2aWNlIGV4dGVuZHMgRmlyZWJhc2VNZXNzYWdpbmdTZXJ2aWNlIHsKCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIG9uTWVzc2FnZVJlY2VpdmVkKFJlbW90ZU1lc3NhZ2UgcmVtb3RlTWVzc2FnZSkgewogICAgICAgIC8vIENoZWNrIGlmIHRoZSBtZXNzYWdlIGNvbnRhaW5zIGEgZGF0YSBwYXlsb2FkLgogICAgICAgIGlmIChyZW1vdGVNZXNzYWdlLmdldERhdGEoKS5zaXplKCkgPiAwKSB7CiAgICAgICAgICAgIGhhbmRsZURhdGFNZXNzYWdlKHJlbW90ZU1lc3NhZ2UuZ2V0RGF0YSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSB2b2lkIGhhbmRsZURhdGFNZXNzYWdlKE1hcDxTdHJpbmcsIFN0cmluZz4gZGF0YSkgewogICAgICAgIC8vIFByb2Nlc3MgdGhlIGRhdGEgbWVzc2FnZQogICAgICAgIC8vIEZvciBleGFtcGxlLCB5b3UgY2FuIGNyZWF0ZSBhIG5vdGlmaWNhdGlvbiBiYXNlZCBvbiB0aGUgZGF0YQogICAgICAgIFN0cmluZyB0aXRsZSA9IGRhdGEuZ2V0KCJ0aXRsZSIpOwogICAgICAgIFN0cmluZyBtZXNzYWdlQm9keSA9IGRhdGEuZ2V0KCJib2R5Iik7CiAgICAgICAgc2hvd05vdGlmaWNhdGlvbih0aXRsZSwgbWVzc2FnZUJvZHkpOwogICAgfQoKICAgIHByaXZhdGUgdm9pZCBzaG93Tm90aWZpY2F0aW9uKFN0cmluZyB0aXRsZSwgU3RyaW5nIG1lc3NhZ2VCb2R5KSB7CiAgICAgICAgTm90aWZpY2F0aW9uQ29tcGF0LkJ1aWxkZXIgbm90aWZpY2F0aW9uQnVpbGRlciA9IG5ldyBOb3RpZmljYXRpb25Db21wYXQuQnVpbGRlcih0aGlzLCAiZGVmYXVsdF9jaGFubmVsX2lkIikKICAgICAgICAgICAgICAgIC5zZXRTbWFsbEljb24oUi5kcmF3YWJsZS5pY19ub3RpZmljYXRpb24pCiAgICAgICAgICAgICAgICAuc2V0Q29udGVudFRpdGxlKHRpdGxlKQogICAgICAgICAgICAgICAgLnNldENvbnRlbnRUZXh0KG1lc3NhZ2VCb2R5KQogICAgICAgICAgICAgICAgLnNldEF1dG9DYW5jZWwodHJ1ZSkKICAgICAgICAgICAgICAgIC5zZXRQcmlvcml0eShOb3RpZmljYXRpb25Db21wYXQuUFJJT1JJVFlfSElHSCk7CgogICAgICAgIE5vdGlmaWNhdGlvbk1hbmFnZXIgbm90aWZpY2F0aW9uTWFuYWdlciA9IChOb3RpZmljYXRpb25NYW5hZ2VyKSBnZXRTeXN0ZW1TZXJ2aWNlKENvbnRleHQuTk9USUZJQ0FUSU9OX1NFUlZJQ0UpOwogICAgICAgIG5vdGlmaWNhdGlvbk1hbmFnZXIubm90aWZ5KDAsIG5vdGlmaWNhdGlvbkJ1aWxkZXIuYnVpbGQoKSk7CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class MyFirebaseMessagingService extends FirebaseMessagingService {

    @Override
    public void onMessageReceived(RemoteMessage remoteMessage) {
        // Check if the message contains a data payload.
        if (remoteMessage.getData().size() &gt; 0) {
            handleDataMessage(remoteMessage.getData());
        }
    }

    private void handleDataMessage(Map&lt;String, String&gt; data) {
        // Process the data message
        // For example, you can create a notification based on the data
        String title = data.get(&quot;title&quot;);
        String messageBody = data.get(&quot;body&quot;);
        showNotification(title, messageBody);
    }

    private void showNotification(String title, String messageBody) {
        NotificationCompat.Builder notificationBuilder = new NotificationCompat.Builder(this, &quot;default_channel_id&quot;)
                .setSmallIcon(R.drawable.ic_notification)
                .setContentTitle(title)
                .setContentText(messageBody)
                .setAutoCancel(true)
                .setPriority(NotificationCompat.PRIORITY_HIGH);

        NotificationManager notificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
        notificationManager.notify(0, notificationBuilder.build());
    }
}</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>onMessageReceived</strong>: This method is called when a message is received. It checks if the message contains a data payload.</li>
<li><strong>handleDataMessage</strong>: This method processes the data payload and creates a notification based on the data.</li>
</ul>
</div><h1><p>Notification Channels (Android Only)</p>
</h1>
<div class='content'><p>Starting from Android 8.0 (API level 26), all notifications must be assigned to a channel. This allows users to manage notification settings for each channel.</p>
</div><h2><p>Example: Creating a Notification Channel</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aWYgKEJ1aWxkLlZFUlNJT04uU0RLX0lOVCA+PSBCdWlsZC5WRVJTSU9OX0NPREVTLk8pIHsKICAgIE5vdGlmaWNhdGlvbkNoYW5uZWwgY2hhbm5lbCA9IG5ldyBOb3RpZmljYXRpb25DaGFubmVsKCJkZWZhdWx0X2NoYW5uZWxfaWQiLAogICAgICAgICAgICAiRGVmYXVsdCBDaGFubmVsIiwKICAgICAgICAgICAgTm90aWZpY2F0aW9uTWFuYWdlci5JTVBPUlRBTkNFX0hJR0gpOwogICAgY2hhbm5lbC5zZXREZXNjcmlwdGlvbigiVGhpcyBpcyB0aGUgZGVmYXVsdCBjaGFubmVsIGZvciBub3RpZmljYXRpb25zIik7CgogICAgTm90aWZpY2F0aW9uTWFuYWdlciBub3RpZmljYXRpb25NYW5hZ2VyID0gZ2V0U3lzdGVtU2VydmljZShOb3RpZmljYXRpb25NYW5hZ2VyLmNsYXNzKTsKICAgIG5vdGlmaWNhdGlvbk1hbmFnZXIuY3JlYXRlTm90aWZpY2F0aW9uQ2hhbm5lbChjaGFubmVsKTsKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O) {
    NotificationChannel channel = new NotificationChannel(&quot;default_channel_id&quot;,
            &quot;Default Channel&quot;,
            NotificationManager.IMPORTANCE_HIGH);
    channel.setDescription(&quot;This is the default channel for notifications&quot;);

    NotificationManager notificationManager = getSystemService(NotificationManager.class);
    notificationManager.createNotificationChannel(channel);
}</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>NotificationChannel</strong>: This class represents a notification channel.</li>
<li><strong>createNotificationChannel</strong>: This method creates the notification channel.</li>
</ul>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Task</p>
</h2>
<div class='content'><ol>
<li>Create a Firebase project and set up Firebase Cloud Messaging.</li>
<li>Implement a service to handle notifications in your Android app.</li>
<li>Create a notification channel for your notifications.</li>
<li>Test sending notifications from the Firebase console.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Create a Firebase Project</strong>:</p>
<ul>
<li>Go to the Firebase Console.</li>
<li>Click on &quot;Add project&quot; and follow the instructions.</li>
</ul>
</li>
<li>
<p><strong>Set Up Firebase Cloud Messaging</strong>:</p>
<ul>
<li>Add Firebase to your Android project.</li>
<li>Add the necessary dependencies in your <code>build.gradle</code> file.</li>
</ul>
</li>
<li>
<p><strong>Implement the Service</strong>:</p>
<ul>
<li>Create a class that extends <code>FirebaseMessagingService</code>.</li>
<li>Override the <code>onMessageReceived</code> method to handle notifications.</li>
</ul>
</li>
<li>
<p><strong>Create a Notification Channel</strong>:</p>
<ul>
<li>In your <code>FirebaseMessagingService</code> class, create a notification channel in the <code>onCreate</code> method.</li>
</ul>
</li>
<li>
<p><strong>Test Sending Notifications</strong>:</p>
<ul>
<li>Go to the Firebase Console.</li>
<li>Navigate to Cloud Messaging.</li>
<li>Send a test notification to your app.</li>
</ul>
</li>
</ol>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Missing Notification Channel</strong>: Ensure you create a notification channel for Android 8.0 and above.</li>
<li><strong>Handling Data Messages</strong>: Always check if the message contains a data payload and handle it appropriately.</li>
<li><strong>Foreground Notifications</strong>: Remember to manually display notifications when the app is in the foreground.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered how to handle notifications in a Firebase-enabled application. We discussed the different types of notifications, how to handle them in both foreground and background states, and how to create notification channels for Android. By following the examples and completing the practical exercise, you should now be able to effectively manage notifications in your app.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-02-sending-notifications' title="Sending Notifications">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-04-advanced-messaging-features' title="Advanced Messaging Features">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
