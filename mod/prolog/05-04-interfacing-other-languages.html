<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interfacing with Other Languages</title>

    <link rel="alternate" href="https://campusempresa.com/mod/prolog/05-04-interfacing-other-languages" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/prolog/05-04-interfacing-other-languages" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/prolog/05-04-interfacing-other-languages" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/prolog/05-04-interfacing-other-languages" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/prolog/05-04-interfacing-other-languages" class="px-2">CA</a>
					</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-03-prolog-libraries' title="Prolog Libraries">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Interfacing with Other Languages</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-05-building-prolog-application' title="Building a Prolog Application">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Interfacing Prolog with other programming languages can significantly enhance the capabilities of your Prolog programs by leveraging the strengths of different languages. This section will cover the basics of how to interface Prolog with other languages, focusing on practical examples and exercises.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Foreign Language Interface (FLI):</strong> Mechanism to call functions written in other languages (e.g., C, Python) from Prolog.</li>
<li><strong>Inter-process Communication (IPC):</strong> Techniques to enable communication between Prolog and other language processes.</li>
<li><strong>Embedding Prolog:</strong> Integrating Prolog into applications written in other languages.</li>
</ol>
</div><h1><p>Foreign Language Interface (FLI)</p>
</h1>
<div class='content'></div><h2><p>Calling C Functions from Prolog</p>
</h2>
<div class='content'><p>Prolog can call C functions using the Foreign Language Interface. This is useful for performance-critical operations or when you need to use existing C libraries.</p>
<h4>Example: Calling a C Function</h4>
<ol>
<li>
<p><strong>C Code (example.c):</strong></p>
<pre><code class="language-c">#include &lt;stdio.h&gt;

void hello_world() {
    printf(&quot;Hello, World from C!\n&quot;);
}
</code></pre>
</li>
<li>
<p><strong>Prolog Code (example.pl):</strong></p>
<pre><code class="language-prolog">:- foreign(hello_world, c, hello_world).

call_hello_world :-
    hello_world.
</code></pre>
</li>
<li>
<p><strong>Compiling and Linking:</strong></p>
<pre><code class="language-sh">gcc -shared -o example.so -fPIC example.c
swipl -s example.pl -g call_hello_world -t halt
</code></pre>
</li>
</ol>
</div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li>The <code>foreign/3</code> directive declares the C function <code>hello_world</code> to Prolog.</li>
<li>The <code>call_hello_world/0</code> predicate calls the C function.</li>
<li>The C code is compiled into a shared library (<code>example.so</code>), which Prolog can load and use.</li>
</ul>
</div><h1><p>Inter-process Communication (IPC)</p>
</h1>
<div class='content'></div><h2><p>Using Sockets for IPC</p>
</h2>
<div class='content'><p>Sockets can be used to communicate between Prolog and other languages. This is useful for distributed systems or when integrating with web services.</p>
<h4>Example: Prolog Server and Python Client</h4>
<ol>
<li>
<p><strong>Prolog Server (server.pl):</strong></p>
<pre><code class="language-prolog">:- use_module(library(socket)).

start_server(Port) :-
    tcp_socket(Socket),
    tcp_bind(Socket, Port),
    tcp_listen(Socket, 5),
    tcp_open_socket(Socket, AcceptFd, _),
    accept_connections(AcceptFd).

accept_connections(AcceptFd) :-
    tcp_accept(AcceptFd, ClientFd, _),
    setup_call_cleanup(
        tcp_open_socket(ClientFd, InStream, OutStream),
        handle_client(InStream, OutStream),
        close_connection(InStream, OutStream)),
    accept_connections(AcceptFd).

handle_client(InStream, OutStream) :-
    read_line_to_string(InStream, Line),
    format(OutStream, 'Received: ~w~n', [Line]),
    flush_output(OutStream).

close_connection(InStream, OutStream) :-
    close(InStream),
    close(OutStream).
</code></pre>
</li>
<li>
<p><strong>Python Client (client.py):</strong></p>
<pre><code class="language-python">import socket

def main():
    host = 'localhost'
    port = 12345

    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.connect((host, port))
        s.sendall(b'Hello, Prolog!\n')
        data = s.recv(1024)

    print('Received', repr(data))

if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
</li>
<li>
<p><strong>Running the Example:</strong></p>
<pre><code class="language-sh">swipl -s server.pl -g &quot;start_server(12345)&quot; -t halt &amp;
python client.py
</code></pre>
</li>
</ol>
</div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li>The Prolog server listens on a specified port and handles incoming connections.</li>
<li>The Python client connects to the Prolog server, sends a message, and receives a response.</li>
</ul>
</div><h1><p>Embedding Prolog</p>
</h1>
<div class='content'></div><h2><p>Using SWI-Prolog with Python</p>
</h2>
<div class='content'><p>SWI-Prolog provides a Python library (<code>pyswip</code>) to embed Prolog in Python applications.</p>
<h4>Example: Embedding Prolog in Python</h4>
<ol>
<li>
<p><strong>Prolog Code (example.pl):</strong></p>
<pre><code class="language-prolog">:- module(example, [greet/1]).

greet(Name) :-
    format('Hello, ~w!~n', [Name]).
</code></pre>
</li>
<li>
<p><strong>Python Code (example.py):</strong></p>
<pre><code class="language-python">from pyswip import Prolog

prolog = Prolog()
prolog.consult(&quot;example.pl&quot;)

for result in prolog.query(&quot;greet('World')&quot;):
    print(result)
</code></pre>
</li>
<li>
<p><strong>Running the Example:</strong></p>
<pre><code class="language-sh">python example.py
</code></pre>
</li>
</ol>
</div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li>The Prolog module <code>example</code> defines a <code>greet/1</code> predicate.</li>
<li>The Python script uses <code>pyswip</code> to consult the Prolog file and query the <code>greet/1</code> predicate.</li>
</ul>
</div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Calling a C Function</p>
</h2>
<div class='content'><ol>
<li>Write a C function that adds two integers and returns the result.</li>
<li>Create a Prolog predicate that calls this C function.</li>
<li>Test the Prolog predicate with different inputs.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>C Code (add.c):</strong></p>
<pre><code class="language-c">int add(int a, int b) {
    return a + b;
}
</code></pre>
</li>
<li>
<p><strong>Prolog Code (add.pl):</strong></p>
<pre><code class="language-prolog">:- foreign(add, c, add(+integer, +integer, [-integer])).

add_numbers(A, B, Result) :-
    add(A, B, Result).
</code></pre>
</li>
<li>
<p><strong>Compiling and Testing:</strong></p>
<pre><code class="language-sh">gcc -shared -o add.so -fPIC add.c
swipl -s add.pl -g &quot;add_numbers(3, 4, Result), write(Result), nl&quot; -t halt
</code></pre>
</li>
</ol>
</div><h2><p>Exercise 2: Prolog Server and Python Client</p>
</h2>
<div class='content'><ol>
<li>Modify the Prolog server to handle multiple messages from the client.</li>
<li>Update the Python client to send multiple messages and print the responses.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Prolog Server (server.pl):</strong></p>
<pre><code class="language-prolog">handle_client(InStream, OutStream) :-
    repeat,
    read_line_to_string(InStream, Line),
    (   Line == end_of_file
    -&gt;  !
    ;   format(OutStream, 'Received: ~w~n', [Line]),
        flush_output(OutStream),
        fail
    ).
</code></pre>
</li>
<li>
<p><strong>Python Client (client.py):</strong></p>
<pre><code class="language-python">import socket

def main():
    host = 'localhost'
    port = 12345

    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        s.connect((host, port))
        messages = [b'Hello, Prolog!\n', b'How are you?\n', b'end_of_file\n']
        for msg in messages:
            s.sendall(msg)
            data = s.recv(1024)
            print('Received', repr(data))

if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
</li>
</ol>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Interfacing Prolog with other languages opens up a wide range of possibilities for enhancing your applications. By using the Foreign Language Interface, Inter-process Communication, and embedding Prolog, you can leverage the strengths of multiple languages to build more powerful and flexible systems. The exercises provided should help you get hands-on experience with these techniques.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-03-prolog-libraries' title="Prolog Libraries">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-05-building-prolog-application' title="Building a Prolog Application">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
