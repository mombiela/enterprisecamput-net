<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Middleware in Django</title>

    <link rel="alternate" href="https://campusempresa.com/mod/django/middleware" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/django/middleware" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/django/middleware" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/django/middleware" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/django/middleware" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='password-management'>&#x25C4;Password Management</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Middleware in Django</a>
	</div>
	<div class='col-4 text-end'>
					<a href='signals'>Signals &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Middleware is a fundamental concept in Django that allows you to process requests globally before they reach the view or after the view has processed them. This section will guide you from the basics to advanced usage of middleware in Django.</p>
</div><h1>What is Middleware?</h1>
<div class='content'><p>Middleware is a way to process requests globally before they reach the view or after the view has processed them. Middleware components are executed in a specific order, and each one can modify the request or response.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Request Middleware</strong>: Code that runs before the view is called.</li>
<li><strong>View Middleware</strong>: Code that runs after the view is called.</li>
<li><strong>Response Middleware</strong>: Code that runs after the response has been constructed.</li>
<li><strong>Exception Middleware</strong>: Code that runs if an exception is raised.</li>
</ul>
</div><h1>Built-in Middleware</h1>
<div class='content'><p>Django comes with several built-in middleware classes that handle common tasks:</p>
<ul>
<li><code>SecurityMiddleware</code></li>
<li><code>SessionMiddleware</code></li>
<li><code>CommonMiddleware</code></li>
<li><code>CsrfViewMiddleware</code></li>
<li><code>AuthenticationMiddleware</code></li>
<li><code>MessageMiddleware</code></li>
</ul>
</div><h2>Example of Built-in Middleware</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("TUlERExFV0FSRSA9IFsKICAgICdkamFuZ28ubWlkZGxld2FyZS5zZWN1cml0eS5TZWN1cml0eU1pZGRsZXdhcmUnLAogICAgJ2RqYW5nby5jb250cmliLnNlc3Npb25zLm1pZGRsZXdhcmUuU2Vzc2lvbk1pZGRsZXdhcmUnLAogICAgJ2RqYW5nby5taWRkbGV3YXJlLmNvbW1vbi5Db21tb25NaWRkbGV3YXJlJywKICAgICdkamFuZ28ubWlkZGxld2FyZS5jc3JmLkNzcmZWaWV3TWlkZGxld2FyZScsCiAgICAnZGphbmdvLmNvbnRyaWIuYXV0aC5taWRkbGV3YXJlLkF1dGhlbnRpY2F0aW9uTWlkZGxld2FyZScsCiAgICAnZGphbmdvLmNvbnRyaWIubWVzc2FnZXMubWlkZGxld2FyZS5NZXNzYWdlTWlkZGxld2FyZScsCl0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
]</pre></div><div class='content'></div><h1>Custom Middleware</h1>
<div class='content'><p>Creating custom middleware allows you to add your own functionality to the request/response processing.</p>
</div><h2>Steps to Create Custom Middleware</h2>
<div class='content'><ol>
<li><strong>Define the Middleware Class</strong>: Create a new Python class with methods to process requests and responses.</li>
<li><strong>Add Middleware to Settings</strong>: Add your middleware class to the <code>MIDDLEWARE</code> list in <code>settings.py</code>.</li>
</ol>
</div><h2>Example of Custom Middleware</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBteWFwcC9taWRkbGV3YXJlLnB5CgpjbGFzcyBTaW1wbGVNaWRkbGV3YXJlOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIGdldF9yZXNwb25zZSk6CiAgICAgICAgc2VsZi5nZXRfcmVzcG9uc2UgPSBnZXRfcmVzcG9uc2UKCiAgICBkZWYgX19jYWxsX18oc2VsZiwgcmVxdWVzdCk6CiAgICAgICAgIyBDb2RlIHRvIGJlIGV4ZWN1dGVkIGZvciBlYWNoIHJlcXVlc3QgYmVmb3JlCiAgICAgICAgIyB0aGUgdmlldyAoYW5kIGxhdGVyIG1pZGRsZXdhcmUpIGFyZSBjYWxsZWQuCiAgICAgICAgcHJpbnQoIkJlZm9yZSB2aWV3IikKCiAgICAgICAgcmVzcG9uc2UgPSBzZWxmLmdldF9yZXNwb25zZShyZXF1ZXN0KQoKICAgICAgICAjIENvZGUgdG8gYmUgZXhlY3V0ZWQgZm9yIGVhY2ggcmVxdWVzdC9yZXNwb25zZSBhZnRlcgogICAgICAgICMgdGhlIHZpZXcgaXMgY2FsbGVkLgogICAgICAgIHByaW50KCJBZnRlciB2aWV3IikKCiAgICAgICAgcmV0dXJuIHJlc3BvbnNl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># myapp/middleware.py

class SimpleMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response

    def __call__(self, request):
        # Code to be executed for each request before
        # the view (and later middleware) are called.
        print(&quot;Before view&quot;)

        response = self.get_response(request)

        # Code to be executed for each request/response after
        # the view is called.
        print(&quot;After view&quot;)

        return response</pre></div><div class='content'></div><h2>Adding Custom Middleware to Settings</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBzZXR0aW5ncy5weQoKTUlERExFV0FSRSA9IFsKICAgICdkamFuZ28ubWlkZGxld2FyZS5zZWN1cml0eS5TZWN1cml0eU1pZGRsZXdhcmUnLAogICAgJ2RqYW5nby5jb250cmliLnNlc3Npb25zLm1pZGRsZXdhcmUuU2Vzc2lvbk1pZGRsZXdhcmUnLAogICAgJ2RqYW5nby5taWRkbGV3YXJlLmNvbW1vbi5Db21tb25NaWRkbGV3YXJlJywKICAgICdkamFuZ28ubWlkZGxld2FyZS5jc3JmLkNzcmZWaWV3TWlkZGxld2FyZScsCiAgICAnZGphbmdvLmNvbnRyaWIuYXV0aC5taWRkbGV3YXJlLkF1dGhlbnRpY2F0aW9uTWlkZGxld2FyZScsCiAgICAnZGphbmdvLmNvbnRyaWIubWVzc2FnZXMubWlkZGxld2FyZS5NZXNzYWdlTWlkZGxld2FyZScsCiAgICAnbXlhcHAubWlkZGxld2FyZS5TaW1wbGVNaWRkbGV3YXJlJywgICMgQWRkIHlvdXIgY3VzdG9tIG1pZGRsZXdhcmUgaGVyZQpd"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># settings.py

MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'myapp.middleware.SimpleMiddleware',  # Add your custom middleware here
]</pre></div><div class='content'></div><h1>Advanced Middleware Concepts</h1>
<div class='content'></div><h2>Middleware Order</h2>
<div class='content'><p>The order in which middleware is listed in the <code>MIDDLEWARE</code> setting is important. Middleware is executed in the order defined in the list for requests and in reverse order for responses.</p>
</div><h2>Middleware Methods</h2>
<div class='content'><ul>
<li><code>__init__(self, get_response)</code>: Called once when the web server starts.</li>
<li><code>__call__(self, request)</code>: Called on each request.</li>
<li><code>process_view(self, request, view_func, view_args, view_kwargs)</code>: Called just before Django calls the view.</li>
<li><code>process_exception(self, request, exception)</code>: Called if the view raises an exception.</li>
<li><code>process_template_response(self, request, response)</code>: Called just after the view has finished executing if the response contains a <code>render()</code> method.</li>
</ul>
</div><h2>Example with Additional Methods</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBteWFwcC9taWRkbGV3YXJlLnB5CgpjbGFzcyBBZHZhbmNlZE1pZGRsZXdhcmU6CiAgICBkZWYgX19pbml0X18oc2VsZiwgZ2V0X3Jlc3BvbnNlKToKICAgICAgICBzZWxmLmdldF9yZXNwb25zZSA9IGdldF9yZXNwb25zZQoKICAgIGRlZiBfX2NhbGxfXyhzZWxmLCByZXF1ZXN0KToKICAgICAgICBwcmludCgiQmVmb3JlIHZpZXciKQogICAgICAgIHJlc3BvbnNlID0gc2VsZi5nZXRfcmVzcG9uc2UocmVxdWVzdCkKICAgICAgICBwcmludCgiQWZ0ZXIgdmlldyIpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlCgogICAgZGVmIHByb2Nlc3NfdmlldyhzZWxmLCByZXF1ZXN0LCB2aWV3X2Z1bmMsIHZpZXdfYXJncywgdmlld19rd2FyZ3MpOgogICAgICAgIHByaW50KCJCZWZvcmUgdmlldyBmdW5jdGlvbiIpCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBkZWYgcHJvY2Vzc19leGNlcHRpb24oc2VsZiwgcmVxdWVzdCwgZXhjZXB0aW9uKToKICAgICAgICBwcmludCgiRXhjZXB0aW9uIG9jY3VycmVkIikKICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBwcm9jZXNzX3RlbXBsYXRlX3Jlc3BvbnNlKHNlbGYsIHJlcXVlc3QsIHJlc3BvbnNlKToKICAgICAgICBwcmludCgiQmVmb3JlIHRlbXBsYXRlIHJlbmRlcmluZyIpCiAgICAgICAgcmV0dXJuIHJlc3BvbnNl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># myapp/middleware.py

class AdvancedMiddleware:
    def __init__(self, get_response):
        self.get_response = get_response

    def __call__(self, request):
        print(&quot;Before view&quot;)
        response = self.get_response(request)
        print(&quot;After view&quot;)
        return response

    def process_view(self, request, view_func, view_args, view_kwargs):
        print(&quot;Before view function&quot;)
        return None

    def process_exception(self, request, exception):
        print(&quot;Exception occurred&quot;)
        return None

    def process_template_response(self, request, response):
        print(&quot;Before template rendering&quot;)
        return response</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Middleware in Django is a powerful tool that allows you to process requests and responses globally. By understanding and utilizing both built-in and custom middleware, you can add a wide range of functionalities to your Django applications. Remember to carefully manage the order of middleware and use the appropriate methods to handle different stages of request and response processing.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='password-management'>&#x25C4;Password Management</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Middleware in Django</a>
	</div>
	<div class='col-4 text-end'>
					<a href='signals'>Signals &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
