<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interfacing with Hardware</title>

    <link rel="alternate" href="https://campusempresa.com/mod/assembly/07-03-interfacing-hardware" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/assembly/07-03-interfacing-hardware" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/assembly/07-03-interfacing-hardware" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/assembly/07-03-interfacing-hardware" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/assembly/07-03-interfacing-hardware" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-02-basic-os-kernel' title="Creating a Basic Operating System Kernel">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Interfacing with Hardware</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-04-debugging-profiling' title="Debugging and Profiling Assembly Code">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Interfacing with hardware is one of the most powerful and practical applications of assembly language. This module will guide you through the basics of hardware interfacing, providing you with the knowledge and skills to control and communicate with hardware components directly from your assembly programs.</p>
</div><h1>Objectives</h1>
<div class='content'><ul>
<li>Understand the basics of hardware interfacing.</li>
<li>Learn how to use assembly language to control hardware components.</li>
<li>Explore practical examples of hardware interfacing.</li>
<li>Practice writing assembly code to interface with hardware.</li>
</ul>
</div><h1>Key Concepts</h1>
<div class='content'></div><h2>1. Hardware Interfacing Basics</h2>
<div class='content'><ul>
<li><strong>I/O Ports</strong>: Input/Output ports are used to communicate with hardware devices. Each port is assigned a unique address.</li>
<li><strong>Memory-Mapped I/O</strong>: Some systems use memory addresses to access I/O devices, treating them as if they were memory locations.</li>
<li><strong>Interrupts</strong>: Hardware interrupts are signals sent by devices to the CPU to indicate that they need attention.</li>
</ul>
</div><h2>2. I/O Instructions</h2>
<div class='content'><ul>
<li><strong>IN</strong>: Reads data from an I/O port.</li>
<li><strong>OUT</strong>: Writes data to an I/O port.</li>
</ul>
</div><h2>3. Common Hardware Components</h2>
<div class='content'><ul>
<li><strong>LEDs</strong>: Light Emitting Diodes can be controlled to turn on or off.</li>
<li><strong>Switches</strong>: Simple input devices that can be read to determine their state.</li>
<li><strong>Displays</strong>: Devices like seven-segment displays or LCDs that can show information.</li>
<li><strong>Sensors</strong>: Devices that measure physical properties and provide data to the system.</li>
</ul>
</div><h1>Practical Example: Controlling an LED</h1>
<div class='content'></div><h2>Step-by-Step Guide</h2>
<div class='content'><ol>
<li>
<p><strong>Setup</strong>: Assume we have an LED connected to a specific I/O port (e.g., port 0x60).</p>
</li>
<li>
<p><strong>Assembly Code</strong>:</p>
</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VjdGlvbiAuZGF0YQogICAgOyBObyBkYXRhIHNlY3Rpb24gbmVlZGVkIGZvciB0aGlzIHNpbXBsZSBleGFtcGxlCgpzZWN0aW9uIC50ZXh0CiAgICBnbG9iYWwgX3N0YXJ0Cgpfc3RhcnQ6CiAgICA7IFR1cm4gb24gdGhlIExFRAogICAgbW92IGFsLCAxICAgICAgICAgIDsgTG9hZCB0aGUgdmFsdWUgMSBpbnRvIHRoZSBBTCByZWdpc3RlciAodHVybiBvbiBMRUQpCiAgICBvdXQgMHg2MCwgYWwgICAgICAgOyBTZW5kIHRoZSB2YWx1ZSBpbiBBTCB0byBwb3J0IDB4NjAKCiAgICA7IFdhaXQgZm9yIGEgd2hpbGUgKHNpbXBsZSBkZWxheSBsb29wKQogICAgbW92IGN4LCAweEZGRkYgICAgIDsgTG9hZCBhIGxhcmdlIHZhbHVlIGludG8gQ1ggZm9yIHRoZSBkZWxheSBsb29wCmRlbGF5X2xvb3A6CiAgICBsb29wIGRlbGF5X2xvb3AgICAgOyBEZWNyZW1lbnQgQ1ggYW5kIGxvb3AgdW50aWwgQ1ggaXMgemVybwoKICAgIDsgVHVybiBvZmYgdGhlIExFRAogICAgbW92IGFsLCAwICAgICAgICAgIDsgTG9hZCB0aGUgdmFsdWUgMCBpbnRvIHRoZSBBTCByZWdpc3RlciAodHVybiBvZmYgTEVEKQogICAgb3V0IDB4NjAsIGFsICAgICAgIDsgU2VuZCB0aGUgdmFsdWUgaW4gQUwgdG8gcG9ydCAweDYwCgogICAgOyBFeGl0IHRoZSBwcm9ncmFtIChpbiBhIHJlYWwgc3lzdGVtLCB5b3Ugd291bGQgdXNlIGFuIGFwcHJvcHJpYXRlIHN5c3RlbSBjYWxsKQogICAgaGx0ICAgICAgICAgICAgICAgIDsgSGFsdCB0aGUgQ1BVIChmb3IgZGVtb25zdHJhdGlvbiBwdXJwb3Nlcyk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>section .data
    ; No data section needed for this simple example

section .text
    global _start

_start:
    ; Turn on the LED
    mov al, 1          ; Load the value 1 into the AL register (turn on LED)
    out 0x60, al       ; Send the value in AL to port 0x60

    ; Wait for a while (simple delay loop)
    mov cx, 0xFFFF     ; Load a large value into CX for the delay loop
delay_loop:
    loop delay_loop    ; Decrement CX and loop until CX is zero

    ; Turn off the LED
    mov al, 0          ; Load the value 0 into the AL register (turn off LED)
    out 0x60, al       ; Send the value in AL to port 0x60

    ; Exit the program (in a real system, you would use an appropriate system call)
    hlt                ; Halt the CPU (for demonstration purposes)</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>mov al, 1</strong>: Load the value <code>1</code> into the <code>AL</code> register. This value represents turning the LED on.</li>
<li><strong>out 0x60, al</strong>: Send the value in <code>AL</code> to the I/O port <code>0x60</code>, which controls the LED.</li>
<li><strong>mov cx, 0xFFFF</strong>: Load a large value into the <code>CX</code> register to create a delay.</li>
<li><strong>loop delay_loop</strong>: Decrement <code>CX</code> and loop until <code>CX</code> is zero, creating a delay.</li>
<li><strong>mov al, 0</strong>: Load the value <code>0</code> into the <code>AL</code> register. This value represents turning the LED off.</li>
<li><strong>out 0x60, al</strong>: Send the value in <code>AL</code> to the I/O port <code>0x60</code> to turn off the LED.</li>
<li><strong>hlt</strong>: Halt the CPU (used here to end the program).</li>
</ul>
</div><h1>Exercise: Reading a Switch State</h1>
<div class='content'></div><h2>Task</h2>
<div class='content'><p>Write an assembly program to read the state of a switch connected to I/O port <code>0x61</code> and turn on an LED connected to I/O port <code>0x60</code> if the switch is pressed.</p>
</div><h2>Solution</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VjdGlvbiAuZGF0YQogICAgOyBObyBkYXRhIHNlY3Rpb24gbmVlZGVkIGZvciB0aGlzIHNpbXBsZSBleGFtcGxlCgpzZWN0aW9uIC50ZXh0CiAgICBnbG9iYWwgX3N0YXJ0Cgpfc3RhcnQ6CiAgICA7IFJlYWQgdGhlIHN3aXRjaCBzdGF0ZQogICAgaW4gYWwsIDB4NjEgICAgICAgIDsgUmVhZCB0aGUgdmFsdWUgZnJvbSBwb3J0IDB4NjEgaW50byBBTAoKICAgIDsgQ2hlY2sgaWYgdGhlIHN3aXRjaCBpcyBwcmVzc2VkIChhc3N1bWluZyBwcmVzc2VkIHN0YXRlIGlzIDEpCiAgICB0ZXN0IGFsLCAxICAgICAgICAgOyBUZXN0IGlmIHRoZSBsZWFzdCBzaWduaWZpY2FudCBiaXQgaXMgc2V0CiAgICBqeiBzd2l0Y2hfbm90X3ByZXNzZWQgOyBKdW1wIGlmIHplcm8gKHN3aXRjaCBub3QgcHJlc3NlZCkKCiAgICA7IFR1cm4gb24gdGhlIExFRAogICAgbW92IGFsLCAxICAgICAgICAgIDsgTG9hZCB0aGUgdmFsdWUgMSBpbnRvIHRoZSBBTCByZWdpc3RlciAodHVybiBvbiBMRUQpCiAgICBvdXQgMHg2MCwgYWwgICAgICAgOyBTZW5kIHRoZSB2YWx1ZSBpbiBBTCB0byBwb3J0IDB4NjAKCiAgICA7IFdhaXQgZm9yIGEgd2hpbGUgKHNpbXBsZSBkZWxheSBsb29wKQogICAgbW92IGN4LCAweEZGRkYgICAgIDsgTG9hZCBhIGxhcmdlIHZhbHVlIGludG8gQ1ggZm9yIHRoZSBkZWxheSBsb29wCmRlbGF5X2xvb3A6CiAgICBsb29wIGRlbGF5X2xvb3AgICAgOyBEZWNyZW1lbnQgQ1ggYW5kIGxvb3AgdW50aWwgQ1ggaXMgemVybwoKICAgIDsgVHVybiBvZmYgdGhlIExFRAogICAgbW92IGFsLCAwICAgICAgICAgIDsgTG9hZCB0aGUgdmFsdWUgMCBpbnRvIHRoZSBBTCByZWdpc3RlciAodHVybiBvZmYgTEVEKQogICAgb3V0IDB4NjAsIGFsICAgICAgIDsgU2VuZCB0aGUgdmFsdWUgaW4gQUwgdG8gcG9ydCAweDYwCgpzd2l0Y2hfbm90X3ByZXNzZWQ6CiAgICA7IEV4aXQgdGhlIHByb2dyYW0gKGluIGEgcmVhbCBzeXN0ZW0sIHlvdSB3b3VsZCB1c2UgYW4gYXBwcm9wcmlhdGUgc3lzdGVtIGNhbGwpCiAgICBobHQgICAgICAgICAgICAgICAgOyBIYWx0IHRoZSBDUFUgKGZvciBkZW1vbnN0cmF0aW9uIHB1cnBvc2VzKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>section .data
    ; No data section needed for this simple example

section .text
    global _start

_start:
    ; Read the switch state
    in al, 0x61        ; Read the value from port 0x61 into AL

    ; Check if the switch is pressed (assuming pressed state is 1)
    test al, 1         ; Test if the least significant bit is set
    jz switch_not_pressed ; Jump if zero (switch not pressed)

    ; Turn on the LED
    mov al, 1          ; Load the value 1 into the AL register (turn on LED)
    out 0x60, al       ; Send the value in AL to port 0x60

    ; Wait for a while (simple delay loop)
    mov cx, 0xFFFF     ; Load a large value into CX for the delay loop
delay_loop:
    loop delay_loop    ; Decrement CX and loop until CX is zero

    ; Turn off the LED
    mov al, 0          ; Load the value 0 into the AL register (turn off LED)
    out 0x60, al       ; Send the value in AL to port 0x60

switch_not_pressed:
    ; Exit the program (in a real system, you would use an appropriate system call)
    hlt                ; Halt the CPU (for demonstration purposes)</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>in al, 0x61</strong>: Read the value from the switch connected to port <code>0x61</code> into the <code>AL</code> register.</li>
<li><strong>test al, 1</strong>: Test if the least significant bit of <code>AL</code> is set (indicating the switch is pressed).</li>
<li><strong>jz switch_not_pressed</strong>: Jump to the <code>switch_not_pressed</code> label if the zero flag is set (indicating the switch is not pressed).</li>
<li><strong>mov al, 1</strong>: Load the value <code>1</code> into the <code>AL</code> register to turn on the LED.</li>
<li><strong>out 0x60, al</strong>: Send the value in <code>AL</code> to port <code>0x60</code> to turn on the LED.</li>
<li><strong>mov cx, 0xFFFF</strong>: Load a large value into the <code>CX</code> register to create a delay.</li>
<li><strong>loop delay_loop</strong>: Decrement <code>CX</code> and loop until <code>CX</code> is zero, creating a delay.</li>
<li><strong>mov al, 0</strong>: Load the value <code>0</code> into the <code>AL</code> register to turn off the LED.</li>
<li><strong>out 0x60, al</strong>: Send the value in <code>AL</code> to port <code>0x60</code> to turn off the LED.</li>
<li><strong>hlt</strong>: Halt the CPU (used here to end the program).</li>
</ul>
</div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Incorrect Port Addresses</strong>: Ensure you are using the correct I/O port addresses for your hardware components.</li>
<li><strong>Timing Issues</strong>: Be aware of timing issues, especially when dealing with hardware that requires precise timing.</li>
<li><strong>Interrupt Handling</strong>: Properly handle interrupts if your hardware generates them.</li>
</ul>
</div><h1>Summary</h1>
<div class='content'><p>In this section, you learned the basics of interfacing with hardware using assembly language. You explored how to use I/O instructions to control hardware components and practiced writing assembly code to read from and write to I/O ports. This knowledge is essential for developing low-level software that interacts directly with hardware, providing a foundation for more advanced topics in assembly programming.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-02-basic-os-kernel' title="Creating a Basic Operating System Kernel">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-04-debugging-profiling' title="Debugging and Profiling Assembly Code">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
