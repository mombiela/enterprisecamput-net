<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security and Exploitation</title>

    <link rel="alternate" href="https://campusempresa.com/mod/assembly/security-and-exploitation" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/assembly/security-and-exploitation" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/assembly/security-and-exploitation" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/assembly/security-and-exploitation" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/assembly/security-and-exploitation" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='reverse-engineering-and-disassembly'>&#x25C4;Reverse Engineering and Disassembly</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Security and Exploitation</a>
	</div>
	<div class='col-4 text-end'>
					<a href='real-world-case-studies'>Real-World Case Studies &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this module, we will explore the critical aspects of security and exploitation in the context of Assembly language programming. Understanding these concepts is essential for writing secure code and recognizing potential vulnerabilities in low-level programming.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Buffer Overflows</strong>: A common vulnerability where data exceeds buffer boundaries, potentially leading to arbitrary code execution.</li>
<li><strong>Stack Smashing</strong>: A specific type of buffer overflow that overwrites the return address on the stack.</li>
<li><strong>NOP Sleds</strong>: A sequence of NOP (No Operation) instructions used to increase the likelihood of successful exploitation.</li>
<li><strong>Shellcode</strong>: A small piece of code used as the payload in the exploitation of a software vulnerability.</li>
<li><strong>Return-Oriented Programming (ROP)</strong>: A technique that uses existing code snippets (gadgets) to perform arbitrary operations.</li>
</ul>
</div><h1>Buffer Overflows</h1>
<div class='content'><p>Buffer overflows occur when data written to a buffer exceeds its allocated size, potentially overwriting adjacent memory. This can lead to unpredictable behavior, crashes, or even arbitrary code execution.</p>
</div><h2>Example: Simple Buffer Overflow</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VjdGlvbiAuZGF0YQogICAgYnVmZmVyIGRiIDY0IGR1cCgwKSA7IEFsbG9jYXRlIDY0IGJ5dGVzIGZvciB0aGUgYnVmZmVyCgpzZWN0aW9uIC50ZXh0CiAgICBnbG9iYWwgX3N0YXJ0Cgpfc3RhcnQ6CiAgICA7IFNpbXVsYXRlIGlucHV0IHRoYXQgZXhjZWVkcyBidWZmZXIgc2l6ZQogICAgbW92IGVheCwgMHg0MTQxNDE0MSA7ICdBQUFBJyBpbiBBU0NJSQogICAgbW92IFtidWZmZXIgKyA3MF0sIGVheCA7IFdyaXRlIGJleW9uZCB0aGUgYnVmZmVyIGJvdW5kYXJ5CgogICAgOyBFeGl0IHByb2dyYW0KICAgIG1vdiBlYXgsIDEKICAgIHhvciBlYngsIGVieAogICAgaW50IDB4ODA="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>section .data
    buffer db 64 dup(0) ; Allocate 64 bytes for the buffer

section .text
    global _start

_start:
    ; Simulate input that exceeds buffer size
    mov eax, 0x41414141 ; 'AAAA' in ASCII
    mov [buffer + 70], eax ; Write beyond the buffer boundary

    ; Exit program
    mov eax, 1
    xor ebx, ebx
    int 0x80</pre></div><div class='content'><p>In this example, the buffer is only 64 bytes, but we write 4 bytes at an offset of 70, causing a buffer overflow.</p>
</div><h1>Stack Smashing</h1>
<div class='content'><p>Stack smashing involves overwriting the stack, particularly the return address, to redirect execution flow.</p>
</div><h2>Example: Stack Smashing</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VjdGlvbiAuZGF0YQogICAgYnVmZmVyIGRiIDY0IGR1cCgwKSA7IEFsbG9jYXRlIDY0IGJ5dGVzIGZvciB0aGUgYnVmZmVyCgpzZWN0aW9uIC50ZXh0CiAgICBnbG9iYWwgX3N0YXJ0Cgpfc3RhcnQ6CiAgICA7IFNpbXVsYXRlIGlucHV0IHRoYXQgb3ZlcndyaXRlcyB0aGUgcmV0dXJuIGFkZHJlc3MKICAgIG1vdiBlYXgsIDB4ZGVhZGJlZWYgOyBBcmJpdHJhcnkgYWRkcmVzcyB0byByZWRpcmVjdCBleGVjdXRpb24KICAgIG1vdiBbYnVmZmVyICsgNjhdLCBlYXggOyBPdmVyd3JpdGUgcmV0dXJuIGFkZHJlc3MKCiAgICA7IEV4aXQgcHJvZ3JhbQogICAgbW92IGVheCwgMQogICAgeG9yIGVieCwgZWJ4CiAgICBpbnQgMHg4MA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>section .data
    buffer db 64 dup(0) ; Allocate 64 bytes for the buffer

section .text
    global _start

_start:
    ; Simulate input that overwrites the return address
    mov eax, 0xdeadbeef ; Arbitrary address to redirect execution
    mov [buffer + 68], eax ; Overwrite return address

    ; Exit program
    mov eax, 1
    xor ebx, ebx
    int 0x80</pre></div><div class='content'><p>Here, we overwrite the return address with <code>0xdeadbeef</code>, which could redirect execution to an arbitrary location.</p>
</div><h1>NOP Sleds</h1>
<div class='content'><p>A NOP sled is a sequence of NOP instructions (<code>0x90</code> in x86) used to pad the payload, increasing the chances of hitting the shellcode.</p>
</div><h2>Example: NOP Sled</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VjdGlvbiAuZGF0YQogICAgbm9wX3NsZWQgZGIgMHg5MCwgMHg5MCwgMHg5MCwgMHg5MCwgMHg5MCA7IDUgTk9QIGluc3RydWN0aW9ucwogICAgc2hlbGxjb2RlIGRiIDB4Y2MgOyBJTlQzIGluc3RydWN0aW9uIChicmVha3BvaW50KQoKc2VjdGlvbiAudGV4dAogICAgZ2xvYmFsIF9zdGFydAoKX3N0YXJ0OgogICAgOyBFeGVjdXRlIE5PUCBzbGVkIGZvbGxvd2VkIGJ5IHNoZWxsY29kZQogICAgbGVhIGVzaSwgW25vcF9zbGVkXQogICAgam1wIGVzaQoKICAgIDsgRXhpdCBwcm9ncmFtCiAgICBtb3YgZWF4LCAxCiAgICB4b3IgZWJ4LCBlYngKICAgIGludCAweDgw"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>section .data
    nop_sled db 0x90, 0x90, 0x90, 0x90, 0x90 ; 5 NOP instructions
    shellcode db 0xcc ; INT3 instruction (breakpoint)

section .text
    global _start

_start:
    ; Execute NOP sled followed by shellcode
    lea esi, [nop_sled]
    jmp esi

    ; Exit program
    mov eax, 1
    xor ebx, ebx
    int 0x80</pre></div><div class='content'><p>In this example, the NOP sled is followed by a single <code>INT3</code> instruction, which is used for debugging.</p>
</div><h1>Shellcode</h1>
<div class='content'><p>Shellcode is a small piece of code used as the payload in exploits. It is typically written in Assembly for size and efficiency.</p>
</div><h2>Example: Simple Shellcode</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VjdGlvbiAudGV4dAogICAgZ2xvYmFsIF9zdGFydAoKX3N0YXJ0OgogICAgOyBFeGVjdXRlIC9iaW4vc2gKICAgIHhvciBlYXgsIGVheAogICAgcHVzaCBlYXgKICAgIHB1c2ggMHg2ODczMmYyZiA7IC8vc2gKICAgIHB1c2ggMHg2ZTY5NjIyZiA7IC9iaW4KICAgIG1vdiBlYngsIGVzcAogICAgcHVzaCBlYXgKICAgIHB1c2ggZWJ4CiAgICBtb3YgZWN4LCBlc3AKICAgIHhvciBlZHgsIGVkeAogICAgbW92IGFsLCAweGIKICAgIGludCAweDgw"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>section .text
    global _start

_start:
    ; Execute /bin/sh
    xor eax, eax
    push eax
    push 0x68732f2f ; //sh
    push 0x6e69622f ; /bin
    mov ebx, esp
    push eax
    push ebx
    mov ecx, esp
    xor edx, edx
    mov al, 0xb
    int 0x80</pre></div><div class='content'><p>This shellcode spawns a shell by executing <code>/bin/sh</code>.</p>
</div><h1>Return-Oriented Programming (ROP)</h1>
<div class='content'><p>ROP is an advanced exploitation technique that uses existing code snippets (gadgets) to perform arbitrary operations without injecting new code.</p>
</div><h2>Example: ROP Chain</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VjdGlvbiAuZGF0YQogICAgcm9wX2NoYWluIGRkIDB4MDgwNDg0MzAsIDB4MDgwNDg1MDAgOyBBZGRyZXNzZXMgb2YgZ2FkZ2V0cwoKc2VjdGlvbiAudGV4dAogICAgZ2xvYmFsIF9zdGFydAoKX3N0YXJ0OgogICAgOyBTaW11bGF0ZSBzdGFjayB3aXRoIFJPUCBjaGFpbgogICAgbGVhIGVzcCwgW3JvcF9jaGFpbl0KICAgIHJldAoKICAgIDsgRXhpdCBwcm9ncmFtCiAgICBtb3YgZWF4LCAxCiAgICB4b3IgZWJ4LCBlYngKICAgIGludCAweDgw"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>section .data
    rop_chain dd 0x08048430, 0x08048500 ; Addresses of gadgets

section .text
    global _start

_start:
    ; Simulate stack with ROP chain
    lea esp, [rop_chain]
    ret

    ; Exit program
    mov eax, 1
    xor ebx, ebx
    int 0x80</pre></div><div class='content'><p>In this example, the ROP chain consists of addresses of existing instructions (gadgets) that will be executed in sequence.</p>
</div><h1>Conclusion</h1>
<div class='content'><p>Understanding security and exploitation in Assembly is crucial for writing secure code and recognizing potential vulnerabilities. By studying buffer overflows, stack smashing, NOP sleds, shellcode, and ROP, you gain the knowledge to both defend against and understand low-level exploits. Always prioritize security in your programming practices to protect against these vulnerabilities.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='reverse-engineering-and-disassembly'>&#x25C4;Reverse Engineering and Disassembly</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Security and Exploitation</a>
	</div>
	<div class='col-4 text-end'>
					<a href='real-world-case-studies'>Real-World Case Studies &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
