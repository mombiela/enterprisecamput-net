<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A03:2021 - Injection</title>

    <link rel="alternate" href="https://campusempresa.com/mod/owasp/tema-11" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/owasp/tema-11" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/owasp/tema-11" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/owasp/tema-11" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/owasp/tema-11" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Injection is one of the most critical and common vulnerabilities in web applications. It occurs when an attacker can send untrusted data to an interpreter as part of a command or query. Malicious data can trick the interpreter into executing unintended commands or accessing unauthorized data.</p>
</div><h1>Common Types of Injection</h1>
<div class='content'><ul>
<li><strong>SQL Injection (SQLi)</strong>: Injection of SQL commands into database queries.</li>
<li><strong>Command Injection</strong>: Injection of operating system commands.</li>
<li><strong>LDAP Injection</strong>: Injection of commands into LDAP queries.</li>
<li><strong>XPath Injection</strong>: Injection into XPath queries for XML.</li>
<li><strong>NoSQL Injection</strong>: Injection into NoSQL databases.</li>
</ul>
</div><h1>Example of SQL Injection</h1>
<div class='content'></div><h2>Vulnerable Code</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlIGluIFB5dGhvbiB3aXRoIGEgdnVsbmVyYWJsZSBTUUwgcXVlcnkKaW1wb3J0IHNxbGl0ZTMKCmRlZiBnZXRfdXNlcl9pbmZvKHVzZXJfaWQpOgogICAgY29ubiA9IHNxbGl0ZTMuY29ubmVjdCgnZXhhbXBsZS5kYicpCiAgICBjdXJzb3IgPSBjb25uLmN1cnNvcigpCiAgICBxdWVyeSA9IGYiU0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSBpZCA9IHt1c2VyX2lkfSIKICAgIGN1cnNvci5leGVjdXRlKHF1ZXJ5KQogICAgcmV0dXJuIGN1cnNvci5mZXRjaGFsbCgp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example in Python with a vulnerable SQL query
import sqlite3

def get_user_info(user_id):
    conn = sqlite3.connect('example.db')
    cursor = conn.cursor()
    query = f&quot;SELECT * FROM users WHERE id = {user_id}&quot;
    cursor.execute(query)
    return cursor.fetchall()</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><p>In the above example, the <code>user_id</code> variable is directly inserted into the SQL query without any validation or sanitization. An attacker could exploit this vulnerability by passing a malicious value like <code>1 OR 1=1</code>, which would result in the execution of the query:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSBpZCA9IDEgT1IgMT0x"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT * FROM users WHERE id = 1 OR 1=1</pre></div><div class='content'><p>This would return all records from the <code>users</code> table.</p>
</div><h1>Injection Prevention</h1>
<div class='content'></div><h2>Use of Prepared Statements</h2>
<div class='content'><p>Prepared statements (also known as parameterized queries) are an effective technique to prevent SQL injections. Here is an example of how to modify the above code to use prepared statements:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlIGluIFB5dGhvbiB1c2luZyBwcmVwYXJlZCBzdGF0ZW1lbnRzCmltcG9ydCBzcWxpdGUzCgpkZWYgZ2V0X3VzZXJfaW5mbyh1c2VyX2lkKToKICAgIGNvbm4gPSBzcWxpdGUzLmNvbm5lY3QoJ2V4YW1wbGUuZGInKQogICAgY3Vyc29yID0gY29ubi5jdXJzb3IoKQogICAgcXVlcnkgPSAiU0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSBpZCA9ID8iCiAgICBjdXJzb3IuZXhlY3V0ZShxdWVyeSwgKHVzZXJfaWQsKSkKICAgIHJldHVybiBjdXJzb3IuZmV0Y2hhbGwoKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example in Python using prepared statements
import sqlite3

def get_user_info(user_id):
    conn = sqlite3.connect('example.db')
    cursor = conn.cursor()
    query = &quot;SELECT * FROM users WHERE id = ?&quot;
    cursor.execute(query, (user_id,))
    return cursor.fetchall()</pre></div><div class='content'></div><h2>Input Validation and Sanitization</h2>
<div class='content'><ul>
<li><strong>Validation</strong>: Ensure that input data meets expected formats before processing it.</li>
<li><strong>Sanitization</strong>: Clean input data to remove dangerous characters.</li>
</ul>
</div><h2>Use of ORM (Object-Relational Mapping)</h2>
<div class='content'><p>ORMs can help prevent SQL injections by abstracting SQL queries and automatically handling input sanitization.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeGFtcGxlIGluIFB5dGhvbiB1c2luZyBTUUxBbGNoZW15IE9STQpmcm9tIHNxbGFsY2hlbXkgaW1wb3J0IGNyZWF0ZV9lbmdpbmUKZnJvbSBzcWxhbGNoZW15Lm9ybSBpbXBvcnQgc2Vzc2lvbm1ha2VyCmZyb20gbW9kZWxzIGltcG9ydCBVc2VyCgplbmdpbmUgPSBjcmVhdGVfZW5naW5lKCdzcWxpdGU6Ly8vZXhhbXBsZS5kYicpClNlc3Npb24gPSBzZXNzaW9ubWFrZXIoYmluZD1lbmdpbmUpCnNlc3Npb24gPSBTZXNzaW9uKCkKCmRlZiBnZXRfdXNlcl9pbmZvKHVzZXJfaWQpOgogICAgdXNlciA9IHNlc3Npb24ucXVlcnkoVXNlcikuZmlsdGVyKFVzZXIuaWQgPT0gdXNlcl9pZCkuZmlyc3QoKQogICAgcmV0dXJuIHVzZXI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Example in Python using SQLAlchemy ORM
from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker
from models import User

engine = create_engine('sqlite:///example.db')
Session = sessionmaker(bind=engine)
session = Session()

def get_user_info(user_id):
    user = session.query(User).filter(User.id == user_id).first()
    return user</pre></div><div class='content'></div><h1>Practical Exercises</h1>
<div class='content'><ol>
<li><strong>Injection Identification</strong>: Given a code snippet, identify if it is vulnerable to injection and explain why.</li>
<li><strong>Vulnerability Fixing</strong>: Modify a vulnerable code to make it secure using prepared statements.</li>
<li><strong>Validation Implementation</strong>: Implement validation and sanitization functions for user inputs in a web form.</li>
</ol>
</div><h1>Conclusion</h1>
<div class='content'><p>Injection is a critical vulnerability that can have devastating consequences for the security of an application. It is essential that developers understand how to identify and mitigate these vulnerabilities through the use of prepared statements, input validation and sanitization, and the use of ORM. Constant practice and code review are key to maintaining secure applications.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
