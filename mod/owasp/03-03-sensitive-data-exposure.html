<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A3: Sensitive Data Exposure</title>

    <link rel="alternate" href="https://campusempresa.com/mod/owasp/03-03-exposicion-datos-sensibles" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/owasp/03-03-exposicio-dades-sensibles" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/owasp/03-03-sensitive-data-exposure" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/owasp/03-03-exposicion-datos-sensibles" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/owasp/03-03-exposicio-dades-sensibles" class="px-2">CA</a>
					</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-02-broken-authentication' title="A2: Broken Authentication">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">A3: Sensitive Data Exposure</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='03-04-xxe' title="A4: XML External Entities (XXE)">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Sensitive Data Exposure is a critical issue in web application security. It occurs when applications do not adequately protect sensitive information such as financial data, healthcare information, or personal identifiers. This module will cover the key concepts, examples, and mitigation strategies for sensitive data exposure.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Sensitive Data</strong>: Information that must be protected from unauthorized access to safeguard the privacy or security of an individual or organization. Examples include:</p>
<ul>
<li>Personal Identifiable Information (PII)</li>
<li>Financial data (credit card numbers, bank account details)</li>
<li>Health records</li>
<li>Authentication credentials (passwords, tokens)</li>
</ul>
</li>
<li>
<p><strong>Data at Rest</strong>: Data stored on a device or server. Protection methods include encryption and access controls.</p>
</li>
<li>
<p><strong>Data in Transit</strong>: Data being transferred over a network. Protection methods include using secure communication protocols like HTTPS and TLS.</p>
</li>
<li>
<p><strong>Data in Use</strong>: Data actively being processed by an application. Protection methods include secure coding practices and memory management.</p>
</li>
</ol>
</div><h1><p>Common Vulnerabilities</p>
</h1>
<div class='content'><ol>
<li><strong>Unencrypted Data</strong>: Storing or transmitting sensitive data without encryption.</li>
<li><strong>Weak Encryption</strong>: Using outdated or weak encryption algorithms.</li>
<li><strong>Insecure Communication Channels</strong>: Transmitting data over unprotected channels.</li>
<li><strong>Improper Key Management</strong>: Poor handling of encryption keys, such as hardcoding them in the source code.</li>
<li><strong>Insufficient Access Controls</strong>: Allowing unauthorized access to sensitive data.</li>
</ol>
</div><h1><p>Examples</p>
</h1>
<div class='content'></div><h2><p>Example 1: Unencrypted Data Storage</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gU3RvcmluZyBjcmVkaXQgY2FyZCBpbmZvcm1hdGlvbiBpbiBwbGFpbiB0ZXh0CnsKICAiY3JlZGl0X2NhcmRfbnVtYmVyIjogIjEyMzQtNTY3OC05MDEyLTM0NTYiLAogICJleHBpcmF0aW9uX2RhdGUiOiAiMTIvMjMiLAogICJjdnYiOiAiMTIzIgp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Storing credit card information in plain text
{
  &quot;credit_card_number&quot;: &quot;1234-5678-9012-3456&quot;,
  &quot;expiration_date&quot;: &quot;12/23&quot;,
  &quot;cvv&quot;: &quot;123&quot;
}</pre></div><div class='content'></div><h2><p>Example 2: Insecure Communication</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gVHJhbnNtaXR0aW5nIHNlbnNpdGl2ZSBkYXRhIG92ZXIgSFRUUApQT1NUIGh0dHA6Ly9leGFtcGxlLmNvbS9sb2dpbgpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24KCnsKICAidXNlcm5hbWUiOiAidXNlcjEiLAogICJwYXNzd29yZCI6ICJwYXNzd29yZDEyMyIKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Transmitting sensitive data over HTTP
POST http://example.com/login
Content-Type: application/json

{
  &quot;username&quot;: &quot;user1&quot;,
  &quot;password&quot;: &quot;password123&quot;
}</pre></div><div class='content'></div><h1><p>Mitigation Strategies</p>
</h1>
<div class='content'><ol>
<li><strong>Encrypt Sensitive Data</strong>: Use strong encryption algorithms (e.g., AES-256) for data at rest and in transit.</li>
<li><strong>Use Secure Protocols</strong>: Ensure all data transmission uses secure protocols like HTTPS and TLS.</li>
<li><strong>Implement Proper Key Management</strong>: Use secure methods for key generation, storage, and rotation.</li>
<li><strong>Apply Access Controls</strong>: Restrict access to sensitive data based on the principle of least privilege.</li>
<li><strong>Regularly Update and Patch</strong>: Keep encryption libraries and protocols up to date to protect against vulnerabilities.</li>
</ol>
</div><h1><p>Practical Example</p>
</h1>
<div class='content'></div><h2><p>Encrypting Data at Rest</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBjcnlwdG9ncmFwaHkuZmVybmV0IGltcG9ydCBGZXJuZXQKCiMgR2VuZXJhdGUgYSBrZXkgZm9yIGVuY3J5cHRpb24Ka2V5ID0gRmVybmV0LmdlbmVyYXRlX2tleSgpCmNpcGhlcl9zdWl0ZSA9IEZlcm5ldChrZXkpCgojIEVuY3J5cHQgc2Vuc2l0aXZlIGRhdGEKY3JlZGl0X2NhcmRfbnVtYmVyID0gIjEyMzQtNTY3OC05MDEyLTM0NTYiCmVuY3J5cHRlZF9kYXRhID0gY2lwaGVyX3N1aXRlLmVuY3J5cHQoY3JlZGl0X2NhcmRfbnVtYmVyLmVuY29kZSgpKQoKcHJpbnQoZiJFbmNyeXB0ZWQgRGF0YToge2VuY3J5cHRlZF9kYXRhfSIpCgojIERlY3J5cHQgc2Vuc2l0aXZlIGRhdGEKZGVjcnlwdGVkX2RhdGEgPSBjaXBoZXJfc3VpdGUuZGVjcnlwdChlbmNyeXB0ZWRfZGF0YSkuZGVjb2RlKCkKcHJpbnQoZiJEZWNyeXB0ZWQgRGF0YToge2RlY3J5cHRlZF9kYXRhfSIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from cryptography.fernet import Fernet

# Generate a key for encryption
key = Fernet.generate_key()
cipher_suite = Fernet(key)

# Encrypt sensitive data
credit_card_number = &quot;1234-5678-9012-3456&quot;
encrypted_data = cipher_suite.encrypt(credit_card_number.encode())

print(f&quot;Encrypted Data: {encrypted_data}&quot;)

# Decrypt sensitive data
decrypted_data = cipher_suite.decrypt(encrypted_data).decode()
print(f&quot;Decrypted Data: {decrypted_data}&quot;)</pre></div><div class='content'></div><h2><p>Using HTTPS for Secure Communication</p>
</h2>
<div class='content'><p>Ensure your web server is configured to use HTTPS. For example, in an Apache server, you can enable HTTPS by configuring the <code>ssl.conf</code> file:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PFZpcnR1YWxIb3N0ICo6NDQzPgogICAgU2VydmVyTmFtZSBleGFtcGxlLmNvbQogICAgRG9jdW1lbnRSb290IC92YXIvd3d3L2h0bWwKCiAgICBTU0xFbmdpbmUgb24KICAgIFNTTENlcnRpZmljYXRlRmlsZSAvcGF0aC90by9jZXJ0aWZpY2F0ZS5jcnQKICAgIFNTTENlcnRpZmljYXRlS2V5RmlsZSAvcGF0aC90by9wcml2YXRlLmtleQo8L1ZpcnR1YWxIb3N0Pg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;VirtualHost *:443&gt;
    ServerName example.com
    DocumentRoot /var/www/html

    SSLEngine on
    SSLCertificateFile /path/to/certificate.crt
    SSLCertificateKeyFile /path/to/private.key
&lt;/VirtualHost&gt;</pre></div><div class='content'></div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Encrypting Sensitive Data</p>
</h2>
<div class='content'><p><strong>Task</strong>: Write a Python script that encrypts and decrypts a user's password using the <code>cryptography</code> library.</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Install the <code>cryptography</code> library if not already installed.</li>
<li>Generate an encryption key.</li>
<li>Encrypt a sample password.</li>
<li>Decrypt the encrypted password and verify it matches the original password.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBjcnlwdG9ncmFwaHkuZmVybmV0IGltcG9ydCBGZXJuZXQKCiMgU3RlcCAxOiBHZW5lcmF0ZSBhIGtleSBmb3IgZW5jcnlwdGlvbgprZXkgPSBGZXJuZXQuZ2VuZXJhdGVfa2V5KCkKY2lwaGVyX3N1aXRlID0gRmVybmV0KGtleSkKCiMgU3RlcCAyOiBFbmNyeXB0IGEgc2FtcGxlIHBhc3N3b3JkCnBhc3N3b3JkID0gInNlY3VyZXBhc3N3b3JkMTIzIgplbmNyeXB0ZWRfcGFzc3dvcmQgPSBjaXBoZXJfc3VpdGUuZW5jcnlwdChwYXNzd29yZC5lbmNvZGUoKSkKCnByaW50KGYiRW5jcnlwdGVkIFBhc3N3b3JkOiB7ZW5jcnlwdGVkX3Bhc3N3b3JkfSIpCgojIFN0ZXAgMzogRGVjcnlwdCB0aGUgZW5jcnlwdGVkIHBhc3N3b3JkCmRlY3J5cHRlZF9wYXNzd29yZCA9IGNpcGhlcl9zdWl0ZS5kZWNyeXB0KGVuY3J5cHRlZF9wYXNzd29yZCkuZGVjb2RlKCkKcHJpbnQoZiJEZWNyeXB0ZWQgUGFzc3dvcmQ6IHtkZWNyeXB0ZWRfcGFzc3dvcmR9IikKCiMgVmVyaWZ5IHRoZSBkZWNyeXB0ZWQgcGFzc3dvcmQgbWF0Y2hlcyB0aGUgb3JpZ2luYWwgcGFzc3dvcmQKYXNzZXJ0IHBhc3N3b3JkID09IGRlY3J5cHRlZF9wYXNzd29yZCwgIlBhc3N3b3JkcyBkbyBub3QgbWF0Y2ghIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from cryptography.fernet import Fernet

# Step 1: Generate a key for encryption
key = Fernet.generate_key()
cipher_suite = Fernet(key)

# Step 2: Encrypt a sample password
password = &quot;securepassword123&quot;
encrypted_password = cipher_suite.encrypt(password.encode())

print(f&quot;Encrypted Password: {encrypted_password}&quot;)

# Step 3: Decrypt the encrypted password
decrypted_password = cipher_suite.decrypt(encrypted_password).decode()
print(f&quot;Decrypted Password: {decrypted_password}&quot;)

# Verify the decrypted password matches the original password
assert password == decrypted_password, &quot;Passwords do not match!&quot;</pre></div><div class='content'></div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li>
<p><strong>Mistake</strong>: Storing encryption keys in the source code.</p>
<ul>
<li><strong>Tip</strong>: Use environment variables or secure key management services to store keys.</li>
</ul>
</li>
<li>
<p><strong>Mistake</strong>: Using outdated encryption algorithms.</p>
<ul>
<li><strong>Tip</strong>: Regularly review and update your encryption methods to use the latest standards.</li>
</ul>
</li>
<li>
<p><strong>Mistake</strong>: Transmitting sensitive data over HTTP.</p>
<ul>
<li><strong>Tip</strong>: Always use HTTPS for data transmission.</li>
</ul>
</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Sensitive Data Exposure is a significant risk in web application security. By understanding the types of sensitive data, common vulnerabilities, and implementing robust encryption and secure communication practices, you can protect your applications from data breaches and unauthorized access. In the next module, we will explore the topic of XML External Entities (XXE) and how to mitigate related risks.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-02-broken-authentication' title="A2: Broken Authentication">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='03-04-xxe' title="A4: XML External Entities (XXE)">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
