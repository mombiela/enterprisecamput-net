<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automating Security Tests</title>

    <link rel="alternate" href="https://campusempresa.com/mod/owasp/06-04-automatizacion-pruebas-seguridad" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/owasp/06-04-automatitzacio-proves-seguretat" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/owasp/06-04-automating-security-tests" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/owasp/06-04-automatizacion-pruebas-seguridad" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/owasp/06-04-automatitzacio-proves-seguretat" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='06-03-vulnerability-scanning' title="Vulnerability Scanning">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Automating Security Tests</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-01-sdlc' title="Secure Development Lifecycle (SDLC)">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Automating security tests is a crucial aspect of ensuring continuous security in web applications. By integrating automated security testing into your development pipeline, you can identify and mitigate vulnerabilities early in the development process, reducing the risk of security breaches. This section will cover the basics of automating security tests using OWASP ZAP (Zed Attack Proxy), including practical examples and exercises.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li>
<p><strong>Continuous Integration (CI) and Continuous Deployment (CD):</strong></p>
<ul>
<li>Integrating security tests into CI/CD pipelines ensures that security checks are performed automatically with every code change.</li>
</ul>
</li>
<li>
<p><strong>Automated Security Testing Tools:</strong></p>
<ul>
<li>Tools like OWASP ZAP can be configured to run automated security tests, providing immediate feedback on potential vulnerabilities.</li>
</ul>
</li>
<li>
<p><strong>Types of Automated Security Tests:</strong></p>
<ul>
<li><strong>Static Application Security Testing (SAST):</strong> Analyzes source code for vulnerabilities.</li>
<li><strong>Dynamic Application Security Testing (DAST):</strong> Tests the running application for vulnerabilities.</li>
<li><strong>Interactive Application Security Testing (IAST):</strong> Combines elements of SAST and DAST to provide more comprehensive security testing.</li>
</ul>
</li>
</ol>
</div><h1>Setting Up OWASP ZAP for Automation</h1>
<div class='content'></div><h2>Installation</h2>
<div class='content'><p>Before automating security tests, ensure that OWASP ZAP is installed and configured correctly. Refer to the <a href="06-02-installation-configuration">Installation and Configuration</a> section for detailed instructions.</p>
</div><h2>Configuring ZAP for Automation</h2>
<div class='content'><ol>
<li>
<p><strong>API Configuration:</strong></p>
<ul>
<li>OWASP ZAP provides a REST API that allows you to automate security tests programmatically.</li>
<li>Ensure the API is enabled and configured with appropriate security settings.</li>
</ul>
</li>
<li>
<p><strong>ZAP Scripts:</strong></p>
<ul>
<li>ZAP supports scripting in various languages (e.g., Python, JavaScript) to customize and automate security tests.</li>
</ul>
</li>
</ol>
</div><h2>Example: Automating Security Tests with OWASP ZAP</h2>
<div class='content'><p>Below is a practical example of how to automate security tests using OWASP ZAP and a simple Python script.</p>
<h4>Python Script for Automating ZAP Scans</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHJlcXVlc3RzCmltcG9ydCB0aW1lCgojIFpBUCBBUEkgY29uZmlndXJhdGlvbgp6YXBfdXJsID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MCcKYXBpX2tleSA9ICd5b3VyX2FwaV9rZXlfaGVyZScKCiMgVGFyZ2V0IGFwcGxpY2F0aW9uIFVSTAp0YXJnZXRfdXJsID0gJ2h0dHA6Ly9leGFtcGxlLmNvbScKCiMgU3RhcnQgYSBuZXcgc2Vzc2lvbgpyZXF1ZXN0cy5nZXQoZid7emFwX3VybH0vSlNPTi9jb3JlL2FjdGlvbi9uZXdTZXNzaW9uLycsIHBhcmFtcz17J2FwaWtleSc6IGFwaV9rZXl9KQoKIyBBY2Nlc3MgdGhlIHRhcmdldCBVUkwKcmVxdWVzdHMuZ2V0KGYne3phcF91cmx9L0pTT04vY29yZS9hY3Rpb24vYWNjZXNzVXJsLycsIHBhcmFtcz17J2FwaWtleSc6IGFwaV9rZXksICd1cmwnOiB0YXJnZXRfdXJsfSkKCiMgU3RhcnQgdGhlIHNwaWRlciB0byBjcmF3bCB0aGUgdGFyZ2V0IGFwcGxpY2F0aW9uCnJlcXVlc3RzLmdldChmJ3t6YXBfdXJsfS9KU09OL3NwaWRlci9hY3Rpb24vc2Nhbi8nLCBwYXJhbXM9eydhcGlrZXknOiBhcGlfa2V5LCAndXJsJzogdGFyZ2V0X3VybH0pCgojIFdhaXQgZm9yIHRoZSBzcGlkZXIgdG8gY29tcGxldGUKd2hpbGUgaW50KHJlcXVlc3RzLmdldChmJ3t6YXBfdXJsfS9KU09OL3NwaWRlci92aWV3L3N0YXR1cy8nLCBwYXJhbXM9eydhcGlrZXknOiBhcGlfa2V5fSkuanNvbigpWydzdGF0dXMnXSkgPCAxMDA6CiAgICBwcmludCgnU3BpZGVyIGluIHByb2dyZXNzLi4uJykKICAgIHRpbWUuc2xlZXAoNSkKCnByaW50KCdTcGlkZXIgY29tcGxldGVkLicpCgojIFN0YXJ0IHRoZSBhY3RpdmUgc2NhbgpyZXF1ZXN0cy5nZXQoZid7emFwX3VybH0vSlNPTi9hc2Nhbi9hY3Rpb24vc2Nhbi8nLCBwYXJhbXM9eydhcGlrZXknOiBhcGlfa2V5LCAndXJsJzogdGFyZ2V0X3VybH0pCgojIFdhaXQgZm9yIHRoZSBhY3RpdmUgc2NhbiB0byBjb21wbGV0ZQp3aGlsZSBpbnQocmVxdWVzdHMuZ2V0KGYne3phcF91cmx9L0pTT04vYXNjYW4vdmlldy9zdGF0dXMvJywgcGFyYW1zPXsnYXBpa2V5JzogYXBpX2tleX0pLmpzb24oKVsnc3RhdHVzJ10pIDwgMTAwOgogICAgcHJpbnQoJ0FjdGl2ZSBzY2FuIGluIHByb2dyZXNzLi4uJykKICAgIHRpbWUuc2xlZXAoNSkKCnByaW50KCdBY3RpdmUgc2NhbiBjb21wbGV0ZWQuJykKCiMgUmV0cmlldmUgdGhlIHNjYW4gcmVzdWx0cwphbGVydHMgPSByZXF1ZXN0cy5nZXQoZid7emFwX3VybH0vSlNPTi9jb3JlL3ZpZXcvYWxlcnRzLycsIHBhcmFtcz17J2FwaWtleSc6IGFwaV9rZXksICdiYXNldXJsJzogdGFyZ2V0X3VybH0pLmpzb24oKVsnYWxlcnRzJ10KCiMgUHJpbnQgdGhlIHJlc3VsdHMKZm9yIGFsZXJ0IGluIGFsZXJ0czoKICAgIHByaW50KGYiQWxlcnQ6IHthbGVydFsnYWxlcnQnXX0sIFJpc2s6IHthbGVydFsncmlzayddfSwgVVJMOiB7YWxlcnRbJ3VybCddfSIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import requests
import time

# ZAP API configuration
zap_url = 'http://localhost:8080'
api_key = 'your_api_key_here'

# Target application URL
target_url = 'http://example.com'

# Start a new session
requests.get(f'{zap_url}/JSON/core/action/newSession/', params={'apikey': api_key})

# Access the target URL
requests.get(f'{zap_url}/JSON/core/action/accessUrl/', params={'apikey': api_key, 'url': target_url})

# Start the spider to crawl the target application
requests.get(f'{zap_url}/JSON/spider/action/scan/', params={'apikey': api_key, 'url': target_url})

# Wait for the spider to complete
while int(requests.get(f'{zap_url}/JSON/spider/view/status/', params={'apikey': api_key}).json()['status']) &lt; 100:
    print('Spider in progress...')
    time.sleep(5)

print('Spider completed.')

# Start the active scan
requests.get(f'{zap_url}/JSON/ascan/action/scan/', params={'apikey': api_key, 'url': target_url})

# Wait for the active scan to complete
while int(requests.get(f'{zap_url}/JSON/ascan/view/status/', params={'apikey': api_key}).json()['status']) &lt; 100:
    print('Active scan in progress...')
    time.sleep(5)

print('Active scan completed.')

# Retrieve the scan results
alerts = requests.get(f'{zap_url}/JSON/core/view/alerts/', params={'apikey': api_key, 'baseurl': target_url}).json()['alerts']

# Print the results
for alert in alerts:
    print(f&quot;Alert: {alert['alert']}, Risk: {alert['risk']}, URL: {alert['url']}&quot;)</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ol>
<li>
<p><strong>Session Management:</strong></p>
<ul>
<li>The script starts a new session in ZAP to ensure a clean slate for each scan.</li>
</ul>
</li>
<li>
<p><strong>Spidering:</strong></p>
<ul>
<li>The spider crawls the target application to discover all accessible URLs.</li>
</ul>
</li>
<li>
<p><strong>Active Scanning:</strong></p>
<ul>
<li>The active scan tests the discovered URLs for vulnerabilities.</li>
</ul>
</li>
<li>
<p><strong>Results Retrieval:</strong></p>
<ul>
<li>The script retrieves and prints the scan results, including the alert name, risk level, and affected URL.</li>
</ul>
</li>
</ol>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Automate a Security Test for a Sample Web Application</h2>
<div class='content'><ol>
<li>
<p><strong>Objective:</strong></p>
<ul>
<li>Automate a security test for a sample web application using OWASP ZAP and a Python script.</li>
</ul>
</li>
<li>
<p><strong>Steps:</strong></p>
<ul>
<li>Install and configure OWASP ZAP.</li>
<li>Write a Python script to automate the security test.</li>
<li>Run the script and analyze the results.</li>
</ul>
</li>
<li>
<p><strong>Solution:</strong></p>
<ul>
<li>Follow the example script provided above.</li>
<li>Modify the <code>target_url</code> to point to your sample web application.</li>
<li>Ensure ZAP is running and the API key is correctly configured.</li>
</ul>
</li>
</ol>
</div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li>
<p><strong>API Key Configuration:</strong></p>
<ul>
<li>Ensure the API key is correctly configured and passed in the script to avoid authentication errors.</li>
</ul>
</li>
<li>
<p><strong>Handling Large Applications:</strong></p>
<ul>
<li>For large applications, consider increasing the timeout values to allow the spider and active scan to complete.</li>
</ul>
</li>
<li>
<p><strong>Result Analysis:</strong></p>
<ul>
<li>Review the scan results carefully to identify and prioritize vulnerabilities based on their risk levels.</li>
</ul>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Automating security tests with OWASP ZAP helps integrate security into the development lifecycle, providing continuous and proactive security assessments. By following the steps and examples provided in this section, you can effectively automate security tests and enhance the security posture of your web applications.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-03-vulnerability-scanning' title="Vulnerability Scanning">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-01-sdlc' title="Secure Development Lifecycle (SDLC)">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
