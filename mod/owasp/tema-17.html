<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A09:2021 - Security Logging and Monitoring Failures</title>

    <link rel="alternate" href="https://campusempresa.com/mod/owasp/tema-17" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/owasp/tema-17" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/owasp/tema-17" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/owasp/tema-17" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/owasp/tema-17" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Security in logging and monitoring is crucial to detect and respond to security incidents. The lack of adequate logs and the inability to monitor security events can lead organizations to not detect ongoing attacks and not respond appropriately.</p>
</div><h1>Importance of Security Logging and Monitoring</h1>
<div class='content'><ul>
<li><strong>Incident Detection</strong>: Security logs help identify suspicious activities and potential security breaches.</li>
<li><strong>Incident Response</strong>: They allow for a quick and appropriate response to security incidents.</li>
<li><strong>Regulatory Compliance</strong>: Many regulations require detailed logs of security events.</li>
<li><strong>Forensic Analysis</strong>: Detailed logs are essential to investigate security incidents and understand how they occurred.</li>
</ul>
</div><h1>Main Failures in Security Logging and Monitoring</h1>
<div class='content'><ul>
<li><strong>Lack of Logs</strong>: Not logging critical security events.</li>
<li><strong>Insufficient Logs</strong>: Logging insufficient information to detect incidents.</li>
<li><strong>Inadequate Monitoring</strong>: Not monitoring security logs in real-time.</li>
<li><strong>Insecure Log Storage</strong>: Not adequately protecting security logs.</li>
<li><strong>Lack of Alerts</strong>: Not generating alerts when suspicious events are detected.</li>
</ul>
</div><h1>Best Practices for Security Logging and Monitoring</h1>
<div class='content'><ul>
<li><strong>Complete Logging</strong>: Ensure all relevant security events are logged.</li>
<li><strong>Continuous Monitoring</strong>: Implement real-time monitoring of security logs.</li>
<li><strong>Log Protection</strong>: Ensure security logs are protected against unauthorized access.</li>
<li><strong>Alert Generation</strong>: Configure alerts for critical security events.</li>
<li><strong>Regular Review</strong>: Regularly review and analyze security logs.</li>
</ul>
</div><h1>Example of Logging and Monitoring Implementation</h1>
<div class='content'></div><h2>Logging Configuration in a Web Application</h2>
<div class='content'><p>Below is an example of how to configure security event logging in a web application using Python and the Flask framework.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QKaW1wb3J0IGxvZ2dpbmcKCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQoKIyBMb2dnZXIgY29uZmlndXJhdGlvbgpsb2dnaW5nLmJhc2ljQ29uZmlnKGZpbGVuYW1lPSdhcHAubG9nJywgbGV2ZWw9bG9nZ2luZy5JTkZPLCAKICAgICAgICAgICAgICAgICAgICBmb3JtYXQ9JyUoYXNjdGltZSlzICUobGV2ZWxuYW1lKXMgJShuYW1lKXMgJShtZXNzYWdlKXMnKQoKQGFwcC5yb3V0ZSgnL2xvZ2luJywgbWV0aG9kcz1bJ1BPU1QnXSkKZGVmIGxvZ2luKCk6CiAgICB1c2VybmFtZSA9IHJlcXVlc3QuZm9ybVsndXNlcm5hbWUnXQogICAgcGFzc3dvcmQgPSByZXF1ZXN0LmZvcm1bJ3Bhc3N3b3JkJ10KICAgIAogICAgIyBMb2cgdGhlIGxvZ2luIGF0dGVtcHQKICAgIGxvZ2dpbmcuaW5mbyhmJ0xvZ2luIGF0dGVtcHQ6IHt1c2VybmFtZX0nKQogICAgCiAgICAjIEF1dGhlbnRpY2F0aW9uIGxvZ2ljIChzaW1wbGlmaWVkKQogICAgaWYgdXNlcm5hbWUgPT0gJ2FkbWluJyBhbmQgcGFzc3dvcmQgPT0gJ3NlY3JldCc6CiAgICAgICAgcmV0dXJuICdMb2dpbiBzdWNjZXNzZnVsJwogICAgZWxzZToKICAgICAgICBsb2dnaW5nLndhcm5pbmcoZidMb2dpbiBmYWlsdXJlOiB7dXNlcm5hbWV9JykKICAgICAgICByZXR1cm4gJ0xvZ2luIGZhaWxlZCcKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBhcHAucnVuKGRlYnVnPVRydWUp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, request
import logging

app = Flask(__name__)

# Logger configuration
logging.basicConfig(filename='app.log', level=logging.INFO, 
                    format='%(asctime)s %(levelname)s %(name)s %(message)s')

@app.route('/login', methods=['POST'])
def login():
    username = request.form['username']
    password = request.form['password']
    
    # Log the login attempt
    logging.info(f'Login attempt: {username}')
    
    # Authentication logic (simplified)
    if username == 'admin' and password == 'secret':
        return 'Login successful'
    else:
        logging.warning(f'Login failure: {username}')
        return 'Login failed'

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'></div><h2>Code Explanation</h2>
<div class='content'><ul>
<li><strong>Logger Configuration</strong>: The logger is configured to log events in a file called <code>app.log</code> with a logging level of <code>INFO</code>.</li>
<li><strong>Logging Login Attempts</strong>: Each login attempt is logged with an information message.</li>
<li><strong>Logging Login Failures</strong>: If the login fails, a warning message is logged.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Security logging and monitoring are essential components of an effective security strategy. Implementing best practices in logging and monitoring helps detect and respond to security incidents in a timely manner, protects sensitive information, and ensures regulatory compliance. Make sure to configure complete logs, monitor in real-time, protect logs, and regularly review security events to maintain a robust security posture.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
