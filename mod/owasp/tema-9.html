<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A01:2021 - Broken Access Control</title>

    <link rel="alternate" href="https://campusempresa.com/mod/owasp/tema-9" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/owasp/tema-9" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/owasp/tema-9" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body  class="test" >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/owasp/tema-9" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/owasp/tema-9" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
									<div class="assert">
						<p><b>Attention!</b> There has been an error in the course generation, and it may contain translation errors.We are working to resolve this issue, so please use the content with caution.You can check the correct content in another language at the following link:<br>
						<a href="https://campusempresa.com/mod/owasp/tema-9">https://campusempresa.com/mod/owasp/tema-9</a></p>
					</div>
								<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Access control is a fundamental mechanism in web application security. It refers to the policies and procedures that determine who can access which resources in an application. The problem of &quot;Broken Access Control&quot; occurs when these policies are not implemented correctly, allowing unauthorized users to access restricted resources.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Access Control</strong>: A set of mechanisms that restrict access to resources to authorized users.</li>
<li><strong>Authentication vs. Authorization</strong>:
<ul>
<li><strong>Authentication</strong>: Verification of the user's identity.</li>
<li><strong>Authorization</strong>: Determination of the authenticated user's permissions.</li>
</ul>
</li>
<li><strong>Principle of Least Privilege</strong>: Users should have only the permissions necessary to perform their tasks.</li>
</ul>
</div><h1>Common Types of Access Control Failures</h1>
<div class='content'><ul>
<li><strong>Authorization Bypass</strong>: Access to resources without going through authorization controls.</li>
<li><strong>Privilege Escalation</strong>: A user obtains higher permissions than they should have.</li>
<li><strong>Direct Object Access</strong>: Access to resources by manipulating URLs, parameters, or forms.</li>
</ul>
</div><h1>Examples of Broken Access Control</h1>
<div class='content'></div><h2>Example 1: Direct Object Access</h2>
<div class='content'><p>A user can access another user's data by manipulating the URL.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBPcmlnaW5hbCBVUkwgdG8gYWNjZXNzIHVzZXIgZGF0YQpodHRwOi8vZXhhbXBsZS5jb20vdXNlci8xMjMKCiMgVVJMIG1hbmlwdWxhdGlvbiB0byBhY2Nlc3MgYW5vdGhlciB1c2VyJ3MgZGF0YQpodHRwOi8vZXhhbXBsZS5jb20vdXNlci8xMjQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Original URL to access user data
http://example.com/user/123

# URL manipulation to access another user's data
http://example.com/user/124</pre></div><div class='content'></div><h2>Example 2: Privilege Escalation</h2>
<div class='content'><p>A regular user attempts to access an admin page.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBVUkwgZm9yIHJlZ3VsYXIgdXNlcnMKaHR0cDovL2V4YW1wbGUuY29tL3VzZXIvZGFzaGJvYXJkCgojIFVSTCBmb3IgYWRtaW5pc3RyYXRvcnMKaHR0cDovL2V4YW1wbGUuY29tL2FkbWluL2Rhc2hib2FyZA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># URL for regular users
http://example.com/user/dashboard

# URL for administrators
http://example.com/admin/dashboard</pre></div><div class='content'><p>If access control is not well implemented, a regular user could access the admin page.</p>
</div><h1>Best Practices to Prevent Broken Access Control</h1>
<div class='content'><ul>
<li><strong>Implement access controls on the server</strong>: Do not rely on access controls implemented only on the client.</li>
<li><strong>Use access control lists (ACLs)</strong>: Clearly define which users have access to which resources.</li>
<li><strong>Review and audit permissions regularly</strong>: Ensure that the assigned permissions are correct.</li>
<li><strong>Principle of Least Privilege</strong>: Assign only the necessary permissions to each user.</li>
<li><strong>Validate access on each request</strong>: Do not assume that a user has access to a resource based on a previous request.</li>
</ul>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise 1: Identifying Access Control Failures</h2>
<div class='content'><p>Given the following code, identify and correct the access control issues.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBPcmlnaW5hbCBjb2RlCmRlZiBnZXRfdXNlcl9kYXRhKHVzZXJfaWQpOgogICAgdXNlciA9IGRiLmdldF91c2VyKHVzZXJfaWQpCiAgICByZXR1cm4gdXNlci5kYXRhCgojIENvcnJlY3RlZCBjb2RlCmRlZiBnZXRfdXNlcl9kYXRhKGN1cnJlbnRfdXNlciwgdXNlcl9pZCk6CiAgICBpZiBjdXJyZW50X3VzZXIuaWQgIT0gdXNlcl9pZCBhbmQgbm90IGN1cnJlbnRfdXNlci5pc19hZG1pbjoKICAgICAgICByYWlzZSBQZXJtaXNzaW9uRXJyb3IoIkFjY2VzcyBEZW5pZWQiKQogICAgdXNlciA9IGRiLmdldF91c2VyKHVzZXJfaWQpCiAgICByZXR1cm4gdXNlci5kYXRh"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Original code
def get_user_data(user_id):
    user = db.get_user(user_id)
    return user.data

# Corrected code
def get_user_data(current_user, user_id):
    if current_user.id != user_id and not current_user.is_admin:
        raise PermissionError(&quot;Access Denied&quot;)
    user = db.get_user(user_id)
    return user.data</pre></div><div class='content'></div><h2>Exercise 2: Implementing Access Control</h2>
<div class='content'><p>Implement basic access control for a web application in Python using Flask.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QsIGpzb25pZnkKCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQoKIyBTaW11bGF0ZWQgdXNlciBkYXRhYmFzZQp1c2Vyc19kYiA9IHsKICAgIDE6IHsiaWQiOiAxLCAibmFtZSI6ICJBbGljZSIsICJyb2xlIjogInVzZXIifSwKICAgIDI6IHsiaWQiOiAyLCAibmFtZSI6ICJCb2IiLCAicm9sZSI6ICJhZG1pbiJ9Cn0KCmRlZiBnZXRfY3VycmVudF91c2VyKCk6CiAgICAjIFNpbXVsYXRlZCBhdXRoZW50aWNhdGlvbgogICAgdXNlcl9pZCA9IGludChyZXF1ZXN0LmhlYWRlcnMuZ2V0KCdYLVVzZXItSUQnKSkKICAgIHJldHVybiB1c2Vyc19kYi5nZXQodXNlcl9pZCkKCkBhcHAucm91dGUoJy9hZG1pbicsIG1ldGhvZHM9WydHRVQnXSkKZGVmIGFkbWluX2Rhc2hib2FyZCgpOgogICAgY3VycmVudF91c2VyID0gZ2V0X2N1cnJlbnRfdXNlcigpCiAgICBpZiBjdXJyZW50X3VzZXJbJ3JvbGUnXSAhPSAnYWRtaW4nOgogICAgICAgIHJldHVybiBqc29uaWZ5KHsiZXJyb3IiOiAiQWNjZXNzIERlbmllZCJ9KSwgNDAzCiAgICByZXR1cm4ganNvbmlmeSh7Im1lc3NhZ2UiOiAiV2VsY29tZSB0byB0aGUgYWRtaW4gZGFzaGJvYXJkIn0pCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgYXBwLnJ1bihkZWJ1Zz1UcnVlKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, request, jsonify

app = Flask(__name__)

# Simulated user database
users_db = {
    1: {&quot;id&quot;: 1, &quot;name&quot;: &quot;Alice&quot;, &quot;role&quot;: &quot;user&quot;},
    2: {&quot;id&quot;: 2, &quot;name&quot;: &quot;Bob&quot;, &quot;role&quot;: &quot;admin&quot;}
}

def get_current_user():
    # Simulated authentication
    user_id = int(request.headers.get('X-User-ID'))
    return users_db.get(user_id)

@app.route('/admin', methods=['GET'])
def admin_dashboard():
    current_user = get_current_user()
    if current_user['role'] != 'admin':
        return jsonify({&quot;error&quot;: &quot;Access Denied&quot;}), 403
    return jsonify({&quot;message&quot;: &quot;Welcome to the admin dashboard&quot;})

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Access control is a critical part of web application security. Failures in access control can allow unauthorized users to access restricted resources, which can have serious consequences. Implementing robust access controls and following best practices can help prevent these issues and protect the integrity and confidentiality of data.</p>
</div>
			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
