<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Benchmarking</title>

    <link rel="alternate" href="https://campusempresa.com/mod/go/06-04-benchmarking" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/go/06-04-benchmarking" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/go/06-04-benchmarking" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=3" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/go/06-04-benchmarking" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/go/06-04-benchmarking" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>Building today's and tomorrow's society</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Languages</a>
				 					<a href="/categ/frameworks">Frameworks</a>
				 					<a href="/categ/tech-tools">Tools</a>
				 					<a href="/categ/foundations">Foundations</a>
				 					<a href="/categ/soft-skills">Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-03-testing' title="Testing">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Benchmarking</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-01-building-a-simple-web-server' title="Building a Simple Web Server">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Benchmarking is a crucial aspect of software development that helps you measure the performance of your code. In Go, the <code>testing</code> package provides built-in support for writing benchmarks. This section will cover the basics of benchmarking in Go, including how to write and run benchmarks, interpret the results, and optimize your code based on the findings.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Benchmark Functions</strong>: Functions that measure the performance of a piece of code.</li>
<li><strong>Benchmarking Syntax</strong>: The specific way to write benchmark functions in Go.</li>
<li><strong>Running Benchmarks</strong>: How to execute benchmark tests.</li>
<li><strong>Interpreting Results</strong>: Understanding the output of benchmark tests.</li>
<li><strong>Optimizing Code</strong>: Making improvements based on benchmark results.</li>
</ol>
</div><h1><p>Writing Benchmark Functions</p>
</h1>
<div class='content'><p>Benchmark functions in Go are similar to test functions but have a specific signature and naming convention. They must start with <code>Benchmark</code> and take a single argument of type <code>*testing.B</code>.</p>
</div><h2><p>Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGFja2FnZSBtYWluCgppbXBvcnQgKAogICAgInRlc3RpbmciCikKCi8vIEZ1bmN0aW9uIHRvIGJlIGJlbmNobWFya2VkCmZ1bmMgU3VtKGEsIGIgaW50KSBpbnQgewogICAgcmV0dXJuIGEgKyBiCn0KCi8vIEJlbmNobWFyayBmdW5jdGlvbgpmdW5jIEJlbmNobWFya1N1bShiICp0ZXN0aW5nLkIpIHsKICAgIGZvciBpIDo9IDA7IGkgPCBiLk47IGkrKyB7CiAgICAgICAgU3VtKDEsIDIpCiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>package main

import (
    &quot;testing&quot;
)

// Function to be benchmarked
func Sum(a, b int) int {
    return a + b
}

// Benchmark function
func BenchmarkSum(b *testing.B) {
    for i := 0; i &lt; b.N; i++ {
        Sum(1, 2)
    }
}</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>Function to be benchmarked</strong>: <code>Sum</code> is a simple function that adds two integers.</li>
<li><strong>Benchmark function</strong>: <code>BenchmarkSum</code> runs the <code>Sum</code> function <code>b.N</code> times. The <code>b.N</code> is a variable that the benchmarking framework uses to determine how many iterations to run.</li>
</ul>
</div><h1><p>Running Benchmarks</p>
</h1>
<div class='content'><p>To run benchmarks, use the <code>go test</code> command with the <code>-bench</code> flag.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z28gdGVzdCAtYmVuY2g9Lg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>go test -bench=.</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><code>-bench=.</code>: Runs all benchmarks in the current package. You can specify a particular benchmark by replacing <code>.</code> with the name of the benchmark function.</li>
</ul>
</div><h1><p>Interpreting Results</p>
</h1>
<div class='content'><p>The output of a benchmark test provides several key metrics:</p>
<ul>
<li><strong>ns/op</strong>: Nanoseconds per operation.</li>
<li><strong>B/op</strong>: Bytes allocated per operation.</li>
<li><strong>allocs/op</strong>: Allocations per operation.</li>
</ul>
</div><h2><p>Example Output</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z29vczogZGFyd2luCmdvYXJjaDogYW1kNjQKcGtnOiBleGFtcGxlCkJlbmNobWFya1N1bS04ICAgCTIwMDAwMDAwMDAJICAgICAgICAgMC4yOSBucy9vcApQQVNTCm9rICAJZXhhbXBsZQkwLjU4MnM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>goos: darwin
goarch: amd64
pkg: example
BenchmarkSum-8   	2000000000	         0.29 ns/op
PASS
ok  	example	0.582s</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>BenchmarkSum-8</strong>: The name of the benchmark and the number of CPU cores used.</li>
<li><strong>2000000000</strong>: The number of iterations.</li>
<li><strong>0.29 ns/op</strong>: The average time per operation.</li>
</ul>
</div><h1><p>Optimizing Code</p>
</h1>
<div class='content'><p>Based on the benchmark results, you can identify bottlenecks and optimize your code. Here are some common optimization techniques:</p>
<ol>
<li><strong>Reduce Allocations</strong>: Minimize memory allocations to improve performance.</li>
<li><strong>Algorithm Optimization</strong>: Use more efficient algorithms.</li>
<li><strong>Concurrency</strong>: Utilize Go's concurrency features like goroutines and channels.</li>
</ol>
</div><h2><p>Example Optimization</p>
</h2>
<div class='content'><p>Suppose the <code>Sum</code> function was more complex and involved unnecessary memory allocations. You could optimize it by reducing these allocations.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGFja2FnZSBtYWluCgppbXBvcnQgKAogICAgInRlc3RpbmciCikKCi8vIE9wdGltaXplZCBmdW5jdGlvbiB0byBiZSBiZW5jaG1hcmtlZApmdW5jIE9wdGltaXplZFN1bShhLCBiIGludCkgaW50IHsKICAgIHJldHVybiBhICsgYgp9CgovLyBCZW5jaG1hcmsgZnVuY3Rpb24gZm9yIG9wdGltaXplZCBjb2RlCmZ1bmMgQmVuY2htYXJrT3B0aW1pemVkU3VtKGIgKnRlc3RpbmcuQikgewogICAgZm9yIGkgOj0gMDsgaSA8IGIuTjsgaSsrIHsKICAgICAgICBPcHRpbWl6ZWRTdW0oMSwgMikKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>package main

import (
    &quot;testing&quot;
)

// Optimized function to be benchmarked
func OptimizedSum(a, b int) int {
    return a + b
}

// Benchmark function for optimized code
func BenchmarkOptimizedSum(b *testing.B) {
    for i := 0; i &lt; b.N; i++ {
        OptimizedSum(1, 2)
    }
}</pre></div><div class='content'></div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise</p>
</h2>
<div class='content'><ol>
<li>Write a function that concatenates two strings.</li>
<li>Write a benchmark function for the string concatenation function.</li>
<li>Run the benchmark and interpret the results.</li>
<li>Optimize the string concatenation function to improve performance.</li>
<li>Write a new benchmark function for the optimized code and compare the results.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGFja2FnZSBtYWluCgppbXBvcnQgKAogICAgInRlc3RpbmciCikKCi8vIEZ1bmN0aW9uIHRvIGNvbmNhdGVuYXRlIHN0cmluZ3MKZnVuYyBDb25jYXRTdHJpbmdzKGEsIGIgc3RyaW5nKSBzdHJpbmcgewogICAgcmV0dXJuIGEgKyBiCn0KCi8vIEJlbmNobWFyayBmdW5jdGlvbiBmb3Igc3RyaW5nIGNvbmNhdGVuYXRpb24KZnVuYyBCZW5jaG1hcmtDb25jYXRTdHJpbmdzKGIgKnRlc3RpbmcuQikgewogICAgZm9yIGkgOj0gMDsgaSA8IGIuTjsgaSsrIHsKICAgICAgICBDb25jYXRTdHJpbmdzKCJIZWxsbywgIiwgIldvcmxkISIpCiAgICB9Cn0KCi8vIE9wdGltaXplZCBmdW5jdGlvbiB0byBjb25jYXRlbmF0ZSBzdHJpbmdzIHVzaW5nIGEgYnVpbGRlcgpmdW5jIE9wdGltaXplZENvbmNhdFN0cmluZ3MoYSwgYiBzdHJpbmcpIHN0cmluZyB7CiAgICB2YXIgYnVpbGRlciBzdHJpbmdzLkJ1aWxkZXIKICAgIGJ1aWxkZXIuV3JpdGVTdHJpbmcoYSkKICAgIGJ1aWxkZXIuV3JpdGVTdHJpbmcoYikKICAgIHJldHVybiBidWlsZGVyLlN0cmluZygpCn0KCi8vIEJlbmNobWFyayBmdW5jdGlvbiBmb3Igb3B0aW1pemVkIHN0cmluZyBjb25jYXRlbmF0aW9uCmZ1bmMgQmVuY2htYXJrT3B0aW1pemVkQ29uY2F0U3RyaW5ncyhiICp0ZXN0aW5nLkIpIHsKICAgIGZvciBpIDo9IDA7IGkgPCBiLk47IGkrKyB7CiAgICAgICAgT3B0aW1pemVkQ29uY2F0U3RyaW5ncygiSGVsbG8sICIsICJXb3JsZCEiKQogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>package main

import (
    &quot;testing&quot;
)

// Function to concatenate strings
func ConcatStrings(a, b string) string {
    return a + b
}

// Benchmark function for string concatenation
func BenchmarkConcatStrings(b *testing.B) {
    for i := 0; i &lt; b.N; i++ {
        ConcatStrings(&quot;Hello, &quot;, &quot;World!&quot;)
    }
}

// Optimized function to concatenate strings using a builder
func OptimizedConcatStrings(a, b string) string {
    var builder strings.Builder
    builder.WriteString(a)
    builder.WriteString(b)
    return builder.String()
}

// Benchmark function for optimized string concatenation
func BenchmarkOptimizedConcatStrings(b *testing.B) {
    for i := 0; i &lt; b.N; i++ {
        OptimizedConcatStrings(&quot;Hello, &quot;, &quot;World!&quot;)
    }
}</pre></div><div class='content'></div><h2><p>Running the Benchmarks</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z28gdGVzdCAtYmVuY2g9Lg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>go test -bench=.</pre></div><div class='content'></div><h2><p>Interpreting the Results</p>
</h2>
<div class='content'><p>Compare the <code>ns/op</code>, <code>B/op</code>, and <code>allocs/op</code> metrics for both the original and optimized functions to see the performance improvements.</p>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Benchmarking is an essential tool for measuring and optimizing the performance of your Go code. By writing benchmark functions, running them, and interpreting the results, you can identify bottlenecks and make informed decisions to improve your code's efficiency. This knowledge will be invaluable as you progress to more advanced topics and real-world applications.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-03-testing' title="Testing">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-01-building-a-simple-web-server' title="Building a Simple Web Server">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
