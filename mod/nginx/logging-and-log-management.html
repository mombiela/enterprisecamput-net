<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logging and Log Management</title>

    <link rel="alternate" href="https://campusempresa.com/mod/nginx/logging-and-log-management" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/nginx/logging-and-log-management" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/nginx/logging-and-log-management" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/nginx/logging-and-log-management" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/nginx/logging-and-log-management" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='monitoring-nginx'>&#x25C4;Monitoring NGINX</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Logging and Log Management</a>
	</div>
	<div class='col-4 text-end'>
					<a href='troubleshooting-common-issues'>Troubleshooting Common Issues &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Logging in NGINX</h1>
<div class='content'><p>Logging is an essential aspect of managing and maintaining web servers. It helps in monitoring server performance, debugging issues, and understanding user behavior. NGINX, a high-performance web server, provides robust logging capabilities.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Access Logs</strong>: Record client requests processed by the server.</li>
<li><strong>Error Logs</strong>: Capture errors encountered by the server.</li>
<li><strong>Log Formats</strong>: Define the structure and content of log entries.</li>
<li><strong>Log Levels</strong>: Determine the severity of messages recorded in error logs.</li>
</ul>
</div><h1>Configuring Access Logs</h1>
<div class='content'><p>Access logs in NGINX record details about each client request. By default, NGINX logs access information in a predefined format.</p>
</div><h2>Basic Configuration</h2>
<div class='content'><p>To enable access logging, add the following directive to your NGINX configuration file (<code>nginx.conf</code>):</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICBhY2Nlc3NfbG9nIC92YXIvbG9nL25naW54L2FjY2Vzcy5sb2c7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    access_log /var/log/nginx/access.log;
}</pre></div><div class='content'></div><h2>Custom Log Formats</h2>
<div class='content'><p>You can define custom log formats to include specific information. Use the <code>log_format</code> directive:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICBsb2dfZm9ybWF0IGN1c3RvbSAnJHJlbW90ZV9hZGRyIC0gJHJlbW90ZV91c2VyIFskdGltZV9sb2NhbF0gIiRyZXF1ZXN0IiAnCiAgICAgICAgICAgICAgICAgICAgICAnJHN0YXR1cyAkYm9keV9ieXRlc19zZW50ICIkaHR0cF9yZWZlcmVyIiAnCiAgICAgICAgICAgICAgICAgICAgICAnIiRodHRwX3VzZXJfYWdlbnQiICIkaHR0cF94X2ZvcndhcmRlZF9mb3IiJzsKCiAgICBhY2Nlc3NfbG9nIC92YXIvbG9nL25naW54L2FjY2Vzcy5sb2cgY3VzdG9tOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    log_format custom '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '
                      '$status $body_bytes_sent &quot;$http_referer&quot; '
                      '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;';

    access_log /var/log/nginx/access.log custom;
}</pre></div><div class='content'></div><h2>Example Explained</h2>
<div class='content'><ul>
<li><code>$remote_addr</code>: Client IP address.</li>
<li><code>$remote_user</code>: Authenticated user (if any).</li>
<li><code>$time_local</code>: Local time of the request.</li>
<li><code>$request</code>: Request line from the client.</li>
<li><code>$status</code>: HTTP status code.</li>
<li><code>$body_bytes_sent</code>: Number of bytes sent to the client.</li>
<li><code>$http_referer</code>: Referer header from the client.</li>
<li><code>$http_user_agent</code>: User-Agent header from the client.</li>
<li><code>$http_x_forwarded_for</code>: X-Forwarded-For header (useful for identifying the original client IP when behind a proxy).</li>
</ul>
</div><h1>Configuring Error Logs</h1>
<div class='content'><p>Error logs capture issues encountered by the server. You can specify the log file and the level of detail.</p>
</div><h2>Basic Configuration</h2>
<div class='content'><p>To enable error logging, add the following directive to your NGINX configuration file:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICBlcnJvcl9sb2cgL3Zhci9sb2cvbmdpbngvZXJyb3IubG9nIHdhcm47Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    error_log /var/log/nginx/error.log warn;
}</pre></div><div class='content'></div><h2>Log Levels</h2>
<div class='content'><p>NGINX supports various log levels:</p>
<ul>
<li><code>debug</code>: Detailed debugging information.</li>
<li><code>info</code>: Informational messages.</li>
<li><code>notice</code>: Normal but significant conditions.</li>
<li><code>warn</code>: Warning conditions.</li>
<li><code>error</code>: Error conditions.</li>
<li><code>crit</code>: Critical conditions.</li>
<li><code>alert</code>: Immediate action required.</li>
<li><code>emerg</code>: System is unusable.</li>
</ul>
</div><h2>Example Explained</h2>
<div class='content'><p>The <code>warn</code> level in the example above will log warnings, errors, critical issues, alerts, and emergencies.</p>
</div><h1>Managing Log Files</h1>
<div class='content'><p>Proper log management is crucial for maintaining server performance and ensuring logs are useful.</p>
</div><h2>Log Rotation</h2>
<div class='content'><p>Log rotation prevents log files from growing indefinitely, which can consume disk space and make log analysis difficult. Use tools like <code>logrotate</code> to manage log rotation.</p>
</div><h2>Example Logrotate Configuration</h2>
<div class='content'><p>Create a configuration file for NGINX logs (<code>/etc/logrotate.d/nginx</code>):</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("L3Zhci9sb2cvbmdpbngvKi5sb2cgewogICAgZGFpbHkKICAgIG1pc3NpbmdvawogICAgcm90YXRlIDE0CiAgICBjb21wcmVzcwogICAgZGVsYXljb21wcmVzcwogICAgbm90aWZlbXB0eQogICAgY3JlYXRlIDA2NDAgd3d3LWRhdGEgYWRtCiAgICBzaGFyZWRzY3JpcHRzCiAgICBwb3N0cm90YXRlCiAgICAgICAgWyAtZiAvdmFyL3J1bi9uZ2lueC5waWQgXSAmJiBraWxsIC1VU1IxIGBjYXQgL3Zhci9ydW4vbmdpbngucGlkYAogICAgZW5kc2NyaXB0Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/var/log/nginx/*.log {
    daily
    missingok
    rotate 14
    compress
    delaycompress
    notifempty
    create 0640 www-data adm
    sharedscripts
    postrotate
        [ -f /var/run/nginx.pid ] &amp;&amp; kill -USR1 `cat /var/run/nginx.pid`
    endscript
}</pre></div><div class='content'></div><h2>Example Explained</h2>
<div class='content'><ul>
<li><code>daily</code>: Rotate logs daily.</li>
<li><code>missingok</code>: Ignore missing log files.</li>
<li><code>rotate 14</code>: Keep 14 days of logs.</li>
<li><code>compress</code>: Compress old log files.</li>
<li><code>delaycompress</code>: Delay compression until the next rotation.</li>
<li><code>notifempty</code>: Do not rotate empty log files.</li>
<li><code>create 0640 www-data adm</code>: Set permissions and ownership for new log files.</li>
<li><code>sharedscripts</code>: Run post-rotate script only once.</li>
<li><code>postrotate</code>: Command to run after rotation (reload NGINX to start new log files).</li>
</ul>
</div><h1>Advanced Log Management Techniques</h1>
<div class='content'><p>For advanced log management, consider using centralized logging solutions and log analysis tools.</p>
</div><h2>Centralized Logging</h2>
<div class='content'><p>Centralized logging aggregates logs from multiple servers into a single location for easier management and analysis. Tools like ELK Stack (Elasticsearch, Logstash, Kibana) or Graylog can be used.</p>
</div><h2>Example ELK Stack Setup</h2>
<div class='content'><ol>
<li><strong>Elasticsearch</strong>: Stores and indexes log data.</li>
<li><strong>Logstash</strong>: Collects, processes, and forwards log data.</li>
<li><strong>Kibana</strong>: Visualizes log data.</li>
</ol>
</div><h2>Log Analysis</h2>
<div class='content'><p>Analyzing logs helps in identifying trends, detecting anomalies, and troubleshooting issues. Tools like <code>GoAccess</code> or <code>AWStats</code> can be used for real-time log analysis.</p>
</div><h1>Conclusion</h1>
<div class='content'><p>Logging and log management are critical components of maintaining an NGINX server. By configuring access and error logs, managing log files, and utilizing advanced techniques like centralized logging and log analysis, you can ensure your server operates efficiently and issues are promptly addressed. Proper log management not only aids in troubleshooting but also provides valuable insights into server performance and user behavior.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='monitoring-nginx'>&#x25C4;Monitoring NGINX</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Logging and Log Management</a>
	</div>
	<div class='col-4 text-end'>
					<a href='troubleshooting-common-issues'>Troubleshooting Common Issues &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
