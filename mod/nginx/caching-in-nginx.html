<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caching in NGINX</title>

    <link rel="alternate" href="https://campusempresa.com/mod/nginx/caching-in-nginx" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/nginx/caching-in-nginx" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/nginx/caching-in-nginx" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/nginx/caching-in-nginx" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/nginx/caching-in-nginx" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='load-balancing-with-nginx'>&#x25C4;Load Balancing with NGINX</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Caching in NGINX</a>
	</div>
	<div class='col-4 text-end'>
					<a href='basic-security-practices'>Basic Security Practices &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Caching</h1>
<div class='content'><p>Caching is a technique used to store copies of files or data in a cache, or temporary storage location, to reduce the time it takes to access data and improve performance. In the context of NGINX, caching can significantly enhance the performance of web applications by reducing the load on the backend servers and decreasing the response time for users.</p>
</div><h1>Benefits of Caching in NGINX</h1>
<div class='content'><ul>
<li><strong>Improved Performance</strong>: Reduces latency and speeds up content delivery.</li>
<li><strong>Reduced Server Load</strong>: Decreases the number of requests to backend servers.</li>
<li><strong>Cost Efficiency</strong>: Lowers bandwidth usage and server resource consumption.</li>
<li><strong>Scalability</strong>: Helps handle more concurrent users by serving cached content.</li>
</ul>
</div><h1>Types of Caching in NGINX</h1>
<div class='content'><ul>
<li><strong>Static Content Caching</strong>: Caches static files like images, CSS, and JavaScript.</li>
<li><strong>Proxy Caching</strong>: Caches responses from backend servers to serve future requests faster.</li>
<li><strong>Microcaching</strong>: Short-term caching for dynamic content to handle high traffic.</li>
</ul>
</div><h1>Configuring Static Content Caching</h1>
<div class='content'><p>Static content caching involves setting up NGINX to cache static files. This is typically done using the <code>expires</code> directive.</p>
</div><h2>Example Configuration</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VydmVyIHsKICAgIGxpc3RlbiA4MDsKICAgIHNlcnZlcl9uYW1lIGV4YW1wbGUuY29tOwoKICAgIGxvY2F0aW9uIC8gewogICAgICAgIHJvb3QgL3Zhci93d3cvaHRtbDsKICAgICAgICBpbmRleCBpbmRleC5odG1sOwogICAgfQoKICAgIGxvY2F0aW9uIH4qIFwuKGpwZ3xqcGVnfHBuZ3xnaWZ8aWNvfGNzc3xqcykkIHsKICAgICAgICBleHBpcmVzIDMwZDsKICAgICAgICBhZGRfaGVhZGVyIENhY2hlLUNvbnRyb2wgInB1YmxpYywgbm8tdHJhbnNmb3JtIjsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>server {
    listen 80;
    server_name example.com;

    location / {
        root /var/www/html;
        index index.html;
    }

    location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {
        expires 30d;
        add_header Cache-Control &quot;public, no-transform&quot;;
    }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>location ~* \.(jpg|jpeg|png|gif|ico|css|js)$</code>: Matches requests for static files.</li>
<li><code>expires 30d</code>: Sets the cache expiration time to 30 days.</li>
<li><code>add_header Cache-Control &quot;public, no-transform&quot;</code>: Adds a Cache-Control header to the response.</li>
</ul>
</li>
</ul>
</div><h1>Configuring Proxy Caching</h1>
<div class='content'><p>Proxy caching involves caching responses from backend servers. This is useful for dynamic content that doesn't change frequently.</p>
</div><h2>Example Configuration</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICBwcm94eV9jYWNoZV9wYXRoIC9kYXRhL25naW54L2NhY2hlIGxldmVscz0xOjIga2V5c196b25lPW15X2NhY2hlOjEwbSBtYXhfc2l6ZT0xMGcgaW5hY3RpdmU9NjBtIHVzZV90ZW1wX3BhdGg9b2ZmOwoKICAgIHNlcnZlciB7CiAgICAgICAgbGlzdGVuIDgwOwogICAgICAgIHNlcnZlcl9uYW1lIGV4YW1wbGUuY29tOwoKICAgICAgICBsb2NhdGlvbiAvIHsKICAgICAgICAgICAgcHJveHlfcGFzcyBodHRwOi8vYmFja2VuZF9zZXJ2ZXI7CiAgICAgICAgICAgIHByb3h5X2NhY2hlIG15X2NhY2hlOwogICAgICAgICAgICBwcm94eV9jYWNoZV92YWxpZCAyMDAgMzAyIDEwbTsKICAgICAgICAgICAgcHJveHlfY2FjaGVfdmFsaWQgNDA0IDFtOwogICAgICAgICAgICBhZGRfaGVhZGVyIFgtQ2FjaGUtU3RhdHVzICR1cHN0cmVhbV9jYWNoZV9zdGF0dXM7CiAgICAgICAgfQogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    proxy_cache_path /data/nginx/cache levels=1:2 keys_zone=my_cache:10m max_size=10g inactive=60m use_temp_path=off;

    server {
        listen 80;
        server_name example.com;

        location / {
            proxy_pass http://backend_server;
            proxy_cache my_cache;
            proxy_cache_valid 200 302 10m;
            proxy_cache_valid 404 1m;
            add_header X-Cache-Status $upstream_cache_status;
        }
    }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>proxy_cache_path</code>: Defines the cache storage path and parameters.</li>
<li><code>proxy_pass http://backend_server</code>: Forwards requests to the backend server.</li>
<li><code>proxy_cache my_cache</code>: Enables caching using the defined cache zone.</li>
<li><code>proxy_cache_valid 200 302 10m</code>: Caches 200 and 302 responses for 10 minutes.</li>
<li><code>proxy_cache_valid 404 1m</code>: Caches 404 responses for 1 minute.</li>
<li><code>add_header X-Cache-Status $upstream_cache_status</code>: Adds a custom header to indicate cache status.</li>
</ul>
</li>
</ul>
</div><h1>Microcaching</h1>
<div class='content'><p>Microcaching is a technique where dynamic content is cached for very short periods (e.g., a few seconds) to handle high traffic efficiently.</p>
</div><h2>Example Configuration</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICBwcm94eV9jYWNoZV9wYXRoIC9kYXRhL25naW54L21pY3JvY2FjaGUgbGV2ZWxzPTE6MiBrZXlzX3pvbmU9bWljcm9jYWNoZToxMG0gbWF4X3NpemU9MWcgaW5hY3RpdmU9MW0gdXNlX3RlbXBfcGF0aD1vZmY7CgogICAgc2VydmVyIHsKICAgICAgICBsaXN0ZW4gODA7CiAgICAgICAgc2VydmVyX25hbWUgZXhhbXBsZS5jb207CgogICAgICAgIGxvY2F0aW9uIC8gewogICAgICAgICAgICBwcm94eV9wYXNzIGh0dHA6Ly9iYWNrZW5kX3NlcnZlcjsKICAgICAgICAgICAgcHJveHlfY2FjaGUgbWljcm9jYWNoZTsKICAgICAgICAgICAgcHJveHlfY2FjaGVfdmFsaWQgMjAwIDFzOwogICAgICAgICAgICBwcm94eV9jYWNoZV92YWxpZCA0MDQgMXM7CiAgICAgICAgICAgIGFkZF9oZWFkZXIgWC1DYWNoZS1TdGF0dXMgJHVwc3RyZWFtX2NhY2hlX3N0YXR1czsKICAgICAgICB9CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    proxy_cache_path /data/nginx/microcache levels=1:2 keys_zone=microcache:10m max_size=1g inactive=1m use_temp_path=off;

    server {
        listen 80;
        server_name example.com;

        location / {
            proxy_pass http://backend_server;
            proxy_cache microcache;
            proxy_cache_valid 200 1s;
            proxy_cache_valid 404 1s;
            add_header X-Cache-Status $upstream_cache_status;
        }
    }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>proxy_cache_valid 200 1s</code>: Caches 200 responses for 1 second.</li>
<li><code>proxy_cache_valid 404 1s</code>: Caches 404 responses for 1 second.</li>
<li>This setup is ideal for high-traffic scenarios where even a short cache duration can significantly reduce server load.</li>
</ul>
</li>
</ul>
</div><h1>Cache Purging</h1>
<div class='content'><p>Cache purging allows you to manually remove cached content. This is useful when content updates and you need to ensure users receive the latest version.</p>
</div><h2>Example Configuration</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICBwcm94eV9jYWNoZV9wYXRoIC9kYXRhL25naW54L2NhY2hlIGxldmVscz0xOjIga2V5c196b25lPW15X2NhY2hlOjEwbSBtYXhfc2l6ZT0xMGcgaW5hY3RpdmU9NjBtIHVzZV90ZW1wX3BhdGg9b2ZmOwoKICAgIHNlcnZlciB7CiAgICAgICAgbGlzdGVuIDgwOwogICAgICAgIHNlcnZlcl9uYW1lIGV4YW1wbGUuY29tOwoKICAgICAgICBsb2NhdGlvbiAvIHsKICAgICAgICAgICAgcHJveHlfcGFzcyBodHRwOi8vYmFja2VuZF9zZXJ2ZXI7CiAgICAgICAgICAgIHByb3h5X2NhY2hlIG15X2NhY2hlOwogICAgICAgICAgICBwcm94eV9jYWNoZV92YWxpZCAyMDAgMzAyIDEwbTsKICAgICAgICAgICAgcHJveHlfY2FjaGVfdmFsaWQgNDA0IDFtOwogICAgICAgICAgICBhZGRfaGVhZGVyIFgtQ2FjaGUtU3RhdHVzICR1cHN0cmVhbV9jYWNoZV9zdGF0dXM7CiAgICAgICAgfQoKICAgICAgICBsb2NhdGlvbiAvcHVyZ2UgewogICAgICAgICAgICBhbGxvdyAxMjcuMC4wLjE7CiAgICAgICAgICAgIGRlbnkgYWxsOwogICAgICAgICAgICBwcm94eV9jYWNoZV9wdXJnZSBteV9jYWNoZSAiJHNjaGVtZSRyZXF1ZXN0X21ldGhvZCRob3N0JHJlcXVlc3RfdXJpIjsKICAgICAgICB9CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    proxy_cache_path /data/nginx/cache levels=1:2 keys_zone=my_cache:10m max_size=10g inactive=60m use_temp_path=off;

    server {
        listen 80;
        server_name example.com;

        location / {
            proxy_pass http://backend_server;
            proxy_cache my_cache;
            proxy_cache_valid 200 302 10m;
            proxy_cache_valid 404 1m;
            add_header X-Cache-Status $upstream_cache_status;
        }

        location /purge {
            allow 127.0.0.1;
            deny all;
            proxy_cache_purge my_cache &quot;$scheme$request_method$host$request_uri&quot;;
        }
    }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>location /purge</code>: Defines a location for purging cache.</li>
<li><code>allow 127.0.0.1; deny all;</code>: Restricts access to the purge location to localhost.</li>
<li><code>proxy_cache_purge my_cache &quot;$scheme$request_method$host$request_uri&quot;;</code>: Purges the specified cache.</li>
</ul>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Caching in NGINX is a powerful feature that can greatly enhance the performance and scalability of web applications. By understanding and configuring static content caching, proxy caching, microcaching, and cache purging, you can optimize your NGINX server to handle more traffic efficiently and provide a better user experience.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='load-balancing-with-nginx'>&#x25C4;Load Balancing with NGINX</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Caching in NGINX</a>
	</div>
	<div class='col-4 text-end'>
					<a href='basic-security-practices'>Basic Security Practices &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
