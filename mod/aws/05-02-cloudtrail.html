<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS CloudTrail</title>

    <link rel="alternate" href="https://campusempresa.com/mod/aws/05-02-cloudtrail" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/aws/05-02-cloudtrail" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/aws/05-02-cloudtrail" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/aws/05-02-cloudtrail" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/aws/05-02-cloudtrail" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-01-cloudwatch' title="Amazon CloudWatch">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">AWS CloudTrail</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-03-aws-config' title="AWS Config">Next &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to AWS CloudTrail</h1>
<div class='content'><p>AWS CloudTrail is a service that enables governance, compliance, and operational and risk auditing of your AWS account. With CloudTrail, you can log, continuously monitor, and retain account activity related to actions across your AWS infrastructure. CloudTrail provides event history of your AWS account activity, including actions taken through the AWS Management Console, AWS SDKs, command-line tools, and other AWS services.</p>
</div><h1>Key Concepts</h1>
<div class='content'></div><h2>1. **Event**</h2>
<div class='content'><p>An event in CloudTrail is a record of an activity in your AWS account. Each event includes details such as the AWS service used, the action performed, and the parameters for the action.</p>
</div><h2>2. **Trail**</h2>
<div class='content'><p>A trail enables CloudTrail to deliver log files to an Amazon S3 bucket. You can configure a trail to capture all or specific events.</p>
</div><h2>3. **Management Events**</h2>
<div class='content'><p>These events provide information about management operations performed on resources in your AWS account. Examples include creating an EC2 instance or deleting an S3 bucket.</p>
</div><h2>4. **Data Events**</h2>
<div class='content'><p>These events provide information about resource operations performed on or within a resource. Examples include S3 object-level API activity and Lambda function execution activity.</p>
</div><h2>5. **Insights Events**</h2>
<div class='content'><p>These events help you identify unusual operational activity in your AWS account. CloudTrail Insights automatically analyzes management events to detect unusual patterns.</p>
</div><h1>Setting Up AWS CloudTrail</h1>
<div class='content'></div><h2>Step-by-Step Guide</h2>
<div class='content'><ol>
<li>
<p><strong>Sign in to the AWS Management Console</strong></p>
<ul>
<li>Navigate to the CloudTrail console at <a href="https://console.aws.amazon.com/cloudtrail">https://console.aws.amazon.com/cloudtrail</a>.</li>
</ul>
</li>
<li>
<p><strong>Create a Trail</strong></p>
<ul>
<li>Click on &quot;Create trail&quot;.</li>
<li>Enter a name for your trail.</li>
<li>Choose whether to apply the trail to all regions or a single region.</li>
</ul>
</li>
<li>
<p><strong>Configure S3 Bucket</strong></p>
<ul>
<li>Specify an existing S3 bucket or create a new one to store your log files.</li>
<li>Optionally, configure S3 bucket policies to control access to your log files.</li>
</ul>
</li>
<li>
<p><strong>Enable Log File Validation</strong></p>
<ul>
<li>This ensures the integrity of your log files by creating a digest file that contains a hash of each log file.</li>
</ul>
</li>
<li>
<p><strong>Configure CloudWatch Logs (Optional)</strong></p>
<ul>
<li>You can send CloudTrail events to CloudWatch Logs for real-time monitoring and alerting.</li>
</ul>
</li>
<li>
<p><strong>Review and Create</strong></p>
<ul>
<li>Review your settings and click &quot;Create trail&quot;.</li>
</ul>
</li>
</ol>
</div><h1>Practical Example</h1>
<div class='content'></div><h2>Creating a Trail Using AWS CLI</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXdzIGNsb3VkdHJhaWwgY3JlYXRlLXRyYWlsIC0tbmFtZSBNeVRyYWlsIC0tczMtYnVja2V0LW5hbWUgbXktY2xvdWR0cmFpbC1idWNrZXQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>aws cloudtrail create-trail --name MyTrail --s3-bucket-name my-cloudtrail-bucket</pre></div><div class='content'></div><h2>Enabling Logging</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXdzIGNsb3VkdHJhaWwgc3RhcnQtbG9nZ2luZyAtLW5hbWUgTXlUcmFpbA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>aws cloudtrail start-logging --name MyTrail</pre></div><div class='content'></div><h2>Verifying the Trail</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXdzIGNsb3VkdHJhaWwgZGVzY3JpYmUtdHJhaWxzIC0tdHJhaWwtbmFtZS1saXN0IE15VHJhaWw="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>aws cloudtrail describe-trails --trail-name-list MyTrail</pre></div><div class='content'></div><h2>Example Output</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICAgInRyYWlsTGlzdCI6IFsKICAgICAgICB7CiAgICAgICAgICAgICJOYW1lIjogIk15VHJhaWwiLAogICAgICAgICAgICAiUzNCdWNrZXROYW1lIjogIm15LWNsb3VkdHJhaWwtYnVja2V0IiwKICAgICAgICAgICAgIkluY2x1ZGVHbG9iYWxTZXJ2aWNlRXZlbnRzIjogdHJ1ZSwKICAgICAgICAgICAgIklzTXVsdGlSZWdpb25UcmFpbCI6IGZhbHNlLAogICAgICAgICAgICAiSG9tZVJlZ2lvbiI6ICJ1cy1lYXN0LTEiLAogICAgICAgICAgICAiVHJhaWxBUk4iOiAiYXJuOmF3czpjbG91ZHRyYWlsOnVzLWVhc3QtMToxMjM0NTY3ODkwMTI6dHJhaWwvTXlUcmFpbCIsCiAgICAgICAgICAgICJMb2dGaWxlVmFsaWRhdGlvbkVuYWJsZWQiOiBmYWxzZSwKICAgICAgICAgICAgIklzT3JnYW5pemF0aW9uVHJhaWwiOiBmYWxzZQogICAgICAgIH0KICAgIF0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
    &quot;trailList&quot;: [
        {
            &quot;Name&quot;: &quot;MyTrail&quot;,
            &quot;S3BucketName&quot;: &quot;my-cloudtrail-bucket&quot;,
            &quot;IncludeGlobalServiceEvents&quot;: true,
            &quot;IsMultiRegionTrail&quot;: false,
            &quot;HomeRegion&quot;: &quot;us-east-1&quot;,
            &quot;TrailARN&quot;: &quot;arn:aws:cloudtrail:us-east-1:123456789012:trail/MyTrail&quot;,
            &quot;LogFileValidationEnabled&quot;: false,
            &quot;IsOrganizationTrail&quot;: false
        }
    ]
}</pre></div><div class='content'></div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Task: Create and Configure a CloudTrail</h2>
<div class='content'><ol>
<li><strong>Create a new trail named <code>StudentTrail</code></strong>.</li>
<li><strong>Configure it to log to an S3 bucket named <code>student-cloudtrail-bucket</code></strong>.</li>
<li><strong>Enable log file validation</strong>.</li>
<li><strong>Send logs to CloudWatch Logs</strong>.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><ol>
<li><strong>Create the Trail</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXdzIGNsb3VkdHJhaWwgY3JlYXRlLXRyYWlsIC0tbmFtZSBTdHVkZW50VHJhaWwgLS1zMy1idWNrZXQtbmFtZSBzdHVkZW50LWNsb3VkdHJhaWwtYnVja2V0"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>aws cloudtrail create-trail --name StudentTrail --s3-bucket-name student-cloudtrail-bucket</pre></div><div class='content'><ol start="2">
<li><strong>Enable Log File Validation</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXdzIGNsb3VkdHJhaWwgdXBkYXRlLXRyYWlsIC0tbmFtZSBTdHVkZW50VHJhaWwgLS1lbmFibGUtbG9nLWZpbGUtdmFsaWRhdGlvbg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>aws cloudtrail update-trail --name StudentTrail --enable-log-file-validation</pre></div><div class='content'><ol start="3">
<li><strong>Configure CloudWatch Logs</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXdzIGNsb3VkdHJhaWwgdXBkYXRlLXRyYWlsIC0tbmFtZSBTdHVkZW50VHJhaWwgLS1jbG91ZC13YXRjaC1sb2dzLWxvZy1ncm91cC1hcm4gYXJuOmF3czpsb2dzOnVzLWVhc3QtMToxMjM0NTY3ODkwMTI6bG9nLWdyb3VwOlN0dWRlbnRUcmFpbExvZ0dyb3VwIC0tY2xvdWQtd2F0Y2gtbG9ncy1yb2xlLWFybiBhcm46YXdzOmlhbTo6MTIzNDU2Nzg5MDEyOnJvbGUvQ2xvdWRUcmFpbF9DbG91ZFdhdGNoTG9nc19Sb2xl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>aws cloudtrail update-trail --name StudentTrail --cloud-watch-logs-log-group-arn arn:aws:logs:us-east-1:123456789012:log-group:StudentTrailLogGroup --cloud-watch-logs-role-arn arn:aws:iam::123456789012:role/CloudTrail_CloudWatchLogs_Role</pre></div><div class='content'><ol start="4">
<li><strong>Start Logging</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXdzIGNsb3VkdHJhaWwgc3RhcnQtbG9nZ2luZyAtLW5hbWUgU3R1ZGVudFRyYWls"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>aws cloudtrail start-logging --name StudentTrail</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Incorrect S3 Bucket Permissions</strong>: Ensure that the S3 bucket policy allows CloudTrail to write logs to the bucket.</li>
<li><strong>Not Enabling Log File Validation</strong>: This is crucial for ensuring the integrity of your logs.</li>
<li><strong>Misconfigured CloudWatch Logs</strong>: Ensure that the IAM role used for CloudWatch Logs has the necessary permissions.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, you learned about AWS CloudTrail, its key concepts, and how to set it up. You also practiced creating and configuring a trail using the AWS CLI. Understanding CloudTrail is essential for monitoring and auditing your AWS account activity, which is crucial for maintaining security and compliance. In the next module, we will explore Amazon CloudWatch, another powerful monitoring tool in AWS.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-01-cloudwatch' title="Amazon CloudWatch">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-03-aws-config' title="AWS Config">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
