<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backup and Restore Jenkins</title>

    <link rel="alternate" href="https://campusempresa.com/mod/jenkins/05-03-backup-and-restore-jenkins" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/jenkins/05-03-backup-and-restore-jenkins" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/jenkins/05-03-backup-and-restore-jenkins" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/jenkins/05-03-backup-and-restore-jenkins" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/jenkins/05-03-backup-and-restore-jenkins" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-configuring-security' title="Configuring Security">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Backup and Restore Jenkins</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-monitoring-jenkins' title="Monitoring Jenkins">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will cover the essential steps to back up and restore Jenkins. This is crucial for ensuring that your Jenkins setup can be recovered in case of data loss, corruption, or migration to a new server.</p>
</div><h1><p>Why Backup and Restore Jenkins?</p>
</h1>
<div class='content'><p>Backing up Jenkins is important for several reasons:</p>
<ul>
<li><strong>Data Protection</strong>: Protects against data loss due to hardware failure, software issues, or human error.</li>
<li><strong>Disaster Recovery</strong>: Ensures that you can quickly restore Jenkins to a working state after a catastrophic event.</li>
<li><strong>Migration</strong>: Facilitates moving Jenkins to a new server or environment.</li>
</ul>
</div><h1><p>What to Backup?</p>
</h1>
<div class='content'><p>To ensure a complete backup of Jenkins, you need to back up the following components:</p>
<ol>
<li><strong>Jenkins Home Directory</strong>: This includes all configurations, job definitions, build history, and plugins.</li>
<li><strong>Configuration Files</strong>: Specific configuration files such as <code>config.xml</code>, <code>credentials.xml</code>, and <code>jobs</code> directory.</li>
<li><strong>User Content</strong>: Any user-generated content stored in Jenkins.</li>
</ol>
</div><h1><p>Backup Methods</p>
</h1>
<div class='content'></div><h2><p>Manual Backup</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Stop Jenkins</strong>: It is recommended to stop Jenkins to ensure a consistent backup.</p>
<pre><code class="language-bash">sudo systemctl stop jenkins
</code></pre>
</li>
<li>
<p><strong>Copy Jenkins Home Directory</strong>: Use a tool like <code>tar</code> to create an archive of the Jenkins home directory.</p>
<pre><code class="language-bash">tar -czvf jenkins_backup.tar.gz /var/lib/jenkins
</code></pre>
</li>
<li>
<p><strong>Store the Backup</strong>: Move the backup file to a secure location, such as an external storage device or a cloud storage service.</p>
</li>
<li>
<p><strong>Restart Jenkins</strong>:</p>
<pre><code class="language-bash">sudo systemctl start jenkins
</code></pre>
</li>
</ol>
</div><h2><p>Automated Backup</p>
</h2>
<div class='content'><p>Automating backups can be achieved using plugins or scripts.</p>
<h4>Using ThinBackup Plugin</h4>
<ol>
<li>
<p><strong>Install ThinBackup Plugin</strong>:</p>
<ul>
<li>Navigate to <code>Manage Jenkins</code> &gt; <code>Manage Plugins</code>.</li>
<li>Go to the <code>Available</code> tab, search for <code>ThinBackup</code>, and install it.</li>
</ul>
</li>
<li>
<p><strong>Configure ThinBackup</strong>:</p>
<ul>
<li>Go to <code>Manage Jenkins</code> &gt; <code>ThinBackup</code>.</li>
<li>Configure the backup settings, such as backup schedule, backup location, and retention policy.</li>
</ul>
</li>
<li>
<p><strong>Run Backup</strong>:</p>
<ul>
<li>You can manually trigger a backup or wait for the scheduled backup to run.</li>
</ul>
</li>
</ol>
</div><h2><p>Using a Script</p>
</h2>
<div class='content'><p>Create a script to automate the backup process. Here is an example script:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyEvYmluL2Jhc2gKCiMgRGVmaW5lIHZhcmlhYmxlcwpKRU5LSU5TX0hPTUU9Ii92YXIvbGliL2plbmtpbnMiCkJBQ0tVUF9ESVI9Ii9iYWNrdXAvamVua2lucyIKVElNRVNUQU1QPSQoZGF0ZSArJUZfJVQpCkJBQ0tVUF9GSUxFPSIkQkFDS1VQX0RJUi9qZW5raW5zX2JhY2t1cF8kVElNRVNUQU1QLnRhci5neiIKCiMgQ3JlYXRlIGJhY2t1cCBkaXJlY3RvcnkgaWYgaXQgZG9lc24ndCBleGlzdApta2RpciAtcCAkQkFDS1VQX0RJUgoKIyBTdG9wIEplbmtpbnMKc3VkbyBzeXN0ZW1jdGwgc3RvcCBqZW5raW5zCgojIENyZWF0ZSBhIGJhY2t1cAp0YXIgLWN6dmYgJEJBQ0tVUF9GSUxFICRKRU5LSU5TX0hPTUUKCiMgU3RhcnQgSmVua2lucwpzdWRvIHN5c3RlbWN0bCBzdGFydCBqZW5raW5zCgojIFByaW50IGNvbXBsZXRpb24gbWVzc2FnZQplY2hvICJCYWNrdXAgY29tcGxldGVkOiAkQkFDS1VQX0ZJTEUi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#!/bin/bash

# Define variables
JENKINS_HOME=&quot;/var/lib/jenkins&quot;
BACKUP_DIR=&quot;/backup/jenkins&quot;
TIMESTAMP=$(date +%F_%T)
BACKUP_FILE=&quot;$BACKUP_DIR/jenkins_backup_$TIMESTAMP.tar.gz&quot;

# Create backup directory if it doesn't exist
mkdir -p $BACKUP_DIR

# Stop Jenkins
sudo systemctl stop jenkins

# Create a backup
tar -czvf $BACKUP_FILE $JENKINS_HOME

# Start Jenkins
sudo systemctl start jenkins

# Print completion message
echo &quot;Backup completed: $BACKUP_FILE&quot;</pre></div><div class='content'></div><h1><p>Restore Jenkins</p>
</h1>
<div class='content'></div><h2><p>Manual Restore</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Stop Jenkins</strong>:</p>
<pre><code class="language-bash">sudo systemctl stop jenkins
</code></pre>
</li>
<li>
<p><strong>Extract Backup</strong>: Extract the backup archive to the Jenkins home directory.</p>
<pre><code class="language-bash">tar -xzvf jenkins_backup.tar.gz -C /var/lib/jenkins
</code></pre>
</li>
<li>
<p><strong>Set Permissions</strong>: Ensure the correct permissions are set for the Jenkins home directory.</p>
<pre><code class="language-bash">sudo chown -R jenkins:jenkins /var/lib/jenkins
</code></pre>
</li>
<li>
<p><strong>Restart Jenkins</strong>:</p>
<pre><code class="language-bash">sudo systemctl start jenkins
</code></pre>
</li>
</ol>
</div><h2><p>Using ThinBackup Plugin</p>
</h2>
<div class='content'><ol>
<li><strong>Install ThinBackup Plugin</strong> (if not already installed).</li>
<li><strong>Restore Backup</strong>:
<ul>
<li>Navigate to <code>Manage Jenkins</code> &gt; <code>ThinBackup</code>.</li>
<li>Go to the <code>Restore</code> tab, select the backup to restore, and follow the prompts.</li>
</ul>
</li>
</ol>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Automate Jenkins Backup</p>
</h2>
<div class='content'><ol>
<li><strong>Objective</strong>: Create a script to automate the backup of Jenkins and schedule it using <code>cron</code>.</li>
<li><strong>Steps</strong>:
<ul>
<li>Write a backup script similar to the one provided above.</li>
<li>Schedule the script to run daily using <code>cron</code>.</li>
</ul>
</li>
</ol>
<h4>Solution</h4>
<ol>
<li>
<p><strong>Create the Script</strong>:</p>
<pre><code class="language-bash">#!/bin/bash

# Define variables
JENKINS_HOME=&quot;/var/lib/jenkins&quot;
BACKUP_DIR=&quot;/backup/jenkins&quot;
TIMESTAMP=$(date +%F_%T)
BACKUP_FILE=&quot;$BACKUP_DIR/jenkins_backup_$TIMESTAMP.tar.gz&quot;

# Create backup directory if it doesn't exist
mkdir -p $BACKUP_DIR

# Stop Jenkins
sudo systemctl stop jenkins

# Create a backup
tar -czvf $BACKUP_FILE $JENKINS_HOME

# Start Jenkins
sudo systemctl start jenkins

# Print completion message
echo &quot;Backup completed: $BACKUP_FILE&quot;
</code></pre>
</li>
<li>
<p><strong>Schedule with <code>cron</code></strong>:</p>
<ul>
<li>Open the <code>cron</code> configuration:
<pre><code class="language-bash">crontab -e
</code></pre>
</li>
<li>Add the following line to schedule the script to run daily at 2 AM:
<pre><code class="language-bash">0 2 * * * /path/to/backup_script.sh
</code></pre>
</li>
</ul>
</li>
</ol>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered the importance of backing up Jenkins, what components need to be backed up, and various methods to perform backups and restores. We also provided a practical exercise to automate the backup process. Ensuring regular backups and having a restore plan in place is crucial for maintaining the integrity and availability of your Jenkins environment.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-configuring-security' title="Configuring Security">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-monitoring-jenkins' title="Monitoring Jenkins">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
