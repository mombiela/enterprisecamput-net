<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Writing Pixel Shaders</title>

    <link rel="alternate" href="https://campusempresa.com/mod/direct_x/03-03-writing-pixel-shaders" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/direct_x/03-03-writing-pixel-shaders" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/direct_x/03-03-writing-pixel-shaders" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/direct_x/03-03-writing-pixel-shaders" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/direct_x/03-03-writing-pixel-shaders" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='03-02-writing-vertex-shaders' title="Writing Vertex Shaders">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Writing Pixel Shaders</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-04-compiling-using-shaders' title="Compiling and Using Shaders">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Pixel shaders, also known as fragment shaders, are a type of shader program executed on the GPU to determine the color and other attributes of each pixel. They are essential for creating detailed and dynamic visual effects in 3D applications. In this section, we will cover the basics of writing pixel shaders in DirectX.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li>
<p><strong>Pixel Shader Overview</strong>:</p>
<ul>
<li>Pixel shaders process fragments generated by the rasterization stage.</li>
<li>They determine the final color, depth, and other attributes of each pixel.</li>
</ul>
</li>
<li>
<p><strong>HLSL (High-Level Shader Language)</strong>:</p>
<ul>
<li>HLSL is the language used to write shaders in DirectX.</li>
<li>It is similar to C/C++ and provides a range of built-in functions and types for graphics programming.</li>
</ul>
</li>
<li>
<p><strong>Shader Model</strong>:</p>
<ul>
<li>DirectX supports various shader models, each providing different features and capabilities.</li>
<li>Ensure your pixel shader is compatible with the shader model supported by your target hardware.</li>
</ul>
</li>
</ol>
</div><h1>Writing a Basic Pixel Shader</h1>
<div class='content'></div><h2>Step 1: Define the Pixel Shader in HLSL</h2>
<div class='content'><p>Here is a simple example of a pixel shader written in HLSL:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gU2ltcGxlUGl4ZWxTaGFkZXIuaGxzbApzdHJ1Y3QgUFNJbnB1dAp7CiAgICBmbG9hdDQgcG9zaXRpb24gOiBTVl9QT1NJVElPTjsKICAgIGZsb2F0NCBjb2xvciA6IENPTE9SOwp9OwoKZmxvYXQ0IG1haW4oUFNJbnB1dCBpbnB1dCkgOiBTVl9UQVJHRVQKewogICAgcmV0dXJuIGlucHV0LmNvbG9yOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// SimplePixelShader.hlsl
struct PSInput
{
    float4 position : SV_POSITION;
    float4 color : COLOR;
};

float4 main(PSInput input) : SV_TARGET
{
    return input.color;
}</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><strong>PSInput Structure</strong>: This structure defines the input to the pixel shader. It contains the position and color of the pixel.</li>
<li><strong>main Function</strong>: This is the entry point of the pixel shader. It takes a <code>PSInput</code> structure as input and returns a <code>float4</code> representing the color of the pixel.</li>
<li><strong>SV_POSITION</strong>: A system value semantic that indicates the position of the pixel.</li>
<li><strong>COLOR</strong>: A semantic that indicates the color of the pixel.</li>
<li><strong>SV_TARGET</strong>: A system value semantic that indicates the output color of the pixel.</li>
</ul>
</div><h2>Step 2: Compile the Pixel Shader</h2>
<div class='content'><p>To use the pixel shader in your DirectX application, you need to compile it. Here is an example of how to compile the shader using the DirectX Shader Compiler (FXC):</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnhjIC9UIHBzXzVfMCAvRSBtYWluIC9GbyBTaW1wbGVQaXhlbFNoYWRlci5jc28gU2ltcGxlUGl4ZWxTaGFkZXIuaGxzbA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>fxc /T ps_5_0 /E main /Fo SimplePixelShader.cso SimplePixelShader.hlsl</pre></div><div class='content'><ul>
<li><strong>/T ps_5_0</strong>: Specifies the target shader model (in this case, Shader Model 5.0).</li>
<li><strong>/E main</strong>: Specifies the entry point of the shader.</li>
<li><strong>/Fo SimplePixelShader.cso</strong>: Specifies the output file for the compiled shader object.</li>
<li><strong>SimplePixelShader.hlsl</strong>: The HLSL file containing the shader code.</li>
</ul>
</div><h2>Step 3: Load and Use the Pixel Shader in Your Application</h2>
<div class='content'><p>Here is an example of how to load and use the compiled pixel shader in a DirectX application:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gTG9hZCB0aGUgY29tcGlsZWQgcGl4ZWwgc2hhZGVyCklEM0QxMVBpeGVsU2hhZGVyKiBwaXhlbFNoYWRlcjsKSUQzREJsb2IqIHBzQmxvYiA9IG51bGxwdHI7CkhSRVNVTFQgaHIgPSBEM0RSZWFkRmlsZVRvQmxvYihMIlNpbXBsZVBpeGVsU2hhZGVyLmNzbyIsICZwc0Jsb2IpOwppZiAoRkFJTEVEKGhyKSkKewogICAgLy8gSGFuZGxlIGVycm9yCn0KCmhyID0gZGV2aWNlLT5DcmVhdGVQaXhlbFNoYWRlcihwc0Jsb2ItPkdldEJ1ZmZlclBvaW50ZXIoKSwgcHNCbG9iLT5HZXRCdWZmZXJTaXplKCksIG51bGxwdHIsICZwaXhlbFNoYWRlcik7CmlmIChGQUlMRUQoaHIpKQp7CiAgICAvLyBIYW5kbGUgZXJyb3IKfQoKLy8gU2V0IHRoZSBwaXhlbCBzaGFkZXIKY29udGV4dC0+UFNTZXRTaGFkZXIocGl4ZWxTaGFkZXIsIG51bGxwdHIsIDApOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Load the compiled pixel shader
ID3D11PixelShader* pixelShader;
ID3DBlob* psBlob = nullptr;
HRESULT hr = D3DReadFileToBlob(L&quot;SimplePixelShader.cso&quot;, &amp;psBlob);
if (FAILED(hr))
{
    // Handle error
}

hr = device-&gt;CreatePixelShader(psBlob-&gt;GetBufferPointer(), psBlob-&gt;GetBufferSize(), nullptr, &amp;pixelShader);
if (FAILED(hr))
{
    // Handle error
}

// Set the pixel shader
context-&gt;PSSetShader(pixelShader, nullptr, 0);</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><strong>D3DReadFileToBlob</strong>: Reads the compiled shader object file into a blob.</li>
<li><strong>CreatePixelShader</strong>: Creates a pixel shader object from the compiled shader code.</li>
<li><strong>PSSetShader</strong>: Sets the pixel shader for the rendering pipeline.</li>
</ul>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Create a Gradient Pixel Shader</h2>
<div class='content'><p><strong>Objective</strong>: Write a pixel shader that creates a gradient effect based on the pixel's position.</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Define the pixel shader in HLSL to create a gradient effect.</li>
<li>Compile the pixel shader.</li>
<li>Load and use the pixel shader in your DirectX application.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gR3JhZGllbnRQaXhlbFNoYWRlci5obHNsCnN0cnVjdCBQU0lucHV0CnsKICAgIGZsb2F0NCBwb3NpdGlvbiA6IFNWX1BPU0lUSU9OOwp9OwoKZmxvYXQ0IG1haW4oUFNJbnB1dCBpbnB1dCkgOiBTVl9UQVJHRVQKewogICAgZmxvYXQgZ3JhZGllbnQgPSBpbnB1dC5wb3NpdGlvbi55IC8gNjAwLjBmOyAvLyBBc3N1bWluZyBhIHNjcmVlbiBoZWlnaHQgb2YgNjAwCiAgICByZXR1cm4gZmxvYXQ0KGdyYWRpZW50LCBncmFkaWVudCwgZ3JhZGllbnQsIDEuMGYpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// GradientPixelShader.hlsl
struct PSInput
{
    float4 position : SV_POSITION;
};

float4 main(PSInput input) : SV_TARGET
{
    float gradient = input.position.y / 600.0f; // Assuming a screen height of 600
    return float4(gradient, gradient, gradient, 1.0f);
}</pre></div><div class='content'><p><strong>Compile the Shader</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnhjIC9UIHBzXzVfMCAvRSBtYWluIC9GbyBHcmFkaWVudFBpeGVsU2hhZGVyLmNzbyBHcmFkaWVudFBpeGVsU2hhZGVyLmhsc2w="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>fxc /T ps_5_0 /E main /Fo GradientPixelShader.cso GradientPixelShader.hlsl</pre></div><div class='content'><p><strong>Load and Use the Shader</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gTG9hZCB0aGUgY29tcGlsZWQgcGl4ZWwgc2hhZGVyCklEM0QxMVBpeGVsU2hhZGVyKiBncmFkaWVudFBpeGVsU2hhZGVyOwpJRDNEQmxvYiogcHNCbG9iID0gbnVsbHB0cjsKSFJFU1VMVCBociA9IEQzRFJlYWRGaWxlVG9CbG9iKEwiR3JhZGllbnRQaXhlbFNoYWRlci5jc28iLCAmcHNCbG9iKTsKaWYgKEZBSUxFRChocikpCnsKICAgIC8vIEhhbmRsZSBlcnJvcgp9CgpociA9IGRldmljZS0+Q3JlYXRlUGl4ZWxTaGFkZXIocHNCbG9iLT5HZXRCdWZmZXJQb2ludGVyKCksIHBzQmxvYi0+R2V0QnVmZmVyU2l6ZSgpLCBudWxscHRyLCAmZ3JhZGllbnRQaXhlbFNoYWRlcik7CmlmIChGQUlMRUQoaHIpKQp7CiAgICAvLyBIYW5kbGUgZXJyb3IKfQoKLy8gU2V0IHRoZSBwaXhlbCBzaGFkZXIKY29udGV4dC0+UFNTZXRTaGFkZXIoZ3JhZGllbnRQaXhlbFNoYWRlciwgbnVsbHB0ciwgMCk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Load the compiled pixel shader
ID3D11PixelShader* gradientPixelShader;
ID3DBlob* psBlob = nullptr;
HRESULT hr = D3DReadFileToBlob(L&quot;GradientPixelShader.cso&quot;, &amp;psBlob);
if (FAILED(hr))
{
    // Handle error
}

hr = device-&gt;CreatePixelShader(psBlob-&gt;GetBufferPointer(), psBlob-&gt;GetBufferSize(), nullptr, &amp;gradientPixelShader);
if (FAILED(hr))
{
    // Handle error
}

// Set the pixel shader
context-&gt;PSSetShader(gradientPixelShader, nullptr, 0);</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Incorrect Semantics</strong>: Ensure you use the correct semantics for the input and output variables.</li>
<li><strong>Shader Model Compatibility</strong>: Verify that your shader is compatible with the target shader model and hardware.</li>
<li><strong>Resource Management</strong>: Properly manage resources such as shader blobs and shader objects to avoid memory leaks.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the basics of writing pixel shaders in DirectX. We discussed the structure of a pixel shader, how to compile it, and how to use it in a DirectX application. We also provided a practical exercise to reinforce the concepts learned. In the next section, we will explore more advanced shader techniques and how to optimize shaders for better performance.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='03-02-writing-vertex-shaders' title="Writing Vertex Shaders">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-04-compiling-using-shaders' title="Compiling and Using Shaders">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
