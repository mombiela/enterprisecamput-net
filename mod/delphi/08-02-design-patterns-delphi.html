<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Design Patterns in Delphi</title>

    <link rel="alternate" href="https://campusempresa.com/mod/delphi/08-02-design-patterns-delphi" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/delphi/08-02-design-patterns-delphi" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/delphi/08-02-design-patterns-delphi" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/delphi/08-02-design-patterns-delphi" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/delphi/08-02-design-patterns-delphi" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Programming Languages</a>
				 					<a href="/categ/frameworks">Frameworks and Libraries</a>
				 					<a href="/categ/tech-tools">Technical Tools</a>
				 					<a href="/categ/foundations">Theoretical Foundations</a>
				 					<a href="/categ/soft-skills">Social Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-01-code-organization-documentation' title="Code Organization and Documentation">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Design Patterns in Delphi</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-03-refactoring-techniques' title="Refactoring Techniques">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Design patterns are proven solutions to common problems in software design. They provide a template for how to solve a problem in a way that is both reusable and adaptable. In this section, we will explore some of the most commonly used design patterns in Delphi/Object Pascal, understand their structure, and see how they can be implemented.</p>
</div><h1><p>What are Design Patterns?</p>
</h1>
<div class='content'><p>Design patterns are typical solutions to common problems in software design. They are like blueprints that you can customize to solve a particular design problem in your code. Design patterns can speed up the development process by providing tested, proven development paradigms.</p>
</div><h2><p>Types of Design Patterns</p>
</h2>
<div class='content'><p>Design patterns are generally categorized into three types:</p>
<ol>
<li><strong>Creational Patterns</strong>: Deal with object creation mechanisms.</li>
<li><strong>Structural Patterns</strong>: Deal with object composition or structure.</li>
<li><strong>Behavioral Patterns</strong>: Deal with object interaction and responsibility.</li>
</ol>
</div><h1><p>Common Design Patterns in Delphi</p>
</h1>
<div class='content'></div><h2><ol>
<li>Singleton Pattern</li>
</ol>
</h2>
<div class='content'><p>The Singleton pattern ensures that a class has only one instance and provides a global point of access to it.</p>
<h4>Structure</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHlwZQogIFRTaW5nbGV0b24gPSBjbGFzcwogIHByaXZhdGUKICAgIGNsYXNzIHZhciBGSW5zdGFuY2U6IFRTaW5nbGV0b247CiAgICBjb25zdHJ1Y3RvciBDcmVhdGU7CiAgcHVibGljCiAgICBjbGFzcyBmdW5jdGlvbiBHZXRJbnN0YW5jZTogVFNpbmdsZXRvbjsKICBlbmQ7Cgpjb25zdHJ1Y3RvciBUU2luZ2xldG9uLkNyZWF0ZTsKYmVnaW4KICBpbmhlcml0ZWQ7CiAgLy8gSW5pdGlhbGl6YXRpb24gY29kZQplbmQ7CgpjbGFzcyBmdW5jdGlvbiBUU2luZ2xldG9uLkdldEluc3RhbmNlOiBUU2luZ2xldG9uOwpiZWdpbgogIGlmIEZJbnN0YW5jZSA9IG5pbCB0aGVuCiAgICBGSW5zdGFuY2UgOj0gVFNpbmdsZXRvbi5DcmVhdGU7CiAgUmVzdWx0IDo9IEZJbnN0YW5jZTsKZW5kOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>type
  TSingleton = class
  private
    class var FInstance: TSingleton;
    constructor Create;
  public
    class function GetInstance: TSingleton;
  end;

constructor TSingleton.Create;
begin
  inherited;
  // Initialization code
end;

class function TSingleton.GetInstance: TSingleton;
begin
  if FInstance = nil then
    FInstance := TSingleton.Create;
  Result := FInstance;
end;</pre></div><div class='content'><h4>Explanation</h4>
<ul>
<li><strong>Private Constructor</strong>: Ensures that the class cannot be instantiated from outside.</li>
<li><strong>Class Variable</strong>: Holds the single instance of the class.</li>
<li><strong>GetInstance Method</strong>: Provides a global point of access to the instance.</li>
</ul>
</div><h2><ol start="2">
<li>Factory Pattern</li>
</ol>
</h2>
<div class='content'><p>The Factory pattern defines an interface for creating an object but lets subclasses alter the type of objects that will be created.</p>
<h4>Structure</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHlwZQogIFRQcm9kdWN0ID0gY2xhc3MKICBlbmQ7CgogIFRDb25jcmV0ZVByb2R1Y3RBID0gY2xhc3MoVFByb2R1Y3QpCiAgZW5kOwoKICBUQ29uY3JldGVQcm9kdWN0QiA9IGNsYXNzKFRQcm9kdWN0KQogIGVuZDsKCiAgVEZhY3RvcnkgPSBjbGFzcwogIHB1YmxpYwogICAgZnVuY3Rpb24gQ3JlYXRlUHJvZHVjdChBVHlwZTogc3RyaW5nKTogVFByb2R1Y3Q7CiAgZW5kOwoKZnVuY3Rpb24gVEZhY3RvcnkuQ3JlYXRlUHJvZHVjdChBVHlwZTogc3RyaW5nKTogVFByb2R1Y3Q7CmJlZ2luCiAgaWYgQVR5cGUgPSAnQScgdGhlbgogICAgUmVzdWx0IDo9IFRDb25jcmV0ZVByb2R1Y3RBLkNyZWF0ZQogIGVsc2UgaWYgQVR5cGUgPSAnQicgdGhlbgogICAgUmVzdWx0IDo9IFRDb25jcmV0ZVByb2R1Y3RCLkNyZWF0ZQogIGVsc2UKICAgIFJlc3VsdCA6PSBuaWw7CmVuZDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>type
  TProduct = class
  end;

  TConcreteProductA = class(TProduct)
  end;

  TConcreteProductB = class(TProduct)
  end;

  TFactory = class
  public
    function CreateProduct(AType: string): TProduct;
  end;

function TFactory.CreateProduct(AType: string): TProduct;
begin
  if AType = 'A' then
    Result := TConcreteProductA.Create
  else if AType = 'B' then
    Result := TConcreteProductB.Create
  else
    Result := nil;
end;</pre></div><div class='content'><h4>Explanation</h4>
<ul>
<li><strong>Product Class</strong>: The base class for all products.</li>
<li><strong>Concrete Products</strong>: Specific implementations of the product.</li>
<li><strong>Factory Class</strong>: Contains a method to create products based on a type.</li>
</ul>
</div><h2><ol start="3">
<li>Observer Pattern</li>
</ol>
</h2>
<div class='content'><p>The Observer pattern defines a one-to-many dependency between objects so that when one object changes state, all its dependents are notified and updated automatically.</p>
<h4>Structure</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHlwZQogIElPYnNlcnZlciA9IGludGVyZmFjZQogICAgcHJvY2VkdXJlIFVwZGF0ZTsKICBlbmQ7CgogIFRTdWJqZWN0ID0gY2xhc3MKICBwcml2YXRlCiAgICBGT2JzZXJ2ZXJzOiBUTGlzdDxJT2JzZXJ2ZXI+OwogIHB1YmxpYwogICAgcHJvY2VkdXJlIEF0dGFjaChBT2JzZXJ2ZXI6IElPYnNlcnZlcik7CiAgICBwcm9jZWR1cmUgRGV0YWNoKEFPYnNlcnZlcjogSU9ic2VydmVyKTsKICAgIHByb2NlZHVyZSBOb3RpZnk7CiAgZW5kOwoKICBUQ29uY3JldGVPYnNlcnZlciA9IGNsYXNzKFRJbnRlcmZhY2VkT2JqZWN0LCBJT2JzZXJ2ZXIpCiAgcHVibGljCiAgICBwcm9jZWR1cmUgVXBkYXRlOwogIGVuZDsKCnByb2NlZHVyZSBUU3ViamVjdC5BdHRhY2goQU9ic2VydmVyOiBJT2JzZXJ2ZXIpOwpiZWdpbgogIEZPYnNlcnZlcnMuQWRkKEFPYnNlcnZlcik7CmVuZDsKCnByb2NlZHVyZSBUU3ViamVjdC5EZXRhY2goQU9ic2VydmVyOiBJT2JzZXJ2ZXIpOwpiZWdpbgogIEZPYnNlcnZlcnMuUmVtb3ZlKEFPYnNlcnZlcik7CmVuZDsKCnByb2NlZHVyZSBUU3ViamVjdC5Ob3RpZnk7CnZhcgogIE9ic2VydmVyOiBJT2JzZXJ2ZXI7CmJlZ2luCiAgZm9yIE9ic2VydmVyIGluIEZPYnNlcnZlcnMgZG8KICAgIE9ic2VydmVyLlVwZGF0ZTsKZW5kOwoKcHJvY2VkdXJlIFRDb25jcmV0ZU9ic2VydmVyLlVwZGF0ZTsKYmVnaW4KICAvLyBVcGRhdGUgbG9naWMKZW5kOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>type
  IObserver = interface
    procedure Update;
  end;

  TSubject = class
  private
    FObservers: TList&lt;IObserver&gt;;
  public
    procedure Attach(AObserver: IObserver);
    procedure Detach(AObserver: IObserver);
    procedure Notify;
  end;

  TConcreteObserver = class(TInterfacedObject, IObserver)
  public
    procedure Update;
  end;

procedure TSubject.Attach(AObserver: IObserver);
begin
  FObservers.Add(AObserver);
end;

procedure TSubject.Detach(AObserver: IObserver);
begin
  FObservers.Remove(AObserver);
end;

procedure TSubject.Notify;
var
  Observer: IObserver;
begin
  for Observer in FObservers do
    Observer.Update;
end;

procedure TConcreteObserver.Update;
begin
  // Update logic
end;</pre></div><div class='content'><h4>Explanation</h4>
<ul>
<li><strong>IObserver Interface</strong>: Defines the update method.</li>
<li><strong>Subject Class</strong>: Manages observers and notifies them of changes.</li>
<li><strong>Concrete Observer</strong>: Implements the update method to respond to changes.</li>
</ul>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Implementing the Singleton Pattern</p>
</h2>
<div class='content'><ol>
<li>Create a new Delphi project.</li>
<li>Implement the Singleton pattern for a class that manages application settings.</li>
<li>Ensure that only one instance of the settings manager can exist.</li>
</ol>
<h4>Solution</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHlwZQogIFRTZXR0aW5nc01hbmFnZXIgPSBjbGFzcwogIHByaXZhdGUKICAgIGNsYXNzIHZhciBGSW5zdGFuY2U6IFRTZXR0aW5nc01hbmFnZXI7CiAgICBjb25zdHJ1Y3RvciBDcmVhdGU7CiAgcHVibGljCiAgICBjbGFzcyBmdW5jdGlvbiBHZXRJbnN0YW5jZTogVFNldHRpbmdzTWFuYWdlcjsKICAgIHByb2NlZHVyZSBMb2FkU2V0dGluZ3M7CiAgICBwcm9jZWR1cmUgU2F2ZVNldHRpbmdzOwogIGVuZDsKCmNvbnN0cnVjdG9yIFRTZXR0aW5nc01hbmFnZXIuQ3JlYXRlOwpiZWdpbgogIGluaGVyaXRlZDsKICAvLyBJbml0aWFsaXphdGlvbiBjb2RlCmVuZDsKCmNsYXNzIGZ1bmN0aW9uIFRTZXR0aW5nc01hbmFnZXIuR2V0SW5zdGFuY2U6IFRTZXR0aW5nc01hbmFnZXI7CmJlZ2luCiAgaWYgRkluc3RhbmNlID0gbmlsIHRoZW4KICAgIEZJbnN0YW5jZSA6PSBUU2V0dGluZ3NNYW5hZ2VyLkNyZWF0ZTsKICBSZXN1bHQgOj0gRkluc3RhbmNlOwplbmQ7Cgpwcm9jZWR1cmUgVFNldHRpbmdzTWFuYWdlci5Mb2FkU2V0dGluZ3M7CmJlZ2luCiAgLy8gTG9hZCBzZXR0aW5ncyBmcm9tIGZpbGUgb3IgZGF0YWJhc2UKZW5kOwoKcHJvY2VkdXJlIFRTZXR0aW5nc01hbmFnZXIuU2F2ZVNldHRpbmdzOwpiZWdpbgogIC8vIFNhdmUgc2V0dGluZ3MgdG8gZmlsZSBvciBkYXRhYmFzZQplbmQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>type
  TSettingsManager = class
  private
    class var FInstance: TSettingsManager;
    constructor Create;
  public
    class function GetInstance: TSettingsManager;
    procedure LoadSettings;
    procedure SaveSettings;
  end;

constructor TSettingsManager.Create;
begin
  inherited;
  // Initialization code
end;

class function TSettingsManager.GetInstance: TSettingsManager;
begin
  if FInstance = nil then
    FInstance := TSettingsManager.Create;
  Result := FInstance;
end;

procedure TSettingsManager.LoadSettings;
begin
  // Load settings from file or database
end;

procedure TSettingsManager.SaveSettings;
begin
  // Save settings to file or database
end;</pre></div><div class='content'></div><h2><p>Common Mistakes and Tips</p>
</h2>
<div class='content'><ul>
<li><strong>Mistake</strong>: Forgetting to make the constructor private.
<ul>
<li><strong>Tip</strong>: Always ensure the constructor is private to prevent external instantiation.</li>
</ul>
</li>
<li><strong>Mistake</strong>: Not handling multi-threading scenarios.
<ul>
<li><strong>Tip</strong>: Use thread-safe mechanisms if the Singleton instance will be accessed from multiple threads.</li>
</ul>
</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we explored some of the most commonly used design patterns in Delphi/Object Pascal, including Singleton, Factory, and Observer patterns. Understanding and implementing these patterns can significantly improve the design and maintainability of your code. In the next section, we will delve into refactoring techniques to further enhance your coding skills.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-01-code-organization-documentation' title="Code Organization and Documentation">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-03-refactoring-techniques' title="Refactoring Techniques">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
