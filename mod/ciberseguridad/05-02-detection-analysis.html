<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Detection and Analysis</title>

    <link rel="alternate" href="https://campusempresa.com/mod/ciberseguridad/05-02-deteccion-analisis" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/ciberseguridad/05-02-deteccio-analisi" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/ciberseguridad/05-02-detection-analysis" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=3" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/ciberseguridad/05-02-deteccion-analisis" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/ciberseguridad/05-02-deteccio-analisi" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>Building today's and tomorrow's society</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Languages</a>
				 					<a href="/categ/frameworks">Frameworks</a>
				 					<a href="/categ/tech-tools">Tools</a>
				 					<a href="/categ/foundations">Foundations</a>
				 					<a href="/categ/soft-skills">Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-01-planning-preparation' title="Planning and Preparation">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Detection and Analysis</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-03-containment-eradication-recovery' title="Containment, Eradication, and Recovery">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1><p>Introduction</p>
</h1>
<div class='content'><p>Detection and analysis are critical components of incident management and response in cybersecurity. This module will cover the methods and tools used to identify potential security incidents and analyze them to understand their impact and origin.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Incident Detection</strong>: The process of identifying potential security breaches or anomalies that may indicate a cyberattack.</li>
<li><strong>Incident Analysis</strong>: The detailed examination of detected incidents to determine their nature, scope, and impact.</li>
<li><strong>Indicators of Compromise (IoCs)</strong>: Pieces of forensic data that suggest a potential intrusion.</li>
<li><strong>Security Information and Event Management (SIEM)</strong>: Systems that provide real-time analysis of security alerts generated by applications and network hardware.</li>
<li><strong>Anomaly Detection</strong>: Identifying patterns in data that do not conform to expected behavior.</li>
</ol>
</div><h1><p>Incident Detection</p>
</h1>
<div class='content'></div><h2><p>Methods of Detection</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Signature-Based Detection</strong>:</p>
<ul>
<li>Uses predefined patterns (signatures) to identify known threats.</li>
<li>Effective against known malware and attack vectors.</li>
<li>Example: Antivirus software.</li>
</ul>
</li>
<li>
<p><strong>Anomaly-Based Detection</strong>:</p>
<ul>
<li>Identifies deviations from normal behavior.</li>
<li>Useful for detecting unknown threats.</li>
<li>Example: Network behavior analysis tools.</li>
</ul>
</li>
<li>
<p><strong>Heuristic-Based Detection</strong>:</p>
<ul>
<li>Uses algorithms to identify suspicious behavior.</li>
<li>Can detect new and evolving threats.</li>
<li>Example: Heuristic analysis in antivirus programs.</li>
</ul>
</li>
<li>
<p><strong>Behavioral Detection</strong>:</p>
<ul>
<li>Monitors the behavior of users and systems.</li>
<li>Detects unusual activities that may indicate a breach.</li>
<li>Example: User and Entity Behavior Analytics (UEBA).</li>
</ul>
</li>
</ol>
</div><h2><p>Tools for Detection</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Intrusion Detection Systems (IDS)</strong>:</p>
<ul>
<li>Monitors network traffic for suspicious activity.</li>
<li>Can be network-based (NIDS) or host-based (HIDS).</li>
<li>Example: Snort.</li>
</ul>
</li>
<li>
<p><strong>Security Information and Event Management (SIEM)</strong>:</p>
<ul>
<li>Aggregates and analyzes data from various sources.</li>
<li>Provides real-time monitoring and alerts.</li>
<li>Example: Splunk, IBM QRadar.</li>
</ul>
</li>
<li>
<p><strong>Endpoint Detection and Response (EDR)</strong>:</p>
<ul>
<li>Monitors and collects activity data from endpoints.</li>
<li>Provides detailed visibility into endpoint activities.</li>
<li>Example: CrowdStrike Falcon, Carbon Black.</li>
</ul>
</li>
</ol>
</div><h1><p>Incident Analysis</p>
</h1>
<div class='content'></div><h2><p>Steps in Incident Analysis</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Initial Triage</strong>:</p>
<ul>
<li>Determine the severity and scope of the incident.</li>
<li>Prioritize incidents based on potential impact.</li>
</ul>
</li>
<li>
<p><strong>Data Collection</strong>:</p>
<ul>
<li>Gather relevant data from logs, network traffic, and affected systems.</li>
<li>Use tools like SIEM, IDS, and EDR for data collection.</li>
</ul>
</li>
<li>
<p><strong>Data Analysis</strong>:</p>
<ul>
<li>Analyze collected data to identify the root cause and attack vector.</li>
<li>Use forensic tools and techniques to examine evidence.</li>
</ul>
</li>
<li>
<p><strong>Impact Assessment</strong>:</p>
<ul>
<li>Determine the extent of the damage caused by the incident.</li>
<li>Assess the impact on systems, data, and business operations.</li>
</ul>
</li>
<li>
<p><strong>Documentation</strong>:</p>
<ul>
<li>Document findings, actions taken, and lessons learned.</li>
<li>Create a detailed incident report for future reference.</li>
</ul>
</li>
</ol>
</div><h2><p>Practical Example</p>
</h2>
<div class='content'><p>Let's consider a scenario where an organization detects unusual network traffic. Here's how the detection and analysis process might unfold:</p>
<ol>
<li>
<p><strong>Detection</strong>:</p>
<ul>
<li>The SIEM system generates an alert for unusual outbound traffic from a server.</li>
<li>The network-based IDS (NIDS) also flags the traffic as suspicious.</li>
</ul>
</li>
<li>
<p><strong>Initial Triage</strong>:</p>
<ul>
<li>The security team reviews the alerts and determines that the incident is high priority due to the potential data exfiltration.</li>
</ul>
</li>
<li>
<p><strong>Data Collection</strong>:</p>
<ul>
<li>Logs from the SIEM and IDS are collected.</li>
<li>Network traffic captures are obtained for further analysis.</li>
</ul>
</li>
<li>
<p><strong>Data Analysis</strong>:</p>
<ul>
<li>The analysis reveals that the server was communicating with an external IP address known for malicious activity.</li>
<li>Further investigation shows that the server was compromised via a phishing email.</li>
</ul>
</li>
<li>
<p><strong>Impact Assessment</strong>:</p>
<ul>
<li>The compromised server contained sensitive customer data.</li>
<li>The extent of data exfiltration is assessed, and affected customers are identified.</li>
</ul>
</li>
<li>
<p><strong>Documentation</strong>:</p>
<ul>
<li>A detailed incident report is created, including the timeline, actions taken, and recommendations for preventing future incidents.</li>
</ul>
</li>
</ol>
</div><h2><p>Code Example: Analyzing Log Files with Python</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHJlCgojIFNhbXBsZSBsb2cgZW50cnkKbG9nX2VudHJ5ID0gIjIwMjMtMTAtMDEgMTI6MzQ6NTYsMTIzIC0gSU5GTyAtIFVzZXIgbG9naW4gc3VjY2Vzc2Z1bCAtIHVzZXI6IGpvaG5kb2UiCgojIFJlZ3VsYXIgZXhwcmVzc2lvbiB0byBleHRyYWN0IGRhdGUsIHRpbWUsIGFuZCBtZXNzYWdlCmxvZ19wYXR0ZXJuID0gcmUuY29tcGlsZShyIihcZHs0fS1cZHsyfS1cZHsyfSBcZHsyfTpcZHsyfTpcZHsyfSksXGR7M30gLSAoXHcrKSAtICguKykiKQoKIyBGdW5jdGlvbiB0byBwYXJzZSBsb2cgZW50cnkKZGVmIHBhcnNlX2xvZ19lbnRyeShlbnRyeSk6CiAgICBtYXRjaCA9IGxvZ19wYXR0ZXJuLm1hdGNoKGVudHJ5KQogICAgaWYgbWF0Y2g6CiAgICAgICAgZGF0ZV90aW1lLCBsb2dfbGV2ZWwsIG1lc3NhZ2UgPSBtYXRjaC5ncm91cHMoKQogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICJkYXRlX3RpbWUiOiBkYXRlX3RpbWUsCiAgICAgICAgICAgICJsb2dfbGV2ZWwiOiBsb2dfbGV2ZWwsCiAgICAgICAgICAgICJtZXNzYWdlIjogbWVzc2FnZQogICAgICAgIH0KICAgIHJldHVybiBOb25lCgojIFBhcnNlIHRoZSBzYW1wbGUgbG9nIGVudHJ5CnBhcnNlZF9lbnRyeSA9IHBhcnNlX2xvZ19lbnRyeShsb2dfZW50cnkpCnByaW50KHBhcnNlZF9lbnRyeSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import re

# Sample log entry
log_entry = &quot;2023-10-01 12:34:56,123 - INFO - User login successful - user: johndoe&quot;

# Regular expression to extract date, time, and message
log_pattern = re.compile(r&quot;(\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}),\d{3} - (\w+) - (.+)&quot;)

# Function to parse log entry
def parse_log_entry(entry):
    match = log_pattern.match(entry)
    if match:
        date_time, log_level, message = match.groups()
        return {
            &quot;date_time&quot;: date_time,
            &quot;log_level&quot;: log_level,
            &quot;message&quot;: message
        }
    return None

# Parse the sample log entry
parsed_entry = parse_log_entry(log_entry)
print(parsed_entry)</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The code uses a regular expression to parse a log entry.</li>
<li>It extracts the date, time, log level, and message from the log entry.</li>
<li>The <code>parse_log_entry</code> function returns a dictionary with the extracted information.</li>
</ul>
</div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Identify Indicators of Compromise (IoCs)</p>
</h2>
<div class='content'><p><strong>Task</strong>: Given a set of log entries, identify potential IoCs.</p>
<p><strong>Log Entries</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("MjAyMy0xMC0wMSAxMjozNDo1NiwxMjMgLSBJTkZPIC0gVXNlciBsb2dpbiBzdWNjZXNzZnVsIC0gdXNlcjogam9obmRvZQoyMDIzLTEwLTAxIDEyOjM1OjAxLDQ1NiAtIFdBUk5JTkcgLSBGYWlsZWQgbG9naW4gYXR0ZW1wdCAtIHVzZXI6IGFkbWluCjIwMjMtMTAtMDEgMTI6MzU6MDUsNzg5IC0gRVJST1IgLSBVbmF1dGhvcml6ZWQgYWNjZXNzIGF0dGVtcHQgLSBJUDogMTkyLjE2OC4xLjEwMAoyMDIzLTEwLTAxIDEyOjM1OjEwLDAxMiAtIElORk8gLSBVc2VyIGxvZ291dCAtIHVzZXI6IGpvaG5kb2U="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>2023-10-01 12:34:56,123 - INFO - User login successful - user: johndoe
2023-10-01 12:35:01,456 - WARNING - Failed login attempt - user: admin
2023-10-01 12:35:05,789 - ERROR - Unauthorized access attempt - IP: 192.168.1.100
2023-10-01 12:35:10,012 - INFO - User logout - user: johndoe</pre></div><div class='content'><p><strong>Solution</strong>:</p>
<ul>
<li>The failed login attempt and unauthorized access attempt are potential IoCs.</li>
<li>Specifically, the log entry with &quot;ERROR - Unauthorized access attempt - IP: 192.168.1.100&quot; indicates a suspicious activity.</li>
</ul>
</div><h2><p>Exercise 2: Analyze Network Traffic</p>
</h2>
<div class='content'><p><strong>Task</strong>: Analyze a sample network traffic capture to identify suspicious activity.</p>
<p><strong>Network Traffic</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("MTAuMC4wLjEgLT4gMTkyLjE2OC4xLjEwMDo4MCAoSFRUUCkKMTAuMC4wLjEgLT4gMTkyLjE2OC4xLjEwMTo0NDMgKEhUVFBTKQoxMC4wLjAuMSAtPiAxOTIuMTY4LjEuMTAyOjIyIChTU0gpCjE5Mi4xNjguMS4xMDAgLT4gMTAuMC4wLjE6ODAgKEhUVFApCjE5Mi4xNjguMS4xMDAgLT4gMTAuMC4wLjE6ODA4MCAoSFRUUCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>10.0.0.1 -&gt; 192.168.1.100:80 (HTTP)
10.0.0.1 -&gt; 192.168.1.101:443 (HTTPS)
10.0.0.1 -&gt; 192.168.1.102:22 (SSH)
192.168.1.100 -&gt; 10.0.0.1:80 (HTTP)
192.168.1.100 -&gt; 10.0.0.1:8080 (HTTP)</pre></div><div class='content'><p><strong>Solution</strong>:</p>
<ul>
<li>The traffic from <code>192.168.1.100</code> to <code>10.0.0.1:8080</code> is unusual since port 8080 is not commonly used for standard web traffic.</li>
<li>This could indicate an attempt to bypass standard security measures.</li>
</ul>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Ignoring Low-Severity Alerts</strong>:</p>
<ul>
<li>Low-severity alerts can sometimes indicate the early stages of an attack. Always investigate patterns of low-severity alerts.</li>
</ul>
</li>
<li>
<p><strong>Overlooking Context</strong>:</p>
<ul>
<li>Always consider the context of an alert. A single failed login attempt might be benign, but multiple failed attempts in a short period could indicate a brute-force attack.</li>
</ul>
</li>
<li>
<p><strong>Inadequate Documentation</strong>:</p>
<ul>
<li>Proper documentation is crucial for learning from incidents and improving future response efforts.</li>
</ul>
</li>
</ol>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this module, we covered the essential aspects of detection and analysis in incident management. We explored various detection methods, tools, and the steps involved in analyzing incidents. By understanding these concepts, you will be better equipped to identify and respond to security incidents effectively. In the next module, we will delve into containment, eradication, and recovery strategies to handle incidents once they are detected and analyzed.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-01-planning-preparation' title="Planning and Preparation">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-03-containment-eradication-recovery' title="Containment, Eradication, and Recovery">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
