<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infrastructure as Code with PowerShell</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/infrastructure-as-code-with-powershell" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/infrastructure-as-code-with-powershell" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/infrastructure-as-code-with-powershell" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/infrastructure-as-code-with-powershell" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/infrastructure-as-code-with-powershell" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='powershell-and-cicd'>&#x25C4;PowerShell and Continuous Integration/Continuous Deployment (CI/CD)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Infrastructure as Code with PowerShell</a>
	</div>
	<div class='col-4 text-end'>
					<a href='powershell-best-practices'>PowerShell Best Practices &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Infrastructure as Code (IaC)</h1>
<div class='content'><ul>
<li><strong>Definition</strong>: Infrastructure as Code (IaC) is the process of managing and provisioning computing infrastructure through machine-readable scripts, rather than through physical hardware configuration or interactive configuration tools.</li>
<li><strong>Benefits</strong>:
<ul>
<li>Consistency and repeatability</li>
<li>Version control</li>
<li>Automation and efficiency</li>
<li>Reduced risk of human error</li>
</ul>
</li>
</ul>
</div><h1>Getting Started with PowerShell</h1>
<div class='content'><ul>
<li>
<p><strong>What is PowerShell?</strong>: A task automation and configuration management framework from Microsoft, consisting of a command-line shell and associated scripting language.</p>
</li>
<li>
<p><strong>Installing PowerShell</strong>:</p>
<ul>
<li>On Windows: PowerShell comes pre-installed.</li>
<li>On macOS/Linux: Use package managers like Homebrew or apt-get.</li>
</ul>
<pre><code class="language-bash"># macOS
brew install --cask powershell

# Linux (Ubuntu)
sudo apt-get install -y powershell
</code></pre>
</li>
</ul>
</div><h1>Basic PowerShell Syntax</h1>
<div class='content'><ul>
<li>
<p><strong>Cmdlets</strong>: PowerShell commands, pronounced &quot;command-lets&quot;.</p>
<ul>
<li>Example: <code>Get-Command</code>, <code>Get-Help</code>, <code>Get-Process</code></li>
</ul>
<pre><code class="language-powershell"># List all available cmdlets
Get-Command

# Get help for a specific cmdlet
Get-Help Get-Process
</code></pre>
</li>
<li>
<p><strong>Variables</strong>: Store data that can be used and manipulated.</p>
<pre><code class="language-powershell">$greeting = &quot;Hello, World!&quot;
Write-Output $greeting
</code></pre>
</li>
<li>
<p><strong>Pipelines</strong>: Pass the output of one cmdlet as input to another.</p>
<pre><code class="language-powershell">Get-Process | Sort-Object CPU -Descending
</code></pre>
</li>
</ul>
</div><h1>Writing PowerShell Scripts</h1>
<div class='content'><ul>
<li>
<p><strong>Script Basics</strong>: PowerShell scripts are text files with a <code>.ps1</code> extension.</p>
</li>
<li>
<p><strong>Running Scripts</strong>:</p>
<ul>
<li>Ensure execution policy allows script running: <code>Set-ExecutionPolicy -ExecutionPolicy RemoteSigned</code></li>
<li>Run a script: <code>.\script.ps1</code></li>
</ul>
<pre><code class="language-powershell"># Example script: hello.ps1
$name = &quot;PowerShell User&quot;
Write-Output &quot;Hello, $name!&quot;
</code></pre>
</li>
</ul>
</div><h1>Infrastructure as Code with PowerShell</h1>
<div class='content'><ul>
<li><strong>PowerShell Desired State Configuration (DSC)</strong>:
<ul>
<li><strong>Definition</strong>: A management platform in PowerShell that enables you to manage your IT and development infrastructure with configuration as code.</li>
<li><strong>Components</strong>:
<ul>
<li><strong>Configuration</strong>: Defines the desired state.</li>
<li><strong>Resources</strong>: The building blocks of DSC, such as files, services, and packages.</li>
<li><strong>Local Configuration Manager (LCM)</strong>: The engine that applies the configuration.</li>
</ul>
</li>
</ul>
</li>
</ul>
</div><h2>Writing a Basic DSC Configuration</h2>
<div class='content'><ul>
<li>
<p><strong>Example</strong>: Ensure a file exists with specific content.</p>
<pre><code class="language-powershell">Configuration SampleConfig {
    Node &quot;localhost&quot; {
        File ExampleFile {
            DestinationPath = &quot;C:\Example\example.txt&quot;
            Contents = &quot;Hello, DSC!&quot;
            Ensure = &quot;Present&quot;
        }
    }
}

# Generate the MOF file
SampleConfig

# Apply the configuration
Start-DscConfiguration -Path .\SampleConfig -Wait -Verbose
</code></pre>
</li>
</ul>
</div><h2>Advanced DSC Configurations</h2>
<div class='content'><ul>
<li>
<p><strong>Composite Configurations</strong>: Reusable configurations that can be included in other configurations.</p>
</li>
<li>
<p><strong>Partial Configurations</strong>: Allow different teams to manage different parts of the configuration.</p>
<pre><code class="language-powershell">Configuration WebServerConfig {
    Import-DscResource -ModuleName PSDesiredStateConfiguration

    Node &quot;WebServer&quot; {
        WindowsFeature IIS {
            Name = &quot;Web-Server&quot;
            Ensure = &quot;Present&quot;
        }

        File WebContent {
            DestinationPath = &quot;C:\inetpub\wwwroot\index.html&quot;
            Contents = &quot;&lt;html&gt;&lt;body&gt;Hello, World!&lt;/body&gt;&lt;/html&gt;&quot;
            Ensure = &quot;Present&quot;
        }
    }
}

# Generate and apply the configuration
WebServerConfig
Start-DscConfiguration -Path .\WebServerConfig -Wait -Verbose
</code></pre>
</li>
</ul>
</div><h1>Best Practices for IaC with PowerShell</h1>
<div class='content'><ul>
<li>
<p><strong>Version Control</strong>: Use Git or another version control system to track changes.</p>
</li>
<li>
<p><strong>Modularization</strong>: Break configurations into smaller, reusable modules.</p>
</li>
<li>
<p><strong>Testing</strong>: Use Pester, a testing framework for PowerShell, to write tests for your configurations.</p>
<pre><code class="language-powershell">Describe &quot;SampleConfig&quot; {
    It &quot;Should create the example file&quot; {
        $filePath = &quot;C:\Example\example.txt&quot;
        Test-Path $filePath | Should -Be $true
    }
}
</code></pre>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Infrastructure as Code with PowerShell, particularly using DSC, allows for robust, repeatable, and automated management of your infrastructure. By leveraging PowerShell's scripting capabilities, you can ensure that your infrastructure is always in the desired state, reducing the risk of configuration drift and human error. As you advance, consider integrating these practices with CI/CD pipelines to further enhance your automation workflows.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='powershell-and-cicd'>&#x25C4;PowerShell and Continuous Integration/Continuous Deployment (CI/CD)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Infrastructure as Code with PowerShell</a>
	</div>
	<div class='col-4 text-end'>
					<a href='powershell-best-practices'>PowerShell Best Practices &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
