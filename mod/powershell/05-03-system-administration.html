<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using PowerShell for System Administration</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/05-03-system-administration" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/05-03-system-administration" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/05-03-system-administration" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/05-03-system-administration" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/05-03-system-administration" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-creating-scheduled-tasks' title="Creating Scheduled Tasks">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Using PowerShell for System Administration</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-automating-active-directory' title="Automating Active Directory Tasks">Next &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1><p>Introduction</p>
</h1>
<div class='content'><p>PowerShell is a powerful tool for system administrators, providing a robust scripting environment to automate and manage various administrative tasks. This module will cover essential system administration tasks that can be performed using PowerShell, including managing services, processes, users, and system information.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Managing Services</strong>: Start, stop, and configure system services.</li>
<li><strong>Managing Processes</strong>: Monitor and control running processes.</li>
<li><strong>User and Group Management</strong>: Create, modify, and delete users and groups.</li>
<li><strong>System Information</strong>: Retrieve and analyze system information.</li>
</ol>
</div><h1><p>Managing Services</p>
</h1>
<div class='content'></div><h2><p>Listing Services</p>
</h2>
<div class='content'><p>To list all services on a system, use the <code>Get-Service</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LVNlcnZpY2U="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-Service</pre></div><div class='content'></div><h2><p>Starting and Stopping Services</p>
</h2>
<div class='content'><p>To start a service, use the <code>Start-Service</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3RhcnQtU2VydmljZSAtTmFtZSAiU2VydmljZU5hbWUi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Start-Service -Name &quot;ServiceName&quot;</pre></div><div class='content'><p>To stop a service, use the <code>Stop-Service</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3RvcC1TZXJ2aWNlIC1OYW1lICJTZXJ2aWNlTmFtZSI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Stop-Service -Name &quot;ServiceName&quot;</pre></div><div class='content'></div><h2><p>Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTdGFydCB0aGUgV2luZG93cyBVcGRhdGUgc2VydmljZQpTdGFydC1TZXJ2aWNlIC1OYW1lICJ3dWF1c2VydiIKCiMgU3RvcCB0aGUgV2luZG93cyBVcGRhdGUgc2VydmljZQpTdG9wLVNlcnZpY2UgLU5hbWUgInd1YXVzZXJ2Ig=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Start the Windows Update service
Start-Service -Name &quot;wuauserv&quot;

# Stop the Windows Update service
Stop-Service -Name &quot;wuauserv&quot;</pre></div><div class='content'></div><h2><p>Practical Exercise</p>
</h2>
<div class='content'><p><strong>Task</strong>: Write a script to check the status of the &quot;Spooler&quot; service and start it if it is stopped.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JHNlcnZpY2UgPSBHZXQtU2VydmljZSAtTmFtZSAiU3Bvb2xlciIKaWYgKCRzZXJ2aWNlLlN0YXR1cyAtZXEgIlN0b3BwZWQiKSB7CiAgICBTdGFydC1TZXJ2aWNlIC1OYW1lICJTcG9vbGVyIgogICAgV3JpdGUtT3V0cHV0ICJTcG9vbGVyIHNlcnZpY2Ugc3RhcnRlZC4iCn0gZWxzZSB7CiAgICBXcml0ZS1PdXRwdXQgIlNwb29sZXIgc2VydmljZSBpcyBhbHJlYWR5IHJ1bm5pbmcuIgp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$service = Get-Service -Name &quot;Spooler&quot;
if ($service.Status -eq &quot;Stopped&quot;) {
    Start-Service -Name &quot;Spooler&quot;
    Write-Output &quot;Spooler service started.&quot;
} else {
    Write-Output &quot;Spooler service is already running.&quot;
}</pre></div><div class='content'></div><h1><p>Managing Processes</p>
</h1>
<div class='content'></div><h2><p>Listing Processes</p>
</h2>
<div class='content'><p>To list all running processes, use the <code>Get-Process</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LVByb2Nlc3M="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-Process</pre></div><div class='content'></div><h2><p>Stopping Processes</p>
</h2>
<div class='content'><p>To stop a process, use the <code>Stop-Process</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3RvcC1Qcm9jZXNzIC1OYW1lICJQcm9jZXNzTmFtZSI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Stop-Process -Name &quot;ProcessName&quot;</pre></div><div class='content'></div><h2><p>Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMaXN0IGFsbCBydW5uaW5nIHByb2Nlc3NlcwpHZXQtUHJvY2VzcwoKIyBTdG9wIHRoZSBub3RlcGFkIHByb2Nlc3MKU3RvcC1Qcm9jZXNzIC1OYW1lICJub3RlcGFkIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># List all running processes
Get-Process

# Stop the notepad process
Stop-Process -Name &quot;notepad&quot;</pre></div><div class='content'></div><h2><p>Practical Exercise</p>
</h2>
<div class='content'><p><strong>Task</strong>: Write a script to find and stop all instances of &quot;notepad&quot;.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JHByb2Nlc3NlcyA9IEdldC1Qcm9jZXNzIC1OYW1lICJub3RlcGFkIgppZiAoJHByb2Nlc3NlcykgewogICAgJHByb2Nlc3NlcyB8IFN0b3AtUHJvY2VzcwogICAgV3JpdGUtT3V0cHV0ICJBbGwgaW5zdGFuY2VzIG9mIG5vdGVwYWQgaGF2ZSBiZWVuIHN0b3BwZWQuIgp9IGVsc2UgewogICAgV3JpdGUtT3V0cHV0ICJObyBpbnN0YW5jZXMgb2Ygbm90ZXBhZCBmb3VuZC4iCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$processes = Get-Process -Name &quot;notepad&quot;
if ($processes) {
    $processes | Stop-Process
    Write-Output &quot;All instances of notepad have been stopped.&quot;
} else {
    Write-Output &quot;No instances of notepad found.&quot;
}</pre></div><div class='content'></div><h1><p>User and Group Management</p>
</h1>
<div class='content'></div><h2><p>Creating a New User</p>
</h2>
<div class='content'><p>To create a new user, use the <code>New-LocalUser</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("TmV3LUxvY2FsVXNlciAtTmFtZSAiTmV3VXNlciIgLVBhc3N3b3JkIChDb252ZXJ0VG8tU2VjdXJlU3RyaW5nICJQQHNzdzByZCIgLUFzUGxhaW5UZXh0IC1Gb3JjZSkgLUZ1bGxOYW1lICJOZXcgVXNlciIgLURlc2NyaXB0aW9uICJBIG5ldyB1c2VyIGFjY291bnQi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>New-LocalUser -Name &quot;NewUser&quot; -Password (ConvertTo-SecureString &quot;P@ssw0rd&quot; -AsPlainText -Force) -FullName &quot;New User&quot; -Description &quot;A new user account&quot;</pre></div><div class='content'></div><h2><p>Adding a User to a Group</p>
</h2>
<div class='content'><p>To add a user to a group, use the <code>Add-LocalGroupMember</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QWRkLUxvY2FsR3JvdXBNZW1iZXIgLUdyb3VwICJBZG1pbmlzdHJhdG9ycyIgLU1lbWJlciAiTmV3VXNlciI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Add-LocalGroupMember -Group &quot;Administrators&quot; -Member &quot;NewUser&quot;</pre></div><div class='content'></div><h2><p>Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcgdXNlcgpOZXctTG9jYWxVc2VyIC1OYW1lICJOZXdVc2VyIiAtUGFzc3dvcmQgKENvbnZlcnRUby1TZWN1cmVTdHJpbmcgIlBAc3N3MHJkIiAtQXNQbGFpblRleHQgLUZvcmNlKSAtRnVsbE5hbWUgIk5ldyBVc2VyIiAtRGVzY3JpcHRpb24gIkEgbmV3IHVzZXIgYWNjb3VudCIKCiMgQWRkIHRoZSBuZXcgdXNlciB0byB0aGUgQWRtaW5pc3RyYXRvcnMgZ3JvdXAKQWRkLUxvY2FsR3JvdXBNZW1iZXIgLUdyb3VwICJBZG1pbmlzdHJhdG9ycyIgLU1lbWJlciAiTmV3VXNlciI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new user
New-LocalUser -Name &quot;NewUser&quot; -Password (ConvertTo-SecureString &quot;P@ssw0rd&quot; -AsPlainText -Force) -FullName &quot;New User&quot; -Description &quot;A new user account&quot;

# Add the new user to the Administrators group
Add-LocalGroupMember -Group &quot;Administrators&quot; -Member &quot;NewUser&quot;</pre></div><div class='content'></div><h2><p>Practical Exercise</p>
</h2>
<div class='content'><p><strong>Task</strong>: Write a script to create a new user &quot;TestUser&quot; with the password &quot;Test@123&quot; and add them to the &quot;Users&quot; group.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcgdXNlcgpOZXctTG9jYWxVc2VyIC1OYW1lICJUZXN0VXNlciIgLVBhc3N3b3JkIChDb252ZXJ0VG8tU2VjdXJlU3RyaW5nICJUZXN0QDEyMyIgLUFzUGxhaW5UZXh0IC1Gb3JjZSkgLUZ1bGxOYW1lICJUZXN0IFVzZXIiIC1EZXNjcmlwdGlvbiAiQSB0ZXN0IHVzZXIgYWNjb3VudCIKCiMgQWRkIHRoZSBuZXcgdXNlciB0byB0aGUgVXNlcnMgZ3JvdXAKQWRkLUxvY2FsR3JvdXBNZW1iZXIgLUdyb3VwICJVc2VycyIgLU1lbWJlciAiVGVzdFVzZXIi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new user
New-LocalUser -Name &quot;TestUser&quot; -Password (ConvertTo-SecureString &quot;Test@123&quot; -AsPlainText -Force) -FullName &quot;Test User&quot; -Description &quot;A test user account&quot;

# Add the new user to the Users group
Add-LocalGroupMember -Group &quot;Users&quot; -Member &quot;TestUser&quot;</pre></div><div class='content'></div><h1><p>System Information</p>
</h1>
<div class='content'></div><h2><p>Retrieving System Information</p>
</h2>
<div class='content'><p>To retrieve system information, use the <code>Get-ComputerInfo</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUNvbXB1dGVySW5mbw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ComputerInfo</pre></div><div class='content'></div><h2><p>Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSZXRyaWV2ZSBhbmQgZGlzcGxheSBzeXN0ZW0gaW5mb3JtYXRpb24KR2V0LUNvbXB1dGVySW5mbw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Retrieve and display system information
Get-ComputerInfo</pre></div><div class='content'></div><h2><p>Practical Exercise</p>
</h2>
<div class='content'><p><strong>Task</strong>: Write a script to retrieve and display the operating system version and the total physical memory.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGluZm8gPSBHZXQtQ29tcHV0ZXJJbmZvCldyaXRlLU91dHB1dCAiT3BlcmF0aW5nIFN5c3RlbTogJCgkaW5mby5XaW5kb3dzVmVyc2lvbikiCldyaXRlLU91dHB1dCAiVG90YWwgUGh5c2ljYWwgTWVtb3J5OiAkKCRpbmZvLkNzVG90YWxQaHlzaWNhbE1lbW9yeSAvIDFHQikgR0Ii"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$info = Get-ComputerInfo
Write-Output &quot;Operating System: $($info.WindowsVersion)&quot;
Write-Output &quot;Total Physical Memory: $($info.CsTotalPhysicalMemory / 1GB) GB&quot;</pre></div><div class='content'></div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered essential system administration tasks using PowerShell, including managing services, processes, users, and retrieving system information. These skills are fundamental for automating and streamlining administrative tasks, making system management more efficient and effective.</p>
<p>Next, we will delve into automating tasks and scheduling them using PowerShell, which will further enhance your ability to manage systems proactively.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-creating-scheduled-tasks' title="Creating Scheduled Tasks">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-automating-active-directory' title="Automating Active Directory Tasks">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
