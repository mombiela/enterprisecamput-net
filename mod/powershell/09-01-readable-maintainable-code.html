<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Writing Readable and Maintainable Code</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/09-01-readable-maintainable-code" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/09-01-readable-maintainable-code" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/09-01-readable-maintainable-code" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/09-01-readable-maintainable-code" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/09-01-readable-maintainable-code" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='08-05-powershell-docker' title="PowerShell and Docker">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Writing Readable and Maintainable Code</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='09-02-performance-optimization' title="Performance Optimization">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Writing readable and maintainable code is crucial for any programming language, including PowerShell. This ensures that your scripts are easy to understand, debug, and extend by yourself or other developers. In this section, we will cover best practices and techniques to achieve this.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Consistent Naming Conventions</strong></li>
<li><strong>Commenting and Documentation</strong></li>
<li><strong>Modular Code</strong></li>
<li><strong>Error Handling</strong></li>
<li><strong>Code Formatting</strong></li>
<li><strong>Version Control</strong></li>
</ol>
</div><h2>1. Consistent Naming Conventions</h2>
<div class='content'><p>Using consistent naming conventions makes your code easier to read and understand. Here are some guidelines:</p>
<ul>
<li>
<p><strong>Variables</strong>: Use camelCase for variable names.</p>
<pre><code class="language-powershell">$userName = &quot;JohnDoe&quot;
$filePath = &quot;C:\Users\JohnDoe\Documents&quot;
</code></pre>
</li>
<li>
<p><strong>Functions</strong>: Use PascalCase for function names.</p>
<pre><code class="language-powershell">function Get-UserName {
    param ($userId)
    # Function logic here
}
</code></pre>
</li>
<li>
<p><strong>Constants</strong>: Use all uppercase letters with underscores for constants.</p>
<pre><code class="language-powershell">$MAX_RETRIES = 5
</code></pre>
</li>
</ul>
</div><h2>2. Commenting and Documentation</h2>
<div class='content'><p>Comments and documentation are essential for explaining the purpose and functionality of your code.</p>
<ul>
<li>
<p><strong>Single-line comments</strong>: Use <code>#</code> for single-line comments.</p>
<pre><code class="language-powershell"># This is a single-line comment
$userName = &quot;JohnDoe&quot;  # Assigning user name
</code></pre>
</li>
<li>
<p><strong>Multi-line comments</strong>: Use <code>&lt;# ... #&gt;</code> for multi-line comments.</p>
<pre><code class="language-powershell">&lt;#
This is a multi-line comment.
It can span multiple lines.
#&gt;
</code></pre>
</li>
<li>
<p><strong>Function documentation</strong>: Use comments to document the purpose, parameters, and return values of functions.</p>
<pre><code class="language-powershell">function Get-UserName {
    &lt;#
    .SYNOPSIS
    Retrieves the user name based on user ID.

    .PARAMETER userId
    The ID of the user.

    .OUTPUTS
    String

    .EXAMPLE
    Get-UserName -userId 123
    #&gt;
    param ($userId)
    # Function logic here
}
</code></pre>
</li>
</ul>
</div><h2>3. Modular Code</h2>
<div class='content'><p>Breaking down your code into smaller, reusable functions or modules makes it easier to manage and understand.</p>
<ul>
<li>
<p><strong>Functions</strong>: Encapsulate repetitive tasks into functions.</p>
<pre><code class="language-powershell">function Get-UserName {
    param ($userId)
    # Function logic here
}

function Get-UserEmail {
    param ($userId)
    # Function logic here
}
</code></pre>
</li>
<li>
<p><strong>Modules</strong>: Group related functions into modules.</p>
<pre><code class="language-powershell"># MyModule.psm1
function Get-UserName {
    param ($userId)
    # Function logic here
}

function Get-UserEmail {
    param ($userId)
    # Function logic here
}
</code></pre>
</li>
</ul>
</div><h2>4. Error Handling</h2>
<div class='content'><p>Proper error handling ensures that your scripts can handle unexpected situations gracefully.</p>
<ul>
<li>
<p><strong>Try-Catch-Finally</strong>: Use <code>try</code>, <code>catch</code>, and <code>finally</code> blocks to handle errors.</p>
<pre><code class="language-powershell">try {
    # Code that might throw an exception
}
catch {
    # Code to handle the exception
}
finally {
    # Code that runs regardless of whether an exception was thrown
}
</code></pre>
</li>
<li>
<p><strong>ErrorAction</strong>: Use the <code>-ErrorAction</code> parameter to control how errors are handled.</p>
<pre><code class="language-powershell">Get-Item &quot;C:\NonExistentFile.txt&quot; -ErrorAction Stop
</code></pre>
</li>
</ul>
</div><h2>5. Code Formatting</h2>
<div class='content'><p>Consistent code formatting improves readability.</p>
<ul>
<li>
<p><strong>Indentation</strong>: Use consistent indentation (e.g., 4 spaces).</p>
<pre><code class="language-powershell">function Get-UserName {
    param ($userId)
    if ($userId -eq $null) {
        throw &quot;User ID cannot be null&quot;
    }
    # Function logic here
}
</code></pre>
</li>
<li>
<p><strong>Line Length</strong>: Keep lines reasonably short (e.g., 80-100 characters).</p>
<pre><code class="language-powershell">$longString = &quot;This is a very long string that should be broken into multiple lines for better readability.&quot;
</code></pre>
</li>
</ul>
</div><h2>6. Version Control</h2>
<div class='content'><p>Using version control systems like Git helps you track changes and collaborate with others.</p>
<ul>
<li>
<p><strong>Commit Messages</strong>: Write clear and concise commit messages.</p>
<pre><code class="language-plaintext">Added function to retrieve user email based on user ID
</code></pre>
</li>
<li>
<p><strong>Branching</strong>: Use branches to work on new features or bug fixes.</p>
<pre><code class="language-bash">git checkout -b feature/add-user-email-function
</code></pre>
</li>
</ul>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise 1: Refactor the Script</h2>
<div class='content'><p>Refactor the following script to make it more readable and maintainable:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JHVzZXJJZCA9IDEyMwokdXNlck5hbWUgPSBHZXQtQURVc2VyIC1JZGVudGl0eSAkdXNlcklkIC1Qcm9wZXJ0aWVzIE5hbWUgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBOYW1lCiR1c2VyRW1haWwgPSBHZXQtQURVc2VyIC1JZGVudGl0eSAkdXNlcklkIC1Qcm9wZXJ0aWVzIEVtYWlsQWRkcmVzcyB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IEVtYWlsQWRkcmVzcwpXcml0ZS1PdXRwdXQgIlVzZXIgTmFtZTogJHVzZXJOYW1lIgpXcml0ZS1PdXRwdXQgIlVzZXIgRW1haWw6ICR1c2VyRW1haWwi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$userId = 123
$userName = Get-ADUser -Identity $userId -Properties Name | Select-Object -ExpandProperty Name
$userEmail = Get-ADUser -Identity $userId -Properties EmailAddress | Select-Object -ExpandProperty EmailAddress
Write-Output &quot;User Name: $userName&quot;
Write-Output &quot;User Email: $userEmail&quot;</pre></div><div class='content'></div><h2>Solution</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gR2V0LVVzZXJOYW1lIHsKICAgIHBhcmFtICgkdXNlcklkKQogICAgJHVzZXIgPSBHZXQtQURVc2VyIC1JZGVudGl0eSAkdXNlcklkIC1Qcm9wZXJ0aWVzIE5hbWUKICAgIHJldHVybiAkdXNlci5OYW1lCn0KCmZ1bmN0aW9uIEdldC1Vc2VyRW1haWwgewogICAgcGFyYW0gKCR1c2VySWQpCiAgICAkdXNlciA9IEdldC1BRFVzZXIgLUlkZW50aXR5ICR1c2VySWQgLVByb3BlcnRpZXMgRW1haWxBZGRyZXNzCiAgICByZXR1cm4gJHVzZXIuRW1haWxBZGRyZXNzCn0KCiR1c2VySWQgPSAxMjMKJHVzZXJOYW1lID0gR2V0LVVzZXJOYW1lIC11c2VySWQgJHVzZXJJZAokdXNlckVtYWlsID0gR2V0LVVzZXJFbWFpbCAtdXNlcklkICR1c2VySWQKCldyaXRlLU91dHB1dCAiVXNlciBOYW1lOiAkdXNlck5hbWUiCldyaXRlLU91dHB1dCAiVXNlciBFbWFpbDogJHVzZXJFbWFpbCI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function Get-UserName {
    param ($userId)
    $user = Get-ADUser -Identity $userId -Properties Name
    return $user.Name
}

function Get-UserEmail {
    param ($userId)
    $user = Get-ADUser -Identity $userId -Properties EmailAddress
    return $user.EmailAddress
}

$userId = 123
$userName = Get-UserName -userId $userId
$userEmail = Get-UserEmail -userId $userId

Write-Output &quot;User Name: $userName&quot;
Write-Output &quot;User Email: $userEmail&quot;</pre></div><div class='content'></div><h1>Summary</h1>
<div class='content'><p>In this section, we covered best practices for writing readable and maintainable PowerShell code. We discussed consistent naming conventions, commenting and documentation, modular code, error handling, code formatting, and version control. By following these guidelines, you can ensure that your PowerShell scripts are easy to understand, debug, and extend.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='08-05-powershell-docker' title="PowerShell and Docker">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='09-02-performance-optimization' title="Performance Optimization">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
