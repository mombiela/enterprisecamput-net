<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Error Handling</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/04-01-error-handling" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/04-01-error-handling" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/04-01-error-handling" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=2" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/powershell/04-01-error-handling" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/powershell/04-01-error-handling" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Programming Languages</a>
				 					<a href="/categ/frameworks">Frameworks and Libraries</a>
				 					<a href="/categ/tech-tools">Technical Tools</a>
				 					<a href="/categ/foundations">Theoretical Foundations</a>
				 					<a href="/categ/soft-skills">Social Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-05-sorting-grouping' title="Sorting and Grouping Objects">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Error Handling</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-02-debugging-scripts' title="Debugging Scripts">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Error handling is a crucial aspect of scripting and automation in PowerShell. It ensures that your scripts can gracefully handle unexpected situations and errors, providing meaningful feedback and maintaining control over the execution flow. In this section, we will cover the following topics:</p>
<ol>
<li><strong>Understanding Errors in PowerShell</strong></li>
<li><strong>Using Try, Catch, and Finally Blocks</strong></li>
<li><strong>Error Variables and Error Records</strong></li>
<li><strong>Common Error Handling Techniques</strong></li>
<li><strong>Practical Exercises</strong></li>
</ol>
</div><h1><p>Understanding Errors in PowerShell</p>
</h1>
<div class='content'><p>Errors in PowerShell can be broadly categorized into two types:</p>
<ul>
<li><strong>Terminating Errors</strong>: These errors stop the execution of the script or command. Examples include syntax errors and critical runtime errors.</li>
<li><strong>Non-Terminating Errors</strong>: These errors do not stop the execution of the script. Instead, they allow the script to continue running. Examples include errors in cmdlets that process multiple items.</li>
</ul>
</div><h2><p>Example of a Terminating Error</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBUaGlzIHdpbGwgY2F1c2UgYSB0ZXJtaW5hdGluZyBlcnJvciBiZWNhdXNlIHRoZSBmaWxlIGRvZXMgbm90IGV4aXN0CkdldC1Db250ZW50IC1QYXRoICJDOlxOb25FeGlzdGVudEZpbGUudHh0Ig=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># This will cause a terminating error because the file does not exist
Get-Content -Path &quot;C:\NonExistentFile.txt&quot;</pre></div><div class='content'></div><h2><p>Example of a Non-Terminating Error</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBUaGlzIHdpbGwgY2F1c2UgYSBub24tdGVybWluYXRpbmcgZXJyb3IgaWYgb25lIG9mIHRoZSBmaWxlcyBkb2VzIG5vdCBleGlzdApHZXQtQ29udGVudCAtUGF0aCAiQzpcRmlsZTEudHh0IiwgIkM6XE5vbkV4aXN0ZW50RmlsZS50eHQi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># This will cause a non-terminating error if one of the files does not exist
Get-Content -Path &quot;C:\File1.txt&quot;, &quot;C:\NonExistentFile.txt&quot;</pre></div><div class='content'></div><h1><p>Using Try, Catch, and Finally Blocks</p>
</h1>
<div class='content'><p>PowerShell provides structured error handling using <code>try</code>, <code>catch</code>, and <code>finally</code> blocks. This structure allows you to handle errors gracefully and execute cleanup code if necessary.</p>
</div><h2><p>Syntax</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJ5IHsKICAgICMgQ29kZSB0aGF0IG1heSBjYXVzZSBhbiBlcnJvcgp9CmNhdGNoIHsKICAgICMgQ29kZSB0byBoYW5kbGUgdGhlIGVycm9yCn0KZmluYWxseSB7CiAgICAjIENvZGUgdGhhdCBydW5zIHJlZ2FyZGxlc3Mgb2Ygd2hldGhlciBhbiBlcnJvciBvY2N1cnJlZAp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>try {
    # Code that may cause an error
}
catch {
    # Code to handle the error
}
finally {
    # Code that runs regardless of whether an error occurred
}</pre></div><div class='content'></div><h2><p>Example</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJ5IHsKICAgICMgQXR0ZW1wdCB0byByZWFkIGEgZmlsZQogICAgJGNvbnRlbnQgPSBHZXQtQ29udGVudCAtUGF0aCAiQzpcTm9uRXhpc3RlbnRGaWxlLnR4dCIKICAgIFdyaXRlLU91dHB1dCAiRmlsZSBjb250ZW50OiAkY29udGVudCIKfQpjYXRjaCB7CiAgICAjIEhhbmRsZSB0aGUgZXJyb3IKICAgIFdyaXRlLU91dHB1dCAiQW4gZXJyb3Igb2NjdXJyZWQ6ICRfIgp9CmZpbmFsbHkgewogICAgIyBDbGVhbnVwIGNvZGUKICAgIFdyaXRlLU91dHB1dCAiRXhlY3V0aW9uIGNvbXBsZXRlZC4iCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>try {
    # Attempt to read a file
    $content = Get-Content -Path &quot;C:\NonExistentFile.txt&quot;
    Write-Output &quot;File content: $content&quot;
}
catch {
    # Handle the error
    Write-Output &quot;An error occurred: $_&quot;
}
finally {
    # Cleanup code
    Write-Output &quot;Execution completed.&quot;
}</pre></div><div class='content'></div><h1><p>Error Variables and Error Records</p>
</h1>
<div class='content'><p>PowerShell provides several built-in variables and objects to help you work with errors:</p>
<ul>
<li><strong><code>$Error</code></strong>: An array that contains the most recent errors.</li>
<li><strong><code>$_</code></strong>: Represents the current error in the <code>catch</code> block.</li>
<li><strong><code>$?</code></strong>: Indicates whether the last operation succeeded (<code>True</code>) or failed (<code>False</code>).</li>
</ul>
</div><h2><p>Example</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJ5IHsKICAgICMgQXR0ZW1wdCB0byByZWFkIGEgZmlsZQogICAgJGNvbnRlbnQgPSBHZXQtQ29udGVudCAtUGF0aCAiQzpcTm9uRXhpc3RlbnRGaWxlLnR4dCIKfQpjYXRjaCB7CiAgICAjIEFjY2VzcyB0aGUgZXJyb3IgbWVzc2FnZQogICAgV3JpdGUtT3V0cHV0ICJFcnJvciBtZXNzYWdlOiAkKCRfLkV4Y2VwdGlvbi5NZXNzYWdlKSIKICAgICMgQ2hlY2sgaWYgdGhlIGxhc3Qgb3BlcmF0aW9uIHN1Y2NlZWRlZAogICAgV3JpdGUtT3V0cHV0ICJEaWQgdGhlIGxhc3Qgb3BlcmF0aW9uIHN1Y2NlZWQ/ICQ/Igp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>try {
    # Attempt to read a file
    $content = Get-Content -Path &quot;C:\NonExistentFile.txt&quot;
}
catch {
    # Access the error message
    Write-Output &quot;Error message: $($_.Exception.Message)&quot;
    # Check if the last operation succeeded
    Write-Output &quot;Did the last operation succeed? $?&quot;
}</pre></div><div class='content'></div><h1><p>Common Error Handling Techniques</p>
</h1>
<div class='content'></div><h2><p>Using <code>-ErrorAction</code> Parameter</p>
</h2>
<div class='content'><p>The <code>-ErrorAction</code> parameter allows you to specify how PowerShell should respond to non-terminating errors.</p>
<ul>
<li><strong><code>Continue</code></strong>: Default behavior. Continue execution and display the error.</li>
<li><strong><code>Stop</code></strong>: Treat the error as a terminating error.</li>
<li><strong><code>SilentlyContinue</code></strong>: Continue execution without displaying the error.</li>
<li><strong><code>Inquire</code></strong>: Prompt the user for input on how to proceed.</li>
</ul>
</div><h2><p>Example</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBUcmVhdCBub24tdGVybWluYXRpbmcgZXJyb3JzIGFzIHRlcm1pbmF0aW5nIGVycm9ycwpHZXQtQ29udGVudCAtUGF0aCAiQzpcTm9uRXhpc3RlbnRGaWxlLnR4dCIgLUVycm9yQWN0aW9uIFN0b3A="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Treat non-terminating errors as terminating errors
Get-Content -Path &quot;C:\NonExistentFile.txt&quot; -ErrorAction Stop</pre></div><div class='content'></div><h2><p>Using <code>-ErrorVariable</code> Parameter</p>
</h2>
<div class='content'><p>The <code>-ErrorVariable</code> parameter allows you to store errors in a specified variable.</p>
</div><h2><p>Example</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTdG9yZSB0aGUgZXJyb3IgaW4gYSBjdXN0b20gdmFyaWFibGUKR2V0LUNvbnRlbnQgLVBhdGggIkM6XE5vbkV4aXN0ZW50RmlsZS50eHQiIC1FcnJvclZhcmlhYmxlIG15RXJyb3IKV3JpdGUtT3V0cHV0ICJDdXN0b20gZXJyb3IgdmFyaWFibGU6ICRteUVycm9yIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Store the error in a custom variable
Get-Content -Path &quot;C:\NonExistentFile.txt&quot; -ErrorVariable myError
Write-Output &quot;Custom error variable: $myError&quot;</pre></div><div class='content'></div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Basic Error Handling</p>
</h2>
<div class='content'><p>Write a script that attempts to read a file and handles any errors that occur. Use <code>try</code>, <code>catch</code>, and <code>finally</code> blocks.</p>
<h4>Solution</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJ5IHsKICAgICRjb250ZW50ID0gR2V0LUNvbnRlbnQgLVBhdGggIkM6XE5vbkV4aXN0ZW50RmlsZS50eHQiCiAgICBXcml0ZS1PdXRwdXQgIkZpbGUgY29udGVudDogJGNvbnRlbnQiCn0KY2F0Y2ggewogICAgV3JpdGUtT3V0cHV0ICJBbiBlcnJvciBvY2N1cnJlZDogJCgkXy5FeGNlcHRpb24uTWVzc2FnZSkiCn0KZmluYWxseSB7CiAgICBXcml0ZS1PdXRwdXQgIkV4ZWN1dGlvbiBjb21wbGV0ZWQuIgp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>try {
    $content = Get-Content -Path &quot;C:\NonExistentFile.txt&quot;
    Write-Output &quot;File content: $content&quot;
}
catch {
    Write-Output &quot;An error occurred: $($_.Exception.Message)&quot;
}
finally {
    Write-Output &quot;Execution completed.&quot;
}</pre></div><div class='content'></div><h2><p>Exercise 2: Using <code>-ErrorAction</code> and <code>-ErrorVariable</code></p>
</h2>
<div class='content'><p>Write a script that attempts to read a file, treats non-terminating errors as terminating errors, and stores the error in a custom variable.</p>
<h4>Solution</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUNvbnRlbnQgLVBhdGggIkM6XE5vbkV4aXN0ZW50RmlsZS50eHQiIC1FcnJvckFjdGlvbiBTdG9wIC1FcnJvclZhcmlhYmxlIG15RXJyb3IKaWYgKCRteUVycm9yKSB7CiAgICBXcml0ZS1PdXRwdXQgIkFuIGVycm9yIG9jY3VycmVkOiAkKCRteUVycm9yLkV4Y2VwdGlvbi5NZXNzYWdlKSIKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-Content -Path &quot;C:\NonExistentFile.txt&quot; -ErrorAction Stop -ErrorVariable myError
if ($myError) {
    Write-Output &quot;An error occurred: $($myError.Exception.Message)&quot;
}</pre></div><div class='content'></div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered the basics of error handling in PowerShell, including the use of <code>try</code>, <code>catch</code>, and <code>finally</code> blocks, error variables, and common error handling techniques. Proper error handling is essential for creating robust and reliable scripts. In the next section, we will delve into debugging scripts to further enhance your scripting skills.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-05-sorting-grouping' title="Sorting and Grouping Objects">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-02-debugging-scripts' title="Debugging Scripts">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
