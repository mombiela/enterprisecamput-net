<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Error Handling in PowerShell</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/error-handling" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/error-handling" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/error-handling" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/error-handling" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/error-handling" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='switch-statements'>&#x25C4;Switch Statements</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Error Handling in PowerShell</a>
	</div>
	<div class='col-4 text-end'>
					<a href='creating-and-using-functions'>Creating and Using Functions &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Error handling is a crucial aspect of scripting and automation in PowerShell. It ensures that your scripts can handle unexpected situations gracefully and continue to operate or fail in a controlled manner. This topic will cover the basics of error handling, advanced techniques, and best practices.</p>
</div><h1>Introduction to Error Handling</h1>
<div class='content'><p>Error handling in PowerShell allows you to manage and respond to errors that occur during script execution. Understanding how to handle errors effectively can make your scripts more robust and reliable.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Error Types</strong>: PowerShell errors can be terminating or non-terminating.
<ul>
<li><strong>Terminating Errors</strong>: These errors stop the execution of the script or command.</li>
<li><strong>Non-Terminating Errors</strong>: These errors allow the script or command to continue running.</li>
</ul>
</li>
<li><strong>Error Variables</strong>: <code>$Error</code> and <code>$_</code> are special variables used in error handling.
<ul>
<li><code>$Error</code>: An array that contains error objects from the current session.</li>
<li><code>$_</code>: Represents the current error object in error handling constructs.</li>
</ul>
</li>
</ul>
</div><h1>Basic Error Handling</h1>
<div class='content'></div><h2>Try, Catch, and Finally</h2>
<div class='content'><p>PowerShell uses <code>try</code>, <code>catch</code>, and <code>finally</code> blocks to handle errors.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJ5IHsKICAgICMgQ29kZSB0aGF0IG1heSBwcm9kdWNlIGFuIGVycm9yCiAgICBHZXQtSXRlbSAiQzpcTm9uRXhpc3RlbnRGaWxlLnR4dCIKfSBjYXRjaCB7CiAgICAjIENvZGUgdG8gaGFuZGxlIHRoZSBlcnJvcgogICAgV3JpdGUtSG9zdCAiQW4gZXJyb3Igb2NjdXJyZWQ6ICRfIgp9IGZpbmFsbHkgewogICAgIyBDb2RlIHRoYXQgcnVucyByZWdhcmRsZXNzIG9mIHdoZXRoZXIgYW4gZXJyb3Igb2NjdXJyZWQKICAgIFdyaXRlLUhvc3QgIlRoaXMgcnVucyBubyBtYXR0ZXIgd2hhdC4iCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>try {
    # Code that may produce an error
    Get-Item &quot;C:\NonExistentFile.txt&quot;
} catch {
    # Code to handle the error
    Write-Host &quot;An error occurred: $_&quot;
} finally {
    # Code that runs regardless of whether an error occurred
    Write-Host &quot;This runs no matter what.&quot;
}</pre></div><div class='content'><ul>
<li><strong>Try Block</strong>: Contains code that might throw an error.</li>
<li><strong>Catch Block</strong>: Contains code to handle the error.</li>
<li><strong>Finally Block</strong>: Contains code that runs regardless of whether an error occurred.</li>
</ul>
</div><h2>Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJ5IHsKICAgICRjb250ZW50ID0gR2V0LUNvbnRlbnQgLVBhdGggIkM6XE5vbkV4aXN0ZW50RmlsZS50eHQiCiAgICBXcml0ZS1Ib3N0ICJGaWxlIGNvbnRlbnQ6ICRjb250ZW50Igp9IGNhdGNoIHsKICAgIFdyaXRlLUhvc3QgIkFuIGVycm9yIG9jY3VycmVkOiAkXyIKfSBmaW5hbGx5IHsKICAgIFdyaXRlLUhvc3QgIkF0dGVtcHRlZCB0byByZWFkIGZpbGUuIgp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>try {
    $content = Get-Content -Path &quot;C:\NonExistentFile.txt&quot;
    Write-Host &quot;File content: $content&quot;
} catch {
    Write-Host &quot;An error occurred: $_&quot;
} finally {
    Write-Host &quot;Attempted to read file.&quot;
}</pre></div><div class='content'><p>In this example, if the file does not exist, the script will catch the error and display a message, then execute the <code>finally</code> block.</p>
</div><h1>Advanced Error Handling</h1>
<div class='content'></div><h2>ErrorAction Parameter</h2>
<div class='content'><p>The <code>-ErrorAction</code> parameter allows you to specify how PowerShell should respond to non-terminating errors.</p>
<ul>
<li><strong>Continue</strong>: Default behavior. Continue running commands after an error.</li>
<li><strong>Stop</strong>: Treat non-terminating errors as terminating errors.</li>
<li><strong>SilentlyContinue</strong>: Suppress error messages and continue.</li>
<li><strong>Inquire</strong>: Prompt the user for input on how to proceed.</li>
<li><strong>Ignore</strong>: Ignore the error and continue without logging it.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUl0ZW0gIkM6XE5vbkV4aXN0ZW50RmlsZS50eHQiIC1FcnJvckFjdGlvbiBTdG9w"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-Item &quot;C:\NonExistentFile.txt&quot; -ErrorAction Stop</pre></div><div class='content'></div><h2>ErrorVariable Parameter</h2>
<div class='content'><p>The <code>-ErrorVariable</code> parameter allows you to store error information in a custom variable.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUl0ZW0gIkM6XE5vbkV4aXN0ZW50RmlsZS50eHQiIC1FcnJvclZhcmlhYmxlIG15RXJyb3IKaWYgKCRteUVycm9yKSB7CiAgICBXcml0ZS1Ib3N0ICJBbiBlcnJvciBvY2N1cnJlZDogJG15RXJyb3IiCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-Item &quot;C:\NonExistentFile.txt&quot; -ErrorVariable myError
if ($myError) {
    Write-Host &quot;An error occurred: $myError&quot;
}</pre></div><div class='content'></div><h2>Throwing Errors</h2>
<div class='content'><p>You can use the <code>throw</code> keyword to generate a terminating error manually.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gVGVzdC1FcnJvciB7CiAgICBwYXJhbSAoJHZhbHVlKQogICAgaWYgKCR2YWx1ZSAtZXEgJG51bGwpIHsKICAgICAgICB0aHJvdyAiVmFsdWUgY2Fubm90IGJlIG51bGwuIgogICAgfQogICAgV3JpdGUtSG9zdCAiVmFsdWUgaXMgJHZhbHVlIgp9Cgp0cnkgewogICAgVGVzdC1FcnJvciAkbnVsbAp9IGNhdGNoIHsKICAgIFdyaXRlLUhvc3QgIkNhdWdodCBhbiBlcnJvcjogJF8iCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function Test-Error {
    param ($value)
    if ($value -eq $null) {
        throw &quot;Value cannot be null.&quot;
    }
    Write-Host &quot;Value is $value&quot;
}

try {
    Test-Error $null
} catch {
    Write-Host &quot;Caught an error: $_&quot;
}</pre></div><div class='content'></div><h1>Best Practices</h1>
<div class='content'><ul>
<li><strong>Use Try-Catch-Finally</strong>: Always use <code>try</code>, <code>catch</code>, and <code>finally</code> blocks for critical operations.</li>
<li><strong>Specify Error Actions</strong>: Use <code>-ErrorAction</code> to control error handling behavior.</li>
<li><strong>Log Errors</strong>: Log errors to a file or monitoring system for later analysis.</li>
<li><strong>Graceful Degradation</strong>: Ensure your script can continue operating in a degraded mode if an error occurs.</li>
<li><strong>Clear Error Variables</strong>: Clear custom error variables to avoid confusion with previous errors.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Effective error handling is essential for creating robust and reliable PowerShell scripts. By understanding and using <code>try</code>, <code>catch</code>, and <code>finally</code> blocks, along with <code>-ErrorAction</code> and <code>-ErrorVariable</code> parameters, you can manage errors gracefully and ensure your scripts handle unexpected situations appropriately. Remember to follow best practices to maintain clean and maintainable code.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='switch-statements'>&#x25C4;Switch Statements</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Error Handling in PowerShell</a>
	</div>
	<div class='col-4 text-end'>
					<a href='creating-and-using-functions'>Creating and Using Functions &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
