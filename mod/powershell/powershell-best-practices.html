<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerShell Best Practices</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/powershell-best-practices" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/powershell-best-practices" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/powershell-best-practices" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/powershell-best-practices" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/powershell-best-practices" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='infrastructure-as-code-with-powershell'>&#x25C4;Infrastructure as Code with PowerShell</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">PowerShell Best Practices</a>
	</div>
	<div class='col-4 text-end'>
					<a href='writing-efficient-powershell-code'>Writing Efficient PowerShell Code &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>PowerShell is a powerful scripting language and command-line shell designed for task automation and configuration management. To make the most of PowerShell, it's essential to follow best practices that ensure your scripts are efficient, maintainable, and secure. This section will cover best practices for writing PowerShell scripts, from beginner to advanced levels.</p>
</div><h1>General Best Practices</h1>
<div class='content'><ul>
<li><strong>Use Descriptive Names</strong>: Always use descriptive names for variables, functions, and scripts to make your code more readable.</li>
<li><strong>Comment Your Code</strong>: Use comments to explain the purpose of your code, especially complex logic.</li>
<li><strong>Consistent Formatting</strong>: Follow a consistent style for indentation, spacing, and braces to improve readability.</li>
<li><strong>Error Handling</strong>: Implement proper error handling to make your scripts robust and user-friendly.</li>
</ul>
</div><h2>Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBUaGlzIGZ1bmN0aW9uIGNhbGN1bGF0ZXMgdGhlIGZhY3RvcmlhbCBvZiBhIG51bWJlcgpmdW5jdGlvbiBHZXQtRmFjdG9yaWFsIHsKICAgIHBhcmFtICgKICAgICAgICBbaW50XSROdW1iZXIKICAgICkKICAgIAogICAgaWYgKCROdW1iZXIgLWx0IDApIHsKICAgICAgICB0aHJvdyAiTnVtYmVyIG11c3QgYmUgbm9uLW5lZ2F0aXZlIgogICAgfQoKICAgICRyZXN1bHQgPSAxCiAgICBmb3IgKCRpID0gMTsgJGkgLWxlICROdW1iZXI7ICRpKyspIHsKICAgICAgICAkcmVzdWx0ICo9ICRpCiAgICB9CgogICAgcmV0dXJuICRyZXN1bHQKfQoKdHJ5IHsKICAgICRmYWN0b3JpYWwgPSBHZXQtRmFjdG9yaWFsIC1OdW1iZXIgNQogICAgV3JpdGUtT3V0cHV0ICJGYWN0b3JpYWw6ICRmYWN0b3JpYWwiCn0gY2F0Y2ggewogICAgV3JpdGUtRXJyb3IgIkFuIGVycm9yIG9jY3VycmVkOiAkXyIKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># This function calculates the factorial of a number
function Get-Factorial {
    param (
        [int]$Number
    )
    
    if ($Number -lt 0) {
        throw &quot;Number must be non-negative&quot;
    }

    $result = 1
    for ($i = 1; $i -le $Number; $i++) {
        $result *= $i
    }

    return $result
}

try {
    $factorial = Get-Factorial -Number 5
    Write-Output &quot;Factorial: $factorial&quot;
} catch {
    Write-Error &quot;An error occurred: $_&quot;
}</pre></div><div class='content'></div><h1>Script Structure</h1>
<div class='content'><ul>
<li><strong>Modular Design</strong>: Break your scripts into smaller, reusable functions.</li>
<li><strong>Parameter Validation</strong>: Use parameter validation to ensure your functions receive valid input.</li>
<li><strong>Output Handling</strong>: Use <code>Write-Output</code>, <code>Write-Error</code>, <code>Write-Verbose</code>, and <code>Write-Debug</code> appropriately to handle different types of output.</li>
</ul>
</div><h2>Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gR2V0LVNxdWFyZSB7CiAgICBwYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQogICAgICAgIFtpbnRdJE51bWJlcgogICAgKQoKICAgIHJldHVybiAkTnVtYmVyICogJE51bWJlcgp9CgojIE1haW4gc2NyaXB0CnRyeSB7CiAgICAkc3F1YXJlID0gR2V0LVNxdWFyZSAtTnVtYmVyIDQKICAgIFdyaXRlLU91dHB1dCAiU3F1YXJlOiAkc3F1YXJlIgp9IGNhdGNoIHsKICAgIFdyaXRlLUVycm9yICJBbiBlcnJvciBvY2N1cnJlZDogJF8iCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function Get-Square {
    param (
        [Parameter(Mandatory=$true)]
        [int]$Number
    )

    return $Number * $Number
}

# Main script
try {
    $square = Get-Square -Number 4
    Write-Output &quot;Square: $square&quot;
} catch {
    Write-Error &quot;An error occurred: $_&quot;
}</pre></div><div class='content'></div><h1>Security Best Practices</h1>
<div class='content'><ul>
<li><strong>Avoid Hardcoding Credentials</strong>: Use secure methods to handle credentials, such as <code>Get-Credential</code>.</li>
<li><strong>Least Privilege Principle</strong>: Run your scripts with the least privileges necessary.</li>
<li><strong>Code Signing</strong>: Sign your scripts to ensure their integrity and authenticity.</li>
</ul>
</div><h2>Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQcm9tcHQgZm9yIGNyZWRlbnRpYWxzIHNlY3VyZWx5CiRjcmVkZW50aWFscyA9IEdldC1DcmVkZW50aWFsCgojIFVzZSB0aGUgY3JlZGVudGlhbHMgaW4gYSBzZWN1cmUgbWFubmVyCkludm9rZS1Db21tYW5kIC1Db21wdXRlck5hbWUgIlNlcnZlcjAxIiAtQ3JlZGVudGlhbCAkY3JlZGVudGlhbHMgLVNjcmlwdEJsb2NrIHsKICAgICMgWW91ciBjb2RlIGhlcmUKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Prompt for credentials securely
$credentials = Get-Credential

# Use the credentials in a secure manner
Invoke-Command -ComputerName &quot;Server01&quot; -Credential $credentials -ScriptBlock {
    # Your code here
}</pre></div><div class='content'></div><h1>Performance Optimization</h1>
<div class='content'><ul>
<li><strong>Use Cmdlets Over External Commands</strong>: Cmdlets are optimized for performance and should be preferred over external commands.</li>
<li><strong>Avoid Unnecessary Loops</strong>: Use pipeline operations and built-in cmdlets to handle collections efficiently.</li>
<li><strong>Measure Performance</strong>: Use <code>Measure-Command</code> to measure the performance of your scripts.</li>
</ul>
</div><h2>Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBNZWFzdXJlIHRoZSB0aW1lIHRha2VuIHRvIGV4ZWN1dGUgYSBjb21tYW5kCiR0aW1lID0gTWVhc3VyZS1Db21tYW5kIHsKICAgIEdldC1Qcm9jZXNzCn0KV3JpdGUtT3V0cHV0ICJUaW1lIHRha2VuOiAkKCR0aW1lLlRvdGFsU2Vjb25kcykgc2Vjb25kcyI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Measure the time taken to execute a command
$time = Measure-Command {
    Get-Process
}
Write-Output &quot;Time taken: $($time.TotalSeconds) seconds&quot;</pre></div><div class='content'></div><h1>Advanced Techniques</h1>
<div class='content'><ul>
<li><strong>Splatting</strong>: Use splatting to pass parameters to functions and cmdlets in a clean and readable way.</li>
<li><strong>Custom Modules</strong>: Create custom modules to organize and distribute your functions.</li>
<li><strong>Advanced Functions</strong>: Use advanced functions to leverage features like cmdlet binding and common parameters.</li>
</ul>
</div><h2>Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTcGxhdHRpbmcgZXhhbXBsZQokcGFyYW1zID0gQHsKICAgIE5hbWUgPSAiTm90ZXBhZCIKICAgIENvbXB1dGVyTmFtZSA9ICJsb2NhbGhvc3QiCn0KR2V0LVByb2Nlc3MgQHBhcmFtcwoKIyBBZHZhbmNlZCBmdW5jdGlvbiBleGFtcGxlCmZ1bmN0aW9uIEdldC1BZHZhbmNlZEZhY3RvcmlhbCB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KICAgICAgICBbaW50XSROdW1iZXIKICAgICkKCiAgICBpZiAoJE51bWJlciAtbHQgMCkgewogICAgICAgIHRocm93ICJOdW1iZXIgbXVzdCBiZSBub24tbmVnYXRpdmUiCiAgICB9CgogICAgJHJlc3VsdCA9IDEKICAgIGZvciAoJGkgPSAxOyAkaSAtbGUgJE51bWJlcjsgJGkrKykgewogICAgICAgICRyZXN1bHQgKj0gJGkKICAgIH0KCiAgICByZXR1cm4gJHJlc3VsdAp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Splatting example
$params = @{
    Name = &quot;Notepad&quot;
    ComputerName = &quot;localhost&quot;
}
Get-Process @params

# Advanced function example
function Get-AdvancedFactorial {
    [CmdletBinding()]
    param (
        [Parameter(Mandatory=$true)]
        [int]$Number
    )

    if ($Number -lt 0) {
        throw &quot;Number must be non-negative&quot;
    }

    $result = 1
    for ($i = 1; $i -le $Number; $i++) {
        $result *= $i
    }

    return $result
}</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Following best practices in PowerShell scripting ensures that your code is efficient, maintainable, and secure. By using descriptive names, commenting your code, handling errors properly, and adhering to security and performance guidelines, you can create robust scripts that are easy to understand and maintain. As you advance, incorporating techniques like splatting, custom modules, and advanced functions will further enhance your scripting capabilities.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='infrastructure-as-code-with-powershell'>&#x25C4;Infrastructure as Code with PowerShell</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">PowerShell Best Practices</a>
	</div>
	<div class='col-4 text-end'>
					<a href='writing-efficient-powershell-code'>Writing Efficient PowerShell Code &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
