<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debugging Scripts</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/04-02-debugging-scripts" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/04-02-debugging-scripts" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/04-02-debugging-scripts" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/04-02-debugging-scripts" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/04-02-debugging-scripts" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-01-error-handling' title="Error Handling">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Debugging Scripts</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='04-03-regular-expressions' title="Regular Expressions">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Debugging is an essential skill for any programmer, and PowerShell is no exception. In this section, we will cover various techniques and tools available in PowerShell to help you debug your scripts effectively.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Understanding Debugging</strong>: The process of identifying and fixing errors or bugs in your code.</li>
<li><strong>Common Debugging Tools</strong>: PowerShell ISE, Visual Studio Code, and built-in cmdlets.</li>
<li><strong>Breakpoints</strong>: Points in your script where execution will pause, allowing you to inspect the state of your script.</li>
<li><strong>Cmdlets for Debugging</strong>: <code>Write-Debug</code>, <code>Set-PSBreakpoint</code>, <code>Get-PSBreakpoint</code>, <code>Remove-PSBreakpoint</code>, <code>Enable-PSBreakpoint</code>, <code>Disable-PSBreakpoint</code>.</li>
</ol>
</div><h1><p>Using Write-Debug</p>
</h1>
<div class='content'><p>The <code>Write-Debug</code> cmdlet is used to display debug messages. These messages are only shown if the debug preference is set to <code>Continue</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JERlYnVnUHJlZmVyZW5jZSA9ICJDb250aW51ZSIKV3JpdGUtRGVidWcgIlRoaXMgaXMgYSBkZWJ1ZyBtZXNzYWdlLiI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$DebugPreference = &quot;Continue&quot;
Write-Debug &quot;This is a debug message.&quot;</pre></div><div class='content'></div><h2><p>Explanation:</p>
</h2>
<div class='content'><ul>
<li><code>$DebugPreference = &quot;Continue&quot;</code>: Sets the debug preference to show debug messages.</li>
<li><code>Write-Debug &quot;This is a debug message.&quot;</code>: Outputs a debug message.</li>
</ul>
</div><h1><p>Setting Breakpoints</p>
</h1>
<div class='content'><p>Breakpoints allow you to pause the execution of your script at a specific line or function, enabling you to inspect variables and the state of your script.</p>
</div><h2><p>Setting a Line Breakpoint</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U2V0LVBTQnJlYWtwb2ludCAtU2NyaXB0ICJDOlxTY3JpcHRzXE15U2NyaXB0LnBzMSIgLUxpbmUgMTA="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Set-PSBreakpoint -Script &quot;C:\Scripts\MyScript.ps1&quot; -Line 10</pre></div><div class='content'></div><h2><p>Explanation:</p>
</h2>
<div class='content'><ul>
<li><code>Set-PSBreakpoint</code>: Cmdlet to set a breakpoint.</li>
<li><code>-Script &quot;C:\Scripts\MyScript.ps1&quot;</code>: Specifies the script file.</li>
<li><code>-Line 10</code>: Sets a breakpoint at line 10.</li>
</ul>
</div><h2><p>Setting a Function Breakpoint</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U2V0LVBTQnJlYWtwb2ludCAtU2NyaXB0ICJDOlxTY3JpcHRzXE15U2NyaXB0LnBzMSIgLUNvbW1hbmQgIk15RnVuY3Rpb24i"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Set-PSBreakpoint -Script &quot;C:\Scripts\MyScript.ps1&quot; -Command &quot;MyFunction&quot;</pre></div><div class='content'></div><h2><p>Explanation:</p>
</h2>
<div class='content'><ul>
<li><code>-Command &quot;MyFunction&quot;</code>: Sets a breakpoint at the start of the function <code>MyFunction</code>.</li>
</ul>
</div><h1><p>Managing Breakpoints</p>
</h1>
<div class='content'></div><h2><p>Listing Breakpoints</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LVBTQnJlYWtwb2ludA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-PSBreakpoint</pre></div><div class='content'></div><h2><p>Removing Breakpoints</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UmVtb3ZlLVBTQnJlYWtwb2ludCAtSWQgMQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Remove-PSBreakpoint -Id 1</pre></div><div class='content'></div><h2><p>Enabling and Disabling Breakpoints</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RW5hYmxlLVBTQnJlYWtwb2ludCAtSWQgMQpEaXNhYmxlLVBTQnJlYWtwb2ludCAtSWQgMQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Enable-PSBreakpoint -Id 1
Disable-PSBreakpoint -Id 1</pre></div><div class='content'></div><h2><p>Explanation:</p>
</h2>
<div class='content'><ul>
<li><code>Get-PSBreakpoint</code>: Lists all breakpoints.</li>
<li><code>Remove-PSBreakpoint -Id 1</code>: Removes the breakpoint with ID 1.</li>
<li><code>Enable-PSBreakpoint -Id 1</code>: Enables the breakpoint with ID 1.</li>
<li><code>Disable-PSBreakpoint -Id 1</code>: Disables the breakpoint with ID 1.</li>
</ul>
</div><h1><p>Using the PowerShell ISE for Debugging</p>
</h1>
<div class='content'><p>The PowerShell Integrated Scripting Environment (ISE) provides a graphical interface for debugging.</p>
</div><h2><p>Setting Breakpoints in ISE</p>
</h2>
<div class='content'><ol>
<li>Open your script in PowerShell ISE.</li>
<li>Click on the line number where you want to set a breakpoint.</li>
<li>Press <code>F9</code> or right-click and select &quot;Toggle Breakpoint&quot;.</li>
</ol>
</div><h2><p>Running the Script in Debug Mode</p>
</h2>
<div class='content'><ol>
<li>Press <code>F5</code> to run the script.</li>
<li>The script will pause at the breakpoint, allowing you to inspect variables and step through the code.</li>
</ol>
</div><h2><p>Stepping Through Code</p>
</h2>
<div class='content'><ul>
<li><strong>Step Over (F10)</strong>: Executes the next line of code but does not step into functions.</li>
<li><strong>Step Into (F11)</strong>: Steps into functions, allowing you to debug inside them.</li>
<li><strong>Step Out (Shift+F11)</strong>: Steps out of the current function.</li>
</ul>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Debugging a Simple Script</p>
</h2>
<div class='content'><ol>
<li>Create a script <code>DebugExample.ps1</code> with the following content:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gR2V0LVNxdWFyZSB7CiAgICBwYXJhbSAoCiAgICAgICAgW2ludF0kTnVtYmVyCiAgICApCiAgICByZXR1cm4gJE51bWJlciAqICROdW1iZXIKfQoKJG51bWJlciA9IDUKJHJlc3VsdCA9IEdldC1TcXVhcmUgLU51bWJlciAkbnVtYmVyCldyaXRlLU91dHB1dCAiVGhlIHNxdWFyZSBvZiAkbnVtYmVyIGlzICRyZXN1bHQi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function Get-Square {
    param (
        [int]$Number
    )
    return $Number * $Number
}

$number = 5
$result = Get-Square -Number $number
Write-Output &quot;The square of $number is $result&quot;</pre></div><div class='content'><ol start="2">
<li>Set a breakpoint at the line <code>$result = Get-Square -Number $number</code>.</li>
<li>Run the script in PowerShell ISE and inspect the value of <code>$number</code> and <code>$result</code>.</li>
<li>Step into the <code>Get-Square</code> function and inspect the value of <code>$Number</code>.</li>
</ol>
</div><h2><p>Solution:</p>
</h2>
<div class='content'><ol>
<li>Open <code>DebugExample.ps1</code> in PowerShell ISE.</li>
<li>Set a breakpoint at the line <code>$result = Get-Square -Number $number</code>.</li>
<li>Press <code>F5</code> to run the script.</li>
<li>When the script pauses, inspect the variables in the &quot;Variables&quot; pane.</li>
<li>Press <code>F11</code> to step into the <code>Get-Square</code> function.</li>
<li>Inspect the value of <code>$Number</code> inside the function.</li>
</ol>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Forgetting to Enable Debug Messages</strong>: Ensure <code>$DebugPreference</code> is set to <code>Continue</code> to see debug messages.</li>
<li><strong>Not Removing Breakpoints</strong>: Remove breakpoints after debugging to avoid unintended pauses in script execution.</li>
<li><strong>Overusing Breakpoints</strong>: Use breakpoints judiciously to avoid cluttering your debugging session.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered the basics of debugging in PowerShell, including using <code>Write-Debug</code>, setting and managing breakpoints, and using the PowerShell ISE for debugging. These tools and techniques will help you identify and fix issues in your scripts more efficiently. In the next section, we will explore regular expressions in PowerShell, which are powerful tools for pattern matching and text manipulation.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-01-error-handling' title="Error Handling">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='04-03-regular-expressions' title="Regular Expressions">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
