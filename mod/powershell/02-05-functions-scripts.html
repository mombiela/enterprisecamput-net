<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Functions and Scripts</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/02-05-functions-scripts" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/02-05-functions-scripts" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/02-05-functions-scripts" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/02-05-functions-scripts" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/02-05-functions-scripts" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-loops' title="Loops in PowerShell">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Functions and Scripts</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-01-understanding-objects' title="Understanding Objects">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into the creation and usage of functions and scripts in PowerShell. Functions and scripts are essential for writing reusable and modular code, which is a cornerstone of efficient scripting and automation.</p>
</div><h1>What is a Function?</h1>
<div class='content'><p>A function in PowerShell is a block of code that performs a specific task. Functions help in organizing code into manageable sections, making it reusable and easier to debug.</p>
</div><h2>Defining a Function</h2>
<div class='content'><p>To define a function in PowerShell, use the <code>function</code> keyword followed by the function name and a script block <code>{}</code> containing the code.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gR2V0LUdyZWV0aW5nIHsKICAgIHBhcmFtICgKICAgICAgICBbc3RyaW5nXSROYW1lCiAgICApCiAgICAiSGVsbG8sICROYW1lISIKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function Get-Greeting {
    param (
        [string]$Name
    )
    &quot;Hello, $Name!&quot;
}</pre></div><div class='content'></div><h2>Calling a Function</h2>
<div class='content'><p>Once defined, you can call the function by its name and pass any required parameters.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUdyZWV0aW5nIC1OYW1lICJBbGljZSI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-Greeting -Name &quot;Alice&quot;</pre></div><div class='content'></div><h2>Practical Example</h2>
<div class='content'><p>Let's create a function that calculates the factorial of a number.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gR2V0LUZhY3RvcmlhbCB7CiAgICBwYXJhbSAoCiAgICAgICAgW2ludF0kTnVtYmVyCiAgICApCiAgICBpZiAoJE51bWJlciAtbGUgMSkgewogICAgICAgIHJldHVybiAxCiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAkTnVtYmVyICogKEdldC1GYWN0b3JpYWwgLU51bWJlciAoJE51bWJlciAtIDEpKQogICAgfQp9CgojIENhbGxpbmcgdGhlIGZ1bmN0aW9uCkdldC1GYWN0b3JpYWwgLU51bWJlciA1"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function Get-Factorial {
    param (
        [int]$Number
    )
    if ($Number -le 1) {
        return 1
    } else {
        return $Number * (Get-Factorial -Number ($Number - 1))
    }
}

# Calling the function
Get-Factorial -Number 5</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Function Definition</strong>: <code>function Get-Factorial { ... }</code> defines the function.</li>
<li><strong>Parameter</strong>: <code>param ([int]$Number)</code> specifies that the function takes an integer parameter.</li>
<li><strong>Recursive Call</strong>: The function calls itself to calculate the factorial.</li>
</ul>
</div><h1>What is a Script?</h1>
<div class='content'><p>A script in PowerShell is a file containing a series of commands and functions. Scripts are saved with a <code>.ps1</code> extension and can be executed in the PowerShell environment.</p>
</div><h2>Creating a Script</h2>
<div class='content'><ol>
<li>Open a text editor (e.g., Notepad, VS Code).</li>
<li>Write your PowerShell commands and functions.</li>
<li>Save the file with a <code>.ps1</code> extension.</li>
</ol>
</div><h2>Example Script</h2>
<div class='content'><p>Create a script named <code>GreetUser.ps1</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBHcmVldFVzZXIucHMxCnBhcmFtICgKICAgIFtzdHJpbmddJFVzZXJOYW1lCikKCmZ1bmN0aW9uIEdldC1HcmVldGluZyB7CiAgICBwYXJhbSAoCiAgICAgICAgW3N0cmluZ10kTmFtZQogICAgKQogICAgIkhlbGxvLCAkTmFtZSEiCn0KCiMgQ2FsbCB0aGUgZnVuY3Rpb24KR2V0LUdyZWV0aW5nIC1OYW1lICRVc2VyTmFtZQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># GreetUser.ps1
param (
    [string]$UserName
)

function Get-Greeting {
    param (
        [string]$Name
    )
    &quot;Hello, $Name!&quot;
}

# Call the function
Get-Greeting -Name $UserName</pre></div><div class='content'></div><h2>Running a Script</h2>
<div class='content'><p>To run the script, open PowerShell and navigate to the directory containing the script. Use the <code>.\</code> notation to execute it.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LlxHcmVldFVzZXIucHMxIC1Vc2VyTmFtZSAiQm9iIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>.\GreetUser.ps1 -UserName &quot;Bob&quot;</pre></div><div class='content'></div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Create a Function</h2>
<div class='content'><p><strong>Task</strong>: Write a function named <code>Get-Square</code> that takes a number as a parameter and returns its square.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gR2V0LVNxdWFyZSB7CiAgICBwYXJhbSAoCiAgICAgICAgW2ludF0kTnVtYmVyCiAgICApCiAgICByZXR1cm4gJE51bWJlciAqICROdW1iZXIKfQoKIyBUZXN0IHRoZSBmdW5jdGlvbgpHZXQtU3F1YXJlIC1OdW1iZXIgNA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function Get-Square {
    param (
        [int]$Number
    )
    return $Number * $Number
}

# Test the function
Get-Square -Number 4</pre></div><div class='content'></div><h2>Exercise 2: Create a Script</h2>
<div class='content'><p><strong>Task</strong>: Create a script named <code>CalculateArea.ps1</code> that defines a function to calculate the area of a rectangle and calls the function with given length and width.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDYWxjdWxhdGVBcmVhLnBzMQpwYXJhbSAoCiAgICBbaW50XSRMZW5ndGgsCiAgICBbaW50XSRXaWR0aAopCgpmdW5jdGlvbiBHZXQtQXJlYSB7CiAgICBwYXJhbSAoCiAgICAgICAgW2ludF0kTCwKICAgICAgICBbaW50XSRXCiAgICApCiAgICByZXR1cm4gJEwgKiAkVwp9CgojIENhbGwgdGhlIGZ1bmN0aW9uCkdldC1BcmVhIC1MICRMZW5ndGggLVcgJFdpZHRo"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># CalculateArea.ps1
param (
    [int]$Length,
    [int]$Width
)

function Get-Area {
    param (
        [int]$L,
        [int]$W
    )
    return $L * $W
}

# Call the function
Get-Area -L $Length -W $Width</pre></div><div class='content'><p>Run the script:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LlxDYWxjdWxhdGVBcmVhLnBzMSAtTGVuZ3RoIDUgLVdpZHRoIDEw"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>.\CalculateArea.ps1 -Length 5 -Width 10</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Parameter Types</strong>: Ensure the parameters are of the correct type. Use <code>[int]</code>, <code>[string]</code>, etc., to specify types.</li>
<li><strong>Script Execution Policy</strong>: PowerShell may block script execution due to security policies. Use <code>Set-ExecutionPolicy</code> to change the policy if needed.</li>
<li><strong>Function Naming</strong>: Use meaningful names for functions to make your code more readable and maintainable.</li>
</ul>
</div><h1>Summary</h1>
<div class='content'><p>In this section, we covered:</p>
<ul>
<li>The basics of defining and calling functions in PowerShell.</li>
<li>How to create and run PowerShell scripts.</li>
<li>Practical examples and exercises to reinforce the concepts.</li>
</ul>
<p>Understanding functions and scripts is crucial for writing efficient and reusable PowerShell code. In the next module, we will explore working with objects in PowerShell, which will further enhance your scripting capabilities.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-loops' title="Loops in PowerShell">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-01-understanding-objects' title="Understanding Objects">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
