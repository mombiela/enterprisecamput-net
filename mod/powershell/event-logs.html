<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Logs</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/event-logs" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/event-logs" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/event-logs" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/event-logs" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/event-logs" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='working-with-the-registry'>&#x25C4;Working with the Registry</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Event Logs</a>
	</div>
	<div class='col-4 text-end'>
					<a href='system-information-and-configuration'>System Information and Configuration &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Event Logs</h1>
<div class='content'><p>Event logs are a valuable resource for monitoring and troubleshooting Windows systems. They record various system, security, and application events, providing insights into the system's health and activities. PowerShell offers robust cmdlets to interact with these logs, making it easier to automate and manage event log data.</p>
</div><h1>Understanding Event Logs</h1>
<div class='content'><ul>
<li>
<p><strong>Event Log Types</strong>: Windows maintains several types of event logs, including:</p>
<ul>
<li><strong>Application Log</strong>: Records events logged by applications or programs.</li>
<li><strong>System Log</strong>: Contains events logged by the Windows system components.</li>
<li><strong>Security Log</strong>: Records security-related events like login attempts and resource access.</li>
<li><strong>Custom Logs</strong>: Created by applications or administrators for specific purposes.</li>
</ul>
</li>
<li>
<p><strong>Event Log Structure</strong>:</p>
<ul>
<li><strong>Event ID</strong>: A unique identifier for the event.</li>
<li><strong>Source</strong>: The application or component that logged the event.</li>
<li><strong>Log Name</strong>: The name of the log where the event is recorded.</li>
<li><strong>Level</strong>: The severity of the event (e.g., Information, Warning, Error).</li>
<li><strong>Message</strong>: A description of the event.</li>
</ul>
</li>
</ul>
</div><h1>Accessing Event Logs with PowerShell</h1>
<div class='content'><p>PowerShell provides several cmdlets to interact with event logs. Here are some key cmdlets:</p>
</div><h2>Viewing Event Logs</h2>
<div class='content'><ul>
<li><strong>Get-EventLog</strong>: Retrieves event log entries from classic event logs.</li>
<li><strong>Get-WinEvent</strong>: Retrieves event log entries from both classic and newer event logs.</li>
</ul>
<h4>Example: Using Get-EventLog</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSZXRyaWV2ZSB0aGUgbGF0ZXN0IDEwIGVudHJpZXMgZnJvbSB0aGUgU3lzdGVtIGxvZwpHZXQtRXZlbnRMb2cgLUxvZ05hbWUgU3lzdGVtIC1OZXdlc3QgMTA="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Retrieve the latest 10 entries from the System log
Get-EventLog -LogName System -Newest 10</pre></div><div class='content'><p>Explanation:</p>
<ul>
<li><code>-LogName System</code>: Specifies the log name.</li>
<li><code>-Newest 10</code>: Retrieves the latest 10 entries.</li>
</ul>
<h4>Example: Using Get-WinEvent</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSZXRyaWV2ZSB0aGUgbGF0ZXN0IDEwIGVudHJpZXMgZnJvbSB0aGUgU3lzdGVtIGxvZwpHZXQtV2luRXZlbnQgLUxvZ05hbWUgU3lzdGVtIC1NYXhFdmVudHMgMTA="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Retrieve the latest 10 entries from the System log
Get-WinEvent -LogName System -MaxEvents 10</pre></div><div class='content'><p>Explanation:</p>
<ul>
<li><code>-LogName System</code>: Specifies the log name.</li>
<li><code>-MaxEvents 10</code>: Retrieves the latest 10 entries.</li>
</ul>
</div><h2>Filtering Event Logs</h2>
<div class='content'><p>You can filter event logs based on various criteria such as Event ID, Source, and Time.</p>
<h4>Example: Filtering by Event ID</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSZXRyaWV2ZSBlbnRyaWVzIHdpdGggRXZlbnQgSUQgNjAwNiBmcm9tIHRoZSBTeXN0ZW0gbG9nCkdldC1FdmVudExvZyAtTG9nTmFtZSBTeXN0ZW0gLUluc3RhbmNlSWQgNjAwNg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Retrieve entries with Event ID 6006 from the System log
Get-EventLog -LogName System -InstanceId 6006</pre></div><div class='content'><p>Explanation:</p>
<ul>
<li><code>-InstanceId 6006</code>: Filters events with Event ID 6006.</li>
</ul>
<h4>Example: Filtering by Time Range</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSZXRyaWV2ZSBlbnRyaWVzIGZyb20gdGhlIFN5c3RlbSBsb2cgaW4gdGhlIGxhc3QgMjQgaG91cnMKJHN0YXJ0VGltZSA9IChHZXQtRGF0ZSkuQWRkRGF5cygtMSkKR2V0LUV2ZW50TG9nIC1Mb2dOYW1lIFN5c3RlbSAtQWZ0ZXIgJHN0YXJ0VGltZQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Retrieve entries from the System log in the last 24 hours
$startTime = (Get-Date).AddDays(-1)
Get-EventLog -LogName System -After $startTime</pre></div><div class='content'><p>Explanation:</p>
<ul>
<li><code>$startTime = (Get-Date).AddDays(-1)</code>: Sets the start time to 24 hours ago.</li>
<li><code>-After $startTime</code>: Filters events after the specified time.</li>
</ul>
</div><h2>Creating and Writing to Event Logs</h2>
<div class='content'><ul>
<li><strong>New-EventLog</strong>: Creates a new event log and a new event source.</li>
<li><strong>Write-EventLog</strong>: Writes an event to an event log.</li>
</ul>
<h4>Example: Creating a Custom Event Log</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcgZXZlbnQgbG9nIG5hbWVkICJNeUFwcExvZyIgd2l0aCBhIHNvdXJjZSAiTXlBcHBTb3VyY2UiCk5ldy1FdmVudExvZyAtTG9nTmFtZSBNeUFwcExvZyAtU291cmNlIE15QXBwU291cmNl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new event log named &quot;MyAppLog&quot; with a source &quot;MyAppSource&quot;
New-EventLog -LogName MyAppLog -Source MyAppSource</pre></div><div class='content'><p>Explanation:</p>
<ul>
<li><code>-LogName MyAppLog</code>: Specifies the name of the new log.</li>
<li><code>-Source MyAppSource</code>: Specifies the source for the new log.</li>
</ul>
<h4>Example: Writing an Event to a Custom Log</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBXcml0ZSBhbiBpbmZvcm1hdGlvbmFsIGV2ZW50IHRvIHRoZSBjdXN0b20gbG9nICJNeUFwcExvZyIKV3JpdGUtRXZlbnRMb2cgLUxvZ05hbWUgTXlBcHBMb2cgLVNvdXJjZSBNeUFwcFNvdXJjZSAtRXZlbnRJZCAxMDAxIC1FbnRyeVR5cGUgSW5mb3JtYXRpb24gLU1lc3NhZ2UgIlRoaXMgaXMgYSB0ZXN0IGV2ZW50LiI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Write an informational event to the custom log &quot;MyAppLog&quot;
Write-EventLog -LogName MyAppLog -Source MyAppSource -EventId 1001 -EntryType Information -Message &quot;This is a test event.&quot;</pre></div><div class='content'><p>Explanation:</p>
<ul>
<li><code>-LogName MyAppLog</code>: Specifies the log name.</li>
<li><code>-Source MyAppSource</code>: Specifies the source.</li>
<li><code>-EventId 1001</code>: Sets the event ID.</li>
<li><code>-EntryType Information</code>: Sets the event type.</li>
<li><code>-Message &quot;This is a test event.&quot;</code>: Provides the event message.</li>
</ul>
</div><h2>Clearing Event Logs</h2>
<div class='content'><ul>
<li><strong>Clear-EventLog</strong>: Clears entries from classic event logs.</li>
<li><strong>Remove-EventLog</strong>: Deletes an event log.</li>
</ul>
<h4>Example: Clearing an Event Log</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDbGVhciBhbGwgZW50cmllcyBmcm9tIHRoZSBTeXN0ZW0gbG9nCkNsZWFyLUV2ZW50TG9nIC1Mb2dOYW1lIFN5c3RlbQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Clear all entries from the System log
Clear-EventLog -LogName System</pre></div><div class='content'><p>Explanation:</p>
<ul>
<li><code>-LogName System</code>: Specifies the log to clear.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Event logs are essential for monitoring and troubleshooting Windows systems. PowerShell provides powerful cmdlets to access, filter, create, write, and clear event logs, making it a versatile tool for system administrators. By mastering these cmdlets, you can efficiently manage event logs and gain valuable insights into your system's operations.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='working-with-the-registry'>&#x25C4;Working with the Registry</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Event Logs</a>
	</div>
	<div class='col-4 text-end'>
					<a href='system-information-and-configuration'>System Information and Configuration &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
