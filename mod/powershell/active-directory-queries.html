<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Active Directory Queries</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/active-directory-queries" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/active-directory-queries" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/active-directory-queries" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/active-directory-queries" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/active-directory-queries" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='managing-users-and-groups'>&#x25C4;Managing Users and Groups</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Active Directory Queries</a>
	</div>
	<div class='col-4 text-end'>
					<a href='automating-active-directory-tasks'>Automating Active Directory Tasks &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Active Directory (AD) is a directory service developed by Microsoft for Windows domain networks. PowerShell provides a powerful way to interact with AD, allowing administrators to query and manage AD objects efficiently. This section will guide you through querying Active Directory using PowerShell, from basic to advanced techniques.</p>
</div><h1>Prerequisites</h1>
<div class='content'><p>Before diving into Active Directory queries, ensure you have:</p>
<ul>
<li>Basic understanding of PowerShell.</li>
<li>Active Directory module installed (<code>RSAT-AD-PowerShell</code>).</li>
</ul>
</div><h1>Basic Queries</h1>
<div class='content'></div><h2>Connecting to Active Directory</h2>
<div class='content'><p>To perform any query, you need to import the Active Directory module:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW1wb3J0LU1vZHVsZSBBY3RpdmVEaXJlY3Rvcnk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Import-Module ActiveDirectory</pre></div><div class='content'></div><h2>Retrieving a Single User</h2>
<div class='content'><p>To retrieve a single user by their username (sAMAccountName):</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtSWRlbnRpdHkgInVzZXJuYW1lIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Identity &quot;username&quot;</pre></div><div class='content'><ul>
<li><code>-Identity</code>: Specifies the user to retrieve.</li>
</ul>
</div><h2>Retrieving Multiple Users</h2>
<div class='content'><p>To retrieve all users in the domain:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtRmlsdGVyICo="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Filter *</pre></div><div class='content'><ul>
<li><code>-Filter *</code>: Retrieves all users.</li>
</ul>
</div><h2>Filtering Users</h2>
<div class='content'><p>To filter users based on specific criteria, such as users in a specific department:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtRmlsdGVyIHtEZXBhcnRtZW50IC1lcSAiU2FsZXMifQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Filter {Department -eq &quot;Sales&quot;}</pre></div><div class='content'><ul>
<li><code>-Filter {Department -eq &quot;Sales&quot;}</code>: Retrieves users in the Sales department.</li>
</ul>
</div><h2>Selecting Specific Properties</h2>
<div class='content'><p>By default, <code>Get-ADUser</code> returns a limited set of properties. To select specific properties:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtSWRlbnRpdHkgInVzZXJuYW1lIiAtUHJvcGVydGllcyBEaXNwbGF5TmFtZSwgRW1haWxBZGRyZXNz"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Identity &quot;username&quot; -Properties DisplayName, EmailAddress</pre></div><div class='content'><ul>
<li><code>-Properties</code>: Specifies additional properties to retrieve.</li>
</ul>
</div><h1>Intermediate Queries</h1>
<div class='content'></div><h2>Retrieving Groups</h2>
<div class='content'><p>To retrieve all groups in the domain:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFER3JvdXAgLUZpbHRlciAq"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADGroup -Filter *</pre></div><div class='content'></div><h2>Filtering Groups</h2>
<div class='content'><p>To filter groups based on specific criteria, such as groups starting with &quot;Admin&quot;:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFER3JvdXAgLUZpbHRlciB7TmFtZSAtbGlrZSAiQWRtaW4qIn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADGroup -Filter {Name -like &quot;Admin*&quot;}</pre></div><div class='content'></div><h2>Retrieving Group Members</h2>
<div class='content'><p>To retrieve members of a specific group:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFER3JvdXBNZW1iZXIgLUlkZW50aXR5ICJHcm91cE5hbWUi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADGroupMember -Identity &quot;GroupName&quot;</pre></div><div class='content'></div><h2>Combining Filters and Properties</h2>
<div class='content'><p>To retrieve users with specific properties and filter criteria:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtRmlsdGVyIHtUaXRsZSAtZXEgIk1hbmFnZXIifSAtUHJvcGVydGllcyBEaXNwbGF5TmFtZSwgRW1haWxBZGRyZXNz"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Filter {Title -eq &quot;Manager&quot;} -Properties DisplayName, EmailAddress</pre></div><div class='content'></div><h1>Advanced Queries</h1>
<div class='content'></div><h2>Using LDAP Filters</h2>
<div class='content'><p>LDAP filters provide more granular control over queries. To retrieve users with an LDAP filter:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtTERBUEZpbHRlciAiKG9iamVjdENsYXNzPXVzZXIpIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -LDAPFilter &quot;(objectClass=user)&quot;</pre></div><div class='content'><ul>
<li><code>-LDAPFilter</code>: Specifies an LDAP filter.</li>
</ul>
</div><h2>Querying Organizational Units (OUs)</h2>
<div class='content'><p>To retrieve all OUs in the domain:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFET3JnYW5pemF0aW9uYWxVbml0IC1GaWx0ZXIgKg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADOrganizationalUnit -Filter *</pre></div><div class='content'></div><h2>Recursive Queries</h2>
<div class='content'><p>To retrieve all users in a specific OU and its child OUs:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtRmlsdGVyICogLVNlYXJjaEJhc2UgIk9VPVNhbGVzLERDPWV4YW1wbGUsREM9Y29tIiAtU2VhcmNoU2NvcGUgU3VidHJlZQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Filter * -SearchBase &quot;OU=Sales,DC=example,DC=com&quot; -SearchScope Subtree</pre></div><div class='content'><ul>
<li><code>-SearchBase</code>: Specifies the base of the search.</li>
<li><code>-SearchScope Subtree</code>: Searches the specified OU and all its child OUs.</li>
</ul>
</div><h2>Custom Attributes</h2>
<div class='content'><p>To retrieve users with custom attributes:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtRmlsdGVyICogLVByb3BlcnRpZXMgQ3VzdG9tQXR0cmlidXRlMQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Filter * -Properties CustomAttribute1</pre></div><div class='content'></div><h2>Exporting Query Results</h2>
<div class='content'><p>To export query results to a CSV file:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUFEVXNlciAtRmlsdGVyICogfCBTZWxlY3QtT2JqZWN0IE5hbWUsIEVtYWlsQWRkcmVzcyB8IEV4cG9ydC1Dc3YgLVBhdGggIkM6XFVzZXJzLmNzdiIgLU5vVHlwZUluZm9ybWF0aW9u"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-ADUser -Filter * | Select-Object Name, EmailAddress | Export-Csv -Path &quot;C:\Users.csv&quot; -NoTypeInformation</pre></div><div class='content'><ul>
<li><code>Select-Object</code>: Selects specific properties.</li>
<li><code>Export-Csv</code>: Exports the results to a CSV file.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>PowerShell provides a robust set of cmdlets for querying Active Directory, enabling administrators to efficiently manage and retrieve AD objects. By mastering these queries, you can automate and streamline many administrative tasks, making your workflow more efficient and effective. Practice these queries and explore the vast capabilities of PowerShell to become proficient in managing Active Directory.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='managing-users-and-groups'>&#x25C4;Managing Users and Groups</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Active Directory Queries</a>
	</div>
	<div class='col-4 text-end'>
					<a href='automating-active-directory-tasks'>Automating Active Directory Tasks &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
