<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creating Scheduled Tasks</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/05-02-creating-scheduled-tasks" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/05-02-creating-scheduled-tasks" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/05-02-creating-scheduled-tasks" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/05-02-creating-scheduled-tasks" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/05-02-creating-scheduled-tasks" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-01-introduction-automation' title="Introduction to Automation">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Creating Scheduled Tasks</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-03-system-administration' title="Using PowerShell for System Administration">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to create and manage scheduled tasks using PowerShell. Scheduled tasks allow you to automate repetitive tasks, ensuring they run at specified times without manual intervention. This is particularly useful for system maintenance, backups, and other routine operations.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Task Scheduler</strong>: A Windows feature that allows you to schedule the launch of programs or scripts at predefined times or intervals.</li>
<li><strong>Scheduled Task Cmdlets</strong>: PowerShell provides a set of cmdlets specifically for creating, managing, and running scheduled tasks.</li>
</ol>
</div><h1>Prerequisites</h1>
<div class='content'><ul>
<li>Basic understanding of PowerShell commands and syntax.</li>
<li>Administrative privileges on the system where you are creating the scheduled tasks.</li>
</ul>
</div><h1>Cmdlets for Scheduled Tasks</h1>
<div class='content'><p>Here are some of the key cmdlets used for managing scheduled tasks:</p>
<table>
<thead>
<tr>
<th>Cmdlet</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>New-ScheduledTaskTrigger</code></td>
<td>Creates a new trigger for a scheduled task.</td>
</tr>
<tr>
<td><code>New-ScheduledTaskAction</code></td>
<td>Defines the action that the scheduled task will perform.</td>
</tr>
<tr>
<td><code>New-ScheduledTaskPrincipal</code></td>
<td>Specifies the user account under which the task runs.</td>
</tr>
<tr>
<td><code>Register-ScheduledTask</code></td>
<td>Registers a new scheduled task in the Task Scheduler.</td>
</tr>
<tr>
<td><code>Get-ScheduledTask</code></td>
<td>Retrieves the definition of a scheduled task.</td>
</tr>
<tr>
<td><code>Unregister-ScheduledTask</code></td>
<td>Deletes a scheduled task.</td>
</tr>
</tbody>
</table>
</div><h1>Creating a Simple Scheduled Task</h1>
<div class='content'><p>Let's create a simple scheduled task that runs a PowerShell script every day at a specific time.</p>
</div><h2>Step-by-Step Example</h2>
<div class='content'><ol>
<li>
<p><strong>Define the Trigger</strong>: The trigger specifies when the task will run.</p>
<pre><code class="language-powershell">$trigger = New-ScheduledTaskTrigger -Daily -At 3AM
</code></pre>
</li>
<li>
<p><strong>Define the Action</strong>: The action specifies what the task will do. In this case, it will run a PowerShell script.</p>
<pre><code class="language-powershell">$action = New-ScheduledTaskAction -Execute &quot;PowerShell.exe&quot; -Argument &quot;C:\Scripts\Backup.ps1&quot;
</code></pre>
</li>
<li>
<p><strong>Define the Principal</strong>: The principal specifies the user account under which the task will run.</p>
<pre><code class="language-powershell">$principal = New-ScheduledTaskPrincipal -UserId &quot;SYSTEM&quot; -LogonType ServiceAccount
</code></pre>
</li>
<li>
<p><strong>Register the Task</strong>: Finally, register the task with the Task Scheduler.</p>
<pre><code class="language-powershell">Register-ScheduledTask -TaskName &quot;DailyBackup&quot; -Trigger $trigger -Action $action -Principal $principal -Description &quot;Daily backup task&quot;
</code></pre>
</li>
</ol>
</div><h2>Full Script</h2>
<div class='content'><p>Here is the complete script to create the scheduled task:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEZWZpbmUgdGhlIHRyaWdnZXIKJHRyaWdnZXIgPSBOZXctU2NoZWR1bGVkVGFza1RyaWdnZXIgLURhaWx5IC1BdCAzQU0KCiMgRGVmaW5lIHRoZSBhY3Rpb24KJGFjdGlvbiA9IE5ldy1TY2hlZHVsZWRUYXNrQWN0aW9uIC1FeGVjdXRlICJQb3dlclNoZWxsLmV4ZSIgLUFyZ3VtZW50ICJDOlxTY3JpcHRzXEJhY2t1cC5wczEiCgojIERlZmluZSB0aGUgcHJpbmNpcGFsCiRwcmluY2lwYWwgPSBOZXctU2NoZWR1bGVkVGFza1ByaW5jaXBhbCAtVXNlcklkICJTWVNURU0iIC1Mb2dvblR5cGUgU2VydmljZUFjY291bnQKCiMgUmVnaXN0ZXIgdGhlIHRhc2sKUmVnaXN0ZXItU2NoZWR1bGVkVGFzayAtVGFza05hbWUgIkRhaWx5QmFja3VwIiAtVHJpZ2dlciAkdHJpZ2dlciAtQWN0aW9uICRhY3Rpb24gLVByaW5jaXBhbCAkcHJpbmNpcGFsIC1EZXNjcmlwdGlvbiAiRGFpbHkgYmFja3VwIHRhc2si"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Define the trigger
$trigger = New-ScheduledTaskTrigger -Daily -At 3AM

# Define the action
$action = New-ScheduledTaskAction -Execute &quot;PowerShell.exe&quot; -Argument &quot;C:\Scripts\Backup.ps1&quot;

# Define the principal
$principal = New-ScheduledTaskPrincipal -UserId &quot;SYSTEM&quot; -LogonType ServiceAccount

# Register the task
Register-ScheduledTask -TaskName &quot;DailyBackup&quot; -Trigger $trigger -Action $action -Principal $principal -Description &quot;Daily backup task&quot;</pre></div><div class='content'></div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise 1: Create a Scheduled Task</h2>
<div class='content'><p><strong>Objective</strong>: Create a scheduled task that runs a PowerShell script every Monday at 2 PM.</p>
<ol>
<li>
<p><strong>Define the Trigger</strong>:</p>
<pre><code class="language-powershell">$trigger = New-ScheduledTaskTrigger -Weekly -DaysOfWeek Monday -At 2PM
</code></pre>
</li>
<li>
<p><strong>Define the Action</strong>:</p>
<pre><code class="language-powershell">$action = New-ScheduledTaskAction -Execute &quot;PowerShell.exe&quot; -Argument &quot;C:\Scripts\WeeklyReport.ps1&quot;
</code></pre>
</li>
<li>
<p><strong>Define the Principal</strong>:</p>
<pre><code class="language-powershell">$principal = New-ScheduledTaskPrincipal -UserId &quot;SYSTEM&quot; -LogonType ServiceAccount
</code></pre>
</li>
<li>
<p><strong>Register the Task</strong>:</p>
<pre><code class="language-powershell">Register-ScheduledTask -TaskName &quot;WeeklyReport&quot; -Trigger $trigger -Action $action -Principal $principal -Description &quot;Weekly report generation task&quot;
</code></pre>
</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><p>Here is the complete script for the exercise:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEZWZpbmUgdGhlIHRyaWdnZXIKJHRyaWdnZXIgPSBOZXctU2NoZWR1bGVkVGFza1RyaWdnZXIgLVdlZWtseSAtRGF5c09mV2VlayBNb25kYXkgLUF0IDJQTQoKIyBEZWZpbmUgdGhlIGFjdGlvbgokYWN0aW9uID0gTmV3LVNjaGVkdWxlZFRhc2tBY3Rpb24gLUV4ZWN1dGUgIlBvd2VyU2hlbGwuZXhlIiAtQXJndW1lbnQgIkM6XFNjcmlwdHNcV2Vla2x5UmVwb3J0LnBzMSIKCiMgRGVmaW5lIHRoZSBwcmluY2lwYWwKJHByaW5jaXBhbCA9IE5ldy1TY2hlZHVsZWRUYXNrUHJpbmNpcGFsIC1Vc2VySWQgIlNZU1RFTSIgLUxvZ29uVHlwZSBTZXJ2aWNlQWNjb3VudAoKIyBSZWdpc3RlciB0aGUgdGFzawpSZWdpc3Rlci1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiV2Vla2x5UmVwb3J0IiAtVHJpZ2dlciAkdHJpZ2dlciAtQWN0aW9uICRhY3Rpb24gLVByaW5jaXBhbCAkcHJpbmNpcGFsIC1EZXNjcmlwdGlvbiAiV2Vla2x5IHJlcG9ydCBnZW5lcmF0aW9uIHRhc2si"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Define the trigger
$trigger = New-ScheduledTaskTrigger -Weekly -DaysOfWeek Monday -At 2PM

# Define the action
$action = New-ScheduledTaskAction -Execute &quot;PowerShell.exe&quot; -Argument &quot;C:\Scripts\WeeklyReport.ps1&quot;

# Define the principal
$principal = New-ScheduledTaskPrincipal -UserId &quot;SYSTEM&quot; -LogonType ServiceAccount

# Register the task
Register-ScheduledTask -TaskName &quot;WeeklyReport&quot; -Trigger $trigger -Action $action -Principal $principal -Description &quot;Weekly report generation task&quot;</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Incorrect Paths</strong>: Ensure that the path to the script is correct and accessible by the user account under which the task runs.</li>
<li><strong>Permissions</strong>: Make sure the user account has the necessary permissions to execute the script and access any resources it needs.</li>
<li><strong>Testing</strong>: Test the script manually before scheduling it to ensure it works as expected.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we learned how to create and manage scheduled tasks using PowerShell. We covered the key cmdlets, provided a step-by-step example, and included a practical exercise to reinforce the concepts. Scheduled tasks are a powerful tool for automating routine tasks, and mastering them can significantly enhance your productivity and system management capabilities.</p>
<p>Next, we will explore how to use PowerShell for system administration tasks in the following section.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-01-introduction-automation' title="Introduction to Automation">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-03-system-administration' title="Using PowerShell for System Administration">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
