<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Performance Optimization</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/09-02-performance-optimization" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/09-02-performance-optimization" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/09-02-performance-optimization" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=3" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/powershell/09-02-performance-optimization" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/powershell/09-02-performance-optimization" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>Building today's and tomorrow's society</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Languages</a>
				 					<a href="/categ/frameworks">Frameworks</a>
				 					<a href="/categ/tech-tools">Tools</a>
				 					<a href="/categ/foundations">Foundations</a>
				 					<a href="/categ/soft-skills">Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='09-01-readable-maintainable-code' title="Writing Readable and Maintainable Code">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Performance Optimization</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-03-security-best-practices' title="Security Best Practices">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Performance optimization in PowerShell involves writing efficient scripts that execute quickly and use minimal system resources. This section will cover various techniques and best practices to enhance the performance of your PowerShell scripts.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Efficient Use of Cmdlets</strong>: Use built-in cmdlets that are optimized for performance.</li>
<li><strong>Minimize Pipeline Usage</strong>: Reduce the number of pipeline stages to avoid unnecessary overhead.</li>
<li><strong>Avoid Unnecessary Object Creation</strong>: Limit the creation of objects to save memory and processing time.</li>
<li><strong>Use Proper Data Structures</strong>: Choose the right data structures for your needs.</li>
<li><strong>Optimize Loops and Conditional Statements</strong>: Write efficient loops and conditionals.</li>
<li><strong>Profile and Measure Performance</strong>: Use tools to measure and profile your script's performance.</li>
</ol>
</div><h1><p>Efficient Use of Cmdlets</p>
</h1>
<div class='content'><p>PowerShell cmdlets are designed to be efficient. Whenever possible, use built-in cmdlets instead of writing custom code.</p>
</div><h2><p>Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbmVmZmljaWVudCB3YXk6IFVzaW5nIGEgbG9vcCB0byBmaWx0ZXIgcHJvY2Vzc2VzCiRwcm9jZXNzZXMgPSBHZXQtUHJvY2VzcwokZmlsdGVyZWRQcm9jZXNzZXMgPSBAKCkKZm9yZWFjaCAoJHByb2Nlc3MgaW4gJHByb2Nlc3NlcykgewogICAgaWYgKCRwcm9jZXNzLkNQVSAtZ3QgMTAwKSB7CiAgICAgICAgJGZpbHRlcmVkUHJvY2Vzc2VzICs9ICRwcm9jZXNzCiAgICB9Cn0KCiMgRWZmaWNpZW50IHdheTogVXNpbmcgV2hlcmUtT2JqZWN0IGNtZGxldAokZmlsdGVyZWRQcm9jZXNzZXMgPSBHZXQtUHJvY2VzcyB8IFdoZXJlLU9iamVjdCB7ICRfLkNQVSAtZ3QgMTAwIH0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Inefficient way: Using a loop to filter processes
$processes = Get-Process
$filteredProcesses = @()
foreach ($process in $processes) {
    if ($process.CPU -gt 100) {
        $filteredProcesses += $process
    }
}

# Efficient way: Using Where-Object cmdlet
$filteredProcesses = Get-Process | Where-Object { $_.CPU -gt 100 }</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li>The first example uses a loop to filter processes, which is less efficient.</li>
<li>The second example uses the <code>Where-Object</code> cmdlet, which is optimized for filtering.</li>
</ul>
</div><h1><p>Minimize Pipeline Usage</p>
</h1>
<div class='content'><p>Each stage in a pipeline adds overhead. Minimize the number of stages to improve performance.</p>
</div><h2><p>Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbmVmZmljaWVudCB3YXk6IE11bHRpcGxlIHBpcGVsaW5lIHN0YWdlcwokcmVzdWx0cyA9IEdldC1Qcm9jZXNzIHwgV2hlcmUtT2JqZWN0IHsgJF8uQ1BVIC1ndCAxMDAgfSB8IFNlbGVjdC1PYmplY3QgLVByb3BlcnR5IE5hbWUsIENQVQoKIyBFZmZpY2llbnQgd2F5OiBTaW5nbGUgcGlwZWxpbmUgc3RhZ2UKJHJlc3VsdHMgPSBHZXQtUHJvY2VzcyB8IFdoZXJlLU9iamVjdCB7ICRfLkNQVSAtZ3QgMTAwIH0gfCBTZWxlY3QtT2JqZWN0IE5hbWUsIENQVQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Inefficient way: Multiple pipeline stages
$results = Get-Process | Where-Object { $_.CPU -gt 100 } | Select-Object -Property Name, CPU

# Efficient way: Single pipeline stage
$results = Get-Process | Where-Object { $_.CPU -gt 100 } | Select-Object Name, CPU</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li>Both examples achieve the same result, but the second example combines the <code>Where-Object</code> and <code>Select-Object</code> cmdlets into a single pipeline stage.</li>
</ul>
</div><h1><p>Avoid Unnecessary Object Creation</p>
</h1>
<div class='content'><p>Creating objects can be resource-intensive. Avoid creating unnecessary objects.</p>
</div><h2><p>Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbmVmZmljaWVudCB3YXk6IENyZWF0aW5nIG9iamVjdHMgaW4gYSBsb29wCiRyZXN1bHRzID0gQCgpCmZvciAoJGkgPSAwOyAkaSAtbHQgMTAwMDsgJGkrKykgewogICAgJG9iaiA9IE5ldy1PYmplY3QgUFNPYmplY3QgLVByb3BlcnR5IEB7IEluZGV4ID0gJGkgfQogICAgJHJlc3VsdHMgKz0gJG9iagp9CgojIEVmZmljaWVudCB3YXk6IFVzaW5nIGEgc2luZ2xlIG9iamVjdCBjcmVhdGlvbgokcmVzdWx0cyA9IDAuLjk5OSB8IEZvckVhY2gtT2JqZWN0IHsgW1BTQ3VzdG9tT2JqZWN0XUB7IEluZGV4ID0gJF8gfSB9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Inefficient way: Creating objects in a loop
$results = @()
for ($i = 0; $i -lt 1000; $i++) {
    $obj = New-Object PSObject -Property @{ Index = $i }
    $results += $obj
}

# Efficient way: Using a single object creation
$results = 0..999 | ForEach-Object { [PSCustomObject]@{ Index = $_ } }</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li>The first example creates a new object in each iteration of the loop.</li>
<li>The second example uses a range operator and <code>ForEach-Object</code> to create objects more efficiently.</li>
</ul>
</div><h1><p>Use Proper Data Structures</p>
</h1>
<div class='content'><p>Choosing the right data structure can significantly impact performance.</p>
</div><h2><p>Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbmVmZmljaWVudCB3YXk6IFVzaW5nIGFuIGFycmF5IGZvciBmcmVxdWVudCBhZGRpdGlvbnMKJGFycmF5ID0gQCgpCmZvciAoJGkgPSAwOyAkaSAtbHQgMTAwMDsgJGkrKykgewogICAgJGFycmF5ICs9ICRpCn0KCiMgRWZmaWNpZW50IHdheTogVXNpbmcgYW4gQXJyYXlMaXN0IGZvciBmcmVxdWVudCBhZGRpdGlvbnMKJGFycmF5TGlzdCA9IFtTeXN0ZW0uQ29sbGVjdGlvbnMuQXJyYXlMaXN0XTo6bmV3KCkKZm9yICgkaSA9IDA7ICRpIC1sdCAxMDAwOyAkaSsrKSB7CiAgICAkbnVsbCA9ICRhcnJheUxpc3QuQWRkKCRpKQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Inefficient way: Using an array for frequent additions
$array = @()
for ($i = 0; $i -lt 1000; $i++) {
    $array += $i
}

# Efficient way: Using an ArrayList for frequent additions
$arrayList = [System.Collections.ArrayList]::new()
for ($i = 0; $i -lt 1000; $i++) {
    $null = $arrayList.Add($i)
}</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li>The first example uses an array, which is inefficient for frequent additions.</li>
<li>The second example uses an <code>ArrayList</code>, which is optimized for frequent additions.</li>
</ul>
</div><h1><p>Optimize Loops and Conditional Statements</p>
</h1>
<div class='content'><p>Write efficient loops and conditionals to improve performance.</p>
</div><h2><p>Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbmVmZmljaWVudCB3YXk6IE5lc3RlZCBsb29wcwpmb3IgKCRpID0gMDsgJGkgLWx0IDEwMDsgJGkrKykgewogICAgZm9yICgkaiA9IDA7ICRqIC1sdCAxMDA7ICRqKyspIHsKICAgICAgICAjIERvIHNvbWV0aGluZwogICAgfQp9CgojIEVmZmljaWVudCB3YXk6IEZsYXR0ZW5lZCBsb29wCmZvciAoJGkgPSAwOyAkaSAtbHQgMTAwMDA7ICRpKyspIHsKICAgICRqID0gJGkgJSAxMDAKICAgICMgRG8gc29tZXRoaW5nCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Inefficient way: Nested loops
for ($i = 0; $i -lt 100; $i++) {
    for ($j = 0; $j -lt 100; $j++) {
        # Do something
    }
}

# Efficient way: Flattened loop
for ($i = 0; $i -lt 10000; $i++) {
    $j = $i % 100
    # Do something
}</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li>The first example uses nested loops, which can be inefficient.</li>
<li>The second example flattens the loop, reducing the number of iterations.</li>
</ul>
</div><h1><p>Profile and Measure Performance</p>
</h1>
<div class='content'><p>Use tools to measure and profile your script's performance.</p>
</div><h2><p>Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBNZWFzdXJlIHNjcmlwdCBleGVjdXRpb24gdGltZQokc3RhcnRUaW1lID0gR2V0LURhdGUKIyBZb3VyIHNjcmlwdCBoZXJlCiRlbmRUaW1lID0gR2V0LURhdGUKJGV4ZWN1dGlvblRpbWUgPSAkZW5kVGltZSAtICRzdGFydFRpbWUKV3JpdGUtT3V0cHV0ICJFeGVjdXRpb24gVGltZTogJGV4ZWN1dGlvblRpbWUiCgojIFVzZSBNZWFzdXJlLUNvbW1hbmQgY21kbGV0CiRleGVjdXRpb25UaW1lID0gTWVhc3VyZS1Db21tYW5kIHsKICAgICMgWW91ciBzY3JpcHQgaGVyZQp9CldyaXRlLU91dHB1dCAiRXhlY3V0aW9uIFRpbWU6ICQoJGV4ZWN1dGlvblRpbWUuVG90YWxTZWNvbmRzKSBzZWNvbmRzIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Measure script execution time
$startTime = Get-Date
# Your script here
$endTime = Get-Date
$executionTime = $endTime - $startTime
Write-Output &quot;Execution Time: $executionTime&quot;

# Use Measure-Command cmdlet
$executionTime = Measure-Command {
    # Your script here
}
Write-Output &quot;Execution Time: $($executionTime.TotalSeconds) seconds&quot;</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li>The first example manually measures the script's execution time.</li>
<li>The second example uses the <code>Measure-Command</code> cmdlet to measure execution time.</li>
</ul>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Task</p>
</h2>
<div class='content'><p>Write a PowerShell script that retrieves all processes consuming more than 50% CPU and sorts them by CPU usage in descending order. Optimize the script for performance.</p>
</div><h2><p>Solution</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBPcHRpbWl6ZWQgc2NyaXB0IHRvIHJldHJpZXZlIGFuZCBzb3J0IHByb2Nlc3NlcyBieSBDUFUgdXNhZ2UKJGhpZ2hDcHVQcm9jZXNzZXMgPSBHZXQtUHJvY2VzcyB8IFdoZXJlLU9iamVjdCB7ICRfLkNQVSAtZ3QgNTAgfSB8IFNvcnQtT2JqZWN0IC1Qcm9wZXJ0eSBDUFUgLURlc2NlbmRpbmcKJGhpZ2hDcHVQcm9jZXNzZXMgfCBTZWxlY3QtT2JqZWN0IC1Qcm9wZXJ0eSBOYW1lLCBDUFU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Optimized script to retrieve and sort processes by CPU usage
$highCpuProcesses = Get-Process | Where-Object { $_.CPU -gt 50 } | Sort-Object -Property CPU -Descending
$highCpuProcesses | Select-Object -Property Name, CPU</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li>The script uses <code>Get-Process</code> to retrieve all processes.</li>
<li><code>Where-Object</code> filters processes consuming more than 50% CPU.</li>
<li><code>Sort-Object</code> sorts the filtered processes by CPU usage in descending order.</li>
<li><code>Select-Object</code> selects the <code>Name</code> and <code>CPU</code> properties for display.</li>
</ul>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Overusing Pipelines</strong>: Avoid using too many pipeline stages as each stage adds overhead.</li>
<li><strong>Inefficient Data Structures</strong>: Use appropriate data structures like <code>ArrayList</code> for frequent additions.</li>
<li><strong>Unnecessary Object Creation</strong>: Limit the creation of objects to save memory and processing time.</li>
<li><strong>Not Profiling</strong>: Always profile your scripts to identify performance bottlenecks.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Performance optimization in PowerShell involves using efficient cmdlets, minimizing pipeline usage, avoiding unnecessary object creation, using proper data structures, and writing efficient loops and conditionals. Profiling and measuring performance are crucial to identify and address bottlenecks. By following these best practices, you can write PowerShell scripts that are both efficient and effective.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='09-01-readable-maintainable-code' title="Writing Readable and Maintainable Code">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-03-security-best-practices' title="Security Best Practices">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
