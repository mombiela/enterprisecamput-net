<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using Invoke-Command</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/using-invoke-command" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/using-invoke-command" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/using-invoke-command" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/using-invoke-command" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/using-invoke-command" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='configuring-remoting'>&#x25C4;Configuring Remoting</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Using Invoke-Command</a>
	</div>
	<div class='col-4 text-end'>
					<a href='automating-tasks-with-scheduled-jobs'>Automating Tasks with Scheduled Jobs &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Invoke-Command</h1>
<div class='content'><p>Invoke-Command is a powerful cmdlet in PowerShell that allows you to run commands on local and remote computers. This is particularly useful for managing multiple systems from a single point of control.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Cmdlet</strong>: A lightweight command used in the PowerShell environment.</li>
<li><strong>Remote Execution</strong>: Running commands on a different machine than the one you are currently using.</li>
<li><strong>Session</strong>: A persistent connection to a remote computer.</li>
</ul>
</div><h1>Basic Usage of Invoke-Command</h1>
<div class='content'><p>Invoke-Command can be used to run simple commands on local or remote computers.</p>
</div><h2>Running Commands Locally</h2>
<div class='content'><p>You can use Invoke-Command to run a command on your local machine.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLVNjcmlwdEJsb2NrIHsgR2V0LVByb2Nlc3MgfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ScriptBlock { Get-Process }</pre></div><div class='content'><ul>
<li><strong>-ScriptBlock</strong>: Defines the block of code to execute.</li>
<li><strong>Get-Process</strong>: A cmdlet that retrieves the processes running on the local machine.</li>
</ul>
</div><h2>Running Commands Remotely</h2>
<div class='content'><p>To run commands on a remote computer, you need to specify the computer name.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAiUmVtb3RlUEMiIC1TY3JpcHRCbG9jayB7IEdldC1Qcm9jZXNzIH0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName &quot;RemotePC&quot; -ScriptBlock { Get-Process }</pre></div><div class='content'><ul>
<li><strong>-ComputerName</strong>: Specifies the remote computer on which to run the command.</li>
</ul>
</div><h1>Advanced Usage of Invoke-Command</h1>
<div class='content'><p>Invoke-Command offers more advanced features such as running commands on multiple computers and using credentials.</p>
</div><h2>Running Commands on Multiple Computers</h2>
<div class='content'><p>You can run a command on multiple remote computers by specifying an array of computer names.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAiUmVtb3RlUEMxIiwgIlJlbW90ZVBDMiIgLVNjcmlwdEJsb2NrIHsgR2V0LVByb2Nlc3MgfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName &quot;RemotePC1&quot;, &quot;RemotePC2&quot; -ScriptBlock { Get-Process }</pre></div><div class='content'></div><h2>Using Credentials</h2>
<div class='content'><p>If the remote computer requires different credentials, you can use the -Credential parameter.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGNyZWQgPSBHZXQtQ3JlZGVudGlhbApJbnZva2UtQ29tbWFuZCAtQ29tcHV0ZXJOYW1lICJSZW1vdGVQQyIgLUNyZWRlbnRpYWwgJGNyZWQgLVNjcmlwdEJsb2NrIHsgR2V0LVByb2Nlc3MgfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$cred = Get-Credential
Invoke-Command -ComputerName &quot;RemotePC&quot; -Credential $cred -ScriptBlock { Get-Process }</pre></div><div class='content'><ul>
<li><strong>Get-Credential</strong>: Prompts for a username and password.</li>
<li><strong>-Credential</strong>: Specifies the user account to use when running the command.</li>
</ul>
</div><h2>Using Sessions</h2>
<div class='content'><p>For more complex scenarios, you can create a persistent session to a remote computer.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JHNlc3Npb24gPSBOZXctUFNTZXNzaW9uIC1Db21wdXRlck5hbWUgIlJlbW90ZVBDIgpJbnZva2UtQ29tbWFuZCAtU2Vzc2lvbiAkc2Vzc2lvbiAtU2NyaXB0QmxvY2sgeyBHZXQtUHJvY2VzcyB9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$session = New-PSSession -ComputerName &quot;RemotePC&quot;
Invoke-Command -Session $session -ScriptBlock { Get-Process }</pre></div><div class='content'><ul>
<li><strong>New-PSSession</strong>: Creates a new session to a remote computer.</li>
<li><strong>-Session</strong>: Specifies the session to use for the command.</li>
</ul>
</div><h1>Error Handling and Output</h1>
<div class='content'><p>Invoke-Command provides mechanisms for handling errors and capturing output.</p>
</div><h2>Capturing Output</h2>
<div class='content'><p>You can capture the output of the command into a variable.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JG91dHB1dCA9IEludm9rZS1Db21tYW5kIC1Db21wdXRlck5hbWUgIlJlbW90ZVBDIiAtU2NyaXB0QmxvY2sgeyBHZXQtUHJvY2VzcyB9CiRvdXRwdXQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$output = Invoke-Command -ComputerName &quot;RemotePC&quot; -ScriptBlock { Get-Process }
$output</pre></div><div class='content'></div><h2>Error Handling</h2>
<div class='content'><p>You can handle errors using try-catch blocks.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJ5IHsKICAgIEludm9rZS1Db21tYW5kIC1Db21wdXRlck5hbWUgIlJlbW90ZVBDIiAtU2NyaXB0QmxvY2sgeyBHZXQtUHJvY2VzcyB9Cn0gY2F0Y2ggewogICAgV3JpdGUtSG9zdCAiQW4gZXJyb3Igb2NjdXJyZWQ6ICRfIgp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>try {
    Invoke-Command -ComputerName &quot;RemotePC&quot; -ScriptBlock { Get-Process }
} catch {
    Write-Host &quot;An error occurred: $_&quot;
}</pre></div><div class='content'></div><h1>Summary</h1>
<div class='content'><p>Invoke-Command is a versatile cmdlet in PowerShell that allows you to run commands on local and remote computers. It supports running commands on multiple computers, using different credentials, and creating persistent sessions. By mastering Invoke-Command, you can efficiently manage multiple systems and automate complex tasks.</p>
</div><h2>Key Takeaways</h2>
<div class='content'><ul>
<li><strong>Invoke-Command</strong>: Run commands locally or remotely.</li>
<li><strong>-ScriptBlock</strong>: Define the code to execute.</li>
<li><strong>-ComputerName</strong>: Specify remote computers.</li>
<li><strong>-Credential</strong>: Use different user accounts.</li>
<li><strong>New-PSSession</strong>: Create persistent connections.</li>
<li><strong>Error Handling</strong>: Use try-catch for robust scripts.</li>
</ul>
<p>By understanding and utilizing these features, you can enhance your PowerShell scripting capabilities and streamline your administrative tasks.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='configuring-remoting'>&#x25C4;Configuring Remoting</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Using Invoke-Command</a>
	</div>
	<div class='col-4 text-end'>
					<a href='automating-tasks-with-scheduled-jobs'>Automating Tasks with Scheduled Jobs &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
