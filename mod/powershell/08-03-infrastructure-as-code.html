<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infrastructure as Code (IaC)</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/08-03-infrastructure-as-code" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/08-03-infrastructure-as-code" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/08-03-infrastructure-as-code" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/08-03-infrastructure-as-code" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/08-03-infrastructure-as-code" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='08-02-using-ci-cd-pipelines' title="Using PowerShell with CI/CD Pipelines">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Infrastructure as Code (IaC)</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='08-04-managing-cloud-resources' title="Managing Cloud Resources with PowerShell">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Infrastructure as Code (IaC) is a key practice in DevOps that involves managing and provisioning computing infrastructure through machine-readable definition files, rather than through physical hardware configuration or interactive configuration tools. This approach allows for automation, consistency, and scalability in managing infrastructure.</p>
</div><h1><p>Key Concepts of IaC</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Declarative vs. Imperative</strong>:</p>
<ul>
<li><strong>Declarative</strong>: You define the desired state of the infrastructure, and the IaC tool ensures that the infrastructure matches this state.</li>
<li><strong>Imperative</strong>: You define the specific commands needed to achieve the desired state.</li>
</ul>
</li>
<li>
<p><strong>Idempotency</strong>:</p>
<ul>
<li>Ensures that applying the same configuration multiple times results in the same state, preventing unintended changes.</li>
</ul>
</li>
<li>
<p><strong>Version Control</strong>:</p>
<ul>
<li>Infrastructure definitions are stored in version control systems (e.g., Git), allowing for tracking changes, collaboration, and rollback capabilities.</li>
</ul>
</li>
<li>
<p><strong>Automation</strong>:</p>
<ul>
<li>Automates the provisioning and management of infrastructure, reducing manual errors and increasing efficiency.</li>
</ul>
</li>
</ol>
</div><h1><p>PowerShell and IaC</p>
</h1>
<div class='content'><p>PowerShell can be used to implement IaC through various tools and frameworks, such as:</p>
<ul>
<li><strong>Azure Resource Manager (ARM) Templates</strong>: Declarative templates for deploying Azure resources.</li>
<li><strong>Terraform</strong>: An open-source tool for building, changing, and versioning infrastructure safely and efficiently.</li>
<li><strong>AWS CloudFormation</strong>: A service that helps you model and set up your Amazon Web Services resources.</li>
</ul>
</div><h2><p>Example: Using ARM Templates with PowerShell</p>
</h2>
<div class='content'><p>ARM templates are JSON files that define the resources you need to deploy for your solution. You can use PowerShell to deploy these templates to Azure.</p>
<h4>Step-by-Step Guide</h4>
<ol>
<li><strong>Create an ARM Template</strong>:
<ul>
<li>Create a JSON file named <code>azuredeploy.json</code> with the following content:</li>
</ul>
</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICIkc2NoZW1hIjogImh0dHBzOi8vc2NoZW1hLm1hbmFnZW1lbnQuYXp1cmUuY29tL3NjaGVtYXMvMjAxOS0wNC0wMS9kZXBsb3ltZW50VGVtcGxhdGUuanNvbiMiLAogICJjb250ZW50VmVyc2lvbiI6ICIxLjAuMC4wIiwKICAicmVzb3VyY2VzIjogWwogICAgewogICAgICAidHlwZSI6ICJNaWNyb3NvZnQuU3RvcmFnZS9zdG9yYWdlQWNjb3VudHMiLAogICAgICAiYXBpVmVyc2lvbiI6ICIyMDE5LTA0LTAxIiwKICAgICAgIm5hbWUiOiAibXlzdG9yYWdlYWNjb3VudCIsCiAgICAgICJsb2NhdGlvbiI6ICJXZXN0IFVTIiwKICAgICAgInNrdSI6IHsKICAgICAgICAibmFtZSI6ICJTdGFuZGFyZF9MUlMiCiAgICAgIH0sCiAgICAgICJraW5kIjogIlN0b3JhZ2VWMiIsCiAgICAgICJwcm9wZXJ0aWVzIjoge30KICAgIH0KICBdCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;$schema&quot;: &quot;https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#&quot;,
  &quot;contentVersion&quot;: &quot;1.0.0.0&quot;,
  &quot;resources&quot;: [
    {
      &quot;type&quot;: &quot;Microsoft.Storage/storageAccounts&quot;,
      &quot;apiVersion&quot;: &quot;2019-04-01&quot;,
      &quot;name&quot;: &quot;mystorageaccount&quot;,
      &quot;location&quot;: &quot;West US&quot;,
      &quot;sku&quot;: {
        &quot;name&quot;: &quot;Standard_LRS&quot;
      },
      &quot;kind&quot;: &quot;StorageV2&quot;,
      &quot;properties&quot;: {}
    }
  ]
}</pre></div><div class='content'><ol start="2">
<li><strong>Deploy the ARM Template using PowerShell</strong>:
<ul>
<li>Open PowerShell and run the following commands:</li>
</ul>
</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMb2dpbiB0byBBenVyZQpDb25uZWN0LUF6QWNjb3VudAoKIyBEZWZpbmUgdGhlIHJlc291cmNlIGdyb3VwIGFuZCB0ZW1wbGF0ZSBmaWxlCiRyZXNvdXJjZUdyb3VwTmFtZSA9ICJNeVJlc291cmNlR3JvdXAiCiR0ZW1wbGF0ZUZpbGUgPSAiQzpccGF0aFx0b1xhenVyZWRlcGxveS5qc29uIgoKIyBDcmVhdGUgdGhlIHJlc291cmNlIGdyb3VwCk5ldy1BelJlc291cmNlR3JvdXAgLU5hbWUgJHJlc291cmNlR3JvdXBOYW1lIC1Mb2NhdGlvbiAiV2VzdCBVUyIKCiMgRGVwbG95IHRoZSB0ZW1wbGF0ZQpOZXctQXpSZXNvdXJjZUdyb3VwRGVwbG95bWVudCAtUmVzb3VyY2VHcm91cE5hbWUgJHJlc291cmNlR3JvdXBOYW1lIC1UZW1wbGF0ZUZpbGUgJHRlbXBsYXRlRmlsZQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Login to Azure
Connect-AzAccount

# Define the resource group and template file
$resourceGroupName = &quot;MyResourceGroup&quot;
$templateFile = &quot;C:\path\to\azuredeploy.json&quot;

# Create the resource group
New-AzResourceGroup -Name $resourceGroupName -Location &quot;West US&quot;

# Deploy the template
New-AzResourceGroupDeployment -ResourceGroupName $resourceGroupName -TemplateFile $templateFile</pre></div><div class='content'><h4>Explanation</h4>
<ul>
<li><code>Connect-AzAccount</code>: Authenticates your PowerShell session with Azure.</li>
<li><code>New-AzResourceGroup</code>: Creates a new resource group in Azure.</li>
<li><code>New-AzResourceGroupDeployment</code>: Deploys the ARM template to the specified resource group.</li>
</ul>
</div><h2><p>Practical Exercise</p>
</h2>
<div class='content'><p><strong>Exercise</strong>: Create and deploy an ARM template that provisions an Azure Virtual Network.</p>
<ol>
<li><strong>Create the ARM Template</strong>:
<ul>
<li>Save the following JSON content to a file named <code>vnetdeploy.json</code>:</li>
</ul>
</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICIkc2NoZW1hIjogImh0dHBzOi8vc2NoZW1hLm1hbmFnZW1lbnQuYXp1cmUuY29tL3NjaGVtYXMvMjAxOS0wNC0wMS9kZXBsb3ltZW50VGVtcGxhdGUuanNvbiMiLAogICJjb250ZW50VmVyc2lvbiI6ICIxLjAuMC4wIiwKICAicmVzb3VyY2VzIjogWwogICAgewogICAgICAidHlwZSI6ICJNaWNyb3NvZnQuTmV0d29yay92aXJ0dWFsTmV0d29ya3MiLAogICAgICAiYXBpVmVyc2lvbiI6ICIyMDE5LTA0LTAxIiwKICAgICAgIm5hbWUiOiAibXlWbmV0IiwKICAgICAgImxvY2F0aW9uIjogIldlc3QgVVMiLAogICAgICAicHJvcGVydGllcyI6IHsKICAgICAgICAiYWRkcmVzc1NwYWNlIjogewogICAgICAgICAgImFkZHJlc3NQcmVmaXhlcyI6IFsKICAgICAgICAgICAgIjEwLjAuMC4wLzE2IgogICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgInN1Ym5ldHMiOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgICJuYW1lIjogImRlZmF1bHQiLAogICAgICAgICAgICAicHJvcGVydGllcyI6IHsKICAgICAgICAgICAgICAiYWRkcmVzc1ByZWZpeCI6ICIxMC4wLjAuMC8yNCIKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIF0KICAgICAgfQogICAgfQogIF0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;$schema&quot;: &quot;https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#&quot;,
  &quot;contentVersion&quot;: &quot;1.0.0.0&quot;,
  &quot;resources&quot;: [
    {
      &quot;type&quot;: &quot;Microsoft.Network/virtualNetworks&quot;,
      &quot;apiVersion&quot;: &quot;2019-04-01&quot;,
      &quot;name&quot;: &quot;myVnet&quot;,
      &quot;location&quot;: &quot;West US&quot;,
      &quot;properties&quot;: {
        &quot;addressSpace&quot;: {
          &quot;addressPrefixes&quot;: [
            &quot;10.0.0.0/16&quot;
          ]
        },
        &quot;subnets&quot;: [
          {
            &quot;name&quot;: &quot;default&quot;,
            &quot;properties&quot;: {
              &quot;addressPrefix&quot;: &quot;10.0.0.0/24&quot;
            }
          }
        ]
      }
    }
  ]
}</pre></div><div class='content'><ol start="2">
<li><strong>Deploy the Template</strong>:
<ul>
<li>Use the following PowerShell script to deploy the template:</li>
</ul>
</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMb2dpbiB0byBBenVyZQpDb25uZWN0LUF6QWNjb3VudAoKIyBEZWZpbmUgdGhlIHJlc291cmNlIGdyb3VwIGFuZCB0ZW1wbGF0ZSBmaWxlCiRyZXNvdXJjZUdyb3VwTmFtZSA9ICJNeVZuZXRSZXNvdXJjZUdyb3VwIgokdGVtcGxhdGVGaWxlID0gIkM6XHBhdGhcdG9cdm5ldGRlcGxveS5qc29uIgoKIyBDcmVhdGUgdGhlIHJlc291cmNlIGdyb3VwCk5ldy1BelJlc291cmNlR3JvdXAgLU5hbWUgJHJlc291cmNlR3JvdXBOYW1lIC1Mb2NhdGlvbiAiV2VzdCBVUyIKCiMgRGVwbG95IHRoZSB0ZW1wbGF0ZQpOZXctQXpSZXNvdXJjZUdyb3VwRGVwbG95bWVudCAtUmVzb3VyY2VHcm91cE5hbWUgJHJlc291cmNlR3JvdXBOYW1lIC1UZW1wbGF0ZUZpbGUgJHRlbXBsYXRlRmlsZQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Login to Azure
Connect-AzAccount

# Define the resource group and template file
$resourceGroupName = &quot;MyVnetResourceGroup&quot;
$templateFile = &quot;C:\path\to\vnetdeploy.json&quot;

# Create the resource group
New-AzResourceGroup -Name $resourceGroupName -Location &quot;West US&quot;

# Deploy the template
New-AzResourceGroupDeployment -ResourceGroupName $resourceGroupName -TemplateFile $templateFile</pre></div><div class='content'></div><h2><p>Solution</p>
</h2>
<div class='content'><ul>
<li>Ensure the JSON file is correctly formatted and saved.</li>
<li>Run the PowerShell script to deploy the virtual network.</li>
</ul>
</div><h2><p>Common Mistakes and Tips</p>
</h2>
<div class='content'><ul>
<li><strong>Common Mistake</strong>: Incorrect JSON syntax in the ARM template.
<ul>
<li><strong>Tip</strong>: Use a JSON validator to check the syntax before deploying.</li>
</ul>
</li>
<li><strong>Common Mistake</strong>: Incorrect resource group name or location.
<ul>
<li><strong>Tip</strong>: Double-check the resource group name and location parameters.</li>
</ul>
</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, you learned about the concept of Infrastructure as Code (IaC) and how to use PowerShell to deploy infrastructure using ARM templates. This approach allows for automated, consistent, and scalable management of your infrastructure. In the next section, we will explore how to use PowerShell with CI/CD pipelines to further enhance your DevOps practices.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='08-02-using-ci-cd-pipelines' title="Using PowerShell with CI/CD Pipelines">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='08-04-managing-cloud-resources' title="Managing Cloud Resources with PowerShell">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
