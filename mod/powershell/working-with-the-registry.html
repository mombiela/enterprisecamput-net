<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Working with the Registry</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/working-with-the-registry" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/working-with-the-registry" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/working-with-the-registry" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/working-with-the-registry" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/working-with-the-registry" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='managing-processes'>&#x25C4;Managing Processes</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Working with the Registry</a>
	</div>
	<div class='col-4 text-end'>
					<a href='event-logs'>Event Logs &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>The Windows Registry is a hierarchical database that stores configuration settings and options for the operating system and installed applications. PowerShell provides a robust set of cmdlets to interact with the registry, making it easier to automate tasks related to system configuration.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Registry Hive</strong>: The top-level sections of the registry, such as <code>HKEY_LOCAL_MACHINE</code> (HKLM) and <code>HKEY_CURRENT_USER</code> (HKCU).</li>
<li><strong>Registry Key</strong>: A node in the registry that can contain subkeys and values.</li>
<li><strong>Registry Value</strong>: The data stored within a key, which can be of different types like <code>String</code>, <code>Binary</code>, <code>DWORD</code>, etc.</li>
</ul>
</div><h1>Accessing the Registry</h1>
<div class='content'><p>PowerShell uses a provider model to access the registry. The <code>Registry</code> provider allows you to navigate the registry like a file system.</p>
</div><h2>Navigating the Registry</h2>
<div class='content'><p>You can use <code>Get-ChildItem</code> (alias <code>ls</code> or <code>dir</code>) to list keys and <code>Set-Location</code> (alias <code>cd</code>) to change the current location.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMaXN0IGFsbCBzdWJrZXlzIHVuZGVyIEhLRVlfTE9DQUxfTUFDSElORVxTb2Z0d2FyZQpHZXQtQ2hpbGRJdGVtIC1QYXRoICJIS0xNOlxTb2Z0d2FyZSIKCiMgQ2hhbmdlIGxvY2F0aW9uIHRvIEhLRVlfQ1VSUkVOVF9VU0VSXFNvZnR3YXJlClNldC1Mb2NhdGlvbiAtUGF0aCAiSEtDVTpcU29mdHdhcmUi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># List all subkeys under HKEY_LOCAL_MACHINE\Software
Get-ChildItem -Path &quot;HKLM:\Software&quot;

# Change location to HKEY_CURRENT_USER\Software
Set-Location -Path &quot;HKCU:\Software&quot;</pre></div><div class='content'></div><h2>Creating and Deleting Keys</h2>
<div class='content'><p>You can create new keys using <code>New-Item</code> and delete them using <code>Remove-Item</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcga2V5IHVuZGVyIEhLRVlfQ1VSUkVOVF9VU0VSXFNvZnR3YXJlCk5ldy1JdGVtIC1QYXRoICJIS0NVOlxTb2Z0d2FyZVxNeUFwcCIKCiMgRGVsZXRlIHRoZSBrZXkKUmVtb3ZlLUl0ZW0gLVBhdGggIkhLQ1U6XFNvZnR3YXJlXE15QXBwIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new key under HKEY_CURRENT_USER\Software
New-Item -Path &quot;HKCU:\Software\MyApp&quot;

# Delete the key
Remove-Item -Path &quot;HKCU:\Software\MyApp&quot;</pre></div><div class='content'></div><h2>Reading and Writing Values</h2>
<div class='content'><p>Use <code>Get-ItemProperty</code> to read values and <code>Set-ItemProperty</code> to write values.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSZWFkIGEgdmFsdWUgZnJvbSB0aGUgcmVnaXN0cnkKJHJlZ1ZhbHVlID0gR2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiSEtDVTpcU29mdHdhcmVcTXlBcHAiIC1OYW1lICJNeVZhbHVlIgpXcml0ZS1PdXRwdXQgJHJlZ1ZhbHVlLk15VmFsdWUKCiMgV3JpdGUgYSB2YWx1ZSB0byB0aGUgcmVnaXN0cnkKU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiSEtDVTpcU29mdHdhcmVcTXlBcHAiIC1OYW1lICJNeVZhbHVlIiAtVmFsdWUgIk5ld1ZhbHVlIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Read a value from the registry
$regValue = Get-ItemProperty -Path &quot;HKCU:\Software\MyApp&quot; -Name &quot;MyValue&quot;
Write-Output $regValue.MyValue

# Write a value to the registry
Set-ItemProperty -Path &quot;HKCU:\Software\MyApp&quot; -Name &quot;MyValue&quot; -Value &quot;NewValue&quot;</pre></div><div class='content'></div><h1>Advanced Operations</h1>
<h2>Exporting and Importing Registry Keys</h2>
<div class='content'><p>You can export and import registry keys using <code>reg.exe</code> command-line utility within PowerShell.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeHBvcnQgYSByZWdpc3RyeSBrZXkgdG8gYSBmaWxlCnJlZyBleHBvcnQgIkhLQ1VcU29mdHdhcmVcTXlBcHAiICJDOlxCYWNrdXBcTXlBcHAucmVnIgoKIyBJbXBvcnQgYSByZWdpc3RyeSBrZXkgZnJvbSBhIGZpbGUKcmVnIGltcG9ydCAiQzpcQmFja3VwXE15QXBwLnJlZyI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Export a registry key to a file
reg export &quot;HKCU\Software\MyApp&quot; &quot;C:\Backup\MyApp.reg&quot;

# Import a registry key from a file
reg import &quot;C:\Backup\MyApp.reg&quot;</pre></div><div class='content'></div><h2>Handling Different Value Types</h2>
<div class='content'><p>The registry supports various data types. Here’s how to handle some common types:</p>
<ul>
<li><strong>String (<code>REG_SZ</code>)</strong>: Simple text value.</li>
<li><strong>Binary (<code>REG_BINARY</code>)</strong>: Binary data.</li>
<li><strong>DWORD (<code>REG_DWORD</code>)</strong>: 32-bit integer.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTZXQgYSBTdHJpbmcgdmFsdWUKU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiSEtDVTpcU29mdHdhcmVcTXlBcHAiIC1OYW1lICJNeVN0cmluZyIgLVZhbHVlICJIZWxsbyIKCiMgU2V0IGEgRFdPUkQgdmFsdWUKU2V0LUl0ZW1Qcm9wZXJ0eSAtUGF0aCAiSEtDVTpcU29mdHdhcmVcTXlBcHAiIC1OYW1lICJNeURXT1JEIiAtVmFsdWUgMSAtVHlwZSBEV29yZAoKIyBTZXQgYSBCaW5hcnkgdmFsdWUKJGJpbmFyeURhdGEgPSBbYnl0ZVtdXSgxLCAyLCAzLCA0KQpTZXQtSXRlbVByb3BlcnR5IC1QYXRoICJIS0NVOlxTb2Z0d2FyZVxNeUFwcCIgLU5hbWUgIk15QmluYXJ5IiAtVmFsdWUgJGJpbmFyeURhdGEgLVR5cGUgQmluYXJ5"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Set a String value
Set-ItemProperty -Path &quot;HKCU:\Software\MyApp&quot; -Name &quot;MyString&quot; -Value &quot;Hello&quot;

# Set a DWORD value
Set-ItemProperty -Path &quot;HKCU:\Software\MyApp&quot; -Name &quot;MyDWORD&quot; -Value 1 -Type DWord

# Set a Binary value
$binaryData = [byte[]](1, 2, 3, 4)
Set-ItemProperty -Path &quot;HKCU:\Software\MyApp&quot; -Name &quot;MyBinary&quot; -Value $binaryData -Type Binary</pre></div><div class='content'></div><h1>Summary</h1>
<div class='content'><p>In this topic, we covered the basics of working with the Windows Registry using PowerShell. We learned how to navigate the registry, create and delete keys, read and write values, and handle different value types. These skills are essential for automating system configuration tasks and managing application settings.</p>
<p>By mastering these techniques, you can efficiently manage the registry and leverage PowerShell's capabilities to streamline your workflows.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='managing-processes'>&#x25C4;Managing Processes</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Working with the Registry</a>
	</div>
	<div class='col-4 text-end'>
					<a href='event-logs'>Event Logs &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
