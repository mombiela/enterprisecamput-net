<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automating Active Directory Tasks</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/05-04-automating-active-directory" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/05-04-automating-active-directory" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/05-04-automating-active-directory" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/05-04-automating-active-directory" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/05-04-automating-active-directory" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-03-system-administration' title="Using PowerShell for System Administration">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Automating Active Directory Tasks</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-05-automating-network-tasks' title="Automating Network Tasks">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to use PowerShell to automate tasks related to Active Directory (AD). Automating AD tasks can save time, reduce errors, and ensure consistency across your environment. We will cover the following topics:</p>
<ol>
<li><strong>Introduction to Active Directory Automation</strong></li>
<li><strong>Connecting to Active Directory</strong></li>
<li><strong>Managing Users</strong></li>
<li><strong>Managing Groups</strong></li>
<li><strong>Managing Organizational Units (OUs)</strong></li>
<li><strong>Practical Exercises</strong></li>
</ol>
</div><h1>1. Introduction to Active Directory Automation</h1>
<div class='content'><p>Active Directory (AD) is a directory service developed by Microsoft for Windows domain networks. It is used for managing permissions and access to network resources. PowerShell provides a set of cmdlets specifically designed for interacting with AD, which are part of the Active Directory module.</p>
</div><h2>Key Concepts:</h2>
<div class='content'><ul>
<li><strong>Cmdlets</strong>: PowerShell commands designed to perform specific tasks.</li>
<li><strong>Active Directory Module</strong>: A PowerShell module that includes cmdlets for managing AD.</li>
</ul>
</div><h1>2. Connecting to Active Directory</h1>
<div class='content'><p>Before performing any AD tasks, you need to import the Active Directory module and establish a connection to your AD environment.</p>
</div><h2>Example:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbXBvcnQgdGhlIEFjdGl2ZSBEaXJlY3RvcnkgbW9kdWxlCkltcG9ydC1Nb2R1bGUgQWN0aXZlRGlyZWN0b3J5CgojIFZlcmlmeSB0aGUgbW9kdWxlIGlzIGltcG9ydGVkCkdldC1Nb2R1bGUgLU5hbWUgQWN0aXZlRGlyZWN0b3J5"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Import the Active Directory module
Import-Module ActiveDirectory

# Verify the module is imported
Get-Module -Name ActiveDirectory</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><code>Import-Module ActiveDirectory</code>: Loads the Active Directory module into your PowerShell session.</li>
<li><code>Get-Module -Name ActiveDirectory</code>: Confirms that the module is loaded.</li>
</ul>
</div><h1>3. Managing Users</h1>
<div class='content'></div><h2>Creating a New User:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcgdXNlciBpbiBBY3RpdmUgRGlyZWN0b3J5Ck5ldy1BRFVzZXIgLU5hbWUgIkpvaG4gRG9lIiAtR2l2ZW5OYW1lICJKb2huIiAtU3VybmFtZSAiRG9lIiAtU2FtQWNjb3VudE5hbWUgImpkb2UiIC1Vc2VyUHJpbmNpcGFsTmFtZSAiamRvZUBkb21haW4uY29tIiAtUGF0aCAiT1U9VXNlcnMsREM9ZG9tYWluLERDPWNvbSIgLUFjY291bnRQYXNzd29yZCAoQ29udmVydFRvLVNlY3VyZVN0cmluZyAiUEBzc3cwcmQiIC1Bc1BsYWluVGV4dCAtRm9yY2UpIC1FbmFibGVkICR0cnVl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new user in Active Directory
New-ADUser -Name &quot;John Doe&quot; -GivenName &quot;John&quot; -Surname &quot;Doe&quot; -SamAccountName &quot;jdoe&quot; -UserPrincipalName &quot;jdoe@domain.com&quot; -Path &quot;OU=Users,DC=domain,DC=com&quot; -AccountPassword (ConvertTo-SecureString &quot;P@ssw0rd&quot; -AsPlainText -Force) -Enabled $true</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><code>New-ADUser</code>: Cmdlet to create a new AD user.</li>
<li><code>-Name</code>: Full name of the user.</li>
<li><code>-GivenName</code>: First name of the user.</li>
<li><code>-Surname</code>: Last name of the user.</li>
<li><code>-SamAccountName</code>: User's logon name.</li>
<li><code>-UserPrincipalName</code>: User's principal name (email).</li>
<li><code>-Path</code>: The OU where the user will be created.</li>
<li><code>-AccountPassword</code>: Sets the user's password.</li>
<li><code>-Enabled</code>: Enables the user account.</li>
</ul>
</div><h2>Modifying an Existing User:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBNb2RpZnkgYW4gZXhpc3RpbmcgdXNlcgpTZXQtQURVc2VyIC1JZGVudGl0eSAiamRvZSIgLVRpdGxlICJTZW5pb3IgRGV2ZWxvcGVyIiAtRGVwYXJ0bWVudCAiSVQi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Modify an existing user
Set-ADUser -Identity &quot;jdoe&quot; -Title &quot;Senior Developer&quot; -Department &quot;IT&quot;</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><code>Set-ADUser</code>: Cmdlet to modify an existing AD user.</li>
<li><code>-Identity</code>: Specifies the user to modify.</li>
<li><code>-Title</code>: Sets the user's job title.</li>
<li><code>-Department</code>: Sets the user's department.</li>
</ul>
</div><h1>4. Managing Groups</h1>
<div class='content'></div><h2>Creating a New Group:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcgZ3JvdXAgaW4gQWN0aXZlIERpcmVjdG9yeQpOZXctQURHcm91cCAtTmFtZSAiRGV2ZWxvcGVycyIgLUdyb3VwU2NvcGUgR2xvYmFsIC1Hcm91cENhdGVnb3J5IFNlY3VyaXR5IC1QYXRoICJPVT1Hcm91cHMsREM9ZG9tYWluLERDPWNvbSI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new group in Active Directory
New-ADGroup -Name &quot;Developers&quot; -GroupScope Global -GroupCategory Security -Path &quot;OU=Groups,DC=domain,DC=com&quot;</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><code>New-ADGroup</code>: Cmdlet to create a new AD group.</li>
<li><code>-Name</code>: Name of the group.</li>
<li><code>-GroupScope</code>: Scope of the group (Global, DomainLocal, Universal).</li>
<li><code>-GroupCategory</code>: Category of the group (Security, Distribution).</li>
<li><code>-Path</code>: The OU where the group will be created.</li>
</ul>
</div><h2>Adding a User to a Group:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBBZGQgYSB1c2VyIHRvIGEgZ3JvdXAKQWRkLUFER3JvdXBNZW1iZXIgLUlkZW50aXR5ICJEZXZlbG9wZXJzIiAtTWVtYmVycyAiamRvZSI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Add a user to a group
Add-ADGroupMember -Identity &quot;Developers&quot; -Members &quot;jdoe&quot;</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><code>Add-ADGroupMember</code>: Cmdlet to add members to a group.</li>
<li><code>-Identity</code>: Specifies the group.</li>
<li><code>-Members</code>: Specifies the users to add.</li>
</ul>
</div><h1>5. Managing Organizational Units (OUs)</h1>
<div class='content'></div><h2>Creating a New OU:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcgT3JnYW5pemF0aW9uYWwgVW5pdApOZXctQURPcmdhbml6YXRpb25hbFVuaXQgLU5hbWUgIkhSIiAtUGF0aCAiREM9ZG9tYWluLERDPWNvbSI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new Organizational Unit
New-ADOrganizationalUnit -Name &quot;HR&quot; -Path &quot;DC=domain,DC=com&quot;</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><code>New-ADOrganizationalUnit</code>: Cmdlet to create a new OU.</li>
<li><code>-Name</code>: Name of the OU.</li>
<li><code>-Path</code>: The path where the OU will be created.</li>
</ul>
</div><h2>Moving an Object to a Different OU:</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBNb3ZlIGEgdXNlciB0byBhIGRpZmZlcmVudCBPVQpNb3ZlLUFET2JqZWN0IC1JZGVudGl0eSAiQ049Sm9obiBEb2UsT1U9VXNlcnMsREM9ZG9tYWluLERDPWNvbSIgLVRhcmdldFBhdGggIk9VPUhSLERDPWRvbWFpbixEQz1jb20i"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Move a user to a different OU
Move-ADObject -Identity &quot;CN=John Doe,OU=Users,DC=domain,DC=com&quot; -TargetPath &quot;OU=HR,DC=domain,DC=com&quot;</pre></div><div class='content'></div><h2>Explanation:</h2>
<div class='content'><ul>
<li><code>Move-ADObject</code>: Cmdlet to move an AD object.</li>
<li><code>-Identity</code>: Specifies the object to move.</li>
<li><code>-TargetPath</code>: Specifies the destination OU.</li>
</ul>
</div><h1>6. Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Create a New User and Add to a Group</h2>
<div class='content'><ol>
<li>Create a new user named &quot;Jane Smith&quot; with the username &quot;jsmith&quot;.</li>
<li>Add &quot;Jane Smith&quot; to the &quot;Developers&quot; group.</li>
</ol>
<h4>Solution:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcgdXNlcgpOZXctQURVc2VyIC1OYW1lICJKYW5lIFNtaXRoIiAtR2l2ZW5OYW1lICJKYW5lIiAtU3VybmFtZSAiU21pdGgiIC1TYW1BY2NvdW50TmFtZSAianNtaXRoIiAtVXNlclByaW5jaXBhbE5hbWUgImpzbWl0aEBkb21haW4uY29tIiAtUGF0aCAiT1U9VXNlcnMsREM9ZG9tYWluLERDPWNvbSIgLUFjY291bnRQYXNzd29yZCAoQ29udmVydFRvLVNlY3VyZVN0cmluZyAiUEBzc3cwcmQiIC1Bc1BsYWluVGV4dCAtRm9yY2UpIC1FbmFibGVkICR0cnVlCgojIEFkZCB0aGUgdXNlciB0byB0aGUgRGV2ZWxvcGVycyBncm91cApBZGQtQURHcm91cE1lbWJlciAtSWRlbnRpdHkgIkRldmVsb3BlcnMiIC1NZW1iZXJzICJqc21pdGgi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new user
New-ADUser -Name &quot;Jane Smith&quot; -GivenName &quot;Jane&quot; -Surname &quot;Smith&quot; -SamAccountName &quot;jsmith&quot; -UserPrincipalName &quot;jsmith@domain.com&quot; -Path &quot;OU=Users,DC=domain,DC=com&quot; -AccountPassword (ConvertTo-SecureString &quot;P@ssw0rd&quot; -AsPlainText -Force) -Enabled $true

# Add the user to the Developers group
Add-ADGroupMember -Identity &quot;Developers&quot; -Members &quot;jsmith&quot;</pre></div><div class='content'></div><h2>Exercise 2: Create a New OU and Move a User</h2>
<div class='content'><ol>
<li>Create a new OU named &quot;Finance&quot;.</li>
<li>Move the user &quot;John Doe&quot; to the &quot;Finance&quot; OU.</li>
</ol>
<h4>Solution:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcgT1UKTmV3LUFET3JnYW5pemF0aW9uYWxVbml0IC1OYW1lICJGaW5hbmNlIiAtUGF0aCAiREM9ZG9tYWluLERDPWNvbSIKCiMgTW92ZSB0aGUgdXNlciB0byB0aGUgRmluYW5jZSBPVQpNb3ZlLUFET2JqZWN0IC1JZGVudGl0eSAiQ049Sm9obiBEb2UsT1U9VXNlcnMsREM9ZG9tYWluLERDPWNvbSIgLVRhcmdldFBhdGggIk9VPUZpbmFuY2UsREM9ZG9tYWluLERDPWNvbSI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new OU
New-ADOrganizationalUnit -Name &quot;Finance&quot; -Path &quot;DC=domain,DC=com&quot;

# Move the user to the Finance OU
Move-ADObject -Identity &quot;CN=John Doe,OU=Users,DC=domain,DC=com&quot; -TargetPath &quot;OU=Finance,DC=domain,DC=com&quot;</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the basics of automating Active Directory tasks using PowerShell. We learned how to connect to AD, manage users, groups, and organizational units, and performed practical exercises to reinforce these concepts. Automating AD tasks with PowerShell can greatly enhance your efficiency and ensure consistency in your environment. In the next module, we will explore PowerShell remoting, which allows you to manage remote systems using PowerShell.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-03-system-administration' title="Using PowerShell for System Administration">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-05-automating-network-tasks' title="Automating Network Tasks">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
