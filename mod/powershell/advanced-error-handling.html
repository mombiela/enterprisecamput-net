<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Error Handling</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/advanced-error-handling" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/advanced-error-handling" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/advanced-error-handling" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/advanced-error-handling" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/advanced-error-handling" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='using-dotnet-classes'>&#x25C4;Using .NET Classes</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Advanced Error Handling</a>
	</div>
	<div class='col-4 text-end'>
					<a href='managing-processes'>Managing Processes &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this section, we will delve into advanced error handling techniques in PowerShell. Proper error handling is crucial for creating robust and reliable scripts. We will cover various methods to handle errors, including try/catch blocks, error variables, and custom error messages.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Error Types</strong>: Understanding the difference between terminating and non-terminating errors.</li>
<li><strong>Try/Catch/Finally</strong>: Using try/catch/finally blocks to manage errors.</li>
<li><strong>Error Variables</strong>: Utilizing <code>$Error</code>, <code>$?</code>, and <code>$LASTEXITCODE</code> to capture and analyze errors.</li>
<li><strong>Custom Error Messages</strong>: Creating and throwing custom error messages.</li>
<li><strong>ErrorAction Parameter</strong>: Controlling error behavior with the <code>-ErrorAction</code> parameter.</li>
<li><strong>Error Handling Functions</strong>: Writing functions to handle errors more effectively.</li>
</ul>
</div><h1>Error Types</h1>
<div class='content'></div><h2>Terminating Errors</h2>
<div class='content'><p>Terminating errors stop the execution of a script. They can be caught and handled using try/catch blocks.</p>
</div><h2>Non-Terminating Errors</h2>
<div class='content'><p>Non-terminating errors do not stop script execution. They are typically logged and can be controlled using the <code>-ErrorAction</code> parameter.</p>
</div><h1>Try/Catch/Finally</h1>
<div class='content'></div><h2>Syntax and Usage</h2>
<div class='content'><p>The try/catch/finally construct allows you to handle errors gracefully.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJ5IHsKICAgICMgQ29kZSB0aGF0IG1heSBjYXVzZSBhbiBlcnJvcgogICAgR2V0LUl0ZW0gIkM6XE5vbkV4aXN0ZW50RmlsZS50eHQiCn0gY2F0Y2ggewogICAgIyBDb2RlIHRvIGhhbmRsZSB0aGUgZXJyb3IKICAgIFdyaXRlLUhvc3QgIkFuIGVycm9yIG9jY3VycmVkOiAkXyIKfSBmaW5hbGx5IHsKICAgICMgQ29kZSB0aGF0IHJ1bnMgcmVnYXJkbGVzcyBvZiBhbiBlcnJvcgogICAgV3JpdGUtSG9zdCAiRXhlY3V0aW9uIGNvbXBsZXRlZC4iCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>try {
    # Code that may cause an error
    Get-Item &quot;C:\NonExistentFile.txt&quot;
} catch {
    # Code to handle the error
    Write-Host &quot;An error occurred: $_&quot;
} finally {
    # Code that runs regardless of an error
    Write-Host &quot;Execution completed.&quot;
}</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>try</strong>: Contains the code that might throw an error.</li>
<li><strong>catch</strong>: Contains the code to handle the error.</li>
<li><strong>finally</strong>: Contains the code that will run regardless of whether an error occurred or not.</li>
</ul>
</div><h1>Error Variables</h1>
<div class='content'></div><h2>`$Error`</h2>
<div class='content'><p>The <code>$Error</code> variable is an array that stores error objects. The most recent error is at index 0.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUl0ZW0gIkM6XE5vbkV4aXN0ZW50RmlsZS50eHQiCldyaXRlLUhvc3QgIkxhc3QgZXJyb3I6ICQoJEVycm9yWzBdKSI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-Item &quot;C:\NonExistentFile.txt&quot;
Write-Host &quot;Last error: $($Error[0])&quot;</pre></div><div class='content'></div><h2>`$?`</h2>
<div class='content'><p>The <code>$?</code> variable indicates whether the last command was successful (<code>True</code>) or not (<code>False</code>).</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUl0ZW0gIkM6XE5vbkV4aXN0ZW50RmlsZS50eHQiCmlmICgkPykgewogICAgV3JpdGUtSG9zdCAiQ29tbWFuZCBzdWNjZWVkZWQuIgp9IGVsc2UgewogICAgV3JpdGUtSG9zdCAiQ29tbWFuZCBmYWlsZWQuIgp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-Item &quot;C:\NonExistentFile.txt&quot;
if ($?) {
    Write-Host &quot;Command succeeded.&quot;
} else {
    Write-Host &quot;Command failed.&quot;
}</pre></div><div class='content'></div><h2>`$LASTEXITCODE`</h2>
<div class='content'><p>The <code>$LASTEXITCODE</code> variable holds the exit code of the last Windows-based program that was run.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y21kIC9jIGV4aXQgMQpXcml0ZS1Ib3N0ICJMYXN0IGV4aXQgY29kZTogJExBU1RFWElUQ09ERSI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>cmd /c exit 1
Write-Host &quot;Last exit code: $LASTEXITCODE&quot;</pre></div><div class='content'></div><h1>Custom Error Messages</h1>
<div class='content'></div><h2>Throwing Custom Errors</h2>
<div class='content'><p>You can throw custom errors using the <code>throw</code> keyword.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gVGVzdC1FcnJvciB7CiAgICBwYXJhbSAoJHZhbHVlKQogICAgaWYgKCR2YWx1ZSAtbHQgMCkgewogICAgICAgIHRocm93ICJWYWx1ZSBjYW5ub3QgYmUgbmVnYXRpdmUuIgogICAgfQogICAgV3JpdGUtSG9zdCAiVmFsdWUgaXMgJHZhbHVlIgp9Cgp0cnkgewogICAgVGVzdC1FcnJvciAtdmFsdWUgLTEKfSBjYXRjaCB7CiAgICBXcml0ZS1Ib3N0ICJDYXVnaHQgYW4gZXJyb3I6ICRfIgp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function Test-Error {
    param ($value)
    if ($value -lt 0) {
        throw &quot;Value cannot be negative.&quot;
    }
    Write-Host &quot;Value is $value&quot;
}

try {
    Test-Error -value -1
} catch {
    Write-Host &quot;Caught an error: $_&quot;
}</pre></div><div class='content'></div><h1>ErrorAction Parameter</h1>
<div class='content'></div><h2>Controlling Error Behavior</h2>
<div class='content'><p>The <code>-ErrorAction</code> parameter allows you to specify how PowerShell responds to non-terminating errors.</p>
<ul>
<li><strong>Continue</strong>: Default behavior, continues execution.</li>
<li><strong>Stop</strong>: Treats the error as terminating.</li>
<li><strong>SilentlyContinue</strong>: Suppresses the error message.</li>
<li><strong>Inquire</strong>: Prompts the user for input.</li>
<li><strong>Ignore</strong>: Ignores the error completely.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LUl0ZW0gIkM6XE5vbkV4aXN0ZW50RmlsZS50eHQiIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-Item &quot;C:\NonExistentFile.txt&quot; -ErrorAction SilentlyContinue</pre></div><div class='content'></div><h1>Error Handling Functions</h1>
<div class='content'></div><h2>Example Function</h2>
<div class='content'><p>Creating a function to handle errors can make your scripts more modular and reusable.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gSW52b2tlLVNhZmVDb21tYW5kIHsKICAgIHBhcmFtICgKICAgICAgICBbc2NyaXB0YmxvY2tdJENvbW1hbmQKICAgICkKICAgIHRyeSB7CiAgICAgICAgJiAkQ29tbWFuZAogICAgfSBjYXRjaCB7CiAgICAgICAgV3JpdGUtSG9zdCAiQW4gZXJyb3Igb2NjdXJyZWQ6ICRfIgogICAgfQp9CgpJbnZva2UtU2FmZUNvbW1hbmQgLUNvbW1hbmQgeyBHZXQtSXRlbSAiQzpcTm9uRXhpc3RlbnRGaWxlLnR4dCIgfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function Invoke-SafeCommand {
    param (
        [scriptblock]$Command
    )
    try {
        &amp; $Command
    } catch {
        Write-Host &quot;An error occurred: $_&quot;
    }
}

Invoke-SafeCommand -Command { Get-Item &quot;C:\NonExistentFile.txt&quot; }</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Advanced error handling in PowerShell is essential for creating reliable and maintainable scripts. By understanding and utilizing try/catch/finally blocks, error variables, custom error messages, and the <code>-ErrorAction</code> parameter, you can effectively manage errors and ensure your scripts run smoothly. Practice these techniques to become proficient in handling errors in PowerShell.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='using-dotnet-classes'>&#x25C4;Using .NET Classes</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Advanced Error Handling</a>
	</div>
	<div class='col-4 text-end'>
					<a href='managing-processes'>Managing Processes &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
