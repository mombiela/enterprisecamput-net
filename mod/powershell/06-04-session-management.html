<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Session Management</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/06-04-session-management" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/06-04-session-management" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/06-04-session-management" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/06-04-session-management" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/06-04-session-management" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='06-03-using-invoke-command' title="Using Invoke-Command">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Session Management</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-05-security-considerations' title="Security Considerations">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to manage sessions in PowerShell Remoting. Sessions allow you to maintain a persistent connection to a remote computer, which can be reused for multiple commands. This can be more efficient than creating a new connection for each command.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>PowerShell Sessions</strong>: Persistent connections to remote computers.</li>
<li><strong>Creating Sessions</strong>: Using <code>New-PSSession</code> to establish a session.</li>
<li><strong>Using Sessions</strong>: Running commands within an established session.</li>
<li><strong>Managing Sessions</strong>: Viewing, disconnecting, and removing sessions.</li>
<li><strong>Session Options</strong>: Configuring session options for specific needs.</li>
</ol>
</div><h1><p>Creating a Session</p>
</h1>
<div class='content'><p>To create a new session, use the <code>New-PSSession</code> cmdlet. This cmdlet establishes a persistent connection to a remote computer.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcgc2Vzc2lvbiB0byBhIHJlbW90ZSBjb21wdXRlcgokc2Vzc2lvbiA9IE5ldy1QU1Nlc3Npb24gLUNvbXB1dGVyTmFtZSAiUmVtb3RlQ29tcHV0ZXJOYW1lIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new session to a remote computer
$session = New-PSSession -ComputerName &quot;RemoteComputerName&quot;</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><code>New-PSSession</code>: Cmdlet to create a new session.</li>
<li><code>-ComputerName</code>: Specifies the name of the remote computer.</li>
</ul>
</div><h1><p>Using a Session</p>
</h1>
<div class='content'><p>Once a session is created, you can use it to run commands on the remote computer. Use the <code>Invoke-Command</code> cmdlet with the <code>-Session</code> parameter.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSdW4gYSBjb21tYW5kIGluIHRoZSBlc3RhYmxpc2hlZCBzZXNzaW9uCkludm9rZS1Db21tYW5kIC1TZXNzaW9uICRzZXNzaW9uIC1TY3JpcHRCbG9jayB7IEdldC1Qcm9jZXNzIH0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Run a command in the established session
Invoke-Command -Session $session -ScriptBlock { Get-Process }</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><code>Invoke-Command</code>: Cmdlet to run commands on a remote computer.</li>
<li><code>-Session</code>: Specifies the session to use.</li>
<li><code>-ScriptBlock</code>: Contains the commands to run on the remote computer.</li>
</ul>
</div><h1><p>Managing Sessions</p>
</h1>
<div class='content'></div><h2><p>Viewing Sessions</p>
</h2>
<div class='content'><p>To view all active sessions, use the <code>Get-PSSession</code> cmdlet.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBHZXQgYWxsIGFjdGl2ZSBzZXNzaW9ucwpHZXQtUFNTZXNzaW9u"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Get all active sessions
Get-PSSession</pre></div><div class='content'></div><h2><p>Disconnecting Sessions</p>
</h2>
<div class='content'><p>To disconnect a session without removing it, use the <code>Disconnect-PSSession</code> cmdlet.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEaXNjb25uZWN0IGEgc2Vzc2lvbgpEaXNjb25uZWN0LVBTU2Vzc2lvbiAtU2Vzc2lvbiAkc2Vzc2lvbg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Disconnect a session
Disconnect-PSSession -Session $session</pre></div><div class='content'></div><h2><p>Removing Sessions</p>
</h2>
<div class='content'><p>To remove a session, use the <code>Remove-PSSession</code> cmdlet.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSZW1vdmUgYSBzZXNzaW9uClJlbW92ZS1QU1Nlc3Npb24gLVNlc3Npb24gJHNlc3Npb24="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Remove a session
Remove-PSSession -Session $session</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><code>Get-PSSession</code>: Lists all active sessions.</li>
<li><code>Disconnect-PSSession</code>: Disconnects a session but keeps it available for reconnection.</li>
<li><code>Remove-PSSession</code>: Removes a session, terminating the connection.</li>
</ul>
</div><h1><p>Session Options</p>
</h1>
<div class='content'><p>You can configure various options for sessions using the <code>New-PSSessionOption</code> cmdlet. For example, you can set the idle timeout for a session.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgc2Vzc2lvbiBvcHRpb25zIHdpdGggYSAzMC1taW51dGUgaWRsZSB0aW1lb3V0CiRzZXNzaW9uT3B0aW9ucyA9IE5ldy1QU1Nlc3Npb25PcHRpb24gLUlkbGVUaW1lb3V0ICgzMCAqIDYwICogMTAwMCkKCiMgQ3JlYXRlIGEgbmV3IHNlc3Npb24gd2l0aCB0aGUgc3BlY2lmaWVkIG9wdGlvbnMKJHNlc3Npb24gPSBOZXctUFNTZXNzaW9uIC1Db21wdXRlck5hbWUgIlJlbW90ZUNvbXB1dGVyTmFtZSIgLVNlc3Npb25PcHRpb24gJHNlc3Npb25PcHRpb25z"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create session options with a 30-minute idle timeout
$sessionOptions = New-PSSessionOption -IdleTimeout (30 * 60 * 1000)

# Create a new session with the specified options
$session = New-PSSession -ComputerName &quot;RemoteComputerName&quot; -SessionOption $sessionOptions</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><code>New-PSSessionOption</code>: Cmdlet to create session options.</li>
<li><code>-IdleTimeout</code>: Specifies the idle timeout in milliseconds.</li>
</ul>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise</p>
</h2>
<div class='content'><ol>
<li>Create a new session to a remote computer named &quot;Server01&quot;.</li>
<li>Run the <code>Get-Service</code> command in the session to list all services on the remote computer.</li>
<li>View all active sessions.</li>
<li>Disconnect the session.</li>
<li>Reconnect the session and run the <code>Get-EventLog -LogName System</code> command.</li>
<li>Remove the session.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTdGVwIDE6IENyZWF0ZSBhIG5ldyBzZXNzaW9uCiRzZXNzaW9uID0gTmV3LVBTU2Vzc2lvbiAtQ29tcHV0ZXJOYW1lICJTZXJ2ZXIwMSIKCiMgU3RlcCAyOiBSdW4gR2V0LVNlcnZpY2UgaW4gdGhlIHNlc3Npb24KSW52b2tlLUNvbW1hbmQgLVNlc3Npb24gJHNlc3Npb24gLVNjcmlwdEJsb2NrIHsgR2V0LVNlcnZpY2UgfQoKIyBTdGVwIDM6IFZpZXcgYWxsIGFjdGl2ZSBzZXNzaW9ucwpHZXQtUFNTZXNzaW9uCgojIFN0ZXAgNDogRGlzY29ubmVjdCB0aGUgc2Vzc2lvbgpEaXNjb25uZWN0LVBTU2Vzc2lvbiAtU2Vzc2lvbiAkc2Vzc2lvbgoKIyBTdGVwIDU6IFJlY29ubmVjdCB0aGUgc2Vzc2lvbiBhbmQgcnVuIEdldC1FdmVudExvZwpDb25uZWN0LVBTU2Vzc2lvbiAtU2Vzc2lvbiAkc2Vzc2lvbgpJbnZva2UtQ29tbWFuZCAtU2Vzc2lvbiAkc2Vzc2lvbiAtU2NyaXB0QmxvY2sgeyBHZXQtRXZlbnRMb2cgLUxvZ05hbWUgU3lzdGVtIH0KCiMgU3RlcCA2OiBSZW1vdmUgdGhlIHNlc3Npb24KUmVtb3ZlLVBTU2Vzc2lvbiAtU2Vzc2lvbiAkc2Vzc2lvbg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Step 1: Create a new session
$session = New-PSSession -ComputerName &quot;Server01&quot;

# Step 2: Run Get-Service in the session
Invoke-Command -Session $session -ScriptBlock { Get-Service }

# Step 3: View all active sessions
Get-PSSession

# Step 4: Disconnect the session
Disconnect-PSSession -Session $session

# Step 5: Reconnect the session and run Get-EventLog
Connect-PSSession -Session $session
Invoke-Command -Session $session -ScriptBlock { Get-EventLog -LogName System }

# Step 6: Remove the session
Remove-PSSession -Session $session</pre></div><div class='content'></div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Mistake</strong>: Forgetting to remove sessions after use.
<ul>
<li><strong>Tip</strong>: Always clean up sessions to free up resources.</li>
</ul>
</li>
<li><strong>Mistake</strong>: Not specifying session options for long-running tasks.
<ul>
<li><strong>Tip</strong>: Configure session options to prevent timeouts during long operations.</li>
</ul>
</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered the basics of session management in PowerShell Remoting. You learned how to create, use, view, disconnect, and remove sessions, as well as how to configure session options. Proper session management is crucial for efficient and effective remote administration. In the next section, we will delve into security considerations for PowerShell Remoting.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-03-using-invoke-command' title="Using Invoke-Command">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-05-security-considerations' title="Security Considerations">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
