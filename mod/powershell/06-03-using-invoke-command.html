<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using Invoke-Command</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/06-03-using-invoke-command" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/06-03-using-invoke-command" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/06-03-using-invoke-command" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/powershell/06-03-using-invoke-command" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/powershell/06-03-using-invoke-command" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='06-02-setting-up-remoting' title="Setting Up Remoting">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Using Invoke-Command</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-04-session-management' title="Session Management">Next &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p><code>Invoke-Command</code> is a powerful cmdlet in PowerShell that allows you to run commands on local and remote computers. This is particularly useful for managing multiple systems simultaneously, automating tasks, and performing administrative functions across a network.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Cmdlet</strong>: A lightweight command used in the PowerShell environment.</li>
<li><strong>Remote Session</strong>: A connection to a remote computer that allows you to run commands as if you were logged in locally.</li>
<li><strong>ScriptBlock</strong>: A block of code or a script that you want to execute.</li>
</ul>
</div><h1>Basic Syntax</h1>
<div class='content'><p>The basic syntax for <code>Invoke-Command</code> is as follows:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSA8Q29tcHV0ZXJOYW1lPiAtU2NyaXB0QmxvY2sgeyA8U2NyaXB0PiB9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName &lt;ComputerName&gt; -ScriptBlock { &lt;Script&gt; }</pre></div><div class='content'><ul>
<li><code>-ComputerName</code>: Specifies the remote computer(s) on which the command should be executed.</li>
<li><code>-ScriptBlock</code>: Contains the commands or script to be executed.</li>
</ul>
</div><h1>Examples</h1>
<div class='content'></div><h2>Example 1: Running a Command on a Remote Computer</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAiU2VydmVyMDEiIC1TY3JpcHRCbG9jayB7IEdldC1Qcm9jZXNzIH0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName &quot;Server01&quot; -ScriptBlock { Get-Process }</pre></div><div class='content'><p>This command retrieves the list of processes running on the remote computer &quot;Server01&quot;.</p>
</div><h2>Example 2: Running a ScriptBlock on Multiple Computers</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGNvbXB1dGVycyA9ICJTZXJ2ZXIwMSIsICJTZXJ2ZXIwMiIsICJTZXJ2ZXIwMyIKSW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAkY29tcHV0ZXJzIC1TY3JpcHRCbG9jayB7IEdldC1TZXJ2aWNlIH0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$computers = &quot;Server01&quot;, &quot;Server02&quot;, &quot;Server03&quot;
Invoke-Command -ComputerName $computers -ScriptBlock { Get-Service }</pre></div><div class='content'><p>This command retrieves the list of services running on multiple remote computers specified in the <code>$computers</code> array.</p>
</div><h2>Example 3: Using Credentials for Remote Execution</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGNyZWQgPSBHZXQtQ3JlZGVudGlhbApJbnZva2UtQ29tbWFuZCAtQ29tcHV0ZXJOYW1lICJTZXJ2ZXIwMSIgLUNyZWRlbnRpYWwgJGNyZWQgLVNjcmlwdEJsb2NrIHsgR2V0LUV2ZW50TG9nIC1Mb2dOYW1lIFN5c3RlbSB9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$cred = Get-Credential
Invoke-Command -ComputerName &quot;Server01&quot; -Credential $cred -ScriptBlock { Get-EventLog -LogName System }</pre></div><div class='content'><p>This command retrieves the system event log from &quot;Server01&quot; using the credentials provided by the user.</p>
</div><h2>Example 4: Running a Local Command</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLVNjcmlwdEJsb2NrIHsgR2V0LUNoaWxkSXRlbSAiQzpcV2luZG93cyIgfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ScriptBlock { Get-ChildItem &quot;C:\Windows&quot; }</pre></div><div class='content'><p>This command lists the contents of the &quot;C:\Windows&quot; directory on the local computer.</p>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise 1: Retrieve Disk Space Information</h2>
<div class='content'><p><strong>Objective</strong>: Use <code>Invoke-Command</code> to retrieve disk space information from multiple remote computers.</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Create an array of computer names.</li>
<li>Use <code>Invoke-Command</code> to run a script block that retrieves disk space information.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGNvbXB1dGVycyA9ICJTZXJ2ZXIwMSIsICJTZXJ2ZXIwMiIsICJTZXJ2ZXIwMyIKSW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAkY29tcHV0ZXJzIC1TY3JpcHRCbG9jayB7CiAgICBHZXQtUFNEcml2ZSAtUFNQcm92aWRlciBGaWxlU3lzdGVtIHwgU2VsZWN0LU9iamVjdCBOYW1lLCBAe05hbWU9IkZyZWVTcGFjZShHQikiO0V4cHJlc3Npb249e1ttYXRoXTo6cm91bmQoJF8uRnJlZS8xR0IsMil9fQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$computers = &quot;Server01&quot;, &quot;Server02&quot;, &quot;Server03&quot;
Invoke-Command -ComputerName $computers -ScriptBlock {
    Get-PSDrive -PSProvider FileSystem | Select-Object Name, @{Name=&quot;FreeSpace(GB)&quot;;Expression={[math]::round($_.Free/1GB,2)}}
}</pre></div><div class='content'></div><h2>Exercise 2: Restart a Service on a Remote Computer</h2>
<div class='content'><p><strong>Objective</strong>: Use <code>Invoke-Command</code> to restart the &quot;Spooler&quot; service on a remote computer.</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Specify the remote computer name.</li>
<li>Use <code>Invoke-Command</code> to run a script block that restarts the &quot;Spooler&quot; service.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAiU2VydmVyMDEiIC1TY3JpcHRCbG9jayB7CiAgICBSZXN0YXJ0LVNlcnZpY2UgLU5hbWUgIlNwb29sZXIiCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName &quot;Server01&quot; -ScriptBlock {
    Restart-Service -Name &quot;Spooler&quot;
}</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Incorrect Computer Name</strong>: Ensure that the computer names are correct and reachable.</li>
<li><strong>Permissions</strong>: Make sure you have the necessary permissions to run commands on the remote computer.</li>
<li><strong>Firewall Settings</strong>: Ensure that the firewall settings on the remote computer allow remote management.</li>
<li><strong>Credential Management</strong>: Use <code>Get-Credential</code> to securely manage credentials for remote sessions.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p><code>Invoke-Command</code> is an essential cmdlet for remote management and automation in PowerShell. By understanding its syntax and usage, you can efficiently manage multiple systems and perform complex administrative tasks. Practice using <code>Invoke-Command</code> with different scenarios to become proficient in remote command execution.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-02-setting-up-remoting' title="Setting Up Remoting">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-04-session-management' title="Session Management">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
