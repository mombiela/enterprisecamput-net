<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Template Haskell</title>

    <link rel="alternate" href="https://campusempresa.com/mod/haskell/07-04-template-haskell" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/haskell/07-04-template-haskell" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/haskell/07-04-template-haskell" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/haskell/07-04-template-haskell" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/haskell/07-04-template-haskell" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-03-ffi' title="Foreign Function Interface (FFI)">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Template Haskell</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='08-01-simple-web-server' title="Building a Simple Web Server">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Template Haskell is a powerful metaprogramming tool in Haskell that allows you to generate and manipulate Haskell code programmatically. It enables you to write code that writes code, which can be particularly useful for tasks like code generation, optimization, and embedding domain-specific languages.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Quasi-Quoting</strong>: Allows you to embed Haskell code within Haskell code.</li>
<li><strong>Splicing</strong>: Inserting generated code into your program.</li>
<li><strong>Reification</strong>: Inspecting the structure of Haskell code.</li>
<li><strong>Syntax Trees</strong>: Representing Haskell code as data structures.</li>
</ol>
</div><h1>Setting Up Template Haskell</h1>
<div class='content'><p>To use Template Haskell, you need to enable the <code>TemplateHaskell</code> language extension. You can do this by adding the following pragma at the top of your Haskell file:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ey0jIExBTkdVQUdFIFRlbXBsYXRlSGFza2VsbCAjLX0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{-# LANGUAGE TemplateHaskell #-}</pre></div><div class='content'></div><h1>Basic Syntax</h1>
<div class='content'></div><h2>Quasi-Quoting</h2>
<div class='content'><p>Quasi-quoting allows you to write Haskell code as a string and then convert it into an abstract syntax tree (AST). The syntax for quasi-quoting is <code>[| ... |]</code>.</p>
<p>Example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ey0jIExBTkdVQUdFIFRlbXBsYXRlSGFza2VsbCAjLX0KCm1vZHVsZSBNYWluIHdoZXJlCgppbXBvcnQgTGFuZ3VhZ2UuSGFza2VsbC5USAoKLS0gUXVhc2ktcXVvdGVkIGV4cHJlc3Npb24KZXhhbXBsZSA6OiBRIEV4cApleGFtcGxlID0gW3wgMSArIDIgfF0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{-# LANGUAGE TemplateHaskell #-}

module Main where

import Language.Haskell.TH

-- Quasi-quoted expression
example :: Q Exp
example = [| 1 + 2 |]</pre></div><div class='content'></div><h2>Splicing</h2>
<div class='content'><p>Splicing is the process of inserting generated code into your program. The syntax for splicing is <code>$( ... )</code>.</p>
<p>Example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ey0jIExBTkdVQUdFIFRlbXBsYXRlSGFza2VsbCAjLX0KCm1vZHVsZSBNYWluIHdoZXJlCgppbXBvcnQgTGFuZ3VhZ2UuSGFza2VsbC5USAoKLS0gUXVhc2ktcXVvdGVkIGV4cHJlc3Npb24KZXhhbXBsZSA6OiBRIEV4cApleGFtcGxlID0gW3wgMSArIDIgfF0KCi0tIFNwbGljaW5nIHRoZSBleHByZXNzaW9uIGludG8gdGhlIHByb2dyYW0KbWFpbiA6OiBJTyAoKQptYWluID0gcHJpbnQgJChleGFtcGxlKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{-# LANGUAGE TemplateHaskell #-}

module Main where

import Language.Haskell.TH

-- Quasi-quoted expression
example :: Q Exp
example = [| 1 + 2 |]

-- Splicing the expression into the program
main :: IO ()
main = print $(example)</pre></div><div class='content'></div><h2>Reification</h2>
<div class='content'><p>Reification allows you to inspect the structure of Haskell code. You can use the <code>reify</code> function to get information about a name.</p>
<p>Example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ey0jIExBTkdVQUdFIFRlbXBsYXRlSGFza2VsbCAjLX0KCm1vZHVsZSBNYWluIHdoZXJlCgppbXBvcnQgTGFuZ3VhZ2UuSGFza2VsbC5USAoKLS0gRnVuY3Rpb24gdG8gcmVpZnkKbXlGdW5jdGlvbiA6OiBJbnQgLT4gSW50Cm15RnVuY3Rpb24geCA9IHggKyAxCgotLSBSZWlmeSB0aGUgZnVuY3Rpb24KbWFpbiA6OiBJTyAoKQptYWluID0gZG8KICBpbmZvIDwtIHJ1blEgKHJlaWZ5ICdteUZ1bmN0aW9uKQogIHByaW50IGluZm8="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{-# LANGUAGE TemplateHaskell #-}

module Main where

import Language.Haskell.TH

-- Function to reify
myFunction :: Int -&gt; Int
myFunction x = x + 1

-- Reify the function
main :: IO ()
main = do
  info &lt;- runQ (reify 'myFunction)
  print info</pre></div><div class='content'></div><h2>Syntax Trees</h2>
<div class='content'><p>Haskell code is represented as syntax trees in Template Haskell. The <code>Q</code> monad is used to construct these trees.</p>
<p>Example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ey0jIExBTkdVQUdFIFRlbXBsYXRlSGFza2VsbCAjLX0KCm1vZHVsZSBNYWluIHdoZXJlCgppbXBvcnQgTGFuZ3VhZ2UuSGFza2VsbC5USAoKLS0gQ29uc3RydWN0aW5nIGEgc3ludGF4IHRyZWUKZXhhbXBsZSA6OiBRIEV4cApleGFtcGxlID0gZG8KICBsZXQgeCA9IG1rTmFtZSAieCIKICBsYW1FIFt2YXJQIHhdIChpbmZpeEUgKEp1c3QgKHZhckUgeCkpICh2YXJFICcoKykpIChKdXN0IChsaXRFIChpbnRlZ2VyTCAxKSkpKQoKLS0gU3BsaWNpbmcgdGhlIHN5bnRheCB0cmVlIGludG8gdGhlIHByb2dyYW0KbWFpbiA6OiBJTyAoKQptYWluID0gcHJpbnQgJChleGFtcGxlKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{-# LANGUAGE TemplateHaskell #-}

module Main where

import Language.Haskell.TH

-- Constructing a syntax tree
example :: Q Exp
example = do
  let x = mkName &quot;x&quot;
  lamE [varP x] (infixE (Just (varE x)) (varE '(+)) (Just (litE (integerL 1))))

-- Splicing the syntax tree into the program
main :: IO ()
main = print $(example)</pre></div><div class='content'></div><h1>Practical Example: Generating a Function</h1>
<div class='content'><p>Let's create a Template Haskell function that generates a function to add two numbers.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ey0jIExBTkdVQUdFIFRlbXBsYXRlSGFza2VsbCAjLX0KCm1vZHVsZSBNYWluIHdoZXJlCgppbXBvcnQgTGFuZ3VhZ2UuSGFza2VsbC5USAoKLS0gRnVuY3Rpb24gdG8gZ2VuZXJhdGUgYW4gYWRkaXRpb24gZnVuY3Rpb24KZ2VuQWRkRnVuY3Rpb24gOjogUSBbRGVjXQpnZW5BZGRGdW5jdGlvbiA9IGRvCiAgbGV0IGZOYW1lID0gbWtOYW1lICJhZGQiCiAgbGV0IHggPSBta05hbWUgIngiCiAgbGV0IHkgPSBta05hbWUgInkiCiAgZnVuRCBmTmFtZSBbY2xhdXNlIFt2YXJQIHgsIHZhclAgeV0gKG5vcm1hbEIgW3wgJCh2YXJFIHgpICsgJCh2YXJFIHkpIHxdKSBbXV0KCi0tIFNwbGljZSB0aGUgZ2VuZXJhdGVkIGZ1bmN0aW9uIGludG8gdGhlIHByb2dyYW0KJChnZW5BZGRGdW5jdGlvbikKCm1haW4gOjogSU8gKCkKbWFpbiA9IHByaW50IChhZGQgMyA1KQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{-# LANGUAGE TemplateHaskell #-}

module Main where

import Language.Haskell.TH

-- Function to generate an addition function
genAddFunction :: Q [Dec]
genAddFunction = do
  let fName = mkName &quot;add&quot;
  let x = mkName &quot;x&quot;
  let y = mkName &quot;y&quot;
  funD fName [clause [varP x, varP y] (normalB [| $(varE x) + $(varE y) |]) []]

-- Splice the generated function into the program
$(genAddFunction)

main :: IO ()
main = print (add 3 5)</pre></div><div class='content'></div><h1>Exercises</h1>
<div class='content'></div><h2>Exercise 1: Generating a Multiplication Function</h2>
<div class='content'><p>Write a Template Haskell function that generates a function to multiply two numbers.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ey0jIExBTkdVQUdFIFRlbXBsYXRlSGFza2VsbCAjLX0KCm1vZHVsZSBNYWluIHdoZXJlCgppbXBvcnQgTGFuZ3VhZ2UuSGFza2VsbC5USAoKLS0gRnVuY3Rpb24gdG8gZ2VuZXJhdGUgYSBtdWx0aXBsaWNhdGlvbiBmdW5jdGlvbgpnZW5NdWxGdW5jdGlvbiA6OiBRIFtEZWNdCmdlbk11bEZ1bmN0aW9uID0gZG8KICBsZXQgZk5hbWUgPSBta05hbWUgIm11bCIKICBsZXQgeCA9IG1rTmFtZSAieCIKICBsZXQgeSA9IG1rTmFtZSAieSIKICBmdW5EIGZOYW1lIFtjbGF1c2UgW3ZhclAgeCwgdmFyUCB5XSAobm9ybWFsQiBbfCAkKHZhckUgeCkgKiAkKHZhckUgeSkgfF0pIFtdXQoKLS0gU3BsaWNlIHRoZSBnZW5lcmF0ZWQgZnVuY3Rpb24gaW50byB0aGUgcHJvZ3JhbQokKGdlbk11bEZ1bmN0aW9uKQoKbWFpbiA6OiBJTyAoKQptYWluID0gcHJpbnQgKG11bCAzIDUp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{-# LANGUAGE TemplateHaskell #-}

module Main where

import Language.Haskell.TH

-- Function to generate a multiplication function
genMulFunction :: Q [Dec]
genMulFunction = do
  let fName = mkName &quot;mul&quot;
  let x = mkName &quot;x&quot;
  let y = mkName &quot;y&quot;
  funD fName [clause [varP x, varP y] (normalB [| $(varE x) * $(varE y) |]) []]

-- Splice the generated function into the program
$(genMulFunction)

main :: IO ()
main = print (mul 3 5)</pre></div><div class='content'></div><h2>Exercise 2: Generating a Function to Compute the Length of a List</h2>
<div class='content'><p>Write a Template Haskell function that generates a function to compute the length of a list.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ey0jIExBTkdVQUdFIFRlbXBsYXRlSGFza2VsbCAjLX0KCm1vZHVsZSBNYWluIHdoZXJlCgppbXBvcnQgTGFuZ3VhZ2UuSGFza2VsbC5USAoKLS0gRnVuY3Rpb24gdG8gZ2VuZXJhdGUgYSBsZW5ndGggZnVuY3Rpb24KZ2VuTGVuZ3RoRnVuY3Rpb24gOjogUSBbRGVjXQpnZW5MZW5ndGhGdW5jdGlvbiA9IGRvCiAgbGV0IGZOYW1lID0gbWtOYW1lICJsaXN0TGVuZ3RoIgogIGxldCB4cyA9IG1rTmFtZSAieHMiCiAgZnVuRCBmTmFtZSBbY2xhdXNlIFt2YXJQIHhzXSAobm9ybWFsQiBbfCBsZW5ndGggJCh2YXJFIHhzKSB8XSkgW11dCgotLSBTcGxpY2UgdGhlIGdlbmVyYXRlZCBmdW5jdGlvbiBpbnRvIHRoZSBwcm9ncmFtCiQoZ2VuTGVuZ3RoRnVuY3Rpb24pCgptYWluIDo6IElPICgpCm1haW4gPSBwcmludCAobGlzdExlbmd0aCBbMSwgMiwgMywgNCwgNV0p"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{-# LANGUAGE TemplateHaskell #-}

module Main where

import Language.Haskell.TH

-- Function to generate a length function
genLengthFunction :: Q [Dec]
genLengthFunction = do
  let fName = mkName &quot;listLength&quot;
  let xs = mkName &quot;xs&quot;
  funD fName [clause [varP xs] (normalB [| length $(varE xs) |]) []]

-- Splice the generated function into the program
$(genLengthFunction)

main :: IO ()
main = print (listLength [1, 2, 3, 4, 5])</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we explored Template Haskell, a powerful metaprogramming tool in Haskell. We covered the basics of quasi-quoting, splicing, reification, and syntax trees. We also provided practical examples and exercises to help you understand how to generate and manipulate Haskell code programmatically. In the next module, we will delve into concurrency and parallelism in Haskell.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-03-ffi' title="Foreign Function Interface (FFI)">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='08-01-simple-web-server' title="Building a Simple Web Server">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
