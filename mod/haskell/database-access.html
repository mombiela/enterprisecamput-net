<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Access in Haskell</title>

    <link rel="alternate" href="https://campusempresa.com/mod/haskell/database-access" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/haskell/database-access" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/haskell/database-access" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/haskell/database-access" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/haskell/database-access" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='building-simple-web-server'>&#x25C4;Building a Simple Web Server</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Database Access in Haskell</a>
	</div>
	<div class='col-4 text-end'>
					<a href='testing-debugging'>Testing and Debugging &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Database Access</h1>
<div class='content'><p>Database access is a crucial aspect of many applications, allowing for the storage, retrieval, and manipulation of data. In Haskell, database access can be achieved using various libraries and frameworks. This section will guide you through the basics of database access in Haskell, from setting up a connection to performing CRUD (Create, Read, Update, Delete) operations.</p>
</div><h1>Setting Up the Environment</h1>
<div class='content'><p>Before we dive into code, let's set up the necessary environment.</p>
<ol>
<li><strong>Install GHC and Cabal</strong>: Ensure you have the Glasgow Haskell Compiler (GHC) and Cabal installed.</li>
<li><strong>Create a New Project</strong>: Use Cabal to create a new Haskell project.
<pre><code class="language-sh">cabal init
</code></pre>
</li>
<li><strong>Add Dependencies</strong>: Add the required libraries to your <code>cabal</code> file. For database access, we'll use <code>persistent</code> and <code>persistent-sqlite</code> for SQLite as an example.
<pre><code class="language-cabal">build-depends: base &gt;=4.7 &amp;&amp; &lt;5,
               persistent,
               persistent-sqlite,
               persistent-template,
               text
</code></pre>
</li>
</ol>
</div><h1>Connecting to a Database</h1>
<div class='content'><p>To connect to a database, you need to define your database schema and set up the connection.</p>
</div><h2>Defining the Schema</h2>
<div class='content'><p>Define your database schema using Persistent's Template Haskell syntax.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ey0jIExBTkdVQUdFIEdBRFRzICMtfQp7LSMgTEFOR1VBR0UgT3ZlcmxvYWRlZFN0cmluZ3MgIy19CnstIyBMQU5HVUFHRSBRdWFzaVF1b3RlcyAjLX0Key0jIExBTkdVQUdFIFRlbXBsYXRlSGFza2VsbCAjLX0Key0jIExBTkdVQUdFIFR5cGVGYW1pbGllcyAjLX0KCmltcG9ydCBEYXRhYmFzZS5QZXJzaXN0CmltcG9ydCBEYXRhYmFzZS5QZXJzaXN0LlNxbGl0ZQppbXBvcnQgRGF0YWJhc2UuUGVyc2lzdC5USAppbXBvcnQgQ29udHJvbC5Nb25hZC5JTy5DbGFzcyAobGlmdElPKQoKc2hhcmUgW21rUGVyc2lzdCBzcWxTZXR0aW5ncywgbWtNaWdyYXRlICJtaWdyYXRlQWxsIl0gW3BlcnNpc3RMb3dlckNhc2V8ClBlcnNvbgogICAgbmFtZSBTdHJpbmcKICAgIGFnZSBJbnQKICAgIGRlcml2aW5nIFNob3cKfF0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{-# LANGUAGE GADTs #-}
{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE QuasiQuotes #-}
{-# LANGUAGE TemplateHaskell #-}
{-# LANGUAGE TypeFamilies #-}

import Database.Persist
import Database.Persist.Sqlite
import Database.Persist.TH
import Control.Monad.IO.Class (liftIO)

share [mkPersist sqlSettings, mkMigrate &quot;migrateAll&quot;] [persistLowerCase|
Person
    name String
    age Int
    deriving Show
|]</pre></div><div class='content'></div><h2>Setting Up the Connection</h2>
<div class='content'><p>Set up the connection to the SQLite database and run the migration to create the tables.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWFpbiA6OiBJTyAoKQptYWluID0gcnVuU3FsaXRlICJ0ZXN0LmRiIiAkIGRvCiAgICBydW5NaWdyYXRpb24gbWlncmF0ZUFsbAogICAgbGlmdElPICQgcHV0U3RyTG4gIkRhdGFiYXNlIGNvbm5lY3RlZCBhbmQgc2NoZW1hIG1pZ3JhdGVkLiI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>main :: IO ()
main = runSqlite &quot;test.db&quot; $ do
    runMigration migrateAll
    liftIO $ putStrLn &quot;Database connected and schema migrated.&quot;</pre></div><div class='content'></div><h1>Performing CRUD Operations</h1>
<div class='content'><p>Once the connection is set up, you can perform CRUD operations.</p>
</div><h2>Create</h2>
<div class='content'><p>Insert a new record into the database.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YWRkUGVyc29uIDo6IFN0cmluZyAtPiBJbnQgLT4gSU8gKCkKYWRkUGVyc29uIG5hbWUgYWdlID0gcnVuU3FsaXRlICJ0ZXN0LmRiIiAkIGRvCiAgICBwZXJzb25JZCA8LSBpbnNlcnQgJCBQZXJzb24gbmFtZSBhZ2UKICAgIGxpZnRJTyAkIHB1dFN0ckxuICQgIkluc2VydGVkIHBlcnNvbiB3aXRoIElEOiAiICsrIHNob3cgcGVyc29uSWQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>addPerson :: String -&gt; Int -&gt; IO ()
addPerson name age = runSqlite &quot;test.db&quot; $ do
    personId &lt;- insert $ Person name age
    liftIO $ putStrLn $ &quot;Inserted person with ID: &quot; ++ show personId</pre></div><div class='content'></div><h2>Read</h2>
<div class='content'><p>Retrieve records from the database.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2V0UGVvcGxlIDo6IElPICgpCmdldFBlb3BsZSA9IHJ1blNxbGl0ZSAidGVzdC5kYiIgJCBkbwogICAgcGVvcGxlIDwtIHNlbGVjdExpc3QgW10gW10KICAgIGxpZnRJTyAkIG1hcE1fIChwcmludCAuIGVudGl0eVZhbCkgcGVvcGxl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>getPeople :: IO ()
getPeople = runSqlite &quot;test.db&quot; $ do
    people &lt;- selectList [] []
    liftIO $ mapM_ (print . entityVal) people</pre></div><div class='content'></div><h2>Update</h2>
<div class='content'><p>Update an existing record.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXBkYXRlUGVyc29uQWdlIDo6IFBlcnNvbklkIC0+IEludCAtPiBJTyAoKQp1cGRhdGVQZXJzb25BZ2UgcGVyc29uSWQgbmV3QWdlID0gcnVuU3FsaXRlICJ0ZXN0LmRiIiAkIGRvCiAgICB1cGRhdGUgcGVyc29uSWQgW1BlcnNvbkFnZSA9LiBuZXdBZ2VdCiAgICBsaWZ0SU8gJCBwdXRTdHJMbiAkICJVcGRhdGVkIHBlcnNvbiB3aXRoIElEOiAiICsrIHNob3cgcGVyc29uSWQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>updatePersonAge :: PersonId -&gt; Int -&gt; IO ()
updatePersonAge personId newAge = runSqlite &quot;test.db&quot; $ do
    update personId [PersonAge =. newAge]
    liftIO $ putStrLn $ &quot;Updated person with ID: &quot; ++ show personId</pre></div><div class='content'></div><h2>Delete</h2>
<div class='content'><p>Delete a record from the database.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVsZXRlUGVyc29uIDo6IFBlcnNvbklkIC0+IElPICgpCmRlbGV0ZVBlcnNvbiBwZXJzb25JZCA9IHJ1blNxbGl0ZSAidGVzdC5kYiIgJCBkbwogICAgZGVsZXRlIHBlcnNvbklkCiAgICBsaWZ0SU8gJCBwdXRTdHJMbiAkICJEZWxldGVkIHBlcnNvbiB3aXRoIElEOiAiICsrIHNob3cgcGVyc29uSWQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>deletePerson :: PersonId -&gt; IO ()
deletePerson personId = runSqlite &quot;test.db&quot; $ do
    delete personId
    liftIO $ putStrLn $ &quot;Deleted person with ID: &quot; ++ show personId</pre></div><div class='content'></div><h1>Advanced Topics</h1>
<div class='content'><p>For advanced users, Haskell offers more sophisticated database operations and optimizations.</p>
</div><h2>Transactions</h2>
<div class='content'><p>Perform multiple operations within a transaction to ensure atomicity.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJhbnNhY3Rpb25FeGFtcGxlIDo6IElPICgpCnRyYW5zYWN0aW9uRXhhbXBsZSA9IHJ1blNxbGl0ZSAidGVzdC5kYiIgJCBkbwogICAgcGVyc29uSWQgPC0gaW5zZXJ0ICQgUGVyc29uICJBbGljZSIgMzAKICAgIHVwZGF0ZSBwZXJzb25JZCBbUGVyc29uQWdlID0uIDMxXQogICAgZGVsZXRlIHBlcnNvbklkCiAgICBsaWZ0SU8gJCBwdXRTdHJMbiAiVHJhbnNhY3Rpb24gY29tcGxldGVkLiI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>transactionExample :: IO ()
transactionExample = runSqlite &quot;test.db&quot; $ do
    personId &lt;- insert $ Person &quot;Alice&quot; 30
    update personId [PersonAge =. 31]
    delete personId
    liftIO $ putStrLn &quot;Transaction completed.&quot;</pre></div><div class='content'></div><h2>Query Optimization</h2>
<div class='content'><p>Use indices and optimized queries to improve performance.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRXhhbXBsZSBvZiBjcmVhdGluZyBhbiBpbmRleApzaGFyZSBbbWtQZXJzaXN0IHNxbFNldHRpbmdzLCBta01pZ3JhdGUgIm1pZ3JhdGVBbGwiXSBbcGVyc2lzdExvd2VyQ2FzZXwKUGVyc29uCiAgICBuYW1lIFN0cmluZwogICAgYWdlIEludAogICAgZGVyaXZpbmcgU2hvdwogICAgVW5pcXVlTmFtZSBuYW1lCnxd"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Example of creating an index
share [mkPersist sqlSettings, mkMigrate &quot;migrateAll&quot;] [persistLowerCase|
Person
    name String
    age Int
    deriving Show
    UniqueName name
|]</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we've covered the basics of database access in Haskell using the Persistent library. You learned how to set up a connection, define a schema, and perform CRUD operations. For advanced users, we touched on transactions and query optimization. With these skills, you can efficiently manage database operations in your Haskell applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='building-simple-web-server'>&#x25C4;Building a Simple Web Server</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Database Access in Haskell</a>
	</div>
	<div class='col-4 text-end'>
					<a href='testing-debugging'>Testing and Debugging &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
