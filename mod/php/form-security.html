<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Security in PHP</title>

    <link rel="alternate" href="https://campusempresa.com/mod/php/form-security" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/php/form-security" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/php/form-security" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/php/form-security" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/php/form-security" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='form-validation'>&#x25C4;Form Validation</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Form Security in PHP</a>
	</div>
	<div class='col-4 text-end'>
					<a href='working-with-arrays'>Working with Arrays &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Form security is a crucial aspect of web development, especially when dealing with user input. In PHP, ensuring that forms are secure can prevent a wide range of attacks, such as SQL injection, Cross-Site Scripting (XSS), and Cross-Site Request Forgery (CSRF). This section will guide you through the essential practices and techniques to secure forms in PHP, from beginner to advanced levels.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Input Validation and Sanitization</strong></li>
<li><strong>SQL Injection Prevention</strong></li>
<li><strong>Cross-Site Scripting (XSS) Prevention</strong></li>
<li><strong>Cross-Site Request Forgery (CSRF) Protection</strong></li>
<li><strong>Password Hashing and Storage</strong></li>
</ul>
</div><h1>Input Validation and Sanitization</h1>
<div class='content'><p>Input validation ensures that the data received from users is in the expected format, while sanitization cleans the data to prevent malicious input.</p>
</div><h2>Example: Basic Input Validation and Sanitization</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKaWYgKCRfU0VSVkVSWyJSRVFVRVNUX01FVEhPRCJdID09ICJQT1NUIikgewogICAgJG5hbWUgPSBzYW5pdGl6ZV9pbnB1dCgkX1BPU1RbIm5hbWUiXSk7CiAgICAkZW1haWwgPSBzYW5pdGl6ZV9pbnB1dCgkX1BPU1RbImVtYWlsIl0pOwogICAgLy8gRnVydGhlciBwcm9jZXNzaW5nCn0KCmZ1bmN0aW9uIHNhbml0aXplX2lucHV0KCRkYXRhKSB7CiAgICAkZGF0YSA9IHRyaW0oJGRhdGEpOyAvLyBSZW1vdmUgd2hpdGVzcGFjZSBmcm9tIGJvdGggc2lkZXMKICAgICRkYXRhID0gc3RyaXBzbGFzaGVzKCRkYXRhKTsgLy8gUmVtb3ZlIGJhY2tzbGFzaGVzCiAgICAkZGF0YSA9IGh0bWxzcGVjaWFsY2hhcnMoJGRhdGEpOyAvLyBDb252ZXJ0IHNwZWNpYWwgY2hhcmFjdGVycyB0byBIVE1MIGVudGl0aWVzCiAgICByZXR1cm4gJGRhdGE7Cn0KPz4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) {
    $name = sanitize_input($_POST[&quot;name&quot;]);
    $email = sanitize_input($_POST[&quot;email&quot;]);
    // Further processing
}

function sanitize_input($data) {
    $data = trim($data); // Remove whitespace from both sides
    $data = stripslashes($data); // Remove backslashes
    $data = htmlspecialchars($data); // Convert special characters to HTML entities
    return $data;
}
?&gt;</pre></div><div class='content'><ul>
<li><code>trim()</code>: Removes whitespace from the beginning and end of a string.</li>
<li><code>stripslashes()</code>: Removes backslashes from a string.</li>
<li><code>htmlspecialchars()</code>: Converts special characters to HTML entities to prevent XSS.</li>
</ul>
</div><h1>SQL Injection Prevention</h1>
<div class='content'><p>SQL injection is a technique where attackers can execute arbitrary SQL code on your database. Using prepared statements with parameterized queries is the best way to prevent SQL injection.</p>
</div><h2>Example: Using Prepared Statements</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJHNlcnZlcm5hbWUgPSAibG9jYWxob3N0IjsKJHVzZXJuYW1lID0gInVzZXJuYW1lIjsKJHBhc3N3b3JkID0gInBhc3N3b3JkIjsKJGRibmFtZSA9ICJkYXRhYmFzZSI7CgokY29ubiA9IG5ldyBteXNxbGkoJHNlcnZlcm5hbWUsICR1c2VybmFtZSwgJHBhc3N3b3JkLCAkZGJuYW1lKTsKCmlmICgkY29ubi0+Y29ubmVjdF9lcnJvcikgewogICAgZGllKCJDb25uZWN0aW9uIGZhaWxlZDogIiAuICRjb25uLT5jb25uZWN0X2Vycm9yKTsKfQoKaWYgKCRfU0VSVkVSWyJSRVFVRVNUX01FVEhPRCJdID09ICJQT1NUIikgewogICAgJG5hbWUgPSAkX1BPU1RbIm5hbWUiXTsKICAgICRlbWFpbCA9ICRfUE9TVFsiZW1haWwiXTsKCiAgICAkc3RtdCA9ICRjb25uLT5wcmVwYXJlKCJJTlNFUlQgSU5UTyB1c2VycyAobmFtZSwgZW1haWwpIFZBTFVFUyAoPywgPykiKTsKICAgICRzdG10LT5iaW5kX3BhcmFtKCJzcyIsICRuYW1lLCAkZW1haWwpOwogICAgJHN0bXQtPmV4ZWN1dGUoKTsKICAgICRzdG10LT5jbG9zZSgpOwp9CgokY29ubi0+Y2xvc2UoKTsKPz4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$servername = &quot;localhost&quot;;
$username = &quot;username&quot;;
$password = &quot;password&quot;;
$dbname = &quot;database&quot;;

$conn = new mysqli($servername, $username, $password, $dbname);

if ($conn-&gt;connect_error) {
    die(&quot;Connection failed: &quot; . $conn-&gt;connect_error);
}

if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) {
    $name = $_POST[&quot;name&quot;];
    $email = $_POST[&quot;email&quot;];

    $stmt = $conn-&gt;prepare(&quot;INSERT INTO users (name, email) VALUES (?, ?)&quot;);
    $stmt-&gt;bind_param(&quot;ss&quot;, $name, $email);
    $stmt-&gt;execute();
    $stmt-&gt;close();
}

$conn-&gt;close();
?&gt;</pre></div><div class='content'><ul>
<li><code>prepare()</code>: Prepares an SQL statement for execution.</li>
<li><code>bind_param()</code>: Binds variables to the prepared statement as parameters.</li>
<li><code>execute()</code>: Executes the prepared statement.</li>
</ul>
</div><h1>Cross-Site Scripting (XSS) Prevention</h1>
<div class='content'><p>XSS attacks occur when attackers inject malicious scripts into web pages viewed by other users. Using <code>htmlspecialchars()</code> is a common way to prevent XSS.</p>
</div><h2>Example: Preventing XSS</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKaWYgKCRfU0VSVkVSWyJSRVFVRVNUX01FVEhPRCJdID09ICJQT1NUIikgewogICAgJGNvbW1lbnQgPSBodG1sc3BlY2lhbGNoYXJzKCRfUE9TVFsiY29tbWVudCJdKTsKICAgIGVjaG8gIllvdXIgY29tbWVudDogIiAuICRjb21tZW50Owp9Cj8+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) {
    $comment = htmlspecialchars($_POST[&quot;comment&quot;]);
    echo &quot;Your comment: &quot; . $comment;
}
?&gt;</pre></div><div class='content'><ul>
<li><code>htmlspecialchars()</code>: Converts special characters to HTML entities, preventing the execution of malicious scripts.</li>
</ul>
</div><h1>Cross-Site Request Forgery (CSRF) Protection</h1>
<div class='content'><p>CSRF attacks trick users into performing actions they didn't intend to. Using tokens is a common method to protect against CSRF.</p>
</div><h2>Example: CSRF Token Implementation</h2>
<div class='content'><h4>Generating a Token</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKc2Vzc2lvbl9zdGFydCgpOwppZiAoZW1wdHkoJF9TRVNTSU9OWyd0b2tlbiddKSkgewogICAgJF9TRVNTSU9OWyd0b2tlbiddID0gYmluMmhleChyYW5kb21fYnl0ZXMoMzIpKTsKfQo/Pgo8Zm9ybSBtZXRob2Q9InBvc3QiIGFjdGlvbj0icHJvY2Vzcy5waHAiPgogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0idG9rZW4iIHZhbHVlPSI8P3BocCBlY2hvICRfU0VTU0lPTlsndG9rZW4nXTsgPz4iPgogICAgPCEtLSBPdGhlciBmb3JtIGZpZWxkcyAtLT4KICAgIDxpbnB1dCB0eXBlPSJzdWJtaXQiIHZhbHVlPSJTdWJtaXQiPgo8L2Zvcm0+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
session_start();
if (empty($_SESSION['token'])) {
    $_SESSION['token'] = bin2hex(random_bytes(32));
}
?&gt;
&lt;form method=&quot;post&quot; action=&quot;process.php&quot;&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;token&quot; value=&quot;&lt;?php echo $_SESSION['token']; ?&gt;&quot;&gt;
    &lt;!-- Other form fields --&gt;
    &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;
&lt;/form&gt;</pre></div><div class='content'><h4>Validating the Token</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKc2Vzc2lvbl9zdGFydCgpOwppZiAoJF9TRVJWRVJbIlJFUVVFU1RfTUVUSE9EIl0gPT0gIlBPU1QiKSB7CiAgICBpZiAoIWhhc2hfZXF1YWxzKCRfU0VTU0lPTlsndG9rZW4nXSwgJF9QT1NUWyd0b2tlbiddKSkgewogICAgICAgIGRpZSgiQ1NSRiB0b2tlbiB2YWxpZGF0aW9uIGZhaWxlZCIpOwogICAgfQogICAgLy8gUHJvY2VzcyBmb3JtIGRhdGEKfQo/Pg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
session_start();
if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) {
    if (!hash_equals($_SESSION['token'], $_POST['token'])) {
        die(&quot;CSRF token validation failed&quot;);
    }
    // Process form data
}
?&gt;</pre></div><div class='content'><ul>
<li><code>bin2hex()</code>: Converts binary data into hexadecimal representation.</li>
<li><code>random_bytes()</code>: Generates cryptographically secure pseudo-random bytes.</li>
<li><code>hash_equals()</code>: Compares two strings in a timing attack safe manner.</li>
</ul>
</div><h1>Password Hashing and Storage</h1>
<div class='content'><p>Storing passwords securely is essential to protect user accounts. PHP provides the <code>password_hash()</code> and <code>password_verify()</code> functions for this purpose.</p>
</div><h2>Example: Password Hashing and Verification</h2>
<div class='content'><h4>Hashing a Password</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJHBhc3N3b3JkID0gInVzZXJfcGFzc3dvcmQiOwokaGFzaGVkX3Bhc3N3b3JkID0gcGFzc3dvcmRfaGFzaCgkcGFzc3dvcmQsIFBBU1NXT1JEX0RFRkFVTFQpOwplY2hvICRoYXNoZWRfcGFzc3dvcmQ7Cj8+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$password = &quot;user_password&quot;;
$hashed_password = password_hash($password, PASSWORD_DEFAULT);
echo $hashed_password;
?&gt;</pre></div><div class='content'><h4>Verifying a Password</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJGVudGVyZWRfcGFzc3dvcmQgPSAidXNlcl9wYXNzd29yZCI7CiRzdG9yZWRfaGFzaGVkX3Bhc3N3b3JkID0gJyQyeSQxMCRFOU4xLi4uJzsgLy8gRXhhbXBsZSBoYXNoZWQgcGFzc3dvcmQgZnJvbSBkYXRhYmFzZQoKaWYgKHBhc3N3b3JkX3ZlcmlmeSgkZW50ZXJlZF9wYXNzd29yZCwgJHN0b3JlZF9oYXNoZWRfcGFzc3dvcmQpKSB7CiAgICBlY2hvICJQYXNzd29yZCBpcyB2YWxpZCEiOwp9IGVsc2UgewogICAgZWNobyAiSW52YWxpZCBwYXNzd29yZC4iOwp9Cj8+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$entered_password = &quot;user_password&quot;;
$stored_hashed_password = '$2y$10$E9N1...'; // Example hashed password from database

if (password_verify($entered_password, $stored_hashed_password)) {
    echo &quot;Password is valid!&quot;;
} else {
    echo &quot;Invalid password.&quot;;
}
?&gt;</pre></div><div class='content'><ul>
<li><code>password_hash()</code>: Creates a password hash.</li>
<li><code>password_verify()</code>: Verifies that a password matches a hash.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Form security in PHP involves multiple layers of protection, including input validation and sanitization, SQL injection prevention, XSS prevention, CSRF protection, and secure password handling. By implementing these practices, you can significantly enhance the security of your web applications and protect both your data and your users.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='form-validation'>&#x25C4;Form Validation</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Form Security in PHP</a>
	</div>
	<div class='col-4 text-end'>
					<a href='working-with-arrays'>Working with Arrays &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
