<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Security</title>

    <link rel="alternate" href="https://campusempresa.com/mod/php/05-04-form-security" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/php/05-04-form-security" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/php/05-04-form-security" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/php/05-04-form-security" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/php/05-04-form-security" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-03-file-uploads' title="File Uploads">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Form Security</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-01-reading-writing-files' title="Reading and Writing Files">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will cover the essential practices and techniques to secure forms in PHP. Forms are a common entry point for user data, and without proper security measures, they can be exploited by malicious users. We will discuss various methods to protect your forms from common attacks such as Cross-Site Scripting (XSS), Cross-Site Request Forgery (CSRF), and SQL Injection.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Input Validation and Sanitization</strong></li>
<li><strong>Cross-Site Scripting (XSS) Prevention</strong></li>
<li><strong>Cross-Site Request Forgery (CSRF) Protection</strong></li>
<li><strong>SQL Injection Prevention</strong></li>
<li><strong>Using HTTPS</strong></li>
</ol>
</div><h1><ol>
<li>Input Validation and Sanitization</li>
</ol>
</h1>
<div class='content'></div><h2><p>Input Validation</p>
</h2>
<div class='content'><p>Input validation ensures that the data entered by the user meets the expected format and type. This can be done using PHP's built-in functions.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRXhhbXBsZSBvZiBpbnB1dCB2YWxpZGF0aW9uCmlmIChmaWx0ZXJfdmFyKCRfUE9TVFsnZW1haWwnXSwgRklMVEVSX1ZBTElEQVRFX0VNQUlMKSA9PT0gZmFsc2UpIHsKICAgIGVjaG8gIkludmFsaWQgZW1haWwgZm9ybWF0IjsKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Example of input validation
if (filter_var($_POST['email'], FILTER_VALIDATE_EMAIL) === false) {
    echo &quot;Invalid email format&quot;;
}</pre></div><div class='content'></div><h2><p>Input Sanitization</p>
</h2>
<div class='content'><p>Sanitization removes or encodes unwanted characters from the input data to prevent malicious code execution.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRXhhbXBsZSBvZiBpbnB1dCBzYW5pdGl6YXRpb24KJG5hbWUgPSBmaWx0ZXJfdmFyKCRfUE9TVFsnbmFtZSddLCBGSUxURVJfU0FOSVRJWkVfU1RSSU5HKTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Example of input sanitization
$name = filter_var($_POST['name'], FILTER_SANITIZE_STRING);</pre></div><div class='content'></div><h1><ol start="2">
<li>Cross-Site Scripting (XSS) Prevention</li>
</ol>
</h1>
<div class='content'><p>XSS attacks occur when an attacker injects malicious scripts into web pages viewed by other users. To prevent XSS, always escape output data.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRXhhbXBsZSBvZiBlc2NhcGluZyBvdXRwdXQgZGF0YQplY2hvIGh0bWxzcGVjaWFsY2hhcnMoJG5hbWUsIEVOVF9RVU9URVMsICdVVEYtOCcpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Example of escaping output data
echo htmlspecialchars($name, ENT_QUOTES, 'UTF-8');</pre></div><div class='content'></div><h1><ol start="3">
<li>Cross-Site Request Forgery (CSRF) Protection</li>
</ol>
</h1>
<div class='content'><p>CSRF attacks trick users into performing actions they did not intend to. To protect against CSRF, use tokens to verify the authenticity of form submissions.</p>
</div><h2><p>Generating a CSRF Token</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gR2VuZXJhdGUgYSBDU1JGIHRva2VuCnNlc3Npb25fc3RhcnQoKTsKaWYgKGVtcHR5KCRfU0VTU0lPTlsnY3NyZl90b2tlbiddKSkgewogICAgJF9TRVNTSU9OWydjc3JmX3Rva2VuJ10gPSBiaW4yaGV4KHJhbmRvbV9ieXRlcygzMikpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Generate a CSRF token
session_start();
if (empty($_SESSION['csrf_token'])) {
    $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
}</pre></div><div class='content'></div><h2><p>Including the CSRF Token in Forms</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGZvcm0gbWV0aG9kPSJwb3N0IiBhY3Rpb249InN1Ym1pdC5waHAiPgogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iY3NyZl90b2tlbiIgdmFsdWU9Ijw/cGhwIGVjaG8gJF9TRVNTSU9OWydjc3JmX3Rva2VuJ107ID8+Ij4KICAgIDwhLS0gT3RoZXIgZm9ybSBmaWVsZHMgLS0+CiAgICA8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iU3VibWl0Ij4KPC9mb3JtPg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;form method=&quot;post&quot; action=&quot;submit.php&quot;&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;csrf_token&quot; value=&quot;&lt;?php echo $_SESSION['csrf_token']; ?&gt;&quot;&gt;
    &lt;!-- Other form fields --&gt;
    &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;
&lt;/form&gt;</pre></div><div class='content'></div><h2><p>Verifying the CSRF Token</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gVmVyaWZ5IHRoZSBDU1JGIHRva2VuCnNlc3Npb25fc3RhcnQoKTsKaWYgKCRfUE9TVFsnY3NyZl90b2tlbiddICE9PSAkX1NFU1NJT05bJ2NzcmZfdG9rZW4nXSkgewogICAgZGllKCJDU1JGIHRva2VuIHZhbGlkYXRpb24gZmFpbGVkIik7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Verify the CSRF token
session_start();
if ($_POST['csrf_token'] !== $_SESSION['csrf_token']) {
    die(&quot;CSRF token validation failed&quot;);
}</pre></div><div class='content'></div><h1><ol start="4">
<li>SQL Injection Prevention</li>
</ol>
</h1>
<div class='content'><p>SQL Injection attacks occur when an attacker manipulates SQL queries by injecting malicious SQL code. Use prepared statements to prevent SQL injection.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRXhhbXBsZSBvZiB1c2luZyBwcmVwYXJlZCBzdGF0ZW1lbnRzCiRjb25uID0gbmV3IG15c3FsaSgkc2VydmVybmFtZSwgJHVzZXJuYW1lLCAkcGFzc3dvcmQsICRkYm5hbWUpOwokc3RtdCA9ICRjb25uLT5wcmVwYXJlKCJTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGVtYWlsID0gPyIpOwokc3RtdC0+YmluZF9wYXJhbSgicyIsICRlbWFpbCk7CiRlbWFpbCA9ICRfUE9TVFsnZW1haWwnXTsKJHN0bXQtPmV4ZWN1dGUoKTsKJHJlc3VsdCA9ICRzdG10LT5nZXRfcmVzdWx0KCk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Example of using prepared statements
$conn = new mysqli($servername, $username, $password, $dbname);
$stmt = $conn-&gt;prepare(&quot;SELECT * FROM users WHERE email = ?&quot;);
$stmt-&gt;bind_param(&quot;s&quot;, $email);
$email = $_POST['email'];
$stmt-&gt;execute();
$result = $stmt-&gt;get_result();</pre></div><div class='content'></div><h1><ol start="5">
<li>Using HTTPS</li>
</ol>
</h1>
<div class='content'><p>Always use HTTPS to encrypt data transmitted between the client and server. This prevents attackers from intercepting sensitive information.</p>
</div><h2><p>Enforcing HTTPS</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gUmVkaXJlY3QgdG8gSFRUUFMKaWYgKCFpc3NldCgkX1NFUlZFUlsnSFRUUFMnXSkgfHwgJF9TRVJWRVJbJ0hUVFBTJ10gIT09ICdvbicpIHsKICAgIGhlYWRlcigiTG9jYXRpb246IGh0dHBzOi8vIiAuICRfU0VSVkVSWydIVFRQX0hPU1QnXSAuICRfU0VSVkVSWydSRVFVRVNUX1VSSSddKTsKICAgIGV4aXQoKTsKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Redirect to HTTPS
if (!isset($_SERVER['HTTPS']) || $_SERVER['HTTPS'] !== 'on') {
    header(&quot;Location: https://&quot; . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI']);
    exit();
}</pre></div><div class='content'></div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Secure a Form</p>
</h2>
<div class='content'><ol>
<li>Create a form that collects a user's name and email.</li>
<li>Implement input validation and sanitization.</li>
<li>Add CSRF protection.</li>
<li>Use prepared statements to insert the data into a database.</li>
<li>Ensure the form is submitted over HTTPS.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gZm9ybS5waHAKc2Vzc2lvbl9zdGFydCgpOwppZiAoZW1wdHkoJF9TRVNTSU9OWydjc3JmX3Rva2VuJ10pKSB7CiAgICAkX1NFU1NJT05bJ2NzcmZfdG9rZW4nXSA9IGJpbjJoZXgocmFuZG9tX2J5dGVzKDMyKSk7Cn0KPz4KPCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDx0aXRsZT5TZWN1cmUgRm9ybTwvdGl0bGU+CjwvaGVhZD4KPGJvZHk+CiAgICA8Zm9ybSBtZXRob2Q9InBvc3QiIGFjdGlvbj0ic3VibWl0LnBocCI+CiAgICAgICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iY3NyZl90b2tlbiIgdmFsdWU9Ijw/cGhwIGVjaG8gJF9TRVNTSU9OWydjc3JmX3Rva2VuJ107ID8+Ij4KICAgICAgICBOYW1lOiA8aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0ibmFtZSI+PGJyPgogICAgICAgIEVtYWlsOiA8aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0iZW1haWwiPjxicj4KICAgICAgICA8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iU3VibWl0Ij4KICAgIDwvZm9ybT4KPC9ib2R5Pgo8L2h0bWw+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// form.php
session_start();
if (empty($_SESSION['csrf_token'])) {
    $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
}
?&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Secure Form&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form method=&quot;post&quot; action=&quot;submit.php&quot;&gt;
        &lt;input type=&quot;hidden&quot; name=&quot;csrf_token&quot; value=&quot;&lt;?php echo $_SESSION['csrf_token']; ?&gt;&quot;&gt;
        Name: &lt;input type=&quot;text&quot; name=&quot;name&quot;&gt;&lt;br&gt;
        Email: &lt;input type=&quot;text&quot; name=&quot;email&quot;&gt;&lt;br&gt;
        &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gc3VibWl0LnBocApzZXNzaW9uX3N0YXJ0KCk7CmlmICgkX1BPU1RbJ2NzcmZfdG9rZW4nXSAhPT0gJF9TRVNTSU9OWydjc3JmX3Rva2VuJ10pIHsKICAgIGRpZSgiQ1NSRiB0b2tlbiB2YWxpZGF0aW9uIGZhaWxlZCIpOwp9CgokbmFtZSA9IGZpbHRlcl92YXIoJF9QT1NUWyduYW1lJ10sIEZJTFRFUl9TQU5JVElaRV9TVFJJTkcpOwokZW1haWwgPSBmaWx0ZXJfdmFyKCRfUE9TVFsnZW1haWwnXSwgRklMVEVSX1ZBTElEQVRFX0VNQUlMKTsKCmlmICgkZW1haWwgPT09IGZhbHNlKSB7CiAgICBkaWUoIkludmFsaWQgZW1haWwgZm9ybWF0Iik7Cn0KCiRjb25uID0gbmV3IG15c3FsaSgkc2VydmVybmFtZSwgJHVzZXJuYW1lLCAkcGFzc3dvcmQsICRkYm5hbWUpOwokc3RtdCA9ICRjb25uLT5wcmVwYXJlKCJJTlNFUlQgSU5UTyB1c2VycyAobmFtZSwgZW1haWwpIFZBTFVFUyAoPywgPykiKTsKJHN0bXQtPmJpbmRfcGFyYW0oInNzIiwgJG5hbWUsICRlbWFpbCk7CiRzdG10LT5leGVjdXRlKCk7CgplY2hvICJEYXRhIHN1Ym1pdHRlZCBzdWNjZXNzZnVsbHkiOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// submit.php
session_start();
if ($_POST['csrf_token'] !== $_SESSION['csrf_token']) {
    die(&quot;CSRF token validation failed&quot;);
}

$name = filter_var($_POST['name'], FILTER_SANITIZE_STRING);
$email = filter_var($_POST['email'], FILTER_VALIDATE_EMAIL);

if ($email === false) {
    die(&quot;Invalid email format&quot;);
}

$conn = new mysqli($servername, $username, $password, $dbname);
$stmt = $conn-&gt;prepare(&quot;INSERT INTO users (name, email) VALUES (?, ?)&quot;);
$stmt-&gt;bind_param(&quot;ss&quot;, $name, $email);
$stmt-&gt;execute();

echo &quot;Data submitted successfully&quot;;</pre></div><div class='content'></div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered the essential techniques to secure forms in PHP. By validating and sanitizing input, preventing XSS and CSRF attacks, using prepared statements to prevent SQL injection, and enforcing HTTPS, you can significantly enhance the security of your web applications. These practices are crucial for protecting both your application and its users from malicious attacks.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-03-file-uploads' title="File Uploads">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-01-reading-writing-files' title="Reading and Writing Files">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
