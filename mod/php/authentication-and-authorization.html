<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication and Authorization in PHP</title>

    <link rel="alternate" href="https://campusempresa.com/mod/php/authentication-and-authorization" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/php/authentication-and-authorization" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/php/authentication-and-authorization" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/php/authentication-and-authorization" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/php/authentication-and-authorization" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='using-https'>&#x25C4;Using HTTPS</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Authentication and Authorization in PHP</a>
	</div>
	<div class='col-4 text-end'>
					<a href='coding-standards'>Coding Standards &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Authentication and authorization are critical components of web application security. Authentication verifies the identity of a user, while authorization determines what an authenticated user is allowed to do. This section will guide you through the basics to advanced concepts of implementing authentication and authorization in PHP.</p>
</div><h1>Authentication</h1>
<div class='content'></div><h2>What is Authentication?</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: The process of verifying the identity of a user.</li>
<li><strong>Common Methods</strong>: Username and password, OAuth, JWT (JSON Web Tokens).</li>
</ul>
</div><h2>Basic Authentication with PHP</h2>
<div class='content'><h4>Example: Simple Login System</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKc2Vzc2lvbl9zdGFydCgpOwoKJHVzZXJzID0gWwogICAgJ2FkbWluJyA9PiAncGFzc3dvcmQxMjMnLAogICAgJ3VzZXInID0+ICd1c2VycGFzcycKXTsKCmlmICgkX1NFUlZFUlsnUkVRVUVTVF9NRVRIT0QnXSA9PSAnUE9TVCcpIHsKICAgICR1c2VybmFtZSA9ICRfUE9TVFsndXNlcm5hbWUnXTsKICAgICRwYXNzd29yZCA9ICRfUE9TVFsncGFzc3dvcmQnXTsKCiAgICBpZiAoaXNzZXQoJHVzZXJzWyR1c2VybmFtZV0pICYmICR1c2Vyc1skdXNlcm5hbWVdID09ICRwYXNzd29yZCkgewogICAgICAgICRfU0VTU0lPTlsndXNlcm5hbWUnXSA9ICR1c2VybmFtZTsKICAgICAgICBlY2hvICJMb2dpbiBzdWNjZXNzZnVsISBXZWxjb21lLCAiIC4gJHVzZXJuYW1lOwogICAgfSBlbHNlIHsKICAgICAgICBlY2hvICJJbnZhbGlkIHVzZXJuYW1lIG9yIHBhc3N3b3JkLiI7CiAgICB9Cn0KPz4KCjxmb3JtIG1ldGhvZD0icG9zdCI+CiAgICBVc2VybmFtZTogPGlucHV0IHR5cGU9InRleHQiIG5hbWU9InVzZXJuYW1lIiByZXF1aXJlZD4KICAgIFBhc3N3b3JkOiA8aW5wdXQgdHlwZT0icGFzc3dvcmQiIG5hbWU9InBhc3N3b3JkIiByZXF1aXJlZD4KICAgIDxidXR0b24gdHlwZT0ic3VibWl0Ij5Mb2dpbjwvYnV0dG9uPgo8L2Zvcm0+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
session_start();

$users = [
    'admin' =&gt; 'password123',
    'user' =&gt; 'userpass'
];

if ($_SERVER['REQUEST_METHOD'] == 'POST') {
    $username = $_POST['username'];
    $password = $_POST['password'];

    if (isset($users[$username]) &amp;&amp; $users[$username] == $password) {
        $_SESSION['username'] = $username;
        echo &quot;Login successful! Welcome, &quot; . $username;
    } else {
        echo &quot;Invalid username or password.&quot;;
    }
}
?&gt;

&lt;form method=&quot;post&quot;&gt;
    Username: &lt;input type=&quot;text&quot; name=&quot;username&quot; required&gt;
    Password: &lt;input type=&quot;password&quot; name=&quot;password&quot; required&gt;
    &lt;button type=&quot;submit&quot;&gt;Login&lt;/button&gt;
&lt;/form&gt;</pre></div><div class='content'></div><h2>Storing Passwords Securely</h2>
<div class='content'><ul>
<li><strong>Hashing</strong>: Use <code>password_hash()</code> to hash passwords before storing them.</li>
<li><strong>Verification</strong>: Use <code>password_verify()</code> to check the hashed password.</li>
</ul>
<h4>Example: Storing and Verifying Passwords</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJHBhc3N3b3JkID0gJ3VzZXJwYXNzJzsKJGhhc2hlZFBhc3N3b3JkID0gcGFzc3dvcmRfaGFzaCgkcGFzc3dvcmQsIFBBU1NXT1JEX0RFRkFVTFQpOwoKZWNobyAiSGFzaGVkIFBhc3N3b3JkOiAiIC4gJGhhc2hlZFBhc3N3b3JkIC4gIjxicj4iOwoKaWYgKHBhc3N3b3JkX3ZlcmlmeSgkcGFzc3dvcmQsICRoYXNoZWRQYXNzd29yZCkpIHsKICAgIGVjaG8gIlBhc3N3b3JkIGlzIHZhbGlkISI7Cn0gZWxzZSB7CiAgICBlY2hvICJJbnZhbGlkIHBhc3N3b3JkLiI7Cn0KPz4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$password = 'userpass';
$hashedPassword = password_hash($password, PASSWORD_DEFAULT);

echo &quot;Hashed Password: &quot; . $hashedPassword . &quot;&lt;br&gt;&quot;;

if (password_verify($password, $hashedPassword)) {
    echo &quot;Password is valid!&quot;;
} else {
    echo &quot;Invalid password.&quot;;
}
?&gt;</pre></div><div class='content'></div><h1>Authorization</h1>
<div class='content'></div><h2>What is Authorization?</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: The process of determining what an authenticated user is allowed to do.</li>
<li><strong>Common Methods</strong>: Role-based access control (RBAC), permissions.</li>
</ul>
</div><h2>Role-Based Access Control (RBAC)</h2>
<div class='content'><ul>
<li><strong>Roles</strong>: Define roles like 'admin', 'editor', 'viewer'.</li>
<li><strong>Permissions</strong>: Assign permissions to roles.</li>
</ul>
<h4>Example: Implementing RBAC</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKc2Vzc2lvbl9zdGFydCgpOwoKJHJvbGVzID0gWwogICAgJ2FkbWluJyA9PiBbJ2NyZWF0ZScsICdlZGl0JywgJ2RlbGV0ZScsICd2aWV3J10sCiAgICAnZWRpdG9yJyA9PiBbJ2VkaXQnLCAndmlldyddLAogICAgJ3ZpZXdlcicgPT4gWyd2aWV3J10KXTsKCmZ1bmN0aW9uIGNoZWNrUGVybWlzc2lvbigkcm9sZSwgJHBlcm1pc3Npb24pIHsKICAgIGdsb2JhbCAkcm9sZXM7CiAgICByZXR1cm4gaW5fYXJyYXkoJHBlcm1pc3Npb24sICRyb2xlc1skcm9sZV0pOwp9CgokX1NFU1NJT05bJ3JvbGUnXSA9ICdlZGl0b3InOwoKaWYgKGNoZWNrUGVybWlzc2lvbigkX1NFU1NJT05bJ3JvbGUnXSwgJ2RlbGV0ZScpKSB7CiAgICBlY2hvICJQZXJtaXNzaW9uIGdyYW50ZWQgdG8gZGVsZXRlLiI7Cn0gZWxzZSB7CiAgICBlY2hvICJQZXJtaXNzaW9uIGRlbmllZCB0byBkZWxldGUuIjsKfQo/Pg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
session_start();

$roles = [
    'admin' =&gt; ['create', 'edit', 'delete', 'view'],
    'editor' =&gt; ['edit', 'view'],
    'viewer' =&gt; ['view']
];

function checkPermission($role, $permission) {
    global $roles;
    return in_array($permission, $roles[$role]);
}

$_SESSION['role'] = 'editor';

if (checkPermission($_SESSION['role'], 'delete')) {
    echo &quot;Permission granted to delete.&quot;;
} else {
    echo &quot;Permission denied to delete.&quot;;
}
?&gt;</pre></div><div class='content'></div><h1>Advanced Authentication and Authorization</h1>
<div class='content'></div><h2>Using OAuth for Authentication</h2>
<div class='content'><ul>
<li><strong>OAuth</strong>: An open standard for access delegation commonly used for token-based authentication.</li>
<li><strong>Providers</strong>: Google, Facebook, GitHub.</li>
</ul>
<h4>Example: OAuth with Google (Conceptual Overview)</h4>
<ol>
<li><strong>Register Application</strong>: Register your application with Google to get client ID and client secret.</li>
<li><strong>Redirect to Google</strong>: Redirect users to Google for authentication.</li>
<li><strong>Handle Callback</strong>: Handle the callback from Google and retrieve the access token.</li>
<li><strong>Fetch User Data</strong>: Use the access token to fetch user data from Google.</li>
</ol>
</div><h2>JSON Web Tokens (JWT)</h2>
<div class='content'><ul>
<li><strong>JWT</strong>: A compact, URL-safe means of representing claims to be transferred between two parties.</li>
<li><strong>Structure</strong>: Header, Payload, Signature.</li>
</ul>
<h4>Example: Generating and Verifying JWT</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKcmVxdWlyZSAndmVuZG9yL2F1dG9sb2FkLnBocCc7CnVzZSBcRmlyZWJhc2VcSldUXEpXVDsKCiRrZXkgPSAiZXhhbXBsZV9rZXkiOwokcGF5bG9hZCA9IFsKICAgICdpc3MnID0+ICJodHRwOi8vZXhhbXBsZS5vcmciLAogICAgJ2F1ZCcgPT4gImh0dHA6Ly9leGFtcGxlLmNvbSIsCiAgICAnaWF0JyA9PiAxMzU2OTk5NTI0LAogICAgJ25iZicgPT4gMTM1NzAwMDAwMApdOwoKJGp3dCA9IEpXVDo6ZW5jb2RlKCRwYXlsb2FkLCAka2V5KTsKZWNobyAiSldUOiAiIC4gJGp3dCAuICI8YnI+IjsKCiRkZWNvZGVkID0gSldUOjpkZWNvZGUoJGp3dCwgJGtleSwgYXJyYXkoJ0hTMjU2JykpOwpwcmludF9yKCRkZWNvZGVkKTsKPz4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
require 'vendor/autoload.php';
use \Firebase\JWT\JWT;

$key = &quot;example_key&quot;;
$payload = [
    'iss' =&gt; &quot;http://example.org&quot;,
    'aud' =&gt; &quot;http://example.com&quot;,
    'iat' =&gt; 1356999524,
    'nbf' =&gt; 1357000000
];

$jwt = JWT::encode($payload, $key);
echo &quot;JWT: &quot; . $jwt . &quot;&lt;br&gt;&quot;;

$decoded = JWT::decode($jwt, $key, array('HS256'));
print_r($decoded);
?&gt;</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Authentication and authorization are essential for securing web applications. This section covered the basics of implementing authentication and authorization in PHP, from simple login systems to advanced methods like OAuth and JWT. By understanding and applying these concepts, you can ensure that your applications are both secure and user-friendly.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='using-https'>&#x25C4;Using HTTPS</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Authentication and Authorization in PHP</a>
	</div>
	<div class='col-4 text-end'>
					<a href='coding-standards'>Coding Standards &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
