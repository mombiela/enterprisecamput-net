<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Subroutines and Functions</title>

    <link rel="alternate" href="https://campusempresa.com/mod/vms/04-04-subroutines-functions" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/vms/04-04-subroutines-functions" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/vms/04-04-subroutines-functions" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/vms/04-04-subroutines-functions" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/vms/04-04-subroutines-functions" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>All the knowledge within your reach</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					 				<a href="/"><i class="bi bi-house-fill"></i> HOME</a>
											</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-03-control-structures' title="Control Structures">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Subroutines and Functions</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-05-error-handling' title="Error Handling">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into the concepts of subroutines and functions in DCL (Digital Command Language) scripting on OpenVMS. Understanding how to create and use subroutines and functions will help you write more modular, reusable, and maintainable scripts.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Subroutines</strong>: Blocks of code that perform a specific task and can be called from different parts of a script.</li>
<li><strong>Functions</strong>: Similar to subroutines but typically return a value to the caller.</li>
<li><strong>Modularity</strong>: Breaking down a script into smaller, manageable pieces.</li>
<li><strong>Reusability</strong>: Writing code that can be reused in different scripts or parts of the same script.</li>
</ol>
</div><h1>Creating Subroutines</h1>
<div class='content'><p>Subroutines in DCL are defined using the <code>CALL</code> and <code>SUBROUTINE</code> commands. Here is a basic example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JCEgRGVmaW5lIGEgc3Vicm91dGluZQokIFNVQlJPVVRJTkUgTVlfU1VCUk9VVElORQokICAgV1JJVEUgU1lTJE9VVFBVVCAiVGhpcyBpcyBhIHN1YnJvdXRpbmUuIgokICAgUkVUVVJOCiQgRU5EX1NVQlJPVVRJTkUKCiQhIE1haW4gc2NyaXB0CiQgQ0FMTCBNWV9TVUJST1VUSU5FCiQgRVhJVA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$! Define a subroutine
$ SUBROUTINE MY_SUBROUTINE
$   WRITE SYS$OUTPUT &quot;This is a subroutine.&quot;
$   RETURN
$ END_SUBROUTINE

$! Main script
$ CALL MY_SUBROUTINE
$ EXIT</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>SUBROUTINE MY_SUBROUTINE</strong>: Defines a subroutine named <code>MY_SUBROUTINE</code>.</li>
<li><strong>WRITE SYS$OUTPUT &quot;This is a subroutine.&quot;</strong>: Prints a message to the output.</li>
<li><strong>RETURN</strong>: Ends the subroutine.</li>
<li><strong>END_SUBROUTINE</strong>: Marks the end of the subroutine definition.</li>
<li><strong>CALL MY_SUBROUTINE</strong>: Calls the subroutine from the main script.</li>
</ul>
</div><h1>Creating Functions</h1>
<div class='content'><p>Functions in DCL are similar to subroutines but are designed to return a value. Here is an example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JCEgRGVmaW5lIGEgZnVuY3Rpb24KJCBGVU5DVElPTiBBRERfTlVNQkVSUwokICAgUDEgPSBQMSArIFAyCiQgICBSRVRVUk4gUDEKJCBFTkRfRlVOQ1RJT04KCiQhIE1haW4gc2NyaXB0CiQgQSA9IDUKJCBCID0gMTAKJCBSRVNVTFQgPSBGJENBTEwoIkFERF9OVU1CRVJTIiwgQSwgQikKJCBXUklURSBTWVMkT1VUUFVUICJUaGUgcmVzdWx0IGlzOiAiLCBSRVNVTFQKJCBFWElU"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$! Define a function
$ FUNCTION ADD_NUMBERS
$   P1 = P1 + P2
$   RETURN P1
$ END_FUNCTION

$! Main script
$ A = 5
$ B = 10
$ RESULT = F$CALL(&quot;ADD_NUMBERS&quot;, A, B)
$ WRITE SYS$OUTPUT &quot;The result is: &quot;, RESULT
$ EXIT</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>FUNCTION ADD_NUMBERS</strong>: Defines a function named <code>ADD_NUMBERS</code>.</li>
<li><strong>P1 = P1 + P2</strong>: Adds two parameters.</li>
<li><strong>RETURN P1</strong>: Returns the result of the addition.</li>
<li><strong>END_FUNCTION</strong>: Marks the end of the function definition.</li>
<li><strong>F$CALL(&quot;ADD_NUMBERS&quot;, A, B)</strong>: Calls the function with parameters <code>A</code> and <code>B</code>.</li>
</ul>
</div><h1>Practical Example</h1>
<div class='content'><p>Let's create a more complex example that combines subroutines and functions to perform a series of tasks.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JCEgRGVmaW5lIGEgZnVuY3Rpb24gdG8gYWRkIHR3byBudW1iZXJzCiQgRlVOQ1RJT04gQUREX05VTUJFUlMKJCAgIFAxID0gUDEgKyBQMgokICAgUkVUVVJOIFAxCiQgRU5EX0ZVTkNUSU9OCgokISBEZWZpbmUgYSBzdWJyb3V0aW5lIHRvIHByaW50IGEgbWVzc2FnZQokIFNVQlJPVVRJTkUgUFJJTlRfTUVTU0FHRQokICAgV1JJVEUgU1lTJE9VVFBVVCBQMQokICAgUkVUVVJOCiQgRU5EX1NVQlJPVVRJTkUKCiQhIE1haW4gc2NyaXB0CiQgQSA9IDUKJCBCID0gMTAKJCBSRVNVTFQgPSBGJENBTEwoIkFERF9OVU1CRVJTIiwgQSwgQikKJCBDQUxMIFBSSU5UX01FU1NBR0UgIlRoZSBzdW0gb2YgIiwgQSwgIiBhbmQgIiwgQiwgIiBpczogIiwgUkVTVUxUCiQgRVhJVA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$! Define a function to add two numbers
$ FUNCTION ADD_NUMBERS
$   P1 = P1 + P2
$   RETURN P1
$ END_FUNCTION

$! Define a subroutine to print a message
$ SUBROUTINE PRINT_MESSAGE
$   WRITE SYS$OUTPUT P1
$   RETURN
$ END_SUBROUTINE

$! Main script
$ A = 5
$ B = 10
$ RESULT = F$CALL(&quot;ADD_NUMBERS&quot;, A, B)
$ CALL PRINT_MESSAGE &quot;The sum of &quot;, A, &quot; and &quot;, B, &quot; is: &quot;, RESULT
$ EXIT</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>ADD_NUMBERS</strong>: Function to add two numbers.</li>
<li><strong>PRINT_MESSAGE</strong>: Subroutine to print a message.</li>
<li><strong>F$CALL(&quot;ADD_NUMBERS&quot;, A, B)</strong>: Calls the <code>ADD_NUMBERS</code> function.</li>
<li><strong>CALL PRINT_MESSAGE &quot;The sum of &quot;, A, &quot; and &quot;, B, &quot; is: &quot;, RESULT</strong>: Calls the <code>PRINT_MESSAGE</code> subroutine with a concatenated message.</li>
</ul>
</div><h1>Exercises</h1>
<div class='content'></div><h2>Exercise 1: Create a Subroutine</h2>
<div class='content'><p>Create a subroutine named <code>GREET_USER</code> that takes a user's name as a parameter and prints a greeting message.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JCBTVUJST1VUSU5FIEdSRUVUX1VTRVIKJCAgIFdSSVRFIFNZUyRPVVRQVVQgIkhlbGxvLCAiLCBQMSwgIiEiCiQgICBSRVRVUk4KJCBFTkRfU1VCUk9VVElORQoKJCEgTWFpbiBzY3JpcHQKJCBDQUxMIEdSRUVUX1VTRVIgIkFsaWNlIgokIEVYSVQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$ SUBROUTINE GREET_USER
$   WRITE SYS$OUTPUT &quot;Hello, &quot;, P1, &quot;!&quot;
$   RETURN
$ END_SUBROUTINE

$! Main script
$ CALL GREET_USER &quot;Alice&quot;
$ EXIT</pre></div><div class='content'></div><h2>Exercise 2: Create a Function</h2>
<div class='content'><p>Create a function named <code>MULTIPLY_NUMBERS</code> that takes two numbers as parameters and returns their product.</p>
<p><strong>Solution:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JCBGVU5DVElPTiBNVUxUSVBMWV9OVU1CRVJTCiQgICBQMSA9IFAxICogUDIKJCAgIFJFVFVSTiBQMQokIEVORF9GVU5DVElPTgoKJCEgTWFpbiBzY3JpcHQKJCBBID0gNAokIEIgPSA3CiQgUkVTVUxUID0gRiRDQUxMKCJNVUxUSVBMWV9OVU1CRVJTIiwgQSwgQikKJCBXUklURSBTWVMkT1VUUFVUICJUaGUgcHJvZHVjdCBpczogIiwgUkVTVUxUCiQgRVhJVA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$ FUNCTION MULTIPLY_NUMBERS
$   P1 = P1 * P2
$   RETURN P1
$ END_FUNCTION

$! Main script
$ A = 4
$ B = 7
$ RESULT = F$CALL(&quot;MULTIPLY_NUMBERS&quot;, A, B)
$ WRITE SYS$OUTPUT &quot;The product is: &quot;, RESULT
$ EXIT</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Forgetting to use <code>RETURN</code></strong>: Always use <code>RETURN</code> to end a subroutine or function.</li>
<li><strong>Incorrect parameter passing</strong>: Ensure parameters are passed correctly using <code>P1</code>, <code>P2</code>, etc.</li>
<li><strong>Not using <code>F$CALL</code> for functions</strong>: Use <code>F$CALL</code> to call functions and retrieve their return values.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the basics of creating and using subroutines and functions in DCL scripting. By breaking down your scripts into smaller, reusable components, you can write more efficient and maintainable code. Practice creating your own subroutines and functions to become more proficient in DCL scripting.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-03-control-structures' title="Control Structures">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-05-error-handling' title="Error Handling">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			









		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
