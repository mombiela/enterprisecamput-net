<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interfacing with System Services</title>

    <link rel="alternate" href="https://campusempresa.com/mod/vms/interfacing-with-system-services" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/vms/interfacing-with-system-services" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/vms/interfacing-with-system-services" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/vms/interfacing-with-system-services" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/vms/interfacing-with-system-services" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='advanced-dcl-scripting-techniques'>&#x25C4;Advanced DCL Scripting Techniques</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Interfacing with System Services</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-lexical-functions'>Using Lexical Functions &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Interfacing with system services in OpenVMS is a crucial skill for developers working on this operating system. System services provide a way to interact with the underlying hardware and system resources, enabling tasks such as file manipulation, process control, and inter-process communication.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>System Services</strong>: Functions provided by the OpenVMS operating system to perform various low-level operations.</li>
<li><strong>Calling Conventions</strong>: The specific way in which functions are called and parameters are passed in OpenVMS.</li>
<li><strong>Status Codes</strong>: Return values from system services that indicate success or failure.</li>
<li><strong>Descriptors</strong>: Data structures used to describe the format and location of data.</li>
</ul>
</div><h1>Basic System Services</h1>
<h2>Introduction to System Services</h2>
<div class='content'><p>System services in OpenVMS are invoked using a specific calling convention. They are typically prefixed with <code>SYS$</code> and are designed to be used from various programming languages, including C and Fortran.</p>
</div><h2>Example: SYS$GETJPI</h2>
<div class='content'><p>The <code>SYS$GETJPI</code> system service retrieves information about a process. Here is a simple example in C:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxkZXNjcmlwLmg+CiNpbmNsdWRlIDxqcGlkZWYuaD4KI2luY2x1ZGUgPHNzZGVmLmg+CiNpbmNsdWRlIDxzdGFybGV0Lmg+CgppbnQgbWFpbigpIHsKICAgIHVuc2lnbmVkIGxvbmcgc3RhdHVzOwogICAgdW5zaWduZWQgbG9uZyBwaWQgPSAwOyAvLyAwIG1lYW5zIGN1cnJlbnQgcHJvY2VzcwogICAgdW5zaWduZWQgbG9uZyBpdGVtID0gSlBJJF9QSUQ7IC8vIEl0ZW0gY29kZSBmb3IgcHJvY2VzcyBJRAogICAgdW5zaWduZWQgbG9uZyB2YWx1ZTsKICAgIHN0cnVjdCBfZ2VuZXJpY182NCBpdGVtbGlzdFsyXTsKCiAgICBpdGVtbGlzdFswXS5sZW5ndGggPSBzaXplb2YodmFsdWUpOwogICAgaXRlbWxpc3RbMF0uY29kZSA9IGl0ZW07CiAgICBpdGVtbGlzdFswXS5idWZmZXIgPSAmdmFsdWU7CiAgICBpdGVtbGlzdFswXS5yZXR1cm5fbGVuZ3RoID0gMDsKICAgIGl0ZW1saXN0WzFdLmxlbmd0aCA9IDA7IC8vIEVuZCBvZiBsaXN0CgogICAgc3RhdHVzID0gU1lTJEdFVEpQSVcoMCwgJnBpZCwgMCwgaXRlbWxpc3QsIDAsIDAsIDApOwoKICAgIGlmIChzdGF0dXMgPT0gU1MkX05PUk1BTCkgewogICAgICAgIHByaW50ZigiUHJvY2VzcyBJRDogJWx1XG4iLCB2YWx1ZSk7CiAgICB9IGVsc2UgewogICAgICAgIHByaW50ZigiRXJyb3I6ICVsdVxuIiwgc3RhdHVzKTsKICAgIH0KCiAgICByZXR1cm4gMDsKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#include &lt;stdio.h&gt;
#include &lt;descrip.h&gt;
#include &lt;jpidef.h&gt;
#include &lt;ssdef.h&gt;
#include &lt;starlet.h&gt;

int main() {
    unsigned long status;
    unsigned long pid = 0; // 0 means current process
    unsigned long item = JPI$_PID; // Item code for process ID
    unsigned long value;
    struct _generic_64 itemlist[2];

    itemlist[0].length = sizeof(value);
    itemlist[0].code = item;
    itemlist[0].buffer = &amp;value;
    itemlist[0].return_length = 0;
    itemlist[1].length = 0; // End of list

    status = SYS$GETJPIW(0, &amp;pid, 0, itemlist, 0, 0, 0);

    if (status == SS$_NORMAL) {
        printf(&quot;Process ID: %lu\n&quot;, value);
    } else {
        printf(&quot;Error: %lu\n&quot;, status);
    }

    return 0;
}</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Headers</strong>: Include necessary headers for descriptors, system service definitions, and status codes.</li>
<li><strong>PID</strong>: Process ID, where <code>0</code> indicates the current process.</li>
<li><strong>Item Code</strong>: Specifies what information to retrieve, in this case, the process ID.</li>
<li><strong>Item List</strong>: An array of structures describing the items to retrieve.</li>
<li><strong>SYS$GETJPIW</strong>: The system service call, where <code>W</code> indicates it waits for completion.</li>
</ul>
</div><h1>Advanced System Services</h1>
<h2>Process Control</h2>
<div class='content'><p>Advanced usage of system services includes controlling processes, such as creating, suspending, or terminating them.</p>
</div><h2>Example: SYS$CREPRC</h2>
<div class='content'><p>The <code>SYS$CREPRC</code> system service creates a new process. Here is an example:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxkZXNjcmlwLmg+CiNpbmNsdWRlIDxwcmNkZWYuaD4KI2luY2x1ZGUgPHNzZGVmLmg+CiNpbmNsdWRlIDxzdGFybGV0Lmg+CgppbnQgbWFpbigpIHsKICAgIHVuc2lnbmVkIGxvbmcgc3RhdHVzOwogICAgc3RydWN0IGRzYyRkZXNjcmlwdG9yX3MgaW1hZ2UgPSB7MH07CiAgICBzdHJ1Y3QgZHNjJGRlc2NyaXB0b3JfcyBuYW1lID0gezB9OwogICAgdW5zaWduZWQgbG9uZyBwaWQ7CgogICAgaW1hZ2UuZHNjJHdfbGVuZ3RoID0gc3RybGVuKCJTWVMkU1lTVEVNOkxPR0lOT1VULkVYRSIpOwogICAgaW1hZ2UuZHNjJGFfcG9pbnRlciA9ICJTWVMkU1lTVEVNOkxPR0lOT1VULkVYRSI7CiAgICBpbWFnZS5kc2MkYl9kdHlwZSA9IERTQyRLX0RUWVBFX1Q7CiAgICBpbWFnZS5kc2MkYl9jbGFzcyA9IERTQyRLX0NMQVNTX1M7CgogICAgc3RhdHVzID0gU1lTJENSRVBSQygmcGlkLCAmbmFtZSwgJmltYWdlLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwKTsKCiAgICBpZiAoc3RhdHVzID09IFNTJF9OT1JNQUwpIHsKICAgICAgICBwcmludGYoIlByb2Nlc3MgY3JlYXRlZCB3aXRoIFBJRDogJWx1XG4iLCBwaWQpOwogICAgfSBlbHNlIHsKICAgICAgICBwcmludGYoIkVycm9yOiAlbHVcbiIsIHN0YXR1cyk7CiAgICB9CgogICAgcmV0dXJuIDA7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#include &lt;stdio.h&gt;
#include &lt;descrip.h&gt;
#include &lt;prcdef.h&gt;
#include &lt;ssdef.h&gt;
#include &lt;starlet.h&gt;

int main() {
    unsigned long status;
    struct dsc$descriptor_s image = {0};
    struct dsc$descriptor_s name = {0};
    unsigned long pid;

    image.dsc$w_length = strlen(&quot;SYS$SYSTEM:LOGINOUT.EXE&quot;);
    image.dsc$a_pointer = &quot;SYS$SYSTEM:LOGINOUT.EXE&quot;;
    image.dsc$b_dtype = DSC$K_DTYPE_T;
    image.dsc$b_class = DSC$K_CLASS_S;

    status = SYS$CREPRC(&amp;pid, &amp;name, &amp;image, 0, 0, 0, 0, 0, 0, 0, 0);

    if (status == SS$_NORMAL) {
        printf(&quot;Process created with PID: %lu\n&quot;, pid);
    } else {
        printf(&quot;Error: %lu\n&quot;, status);
    }

    return 0;
}</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Image Descriptor</strong>: Describes the executable image to run.</li>
<li><strong>Name Descriptor</strong>: Describes the process name (optional).</li>
<li><strong>SYS$CREPRC</strong>: The system service call to create a new process.</li>
</ul>
</div><h1>Error Handling</h1>
<h2>Status Codes</h2>
<div class='content'><p>System services return status codes that need to be checked to ensure the operation was successful. Common status codes include:</p>
<ul>
<li><code>SS$_NORMAL</code>: Operation completed successfully.</li>
<li><code>SS$_BADPARAM</code>: Invalid parameter.</li>
<li><code>SS$_NOPRIV</code>: Insufficient privileges.</li>
</ul>
</div><h2>Example: Checking Status Codes</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aWYgKHN0YXR1cyAhPSBTUyRfTk9STUFMKSB7CiAgICBwcmludGYoIkVycm9yOiAlbHVcbiIsIHN0YXR1cyk7CiAgICAvLyBIYW5kbGUgZXJyb3IgYXBwcm9wcmlhdGVseQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>if (status != SS$_NORMAL) {
    printf(&quot;Error: %lu\n&quot;, status);
    // Handle error appropriately
}</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Interfacing with system services in OpenVMS allows developers to perform a wide range of low-level operations essential for system programming. Understanding how to call these services, handle descriptors, and check status codes is fundamental for effective OpenVMS development. By mastering these concepts, developers can leverage the full power of the OpenVMS operating system.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='advanced-dcl-scripting-techniques'>&#x25C4;Advanced DCL Scripting Techniques</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Interfacing with System Services</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-lexical-functions'>Using Lexical Functions &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
