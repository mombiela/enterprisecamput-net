<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using COBOL on OpenVMS</title>

    <link rel="alternate" href="https://campusempresa.com/mod/vms/07-04-using-cobol" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/vms/07-04-using-cobol" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/vms/07-04-using-cobol" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/vms/07-04-using-cobol" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/vms/07-04-using-cobol" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-03-using-fortran' title="Using Fortran on OpenVMS">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Using COBOL on OpenVMS</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-05-interfacing-system-services' title="Interfacing with System Services">Next &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>COBOL (Common Business-Oriented Language) is a high-level programming language designed for business applications. OpenVMS supports COBOL, allowing developers to create robust and efficient business applications. This section will cover the basics of using COBOL on OpenVMS, including setting up the environment, writing and compiling COBOL programs, and practical examples.</p>
</div><h1>Setting Up the Environment</h1>
<div class='content'><p>Before you start writing COBOL programs on OpenVMS, you need to ensure that the COBOL compiler is installed and properly configured.</p>
</div><h2>Steps to Set Up COBOL on OpenVMS</h2>
<div class='content'><ol>
<li>
<p><strong>Check for COBOL Compiler Installation:</strong></p>
<pre><code class="language-shell">$ SHOW LOGICAL COBOL$COMPILER
</code></pre>
<p>If the compiler is installed, this command will display the logical name of the COBOL compiler.</p>
</li>
<li>
<p><strong>Install COBOL Compiler (if not installed):</strong>
Follow the OpenVMS documentation to install the COBOL compiler package.</p>
</li>
<li>
<p><strong>Set Up Environment Variables:</strong>
Ensure that the necessary environment variables are set. This can typically be done in your login script.</p>
<pre><code class="language-shell">$ DEFINE COBOL$COMPILER SYS$SYSTEM:COBOL.EXE
</code></pre>
</li>
</ol>
</div><h1>Writing a COBOL Program</h1>
<div class='content'><p>A COBOL program consists of four main divisions: Identification Division, Environment Division, Data Division, and Procedure Division. Below is a simple COBOL program that prints &quot;Hello, OpenVMS!&quot;.</p>
</div><h2>Example: Hello, OpenVMS!</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEhFTExPLU9QRU5WTVMuCgpFTlZJUk9OTUVOVCBESVZJU0lPTi4KCkRBVEEgRElWSVNJT04uCgpQUk9DRURVUkUgRElWSVNJT04uCiAgICBESVNQTEFZICJIZWxsbywgT3BlblZNUyEiLgogICAgU1RPUCBSVU4u"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. HELLO-OPENVMS.

ENVIRONMENT DIVISION.

DATA DIVISION.

PROCEDURE DIVISION.
    DISPLAY &quot;Hello, OpenVMS!&quot;.
    STOP RUN.</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>IDENTIFICATION DIVISION:</strong> This section identifies the program.</li>
<li><strong>PROGRAM-ID:</strong> Specifies the name of the program.</li>
<li><strong>ENVIRONMENT DIVISION:</strong> Used to specify the environment in which the program will run (not used in this simple example).</li>
<li><strong>DATA DIVISION:</strong> Used to define variables and data structures (not used in this simple example).</li>
<li><strong>PROCEDURE DIVISION:</strong> Contains the executable code. The <code>DISPLAY</code> statement outputs text to the screen, and <code>STOP RUN</code> terminates the program.</li>
</ul>
</div><h1>Compiling and Running COBOL Programs</h1>
<div class='content'></div><h2>Compiling the Program</h2>
<div class='content'><p>To compile the COBOL program, use the following command:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JCBDT0JPTCBIRUxMTy1PUEVOVk1TLkNPQg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$ COBOL HELLO-OPENVMS.COB</pre></div><div class='content'><p>This command will generate an object file (<code>HELLO-OPENVMS.OBJ</code>).</p>
</div><h2>Linking the Program</h2>
<div class='content'><p>Next, link the object file to create an executable:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JCBMSU5LIEhFTExPLU9QRU5WTVM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$ LINK HELLO-OPENVMS</pre></div><div class='content'><p>This command will produce an executable file (<code>HELLO-OPENVMS.EXE</code>).</p>
</div><h2>Running the Program</h2>
<div class='content'><p>Finally, run the executable:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JCBSVU4gSEVMTE8tT1BFTlZNUw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$ RUN HELLO-OPENVMS</pre></div><div class='content'><p>You should see the output:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SGVsbG8sIE9wZW5WTVMh"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Hello, OpenVMS!</pre></div><div class='content'></div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Simple Arithmetic Operations</h2>
<div class='content'><p>Write a COBOL program that performs basic arithmetic operations (addition, subtraction, multiplication, and division) on two numbers provided by the user.</p>
<h4>Solution</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEFSSVRITUVUSUMtT1BFUkFUSU9OUy4KCkVOVklST05NRU5UIERJVklTSU9OLgoKREFUQSBESVZJU0lPTi4KV09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCjAxIE5VTTEgUElDIDkoNSkuCjAxIE5VTTIgUElDIDkoNSkuCjAxIFJFU1VMVCBQSUMgOSgxMCkuCgpQUk9DRURVUkUgRElWSVNJT04uCiAgICBESVNQTEFZICJFbnRlciBmaXJzdCBudW1iZXI6ICIuCiAgICBBQ0NFUFQgTlVNMS4KICAgIERJU1BMQVkgIkVudGVyIHNlY29uZCBudW1iZXI6ICIuCiAgICBBQ0NFUFQgTlVNMi4KCiAgICBDT01QVVRFIFJFU1VMVCA9IE5VTTEgKyBOVU0yLgogICAgRElTUExBWSAiQWRkaXRpb246ICIgUkVTVUxULgoKICAgIENPTVBVVEUgUkVTVUxUID0gTlVNMSAtIE5VTTIuCiAgICBESVNQTEFZICJTdWJ0cmFjdGlvbjogIiBSRVNVTFQuCgogICAgQ09NUFVURSBSRVNVTFQgPSBOVU0xICogTlVNMi4KICAgIERJU1BMQVkgIk11bHRpcGxpY2F0aW9uOiAiIFJFU1VMVC4KCiAgICBJRiBOVU0yIE5PVCA9IDAgVEhFTgogICAgICAgIENPTVBVVEUgUkVTVUxUID0gTlVNMSAvIE5VTTIKICAgICAgICBESVNQTEFZICJEaXZpc2lvbjogIiBSRVNVTFQKICAgIEVMU0UKICAgICAgICBESVNQTEFZICJEaXZpc2lvbiBieSB6ZXJvIGlzIG5vdCBhbGxvd2VkLiIuCgogICAgU1RPUCBSVU4u"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. ARITHMETIC-OPERATIONS.

ENVIRONMENT DIVISION.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 NUM1 PIC 9(5).
01 NUM2 PIC 9(5).
01 RESULT PIC 9(10).

PROCEDURE DIVISION.
    DISPLAY &quot;Enter first number: &quot;.
    ACCEPT NUM1.
    DISPLAY &quot;Enter second number: &quot;.
    ACCEPT NUM2.

    COMPUTE RESULT = NUM1 + NUM2.
    DISPLAY &quot;Addition: &quot; RESULT.

    COMPUTE RESULT = NUM1 - NUM2.
    DISPLAY &quot;Subtraction: &quot; RESULT.

    COMPUTE RESULT = NUM1 * NUM2.
    DISPLAY &quot;Multiplication: &quot; RESULT.

    IF NUM2 NOT = 0 THEN
        COMPUTE RESULT = NUM1 / NUM2
        DISPLAY &quot;Division: &quot; RESULT
    ELSE
        DISPLAY &quot;Division by zero is not allowed.&quot;.

    STOP RUN.</pre></div><div class='content'></div><h2>Exercise 2: String Manipulation</h2>
<div class='content'><p>Write a COBOL program that accepts a string from the user and displays it in reverse order.</p>
<h4>Solution</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIFJFVkVSU0UtU1RSSU5HLgoKRU5WSVJPTk1FTlQgRElWSVNJT04uCgpEQVRBIERJVklTSU9OLgpXT1JLSU5HLVNUT1JBR0UgU0VDVElPTi4KMDEgSU5QVVQtU1RSSU5HIFBJQyBYKDUwKS4KMDEgUkVWRVJTRUQtU1RSSU5HIFBJQyBYKDUwKS4KMDEgSSBQSUMgOTkuCjAxIExFTkdUSCBQSUMgOTkuCgpQUk9DRURVUkUgRElWSVNJT04uCiAgICBESVNQTEFZICJFbnRlciBhIHN0cmluZzogIi4KICAgIEFDQ0VQVCBJTlBVVC1TVFJJTkcuCgogICAgQ09NUFVURSBMRU5HVEggPSBGVU5DVElPTiBMRU5HVEgoSU5QVVQtU1RSSU5HKS4KCiAgICBQRVJGT1JNIFZBUllJTkcgSSBGUk9NIDEgQlkgMSBVTlRJTCBJID4gTEVOR1RICiAgICAgICAgTU9WRSBJTlBVVC1TVFJJTkcoTEVOR1RIIC0gSSArIDE6MSkgVE8gUkVWRVJTRUQtU1RSSU5HKEk6MSkKICAgIEVORC1QRVJGT1JNLgoKICAgIERJU1BMQVkgIlJldmVyc2VkIHN0cmluZzogIiBSRVZFUlNFRC1TVFJJTkcuCgogICAgU1RPUCBSVU4u"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. REVERSE-STRING.

ENVIRONMENT DIVISION.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 INPUT-STRING PIC X(50).
01 REVERSED-STRING PIC X(50).
01 I PIC 99.
01 LENGTH PIC 99.

PROCEDURE DIVISION.
    DISPLAY &quot;Enter a string: &quot;.
    ACCEPT INPUT-STRING.

    COMPUTE LENGTH = FUNCTION LENGTH(INPUT-STRING).

    PERFORM VARYING I FROM 1 BY 1 UNTIL I &gt; LENGTH
        MOVE INPUT-STRING(LENGTH - I + 1:1) TO REVERSED-STRING(I:1)
    END-PERFORM.

    DISPLAY &quot;Reversed string: &quot; REVERSED-STRING.

    STOP RUN.</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Syntax Errors:</strong> COBOL is very particular about syntax and formatting. Ensure that each division, section, and statement is correctly placed.</li>
<li><strong>Data Types:</strong> Be mindful of the data types and their sizes. COBOL uses specific picture clauses (PIC) to define data types.</li>
<li><strong>Environment Setup:</strong> Ensure that the COBOL compiler and environment variables are correctly set up before compiling and running programs.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, you learned how to set up the COBOL environment on OpenVMS, write simple COBOL programs, and compile and run them. You also practiced with exercises to reinforce your understanding. In the next module, we will explore interfacing with system services using COBOL on OpenVMS.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-03-using-fortran' title="Using Fortran on OpenVMS">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-05-interfacing-system-services' title="Interfacing with System Services">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
