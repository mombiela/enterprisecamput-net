<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using Collections</title>

    <link rel="alternate" href="https://campusempresa.com/mod/plsql/using-collections" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/plsql/using-collections" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/plsql/using-collections" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/plsql/using-collections" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/plsql/using-collections" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='bulk-collect-forall'>&#x25C4;Bulk Collect and FORALL</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Using Collections</a>
	</div>
	<div class='col-4 text-end'>
					<a href='error-handling-best-practices'>Error Handling Best Practices &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Collections</h1>
<div class='content'><p>Collections in PL/SQL are composite data types that allow you to store and manipulate sets of elements. They are similar to arrays in other programming languages but offer more flexibility and functionality.</p>
</div><h2>Types of Collections</h2>
<div class='content'><p>PL/SQL supports three main types of collections:</p>
<ul>
<li><strong>Associative Arrays (Index-by Tables)</strong></li>
<li><strong>Nested Tables</strong></li>
<li><strong>VARRAYs (Variable-size Arrays)</strong></li>
</ul>
</div><h1>Associative Arrays (Index-by Tables)</h1>
<div class='content'><p>Associative arrays, also known as index-by tables, are collections that use arbitrary numbers and strings as keys.</p>
</div><h2>Syntax and Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogIFRZUEUgYXNzb2NfYXJyYXkgSVMgVEFCTEUgT0YgVkFSQ0hBUjIoMTAwKSBJTkRFWCBCWSBQTFNfSU5URUdFUjsKICBteV9hcnJheSBhc3NvY19hcnJheTsKQkVHSU4KICBteV9hcnJheSgxKSA6PSAnRmlyc3QgRWxlbWVudCc7CiAgbXlfYXJyYXkoMikgOj0gJ1NlY29uZCBFbGVtZW50JzsKICBEQk1TX09VVFBVVC5QVVRfTElORShteV9hcnJheSgxKSk7IC0tIE91dHB1dHM6IEZpcnN0IEVsZW1lbnQKICBEQk1TX09VVFBVVC5QVVRfTElORShteV9hcnJheSgyKSk7IC0tIE91dHB1dHM6IFNlY29uZCBFbGVtZW50CkVORDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
  TYPE assoc_array IS TABLE OF VARCHAR2(100) INDEX BY PLS_INTEGER;
  my_array assoc_array;
BEGIN
  my_array(1) := 'First Element';
  my_array(2) := 'Second Element';
  DBMS_OUTPUT.PUT_LINE(my_array(1)); -- Outputs: First Element
  DBMS_OUTPUT.PUT_LINE(my_array(2)); -- Outputs: Second Element
END;</pre></div><div class='content'></div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Dynamic Size</strong>: Associative arrays can grow dynamically.</li>
<li><strong>Indexing</strong>: Can be indexed by integers or strings.</li>
<li><strong>Sparse</strong>: Elements do not need to be contiguous.</li>
</ul>
</div><h1>Nested Tables</h1>
<div class='content'><p>Nested tables are collections that can be stored in database tables and can be manipulated as whole sets.</p>
</div><h2>Syntax and Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogIFRZUEUgbmVzdGVkX3RhYmxlIElTIFRBQkxFIE9GIFZBUkNIQVIyKDEwMCk7CiAgbXlfdGFibGUgbmVzdGVkX3RhYmxlIDo9IG5lc3RlZF90YWJsZSgnRWxlbWVudCAxJywgJ0VsZW1lbnQgMicsICdFbGVtZW50IDMnKTsKQkVHSU4KICBGT1IgaSBJTiAxLi5teV90YWJsZS5DT1VOVCBMT09QCiAgICBEQk1TX09VVFBVVC5QVVRfTElORShteV90YWJsZShpKSk7CiAgRU5EIExPT1A7CkVORDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
  TYPE nested_table IS TABLE OF VARCHAR2(100);
  my_table nested_table := nested_table('Element 1', 'Element 2', 'Element 3');
BEGIN
  FOR i IN 1..my_table.COUNT LOOP
    DBMS_OUTPUT.PUT_LINE(my_table(i));
  END LOOP;
END;</pre></div><div class='content'></div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Dynamic Size</strong>: Nested tables can grow dynamically.</li>
<li><strong>Dense</strong>: Initially dense but can become sparse after deletions.</li>
<li><strong>Storage</strong>: Can be stored in database columns.</li>
</ul>
</div><h1>VARRAYs (Variable-size Arrays)</h1>
<div class='content'><p>VARRAYs are collections with a fixed maximum size, which makes them more efficient for certain operations.</p>
</div><h2>Syntax and Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogIFRZUEUgdmFycmF5X3R5cGUgSVMgVkFSUkFZKDUpIE9GIFZBUkNIQVIyKDEwMCk7CiAgbXlfdmFycmF5IHZhcnJheV90eXBlIDo9IHZhcnJheV90eXBlKCdFbGVtZW50IDEnLCAnRWxlbWVudCAyJyk7CkJFR0lOCiAgRk9SIGkgSU4gMS4ubXlfdmFycmF5LkNPVU5UIExPT1AKICAgIERCTVNfT1VUUFVULlBVVF9MSU5FKG15X3ZhcnJheShpKSk7CiAgRU5EIExPT1A7CkVORDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
  TYPE varray_type IS VARRAY(5) OF VARCHAR2(100);
  my_varray varray_type := varray_type('Element 1', 'Element 2');
BEGIN
  FOR i IN 1..my_varray.COUNT LOOP
    DBMS_OUTPUT.PUT_LINE(my_varray(i));
  END LOOP;
END;</pre></div><div class='content'></div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Fixed Size</strong>: Maximum size is defined at the time of declaration.</li>
<li><strong>Dense</strong>: Always dense, no gaps between elements.</li>
<li><strong>Storage</strong>: Can be stored in database columns.</li>
</ul>
</div><h1>Comparison of Collection Types</h1>
<div class='content'><table>
<thead>
<tr>
<th>Feature</th>
<th>Associative Arrays</th>
<th>Nested Tables</th>
<th>VARRAYs</th>
</tr>
</thead>
<tbody>
<tr>
<td>Indexing</td>
<td>Arbitrary (integer, string)</td>
<td>Sequential (integer)</td>
<td>Sequential (integer)</td>
</tr>
<tr>
<td>Dynamic Size</td>
<td>Yes</td>
<td>Yes</td>
<td>No (fixed max size)</td>
</tr>
<tr>
<td>Storage in DB</td>
<td>No</td>
<td>Yes</td>
<td>Yes</td>
</tr>
<tr>
<td>Sparsity</td>
<td>Yes</td>
<td>Yes (after deletions)</td>
<td>No</td>
</tr>
</tbody>
</table>
</div><h1>Advanced Usage</h1>
<h2>Bulk Operations</h2>
<div class='content'><p>PL/SQL collections support bulk operations that can significantly improve performance.</p>
<h4>Example: Bulk Collect</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogIFRZUEUgbnVtYmVyX3RhYmxlIElTIFRBQkxFIE9GIE5VTUJFUjsKICBteV9udW1iZXJzIG51bWJlcl90YWJsZTsKQkVHSU4KICBTRUxFQ1QgZW1wbG95ZWVfaWQgQlVMSyBDT0xMRUNUIElOVE8gbXlfbnVtYmVycyBGUk9NIGVtcGxveWVlczsKICBGT1IgaSBJTiAxLi5teV9udW1iZXJzLkNPVU5UIExPT1AKICAgIERCTVNfT1VUUFVULlBVVF9MSU5FKG15X251bWJlcnMoaSkpOwogIEVORCBMT09QOwpFTkQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
  TYPE number_table IS TABLE OF NUMBER;
  my_numbers number_table;
BEGIN
  SELECT employee_id BULK COLLECT INTO my_numbers FROM employees;
  FOR i IN 1..my_numbers.COUNT LOOP
    DBMS_OUTPUT.PUT_LINE(my_numbers(i));
  END LOOP;
END;</pre></div><div class='content'><h4>Example: FORALL</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogIFRZUEUgbnVtYmVyX3RhYmxlIElTIFRBQkxFIE9GIE5VTUJFUjsKICBteV9udW1iZXJzIG51bWJlcl90YWJsZSA6PSBudW1iZXJfdGFibGUoMSwgMiwgMywgNCwgNSk7CkJFR0lOCiAgRk9SQUxMIGkgSU4gMS4ubXlfbnVtYmVycy5DT1VOVAogICAgSU5TRVJUIElOVE8gbXlfdGFibGUgKGNvbHVtbl9uYW1lKSBWQUxVRVMgKG15X251bWJlcnMoaSkpOwpFTkQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
  TYPE number_table IS TABLE OF NUMBER;
  my_numbers number_table := number_table(1, 2, 3, 4, 5);
BEGIN
  FORALL i IN 1..my_numbers.COUNT
    INSERT INTO my_table (column_name) VALUES (my_numbers(i));
END;</pre></div><div class='content'></div><h2>Collection Methods</h2>
<div class='content'><p>PL/SQL provides several built-in methods to manipulate collections:</p>
<ul>
<li><strong>COUNT</strong>: Returns the number of elements.</li>
<li><strong>EXISTS(n)</strong>: Checks if the nth element exists.</li>
<li><strong>FIRST</strong>: Returns the first index.</li>
<li><strong>LAST</strong>: Returns the last index.</li>
<li><strong>PRIOR(n)</strong>: Returns the index before n.</li>
<li><strong>NEXT(n)</strong>: Returns the index after n.</li>
<li><strong>EXTEND</strong>: Adds elements to the collection.</li>
<li><strong>TRIM</strong>: Removes elements from the collection.</li>
<li><strong>DELETE</strong>: Removes all or specific elements.</li>
</ul>
<h4>Example: Using Collection Methods</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogIFRZUEUgbmVzdGVkX3RhYmxlIElTIFRBQkxFIE9GIFZBUkNIQVIyKDEwMCk7CiAgbXlfdGFibGUgbmVzdGVkX3RhYmxlIDo9IG5lc3RlZF90YWJsZSgnRWxlbWVudCAxJywgJ0VsZW1lbnQgMicsICdFbGVtZW50IDMnKTsKQkVHSU4KICBEQk1TX09VVFBVVC5QVVRfTElORSgnQ291bnQ6ICcgfHwgbXlfdGFibGUuQ09VTlQpOyAtLSBPdXRwdXRzOiBDb3VudDogMwogIG15X3RhYmxlLkRFTEVURSgyKTsgLS0gRGVsZXRlcyB0aGUgc2Vjb25kIGVsZW1lbnQKICBEQk1TX09VVFBVVC5QVVRfTElORSgnQ291bnQgYWZ0ZXIgZGVsZXRlOiAnIHx8IG15X3RhYmxlLkNPVU5UKTsgLS0gT3V0cHV0czogQ291bnQgYWZ0ZXIgZGVsZXRlOiAyCiAgbXlfdGFibGUuRVhURU5EKDIpOyAtLSBBZGRzIHR3byBtb3JlIGVsZW1lbnRzCiAgREJNU19PVVRQVVQuUFVUX0xJTkUoJ0NvdW50IGFmdGVyIGV4dGVuZDogJyB8fCBteV90YWJsZS5DT1VOVCk7IC0tIE91dHB1dHM6IENvdW50IGFmdGVyIGV4dGVuZDogNApFTkQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
  TYPE nested_table IS TABLE OF VARCHAR2(100);
  my_table nested_table := nested_table('Element 1', 'Element 2', 'Element 3');
BEGIN
  DBMS_OUTPUT.PUT_LINE('Count: ' || my_table.COUNT); -- Outputs: Count: 3
  my_table.DELETE(2); -- Deletes the second element
  DBMS_OUTPUT.PUT_LINE('Count after delete: ' || my_table.COUNT); -- Outputs: Count after delete: 2
  my_table.EXTEND(2); -- Adds two more elements
  DBMS_OUTPUT.PUT_LINE('Count after extend: ' || my_table.COUNT); -- Outputs: Count after extend: 4
END;</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Collections in PL/SQL are powerful tools that allow you to handle sets of data efficiently. Understanding the different types of collections—associative arrays, nested tables, and VARRAYs—along with their unique features and methods, will enable you to write more flexible and performant PL/SQL code. Utilize bulk operations and collection methods to optimize your data processing tasks.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='bulk-collect-forall'>&#x25C4;Bulk Collect and FORALL</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Using Collections</a>
	</div>
	<div class='col-4 text-end'>
					<a href='error-handling-best-practices'>Error Handling Best Practices &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
