<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic SQL in PL/SQL</title>

    <link rel="alternate" href="https://campusempresa.com/mod/plsql/dynamic-sql" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/plsql/dynamic-sql" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/plsql/dynamic-sql" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/plsql/dynamic-sql" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/plsql/dynamic-sql" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='triggers'>&#x25C4;Triggers</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Dynamic SQL in PL/SQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='plsql-optimization-techniques'>PL/SQL Optimization Techniques &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Dynamic SQL is a powerful feature in PL/SQL that allows you to construct and execute SQL statements dynamically at runtime. This is particularly useful when the exact SQL statement is not known until runtime, such as when building complex queries based on user input or other runtime conditions.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Static SQL vs. Dynamic SQL</strong>: Static SQL statements are hard-coded in the PL/SQL block and known at compile time, whereas dynamic SQL statements are constructed and executed at runtime.</li>
<li><strong>EXECUTE IMMEDIATE</strong>: A PL/SQL command used to execute a single SQL statement or a PL/SQL block dynamically.</li>
<li><strong>DBMS_SQL Package</strong>: A PL/SQL package that provides a more flexible way to execute dynamic SQL, especially useful for executing multiple SQL statements or handling complex queries.</li>
</ul>
</div><h1>Static SQL vs. Dynamic SQL</h1>
<div class='content'><p>| Feature           | Static SQL                          | Dynamic SQL                          |
|-------------------|-------------------------------------|--------------------------------------|
| Compilation       | Known at compile time               | Constructed and executed at runtime  |
| Performance       | Generally faster due to pre-compilation | May be slower due to runtime parsing |
| Flexibility       | Less flexible, fixed structure      | Highly flexible, can change at runtime|</p>
</div><h1>Using EXECUTE IMMEDIATE</h1>
<div class='content'><p><code>EXECUTE IMMEDIATE</code> is the simplest way to execute dynamic SQL in PL/SQL. It allows you to run a single SQL statement or a PL/SQL block.</p>
</div><h2>Example: Executing a Simple SQL Statement</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgc3FsX3N0bXQgVkFSQ0hBUjIoMTAwKTsKQkVHSU4KICAgIHNxbF9zdG10IDo9ICdVUERBVEUgZW1wbG95ZWVzIFNFVCBzYWxhcnkgPSBzYWxhcnkgKiAxLjEgV0hFUkUgZGVwYXJ0bWVudF9pZCA9IDEwJzsKICAgIEVYRUNVVEUgSU1NRURJQVRFIHNxbF9zdG10OwogICAgREJNU19PVVRQVVQuUFVUX0xJTkUoJ1NhbGFyaWVzIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5LicpOwpFTkQ7Ci8="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    sql_stmt VARCHAR2(100);
BEGIN
    sql_stmt := 'UPDATE employees SET salary = salary * 1.1 WHERE department_id = 10';
    EXECUTE IMMEDIATE sql_stmt;
    DBMS_OUTPUT.PUT_LINE('Salaries updated successfully.');
END;
/</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>sql_stmt</strong>: A variable to hold the dynamic SQL statement.</li>
<li><strong>EXECUTE IMMEDIATE</strong>: Executes the SQL statement stored in <code>sql_stmt</code>.</li>
<li><strong>DBMS_OUTPUT.PUT_LINE</strong>: Outputs a message indicating the operation was successful.</li>
</ul>
</div><h2>Example: Using Bind Variables</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgc3FsX3N0bXQgVkFSQ0hBUjIoMTAwKTsKICAgIGRlcHRfaWQgTlVNQkVSIDo9IDEwOwogICAgaW5jcmVtZW50IE5VTUJFUiA6PSAxLjE7CkJFR0lOCiAgICBzcWxfc3RtdCA6PSAnVVBEQVRFIGVtcGxveWVlcyBTRVQgc2FsYXJ5ID0gc2FsYXJ5ICogOmluY3JlbWVudCBXSEVSRSBkZXBhcnRtZW50X2lkID0gOmRlcHRfaWQnOwogICAgRVhFQ1VURSBJTU1FRElBVEUgc3FsX3N0bXQgVVNJTkcgaW5jcmVtZW50LCBkZXB0X2lkOwogICAgREJNU19PVVRQVVQuUFVUX0xJTkUoJ1NhbGFyaWVzIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5LicpOwpFTkQ7Ci8="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    sql_stmt VARCHAR2(100);
    dept_id NUMBER := 10;
    increment NUMBER := 1.1;
BEGIN
    sql_stmt := 'UPDATE employees SET salary = salary * :increment WHERE department_id = :dept_id';
    EXECUTE IMMEDIATE sql_stmt USING increment, dept_id;
    DBMS_OUTPUT.PUT_LINE('Salaries updated successfully.');
END;
/</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Bind Variables</strong>: <code>:increment</code> and <code>:dept_id</code> are placeholders in the SQL statement.</li>
<li><strong>USING Clause</strong>: Provides values for the bind variables at runtime.</li>
</ul>
</div><h1>Using DBMS_SQL Package</h1>
<div class='content'><p>The <code>DBMS_SQL</code> package offers more control and flexibility for executing dynamic SQL, especially for complex scenarios.</p>
</div><h2>Example: Executing a Query with DBMS_SQL</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgY3Vyc29yX2lkIElOVEVHRVI7CiAgICBzcWxfc3RtdCBWQVJDSEFSMigyMDApOwogICAgZW1wX25hbWUgVkFSQ0hBUjIoNTApOwpCRUdJTgogICAgc3FsX3N0bXQgOj0gJ1NFTEVDVCBmaXJzdF9uYW1lIEZST00gZW1wbG95ZWVzIFdIRVJFIGVtcGxveWVlX2lkID0gOmVtcF9pZCc7CiAgICBjdXJzb3JfaWQgOj0gREJNU19TUUwuT1BFTl9DVVJTT1I7CiAgICBEQk1TX1NRTC5QQVJTRShjdXJzb3JfaWQsIHNxbF9zdG10LCBEQk1TX1NRTC5OQVRJVkUpOwogICAgREJNU19TUUwuQklORF9WQVJJQUJMRShjdXJzb3JfaWQsICc6ZW1wX2lkJywgMTAwKTsKICAgIERCTVNfU1FMLkRFRklORV9DT0xVTU4oY3Vyc29yX2lkLCAxLCBlbXBfbmFtZSk7CiAgICAKICAgIElGIERCTVNfU1FMLkVYRUNVVEVfQU5EX0ZFVENIKGN1cnNvcl9pZCkgPiAwIFRIRU4KICAgICAgICBEQk1TX1NRTC5DT0xVTU5fVkFMVUUoY3Vyc29yX2lkLCAxLCBlbXBfbmFtZSk7CiAgICAgICAgREJNU19PVVRQVVQuUFVUX0xJTkUoJ0VtcGxveWVlIE5hbWU6ICcgfHwgZW1wX25hbWUpOwogICAgRU5EIElGOwogICAgCiAgICBEQk1TX1NRTC5DTE9TRV9DVVJTT1IoY3Vyc29yX2lkKTsKRU5EOwov"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    cursor_id INTEGER;
    sql_stmt VARCHAR2(200);
    emp_name VARCHAR2(50);
BEGIN
    sql_stmt := 'SELECT first_name FROM employees WHERE employee_id = :emp_id';
    cursor_id := DBMS_SQL.OPEN_CURSOR;
    DBMS_SQL.PARSE(cursor_id, sql_stmt, DBMS_SQL.NATIVE);
    DBMS_SQL.BIND_VARIABLE(cursor_id, ':emp_id', 100);
    DBMS_SQL.DEFINE_COLUMN(cursor_id, 1, emp_name);
    
    IF DBMS_SQL.EXECUTE_AND_FETCH(cursor_id) &gt; 0 THEN
        DBMS_SQL.COLUMN_VALUE(cursor_id, 1, emp_name);
        DBMS_OUTPUT.PUT_LINE('Employee Name: ' || emp_name);
    END IF;
    
    DBMS_SQL.CLOSE_CURSOR(cursor_id);
END;
/</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>OPEN_CURSOR</strong>: Opens a new cursor for the dynamic SQL statement.</li>
<li><strong>PARSE</strong>: Parses the SQL statement.</li>
<li><strong>BIND_VARIABLE</strong>: Binds a value to the bind variable <code>:emp_id</code>.</li>
<li><strong>DEFINE_COLUMN</strong>: Defines the output variable for the result set.</li>
<li><strong>EXECUTE_AND_FETCH</strong>: Executes the SQL statement and fetches the result.</li>
<li><strong>COLUMN_VALUE</strong>: Retrieves the value of the specified column.</li>
<li><strong>CLOSE_CURSOR</strong>: Closes the cursor.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Dynamic SQL in PL/SQL provides the flexibility to construct and execute SQL statements at runtime, making it a powerful tool for handling complex and variable queries. The <code>EXECUTE IMMEDIATE</code> command is suitable for simpler, single-statement executions, while the <code>DBMS_SQL</code> package offers more advanced capabilities for handling multiple statements and complex scenarios. Understanding when and how to use these tools effectively can greatly enhance the versatility and functionality of your PL/SQL programs.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='triggers'>&#x25C4;Triggers</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Dynamic SQL in PL/SQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='plsql-optimization-techniques'>PL/SQL Optimization Techniques &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
