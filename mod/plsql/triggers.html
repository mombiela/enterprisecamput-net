<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triggers in PL/SQL</title>

    <link rel="alternate" href="https://campusempresa.com/mod/plsql/triggers" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/plsql/triggers" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/plsql/triggers" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/plsql/triggers" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/plsql/triggers" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='packages'>&#x25C4;Packages</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Triggers in PL/SQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='dynamic-sql'>Dynamic SQL &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Triggers</h1>
<div class='content'><p>Triggers are a special type of stored procedure that automatically execute or fire when certain events occur. They are used to enforce business rules, maintain audit trails, and synchronize tables.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Trigger Event</strong>: The specific event that causes the trigger to fire (e.g., INSERT, UPDATE, DELETE).</li>
<li><strong>Trigger Timing</strong>: Specifies when the trigger should fire (e.g., BEFORE, AFTER).</li>
<li><strong>Trigger Type</strong>: Defines the scope of the trigger (e.g., row-level, statement-level).</li>
<li><strong>Trigger Body</strong>: The PL/SQL code that executes when the trigger fires.</li>
</ul>
</div><h1>Creating Triggers</h1>
<div class='content'><p>To create a trigger, you use the <code>CREATE TRIGGER</code> statement. The basic syntax is as follows:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFtPUiBSRVBMQUNFXSBUUklHR0VSIHRyaWdnZXJfbmFtZQp7QkVGT1JFIHwgQUZURVJ9IHtJTlNFUlQgfCBVUERBVEUgfCBERUxFVEV9Ck9OIHRhYmxlX25hbWUKW0ZPUiBFQUNIIFJPV10KREVDTEFSRQogIC0tIHZhcmlhYmxlIGRlY2xhcmF0aW9ucwpCRUdJTgogIC0tIHRyaWdnZXIgYm9keQpFTkQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE [OR REPLACE] TRIGGER trigger_name
{BEFORE | AFTER} {INSERT | UPDATE | DELETE}
ON table_name
[FOR EACH ROW]
DECLARE
  -- variable declarations
BEGIN
  -- trigger body
END;</pre></div><div class='content'></div><h2>Example: Basic Trigger</h2>
<div class='content'><p>Let's create a simple trigger that logs changes to an <code>employees</code> table:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgVFJJR0dFUiBsb2dfZW1wbG95ZWVfY2hhbmdlcwpBRlRFUiBJTlNFUlQgT1IgVVBEQVRFIE9SIERFTEVURQpPTiBlbXBsb3llZXMKRk9SIEVBQ0ggUk9XCkJFR0lOCiAgSUYgSU5TRVJUSU5HIFRIRU4KICAgIElOU0VSVCBJTlRPIGVtcGxveWVlX2xvZyAobG9nX2RhdGUsIHVzZXJfaWQsIG9wZXJhdGlvbikKICAgIFZBTFVFUyAoU1lTREFURSwgVVNFUiwgJ0lOU0VSVCcpOwogIEVMU0lGIFVQREFUSU5HIFRIRU4KICAgIElOU0VSVCBJTlRPIGVtcGxveWVlX2xvZyAobG9nX2RhdGUsIHVzZXJfaWQsIG9wZXJhdGlvbikKICAgIFZBTFVFUyAoU1lTREFURSwgVVNFUiwgJ1VQREFURScpOwogIEVMU0lGIERFTEVUSU5HIFRIRU4KICAgIElOU0VSVCBJTlRPIGVtcGxveWVlX2xvZyAobG9nX2RhdGUsIHVzZXJfaWQsIG9wZXJhdGlvbikKICAgIFZBTFVFUyAoU1lTREFURSwgVVNFUiwgJ0RFTEVURScpOwogIEVORCBJRjsKRU5EOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE TRIGGER log_employee_changes
AFTER INSERT OR UPDATE OR DELETE
ON employees
FOR EACH ROW
BEGIN
  IF INSERTING THEN
    INSERT INTO employee_log (log_date, user_id, operation)
    VALUES (SYSDATE, USER, 'INSERT');
  ELSIF UPDATING THEN
    INSERT INTO employee_log (log_date, user_id, operation)
    VALUES (SYSDATE, USER, 'UPDATE');
  ELSIF DELETING THEN
    INSERT INTO employee_log (log_date, user_id, operation)
    VALUES (SYSDATE, USER, 'DELETE');
  END IF;
END;</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Trigger Name</strong>: <code>log_employee_changes</code></li>
<li><strong>Trigger Timing</strong>: <code>AFTER</code></li>
<li><strong>Trigger Event</strong>: <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code></li>
<li><strong>Trigger Scope</strong>: <code>FOR EACH ROW</code> (row-level trigger)</li>
<li><strong>Trigger Body</strong>: Inserts a log entry into <code>employee_log</code> table whenever an insert, update, or delete operation occurs on the <code>employees</code> table.</li>
</ul>
</div><h1>Advanced Trigger Concepts</h1>
<div class='content'></div><h2>Compound Triggers</h2>
<div class='content'><p>Compound triggers allow you to define multiple timing points within a single trigger. This can help avoid mutating table errors and improve performance.</p>
<h4>Example: Compound Trigger</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgVFJJR0dFUiBjb21wb3VuZF9lbXBsb3llZV90cmlnZ2VyCkZPUiBJTlNFUlQgT1IgVVBEQVRFIE9SIERFTEVURSBPTiBlbXBsb3llZXMKQ09NUE9VTkQgVFJJR0dFUgogIFRZUEUgdF9lbXBsb3llZV9pZHMgSVMgVEFCTEUgT0YgZW1wbG95ZWVzLmVtcGxveWVlX2lkJVRZUEU7CiAgZW1wbG95ZWVfaWRzIHRfZW1wbG95ZWVfaWRzIDo9IHRfZW1wbG95ZWVfaWRzKCk7CgogIEJFRk9SRSBTVEFURU1FTlQgSVMKICBCRUdJTgogICAgLS0gQ29kZSB0byBleGVjdXRlIGJlZm9yZSB0aGUgdHJpZ2dlcmluZyBzdGF0ZW1lbnQKICBFTkQgQkVGT1JFIFNUQVRFTUVOVDsKCiAgQkVGT1JFIEVBQ0ggUk9XIElTCiAgQkVHSU4KICAgIC0tIENvZGUgdG8gZXhlY3V0ZSBiZWZvcmUgZWFjaCByb3cKICAgIElGIElOU0VSVElORyBPUiBVUERBVElORyBUSEVOCiAgICAgIGVtcGxveWVlX2lkcy5FWFRFTkQ7CiAgICAgIGVtcGxveWVlX2lkcyhlbXBsb3llZV9pZHMuQ09VTlQpIDo9IDpORVcuZW1wbG95ZWVfaWQ7CiAgICBFTkQgSUY7CiAgRU5EIEJFRk9SRSBFQUNIIFJPVzsKCiAgQUZURVIgRUFDSCBST1cgSVMKICBCRUdJTgogICAgLS0gQ29kZSB0byBleGVjdXRlIGFmdGVyIGVhY2ggcm93CiAgRU5EIEFGVEVSIEVBQ0ggUk9XOwoKICBBRlRFUiBTVEFURU1FTlQgSVMKICBCRUdJTgogICAgLS0gQ29kZSB0byBleGVjdXRlIGFmdGVyIHRoZSB0cmlnZ2VyaW5nIHN0YXRlbWVudAogICAgRk9SIGkgSU4gMSAuLiBlbXBsb3llZV9pZHMuQ09VTlQgTE9PUAogICAgICAtLSBQcm9jZXNzIGVhY2ggZW1wbG95ZWVfaWQKICAgIEVORCBMT09QOwogIEVORCBBRlRFUiBTVEFURU1FTlQ7CkVORCBjb21wb3VuZF9lbXBsb3llZV90cmlnZ2VyOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE TRIGGER compound_employee_trigger
FOR INSERT OR UPDATE OR DELETE ON employees
COMPOUND TRIGGER
  TYPE t_employee_ids IS TABLE OF employees.employee_id%TYPE;
  employee_ids t_employee_ids := t_employee_ids();

  BEFORE STATEMENT IS
  BEGIN
    -- Code to execute before the triggering statement
  END BEFORE STATEMENT;

  BEFORE EACH ROW IS
  BEGIN
    -- Code to execute before each row
    IF INSERTING OR UPDATING THEN
      employee_ids.EXTEND;
      employee_ids(employee_ids.COUNT) := :NEW.employee_id;
    END IF;
  END BEFORE EACH ROW;

  AFTER EACH ROW IS
  BEGIN
    -- Code to execute after each row
  END AFTER EACH ROW;

  AFTER STATEMENT IS
  BEGIN
    -- Code to execute after the triggering statement
    FOR i IN 1 .. employee_ids.COUNT LOOP
      -- Process each employee_id
    END LOOP;
  END AFTER STATEMENT;
END compound_employee_trigger;</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Compound Trigger</strong>: Combines multiple timing points (<code>BEFORE STATEMENT</code>, <code>BEFORE EACH ROW</code>, <code>AFTER EACH ROW</code>, <code>AFTER STATEMENT</code>) within a single trigger.</li>
<li><strong>Temporary Storage</strong>: Uses a PL/SQL collection (<code>employee_ids</code>) to store data across different timing points.</li>
</ul>
</div><h1>Managing Triggers</h1>
<div class='content'><ul>
<li><strong>Enable/Disable Triggers</strong>: You can enable or disable triggers using the <code>ALTER TRIGGER</code> statement.</li>
<li><strong>Drop Triggers</strong>: You can remove a trigger using the <code>DROP TRIGGER</code> statement.</li>
</ul>
</div><h2>Example: Managing Triggers</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRGlzYWJsZSBhIHRyaWdnZXIKQUxURVIgVFJJR0dFUiBsb2dfZW1wbG95ZWVfY2hhbmdlcyBESVNBQkxFOwoKLS0gRW5hYmxlIGEgdHJpZ2dlcgpBTFRFUiBUUklHR0VSIGxvZ19lbXBsb3llZV9jaGFuZ2VzIEVOQUJMRTsKCi0tIERyb3AgYSB0cmlnZ2VyCkRST1AgVFJJR0dFUiBsb2dfZW1wbG95ZWVfY2hhbmdlczs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Disable a trigger
ALTER TRIGGER log_employee_changes DISABLE;

-- Enable a trigger
ALTER TRIGGER log_employee_changes ENABLE;

-- Drop a trigger
DROP TRIGGER log_employee_changes;</pre></div><div class='content'></div><h1>Best Practices</h1>
<div class='content'><ul>
<li><strong>Keep Triggers Simple</strong>: Avoid complex logic within triggers to maintain performance and readability.</li>
<li><strong>Use Compound Triggers</strong>: To handle multiple timing points and avoid mutating table errors.</li>
<li><strong>Document Triggers</strong>: Clearly document the purpose and logic of each trigger.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Triggers in PL/SQL are powerful tools for automating database tasks and enforcing business rules. By understanding the basics and advanced concepts, you can effectively use triggers to enhance your database applications. Always follow best practices to ensure your triggers are efficient and maintainable.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='packages'>&#x25C4;Packages</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Triggers in PL/SQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='dynamic-sql'>Dynamic SQL &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
