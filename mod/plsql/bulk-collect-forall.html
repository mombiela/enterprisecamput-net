<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bulk Collect and FORALL in PL/SQL</title>

    <link rel="alternate" href="https://campusempresa.com/mod/plsql/bulk-collect-forall" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/plsql/bulk-collect-forall" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/plsql/bulk-collect-forall" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/plsql/bulk-collect-forall" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/plsql/bulk-collect-forall" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='plsql-optimization-techniques'>&#x25C4;PL/SQL Optimization Techniques</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Bulk Collect and FORALL in PL/SQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-collections'>Using Collections &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In PL/SQL, <code>BULK COLLECT</code> and <code>FORALL</code> are powerful features that allow you to perform bulk operations efficiently. These features are particularly useful when dealing with large volumes of data, as they can significantly improve performance by reducing context switches between the PL/SQL engine and the SQL engine.</p>
</div><h1>BULK COLLECT</h1>
<div class='content'><p><code>BULK COLLECT</code> is used to fetch multiple rows from a query into a collection in a single operation, rather than fetching one row at a time.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Collections</strong>: PL/SQL data structures that can hold multiple values, such as VARRAYs, Nested Tables, and Associative Arrays.</li>
<li><strong>Efficiency</strong>: Reduces the number of context switches between SQL and PL/SQL engines, improving performance.</li>
</ul>
</div><h2>Syntax</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGNvbHVtbjEsIGNvbHVtbjIsIC4uLgpCVUxLIENPTExFQ1QgSU5UTyBjb2xsZWN0aW9uMSwgY29sbGVjdGlvbjIsIC4uLgpGUk9NIHRhYmxlX25hbWUKV0hFUkUgY29uZGl0aW9uOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT column1, column2, ...
BULK COLLECT INTO collection1, collection2, ...
FROM table_name
WHERE condition;</pre></div><div class='content'></div><h2>Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgVFlQRSBOdW1MaXN0IElTIFRBQkxFIE9GIE5VTUJFUjsKICAgIFRZUEUgTmFtZUxpc3QgSVMgVEFCTEUgT0YgVkFSQ0hBUjIoNTApOwogICAgbnVtYmVycyBOdW1MaXN0OwogICAgbmFtZXMgTmFtZUxpc3Q7CkJFR0lOCiAgICBTRUxFQ1QgZW1wbG95ZWVfaWQsIGZpcnN0X25hbWUKICAgIEJVTEsgQ09MTEVDVCBJTlRPIG51bWJlcnMsIG5hbWVzCiAgICBGUk9NIGVtcGxveWVlcwogICAgV0hFUkUgZGVwYXJ0bWVudF9pZCA9IDEwOwogICAgCiAgICBGT1IgaSBJTiAxLi5udW1iZXJzLkNPVU5UIExPT1AKICAgICAgICBEQk1TX09VVFBVVC5QVVRfTElORSgnSUQ6ICcgfHwgbnVtYmVycyhpKSB8fCAnLCBOYW1lOiAnIHx8IG5hbWVzKGkpKTsKICAgIEVORCBMT09QOwpFTkQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    TYPE NumList IS TABLE OF NUMBER;
    TYPE NameList IS TABLE OF VARCHAR2(50);
    numbers NumList;
    names NameList;
BEGIN
    SELECT employee_id, first_name
    BULK COLLECT INTO numbers, names
    FROM employees
    WHERE department_id = 10;
    
    FOR i IN 1..numbers.COUNT LOOP
        DBMS_OUTPUT.PUT_LINE('ID: ' || numbers(i) || ', Name: ' || names(i));
    END LOOP;
END;</pre></div><div class='content'><p>In this example, <code>BULK COLLECT</code> is used to fetch <code>employee_id</code> and <code>first_name</code> from the <code>employees</code> table into two collections, <code>numbers</code> and <code>names</code>.</p>
</div><h1>FORALL</h1>
<div class='content'><p><code>FORALL</code> is used to perform bulk DML operations (INSERT, UPDATE, DELETE) efficiently by reducing context switches.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>DML Operations</strong>: Data Manipulation Language operations like INSERT, UPDATE, and DELETE.</li>
<li><strong>Efficiency</strong>: Executes multiple DML statements in a single context switch.</li>
</ul>
</div><h2>Syntax</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Rk9SQUxMIGluZGV4IElOIGxvd2VyX2JvdW5kLi51cHBlcl9ib3VuZAogICAgRE1MX3N0YXRlbWVudDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>FORALL index IN lower_bound..upper_bound
    DML_statement;</pre></div><div class='content'></div><h2>Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgVFlQRSBOdW1MaXN0IElTIFRBQkxFIE9GIE5VTUJFUjsKICAgIGVtcGxveWVlX2lkcyBOdW1MaXN0IDo9IE51bUxpc3QoMTAwMSwgMTAwMiwgMTAwMyk7CkJFR0lOCiAgICBGT1JBTEwgaSBJTiBlbXBsb3llZV9pZHMuRklSU1QuLmVtcGxveWVlX2lkcy5MQVNUCiAgICAgICAgVVBEQVRFIGVtcGxveWVlcwogICAgICAgIFNFVCBzYWxhcnkgPSBzYWxhcnkgKiAxLjEwCiAgICAgICAgV0hFUkUgZW1wbG95ZWVfaWQgPSBlbXBsb3llZV9pZHMoaSk7CkVORDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    TYPE NumList IS TABLE OF NUMBER;
    employee_ids NumList := NumList(1001, 1002, 1003);
BEGIN
    FORALL i IN employee_ids.FIRST..employee_ids.LAST
        UPDATE employees
        SET salary = salary * 1.10
        WHERE employee_id = employee_ids(i);
END;</pre></div><div class='content'><p>In this example, <code>FORALL</code> is used to update the salaries of employees with IDs 1001, 1002, and 1003 in a single operation.</p>
</div><h1>Combining BULK COLLECT and FORALL</h1>
<div class='content'><p>You can combine <code>BULK COLLECT</code> and <code>FORALL</code> to fetch data into collections and then perform bulk DML operations on that data.</p>
</div><h2>Example</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgVFlQRSBOdW1MaXN0IElTIFRBQkxFIE9GIE5VTUJFUjsKICAgIFRZUEUgTmFtZUxpc3QgSVMgVEFCTEUgT0YgVkFSQ0hBUjIoNTApOwogICAgZW1wbG95ZWVfaWRzIE51bUxpc3Q7CiAgICBlbXBsb3llZV9uYW1lcyBOYW1lTGlzdDsKQkVHSU4KICAgIC0tIEJ1bGsgY29sbGVjdCBkYXRhIGludG8gY29sbGVjdGlvbnMKICAgIFNFTEVDVCBlbXBsb3llZV9pZCwgZmlyc3RfbmFtZQogICAgQlVMSyBDT0xMRUNUIElOVE8gZW1wbG95ZWVfaWRzLCBlbXBsb3llZV9uYW1lcwogICAgRlJPTSBlbXBsb3llZXMKICAgIFdIRVJFIGRlcGFydG1lbnRfaWQgPSAxMDsKICAgIAogICAgLS0gUGVyZm9ybSBidWxrIHVwZGF0ZSB1c2luZyBGT1JBTEwKICAgIEZPUkFMTCBpIElOIGVtcGxveWVlX2lkcy5GSVJTVC4uZW1wbG95ZWVfaWRzLkxBU1QKICAgICAgICBVUERBVEUgZW1wbG95ZWVzCiAgICAgICAgU0VUIHNhbGFyeSA9IHNhbGFyeSAqIDEuMTAKICAgICAgICBXSEVSRSBlbXBsb3llZV9pZCA9IGVtcGxveWVlX2lkcyhpKTsKICAgIAogICAgLS0gT3V0cHV0IHRoZSB1cGRhdGVkIG5hbWVzCiAgICBGT1IgaSBJTiBlbXBsb3llZV9pZHMuRklSU1QuLmVtcGxveWVlX2lkcy5MQVNUIExPT1AKICAgICAgICBEQk1TX09VVFBVVC5QVVRfTElORSgnVXBkYXRlZCBFbXBsb3llZTogJyB8fCBlbXBsb3llZV9uYW1lcyhpKSk7CiAgICBFTkQgTE9PUDsKRU5EOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    TYPE NumList IS TABLE OF NUMBER;
    TYPE NameList IS TABLE OF VARCHAR2(50);
    employee_ids NumList;
    employee_names NameList;
BEGIN
    -- Bulk collect data into collections
    SELECT employee_id, first_name
    BULK COLLECT INTO employee_ids, employee_names
    FROM employees
    WHERE department_id = 10;
    
    -- Perform bulk update using FORALL
    FORALL i IN employee_ids.FIRST..employee_ids.LAST
        UPDATE employees
        SET salary = salary * 1.10
        WHERE employee_id = employee_ids(i);
    
    -- Output the updated names
    FOR i IN employee_ids.FIRST..employee_ids.LAST LOOP
        DBMS_OUTPUT.PUT_LINE('Updated Employee: ' || employee_names(i));
    END LOOP;
END;</pre></div><div class='content'><p>In this example, <code>BULK COLLECT</code> is used to fetch employee IDs and names into collections, and <code>FORALL</code> is used to update the salaries of those employees in a single operation.</p>
</div><h1>Conclusion</h1>
<div class='content'><p><code>BULK COLLECT</code> and <code>FORALL</code> are essential tools in PL/SQL for handling large volumes of data efficiently. By reducing context switches between the PL/SQL and SQL engines, these features can significantly improve the performance of your PL/SQL programs. Understanding and utilizing these features will help you write more efficient and scalable PL/SQL code.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='plsql-optimization-techniques'>&#x25C4;PL/SQL Optimization Techniques</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Bulk Collect and FORALL in PL/SQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-collections'>Using Collections &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
