<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Access Techniques in COBOL</title>

    <link rel="alternate" href="https://campusempresa.com/mod/cobol/database-access-techniques" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/cobol/database-access-techniques" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/cobol/database-access-techniques" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/cobol/database-access-techniques" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/cobol/database-access-techniques" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='embedded-sql-in-cobol'>&#x25C4;Embedded SQL in COBOL</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Database Access Techniques in COBOL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='handling-transactions'>Handling Transactions &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this section, we will explore various techniques for accessing databases using COBOL. This includes understanding the basics of database connectivity, executing SQL queries, handling transactions, and managing data retrieval and updates. By the end of this topic, you will be able to effectively interact with databases in your COBOL programs.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Embedded SQL</strong>: SQL statements written directly within COBOL code.</li>
<li><strong>Cursor Management</strong>: Techniques for handling multiple rows of data.</li>
<li><strong>Transaction Control</strong>: Managing database transactions to ensure data integrity.</li>
<li><strong>Error Handling</strong>: Techniques for managing errors during database operations.</li>
</ul>
</div><h1>Connecting to a Database</h1>
<div class='content'><p>To interact with a database, you first need to establish a connection. This typically involves specifying the database name, user credentials, and other connection parameters.</p>
</div><h2>Example: Establishing a Database Connection</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIENvbm5lY3RUb0RhdGFiYXNlLgoKREFUQSBESVZJU0lPTi4KV09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCjAxICBEQi1DT05ORUNUSU9OLVNUQVRVUyAgUElDIFgoMTApLgoKRVhFQyBTUUwKICAgIElOQ0xVREUgU1FMQ0EKRU5ELUVYRUMuCgpQUk9DRURVUkUgRElWSVNJT04uCiAgICBFWEVDIFNRTAogICAgICAgIENPTk5FQ1QgVE8gJ2RhdGFiYXNlX25hbWUnCiAgICAgICAgVVNFUiAndXNlcm5hbWUnCiAgICAgICAgVVNJTkcgJ3Bhc3N3b3JkJwogICAgRU5ELUVYRUMuCgogICAgSUYgU1FMQ09ERSA9IDAKICAgICAgICBESVNQTEFZICdDb25uZWN0aW9uIHN1Y2Nlc3NmdWwuJwogICAgRUxTRQogICAgICAgIERJU1BMQVkgJ0Nvbm5lY3Rpb24gZmFpbGVkLiBTUUxDT0RFOiAnIFNRTENPREUKICAgIEVORC1JRi4KCiAgICBTVE9QIFJVTi4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. ConnectToDatabase.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  DB-CONNECTION-STATUS  PIC X(10).

EXEC SQL
    INCLUDE SQLCA
END-EXEC.

PROCEDURE DIVISION.
    EXEC SQL
        CONNECT TO 'database_name'
        USER 'username'
        USING 'password'
    END-EXEC.

    IF SQLCODE = 0
        DISPLAY 'Connection successful.'
    ELSE
        DISPLAY 'Connection failed. SQLCODE: ' SQLCODE
    END-IF.

    STOP RUN.</pre></div><div class='content'><ul>
<li><strong>SQLCA</strong>: SQL Communication Area, used for error handling.</li>
<li><strong>SQLCODE</strong>: Variable that holds the status of the last executed SQL statement.</li>
</ul>
</div><h1>Executing SQL Queries</h1>
<div class='content'><p>Once connected, you can execute SQL queries to interact with the database. This includes SELECT, INSERT, UPDATE, and DELETE operations.</p>
</div><h2>Example: Executing a SELECT Query</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIFNlbGVjdFF1ZXJ5LgoKREFUQSBESVZJU0lPTi4KV09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCjAxICBFTVAtSUQgICAgICAgICAgICBQSUMgOSg1KS4KMDEgIEVNUC1OQU1FICAgICAgICAgIFBJQyBYKDIwKS4KMDEgIFNRTC1RVUVSWS1TVEFUVVMgIFBJQyBYKDEwKS4KCkVYRUMgU1FMCiAgICBJTkNMVURFIFNRTENBCkVORC1FWEVDLgoKUFJPQ0VEVVJFIERJVklTSU9OLgogICAgRVhFQyBTUUwKICAgICAgICBERUNMQVJFIEMxIENVUlNPUiBGT1IKICAgICAgICBTRUxFQ1QgRU1QX0lELCBFTVBfTkFNRQogICAgICAgIEZST00gRU1QTE9ZRUUKICAgIEVORC1FWEVDLgoKICAgIEVYRUMgU1FMCiAgICAgICAgT1BFTiBDMQogICAgRU5ELUVYRUMuCgogICAgUEVSRk9STSBVTlRJTCBTUUxDT0RFIDw+IDAKICAgICAgICBFWEVDIFNRTAogICAgICAgICAgICBGRVRDSCBDMSBJTlRPIDpFTVAtSUQsIDpFTVAtTkFNRQogICAgICAgIEVORC1FWEVDCgogICAgICAgIElGIFNRTENPREUgPSAwCiAgICAgICAgICAgIERJU1BMQVkgJ0VtcGxveWVlIElEOiAnIEVNUC1JRAogICAgICAgICAgICBESVNQTEFZICdFbXBsb3llZSBOYW1lOiAnIEVNUC1OQU1FCiAgICAgICAgRU5ELUlGCiAgICBFTkQtUEVSRk9STS4KCiAgICBFWEVDIFNRTAogICAgICAgIENMT1NFIEMxCiAgICBFTkQtRVhFQy4KCiAgICBTVE9QIFJVTi4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. SelectQuery.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  EMP-ID            PIC 9(5).
01  EMP-NAME          PIC X(20).
01  SQL-QUERY-STATUS  PIC X(10).

EXEC SQL
    INCLUDE SQLCA
END-EXEC.

PROCEDURE DIVISION.
    EXEC SQL
        DECLARE C1 CURSOR FOR
        SELECT EMP_ID, EMP_NAME
        FROM EMPLOYEE
    END-EXEC.

    EXEC SQL
        OPEN C1
    END-EXEC.

    PERFORM UNTIL SQLCODE &lt;&gt; 0
        EXEC SQL
            FETCH C1 INTO :EMP-ID, :EMP-NAME
        END-EXEC

        IF SQLCODE = 0
            DISPLAY 'Employee ID: ' EMP-ID
            DISPLAY 'Employee Name: ' EMP-NAME
        END-IF
    END-PERFORM.

    EXEC SQL
        CLOSE C1
    END-EXEC.

    STOP RUN.</pre></div><div class='content'><ul>
<li><strong>DECLARE CURSOR</strong>: Defines a cursor for retrieving multiple rows.</li>
<li><strong>OPEN CURSOR</strong>: Opens the cursor for fetching data.</li>
<li><strong>FETCH</strong>: Retrieves the next row from the cursor.</li>
<li><strong>CLOSE CURSOR</strong>: Closes the cursor after fetching all rows.</li>
</ul>
</div><h1>Transaction Control</h1>
<div class='content'><p>Transactions ensure that a series of database operations are executed as a single unit. This is crucial for maintaining data integrity.</p>
</div><h2>Example: Handling Transactions</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIFRyYW5zYWN0aW9uQ29udHJvbC4KCkRBVEEgRElWSVNJT04uCldPUktJTkctU1RPUkFHRSBTRUNUSU9OLgowMSAgU1FMLVNUQVRVUyAgUElDIFgoMTApLgoKRVhFQyBTUUwKICAgIElOQ0xVREUgU1FMQ0EKRU5ELUVYRUMuCgpQUk9DRURVUkUgRElWSVNJT04uCiAgICBFWEVDIFNRTAogICAgICAgIEJFR0lOIFRSQU5TQUNUSU9OCiAgICBFTkQtRVhFQy4KCiAgICBFWEVDIFNRTAogICAgICAgIFVQREFURSBFTVBMT1lFRQogICAgICAgIFNFVCBTQUxBUlkgPSBTQUxBUlkgKiAxLjEKICAgICAgICBXSEVSRSBERVBUX0lEID0gMTAKICAgIEVORC1FWEVDLgoKICAgIElGIFNRTENPREUgPSAwCiAgICAgICAgRVhFQyBTUUwKICAgICAgICAgICAgQ09NTUlUCiAgICAgICAgRU5ELUVYRUMKICAgICAgICBESVNQTEFZICdUcmFuc2FjdGlvbiBjb21taXR0ZWQuJwogICAgRUxTRQogICAgICAgIEVYRUMgU1FMCiAgICAgICAgICAgIFJPTExCQUNLCiAgICAgICAgRU5ELUVYRUMKICAgICAgICBESVNQTEFZICdUcmFuc2FjdGlvbiByb2xsZWQgYmFjay4gU1FMQ09ERTogJyBTUUxDT0RFCiAgICBFTkQtSUYuCgogICAgU1RPUCBSVU4u"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. TransactionControl.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  SQL-STATUS  PIC X(10).

EXEC SQL
    INCLUDE SQLCA
END-EXEC.

PROCEDURE DIVISION.
    EXEC SQL
        BEGIN TRANSACTION
    END-EXEC.

    EXEC SQL
        UPDATE EMPLOYEE
        SET SALARY = SALARY * 1.1
        WHERE DEPT_ID = 10
    END-EXEC.

    IF SQLCODE = 0
        EXEC SQL
            COMMIT
        END-EXEC
        DISPLAY 'Transaction committed.'
    ELSE
        EXEC SQL
            ROLLBACK
        END-EXEC
        DISPLAY 'Transaction rolled back. SQLCODE: ' SQLCODE
    END-IF.

    STOP RUN.</pre></div><div class='content'><ul>
<li><strong>BEGIN TRANSACTION</strong>: Starts a new transaction.</li>
<li><strong>COMMIT</strong>: Commits the transaction, making all changes permanent.</li>
<li><strong>ROLLBACK</strong>: Rolls back the transaction, undoing all changes.</li>
</ul>
</div><h1>Error Handling</h1>
<div class='content'><p>Proper error handling is essential for robust database operations. The SQLCA structure provides detailed information about errors.</p>
</div><h2>Example: Error Handling</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEVycm9ySGFuZGxpbmcuCgpEQVRBIERJVklTSU9OLgpXT1JLSU5HLVNUT1JBR0UgU0VDVElPTi4KMDEgIFNRTC1TVEFUVVMgIFBJQyBYKDEwKS4KCkVYRUMgU1FMCiAgICBJTkNMVURFIFNRTENBCkVORC1FWEVDLgoKUFJPQ0VEVVJFIERJVklTSU9OLgogICAgRVhFQyBTUUwKICAgICAgICBERUxFVEUgRlJPTSBFTVBMT1lFRQogICAgICAgIFdIRVJFIEVNUF9JRCA9IDk5OTk5CiAgICBFTkQtRVhFQy4KCiAgICBJRiBTUUxDT0RFIDw+IDAKICAgICAgICBESVNQTEFZICdFcnJvciBvY2N1cnJlZC4gU1FMQ09ERTogJyBTUUxDT0RFCiAgICAgICAgRElTUExBWSAnU1FMRVJSTTogJyBTUUxFUlJNCiAgICBFTFNFCiAgICAgICAgRElTUExBWSAnUmVjb3JkIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5LicKICAgIEVORC1JRi4KCiAgICBTVE9QIFJVTi4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. ErrorHandling.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  SQL-STATUS  PIC X(10).

EXEC SQL
    INCLUDE SQLCA
END-EXEC.

PROCEDURE DIVISION.
    EXEC SQL
        DELETE FROM EMPLOYEE
        WHERE EMP_ID = 99999
    END-EXEC.

    IF SQLCODE &lt;&gt; 0
        DISPLAY 'Error occurred. SQLCODE: ' SQLCODE
        DISPLAY 'SQLERRM: ' SQLERRM
    ELSE
        DISPLAY 'Record deleted successfully.'
    END-IF.

    STOP RUN.</pre></div><div class='content'><ul>
<li><strong>SQLERRM</strong>: Provides a descriptive error message.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this topic, we covered the essential techniques for accessing databases using COBOL. We explored how to establish a connection, execute SQL queries, manage transactions, and handle errors. With these skills, you can effectively interact with databases in your COBOL applications, ensuring data integrity and robust error handling.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='embedded-sql-in-cobol'>&#x25C4;Embedded SQL in COBOL</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Database Access Techniques in COBOL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='handling-transactions'>Handling Transactions &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
