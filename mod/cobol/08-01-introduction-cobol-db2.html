<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction to COBOL-DB2</title>

    <link rel="alternate" href="https://campusempresa.com/mod/cobol/08-01-introduction-cobol-db2" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/cobol/08-01-introduction-cobol-db2" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/cobol/08-01-introduction-cobol-db2" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/cobol/08-01-introduction-cobol-db2" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/cobol/08-01-introduction-cobol-db2" class="px-2">CA</a>
					</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='07-03-common-errors-solutions' title="Common Errors and Solutions">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Introduction to COBOL-DB2</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-02-embedded-sql-cobol' title="Embedded SQL in COBOL">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1><p>Overview</p>
</h1>
<div class='content'><p>In this module, we will explore the integration of COBOL with DB2, a powerful relational database management system (RDBMS) from IBM. This combination is widely used in enterprise environments for handling large volumes of data efficiently. By the end of this module, you will understand how to embed SQL statements within COBOL programs to interact with DB2 databases.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>DB2 Basics</strong>: Understanding what DB2 is and its role in data management.</li>
<li><strong>Embedded SQL</strong>: Learning how to embed SQL statements within COBOL programs.</li>
<li><strong>Connecting to DB2</strong>: Establishing a connection between COBOL programs and DB2 databases.</li>
<li><strong>Executing SQL Statements</strong>: Performing CRUD (Create, Read, Update, Delete) operations using SQL in COBOL.</li>
<li><strong>Handling SQL Errors</strong>: Managing errors that occur during SQL execution.</li>
</ol>
</div><h1><p>DB2 Basics</p>
</h1>
<div class='content'><p>DB2 is a family of data management products, including database servers, developed by IBM. It is designed to store, retrieve, and manage data efficiently. DB2 supports SQL (Structured Query Language) for querying and manipulating data.</p>
</div><h2><p>Key Features of DB2</p>
</h2>
<div class='content'><ul>
<li><strong>High Performance</strong>: Optimized for high-speed data processing.</li>
<li><strong>Scalability</strong>: Can handle large volumes of data and numerous concurrent users.</li>
<li><strong>Security</strong>: Provides robust security features to protect data.</li>
<li><strong>Reliability</strong>: Ensures data integrity and availability.</li>
</ul>
</div><h1><p>Embedded SQL in COBOL</p>
</h1>
<div class='content'><p>Embedded SQL allows you to include SQL statements directly within your COBOL code. This integration enables COBOL programs to interact with DB2 databases seamlessly.</p>
</div><h2><p>Basic Structure of Embedded SQL</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIFNRTC1TVEFURU1FTlQKRU5ELUVYRUMu"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    SQL-STATEMENT
END-EXEC.</pre></div><div class='content'><ul>
<li><strong>EXEC SQL</strong>: Marks the beginning of an SQL statement.</li>
<li><strong>SQL-STATEMENT</strong>: The SQL command to be executed.</li>
<li><strong>END-EXEC</strong>: Marks the end of the SQL statement.</li>
</ul>
</div><h2><p>Example: Simple SELECT Statement</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIFNFTEVDVCBGSVJTVE5BTUUsIExBU1ROQU1FCiAgICBJTlRPIDpGSVJTVE5BTUUsIDpMQVNUTkFNRQogICAgRlJPTSBFTVBMT1lFRVMKICAgIFdIRVJFIEVNUExPWUVFX0lEID0gOkVNUC1JRApFTkQtRVhFQy4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    SELECT FIRSTNAME, LASTNAME
    INTO :FIRSTNAME, :LASTNAME
    FROM EMPLOYEES
    WHERE EMPLOYEE_ID = :EMP-ID
END-EXEC.</pre></div><div class='content'><ul>
<li><strong>SELECT</strong>: SQL command to retrieve data.</li>
<li><strong>INTO</strong>: Specifies the COBOL variables to store the retrieved data.</li>
<li><strong>FROM</strong>: Specifies the table to query.</li>
<li><strong>WHERE</strong>: Specifies the condition to filter the data.</li>
</ul>
</div><h1><p>Connecting to DB2</p>
</h1>
<div class='content'><p>To execute SQL statements, a COBOL program must first establish a connection to the DB2 database.</p>
</div><h2><p>Steps to Connect to DB2</p>
</h2>
<div class='content'><ol>
<li><strong>Include SQLCA</strong>: SQL Communication Area (SQLCA) is a structure used to store information about the execution of SQL statements.</li>
<li><strong>Declare Host Variables</strong>: COBOL variables that will be used in SQL statements.</li>
<li><strong>Establish Connection</strong>: Use the <code>CONNECT</code> statement to connect to the DB2 database.</li>
</ol>
</div><h2><p>Example: Connecting to DB2</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("V09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCkVYRUMgU1FMIElOQ0xVREUgU1FMQ0EgRU5ELUVYRUMuCgowMSAgVVNFUklEICAgICBQSUMgWCg4KSBWQUxVRSAnZGIydXNlcicuCjAxICBQQVNTV09SRCAgIFBJQyBYKDgpIFZBTFVFICdkYjJwYXNzJy4KMDEgIFNRTENPREUgICAgUElDIFM5KDkpIENPTVAuCgpQUk9DRURVUkUgRElWSVNJT04uCkVYRUMgU1FMCiAgICBDT05ORUNUIFRPIFNBTVBMRQogICAgVVNFUiA6VVNFUklEIFVTSU5HIDpQQVNTV09SRApFTkQtRVhFQy4KCklGIFNRTENPREUgTk9UID0gMAogICAgRElTUExBWSAnQ29ubmVjdGlvbiBmYWlsZWQgd2l0aCBTUUxDT0RFOiAnIFNRTENPREUKICAgIFNUT1AgUlVOLgpFTFNFCiAgICBESVNQTEFZICdDb25uZWN0aW9uIHN1Y2Nlc3NmdWwnLg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>WORKING-STORAGE SECTION.
EXEC SQL INCLUDE SQLCA END-EXEC.

01  USERID     PIC X(8) VALUE 'db2user'.
01  PASSWORD   PIC X(8) VALUE 'db2pass'.
01  SQLCODE    PIC S9(9) COMP.

PROCEDURE DIVISION.
EXEC SQL
    CONNECT TO SAMPLE
    USER :USERID USING :PASSWORD
END-EXEC.

IF SQLCODE NOT = 0
    DISPLAY 'Connection failed with SQLCODE: ' SQLCODE
    STOP RUN.
ELSE
    DISPLAY 'Connection successful'.</pre></div><div class='content'><ul>
<li><strong>SQLCA</strong>: Included to handle SQL execution information.</li>
<li><strong>USERID and PASSWORD</strong>: Host variables for database credentials.</li>
<li><strong>CONNECT</strong>: SQL command to establish a connection to the DB2 database.</li>
</ul>
</div><h1><p>Executing SQL Statements</p>
</h1>
<div class='content'><p>Once connected, you can execute various SQL statements to interact with the database.</p>
</div><h2><p>Example: Inserting Data</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("V09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCjAxICBFTVAtSUQgICAgIFBJQyA5KDUpLgowMSAgRklSU1ROQU1FICBQSUMgWCgyMCkuCjAxICBMQVNUTkFNRSAgIFBJQyBYKDIwKS4KClBST0NFRFVSRSBESVZJU0lPTi4KTU9WRSAxMjM0NSBUTyBFTVAtSUQuCk1PVkUgJ0pvaG4nIFRPIEZJUlNUTkFNRS4KTU9WRSAnRG9lJyBUTyBMQVNUTkFNRS4KCkVYRUMgU1FMCiAgICBJTlNFUlQgSU5UTyBFTVBMT1lFRVMgKEVNUExPWUVFX0lELCBGSVJTVE5BTUUsIExBU1ROQU1FKQogICAgVkFMVUVTICg6RU1QLUlELCA6RklSU1ROQU1FLCA6TEFTVE5BTUUpCkVORC1FWEVDLgoKSUYgU1FMQ09ERSBOT1QgPSAwCiAgICBESVNQTEFZICdJbnNlcnQgZmFpbGVkIHdpdGggU1FMQ09ERTogJyBTUUxDT0RFCiAgICBTVE9QIFJVTi4KRUxTRQogICAgRElTUExBWSAnSW5zZXJ0IHN1Y2Nlc3NmdWwnLg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>WORKING-STORAGE SECTION.
01  EMP-ID     PIC 9(5).
01  FIRSTNAME  PIC X(20).
01  LASTNAME   PIC X(20).

PROCEDURE DIVISION.
MOVE 12345 TO EMP-ID.
MOVE 'John' TO FIRSTNAME.
MOVE 'Doe' TO LASTNAME.

EXEC SQL
    INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRSTNAME, LASTNAME)
    VALUES (:EMP-ID, :FIRSTNAME, :LASTNAME)
END-EXEC.

IF SQLCODE NOT = 0
    DISPLAY 'Insert failed with SQLCODE: ' SQLCODE
    STOP RUN.
ELSE
    DISPLAY 'Insert successful'.</pre></div><div class='content'><ul>
<li><strong>INSERT INTO</strong>: SQL command to insert data into a table.</li>
<li><strong>VALUES</strong>: Specifies the values to be inserted.</li>
</ul>
</div><h1><p>Handling SQL Errors</p>
</h1>
<div class='content'><p>SQL errors can occur during the execution of SQL statements. These errors are captured in the SQLCA structure.</p>
</div><h2><p>Common SQLCA Fields</p>
</h2>
<div class='content'><ul>
<li><strong>SQLCODE</strong>: Numeric code indicating the result of the SQL statement.</li>
<li><strong>SQLERRM</strong>: Error message text.</li>
</ul>
</div><h2><p>Example: Error Handling</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIERFTEVURSBGUk9NIEVNUExPWUVFUwogICAgV0hFUkUgRU1QTE9ZRUVfSUQgPSA6RU1QLUlECkVORC1FWEVDLgoKSUYgU1FMQ09ERSBOT1QgPSAwCiAgICBESVNQTEFZICdEZWxldGUgZmFpbGVkIHdpdGggU1FMQ09ERTogJyBTUUxDT0RFCiAgICBESVNQTEFZICdFcnJvciBtZXNzYWdlOiAnIFNRTEVSUk0KICAgIFNUT1AgUlVOLgpFTFNFCiAgICBESVNQTEFZICdEZWxldGUgc3VjY2Vzc2Z1bCcu"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    DELETE FROM EMPLOYEES
    WHERE EMPLOYEE_ID = :EMP-ID
END-EXEC.

IF SQLCODE NOT = 0
    DISPLAY 'Delete failed with SQLCODE: ' SQLCODE
    DISPLAY 'Error message: ' SQLERRM
    STOP RUN.
ELSE
    DISPLAY 'Delete successful'.</pre></div><div class='content'><ul>
<li><strong>SQLCODE</strong>: Checked to determine if the SQL statement was successful.</li>
<li><strong>SQLERRM</strong>: Displays the error message if an error occurs.</li>
</ul>
</div><h1><p>Summary</p>
</h1>
<div class='content'><p>In this module, we covered the basics of integrating COBOL with DB2, including:</p>
<ul>
<li>Understanding DB2 and its features.</li>
<li>Embedding SQL statements within COBOL programs.</li>
<li>Establishing a connection to a DB2 database.</li>
<li>Executing SQL statements to perform database operations.</li>
<li>Handling SQL errors effectively.</li>
</ul>
<p>By mastering these concepts, you will be able to create robust COBOL programs that interact with DB2 databases, enabling efficient data management in enterprise environments.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='07-03-common-errors-solutions' title="Common Errors and Solutions">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-02-embedded-sql-cobol' title="Embedded SQL in COBOL">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
