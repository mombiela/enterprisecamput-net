<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced File Handling in COBOL</title>

    <link rel="alternate" href="https://campusempresa.com/mod/cobol/advanced-file-handling" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/cobol/advanced-file-handling" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/cobol/advanced-file-handling" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/cobol/advanced-file-handling" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/cobol/advanced-file-handling" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='date-and-time-handling'>&#x25C4;Date and Time Handling</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Advanced File Handling in COBOL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='error-handling-techniques'>Error Handling Techniques &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this section, we will delve into advanced file handling techniques in COBOL. This includes understanding indexed files, relative files, and advanced file operations such as dynamic access and file status handling. By the end of this section, you should be able to efficiently manage and manipulate files in COBOL for complex applications.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Indexed Files</strong>: Files that allow access to records based on key values.</li>
<li><strong>Relative Files</strong>: Files that allow access to records based on their relative position.</li>
<li><strong>Dynamic Access</strong>: The ability to read, write, and update records in a file dynamically.</li>
<li><strong>File Status Codes</strong>: Codes that indicate the success or failure of file operations.</li>
</ul>
</div><h1>Indexed Files</h1>
<div class='content'><p>Indexed files in COBOL allow you to access records using a key. This is particularly useful for databases and applications where quick retrieval of records is necessary.</p>
</div><h2>Defining an Indexed File</h2>
<div class='content'><p>To define an indexed file, you need to specify the <code>ORGANIZATION</code> clause as <code>INDEXED</code> and define the key.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RklMRS1DT05UUk9MLgogICAgU0VMRUNUIEVNUExPWUVFLUZJTEUgQVNTSUdOIFRPICdlbXBsb3llZS5kYXQnCiAgICAgICAgT1JHQU5JWkFUSU9OIElTIElOREVYRUQKICAgICAgICBBQ0NFU1MgTU9ERSBJUyBEWU5BTUlDCiAgICAgICAgUkVDT1JEIEtFWSBJUyBFTVAtSUQKICAgICAgICBGSUxFIFNUQVRVUyBJUyBXUy1GSUxFLVNUQVRVUy4KCkRBVEEgRElWSVNJT04uCkZJTEUgU0VDVElPTi4KRkQgIEVNUExPWUVFLUZJTEUuCjAxICBFTVBMT1lFRS1SRUNPUkQuCiAgICAwNSAgRU1QLUlEICAgICAgICAgUElDIFgoNSkuCiAgICAwNSAgRU1QLU5BTUUgICAgICAgUElDIFgoMjApLgogICAgMDUgIEVNUC1ERVBUICAgICAgIFBJQyBYKDEwKS4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>FILE-CONTROL.
    SELECT EMPLOYEE-FILE ASSIGN TO 'employee.dat'
        ORGANIZATION IS INDEXED
        ACCESS MODE IS DYNAMIC
        RECORD KEY IS EMP-ID
        FILE STATUS IS WS-FILE-STATUS.

DATA DIVISION.
FILE SECTION.
FD  EMPLOYEE-FILE.
01  EMPLOYEE-RECORD.
    05  EMP-ID         PIC X(5).
    05  EMP-NAME       PIC X(20).
    05  EMP-DEPT       PIC X(10).</pre></div><div class='content'></div><h2>Accessing Records</h2>
<div class='content'><p>You can access records in an indexed file using the <code>READ</code>, <code>WRITE</code>, <code>REWRITE</code>, and <code>DELETE</code> statements.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UFJPQ0VEVVJFIERJVklTSU9OLgogICAgT1BFTiBJLU8gRU1QTE9ZRUUtRklMRS4KICAgIE1PVkUgJzEyMzQ1JyBUTyBFTVAtSUQuCiAgICBSRUFEIEVNUExPWUVFLUZJTEUKICAgICAgICBJTlZBTElEIEtFWSBESVNQTEFZICdSZWNvcmQgbm90IGZvdW5kJy4KICAgIElGIFdTLUZJTEUtU1RBVFVTID0gJzAwJwogICAgICAgIERJU1BMQVkgJ0VtcGxveWVlIE5hbWU6ICcgRU1QLU5BTUUKICAgICAgICBESVNQTEFZICdFbXBsb3llZSBEZXB0OiAnIEVNUC1ERVBULgogICAgQ0xPU0UgRU1QTE9ZRUUtRklMRS4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PROCEDURE DIVISION.
    OPEN I-O EMPLOYEE-FILE.
    MOVE '12345' TO EMP-ID.
    READ EMPLOYEE-FILE
        INVALID KEY DISPLAY 'Record not found'.
    IF WS-FILE-STATUS = '00'
        DISPLAY 'Employee Name: ' EMP-NAME
        DISPLAY 'Employee Dept: ' EMP-DEPT.
    CLOSE EMPLOYEE-FILE.</pre></div><div class='content'></div><h1>Relative Files</h1>
<div class='content'><p>Relative files allow you to access records based on their relative position in the file.</p>
</div><h2>Defining a Relative File</h2>
<div class='content'><p>To define a relative file, use the <code>ORGANIZATION</code> clause as <code>RELATIVE</code> and specify the relative key.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RklMRS1DT05UUk9MLgogICAgU0VMRUNUIENVU1RPTUVSLUZJTEUgQVNTSUdOIFRPICdjdXN0b21lci5kYXQnCiAgICAgICAgT1JHQU5JWkFUSU9OIElTIFJFTEFUSVZFCiAgICAgICAgQUNDRVNTIE1PREUgSVMgRFlOQU1JQwogICAgICAgIFJFTEFUSVZFIEtFWSBJUyBDVVNULVJFTC1LRVkKICAgICAgICBGSUxFIFNUQVRVUyBJUyBXUy1GSUxFLVNUQVRVUy4KCkRBVEEgRElWSVNJT04uCkZJTEUgU0VDVElPTi4KRkQgIENVU1RPTUVSLUZJTEUuCjAxICBDVVNUT01FUi1SRUNPUkQuCiAgICAwNSAgQ1VTVC1SRUwtS0VZICAgUElDIDkoNCkuCiAgICAwNSAgQ1VTVC1OQU1FICAgICAgUElDIFgoMjApLgogICAgMDUgIENVU1QtQUREUkVTUyAgIFBJQyBYKDUwKS4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>FILE-CONTROL.
    SELECT CUSTOMER-FILE ASSIGN TO 'customer.dat'
        ORGANIZATION IS RELATIVE
        ACCESS MODE IS DYNAMIC
        RELATIVE KEY IS CUST-REL-KEY
        FILE STATUS IS WS-FILE-STATUS.

DATA DIVISION.
FILE SECTION.
FD  CUSTOMER-FILE.
01  CUSTOMER-RECORD.
    05  CUST-REL-KEY   PIC 9(4).
    05  CUST-NAME      PIC X(20).
    05  CUST-ADDRESS   PIC X(50).</pre></div><div class='content'></div><h2>Accessing Records</h2>
<div class='content'><p>You can access records in a relative file using the <code>READ</code>, <code>WRITE</code>, <code>REWRITE</code>, and <code>DELETE</code> statements.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UFJPQ0VEVVJFIERJVklTSU9OLgogICAgT1BFTiBJLU8gQ1VTVE9NRVItRklMRS4KICAgIE1PVkUgMTAwMSBUTyBDVVNULVJFTC1LRVkuCiAgICBSRUFEIENVU1RPTUVSLUZJTEUKICAgICAgICBJTlZBTElEIEtFWSBESVNQTEFZICdSZWNvcmQgbm90IGZvdW5kJy4KICAgIElGIFdTLUZJTEUtU1RBVFVTID0gJzAwJwogICAgICAgIERJU1BMQVkgJ0N1c3RvbWVyIE5hbWU6ICcgQ1VTVC1OQU1FCiAgICAgICAgRElTUExBWSAnQ3VzdG9tZXIgQWRkcmVzczogJyBDVVNULUFERFJFU1MuCiAgICBDTE9TRSBDVVNUT01FUi1GSUxFLg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PROCEDURE DIVISION.
    OPEN I-O CUSTOMER-FILE.
    MOVE 1001 TO CUST-REL-KEY.
    READ CUSTOMER-FILE
        INVALID KEY DISPLAY 'Record not found'.
    IF WS-FILE-STATUS = '00'
        DISPLAY 'Customer Name: ' CUST-NAME
        DISPLAY 'Customer Address: ' CUST-ADDRESS.
    CLOSE CUSTOMER-FILE.</pre></div><div class='content'></div><h1>Dynamic Access</h1>
<div class='content'><p>Dynamic access allows you to read, write, and update records in a file without closing and reopening the file.</p>
</div><h2>Example of Dynamic Access</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UFJPQ0VEVVJFIERJVklTSU9OLgogICAgT1BFTiBJLU8gRU1QTE9ZRUUtRklMRS4KICAgIE1PVkUgJzEyMzQ1JyBUTyBFTVAtSUQuCiAgICBSRUFEIEVNUExPWUVFLUZJTEUKICAgICAgICBJTlZBTElEIEtFWSBESVNQTEFZICdSZWNvcmQgbm90IGZvdW5kJy4KICAgIElGIFdTLUZJTEUtU1RBVFVTID0gJzAwJwogICAgICAgIE1PVkUgJ0pvaG4gRG9lJyBUTyBFTVAtTkFNRQogICAgICAgIFJFV1JJVEUgRU1QTE9ZRUUtUkVDT1JECiAgICAgICAgSU5WQUxJRCBLRVkgRElTUExBWSAnVXBkYXRlIGZhaWxlZCcuCiAgICBDTE9TRSBFTVBMT1lFRS1GSUxFLg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PROCEDURE DIVISION.
    OPEN I-O EMPLOYEE-FILE.
    MOVE '12345' TO EMP-ID.
    READ EMPLOYEE-FILE
        INVALID KEY DISPLAY 'Record not found'.
    IF WS-FILE-STATUS = '00'
        MOVE 'John Doe' TO EMP-NAME
        REWRITE EMPLOYEE-RECORD
        INVALID KEY DISPLAY 'Update failed'.
    CLOSE EMPLOYEE-FILE.</pre></div><div class='content'></div><h1>File Status Codes</h1>
<div class='content'><p>File status codes provide feedback on the success or failure of file operations. It is crucial to handle these codes to ensure robust file handling.</p>
</div><h2>Common File Status Codes</h2>
<div class='content'><p>| Status Code | Meaning                  |
|-------------|--------------------------|
| 00          | Successful operation     |
| 10          | End of file              |
| 23          | Record not found         |
| 34          | Permanent I/O error      |
| 92          | Logic error              |</p>
</div><h2>Handling File Status Codes</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UFJPQ0VEVVJFIERJVklTSU9OLgogICAgT1BFTiBJLU8gRU1QTE9ZRUUtRklMRS4KICAgIElGIFdTLUZJTEUtU1RBVFVTIE5PVCA9ICcwMCcKICAgICAgICBESVNQTEFZICdFcnJvciBvcGVuaW5nIGZpbGU6ICcgV1MtRklMRS1TVEFUVVMKICAgICAgICBTVE9QIFJVTi4KICAgIE1PVkUgJzEyMzQ1JyBUTyBFTVAtSUQuCiAgICBSRUFEIEVNUExPWUVFLUZJTEUKICAgICAgICBJTlZBTElEIEtFWSBESVNQTEFZICdSZWNvcmQgbm90IGZvdW5kOiAnIFdTLUZJTEUtU1RBVFVTLgogICAgQ0xPU0UgRU1QTE9ZRUUtRklMRS4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PROCEDURE DIVISION.
    OPEN I-O EMPLOYEE-FILE.
    IF WS-FILE-STATUS NOT = '00'
        DISPLAY 'Error opening file: ' WS-FILE-STATUS
        STOP RUN.
    MOVE '12345' TO EMP-ID.
    READ EMPLOYEE-FILE
        INVALID KEY DISPLAY 'Record not found: ' WS-FILE-STATUS.
    CLOSE EMPLOYEE-FILE.</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Advanced file handling in COBOL involves understanding and utilizing indexed and relative files, dynamic access, and properly handling file status codes. Mastering these concepts will enable you to create efficient and robust COBOL applications that can handle complex file operations. Practice these techniques with various examples to solidify your understanding and improve your file handling skills in COBOL.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='date-and-time-handling'>&#x25C4;Date and Time Handling</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Advanced File Handling in COBOL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='error-handling-techniques'>Error Handling Techniques &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
