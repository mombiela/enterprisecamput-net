<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embedded SQL in COBOL</title>

    <link rel="alternate" href="https://campusempresa.com/mod/cobol/08-02-embedded-sql-cobol" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/cobol/08-02-embedded-sql-cobol" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/cobol/08-02-embedded-sql-cobol" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/cobol/08-02-embedded-sql-cobol" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/cobol/08-02-embedded-sql-cobol" class="px-2">CA</a>
					</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-01-introduction-cobol-db2' title="Introduction to COBOL-DB2">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Embedded SQL in COBOL</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-03-database-operations' title="Database Operations">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Embedded SQL allows COBOL programs to interact with databases directly by embedding SQL statements within the COBOL code. This integration provides a powerful way to perform database operations such as querying, updating, and managing data within a COBOL application.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Embedded SQL</strong>: SQL statements are written directly within the COBOL program.</li>
<li><strong>Host Variables</strong>: COBOL variables used to pass data between the COBOL program and the SQL statements.</li>
<li><strong>EXEC SQL</strong>: The keyword used to start an embedded SQL statement.</li>
<li><strong>END-EXEC</strong>: The keyword used to end an embedded SQL statement.</li>
</ol>
</div><h1><p>Basic Structure</p>
</h1>
<div class='content'><p>An embedded SQL statement in COBOL typically follows this structure:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIFNRTC1TVEFURU1FTlQKRU5ELUVYRUMu"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    SQL-STATEMENT
END-EXEC.</pre></div><div class='content'></div><h2><p>Example</p>
</h2>
<div class='content'><p>Here is a simple example of an embedded SQL statement in a COBOL program:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEVtYmVkZGVkU1FMRXhhbXBsZS4KCkRBVEEgRElWSVNJT04uCldPUktJTkctU1RPUkFHRSBTRUNUSU9OLgowMSBXUy1FTVAtSUQgUElDIDkoNSkuCjAxIFdTLUVNUC1OQU1FIFBJQyBYKDIwKS4KClBST0NFRFVSRSBESVZJU0lPTi4KICAgIEVYRUMgU1FMCiAgICAgICAgU0VMRUNUIEVNUF9OQU1FCiAgICAgICAgSU5UTyA6V1MtRU1QLU5BTUUKICAgICAgICBGUk9NIEVNUExPWUVFCiAgICAgICAgV0hFUkUgRU1QX0lEID0gOldTLUVNUC1JRAogICAgRU5ELUVYRUMuCgogICAgRElTUExBWSAnRW1wbG95ZWUgTmFtZTogJyBXUy1FTVAtTkFNRS4KCiAgICBTVE9QIFJVTi4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. EmbeddedSQLExample.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-EMP-ID PIC 9(5).
01 WS-EMP-NAME PIC X(20).

PROCEDURE DIVISION.
    EXEC SQL
        SELECT EMP_NAME
        INTO :WS-EMP-NAME
        FROM EMPLOYEE
        WHERE EMP_ID = :WS-EMP-ID
    END-EXEC.

    DISPLAY 'Employee Name: ' WS-EMP-NAME.

    STOP RUN.</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>Host Variables</strong>: <code>WS-EMP-ID</code> and <code>WS-EMP-NAME</code> are COBOL variables used in the SQL statement.</li>
<li><strong>EXEC SQL ... END-EXEC</strong>: The SQL statement is embedded between these keywords.</li>
<li><strong>SELECT Statement</strong>: Retrieves the employee name from the <code>EMPLOYEE</code> table where the <code>EMP_ID</code> matches <code>WS-EMP-ID</code>.</li>
</ul>
</div><h1><p>Practical Example</p>
</h1>
<div class='content'><p>Let's create a more detailed example that includes connecting to a database, querying data, and handling the results.</p>
</div><h2><p>Example: Fetching Employee Details</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEZldGNoRW1wbG95ZWVEZXRhaWxzLgoKREFUQSBESVZJU0lPTi4KV09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCjAxIFdTLUVNUC1JRCBQSUMgOSg1KSBWQUxVRSAxMjM0NS4KMDEgV1MtRU1QLU5BTUUgUElDIFgoMjApLgowMSBXUy1FTVAtU0FMQVJZIFBJQyA5KDcpVjk5LgoKUFJPQ0VEVVJFIERJVklTSU9OLgogICAgRVhFQyBTUUwKICAgICAgICBDT05ORUNUIFRPICdEQk5BTUUnIFVTRVIgJ3VzZXJuYW1lJyBVU0lORyAncGFzc3dvcmQnCiAgICBFTkQtRVhFQy4KCiAgICBFWEVDIFNRTAogICAgICAgIFNFTEVDVCBFTVBfTkFNRSwgRU1QX1NBTEFSWQogICAgICAgIElOVE8gOldTLUVNUC1OQU1FLCA6V1MtRU1QLVNBTEFSWQogICAgICAgIEZST00gRU1QTE9ZRUUKICAgICAgICBXSEVSRSBFTVBfSUQgPSA6V1MtRU1QLUlECiAgICBFTkQtRVhFQy4KCiAgICBESVNQTEFZICdFbXBsb3llZSBOYW1lOiAnIFdTLUVNUC1OQU1FLgogICAgRElTUExBWSAnRW1wbG95ZWUgU2FsYXJ5OiAnIFdTLUVNUC1TQUxBUlkuCgogICAgRVhFQyBTUUwKICAgICAgICBDT01NSVQKICAgIEVORC1FWEVDLgoKICAgIEVYRUMgU1FMCiAgICAgICAgRElTQ09OTkVDVCBDVVJSRU5UCiAgICBFTkQtRVhFQy4KCiAgICBTVE9QIFJVTi4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. FetchEmployeeDetails.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-EMP-ID PIC 9(5) VALUE 12345.
01 WS-EMP-NAME PIC X(20).
01 WS-EMP-SALARY PIC 9(7)V99.

PROCEDURE DIVISION.
    EXEC SQL
        CONNECT TO 'DBNAME' USER 'username' USING 'password'
    END-EXEC.

    EXEC SQL
        SELECT EMP_NAME, EMP_SALARY
        INTO :WS-EMP-NAME, :WS-EMP-SALARY
        FROM EMPLOYEE
        WHERE EMP_ID = :WS-EMP-ID
    END-EXEC.

    DISPLAY 'Employee Name: ' WS-EMP-NAME.
    DISPLAY 'Employee Salary: ' WS-EMP-SALARY.

    EXEC SQL
        COMMIT
    END-EXEC.

    EXEC SQL
        DISCONNECT CURRENT
    END-EXEC.

    STOP RUN.</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>CONNECT Statement</strong>: Connects to the database using the provided credentials.</li>
<li><strong>SELECT Statement</strong>: Retrieves the employee name and salary from the <code>EMPLOYEE</code> table.</li>
<li><strong>COMMIT Statement</strong>: Commits the transaction.</li>
<li><strong>DISCONNECT Statement</strong>: Disconnects from the database.</li>
</ul>
</div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Retrieve Department Name</p>
</h2>
<div class='content'><p><strong>Task</strong>: Write a COBOL program that retrieves the department name for a given department ID.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEZldGNoRGVwYXJ0bWVudE5hbWUuCgpEQVRBIERJVklTSU9OLgpXT1JLSU5HLVNUT1JBR0UgU0VDVElPTi4KMDEgV1MtREVQVC1JRCBQSUMgOSgzKSBWQUxVRSAxMDEuCjAxIFdTLURFUFQtTkFNRSBQSUMgWCgzMCkuCgpQUk9DRURVUkUgRElWSVNJT04uCiAgICBFWEVDIFNRTAogICAgICAgIENPTk5FQ1QgVE8gJ0RCTkFNRScgVVNFUiAndXNlcm5hbWUnIFVTSU5HICdwYXNzd29yZCcKICAgIEVORC1FWEVDLgoKICAgIEVYRUMgU1FMCiAgICAgICAgU0VMRUNUIERFUFRfTkFNRQogICAgICAgIElOVE8gOldTLURFUFQtTkFNRQogICAgICAgIEZST00gREVQQVJUTUVOVAogICAgICAgIFdIRVJFIERFUFRfSUQgPSA6V1MtREVQVC1JRAogICAgRU5ELUVYRUMuCgogICAgRElTUExBWSAnRGVwYXJ0bWVudCBOYW1lOiAnIFdTLURFUFQtTkFNRS4KCiAgICBFWEVDIFNRTAogICAgICAgIENPTU1JVAogICAgRU5ELUVYRUMuCgogICAgRVhFQyBTUUwKICAgICAgICBESVNDT05ORUNUIENVUlJFTlQKICAgIEVORC1FWEVDLgoKICAgIFNUT1AgUlVOLg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. FetchDepartmentName.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-DEPT-ID PIC 9(3) VALUE 101.
01 WS-DEPT-NAME PIC X(30).

PROCEDURE DIVISION.
    EXEC SQL
        CONNECT TO 'DBNAME' USER 'username' USING 'password'
    END-EXEC.

    EXEC SQL
        SELECT DEPT_NAME
        INTO :WS-DEPT-NAME
        FROM DEPARTMENT
        WHERE DEPT_ID = :WS-DEPT-ID
    END-EXEC.

    DISPLAY 'Department Name: ' WS-DEPT-NAME.

    EXEC SQL
        COMMIT
    END-EXEC.

    EXEC SQL
        DISCONNECT CURRENT
    END-EXEC.

    STOP RUN.</pre></div><div class='content'></div><h2><p>Exercise 2: Update Employee Salary</p>
</h2>
<div class='content'><p><strong>Task</strong>: Write a COBOL program that updates the salary of an employee based on their employee ID.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIFVwZGF0ZUVtcGxveWVlU2FsYXJ5LgoKREFUQSBESVZJU0lPTi4KV09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCjAxIFdTLUVNUC1JRCBQSUMgOSg1KSBWQUxVRSAxMjM0NS4KMDEgV1MtTkVXLVNBTEFSWSBQSUMgOSg3KVY5OSBWQUxVRSA3NTAwMC4wMC4KClBST0NFRFVSRSBESVZJU0lPTi4KICAgIEVYRUMgU1FMCiAgICAgICAgQ09OTkVDVCBUTyAnREJOQU1FJyBVU0VSICd1c2VybmFtZScgVVNJTkcgJ3Bhc3N3b3JkJwogICAgRU5ELUVYRUMuCgogICAgRVhFQyBTUUwKICAgICAgICBVUERBVEUgRU1QTE9ZRUUKICAgICAgICBTRVQgRU1QX1NBTEFSWSA9IDpXUy1ORVctU0FMQVJZCiAgICAgICAgV0hFUkUgRU1QX0lEID0gOldTLUVNUC1JRAogICAgRU5ELUVYRUMuCgogICAgRElTUExBWSAnRW1wbG95ZWUgc2FsYXJ5IHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5LicKCiAgICBFWEVDIFNRTAogICAgICAgIENPTU1JVAogICAgRU5ELUVYRUMuCgogICAgRVhFQyBTUUwKICAgICAgICBESVNDT05ORUNUIENVUlJFTlQKICAgIEVORC1FWEVDLgoKICAgIFNUT1AgUlVOLg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. UpdateEmployeeSalary.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 WS-EMP-ID PIC 9(5) VALUE 12345.
01 WS-NEW-SALARY PIC 9(7)V99 VALUE 75000.00.

PROCEDURE DIVISION.
    EXEC SQL
        CONNECT TO 'DBNAME' USER 'username' USING 'password'
    END-EXEC.

    EXEC SQL
        UPDATE EMPLOYEE
        SET EMP_SALARY = :WS-NEW-SALARY
        WHERE EMP_ID = :WS-EMP-ID
    END-EXEC.

    DISPLAY 'Employee salary updated successfully.'

    EXEC SQL
        COMMIT
    END-EXEC.

    EXEC SQL
        DISCONNECT CURRENT
    END-EXEC.

    STOP RUN.</pre></div><div class='content'></div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Unmatched Host Variables</strong>: Ensure that the host variables in the SQL statement match the COBOL variables in terms of data type and length.</li>
<li><strong>SQL Errors</strong>: Always check for SQL errors after executing an SQL statement. Use SQLCODE and SQLSTATE for error handling.</li>
<li><strong>Proper Disconnection</strong>: Always disconnect from the database to free up resources.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Embedded SQL in COBOL provides a seamless way to integrate database operations within COBOL programs. By understanding the basic structure and practicing with examples, you can effectively manage and manipulate data in your COBOL applications. In the next section, we will delve into handling cursors in COBOL, which is essential for processing multiple rows of data retrieved from a database.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-01-introduction-cobol-db2' title="Introduction to COBOL-DB2">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-03-database-operations' title="Database Operations">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
