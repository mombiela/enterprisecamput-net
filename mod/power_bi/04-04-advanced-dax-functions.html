<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced DAX Functions</title>

    <link rel="alternate" href="https://campusempresa.com/mod/power_bi/04-04-advanced-dax-functions" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/power_bi/04-04-advanced-dax-functions" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/power_bi/04-04-advanced-dax-functions" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/power_bi/04-04-advanced-dax-functions" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/power_bi/04-04-advanced-dax-functions" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-03-time-intelligence-functions' title="Time Intelligence Functions">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Advanced DAX Functions</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-designing-effective-reports' title="Designing Effective Reports">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will delve into advanced DAX (Data Analysis Expressions) functions that allow you to perform complex calculations and data analysis in Power BI. This module is designed for users who are already familiar with basic DAX functions and want to enhance their skills to create more sophisticated data models and reports.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li>
<p><strong>Understanding Context in DAX</strong></p>
<ul>
<li>Row Context</li>
<li>Filter Context</li>
<li>Context Transition</li>
</ul>
</li>
<li>
<p><strong>Advanced Aggregation Functions</strong></p>
<ul>
<li>SUMX</li>
<li>AVERAGEX</li>
<li>MAXX</li>
<li>MINX</li>
</ul>
</li>
<li>
<p><strong>Time Intelligence Functions</strong></p>
<ul>
<li>SAMEPERIODLASTYEAR</li>
<li>DATESYTD</li>
<li>TOTALYTD</li>
<li>PARALLELPERIOD</li>
</ul>
</li>
<li>
<p><strong>Advanced Filtering Functions</strong></p>
<ul>
<li>CALCULATE</li>
<li>FILTER</li>
<li>ALL</li>
<li>ALLEXCEPT</li>
</ul>
</li>
<li>
<p><strong>Statistical Functions</strong></p>
<ul>
<li>MEDIANX</li>
<li>PERCENTILEX.INC</li>
<li>PERCENTILEX.EXC</li>
</ul>
</li>
<li>
<p><strong>Iterative Functions</strong></p>
<ul>
<li>GENERATE</li>
<li>GENERATEALL</li>
</ul>
</li>
</ol>
</div><h1>Understanding Context in DAX</h1>
<div class='content'></div><h2>Row Context</h2>
<div class='content'><p>Row context refers to the current row being processed in a table. It is automatically created when you use functions like <code>SUMX</code>, <code>AVERAGEX</code>, etc.</p>
</div><h2>Filter Context</h2>
<div class='content'><p>Filter context is the set of filters applied to the data model, either through slicers, filters, or DAX functions like <code>CALCULATE</code>.</p>
</div><h2>Context Transition</h2>
<div class='content'><p>Context transition occurs when a row context is converted into an equivalent filter context. This is often seen when using <code>CALCULATE</code> within a row context.</p>
</div><h1>Advanced Aggregation Functions</h1>
<div class='content'></div><h2>SUMX</h2>
<div class='content'><p><code>SUMX</code> iterates over a table, evaluating an expression for each row and then summing the results.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VG90YWwgU2FsZXMgPSBTVU1YKFNhbGVzLCBTYWxlc1tRdWFudGl0eV0gKiBTYWxlc1tQcmljZV0p"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Total Sales = SUMX(Sales, Sales[Quantity] * Sales[Price])</pre></div><div class='content'></div><h2>AVERAGEX</h2>
<div class='content'><p><code>AVERAGEX</code> calculates the average of an expression evaluated over a table.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QXZlcmFnZSBTYWxlcyA9IEFWRVJBR0VYKFNhbGVzLCBTYWxlc1tRdWFudGl0eV0gKiBTYWxlc1tQcmljZV0p"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Average Sales = AVERAGEX(Sales, Sales[Quantity] * Sales[Price])</pre></div><div class='content'></div><h2>MAXX</h2>
<div class='content'><p><code>MAXX</code> returns the maximum value of an expression evaluated over a table.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("TWF4IFNhbGVzID0gTUFYWChTYWxlcywgU2FsZXNbUXVhbnRpdHldICogU2FsZXNbUHJpY2VdKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Max Sales = MAXX(Sales, Sales[Quantity] * Sales[Price])</pre></div><div class='content'></div><h2>MINX</h2>
<div class='content'><p><code>MINX</code> returns the minimum value of an expression evaluated over a table.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("TWluIFNhbGVzID0gTUlOWChTYWxlcywgU2FsZXNbUXVhbnRpdHldICogU2FsZXNbUHJpY2VdKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Min Sales = MINX(Sales, Sales[Quantity] * Sales[Price])</pre></div><div class='content'></div><h1>Time Intelligence Functions</h1>
<div class='content'></div><h2>SAMEPERIODLASTYEAR</h2>
<div class='content'><p><code>SAMEPERIODLASTYEAR</code> returns a table that contains a column of dates shifted one year back.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U2FsZXMgTGFzdCBZZWFyID0gQ0FMQ1VMQVRFKFNVTShTYWxlc1tUb3RhbCBTYWxlc10pLCBTQU1FUEVSSU9ETEFTVFlFQVIoQ2FsZW5kYXJbRGF0ZV0pKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sales Last Year = CALCULATE(SUM(Sales[Total Sales]), SAMEPERIODLASTYEAR(Calendar[Date]))</pre></div><div class='content'></div><h2>DATESYTD</h2>
<div class='content'><p><code>DATESYTD</code> returns a table that contains a column of dates for the year-to-date period.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U2FsZXMgWVREID0gQ0FMQ1VMQVRFKFNVTShTYWxlc1tUb3RhbCBTYWxlc10pLCBEQVRFU1lURChDYWxlbmRhcltEYXRlXSkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sales YTD = CALCULATE(SUM(Sales[Total Sales]), DATESYTD(Calendar[Date]))</pre></div><div class='content'></div><h2>TOTALYTD</h2>
<div class='content'><p><code>TOTALYTD</code> calculates the year-to-date value of an expression.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VG90YWwgU2FsZXMgWVREID0gVE9UQUxZVEQoU1VNKFNhbGVzW1RvdGFsIFNhbGVzXSksIENhbGVuZGFyW0RhdGVdKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Total Sales YTD = TOTALYTD(SUM(Sales[Total Sales]), Calendar[Date])</pre></div><div class='content'></div><h2>PARALLELPERIOD</h2>
<div class='content'><p><code>PARALLELPERIOD</code> returns a table that contains a column of dates shifted by the specified number of intervals.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U2FsZXMgUGFyYWxsZWwgUGVyaW9kID0gQ0FMQ1VMQVRFKFNVTShTYWxlc1tUb3RhbCBTYWxlc10pLCBQQVJBTExFTFBFUklPRChDYWxlbmRhcltEYXRlXSwgLTEsIE1PTlRIKSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sales Parallel Period = CALCULATE(SUM(Sales[Total Sales]), PARALLELPERIOD(Calendar[Date], -1, MONTH))</pre></div><div class='content'></div><h1>Advanced Filtering Functions</h1>
<div class='content'></div><h2>CALCULATE</h2>
<div class='content'><p><code>CALCULATE</code> changes the context in which the data is evaluated.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RmlsdGVyZWQgU2FsZXMgPSBDQUxDVUxBVEUoU1VNKFNhbGVzW1RvdGFsIFNhbGVzXSksIFNhbGVzW1JlZ2lvbl0gPSAiTm9ydGggQW1lcmljYSIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Filtered Sales = CALCULATE(SUM(Sales[Total Sales]), Sales[Region] = &quot;North America&quot;)</pre></div><div class='content'></div><h2>FILTER</h2>
<div class='content'><p><code>FILTER</code> returns a table that represents a subset of another table.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SGlnaCBTYWxlcyA9IEZJTFRFUihTYWxlcywgU2FsZXNbVG90YWwgU2FsZXNdID4gMTAwMCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>High Sales = FILTER(Sales, Sales[Total Sales] &gt; 1000)</pre></div><div class='content'></div><h2>ALL</h2>
<div class='content'><p><code>ALL</code> removes all filters from the specified columns or tables.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QWxsIFNhbGVzID0gQ0FMQ1VMQVRFKFNVTShTYWxlc1tUb3RhbCBTYWxlc10pLCBBTEwoU2FsZXMpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>All Sales = CALCULATE(SUM(Sales[Total Sales]), ALL(Sales))</pre></div><div class='content'></div><h2>ALLEXCEPT</h2>
<div class='content'><p><code>ALLEXCEPT</code> removes all filters from the specified table except for the specified columns.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QWxsIFNhbGVzIEV4Y2VwdCBSZWdpb24gPSBDQUxDVUxBVEUoU1VNKFNhbGVzW1RvdGFsIFNhbGVzXSksIEFMTEVYQ0VQVChTYWxlcywgU2FsZXNbUmVnaW9uXSkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>All Sales Except Region = CALCULATE(SUM(Sales[Total Sales]), ALLEXCEPT(Sales, Sales[Region]))</pre></div><div class='content'></div><h1>Statistical Functions</h1>
<div class='content'></div><h2>MEDIANX</h2>
<div class='content'><p><code>MEDIANX</code> returns the median value of an expression evaluated over a table.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("TWVkaWFuIFNhbGVzID0gTUVESUFOWChTYWxlcywgU2FsZXNbVG90YWwgU2FsZXNdKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Median Sales = MEDIANX(Sales, Sales[Total Sales])</pre></div><div class='content'></div><h2>PERCENTILEX.INC</h2>
<div class='content'><p><code>PERCENTILEX.INC</code> returns the k-th percentile of values in a range, where k is in the range 0..1, inclusive.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("OTB0aCBQZXJjZW50aWxlIFNhbGVzID0gUEVSQ0VOVElMRVguSU5DKFNhbGVzLCBTYWxlc1tUb3RhbCBTYWxlc10sIDAuOSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>90th Percentile Sales = PERCENTILEX.INC(Sales, Sales[Total Sales], 0.9)</pre></div><div class='content'></div><h2>PERCENTILEX.EXC</h2>
<div class='content'><p><code>PERCENTILEX.EXC</code> returns the k-th percentile of values in a range, where k is in the range 0..1, exclusive.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("OTB0aCBQZXJjZW50aWxlIFNhbGVzID0gUEVSQ0VOVElMRVguRVhDKFNhbGVzLCBTYWxlc1tUb3RhbCBTYWxlc10sIDAuOSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>90th Percentile Sales = PERCENTILEX.EXC(Sales, Sales[Total Sales], 0.9)</pre></div><div class='content'></div><h1>Iterative Functions</h1>
<div class='content'></div><h2>GENERATE</h2>
<div class='content'><p><code>GENERATE</code> returns a table with all possible combinations of rows from two tables.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q29tYmluYXRpb25zID0gR0VORVJBVEUoVGFibGUxLCBUYWJsZTIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Combinations = GENERATE(Table1, Table2)</pre></div><div class='content'></div><h2>GENERATEALL</h2>
<div class='content'><p><code>GENERATEALL</code> returns a table with all possible combinations of rows from two tables, including rows with no match.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QWxsIENvbWJpbmF0aW9ucyA9IEdFTkVSQVRFQUxMKFRhYmxlMSwgVGFibGUyKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>All Combinations = GENERATEALL(Table1, Table2)</pre></div><div class='content'></div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Calculate Year-over-Year Growth</h2>
<div class='content'><p>Calculate the year-over-year growth in sales.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("WW9ZIEdyb3d0aCA9IApWQVIgU2FsZXNMYXN0WWVhciA9IENBTENVTEFURShTVU0oU2FsZXNbVG90YWwgU2FsZXNdKSwgU0FNRVBFUklPRExBU1RZRUFSKENhbGVuZGFyW0RhdGVdKSkKUkVUVVJOCkRJVklERShTVU0oU2FsZXNbVG90YWwgU2FsZXNdKSAtIFNhbGVzTGFzdFllYXIsIFNhbGVzTGFzdFllYXIp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>YoY Growth = 
VAR SalesLastYear = CALCULATE(SUM(Sales[Total Sales]), SAMEPERIODLASTYEAR(Calendar[Date]))
RETURN
DIVIDE(SUM(Sales[Total Sales]) - SalesLastYear, SalesLastYear)</pre></div><div class='content'></div><h2>Exercise 2: Calculate the 75th Percentile of Sales</h2>
<div class='content'><p>Calculate the 75th percentile of total sales.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("NzV0aCBQZXJjZW50aWxlIFNhbGVzID0gUEVSQ0VOVElMRVguSU5DKFNhbGVzLCBTYWxlc1tUb3RhbCBTYWxlc10sIDAuNzUp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>75th Percentile Sales = PERCENTILEX.INC(Sales, Sales[Total Sales], 0.75)</pre></div><div class='content'></div><h2>Exercise 3: Filter Sales Greater Than a Specific Value</h2>
<div class='content'><p>Create a measure that filters sales greater than $500.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SGlnaCBTYWxlcyA9IENBTENVTEFURShTVU0oU2FsZXNbVG90YWwgU2FsZXNdKSwgU2FsZXNbVG90YWwgU2FsZXNdID4gNTAwKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>High Sales = CALCULATE(SUM(Sales[Total Sales]), Sales[Total Sales] &gt; 500)</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Misunderstanding Context:</strong> Ensure you understand the difference between row context and filter context. Misapplying these can lead to incorrect calculations.</li>
<li><strong>Overusing CALCULATE:</strong> While <code>CALCULATE</code> is powerful, overusing it can make your DAX code harder to read and maintain.</li>
<li><strong>Ignoring Performance:</strong> Advanced DAX functions can be resource-intensive. Always test the performance of your DAX queries, especially on large datasets.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we explored advanced DAX functions that enable you to perform complex data analysis in Power BI. Understanding and mastering these functions will allow you to create more sophisticated and insightful reports. In the next module, we will focus on designing effective reports and creating interactive dashboards to present your data compellingly.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-03-time-intelligence-functions' title="Time Intelligence Functions">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-designing-effective-reports' title="Designing Effective Reports">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
