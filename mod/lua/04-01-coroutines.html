<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Coroutines</title>

    <link rel="alternate" href="https://campusempresa.com/mod/lua/04-01-coroutines" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/lua/04-01-coroutines" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/lua/04-01-coroutines" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/lua/04-01-coroutines" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/lua/04-01-coroutines" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>All the knowledge within your reach</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					 				<a href="/"><i class="bi bi-house-fill"></i> HOME</a>
											</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-05-file-io' title="File I/O">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Coroutines</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-02-oop-lua' title="Object-Oriented Programming in Lua">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Coroutines are a powerful feature in Lua that allows you to manage multiple tasks simultaneously without the complexity of traditional multithreading. They enable cooperative multitasking, where the control is explicitly passed between different routines. This makes coroutines particularly useful for tasks like game development, where you need to manage multiple entities or processes concurrently.</p>
</div><h1>Key Concepts</h1>
<div class='content'></div><h2><ol>
<li>What is a Coroutine?</li>
</ol></h2>
<div class='content'><ul>
<li><strong>Coroutine</strong>: A coroutine is a function that can pause its execution (yield) and resume from the point it left off.</li>
<li><strong>Cooperative Multitasking</strong>: Unlike preemptive multitasking, where the system decides when to switch tasks, cooperative multitasking requires the tasks to yield control explicitly.</li>
</ul>
</div><h2><ol start="2">
<li>Creating a Coroutine</li>
</ol></h2>
<div class='content'><ul>
<li><strong><code>coroutine.create</code></strong>: This function creates a new coroutine.</li>
<li><strong><code>coroutine.resume</code></strong>: This function resumes a coroutine.</li>
<li><strong><code>coroutine.yield</code></strong>: This function pauses the coroutine, allowing it to be resumed later.</li>
</ul>
</div><h2><ol start="3">
<li>Coroutine States</li>
</ol></h2>
<div class='content'><ul>
<li><strong>Suspended</strong>: The coroutine is created but not yet running.</li>
<li><strong>Running</strong>: The coroutine is currently executing.</li>
<li><strong>Normal</strong>: The coroutine is active but not running (e.g., it has yielded).</li>
<li><strong>Dead</strong>: The coroutine has finished its execution.</li>
</ul>
</div><h1>Practical Examples</h1>
<div class='content'></div><h2>Example 1: Basic Coroutine</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRGVmaW5lIGEgc2ltcGxlIGNvcm91dGluZSBmdW5jdGlvbgpmdW5jdGlvbiBteUNvcm91dGluZSgpCiAgICBwcmludCgiQ29yb3V0aW5lIHN0YXJ0ZWQiKQogICAgY29yb3V0aW5lLnlpZWxkKCkgIC0tIFBhdXNlIGV4ZWN1dGlvbgogICAgcHJpbnQoIkNvcm91dGluZSByZXN1bWVkIikKZW5kCgotLSBDcmVhdGUgYSBjb3JvdXRpbmUKY28gPSBjb3JvdXRpbmUuY3JlYXRlKG15Q29yb3V0aW5lKQoKLS0gUmVzdW1lIHRoZSBjb3JvdXRpbmUKY29yb3V0aW5lLnJlc3VtZShjbykgIC0tIE91dHB1dDogQ29yb3V0aW5lIHN0YXJ0ZWQKCi0tIFJlc3VtZSB0aGUgY29yb3V0aW5lIGFnYWluCmNvcm91dGluZS5yZXN1bWUoY28pICAtLSBPdXRwdXQ6IENvcm91dGluZSByZXN1bWVk"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Define a simple coroutine function
function myCoroutine()
    print(&quot;Coroutine started&quot;)
    coroutine.yield()  -- Pause execution
    print(&quot;Coroutine resumed&quot;)
end

-- Create a coroutine
co = coroutine.create(myCoroutine)

-- Resume the coroutine
coroutine.resume(co)  -- Output: Coroutine started

-- Resume the coroutine again
coroutine.resume(co)  -- Output: Coroutine resumed</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ol>
<li><code>myCoroutine</code> is defined with a <code>coroutine.yield</code> to pause its execution.</li>
<li><code>coroutine.create(myCoroutine)</code> creates a coroutine.</li>
<li><code>coroutine.resume(co)</code> starts the coroutine, printing &quot;Coroutine started&quot; and then pauses.</li>
<li><code>coroutine.resume(co)</code> resumes the coroutine, printing &quot;Coroutine resumed&quot;.</li>
</ol>
</div><h2>Example 2: Coroutine with Parameters</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gbXlDb3JvdXRpbmUoYSwgYikKICAgIHByaW50KCJDb3JvdXRpbmUgc3RhcnRlZCB3aXRoIHZhbHVlczoiLCBhLCBiKQogICAgbG9jYWwgc3VtID0gYSArIGIKICAgIGNvcm91dGluZS55aWVsZChzdW0pICAtLSBQYXVzZSBhbmQgcmV0dXJuIHRoZSBzdW0KICAgIHByaW50KCJDb3JvdXRpbmUgcmVzdW1lZCB3aXRoIHN1bToiLCBzdW0pCmVuZAoKY28gPSBjb3JvdXRpbmUuY3JlYXRlKG15Q29yb3V0aW5lKQoKLS0gUmVzdW1lIHRoZSBjb3JvdXRpbmUgd2l0aCBwYXJhbWV0ZXJzCnN0YXR1cywgcmVzdWx0ID0gY29yb3V0aW5lLnJlc3VtZShjbywgNSwgNykgIC0tIE91dHB1dDogQ29yb3V0aW5lIHN0YXJ0ZWQgd2l0aCB2YWx1ZXM6IDUgNwpwcmludCgiU3VtOiIsIHJlc3VsdCkgIC0tIE91dHB1dDogU3VtOiAxMgoKLS0gUmVzdW1lIHRoZSBjb3JvdXRpbmUgYWdhaW4KY29yb3V0aW5lLnJlc3VtZShjbykgIC0tIE91dHB1dDogQ29yb3V0aW5lIHJlc3VtZWQgd2l0aCBzdW06IDEy"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function myCoroutine(a, b)
    print(&quot;Coroutine started with values:&quot;, a, b)
    local sum = a + b
    coroutine.yield(sum)  -- Pause and return the sum
    print(&quot;Coroutine resumed with sum:&quot;, sum)
end

co = coroutine.create(myCoroutine)

-- Resume the coroutine with parameters
status, result = coroutine.resume(co, 5, 7)  -- Output: Coroutine started with values: 5 7
print(&quot;Sum:&quot;, result)  -- Output: Sum: 12

-- Resume the coroutine again
coroutine.resume(co)  -- Output: Coroutine resumed with sum: 12</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ol>
<li><code>myCoroutine</code> takes two parameters, calculates their sum, and yields it.</li>
<li><code>coroutine.resume(co, 5, 7)</code> starts the coroutine with parameters 5 and 7, yielding the sum 12.</li>
<li>The sum is printed, and the coroutine is resumed to complete its execution.</li>
</ol>
</div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Simple Coroutine</h2>
<div class='content'><p><strong>Task</strong>: Create a coroutine that prints numbers from 1 to 5, yielding after each number.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gcHJpbnROdW1iZXJzKCkKICAgIGZvciBpID0gMSwgNSBkbwogICAgICAgIHByaW50KGkpCiAgICAgICAgY29yb3V0aW5lLnlpZWxkKCkKICAgIGVuZAplbmQKCmNvID0gY29yb3V0aW5lLmNyZWF0ZShwcmludE51bWJlcnMpCgotLSBSZXN1bWUgdGhlIGNvcm91dGluZSBtdWx0aXBsZSB0aW1lcwpmb3IgaSA9IDEsIDUgZG8KICAgIGNvcm91dGluZS5yZXN1bWUoY28pCmVuZA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function printNumbers()
    for i = 1, 5 do
        print(i)
        coroutine.yield()
    end
end

co = coroutine.create(printNumbers)

-- Resume the coroutine multiple times
for i = 1, 5 do
    coroutine.resume(co)
end</pre></div><div class='content'><p><strong>Solution</strong>:</p>
<ol>
<li>Define <code>printNumbers</code> to print numbers from 1 to 5, yielding after each print.</li>
<li>Create and resume the coroutine in a loop to print all numbers.</li>
</ol>
</div><h2>Exercise 2: Coroutine with State</h2>
<div class='content'><p><strong>Task</strong>: Create a coroutine that maintains a state and increments a counter each time it is resumed.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gY291bnRlcigpCiAgICBsb2NhbCBjb3VudCA9IDAKICAgIHdoaWxlIHRydWUgZG8KICAgICAgICBjb3VudCA9IGNvdW50ICsgMQogICAgICAgIGNvcm91dGluZS55aWVsZChjb3VudCkKICAgIGVuZAplbmQKCmNvID0gY29yb3V0aW5lLmNyZWF0ZShjb3VudGVyKQoKLS0gUmVzdW1lIHRoZSBjb3JvdXRpbmUgbXVsdGlwbGUgdGltZXMgYW5kIHByaW50IHRoZSBjb3VudGVyCmZvciBpID0gMSwgNSBkbwogICAgbG9jYWwgc3RhdHVzLCBjb3VudCA9IGNvcm91dGluZS5yZXN1bWUoY28pCiAgICBwcmludCgiQ291bnRlcjoiLCBjb3VudCkKZW5k"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function counter()
    local count = 0
    while true do
        count = count + 1
        coroutine.yield(count)
    end
end

co = coroutine.create(counter)

-- Resume the coroutine multiple times and print the counter
for i = 1, 5 do
    local status, count = coroutine.resume(co)
    print(&quot;Counter:&quot;, count)
end</pre></div><div class='content'><p><strong>Solution</strong>:</p>
<ol>
<li>Define <code>counter</code> to maintain and increment a counter, yielding the current count.</li>
<li>Create and resume the coroutine in a loop, printing the counter each time.</li>
</ol>
</div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Forgetting to Yield</strong>: Ensure that your coroutine yields at appropriate points to allow other tasks to run.</li>
<li><strong>Handling Coroutine States</strong>: Always check the state of a coroutine before resuming it to avoid errors.</li>
<li><strong>Passing Parameters</strong>: Remember that <code>coroutine.resume</code> can pass parameters to the coroutine function.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Coroutines in Lua provide a powerful way to manage multiple tasks concurrently with minimal complexity. By understanding how to create, resume, and yield coroutines, you can effectively implement cooperative multitasking in your Lua programs. Practice with the provided examples and exercises to solidify your understanding and prepare for more advanced applications.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-05-file-io' title="File I/O">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-02-oop-lua' title="Object-Oriented Programming in Lua">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			









		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
