<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monitoring and Maintenance</title>

    <link rel="alternate" href="https://campusempresa.com/mod/elasticsearch/05-03-monitoring-maintenance" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/elasticsearch/05-03-monitoring-maintenance" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/elasticsearch/05-03-monitoring-maintenance" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=2" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/elasticsearch/05-03-monitoring-maintenance" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/elasticsearch/05-03-monitoring-maintenance" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Programming Languages</a>
				 					<a href="/categ/frameworks">Frameworks and Libraries</a>
				 					<a href="/categ/tech-tools">Technical Tools</a>
				 					<a href="/categ/foundations">Theoretical Foundations</a>
				 					<a href="/categ/soft-skills">Social Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-02-scaling-elasticsearch' title="Scaling Elasticsearch">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Monitoring and Maintenance</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-04-backup-restore' title="Backup and Restore">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Monitoring and maintaining an Elasticsearch cluster is crucial to ensure its health, performance, and reliability. This section will cover the essential tools and techniques for monitoring Elasticsearch, identifying potential issues, and performing regular maintenance tasks.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li><strong>Cluster Health</strong>: Understanding the overall status of the cluster, including node availability and shard allocation.</li>
<li><strong>Node Statistics</strong>: Monitoring individual node performance metrics such as CPU, memory, and disk usage.</li>
<li><strong>Index Statistics</strong>: Keeping track of index-level metrics like document count, index size, and indexing/search performance.</li>
<li><strong>Log Analysis</strong>: Analyzing Elasticsearch logs to identify errors, warnings, and other significant events.</li>
<li><strong>Alerting</strong>: Setting up alerts to notify administrators of potential issues before they become critical.</li>
</ol>
</div><h1><p>Tools for Monitoring</p>
</h1>
<div class='content'></div><h2><ol>
<li>Elasticsearch APIs</li>
</ol>
</h2>
<div class='content'><p>Elasticsearch provides several built-in APIs to monitor the cluster:</p>
<ul>
<li>
<p><strong>Cluster Health API</strong>: Provides information about the health of the cluster.</p>
<pre><code class="language-json">GET /_cluster/health
</code></pre>
</li>
<li>
<p><strong>Nodes Stats API</strong>: Returns statistics about nodes in the cluster.</p>
<pre><code class="language-json">GET /_nodes/stats
</code></pre>
</li>
<li>
<p><strong>Indices Stats API</strong>: Provides statistics about indices.</p>
<pre><code class="language-json">GET /_stats
</code></pre>
</li>
</ul>
</div><h2><ol start="2">
<li>Kibana</li>
</ol>
</h2>
<div class='content'><p>Kibana is a powerful visualization tool that integrates seamlessly with Elasticsearch. It provides dashboards and visualizations for monitoring cluster health, node performance, and index statistics.</p>
</div><h2><ol start="3">
<li>Elastic Stack (ELK Stack)</li>
</ol>
</h2>
<div class='content'><p>The ELK Stack (Elasticsearch, Logstash, Kibana) can be used to collect, analyze, and visualize logs and metrics from Elasticsearch and other sources.</p>
</div><h2><ol start="4">
<li>External Monitoring Tools</li>
</ol>
</h2>
<div class='content'><p>Several third-party tools can be used to monitor Elasticsearch, such as:</p>
<ul>
<li><strong>Prometheus</strong>: For collecting and querying metrics.</li>
<li><strong>Grafana</strong>: For creating dashboards and visualizations.</li>
<li><strong>Datadog</strong>: For comprehensive monitoring and alerting.</li>
</ul>
</div><h1><p>Practical Examples</p>
</h1>
<div class='content'></div><h2><p>Example 1: Checking Cluster Health</p>
</h2>
<div class='content'><p>Use the Cluster Health API to check the health of your cluster:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R0VUIC9fY2x1c3Rlci9oZWFsdGg="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>GET /_cluster/health</pre></div><div class='content'><p><strong>Response:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJjbHVzdGVyX25hbWUiOiAiZWxhc3RpY3NlYXJjaCIsCiAgInN0YXR1cyI6ICJncmVlbiIsCiAgInRpbWVkX291dCI6IGZhbHNlLAogICJudW1iZXJfb2Zfbm9kZXMiOiAzLAogICJudW1iZXJfb2ZfZGF0YV9ub2RlcyI6IDMsCiAgImFjdGl2ZV9wcmltYXJ5X3NoYXJkcyI6IDEwLAogICJhY3RpdmVfc2hhcmRzIjogMjAsCiAgInJlbG9jYXRpbmdfc2hhcmRzIjogMCwKICAiaW5pdGlhbGl6aW5nX3NoYXJkcyI6IDAsCiAgInVuYXNzaWduZWRfc2hhcmRzIjogMCwKICAiZGVsYXllZF91bmFzc2lnbmVkX3NoYXJkcyI6IDAsCiAgIm51bWJlcl9vZl9wZW5kaW5nX3Rhc2tzIjogMCwKICAibnVtYmVyX29mX2luX2ZsaWdodF9mZXRjaCI6IDAsCiAgInRhc2tfbWF4X3dhaXRpbmdfaW5fcXVldWVfbWlsbGlzIjogMCwKICAiYWN0aXZlX3NoYXJkc19wZXJjZW50X2FzX251bWJlciI6IDEwMC4wCn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;cluster_name&quot;: &quot;elasticsearch&quot;,
  &quot;status&quot;: &quot;green&quot;,
  &quot;timed_out&quot;: false,
  &quot;number_of_nodes&quot;: 3,
  &quot;number_of_data_nodes&quot;: 3,
  &quot;active_primary_shards&quot;: 10,
  &quot;active_shards&quot;: 20,
  &quot;relocating_shards&quot;: 0,
  &quot;initializing_shards&quot;: 0,
  &quot;unassigned_shards&quot;: 0,
  &quot;delayed_unassigned_shards&quot;: 0,
  &quot;number_of_pending_tasks&quot;: 0,
  &quot;number_of_in_flight_fetch&quot;: 0,
  &quot;task_max_waiting_in_queue_millis&quot;: 0,
  &quot;active_shards_percent_as_number&quot;: 100.0
}</pre></div><div class='content'></div><h2><p>Example 2: Monitoring Node Statistics</p>
</h2>
<div class='content'><p>Use the Nodes Stats API to get detailed statistics about each node:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R0VUIC9fbm9kZXMvc3RhdHM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>GET /_nodes/stats</pre></div><div class='content'><p><strong>Response:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJjbHVzdGVyX25hbWUiOiAiZWxhc3RpY3NlYXJjaCIsCiAgIm5vZGVzIjogewogICAgIm5vZGVfaWQiOiB7CiAgICAgICJuYW1lIjogIm5vZGVfbmFtZSIsCiAgICAgICJ0cmFuc3BvcnRfYWRkcmVzcyI6ICIxMjcuMC4wLjE6OTMwMCIsCiAgICAgICJob3N0IjogIjEyNy4wLjAuMSIsCiAgICAgICJpcCI6ICIxMjcuMC4wLjEiLAogICAgICAicm9sZXMiOiBbIm1hc3RlciIsICJkYXRhIl0sCiAgICAgICJvcyI6IHsKICAgICAgICAiY3B1IjogewogICAgICAgICAgInBlcmNlbnQiOiAxMAogICAgICAgIH0sCiAgICAgICAgIm1lbSI6IHsKICAgICAgICAgICJ0b3RhbF9pbl9ieXRlcyI6IDE2Nzc3MjE2MDAwLAogICAgICAgICAgImZyZWVfaW5fYnl0ZXMiOiAxMDQ4NTc2MDAwLAogICAgICAgICAgInVzZWRfaW5fYnl0ZXMiOiAxNTcyODY0MDAwMCwKICAgICAgICAgICJmcmVlX3BlcmNlbnQiOiA2LAogICAgICAgICAgInVzZWRfcGVyY2VudCI6IDk0CiAgICAgICAgfQogICAgICB9LAogICAgICAicHJvY2VzcyI6IHsKICAgICAgICAiY3B1IjogewogICAgICAgICAgInBlcmNlbnQiOiA1CiAgICAgICAgfSwKICAgICAgICAib3Blbl9maWxlX2Rlc2NyaXB0b3JzIjogMjAwCiAgICAgIH0KICAgIH0KICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;cluster_name&quot;: &quot;elasticsearch&quot;,
  &quot;nodes&quot;: {
    &quot;node_id&quot;: {
      &quot;name&quot;: &quot;node_name&quot;,
      &quot;transport_address&quot;: &quot;127.0.0.1:9300&quot;,
      &quot;host&quot;: &quot;127.0.0.1&quot;,
      &quot;ip&quot;: &quot;127.0.0.1&quot;,
      &quot;roles&quot;: [&quot;master&quot;, &quot;data&quot;],
      &quot;os&quot;: {
        &quot;cpu&quot;: {
          &quot;percent&quot;: 10
        },
        &quot;mem&quot;: {
          &quot;total_in_bytes&quot;: 16777216000,
          &quot;free_in_bytes&quot;: 1048576000,
          &quot;used_in_bytes&quot;: 15728640000,
          &quot;free_percent&quot;: 6,
          &quot;used_percent&quot;: 94
        }
      },
      &quot;process&quot;: {
        &quot;cpu&quot;: {
          &quot;percent&quot;: 5
        },
        &quot;open_file_descriptors&quot;: 200
      }
    }
  }
}</pre></div><div class='content'></div><h1><p>Maintenance Tasks</p>
</h1>
<div class='content'></div><h2><ol>
<li>Regular Backups</li>
</ol>
</h2>
<div class='content'><p>Regularly back up your Elasticsearch indices to prevent data loss. Use the Snapshot and Restore API to create snapshots of your indices.</p>
<p><strong>Creating a Snapshot:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UFVUIC9fc25hcHNob3QvbXlfYmFja3VwL3NuYXBzaG90XzEKewogICJpbmRpY2VzIjogImluZGV4XzEsaW5kZXhfMiIsCiAgImlnbm9yZV91bmF2YWlsYWJsZSI6IHRydWUsCiAgImluY2x1ZGVfZ2xvYmFsX3N0YXRlIjogZmFsc2UKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PUT /_snapshot/my_backup/snapshot_1
{
  &quot;indices&quot;: &quot;index_1,index_2&quot;,
  &quot;ignore_unavailable&quot;: true,
  &quot;include_global_state&quot;: false
}</pre></div><div class='content'></div><h2><ol start="2">
<li>Index Management</li>
</ol>
</h2>
<div class='content'><p>Regularly monitor and manage your indices to ensure optimal performance. This includes:</p>
<ul>
<li><strong>Deleting old indices</strong>: Remove indices that are no longer needed.</li>
<li><strong>Force merging</strong>: Optimize indices by reducing the number of segments.
<pre><code class="language-json">POST /index_name/_forcemerge?max_num_segments=1
</code></pre>
</li>
</ul>
</div><h2><ol start="3">
<li>Log Analysis</li>
</ol>
</h2>
<div class='content'><p>Regularly analyze Elasticsearch logs to identify and resolve issues. Set up log rotation to manage log file sizes.</p>
</div><h2><ol start="4">
<li>Upgrading Elasticsearch</li>
</ol>
</h2>
<div class='content'><p>Keep your Elasticsearch cluster up to date with the latest version to benefit from new features, performance improvements, and security patches.</p>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Monitor Cluster Health and Node Statistics</p>
</h2>
<div class='content'><ol>
<li>Use the Cluster Health API to check the health of your cluster.</li>
<li>Use the Nodes Stats API to get detailed statistics about each node.</li>
<li>Create a snapshot of an index using the Snapshot and Restore API.</li>
</ol>
<p><strong>Solution:</strong></p>
<ol>
<li>
<p>Check Cluster Health:</p>
<pre><code class="language-json">GET /_cluster/health
</code></pre>
</li>
<li>
<p>Get Node Statistics:</p>
<pre><code class="language-json">GET /_nodes/stats
</code></pre>
</li>
<li>
<p>Create a Snapshot:</p>
<pre><code class="language-json">PUT /_snapshot/my_backup/snapshot_1
{
  &quot;indices&quot;: &quot;index_1,index_2&quot;,
  &quot;ignore_unavailable&quot;: true,
  &quot;include_global_state&quot;: false
}
</code></pre>
</li>
</ol>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Ignoring Cluster Health</strong>: Regularly check the cluster health to identify and resolve issues early.</li>
<li><strong>Overlooking Node Performance</strong>: Monitor node performance metrics to prevent resource exhaustion.</li>
<li><strong>Neglecting Log Analysis</strong>: Regularly analyze logs to identify and resolve issues.</li>
<li><strong>Skipping Backups</strong>: Regularly back up your indices to prevent data loss.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Monitoring and maintaining an Elasticsearch cluster is essential for ensuring its health, performance, and reliability. By using the built-in APIs, Kibana, and other monitoring tools, you can keep track of cluster health, node performance, and index statistics. Regular maintenance tasks such as backups, index management, and log analysis will help you prevent issues and ensure the smooth operation of your Elasticsearch cluster.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-02-scaling-elasticsearch' title="Scaling Elasticsearch">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-04-backup-restore' title="Backup and Restore">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
