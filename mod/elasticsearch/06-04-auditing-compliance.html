<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Auditing and Compliance</title>

    <link rel="alternate" href="https://campusempresa.com/mod/elasticsearch/06-04-auditing-compliance" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/elasticsearch/06-04-auditing-compliance" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/elasticsearch/06-04-auditing-compliance" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>var DEVELOP = window.location.href.indexOf("localhost")!=-1 && true;</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/elasticsearch/06-04-auditing-compliance" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/elasticsearch/06-04-auditing-compliance" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>
		<!-- <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

			</div>
		</div>
	</div>
</div>
 -->
 
<div class="top-bar container-fluid">
	<div class="container-xxl">
		<nav class="navbar navbar-expand-md p-0">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<div class="navbar-nav me-auto">
							<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

					</div>
				</div>			
							</div>
		</nav>
	</div>
</div>				<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-03-role-based-access-control' title="Role-Based Access Control">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<h2 style="text-decoration:underline">Auditing and Compliance</h2>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-01-elasticsearch-logstash' title="Elasticsearch with Logstash">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to implement auditing and compliance in Elasticsearch. Auditing is crucial for tracking access and changes to your data, ensuring that your Elasticsearch cluster meets regulatory requirements and security policies.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Auditing</strong>: The process of recording and monitoring access and changes to data.</li>
<li><strong>Compliance</strong>: Adhering to laws, regulations, and policies that govern data usage and security.</li>
<li><strong>Audit Logs</strong>: Logs that capture detailed information about user actions and system events.</li>
</ol>
</div><h1>Why Auditing and Compliance Matter</h1>
<div class='content'><ul>
<li><strong>Security</strong>: Helps detect unauthorized access and potential security breaches.</li>
<li><strong>Regulatory Requirements</strong>: Ensures adherence to laws such as GDPR, HIPAA, and others.</li>
<li><strong>Accountability</strong>: Provides a trail of actions for accountability and forensic analysis.</li>
</ul>
</div><h1>Enabling Auditing in Elasticsearch</h1>
<div class='content'><p>Elasticsearch provides built-in auditing capabilities that can be configured to log various events. Here’s how to enable and configure auditing:</p>
</div><h2>Step-by-Step Guide</h2>
<div class='content'><ol>
<li>
<p><strong>Enable Auditing</strong>:</p>
<ul>
<li>Edit the <code>elasticsearch.yml</code> configuration file to enable auditing.</li>
<li>Add the following lines to the configuration file:</li>
</ul>
<pre><code class="language-yaml">xpack.security.audit.enabled: true
</code></pre>
</li>
<li>
<p><strong>Configure Audit Outputs</strong>:</p>
<ul>
<li>You can configure where the audit logs are stored. By default, they are stored in the Elasticsearch logs directory.</li>
<li>To specify a different location, add:</li>
</ul>
<pre><code class="language-yaml">xpack.security.audit.outputs: [ index, logfile ]
xpack.security.audit.logfile.events.include: [ &quot;access_granted&quot;, &quot;access_denied&quot; ]
xpack.security.audit.index.events.include: [ &quot;access_granted&quot;, &quot;access_denied&quot; ]
</code></pre>
</li>
<li>
<p><strong>Filter Audit Events</strong>:</p>
<ul>
<li>You can filter which events to log by specifying include and exclude filters.</li>
<li>Example configuration:</li>
</ul>
<pre><code class="language-yaml">xpack.security.audit.logfile.events.exclude: [ &quot;anonymous_access_denied&quot; ]
</code></pre>
</li>
<li>
<p><strong>Restart Elasticsearch</strong>:</p>
<ul>
<li>After making these changes, restart your Elasticsearch nodes to apply the new settings.</li>
</ul>
<pre><code class="language-bash">sudo systemctl restart elasticsearch
</code></pre>
</li>
</ol>
</div><h2>Example Configuration</h2>
<div class='content'><p>Here’s a complete example of an <code>elasticsearch.yml</code> configuration with auditing enabled:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("eHBhY2suc2VjdXJpdHkuYXVkaXQuZW5hYmxlZDogdHJ1ZQp4cGFjay5zZWN1cml0eS5hdWRpdC5vdXRwdXRzOiBbIGluZGV4LCBsb2dmaWxlIF0KeHBhY2suc2VjdXJpdHkuYXVkaXQubG9nZmlsZS5ldmVudHMuaW5jbHVkZTogWyAiYWNjZXNzX2dyYW50ZWQiLCAiYWNjZXNzX2RlbmllZCIsICJhdXRoZW50aWNhdGlvbl9mYWlsZWQiIF0KeHBhY2suc2VjdXJpdHkuYXVkaXQuaW5kZXguZXZlbnRzLmluY2x1ZGU6IFsgImFjY2Vzc19ncmFudGVkIiwgImFjY2Vzc19kZW5pZWQiLCAiYXV0aGVudGljYXRpb25fZmFpbGVkIiBdCnhwYWNrLnNlY3VyaXR5LmF1ZGl0LmxvZ2ZpbGUuZXZlbnRzLmV4Y2x1ZGU6IFsgImFub255bW91c19hY2Nlc3NfZGVuaWVkIiBd"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>xpack.security.audit.enabled: true
xpack.security.audit.outputs: [ index, logfile ]
xpack.security.audit.logfile.events.include: [ &quot;access_granted&quot;, &quot;access_denied&quot;, &quot;authentication_failed&quot; ]
xpack.security.audit.index.events.include: [ &quot;access_granted&quot;, &quot;access_denied&quot;, &quot;authentication_failed&quot; ]
xpack.security.audit.logfile.events.exclude: [ &quot;anonymous_access_denied&quot; ]</pre></div><div class='content'></div><h1>Viewing Audit Logs</h1>
<div class='content'><p>Audit logs can be viewed in two primary ways:</p>
<ol>
<li>
<p><strong>Log Files</strong>:</p>
<ul>
<li>By default, audit logs are written to the <code>logs</code> directory of your Elasticsearch installation.</li>
<li>Example log entry:</li>
</ul>
<pre><code>[2023-10-01T12:34:56,789][INFO ][o.e.x.s.a.l.LoggingAuditTrail] [node-1] [access_granted] origin_type=[rest], origin_address=[127.0.0.1], principal=[admin], action=[indices:data/read/search], indices=[my_index]
</code></pre>
</li>
<li>
<p><strong>Elasticsearch Index</strong>:</p>
<ul>
<li>If configured, audit events can be indexed into a dedicated Elasticsearch index.</li>
<li>You can search and analyze these logs using Kibana or Elasticsearch queries.</li>
</ul>
<pre><code class="language-json">GET /_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;event_type&quot;: &quot;access_granted&quot;
    }
  }
}
</code></pre>
</li>
</ol>
</div><h1>Compliance Considerations</h1>
<div class='content'><p>When implementing auditing and compliance, consider the following:</p>
<ul>
<li><strong>Data Retention</strong>: Define how long audit logs should be retained based on regulatory requirements.</li>
<li><strong>Access Control</strong>: Ensure that only authorized personnel have access to audit logs.</li>
<li><strong>Regular Reviews</strong>: Periodically review audit logs to detect and respond to suspicious activities.</li>
</ul>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Enable and Configure Auditing</h2>
<div class='content'><ol>
<li><strong>Objective</strong>: Enable auditing in your Elasticsearch cluster and configure it to log access granted and access denied events.</li>
<li><strong>Steps</strong>:
<ul>
<li>Edit the <code>elasticsearch.yml</code> file to enable auditing.</li>
<li>Configure the audit outputs to log to both index and logfile.</li>
<li>Include events for access granted and access denied.</li>
<li>Restart Elasticsearch to apply the changes.</li>
</ul>
</li>
<li><strong>Verification</strong>:
<ul>
<li>Perform some search operations and check the audit logs in the log files and the Elasticsearch index.</li>
</ul>
</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><ol>
<li>
<p><strong>Edit <code>elasticsearch.yml</code></strong>:</p>
<pre><code class="language-yaml">xpack.security.audit.enabled: true
xpack.security.audit.outputs: [ index, logfile ]
xpack.security.audit.logfile.events.include: [ &quot;access_granted&quot;, &quot;access_denied&quot; ]
xpack.security.audit.index.events.include: [ &quot;access_granted&quot;, &quot;access_denied&quot; ]
</code></pre>
</li>
<li>
<p><strong>Restart Elasticsearch</strong>:</p>
<pre><code class="language-bash">sudo systemctl restart elasticsearch
</code></pre>
</li>
<li>
<p><strong>Verify Logs</strong>:</p>
<ul>
<li>Check the log files in the <code>logs</code> directory.</li>
<li>Query the audit index in Elasticsearch:</li>
</ul>
<pre><code class="language-json">GET /_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;event_type&quot;: &quot;access_granted&quot;
    }
  }
}
</code></pre>
</li>
</ol>
</div><h1>Summary</h1>
<div class='content'><p>In this section, we covered the importance of auditing and compliance in Elasticsearch. We learned how to enable and configure auditing, view audit logs, and consider compliance requirements. By implementing these practices, you can ensure that your Elasticsearch cluster is secure, compliant, and accountable.</p>
<p>Next, we will explore how to integrate Elasticsearch with other tools in the ecosystem.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-03-role-based-access-control' title="Role-Based Access Control">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-01-elasticsearch-logstash' title="Elasticsearch with Logstash">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
	     crossorigin="anonymous"></script>
	<!-- enterprise_campus -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-0611338592562725"
	     data-ad-slot="6914733106"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
	     (adsbygoogle = window.adsbygoogle || []).push({});
	</script>
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>Elasticsearch Course</h1>
<h2>Module 1: Introduction to Elasticsearch</h2>
<ul>
<li><a href="01-01-what-is-elasticsearch">What is Elasticsearch?</a></li>
<li><a href="01-02-installing-elasticsearch">Installing Elasticsearch</a></li>
<li><a href="01-03-basic-concepts">Basic Concepts: Nodes, Clusters, and Indices</a></li>
<li><a href="01-04-elasticsearch-architecture">Elasticsearch Architecture</a></li>
</ul>
<h2>Module 2: Getting Started with Elasticsearch</h2>
<ul>
<li><a href="02-01-indexing-data">Indexing Data</a></li>
<li><a href="02-02-searching-data">Searching Data</a></li>
<li><a href="02-03-updating-deleting-data">Updating and Deleting Data</a></li>
<li><a href="02-04-elasticsearch-query-dsl">Elasticsearch Query DSL</a></li>
</ul>
<h2>Module 3: Advanced Search Techniques</h2>
<ul>
<li><a href="03-01-full-text-search">Full-Text Search</a></li>
<li><a href="03-02-filtering-sorting">Filtering and Sorting</a></li>
<li><a href="03-03-aggregations">Aggregations</a></li>
<li><a href="03-04-scripting">Scripting</a></li>
</ul>
<h2>Module 4: Data Modeling and Index Management</h2>
<ul>
<li><a href="04-01-mapping-analyzers">Mapping and Analyzers</a></li>
<li><a href="04-02-index-templates">Index Templates</a></li>
<li><a href="04-03-aliases-reindexing">Aliases and Reindexing</a></li>
<li><a href="04-04-index-lifecycle-management">Index Lifecycle Management</a></li>
</ul>
<h2>Module 5: Performance and Scaling</h2>
<ul>
<li><a href="05-01-optimizing-search-performance">Optimizing Search Performance</a></li>
<li><a href="05-02-scaling-elasticsearch">Scaling Elasticsearch</a></li>
<li><a href="05-03-monitoring-maintenance">Monitoring and Maintenance</a></li>
<li><a href="05-04-backup-restore">Backup and Restore</a></li>
</ul>
<h2>Module 6: Security and Access Control</h2>
<ul>
<li><a href="06-01-securing-elasticsearch">Securing Elasticsearch</a></li>
<li><a href="06-02-user-authentication-authorization">User Authentication and Authorization</a></li>
<li><a href="06-03-role-based-access-control">Role-Based Access Control</a></li>
<li><a href="06-04-auditing-compliance">Auditing and Compliance</a></li>
</ul>
<h2>Module 7: Integrations and Ecosystem</h2>
<ul>
<li><a href="07-01-elasticsearch-logstash">Elasticsearch with Logstash</a></li>
<li><a href="07-02-elasticsearch-kibana">Elasticsearch with Kibana</a></li>
<li><a href="07-03-elasticsearch-beats">Elasticsearch with Beats</a></li>
<li><a href="07-04-elasticsearch-other-tools">Elasticsearch with Other Tools</a></li>
</ul>
<h2>Module 8: Advanced Topics</h2>
<ul>
<li><a href="08-01-custom-plugins">Custom Plugins</a></li>
<li><a href="08-02-machine-learning-elasticsearch">Machine Learning in Elasticsearch</a></li>
<li><a href="08-03-graph-exploration">Graph Exploration</a></li>
<li><a href="08-04-geo-search">Geo-Search</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
</body>
</html>
