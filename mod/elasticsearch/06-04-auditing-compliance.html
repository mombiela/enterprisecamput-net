<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auditing and Compliance</title>

    <link rel="alternate" href="https://campusempresa.com/mod/elasticsearch/06-04-auditing-compliance" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/elasticsearch/06-04-auditing-compliance" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/elasticsearch/06-04-auditing-compliance" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/elasticsearch/06-04-auditing-compliance" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/elasticsearch/06-04-auditing-compliance" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='06-03-role-based-access-control' title="Role-Based Access Control">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Auditing and Compliance</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-01-elasticsearch-logstash' title="Elasticsearch with Logstash">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore how to implement auditing and compliance in Elasticsearch. Auditing is crucial for tracking access and changes to your data, ensuring that your Elasticsearch cluster meets regulatory requirements and security policies.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Auditing</strong>: The process of recording and monitoring access and changes to data.</li>
<li><strong>Compliance</strong>: Adhering to laws, regulations, and policies that govern data usage and security.</li>
<li><strong>Audit Logs</strong>: Logs that capture detailed information about user actions and system events.</li>
</ol>
</div><h1>Why Auditing and Compliance Matter</h1>
<div class='content'><ul>
<li><strong>Security</strong>: Helps detect unauthorized access and potential security breaches.</li>
<li><strong>Regulatory Requirements</strong>: Ensures adherence to laws such as GDPR, HIPAA, and others.</li>
<li><strong>Accountability</strong>: Provides a trail of actions for accountability and forensic analysis.</li>
</ul>
</div><h1>Enabling Auditing in Elasticsearch</h1>
<div class='content'><p>Elasticsearch provides built-in auditing capabilities that can be configured to log various events. Here’s how to enable and configure auditing:</p>
</div><h2>Step-by-Step Guide</h2>
<div class='content'><ol>
<li>
<p><strong>Enable Auditing</strong>:</p>
<ul>
<li>Edit the <code>elasticsearch.yml</code> configuration file to enable auditing.</li>
<li>Add the following lines to the configuration file:</li>
</ul>
<pre><code class="language-yaml">xpack.security.audit.enabled: true
</code></pre>
</li>
<li>
<p><strong>Configure Audit Outputs</strong>:</p>
<ul>
<li>You can configure where the audit logs are stored. By default, they are stored in the Elasticsearch logs directory.</li>
<li>To specify a different location, add:</li>
</ul>
<pre><code class="language-yaml">xpack.security.audit.outputs: [ index, logfile ]
xpack.security.audit.logfile.events.include: [ &quot;access_granted&quot;, &quot;access_denied&quot; ]
xpack.security.audit.index.events.include: [ &quot;access_granted&quot;, &quot;access_denied&quot; ]
</code></pre>
</li>
<li>
<p><strong>Filter Audit Events</strong>:</p>
<ul>
<li>You can filter which events to log by specifying include and exclude filters.</li>
<li>Example configuration:</li>
</ul>
<pre><code class="language-yaml">xpack.security.audit.logfile.events.exclude: [ &quot;anonymous_access_denied&quot; ]
</code></pre>
</li>
<li>
<p><strong>Restart Elasticsearch</strong>:</p>
<ul>
<li>After making these changes, restart your Elasticsearch nodes to apply the new settings.</li>
</ul>
<pre><code class="language-bash">sudo systemctl restart elasticsearch
</code></pre>
</li>
</ol>
</div><h2>Example Configuration</h2>
<div class='content'><p>Here’s a complete example of an <code>elasticsearch.yml</code> configuration with auditing enabled:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("eHBhY2suc2VjdXJpdHkuYXVkaXQuZW5hYmxlZDogdHJ1ZQp4cGFjay5zZWN1cml0eS5hdWRpdC5vdXRwdXRzOiBbIGluZGV4LCBsb2dmaWxlIF0KeHBhY2suc2VjdXJpdHkuYXVkaXQubG9nZmlsZS5ldmVudHMuaW5jbHVkZTogWyAiYWNjZXNzX2dyYW50ZWQiLCAiYWNjZXNzX2RlbmllZCIsICJhdXRoZW50aWNhdGlvbl9mYWlsZWQiIF0KeHBhY2suc2VjdXJpdHkuYXVkaXQuaW5kZXguZXZlbnRzLmluY2x1ZGU6IFsgImFjY2Vzc19ncmFudGVkIiwgImFjY2Vzc19kZW5pZWQiLCAiYXV0aGVudGljYXRpb25fZmFpbGVkIiBdCnhwYWNrLnNlY3VyaXR5LmF1ZGl0LmxvZ2ZpbGUuZXZlbnRzLmV4Y2x1ZGU6IFsgImFub255bW91c19hY2Nlc3NfZGVuaWVkIiBd"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>xpack.security.audit.enabled: true
xpack.security.audit.outputs: [ index, logfile ]
xpack.security.audit.logfile.events.include: [ &quot;access_granted&quot;, &quot;access_denied&quot;, &quot;authentication_failed&quot; ]
xpack.security.audit.index.events.include: [ &quot;access_granted&quot;, &quot;access_denied&quot;, &quot;authentication_failed&quot; ]
xpack.security.audit.logfile.events.exclude: [ &quot;anonymous_access_denied&quot; ]</pre></div><div class='content'></div><h1>Viewing Audit Logs</h1>
<div class='content'><p>Audit logs can be viewed in two primary ways:</p>
<ol>
<li>
<p><strong>Log Files</strong>:</p>
<ul>
<li>By default, audit logs are written to the <code>logs</code> directory of your Elasticsearch installation.</li>
<li>Example log entry:</li>
</ul>
<pre><code>[2023-10-01T12:34:56,789][INFO ][o.e.x.s.a.l.LoggingAuditTrail] [node-1] [access_granted] origin_type=[rest], origin_address=[127.0.0.1], principal=[admin], action=[indices:data/read/search], indices=[my_index]
</code></pre>
</li>
<li>
<p><strong>Elasticsearch Index</strong>:</p>
<ul>
<li>If configured, audit events can be indexed into a dedicated Elasticsearch index.</li>
<li>You can search and analyze these logs using Kibana or Elasticsearch queries.</li>
</ul>
<pre><code class="language-json">GET /_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;event_type&quot;: &quot;access_granted&quot;
    }
  }
}
</code></pre>
</li>
</ol>
</div><h1>Compliance Considerations</h1>
<div class='content'><p>When implementing auditing and compliance, consider the following:</p>
<ul>
<li><strong>Data Retention</strong>: Define how long audit logs should be retained based on regulatory requirements.</li>
<li><strong>Access Control</strong>: Ensure that only authorized personnel have access to audit logs.</li>
<li><strong>Regular Reviews</strong>: Periodically review audit logs to detect and respond to suspicious activities.</li>
</ul>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Enable and Configure Auditing</h2>
<div class='content'><ol>
<li><strong>Objective</strong>: Enable auditing in your Elasticsearch cluster and configure it to log access granted and access denied events.</li>
<li><strong>Steps</strong>:
<ul>
<li>Edit the <code>elasticsearch.yml</code> file to enable auditing.</li>
<li>Configure the audit outputs to log to both index and logfile.</li>
<li>Include events for access granted and access denied.</li>
<li>Restart Elasticsearch to apply the changes.</li>
</ul>
</li>
<li><strong>Verification</strong>:
<ul>
<li>Perform some search operations and check the audit logs in the log files and the Elasticsearch index.</li>
</ul>
</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><ol>
<li>
<p><strong>Edit <code>elasticsearch.yml</code></strong>:</p>
<pre><code class="language-yaml">xpack.security.audit.enabled: true
xpack.security.audit.outputs: [ index, logfile ]
xpack.security.audit.logfile.events.include: [ &quot;access_granted&quot;, &quot;access_denied&quot; ]
xpack.security.audit.index.events.include: [ &quot;access_granted&quot;, &quot;access_denied&quot; ]
</code></pre>
</li>
<li>
<p><strong>Restart Elasticsearch</strong>:</p>
<pre><code class="language-bash">sudo systemctl restart elasticsearch
</code></pre>
</li>
<li>
<p><strong>Verify Logs</strong>:</p>
<ul>
<li>Check the log files in the <code>logs</code> directory.</li>
<li>Query the audit index in Elasticsearch:</li>
</ul>
<pre><code class="language-json">GET /_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;event_type&quot;: &quot;access_granted&quot;
    }
  }
}
</code></pre>
</li>
</ol>
</div><h1>Summary</h1>
<div class='content'><p>In this section, we covered the importance of auditing and compliance in Elasticsearch. We learned how to enable and configure auditing, view audit logs, and consider compliance requirements. By implementing these practices, you can ensure that your Elasticsearch cluster is secure, compliant, and accountable.</p>
<p>Next, we will explore how to integrate Elasticsearch with other tools in the ecosystem.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-03-role-based-access-control' title="Role-Based Access Control">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-01-elasticsearch-logstash' title="Elasticsearch with Logstash">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
