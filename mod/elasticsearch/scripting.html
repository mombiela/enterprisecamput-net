<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scripting in Elasticsearch</title>

    <link rel="alternate" href="https://campusempresa.com/mod/elasticsearch/scripting" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/elasticsearch/scripting" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/elasticsearch/scripting" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/elasticsearch/scripting" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/elasticsearch/scripting" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='aggregations'>&#x25C4;Aggregations</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Scripting in Elasticsearch</a>
	</div>
	<div class='col-4 text-end'>
					<a href='geo-search'>Geo-Search &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Scripting</h1>
<div class='content'><p>Scripting in Elasticsearch allows you to customize the behavior of your queries and operations. It can be used for a variety of purposes, such as custom scoring, filtering, and data transformation.</p>
<ul>
<li>
<p><strong>What is Scripting?</strong></p>
<ul>
<li>Scripting is the process of writing code to automate tasks or customize operations.</li>
<li>In Elasticsearch, scripts can be used in queries, aggregations, and updates.</li>
</ul>
</li>
<li>
<p><strong>Why Use Scripting?</strong></p>
<ul>
<li>To perform complex calculations.</li>
<li>To customize scoring algorithms.</li>
<li>To manipulate data during indexing or querying.</li>
</ul>
</li>
</ul>
</div><h1>Types of Scripts</h1>
<div class='content'><p>Elasticsearch supports several scripting languages, each with its own use cases and advantages.</p>
<ul>
<li>
<p><strong>Painless</strong></p>
<ul>
<li>The default and recommended scripting language.</li>
<li>Designed to be secure and performant.</li>
<li>Syntax similar to Java.</li>
</ul>
</li>
<li>
<p><strong>Expressions</strong></p>
<ul>
<li>A simple, secure, and fast language for basic arithmetic and logical operations.</li>
<li>Limited in functionality compared to Painless.</li>
</ul>
</li>
<li>
<p><strong>Mustache</strong></p>
<ul>
<li>A templating language used for creating dynamic queries.</li>
<li>Useful for parameterizing queries.</li>
</ul>
</li>
</ul>
<p>| Language   | Use Case                                  | Performance | Security |
|------------|-------------------------------------------|-------------|----------|
| Painless   | General-purpose scripting                 | High        | High     |
| Expressions| Basic arithmetic and logical operations   | Very High   | Very High|
| Mustache   | Dynamic query templates                   | Moderate    | High     |</p>
</div><h1>Using Painless Scripts</h1>
<div class='content'><p>Painless is the most versatile and powerful scripting language in Elasticsearch. Here's how you can use it:</p>
</div><h2>Inline Scripts</h2>
<div class='content'><p>Inline scripts are written directly within the query.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJxdWVyeSI6IHsKICAgICJzY3JpcHRfc2NvcmUiOiB7CiAgICAgICJxdWVyeSI6IHsKICAgICAgICAibWF0Y2giOiB7CiAgICAgICAgICAibWVzc2FnZSI6ICJlbGFzdGljc2VhcmNoIgogICAgICAgIH0KICAgICAgfSwKICAgICAgInNjcmlwdCI6IHsKICAgICAgICAic291cmNlIjogImRvY1snbGlrZXMnXS52YWx1ZSAqIDIiCiAgICAgIH0KICAgIH0KICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;query&quot;: {
    &quot;script_score&quot;: {
      &quot;query&quot;: {
        &quot;match&quot;: {
          &quot;message&quot;: &quot;elasticsearch&quot;
        }
      },
      &quot;script&quot;: {
        &quot;source&quot;: &quot;doc['likes'].value * 2&quot;
      }
    }
  }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>: This script multiplies the <code>likes</code> field by 2 for scoring purposes.</li>
</ul>
</div><h2>Stored Scripts</h2>
<div class='content'><p>Stored scripts are pre-defined and stored in Elasticsearch, allowing for reuse and better security.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UFVUIF9zY3JpcHRzL2NhbGN1bGF0ZS1zY29yZQp7CiAgInNjcmlwdCI6IHsKICAgICJsYW5nIjogInBhaW5sZXNzIiwKICAgICJzb3VyY2UiOiAiZG9jWydsaWtlcyddLnZhbHVlICogcGFyYW1zLmZhY3RvciIKICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PUT _scripts/calculate-score
{
  &quot;script&quot;: {
    &quot;lang&quot;: &quot;painless&quot;,
    &quot;source&quot;: &quot;doc['likes'].value * params.factor&quot;
  }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>: This script calculates a score by multiplying the <code>likes</code> field by a parameter <code>factor</code>.</li>
</ul>
</div><h2>Using Parameters</h2>
<div class='content'><p>Parameters can be passed to scripts to make them more flexible and secure.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJxdWVyeSI6IHsKICAgICJzY3JpcHRfc2NvcmUiOiB7CiAgICAgICJxdWVyeSI6IHsKICAgICAgICAibWF0Y2giOiB7CiAgICAgICAgICAibWVzc2FnZSI6ICJlbGFzdGljc2VhcmNoIgogICAgICAgIH0KICAgICAgfSwKICAgICAgInNjcmlwdCI6IHsKICAgICAgICAic291cmNlIjogImRvY1snbGlrZXMnXS52YWx1ZSAqIHBhcmFtcy5mYWN0b3IiLAogICAgICAgICJwYXJhbXMiOiB7CiAgICAgICAgICAiZmFjdG9yIjogMgogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;query&quot;: {
    &quot;script_score&quot;: {
      &quot;query&quot;: {
        &quot;match&quot;: {
          &quot;message&quot;: &quot;elasticsearch&quot;
        }
      },
      &quot;script&quot;: {
        &quot;source&quot;: &quot;doc['likes'].value * params.factor&quot;,
        &quot;params&quot;: {
          &quot;factor&quot;: 2
        }
      }
    }
  }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>: This script uses a parameter <code>factor</code> to multiply the <code>likes</code> field.</li>
</ul>
</div><h1>Advanced Scripting Techniques</h1>
<div class='content'><p>As you become more comfortable with scripting, you can explore advanced techniques.</p>
<ul>
<li>
<p><strong>Custom Scoring</strong></p>
<ul>
<li>Create complex scoring algorithms based on multiple fields and conditions.</li>
</ul>
</li>
<li>
<p><strong>Data Transformation</strong></p>
<ul>
<li>Modify documents during indexing or querying to fit specific needs.</li>
</ul>
</li>
<li>
<p><strong>Aggregations</strong></p>
<ul>
<li>Use scripts to create custom aggregations for more detailed analysis.</li>
</ul>
</li>
</ul>
</div><h2>Example: Custom Scoring</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJxdWVyeSI6IHsKICAgICJmdW5jdGlvbl9zY29yZSI6IHsKICAgICAgInF1ZXJ5IjogewogICAgICAgICJtYXRjaF9hbGwiOiB7fQogICAgICB9LAogICAgICAic2NyaXB0X3Njb3JlIjogewogICAgICAgICJzY3JpcHQiOiB7CiAgICAgICAgICAic291cmNlIjogIk1hdGgubG9nKDIgKyBkb2NbJ2xpa2VzJ10udmFsdWUpIgogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;query&quot;: {
    &quot;function_score&quot;: {
      &quot;query&quot;: {
        &quot;match_all&quot;: {}
      },
      &quot;script_score&quot;: {
        &quot;script&quot;: {
          &quot;source&quot;: &quot;Math.log(2 + doc['likes'].value)&quot;
        }
      }
    }
  }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>: This script uses the logarithm of the <code>likes</code> field plus 2 to calculate the score.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Scripting in Elasticsearch is a powerful feature that allows for extensive customization and optimization of your search and indexing operations. By understanding the basics of scripting languages like Painless, and learning how to use inline and stored scripts, you can unlock the full potential of Elasticsearch for your specific use cases. As you advance, you can explore more complex scenarios and techniques to further enhance your Elasticsearch applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='aggregations'>&#x25C4;Aggregations</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Scripting in Elasticsearch</a>
	</div>
	<div class='col-4 text-end'>
					<a href='geo-search'>Geo-Search &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
