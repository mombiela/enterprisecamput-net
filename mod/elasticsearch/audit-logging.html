<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audit Logging in Elasticsearch</title>

    <link rel="alternate" href="https://campusempresa.com/mod/elasticsearch/audit-logging" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/elasticsearch/audit-logging" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/elasticsearch/audit-logging" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/elasticsearch/audit-logging" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/elasticsearch/audit-logging" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='user-role-management'>&#x25C4;User and Role Management</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Audit Logging in Elasticsearch</a>
	</div>
	<div class='col-4 text-end'>
					<a href='elasticsearch-in-production'>Elasticsearch in Production &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Audit Logging</h1>
<div class='content'><p>Audit logging is a critical feature for monitoring and tracking user activities within an Elasticsearch cluster. It helps in maintaining security, compliance, and operational oversight by recording events such as user logins, data access, and configuration changes.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Audit Logs</strong>: Records of events that capture user actions and system changes.</li>
<li><strong>Compliance</strong>: Ensuring that the system adheres to regulatory requirements.</li>
<li><strong>Security</strong>: Monitoring unauthorized access and potential security breaches.</li>
<li><strong>Operational Oversight</strong>: Tracking changes and activities for troubleshooting and system management.</li>
</ul>
</div><h1>Setting Up Audit Logging</h1>
<div class='content'><p>To enable audit logging in Elasticsearch, you need to configure the <code>elasticsearch.yml</code> file. Here’s a step-by-step guide:</p>
</div><h2>Configuration Steps</h2>
<div class='content'><ol>
<li>
<p><strong>Enable Audit Logging</strong>:</p>
<pre><code class="language-yaml">xpack.security.audit.enabled: true
</code></pre>
</li>
<li>
<p><strong>Specify Output Destination</strong>:</p>
<ul>
<li><strong>Log File</strong>:
<pre><code class="language-yaml">xpack.security.audit.outputs: [file]
xpack.security.audit.logfile.events.emit_request_body: true
xpack.security.audit.logfile.prefix: &quot;audit&quot;
xpack.security.audit.logfile.events.include: [&quot;access_granted&quot;, &quot;access_denied&quot;]
</code></pre>
</li>
<li><strong>Index</strong>:
<pre><code class="language-yaml">xpack.security.audit.outputs: [index]
xpack.security.audit.index.events.emit_request_body: true
xpack.security.audit.index.events.include: [&quot;access_granted&quot;, &quot;access_denied&quot;]
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Filter Events</strong>:</p>
<ul>
<li>Include specific events:
<pre><code class="language-yaml">xpack.security.audit.logfile.events.include: [&quot;access_granted&quot;, &quot;access_denied&quot;]
</code></pre>
</li>
<li>Exclude specific events:
<pre><code class="language-yaml">xpack.security.audit.logfile.events.exclude: [&quot;authentication_success&quot;]
</code></pre>
</li>
</ul>
</li>
</ol>
</div><h2>Example Configuration</h2>
<div class='content'><p>Here is a complete example of an <code>elasticsearch.yml</code> configuration for audit logging:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("eHBhY2suc2VjdXJpdHkuYXVkaXQuZW5hYmxlZDogdHJ1ZQp4cGFjay5zZWN1cml0eS5hdWRpdC5vdXRwdXRzOiBbZmlsZSwgaW5kZXhdCnhwYWNrLnNlY3VyaXR5LmF1ZGl0LmxvZ2ZpbGUuZXZlbnRzLmVtaXRfcmVxdWVzdF9ib2R5OiB0cnVlCnhwYWNrLnNlY3VyaXR5LmF1ZGl0LmxvZ2ZpbGUucHJlZml4OiAiYXVkaXQiCnhwYWNrLnNlY3VyaXR5LmF1ZGl0LmxvZ2ZpbGUuZXZlbnRzLmluY2x1ZGU6IFsiYWNjZXNzX2dyYW50ZWQiLCAiYWNjZXNzX2RlbmllZCJdCnhwYWNrLnNlY3VyaXR5LmF1ZGl0LmluZGV4LmV2ZW50cy5lbWl0X3JlcXVlc3RfYm9keTogdHJ1ZQp4cGFjay5zZWN1cml0eS5hdWRpdC5pbmRleC5ldmVudHMuaW5jbHVkZTogWyJhY2Nlc3NfZ3JhbnRlZCIsICJhY2Nlc3NfZGVuaWVkIl0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>xpack.security.audit.enabled: true
xpack.security.audit.outputs: [file, index]
xpack.security.audit.logfile.events.emit_request_body: true
xpack.security.audit.logfile.prefix: &quot;audit&quot;
xpack.security.audit.logfile.events.include: [&quot;access_granted&quot;, &quot;access_denied&quot;]
xpack.security.audit.index.events.emit_request_body: true
xpack.security.audit.index.events.include: [&quot;access_granted&quot;, &quot;access_denied&quot;]</pre></div><div class='content'></div><h1>Analyzing Audit Logs</h1>
<div class='content'><p>Once audit logging is enabled, you can analyze the logs to monitor user activities and system changes.</p>
</div><h2>Accessing Log Files</h2>
<div class='content'><p>Audit logs are stored in the specified log file or index. For example, if logs are stored in a file, you can access them at the configured location:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("L3Zhci9sb2cvZWxhc3RpY3NlYXJjaC9hdWRpdC5sb2c="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/var/log/elasticsearch/audit.log</pre></div><div class='content'></div><h2>Querying Audit Logs in Kibana</h2>
<div class='content'><p>If audit logs are stored in an index, you can use Kibana to query and visualize the logs:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R0VUIC9fc2VhcmNoCnsKICAicXVlcnkiOiB7CiAgICAibWF0Y2giOiB7CiAgICAgICJldmVudC50eXBlIjogImFjY2Vzc19ncmFudGVkIgogICAgfQogIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>GET /_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;event.type&quot;: &quot;access_granted&quot;
    }
  }
}</pre></div><div class='content'></div><h2>Example Log Entry</h2>
<div class='content'><p>Here’s an example of an audit log entry:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJ0aW1lc3RhbXAiOiAiMjAyMy0xMC0wMVQxMjozNDo1NloiLAogICJwcmluY2lwYWwiOiAidXNlcjEiLAogICJhY3Rpb24iOiAiYWNjZXNzX2dyYW50ZWQiLAogICJpbmRpY2VzIjogWyJpbmRleDEiXSwKICAicmVxdWVzdCI6IHsKICAgICJtZXRob2QiOiAiR0VUIiwKICAgICJ1cmkiOiAiL2luZGV4MS9fc2VhcmNoIgogIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;timestamp&quot;: &quot;2023-10-01T12:34:56Z&quot;,
  &quot;principal&quot;: &quot;user1&quot;,
  &quot;action&quot;: &quot;access_granted&quot;,
  &quot;indices&quot;: [&quot;index1&quot;],
  &quot;request&quot;: {
    &quot;method&quot;: &quot;GET&quot;,
    &quot;uri&quot;: &quot;/index1/_search&quot;
  }
}</pre></div><div class='content'></div><h1>Best Practices</h1>
<div class='content'><ul>
<li><strong>Regular Monitoring</strong>: Regularly review audit logs to detect any unusual activities.</li>
<li><strong>Retention Policies</strong>: Implement log retention policies to manage storage and compliance.</li>
<li><strong>Alerting</strong>: Set up alerts for critical events such as access_denied or authentication_failures.</li>
<li><strong>Secure Storage</strong>: Ensure that audit logs are stored securely to prevent tampering.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Audit logging in Elasticsearch is an essential feature for maintaining security, compliance, and operational oversight. By enabling and properly configuring audit logging, you can monitor user activities, detect unauthorized access, and ensure that your Elasticsearch cluster operates within regulatory requirements. Regular analysis and best practices will help you make the most out of audit logging capabilities.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='user-role-management'>&#x25C4;User and Role Management</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Audit Logging in Elasticsearch</a>
	</div>
	<div class='col-4 text-end'>
					<a href='elasticsearch-in-production'>Elasticsearch in Production &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
