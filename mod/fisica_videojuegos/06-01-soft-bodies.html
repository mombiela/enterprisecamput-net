<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soft Bodies</title>

    <link rel="alternate" href="https://campusempresa.com/mod/fisica_videojuegos/06-01-soft-bodies" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/fisica_videojuegos/06-01-soft-bodies" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/fisica_videojuegos/06-01-soft-bodies" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/fisica_videojuegos/06-01-soft-bodies" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/fisica_videojuegos/06-01-soft-bodies" class="px-2">CA</a>
<br>
			<cite>Building today's and tomorrow's society</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Programming Languages</a>
				 					<a href="/categ/frameworks">Frameworks and Libraries</a>
				 					<a href="/categ/tech-tools">Technical Tools</a>
				 					<a href="/categ/foundations">Theoretical Foundations</a>
				 					<a href="/categ/soft-skills">Social Skills</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-03-particle-effects' title="Particle Effects">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Soft Bodies</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-02-ragdoll-physics' title="Ragdoll Physics">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1><p>Introduction</p>
</h1>
<div class='content'><p>Soft body physics is a complex and fascinating area of game development that deals with the simulation of deformable objects. Unlike rigid bodies, which do not change shape, soft bodies can bend, stretch, and compress, making them ideal for simulating objects like cloth, jelly, or even human tissue.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'></div><h2><ol>
<li>Deformable Objects</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Definition</strong>: Objects that can change shape in response to forces.</li>
<li><strong>Examples</strong>: Cloth, rubber, jelly, and organic tissues.</li>
</ul>
</div><h2><ol start="2">
<li>Mesh Representation</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Vertices and Edges</strong>: Soft bodies are often represented as a mesh of interconnected vertices and edges.</li>
<li><strong>Springs and Damping</strong>: Springs can be used to simulate the elastic properties of the material, while damping helps to simulate energy loss over time.</li>
</ul>
</div><h2><ol start="3">
<li>Physics Models</li>
</ol>
</h2>
<div class='content'><ul>
<li><strong>Mass-Spring Model</strong>: Uses masses connected by springs to simulate elasticity.</li>
<li><strong>Finite Element Method (FEM)</strong>: A more advanced technique that divides the object into smaller elements and solves the physics equations for each element.</li>
</ul>
</div><h1><p>Practical Example: Mass-Spring Model</p>
</h1>
<div class='content'></div><h2><p>Step-by-Step Implementation</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Define the Mesh</strong>:</p>
<ul>
<li>Create a grid of vertices connected by springs.</li>
<li>Each vertex has a mass and can move in response to forces.</li>
</ul>
</li>
<li>
<p><strong>Apply Forces</strong>:</p>
<ul>
<li>Gravity, wind, and user interactions can be applied to the vertices.</li>
<li>Calculate the forces acting on each vertex.</li>
</ul>
</li>
<li>
<p><strong>Update Positions</strong>:</p>
<ul>
<li>Use numerical integration (e.g., Euler or Verlet integration) to update the positions of the vertices based on the forces.</li>
</ul>
</li>
<li>
<p><strong>Collision Detection and Response</strong>:</p>
<ul>
<li>Detect collisions with other objects and adjust the positions of the vertices to prevent interpenetration.</li>
</ul>
</li>
</ol>
</div><h2><p>Code Example</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCgpjbGFzcyBTb2Z0Qm9keToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB3aWR0aCwgaGVpZ2h0LCBtYXNzLCBzdGlmZm5lc3MsIGRhbXBpbmcpOgogICAgICAgIHNlbGYud2lkdGggPSB3aWR0aAogICAgICAgIHNlbGYuaGVpZ2h0ID0gaGVpZ2h0CiAgICAgICAgc2VsZi5tYXNzID0gbWFzcwogICAgICAgIHNlbGYuc3RpZmZuZXNzID0gc3RpZmZuZXNzCiAgICAgICAgc2VsZi5kYW1waW5nID0gZGFtcGluZwogICAgICAgIHNlbGYudmVydGljZXMgPSBucC56ZXJvcygod2lkdGgsIGhlaWdodCwgMikpICAjIDJEIHBvc2l0aW9ucwogICAgICAgIHNlbGYudmVsb2NpdGllcyA9IG5wLnplcm9zKCh3aWR0aCwgaGVpZ2h0LCAyKSkgICMgMkQgdmVsb2NpdGllcwogICAgICAgIHNlbGYuZm9yY2VzID0gbnAuemVyb3MoKHdpZHRoLCBoZWlnaHQsIDIpKSAgIyAyRCBmb3JjZXMKCiAgICBkZWYgYXBwbHlfZ3Jhdml0eShzZWxmLCBnKToKICAgICAgICBzZWxmLmZvcmNlc1s6LCA6LCAxXSArPSBzZWxmLm1hc3MgKiBnCgogICAgZGVmIHVwZGF0ZShzZWxmLCBkdCk6CiAgICAgICAgIyBBcHBseSBmb3JjZXMgYW5kIHVwZGF0ZSB2ZWxvY2l0aWVzCiAgICAgICAgc2VsZi52ZWxvY2l0aWVzICs9IChzZWxmLmZvcmNlcyAvIHNlbGYubWFzcykgKiBkdAogICAgICAgICMgRGFtcGluZwogICAgICAgIHNlbGYudmVsb2NpdGllcyAqPSAoMSAtIHNlbGYuZGFtcGluZykKICAgICAgICAjIFVwZGF0ZSBwb3NpdGlvbnMKICAgICAgICBzZWxmLnZlcnRpY2VzICs9IHNlbGYudmVsb2NpdGllcyAqIGR0CiAgICAgICAgIyBSZXNldCBmb3JjZXMKICAgICAgICBzZWxmLmZvcmNlcy5maWxsKDApCgojIEV4YW1wbGUgdXNhZ2UKc29mdF9ib2R5ID0gU29mdEJvZHkod2lkdGg9MTAsIGhlaWdodD0xMCwgbWFzcz0xLjAsIHN0aWZmbmVzcz0wLjUsIGRhbXBpbmc9MC4xKQpzb2Z0X2JvZHkuYXBwbHlfZ3Jhdml0eSg5LjgxKQpzb2Z0X2JvZHkudXBkYXRlKDAuMDEp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np

class SoftBody:
    def __init__(self, width, height, mass, stiffness, damping):
        self.width = width
        self.height = height
        self.mass = mass
        self.stiffness = stiffness
        self.damping = damping
        self.vertices = np.zeros((width, height, 2))  # 2D positions
        self.velocities = np.zeros((width, height, 2))  # 2D velocities
        self.forces = np.zeros((width, height, 2))  # 2D forces

    def apply_gravity(self, g):
        self.forces[:, :, 1] += self.mass * g

    def update(self, dt):
        # Apply forces and update velocities
        self.velocities += (self.forces / self.mass) * dt
        # Damping
        self.velocities *= (1 - self.damping)
        # Update positions
        self.vertices += self.velocities * dt
        # Reset forces
        self.forces.fill(0)

# Example usage
soft_body = SoftBody(width=10, height=10, mass=1.0, stiffness=0.5, damping=0.1)
soft_body.apply_gravity(9.81)
soft_body.update(0.01)</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>Vertices</strong>: Represent the positions of the points in the soft body.</li>
<li><strong>Velocities</strong>: Track the movement speed of each vertex.</li>
<li><strong>Forces</strong>: Accumulate the forces acting on each vertex.</li>
<li><strong>apply_gravity</strong>: Adds gravitational force to each vertex.</li>
<li><strong>update</strong>: Updates the positions and velocities of the vertices based on the forces.</li>
</ul>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Task</p>
</h2>
<div class='content'><p>Create a simple soft body simulation using the mass-spring model. Implement collision detection with a static plane.</p>
</div><h2><p>Steps</p>
</h2>
<div class='content'><ol>
<li>Define a grid of vertices connected by springs.</li>
<li>Apply gravitational force to the vertices.</li>
<li>Implement collision detection with a plane.</li>
<li>Update the positions and velocities of the vertices.</li>
</ol>
</div><h2><p>Solution</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCgpjbGFzcyBTb2Z0Qm9keToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB3aWR0aCwgaGVpZ2h0LCBtYXNzLCBzdGlmZm5lc3MsIGRhbXBpbmcpOgogICAgICAgIHNlbGYud2lkdGggPSB3aWR0aAogICAgICAgIHNlbGYuaGVpZ2h0ID0gaGVpZ2h0CiAgICAgICAgc2VsZi5tYXNzID0gbWFzcwogICAgICAgIHNlbGYuc3RpZmZuZXNzID0gc3RpZmZuZXNzCiAgICAgICAgc2VsZi5kYW1waW5nID0gZGFtcGluZwogICAgICAgIHNlbGYudmVydGljZXMgPSBucC56ZXJvcygod2lkdGgsIGhlaWdodCwgMikpICAjIDJEIHBvc2l0aW9ucwogICAgICAgIHNlbGYudmVsb2NpdGllcyA9IG5wLnplcm9zKCh3aWR0aCwgaGVpZ2h0LCAyKSkgICMgMkQgdmVsb2NpdGllcwogICAgICAgIHNlbGYuZm9yY2VzID0gbnAuemVyb3MoKHdpZHRoLCBoZWlnaHQsIDIpKSAgIyAyRCBmb3JjZXMKCiAgICBkZWYgYXBwbHlfZ3Jhdml0eShzZWxmLCBnKToKICAgICAgICBzZWxmLmZvcmNlc1s6LCA6LCAxXSArPSBzZWxmLm1hc3MgKiBnCgogICAgZGVmIGFwcGx5X3NwcmluZ19mb3JjZXMoc2VsZik6CiAgICAgICAgZm9yIGkgaW4gcmFuZ2Uoc2VsZi53aWR0aCk6CiAgICAgICAgICAgIGZvciBqIGluIHJhbmdlKHNlbGYuaGVpZ2h0KToKICAgICAgICAgICAgICAgIGlmIGkgPiAwOgogICAgICAgICAgICAgICAgICAgIHNlbGYuYWRkX3NwcmluZ19mb3JjZShpLCBqLCBpLTEsIGopCiAgICAgICAgICAgICAgICBpZiBpIDwgc2VsZi53aWR0aCAtIDE6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5hZGRfc3ByaW5nX2ZvcmNlKGksIGosIGkrMSwgaikKICAgICAgICAgICAgICAgIGlmIGogPiAwOgogICAgICAgICAgICAgICAgICAgIHNlbGYuYWRkX3NwcmluZ19mb3JjZShpLCBqLCBpLCBqLTEpCiAgICAgICAgICAgICAgICBpZiBqIDwgc2VsZi5oZWlnaHQgLSAxOgogICAgICAgICAgICAgICAgICAgIHNlbGYuYWRkX3NwcmluZ19mb3JjZShpLCBqLCBpLCBqKzEpCgogICAgZGVmIGFkZF9zcHJpbmdfZm9yY2Uoc2VsZiwgaTEsIGoxLCBpMiwgajIpOgogICAgICAgIHBvczEgPSBzZWxmLnZlcnRpY2VzW2kxLCBqMV0KICAgICAgICBwb3MyID0gc2VsZi52ZXJ0aWNlc1tpMiwgajJdCiAgICAgICAgZGVsdGEgPSBwb3MyIC0gcG9zMQogICAgICAgIGRpc3RhbmNlID0gbnAubGluYWxnLm5vcm0oZGVsdGEpCiAgICAgICAgZm9yY2UgPSBzZWxmLnN0aWZmbmVzcyAqIChkaXN0YW5jZSAtIDEpICogKGRlbHRhIC8gZGlzdGFuY2UpCiAgICAgICAgc2VsZi5mb3JjZXNbaTEsIGoxXSArPSBmb3JjZQogICAgICAgIHNlbGYuZm9yY2VzW2kyLCBqMl0gLT0gZm9yY2UKCiAgICBkZWYgdXBkYXRlKHNlbGYsIGR0KToKICAgICAgICBzZWxmLmFwcGx5X3NwcmluZ19mb3JjZXMoKQogICAgICAgIHNlbGYudmVsb2NpdGllcyArPSAoc2VsZi5mb3JjZXMgLyBzZWxmLm1hc3MpICogZHQKICAgICAgICBzZWxmLnZlbG9jaXRpZXMgKj0gKDEgLSBzZWxmLmRhbXBpbmcpCiAgICAgICAgc2VsZi52ZXJ0aWNlcyArPSBzZWxmLnZlbG9jaXRpZXMgKiBkdAogICAgICAgIHNlbGYuZm9yY2VzLmZpbGwoMCkKCiAgICBkZWYgaGFuZGxlX2NvbGxpc2lvbnMoc2VsZiwgcGxhbmVfeSk6CiAgICAgICAgZm9yIGkgaW4gcmFuZ2Uoc2VsZi53aWR0aCk6CiAgICAgICAgICAgIGZvciBqIGluIHJhbmdlKHNlbGYuaGVpZ2h0KToKICAgICAgICAgICAgICAgIGlmIHNlbGYudmVydGljZXNbaSwgaiwgMV0gPCBwbGFuZV95OgogICAgICAgICAgICAgICAgICAgIHNlbGYudmVydGljZXNbaSwgaiwgMV0gPSBwbGFuZV95CiAgICAgICAgICAgICAgICAgICAgc2VsZi52ZWxvY2l0aWVzW2ksIGosIDFdID0gMAoKIyBFeGFtcGxlIHVzYWdlCnNvZnRfYm9keSA9IFNvZnRCb2R5KHdpZHRoPTEwLCBoZWlnaHQ9MTAsIG1hc3M9MS4wLCBzdGlmZm5lc3M9MC41LCBkYW1waW5nPTAuMSkKc29mdF9ib2R5LmFwcGx5X2dyYXZpdHkoOS44MSkKZm9yIF8gaW4gcmFuZ2UoMTAwKToKICAgIHNvZnRfYm9keS51cGRhdGUoMC4wMSkKICAgIHNvZnRfYm9keS5oYW5kbGVfY29sbGlzaW9ucyhwbGFuZV95PTAp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np

class SoftBody:
    def __init__(self, width, height, mass, stiffness, damping):
        self.width = width
        self.height = height
        self.mass = mass
        self.stiffness = stiffness
        self.damping = damping
        self.vertices = np.zeros((width, height, 2))  # 2D positions
        self.velocities = np.zeros((width, height, 2))  # 2D velocities
        self.forces = np.zeros((width, height, 2))  # 2D forces

    def apply_gravity(self, g):
        self.forces[:, :, 1] += self.mass * g

    def apply_spring_forces(self):
        for i in range(self.width):
            for j in range(self.height):
                if i &gt; 0:
                    self.add_spring_force(i, j, i-1, j)
                if i &lt; self.width - 1:
                    self.add_spring_force(i, j, i+1, j)
                if j &gt; 0:
                    self.add_spring_force(i, j, i, j-1)
                if j &lt; self.height - 1:
                    self.add_spring_force(i, j, i, j+1)

    def add_spring_force(self, i1, j1, i2, j2):
        pos1 = self.vertices[i1, j1]
        pos2 = self.vertices[i2, j2]
        delta = pos2 - pos1
        distance = np.linalg.norm(delta)
        force = self.stiffness * (distance - 1) * (delta / distance)
        self.forces[i1, j1] += force
        self.forces[i2, j2] -= force

    def update(self, dt):
        self.apply_spring_forces()
        self.velocities += (self.forces / self.mass) * dt
        self.velocities *= (1 - self.damping)
        self.vertices += self.velocities * dt
        self.forces.fill(0)

    def handle_collisions(self, plane_y):
        for i in range(self.width):
            for j in range(self.height):
                if self.vertices[i, j, 1] &lt; plane_y:
                    self.vertices[i, j, 1] = plane_y
                    self.velocities[i, j, 1] = 0

# Example usage
soft_body = SoftBody(width=10, height=10, mass=1.0, stiffness=0.5, damping=0.1)
soft_body.apply_gravity(9.81)
for _ in range(100):
    soft_body.update(0.01)
    soft_body.handle_collisions(plane_y=0)</pre></div><div class='content'></div><h2><p>Explanation</p>
</h2>
<div class='content'><ul>
<li><strong>apply_spring_forces</strong>: Adds forces between connected vertices to simulate elasticity.</li>
<li><strong>add_spring_force</strong>: Calculates and applies the spring force between two vertices.</li>
<li><strong>handle_collisions</strong>: Detects and resolves collisions with a static plane.</li>
</ul>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Numerical Stability</strong>: Ensure the time step (<code>dt</code>) is small enough to maintain stability in the simulation.</li>
<li><strong>Damping</strong>: Proper damping is crucial to prevent the system from oscillating indefinitely.</li>
<li><strong>Collision Handling</strong>: Ensure that collision response is robust to prevent vertices from penetrating the collision plane.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Soft body physics adds a layer of realism to video games by simulating deformable objects. Understanding the principles of mesh representation, mass-spring models, and collision detection is essential for implementing soft body physics. By practicing with simple examples and gradually increasing complexity, you can master the techniques needed to create realistic soft body simulations in your games.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-03-particle-effects' title="Particle Effects">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-02-ragdoll-physics' title="Ragdoll Physics">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
