<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    <title>Pod Security Policies</title>

    <link rel="alternate" href="https://campusempresa.com/mod/kubernetes/08-02-pod-security-policies" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/kubernetes/08-02-pod-security-policies" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/kubernetes/08-02-pod-security-policies" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>var DEVELOP = window.location.href.indexOf("localhost")!=-1 && true;</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/kubernetes/08-02-pod-security-policies" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/kubernetes/08-02-pod-security-policies" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>All the knowledge within your reach</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col" id="left_menu">
					<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

			</div>
		</div>
	</div>
</div>

<!--  
<div class="top-bar container-fluid">
	<div class="container-xxl">
		<nav class="navbar navbar-expand-md p-0">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<div class="navbar-nav me-auto">
							<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Course Content
	</a>

					</div>
				</div>			
							</div>
		</nav>
	</div>
</div>
 -->				<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-01-rbac' title="Role-Based Access Control (RBAC)">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<h2 style="text-decoration:underline">Pod Security Policies</h2>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-03-network-security' title="Network Security">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Pod Security Policies (PSPs) are a critical aspect of Kubernetes security, providing a mechanism to control the security-related aspects of pod specifications. They allow cluster administrators to define a set of conditions that a pod must meet to be accepted into the system, thus enhancing the security posture of the Kubernetes cluster.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Pod Security Policy (PSP)</strong>: A cluster-level resource that controls security-sensitive aspects of the pod specification.</li>
<li><strong>Admission Controller</strong>: A piece of code that intercepts requests to the Kubernetes API server prior to persistence of the object, but after the request is authenticated and authorized.</li>
<li><strong>Security Context</strong>: Defines privilege and access control settings for a pod or container.</li>
</ol>
</div><h1>Creating a Pod Security Policy</h1>
<div class='content'></div><h2>Example PSP YAML</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBpVmVyc2lvbjogcG9saWN5L3YxYmV0YTEKa2luZDogUG9kU2VjdXJpdHlQb2xpY3kKbWV0YWRhdGE6CiAgbmFtZTogZXhhbXBsZS1wc3AKc3BlYzoKICBwcml2aWxlZ2VkOiBmYWxzZQogIGFsbG93UHJpdmlsZWdlRXNjYWxhdGlvbjogZmFsc2UKICByZXF1aXJlZERyb3BDYXBhYmlsaXRpZXM6CiAgICAtIEFMTAogIHZvbHVtZXM6CiAgICAtICdjb25maWdNYXAnCiAgICAtICdlbXB0eURpcicKICAgIC0gJ3Byb2plY3RlZCcKICAgIC0gJ3NlY3JldCcKICAgIC0gJ2Rvd253YXJkQVBJJwogIGhvc3ROZXR3b3JrOiBmYWxzZQogIGhvc3RJUEM6IGZhbHNlCiAgaG9zdFBJRDogZmFsc2UKICBydW5Bc1VzZXI6CiAgICBydWxlOiAnTXVzdFJ1bkFzTm9uUm9vdCcKICBzZUxpbnV4OgogICAgcnVsZTogJ1J1bkFzQW55JwogIHN1cHBsZW1lbnRhbEdyb3VwczoKICAgIHJ1bGU6ICdNdXN0UnVuQXMnCiAgICByYW5nZXM6CiAgICAgIC0gbWluOiAxCiAgICAgICAgbWF4OiA2NTUzNQogIGZzR3JvdXA6CiAgICBydWxlOiAnTXVzdFJ1bkFzJwogICAgcmFuZ2VzOgogICAgICAtIG1pbjogMQogICAgICAgIG1heDogNjU1MzU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: example-psp
spec:
  privileged: false
  allowPrivilegeEscalation: false
  requiredDropCapabilities:
    - ALL
  volumes:
    - 'configMap'
    - 'emptyDir'
    - 'projected'
    - 'secret'
    - 'downwardAPI'
  hostNetwork: false
  hostIPC: false
  hostPID: false
  runAsUser:
    rule: 'MustRunAsNonRoot'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'MustRunAs'
    ranges:
      - min: 1
        max: 65535
  fsGroup:
    rule: 'MustRunAs'
    ranges:
      - min: 1
        max: 65535</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>privileged</strong>: Ensures that no privileged containers are allowed.</li>
<li><strong>allowPrivilegeEscalation</strong>: Prevents containers from gaining more privileges than their parent process.</li>
<li><strong>requiredDropCapabilities</strong>: Drops all Linux capabilities.</li>
<li><strong>volumes</strong>: Restricts the types of volumes that can be used.</li>
<li><strong>hostNetwork, hostIPC, hostPID</strong>: Prevents the use of the host's network, IPC, and PID namespaces.</li>
<li><strong>runAsUser</strong>: Ensures that containers run as a non-root user.</li>
<li><strong>seLinux</strong>: Allows any SELinux context.</li>
<li><strong>supplementalGroups</strong>: Requires that containers run with a specific range of supplemental groups.</li>
<li><strong>fsGroup</strong>: Requires that containers run with a specific range of file system groups.</li>
</ul>
</div><h1>Applying the Pod Security Policy</h1>
<div class='content'><ol>
<li>
<p><strong>Create the PSP</strong>:</p>
<pre><code class="language-bash">kubectl apply -f example-psp.yaml
</code></pre>
</li>
<li>
<p><strong>Create a Role and RoleBinding</strong>:
To use the PSP, you need to create a Role and RoleBinding that grants the necessary permissions.</p>
<pre><code class="language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: psp-role
  namespace: default
rules:
- apiGroups: ['policy']
  resources: ['podsecuritypolicies']
  verbs: ['use']
  resourceNames: ['example-psp']
</code></pre>
<pre><code class="language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: psp-rolebinding
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: psp-role
subjects:
- kind: User
  name: &lt;your-username&gt;
  apiGroup: rbac.authorization.k8s.io
</code></pre>
</li>
<li>
<p><strong>Apply the Role and RoleBinding</strong>:</p>
<pre><code class="language-bash">kubectl apply -f psp-role.yaml
kubectl apply -f psp-rolebinding.yaml
</code></pre>
</li>
</ol>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Task</h2>
<div class='content'><ol>
<li>
<p>Create a Pod Security Policy that:</p>
<ul>
<li>Disallows privileged containers.</li>
<li>Requires containers to run as a non-root user.</li>
<li>Restricts volume types to <code>configMap</code> and <code>emptyDir</code>.</li>
</ul>
</li>
<li>
<p>Apply the PSP and create a Role and RoleBinding to use it.</p>
</li>
</ol>
</div><h2>Solution</h2>
<div class='content'><ol>
<li>
<p><strong>Create the PSP YAML</strong>:</p>
<pre><code class="language-yaml">apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: custom-psp
spec:
  privileged: false
  allowPrivilegeEscalation: false
  requiredDropCapabilities:
    - ALL
  volumes:
    - 'configMap'
    - 'emptyDir'
  hostNetwork: false
  hostIPC: false
  hostPID: false
  runAsUser:
    rule: 'MustRunAsNonRoot'
  seLinux:
    rule: 'RunAsAny'
  supplementalGroups:
    rule: 'MustRunAs'
    ranges:
      - min: 1
        max: 65535
  fsGroup:
    rule: 'MustRunAs'
    ranges:
      - min: 1
        max: 65535
</code></pre>
</li>
<li>
<p><strong>Apply the PSP</strong>:</p>
<pre><code class="language-bash">kubectl apply -f custom-psp.yaml
</code></pre>
</li>
<li>
<p><strong>Create the Role and RoleBinding</strong>:</p>
<pre><code class="language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: custom-psp-role
  namespace: default
rules:
- apiGroups: ['policy']
  resources: ['podsecuritypolicies']
  verbs: ['use']
  resourceNames: ['custom-psp']
</code></pre>
<pre><code class="language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: custom-psp-rolebinding
  namespace: default
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: custom-psp-role
subjects:
- kind: User
  name: &lt;your-username&gt;
  apiGroup: rbac.authorization.k8s.io
</code></pre>
</li>
<li>
<p><strong>Apply the Role and RoleBinding</strong>:</p>
<pre><code class="language-bash">kubectl apply -f custom-psp-role.yaml
kubectl apply -f custom-psp-rolebinding.yaml
</code></pre>
</li>
</ol>
</div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Incorrect RoleBinding</strong>: Ensure that the RoleBinding correctly references the Role and the PSP.</li>
<li><strong>PSP Not Applied</strong>: Verify that the PSP is applied and active by checking the <code>kubectl get psp</code> output.</li>
<li><strong>Admission Controller</strong>: Ensure that the PodSecurityPolicy admission controller is enabled in your Kubernetes cluster.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Pod Security Policies are a powerful tool for enforcing security standards in your Kubernetes cluster. By defining and applying PSPs, you can control the security aspects of your pods, ensuring they adhere to your organization's security policies. This module has covered the creation, application, and management of PSPs, providing you with the knowledge to enhance your cluster's security.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-01-rbac' title="Role-Based Access Control (RBAC)">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-03-network-security' title="Network Security">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
	     crossorigin="anonymous"></script>
	<!-- enterprise_campus -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-0611338592562725"
	     data-ad-slot="6914733106"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
	     (adsbygoogle = window.adsbygoogle || []).push({});
	</script>
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>Kubernetes Course</h1>
<h2>Module 1: Introduction to Kubernetes</h2>
<ul>
<li><a href="01-01-what-is-kubernetes">What is Kubernetes?</a></li>
<li><a href="01-02-kubernetes-architecture">Kubernetes Architecture</a></li>
<li><a href="01-03-key-concepts-terminology">Key Concepts and Terminology</a></li>
<li><a href="01-04-setting-up-cluster">Setting Up a Kubernetes Cluster</a></li>
<li><a href="01-05-kubernetes-cli">Kubernetes CLI (kubectl)</a></li>
</ul>
<h2>Module 2: Core Kubernetes Components</h2>
<ul>
<li><a href="02-01-pods">Pods</a></li>
<li><a href="02-02-replicasets">ReplicaSets</a></li>
<li><a href="02-03-deployments">Deployments</a></li>
<li><a href="02-04-services">Services</a></li>
<li><a href="02-05-namespaces">Namespaces</a></li>
</ul>
<h2>Module 3: Configuration and Secrets Management</h2>
<ul>
<li><a href="03-01-configmaps">ConfigMaps</a></li>
<li><a href="03-02-secrets">Secrets</a></li>
<li><a href="03-03-environment-variables">Environment Variables</a></li>
<li><a href="03-04-resource-quotas-limits">Resource Quotas and Limits</a></li>
</ul>
<h2>Module 4: Networking in Kubernetes</h2>
<ul>
<li><a href="04-01-cluster-networking">Cluster Networking</a></li>
<li><a href="04-02-service-types">Service Types</a></li>
<li><a href="04-03-ingress-controllers">Ingress Controllers</a></li>
<li><a href="04-04-network-policies">Network Policies</a></li>
</ul>
<h2>Module 5: Storage in Kubernetes</h2>
<ul>
<li><a href="05-01-volumes">Volumes</a></li>
<li><a href="05-02-persistent-volumes">Persistent Volumes</a></li>
<li><a href="05-03-persistent-volume-claims">Persistent Volume Claims</a></li>
<li><a href="05-04-storage-classes">Storage Classes</a></li>
</ul>
<h2>Module 6: Advanced Kubernetes Concepts</h2>
<ul>
<li><a href="06-01-statefulsets">StatefulSets</a></li>
<li><a href="06-02-daemonsets">DaemonSets</a></li>
<li><a href="06-03-jobs-cronjobs">Jobs and CronJobs</a></li>
<li><a href="06-04-crds">Custom Resource Definitions (CRDs)</a></li>
</ul>
<h2>Module 7: Monitoring and Logging</h2>
<ul>
<li><a href="07-01-monitoring-prometheus">Monitoring with Prometheus</a></li>
<li><a href="07-02-logging-efk">Logging with Elasticsearch, Fluentd, and Kibana (EFK)</a></li>
<li><a href="07-03-health-checks-probes">Health Checks and Probes</a></li>
<li><a href="07-04-metrics-server">Metrics Server</a></li>
</ul>
<h2>Module 8: Security in Kubernetes</h2>
<ul>
<li><a href="08-01-rbac">Role-Based Access Control (RBAC)</a></li>
<li><a href="08-02-pod-security-policies">Pod Security Policies</a></li>
<li><a href="08-03-network-security">Network Security</a></li>
<li><a href="08-04-image-security">Image Security</a></li>
</ul>
<h2>Module 9: Scaling and Performance</h2>
<ul>
<li><a href="09-01-horizontal-pod-autoscaling">Horizontal Pod Autoscaling</a></li>
<li><a href="09-02-vertical-pod-autoscaling">Vertical Pod Autoscaling</a></li>
<li><a href="09-03-cluster-autoscaling">Cluster Autoscaling</a></li>
<li><a href="09-04-performance-tuning">Performance Tuning</a></li>
</ul>
<h2>Module 10: Kubernetes Ecosystem and Tools</h2>
<ul>
<li><a href="10-01-helm">Helm</a></li>
<li><a href="10-02-kustomize">Kustomize</a></li>
<li><a href="10-03-kubeadm">Kubeadm</a></li>
<li><a href="10-04-minikube">Minikube</a></li>
</ul>
<h2>Module 11: Case Studies and Real-World Applications</h2>
<ul>
<li><a href="11-01-deploying-web-application">Deploying a Web Application</a></li>
<li><a href="11-02-cicd-kubernetes">CI/CD with Kubernetes</a></li>
<li><a href="11-03-running-stateful-applications">Running Stateful Applications</a></li>
<li><a href="11-04-multi-cluster-management">Multi-Cluster Management</a></li>
</ul>
<h2>Module 12: Preparing for Kubernetes Certification</h2>
<ul>
<li><a href="12-01-cka">Certified Kubernetes Administrator (CKA)</a></li>
<li><a href="12-02-ckad">Certified Kubernetes Application Developer (CKAD)</a></li>
<li><a href="12-03-cks">Certified Kubernetes Security Specialist (CKS)</a></li>
<li><a href="12-04-exam-preparation-tips">Exam Preparation Tips</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
