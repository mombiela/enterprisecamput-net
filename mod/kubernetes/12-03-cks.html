<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Certified Kubernetes Security Specialist (CKS)</title>

    <link rel="alternate" href="https://campusempresa.com/mod/kubernetes/12-03-cks" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/kubernetes/12-03-cks" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/kubernetes/12-03-cks" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/kubernetes/12-03-cks" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/kubernetes/12-03-cks" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>All the knowledge within your reach</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					 				<a href="/"><i class="bi bi-house-fill"></i> HOME</a>
											</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='12-02-ckad' title="Certified Kubernetes Application Developer (CKAD)">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Certified Kubernetes Security Specialist (CKS)</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='12-04-exam-preparation-tips' title="Exam Preparation Tips">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>The Certified Kubernetes Security Specialist (CKS) certification is designed for Kubernetes professionals who want to demonstrate their expertise in securing container-based applications and Kubernetes platforms during build, deployment, and runtime. This module will guide you through the key areas of knowledge required to pass the CKS exam, including practical examples and exercises to reinforce your learning.</p>
</div><h1>Key Areas of Focus</h1>
<div class='content'><ol>
<li><strong>Cluster Setup</strong></li>
<li><strong>Cluster Hardening</strong></li>
<li><strong>System Hardening</strong></li>
<li><strong>Minimize Microservice Vulnerabilities</strong></li>
<li><strong>Supply Chain Security</strong></li>
<li><strong>Monitoring, Logging, and Runtime Security</strong></li>
</ol>
</div><h1><ol>
<li>Cluster Setup</li>
</ol></h1>
<div class='content'></div><h2>Overview</h2>
<div class='content'><p>Setting up a secure Kubernetes cluster involves configuring the cluster components and network to ensure security from the ground up.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Kubeadm</strong>: A tool to set up a secure Kubernetes cluster.</li>
<li><strong>Network Policies</strong>: Define how pods communicate with each other and other network endpoints.</li>
<li><strong>RBAC (Role-Based Access Control)</strong>: Manage permissions within the cluster.</li>
</ul>
</div><h2>Practical Example: Setting Up a Secure Cluster with Kubeadm</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbml0aWFsaXplIHRoZSBLdWJlcm5ldGVzIGNsdXN0ZXIgd2l0aCBrdWJlYWRtCnN1ZG8ga3ViZWFkbSBpbml0IC0tcG9kLW5ldHdvcmstY2lkcj0xOTIuMTY4LjAuMC8xNgoKIyBTZXQgdXAga3ViZWNvbmZpZyBmb3IgdGhlIGFkbWluIHVzZXIKbWtkaXIgLXAgJEhPTUUvLmt1YmUKc3VkbyBjcCAtaSAvZXRjL2t1YmVybmV0ZXMvYWRtaW4uY29uZiAkSE9NRS8ua3ViZS9jb25maWcKc3VkbyBjaG93biAkKGlkIC11KTokKGlkIC1nKSAkSE9NRS8ua3ViZS9jb25maWcKCiMgQXBwbHkgYSBuZXR3b3JrIHBsdWdpbiAoZS5nLiwgQ2FsaWNvKQprdWJlY3RsIGFwcGx5IC1mIGh0dHBzOi8vZG9jcy5wcm9qZWN0Y2FsaWNvLm9yZy9tYW5pZmVzdHMvY2FsaWNvLnlhbWw="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Initialize the Kubernetes cluster with kubeadm
sudo kubeadm init --pod-network-cidr=192.168.0.0/16

# Set up kubeconfig for the admin user
mkdir -p $HOME/.kube
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config

# Apply a network plugin (e.g., Calico)
kubectl apply -f https://docs.projectcalico.org/manifests/calico.yaml</pre></div><div class='content'></div><h2>Exercise: Configure RBAC for a Namespace</h2>
<div class='content'><ol>
<li>
<p><strong>Create a namespace</strong>:</p>
<pre><code class="language-bash">kubectl create namespace secure-namespace
</code></pre>
</li>
<li>
<p><strong>Create a Role</strong>:</p>
<pre><code class="language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: secure-namespace
  name: pod-reader
rules:
- apiGroups: [&quot;&quot;]
  resources: [&quot;pods&quot;]
  verbs: [&quot;get&quot;, &quot;watch&quot;, &quot;list&quot;]
</code></pre>
</li>
<li>
<p><strong>Create a RoleBinding</strong>:</p>
<pre><code class="language-yaml">apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: read-pods
  namespace: secure-namespace
subjects:
- kind: User
  name: jane
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: pod-reader
  apiGroup: rbac.authorization.k8s.io
</code></pre>
</li>
</ol>
</div><h1><ol start="2">
<li>Cluster Hardening</li>
</ol></h1>
<div class='content'></div><h2>Overview</h2>
<div class='content'><p>Cluster hardening involves securing the Kubernetes components and configurations to protect against unauthorized access and vulnerabilities.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>API Server Security</strong>: Secure the Kubernetes API server.</li>
<li><strong>Etcd Security</strong>: Secure the etcd database.</li>
<li><strong>Kubelet Security</strong>: Secure the kubelet on each node.</li>
</ul>
</div><h2>Practical Example: Securing the API Server</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFZGl0IHRoZSBrdWJlLWFwaXNlcnZlciBtYW5pZmVzdApzdWRvIHZpIC9ldGMva3ViZXJuZXRlcy9tYW5pZmVzdHMva3ViZS1hcGlzZXJ2ZXIueWFtbAoKIyBBZGQgdGhlIGZvbGxvd2luZyBmbGFncyB0byBlbmFibGUgYXVkaXQgbG9nZ2luZyBhbmQgc2VjdXJlIGNvbW11bmljYXRpb24KLSAtLWF1ZGl0LWxvZy1wYXRoPS92YXIvbG9nL2t1YmVybmV0ZXMvYXVkaXQubG9nCi0gLS1hdWRpdC1sb2ctbWF4YWdlPTMwCi0gLS1hdWRpdC1sb2ctbWF4YmFja3VwPTEwCi0gLS1hdWRpdC1sb2ctbWF4c2l6ZT0xMDAKLSAtLXRscy1jZXJ0LWZpbGU9L2V0Yy9rdWJlcm5ldGVzL3BraS9hcGlzZXJ2ZXIuY3J0Ci0gLS10bHMtcHJpdmF0ZS1rZXktZmlsZT0vZXRjL2t1YmVybmV0ZXMvcGtpL2FwaXNlcnZlci5rZXk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Edit the kube-apiserver manifest
sudo vi /etc/kubernetes/manifests/kube-apiserver.yaml

# Add the following flags to enable audit logging and secure communication
- --audit-log-path=/var/log/kubernetes/audit.log
- --audit-log-maxage=30
- --audit-log-maxbackup=10
- --audit-log-maxsize=100
- --tls-cert-file=/etc/kubernetes/pki/apiserver.crt
- --tls-private-key-file=/etc/kubernetes/pki/apiserver.key</pre></div><div class='content'></div><h2>Exercise: Enable Audit Logging</h2>
<div class='content'><ol>
<li>
<p><strong>Create an audit policy file</strong>:</p>
<pre><code class="language-yaml">apiVersion: audit.k8s.io/v1
kind: Policy
rules:
- level: Metadata
</code></pre>
</li>
<li>
<p><strong>Configure the API server to use the audit policy</strong>:</p>
<pre><code class="language-yaml">- --audit-policy-file=/etc/kubernetes/audit-policy.yaml
</code></pre>
</li>
</ol>
</div><h1><ol start="3">
<li>System Hardening</li>
</ol></h1>
<div class='content'></div><h2>Overview</h2>
<div class='content'><p>System hardening involves securing the underlying operating system and container runtime.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Operating System Security</strong>: Secure the OS running Kubernetes nodes.</li>
<li><strong>Container Runtime Security</strong>: Secure the container runtime (e.g., Docker, containerd).</li>
</ul>
</div><h2>Practical Example: Securing Docker</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBEb2NrZXIgZGFlbW9uIGNvbmZpZ3VyYXRpb24gZmlsZQpzdWRvIHZpIC9ldGMvZG9ja2VyL2RhZW1vbi5qc29uCgojIEFkZCB0aGUgZm9sbG93aW5nIGNvbmZpZ3VyYXRpb24gdG8gZW5hYmxlIHVzZXIgbmFtZXNwYWNlcwp7CiAgInVzZXJucy1yZW1hcCI6ICJkZWZhdWx0Igp9CgojIFJlc3RhcnQgRG9ja2VyIHRvIGFwcGx5IHRoZSBjaGFuZ2VzCnN1ZG8gc3lzdGVtY3RsIHJlc3RhcnQgZG9ja2Vy"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a Docker daemon configuration file
sudo vi /etc/docker/daemon.json

# Add the following configuration to enable user namespaces
{
  &quot;userns-remap&quot;: &quot;default&quot;
}

# Restart Docker to apply the changes
sudo systemctl restart docker</pre></div><div class='content'></div><h2>Exercise: Configure AppArmor for a Pod</h2>
<div class='content'><ol>
<li>
<p><strong>Create an AppArmor profile</strong>:</p>
<pre><code class="language-bash">sudo vi /etc/apparmor.d/k8s-apparmor-profile

# Add the following profile
profile k8s-apparmor-profile flags=(attach_disconnected,mediate_deleted) {
  #include &lt;tunables/global&gt;
  file,
  network,
  capability,
}
</code></pre>
</li>
<li>
<p><strong>Apply the AppArmor profile to a pod</strong>:</p>
<pre><code class="language-yaml">apiVersion: v1
kind: Pod
metadata:
  name: apparmor-pod
  annotations:
    container.apparmor.security.beta.kubernetes.io/nginx: localhost/k8s-apparmor-profile
spec:
  containers:
  - name: nginx
    image: nginx
</code></pre>
</li>
</ol>
</div><h1><ol start="4">
<li>Minimize Microservice Vulnerabilities</li>
</ol></h1>
<div class='content'></div><h2>Overview</h2>
<div class='content'><p>Minimizing microservice vulnerabilities involves securing the application code and configurations.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Image Security</strong>: Use secure and trusted container images.</li>
<li><strong>Pod Security Policies</strong>: Define security policies for pods.</li>
</ul>
</div><h2>Practical Example: Using a Secure Base Image</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBVc2UgYSBtaW5pbWFsIGFuZCBzZWN1cmUgYmFzZSBpbWFnZQpGUk9NIGFscGluZTozLjEyCgojIEluc3RhbGwgbmVjZXNzYXJ5IHBhY2thZ2VzClJVTiBhcGsgYWRkIC0tbm8tY2FjaGUgbmdpbngKCiMgQ29weSBhcHBsaWNhdGlvbiBmaWxlcwpDT1BZIC4gL3Vzci9zaGFyZS9uZ2lueC9odG1sCgojIFN0YXJ0IHRoZSBhcHBsaWNhdGlvbgpDTUQgWyJuZ2lueCIsICItZyIsICJkYWVtb24gb2ZmOyJd"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Use a minimal and secure base image
FROM alpine:3.12

# Install necessary packages
RUN apk add --no-cache nginx

# Copy application files
COPY . /usr/share/nginx/html

# Start the application
CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]</pre></div><div class='content'></div><h2>Exercise: Create a Pod Security Policy</h2>
<div class='content'><ol>
<li>
<p><strong>Create a Pod Security Policy</strong>:</p>
<pre><code class="language-yaml">apiVersion: policy/v1beta1
kind: PodSecurityPolicy
metadata:
  name: restricted
spec:
  privileged: false
  seLinux:
    rule: RunAsAny
  runAsUser:
    rule: MustRunAsNonRoot
  fsGroup:
    rule: MustRunAs
    ranges:
    - min: 1
      max: 65535
  volumes:
  - 'configMap'
  - 'emptyDir'
  - 'projected'
  - 'secret'
  - 'downwardAPI'
  - 'persistentVolumeClaim'
</code></pre>
</li>
<li>
<p><strong>Apply the Pod Security Policy</strong>:</p>
<pre><code class="language-bash">kubectl apply -f psp.yaml
</code></pre>
</li>
</ol>
</div><h1><ol start="5">
<li>Supply Chain Security</li>
</ol></h1>
<div class='content'></div><h2>Overview</h2>
<div class='content'><p>Supply chain security involves securing the software supply chain, including source code, build processes, and dependencies.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Source Code Security</strong>: Secure the source code repository.</li>
<li><strong>Dependency Management</strong>: Use secure and trusted dependencies.</li>
</ul>
</div><h2>Practical Example: Using Snyk for Dependency Scanning</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbnN0YWxsIFNueWsgQ0xJCm5wbSBpbnN0YWxsIC1nIHNueWsKCiMgQXV0aGVudGljYXRlIHdpdGggU255awpzbnlrIGF1dGgKCiMgU2NhbiBhIHByb2plY3QgZm9yIHZ1bG5lcmFiaWxpdGllcwpzbnlrIHRlc3Q="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Install Snyk CLI
npm install -g snyk

# Authenticate with Snyk
snyk auth

# Scan a project for vulnerabilities
snyk test</pre></div><div class='content'></div><h2>Exercise: Scan a Docker Image for Vulnerabilities</h2>
<div class='content'><ol>
<li>
<p><strong>Install Snyk Docker plugin</strong>:</p>
<pre><code class="language-bash">snyk install docker
</code></pre>
</li>
<li>
<p><strong>Scan a Docker image</strong>:</p>
<pre><code class="language-bash">snyk test --docker nginx:latest
</code></pre>
</li>
</ol>
</div><h1><ol start="6">
<li>Monitoring, Logging, and Runtime Security</li>
</ol></h1>
<div class='content'></div><h2>Overview</h2>
<div class='content'><p>Monitoring, logging, and runtime security involve continuously monitoring the cluster and applications for security threats and vulnerabilities.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Prometheus</strong>: Monitor Kubernetes clusters.</li>
<li><strong>EFK Stack</strong>: Collect and analyze logs.</li>
<li><strong>Falco</strong>: Monitor runtime security.</li>
</ul>
</div><h2>Practical Example: Setting Up Falco</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbnN0YWxsIEZhbGNvCmN1cmwgLXMgaHR0cHM6Ly9mYWxjby5vcmcvcmVwby9mYWxjb3NlY3VyaXR5LXBhY2thZ2VzLmFzYyB8IHN1ZG8gYXB0LWtleSBhZGQgLQpzdWRvIGFwdC1nZXQgdXBkYXRlCnN1ZG8gYXB0LWdldCBpbnN0YWxsIC15IGZhbGNvCgojIFN0YXJ0IEZhbGNvCnN1ZG8gc3lzdGVtY3RsIHN0YXJ0IGZhbGNv"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Install Falco
curl -s https://falco.org/repo/falcosecurity-packages.asc | sudo apt-key add -
sudo apt-get update
sudo apt-get install -y falco

# Start Falco
sudo systemctl start falco</pre></div><div class='content'></div><h2>Exercise: Create a Falco Rule</h2>
<div class='content'><ol>
<li>
<p><strong>Create a Falco rule file</strong>:</p>
<pre><code class="language-yaml">- rule: Write below etc
  desc: Detect any write below /etc
  condition: evt.type = write and fd.name startswith /etc
  output: &quot;Write below /etc detected (user=%user.name command=%proc.cmdline file=%fd.name)&quot;
  priority: WARNING
</code></pre>
</li>
<li>
<p><strong>Apply the Falco rule</strong>:</p>
<pre><code class="language-bash">sudo cp falco-rules.yaml /etc/falco/falco_rules.local.yaml
sudo systemctl restart falco
</code></pre>
</li>
</ol>
</div><h1>Conclusion</h1>
<div class='content'><p>In this module, you have learned about the key areas of focus for the Certified Kubernetes Security Specialist (CKS) certification. You have explored practical examples and exercises to help you understand and apply security best practices in Kubernetes. By mastering these concepts, you will be well-prepared to secure Kubernetes clusters and applications, and to pass the CKS exam.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='12-02-ckad' title="Certified Kubernetes Application Developer (CKAD)">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='12-04-exam-preparation-tips' title="Exam Preparation Tips">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			









		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
