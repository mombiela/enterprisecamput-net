<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 7: Advanced Topics</title>

    <link rel="alternate" href="https://campusempresa.com/mod/python/7-3-context-managers" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/python/7-3-context-managers" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/python/7-3-context-managers" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/python/7-3-context-managers" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/python/7-3-context-managers" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='7-2-generators'>&#x25C4;Generators</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Module 7: Advanced Topics</a>
	</div>
	<div class='col-4 text-end'>
					<a href='7-4-regular-expressions'>Regular Expressions &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>7-3: Context Managers</h1>
<div class='content'></div><h2>Introduction to Context Managers</h2>
<div class='content'><p>Context managers in Python are a way to allocate and release resources precisely when you want to. The most common use of context managers is with the <code>with</code> statement, which ensures that resources are properly managed. For example, when working with files, context managers help ensure that files are properly closed after their suite finishes, even if an exception is raised.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ol>
<li>
<p><strong>Context Manager Protocol</strong>:</p>
<ul>
<li><code>__enter__()</code>: This method is executed when the execution flow enters the context of the <code>with</code> statement.</li>
<li><code>__exit__(exc_type, exc_value, traceback)</code>: This method is executed when the execution flow exits the context of the <code>with</code> statement. It can handle exceptions if they occur.</li>
</ul>
</li>
<li>
<p><strong>The <code>with</code> Statement</strong>:</p>
<ul>
<li>Simplifies resource management.</li>
<li>Ensures that resources are cleaned up promptly.</li>
</ul>
</li>
</ol>
</div><h2>Practical Example</h2>
<div class='content'><h4>Using a Context Manager with Files</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBVc2luZyBhIGNvbnRleHQgbWFuYWdlciB0byBvcGVuIGFuZCByZWFkIGEgZmlsZQp3aXRoIG9wZW4oJ2V4YW1wbGUudHh0JywgJ3InKSBhcyBmaWxlOgogICAgY29udGVudCA9IGZpbGUucmVhZCgpCiAgICBwcmludChjb250ZW50KQojIE5vIG5lZWQgdG8gZXhwbGljaXRseSBjbG9zZSB0aGUgZmlsZSwgaXQncyBkb25lIGF1dG9tYXRpY2FsbHk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Using a context manager to open and read a file
with open('example.txt', 'r') as file:
    content = file.read()
    print(content)
# No need to explicitly close the file, it's done automatically</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The <code>with</code> statement calls <code>open('example.txt', 'r')</code> and binds the returned file object to <code>file</code>.</li>
<li>The <code>__enter__()</code> method is called, which opens the file.</li>
<li>The file is read inside the block.</li>
<li>When the block is exited, the <code>__exit__()</code> method is called, which closes the file.</li>
</ul>
</div><h2>Creating Custom Context Managers</h2>
<div class='content'><p>You can create your own context managers by defining a class with <code>__enter__</code> and <code>__exit__</code> methods.</p>
<h4>Example: Custom Context Manager</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgQ3VzdG9tQ29udGV4dE1hbmFnZXI6CiAgICBkZWYgX19lbnRlcl9fKHNlbGYpOgogICAgICAgIHByaW50KCJFbnRlcmluZyB0aGUgY29udGV4dCIpCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19leGl0X18oc2VsZiwgZXhjX3R5cGUsIGV4Y192YWx1ZSwgdHJhY2ViYWNrKToKICAgICAgICBwcmludCgiRXhpdGluZyB0aGUgY29udGV4dCIpCiAgICAgICAgaWYgZXhjX3R5cGU6CiAgICAgICAgICAgIHByaW50KGYiQW4gZXhjZXB0aW9uIG9jY3VycmVkOiB7ZXhjX3ZhbHVlfSIpCiAgICAgICAgcmV0dXJuIFRydWUgICMgU3VwcHJlc3MgdGhlIGV4Y2VwdGlvbgoKIyBVc2luZyB0aGUgY3VzdG9tIGNvbnRleHQgbWFuYWdlcgp3aXRoIEN1c3RvbUNvbnRleHRNYW5hZ2VyKCkgYXMgbWFuYWdlcjoKICAgIHByaW50KCJJbnNpZGUgdGhlIGNvbnRleHQiKQogICAgcmFpc2UgVmFsdWVFcnJvcigiQW4gZXJyb3Igb2NjdXJyZWQiKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class CustomContextManager:
    def __enter__(self):
        print(&quot;Entering the context&quot;)
        return self

    def __exit__(self, exc_type, exc_value, traceback):
        print(&quot;Exiting the context&quot;)
        if exc_type:
            print(f&quot;An exception occurred: {exc_value}&quot;)
        return True  # Suppress the exception

# Using the custom context manager
with CustomContextManager() as manager:
    print(&quot;Inside the context&quot;)
    raise ValueError(&quot;An error occurred&quot;)</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>__enter__</code> method prints a message and returns <code>self</code>.</li>
<li><code>__exit__</code> method prints a message and handles any exceptions that occur within the context.</li>
<li>The <code>with</code> statement ensures that <code>__enter__</code> and <code>__exit__</code> are called at the appropriate times.</li>
</ul>
</div><h2>Contextlib Module</h2>
<div class='content'><p>The <code>contextlib</code> module provides utilities for working with context managers.</p>
<h4>Example: Using <code>contextlib.contextmanager</code></h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBjb250ZXh0bGliIGltcG9ydCBjb250ZXh0bWFuYWdlcgoKQGNvbnRleHRtYW5hZ2VyCmRlZiBjdXN0b21fY29udGV4dCgpOgogICAgcHJpbnQoIkVudGVyaW5nIHRoZSBjb250ZXh0IikKICAgIHRyeToKICAgICAgICB5aWVsZAogICAgZmluYWxseToKICAgICAgICBwcmludCgiRXhpdGluZyB0aGUgY29udGV4dCIpCgojIFVzaW5nIHRoZSBjdXN0b20gY29udGV4dCBtYW5hZ2VyCndpdGggY3VzdG9tX2NvbnRleHQoKToKICAgIHByaW50KCJJbnNpZGUgdGhlIGNvbnRleHQiKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from contextlib import contextmanager

@contextmanager
def custom_context():
    print(&quot;Entering the context&quot;)
    try:
        yield
    finally:
        print(&quot;Exiting the context&quot;)

# Using the custom context manager
with custom_context():
    print(&quot;Inside the context&quot;)</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The <code>@contextmanager</code> decorator simplifies the creation of context managers.</li>
<li>The <code>yield</code> statement is used to define the point where the context block is executed.</li>
<li>The code before <code>yield</code> runs when entering the context, and the code after <code>yield</code> runs when exiting the context.</li>
</ul>
</div><h2>Practical Exercises</h2>
<div class='content'><h4>Exercise 1: File Handling with Context Managers</h4>
<p><strong>Task</strong>: Write a script that reads from a file named <code>data.txt</code> and prints its contents using a context manager.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("d2l0aCBvcGVuKCdkYXRhLnR4dCcsICdyJykgYXMgZmlsZToKICAgIGNvbnRlbnQgPSBmaWxlLnJlYWQoKQogICAgcHJpbnQoY29udGVudCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>with open('data.txt', 'r') as file:
    content = file.read()
    print(content)</pre></div><div class='content'><h4>Exercise 2: Custom Context Manager</h4>
<p><strong>Task</strong>: Create a custom context manager that prints &quot;Start&quot; when entering the context and &quot;End&quot; when exiting the context.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgU2ltcGxlQ29udGV4dE1hbmFnZXI6CiAgICBkZWYgX19lbnRlcl9fKHNlbGYpOgogICAgICAgIHByaW50KCJTdGFydCIpCiAgICAgICAgcmV0dXJuIHNlbGYKCiAgICBkZWYgX19leGl0X18oc2VsZiwgZXhjX3R5cGUsIGV4Y192YWx1ZSwgdHJhY2ViYWNrKToKICAgICAgICBwcmludCgiRW5kIikKCndpdGggU2ltcGxlQ29udGV4dE1hbmFnZXIoKToKICAgIHByaW50KCJJbnNpZGUgdGhlIGNvbnRleHQiKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class SimpleContextManager:
    def __enter__(self):
        print(&quot;Start&quot;)
        return self

    def __exit__(self, exc_type, exc_value, traceback):
        print(&quot;End&quot;)

with SimpleContextManager():
    print(&quot;Inside the context&quot;)</pre></div><div class='content'></div><h2>Common Mistakes and Tips</h2>
<div class='content'><ul>
<li><strong>Forgetting to Close Resources</strong>: Always use context managers to ensure resources are properly closed.</li>
<li><strong>Suppressing Exceptions</strong>: Be cautious when returning <code>True</code> in <code>__exit__</code> as it suppresses exceptions. Only do this if you are sure you want to handle the exception within the context manager.</li>
</ul>
</div><h2>Conclusion</h2>
<div class='content'><p>Context managers are a powerful feature in Python that help manage resources efficiently and safely. By using the <code>with</code> statement and implementing the context manager protocol, you can ensure that resources are properly acquired and released. The <code>contextlib</code> module further simplifies the creation of context managers, making your code cleaner and more readable.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='7-2-generators'>&#x25C4;Generators</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Module 7: Advanced Topics</a>
	</div>
	<div class='col-4 text-end'>
					<a href='7-4-regular-expressions'>Regular Expressions &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
