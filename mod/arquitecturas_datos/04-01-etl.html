<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ETL (Extract, Transform, Load)</title>

    <link rel="alternate" href="https://campusempresa.com/mod/arquitecturas_datos/04-01-etl" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/arquitecturas_datos/04-01-etl" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/arquitecturas_datos/04-01-etl" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/arquitecturas_datos/04-01-etl" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/arquitecturas_datos/04-01-etl" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='03-04-integration' title="Data Integration">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">ETL (Extract, Transform, Load)</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='04-02-real-time-vs-batch' title="Real-Time vs Batch Processing">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>ETL stands for Extract, Transform, Load, which is a fundamental process in data warehousing and data integration. It involves extracting data from various sources, transforming it into a suitable format, and loading it into a target database or data warehouse. This process is crucial for consolidating data from disparate sources, ensuring data quality, and making data ready for analysis.</p>
</div><h1>Key Concepts of ETL</h1>
<div class='content'></div><h2>1. Extract</h2>
<div class='content'><p>The extraction phase involves retrieving data from various sources. These sources can be:</p>
<ul>
<li><strong>Databases</strong>: SQL databases, NoSQL databases.</li>
<li><strong>Files</strong>: CSV, JSON, XML files.</li>
<li><strong>APIs</strong>: Web services, RESTful APIs.</li>
<li><strong>Other Sources</strong>: Spreadsheets, logs, etc.</li>
</ul>
</div><h2>2. Transform</h2>
<div class='content'><p>The transformation phase involves converting the extracted data into a format suitable for analysis. This can include:</p>
<ul>
<li><strong>Data Cleaning</strong>: Removing duplicates, handling missing values.</li>
<li><strong>Data Integration</strong>: Combining data from different sources.</li>
<li><strong>Data Aggregation</strong>: Summarizing data, calculating averages, totals.</li>
<li><strong>Data Enrichment</strong>: Adding additional information, such as geolocation data.</li>
</ul>
</div><h2>3. Load</h2>
<div class='content'><p>The loading phase involves inserting the transformed data into the target database or data warehouse. This can be done in:</p>
<ul>
<li><strong>Batch Mode</strong>: Loading large volumes of data at scheduled intervals.</li>
<li><strong>Real-Time Mode</strong>: Loading data continuously as it becomes available.</li>
</ul>
</div><h1>ETL Process Flow</h1>
<div class='content'><ol>
<li><strong>Extract Data</strong>: Connect to data sources and retrieve data.</li>
<li><strong>Transform Data</strong>: Apply necessary transformations to clean and integrate data.</li>
<li><strong>Load Data</strong>: Insert transformed data into the target system.</li>
</ol>
</div><h1>Practical Example</h1>
<div class='content'><p>Let's consider a simple ETL process using Python and the pandas library. We will extract data from a CSV file, transform it by cleaning and aggregating, and then load it into a SQLite database.</p>
</div><h2>Step 1: Extract Data</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHBhbmRhcyBhcyBwZAoKIyBFeHRyYWN0IGRhdGEgZnJvbSBDU1YgZmlsZQpkYXRhID0gcGQucmVhZF9jc3YoJ3NhbGVzX2RhdGEuY3N2JykKcHJpbnQoZGF0YS5oZWFkKCkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import pandas as pd

# Extract data from CSV file
data = pd.read_csv('sales_data.csv')
print(data.head())</pre></div><div class='content'></div><h2>Step 2: Transform Data</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEYXRhIENsZWFuaW5nOiBSZW1vdmUgcm93cyB3aXRoIG1pc3NpbmcgdmFsdWVzCmRhdGFfY2xlYW5lZCA9IGRhdGEuZHJvcG5hKCkKCiMgRGF0YSBBZ2dyZWdhdGlvbjogQ2FsY3VsYXRlIHRvdGFsIHNhbGVzIHBlciBwcm9kdWN0CmRhdGFfYWdncmVnYXRlZCA9IGRhdGFfY2xlYW5lZC5ncm91cGJ5KCdwcm9kdWN0X2lkJykuYWdnKHsnc2FsZXMnOiAnc3VtJ30pLnJlc2V0X2luZGV4KCkKcHJpbnQoZGF0YV9hZ2dyZWdhdGVkLmhlYWQoKSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Data Cleaning: Remove rows with missing values
data_cleaned = data.dropna()

# Data Aggregation: Calculate total sales per product
data_aggregated = data_cleaned.groupby('product_id').agg({'sales': 'sum'}).reset_index()
print(data_aggregated.head())</pre></div><div class='content'></div><h2>Step 3: Load Data</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHNxbGl0ZTMKCiMgQ29ubmVjdCB0byBTUUxpdGUgZGF0YWJhc2UgKG9yIGNyZWF0ZSBpdCkKY29ubiA9IHNxbGl0ZTMuY29ubmVjdCgnc2FsZXNfZGF0YS5kYicpCgojIExvYWQgZGF0YSBpbnRvIHRoZSBkYXRhYmFzZQpkYXRhX2FnZ3JlZ2F0ZWQudG9fc3FsKCdzYWxlc19zdW1tYXJ5JywgY29ubiwgaWZfZXhpc3RzPSdyZXBsYWNlJywgaW5kZXg9RmFsc2UpCgojIFZlcmlmeSBkYXRhIGlzIGxvYWRlZApsb2FkZWRfZGF0YSA9IHBkLnJlYWRfc3FsKCdTRUxFQ1QgKiBGUk9NIHNhbGVzX3N1bW1hcnknLCBjb25uKQpwcmludChsb2FkZWRfZGF0YS5oZWFkKCkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import sqlite3

# Connect to SQLite database (or create it)
conn = sqlite3.connect('sales_data.db')

# Load data into the database
data_aggregated.to_sql('sales_summary', conn, if_exists='replace', index=False)

# Verify data is loaded
loaded_data = pd.read_sql('SELECT * FROM sales_summary', conn)
print(loaded_data.head())</pre></div><div class='content'></div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Extract Data from JSON</h2>
<div class='content'><p><strong>Task</strong>: Extract data from a JSON file and display the first 5 rows.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHBhbmRhcyBhcyBwZAoKIyBFeHRyYWN0IGRhdGEgZnJvbSBKU09OIGZpbGUKZGF0YSA9IHBkLnJlYWRfanNvbignc2FsZXNfZGF0YS5qc29uJykKcHJpbnQoZGF0YS5oZWFkKCkp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import pandas as pd

# Extract data from JSON file
data = pd.read_json('sales_data.json')
print(data.head())</pre></div><div class='content'></div><h2>Exercise 2: Transform Data by Adding a New Column</h2>
<div class='content'><p><strong>Task</strong>: Add a new column 'total_price' by multiplying 'quantity' and 'price' columns.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBBZGQgYSBuZXcgY29sdW1uICd0b3RhbF9wcmljZScKZGF0YVsndG90YWxfcHJpY2UnXSA9IGRhdGFbJ3F1YW50aXR5J10gKiBkYXRhWydwcmljZSddCnByaW50KGRhdGEuaGVhZCgpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Add a new column 'total_price'
data['total_price'] = data['quantity'] * data['price']
print(data.head())</pre></div><div class='content'></div><h2>Exercise 3: Load Data into a PostgreSQL Database</h2>
<div class='content'><p><strong>Task</strong>: Load the transformed data into a PostgreSQL database.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBzcWxhbGNoZW15IGltcG9ydCBjcmVhdGVfZW5naW5lCgojIENyZWF0ZSBhIGNvbm5lY3Rpb24gdG8gUG9zdGdyZVNRTAplbmdpbmUgPSBjcmVhdGVfZW5naW5lKCdwb3N0Z3Jlc3FsOi8vdXNlcm5hbWU6cGFzc3dvcmRAbG9jYWxob3N0OjU0MzIvbXlkYXRhYmFzZScpCgojIExvYWQgZGF0YSBpbnRvIHRoZSBkYXRhYmFzZQpkYXRhLnRvX3NxbCgnc2FsZXNfZGF0YScsIGVuZ2luZSwgaWZfZXhpc3RzPSdyZXBsYWNlJywgaW5kZXg9RmFsc2UpCgojIFZlcmlmeSBkYXRhIGlzIGxvYWRlZApsb2FkZWRfZGF0YSA9IHBkLnJlYWRfc3FsKCdTRUxFQ1QgKiBGUk9NIHNhbGVzX2RhdGEnLCBlbmdpbmUpCnByaW50KGxvYWRlZF9kYXRhLmhlYWQoKSk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sqlalchemy import create_engine

# Create a connection to PostgreSQL
engine = create_engine('postgresql://username:password@localhost:5432/mydatabase')

# Load data into the database
data.to_sql('sales_data', engine, if_exists='replace', index=False)

# Verify data is loaded
loaded_data = pd.read_sql('SELECT * FROM sales_data', engine)
print(loaded_data.head())</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Handling Missing Values</strong>: Always check for and handle missing values during the transformation phase to avoid errors during loading.</li>
<li><strong>Data Types</strong>: Ensure that data types are consistent and appropriate for the target database schema.</li>
<li><strong>Performance Optimization</strong>: For large datasets, consider optimizing the extraction and loading processes to improve performance.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the ETL process, which is essential for data integration and preparation. We discussed the key concepts of extracting, transforming, and loading data, provided practical examples, and included exercises to reinforce the learning. Understanding ETL is crucial for building efficient data architectures that support robust data analysis and processing.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='03-04-integration' title="Data Integration">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='04-02-real-time-vs-batch' title="Real-Time vs Batch Processing">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
