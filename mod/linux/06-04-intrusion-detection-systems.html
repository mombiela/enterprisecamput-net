<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intrusion Detection Systems</title>

    <link rel="alternate" href="https://campusempresa.com/mod/linux/06-04-intrusion-detection-systems" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/linux/06-04-sistemes-de-deteccio-d-intrusions" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/linux/06-04-intrusion-detection-systems" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/linux/06-04-intrusion-detection-systems" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/linux/06-04-sistemes-de-deteccio-d-intrusions" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='06-03-ssh-and-remote-access' title="SSH and Remote Access">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Intrusion Detection Systems</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-05-securing-linux-systems' title="Securing Linux Systems">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Intrusion Detection Systems (IDS) are critical components in the security infrastructure of any Linux system. They help detect unauthorized access or anomalies that could indicate a security breach. This section will cover the basics of IDS, types of IDS, and how to implement and manage them on a Linux system.</p>
</div><h1><p>What is an Intrusion Detection System?</p>
</h1>
<div class='content'><p>An Intrusion Detection System (IDS) is a device or software application that monitors network or system activities for malicious activities or policy violations. Any detected activity or violation is typically reported to an administrator or collected centrally using a security information and event management (SIEM) system.</p>
</div><h2><p>Key Concepts:</p>
</h2>
<div class='content'><ul>
<li><strong>Detection</strong>: Identifying potential security breaches.</li>
<li><strong>Monitoring</strong>: Continuously observing network traffic or system activities.</li>
<li><strong>Alerting</strong>: Notifying administrators of suspicious activities.</li>
</ul>
</div><h1><p>Types of Intrusion Detection Systems</p>
</h1>
<div class='content'><p>IDS can be broadly classified into two categories:</p>
<ol>
<li>
<p><strong>Network-based Intrusion Detection System (NIDS)</strong>:</p>
<ul>
<li>Monitors network traffic for suspicious activity.</li>
<li>Typically deployed at strategic points within the network to monitor traffic to and from all devices on the network.</li>
<li>Examples: Snort, Suricata.</li>
</ul>
</li>
<li>
<p><strong>Host-based Intrusion Detection System (HIDS)</strong>:</p>
<ul>
<li>Monitors the activities on a single host for suspicious activity.</li>
<li>Typically installed on critical servers or endpoints.</li>
<li>Examples: OSSEC, Tripwire.</li>
</ul>
</li>
</ol>
</div><h2><p>Comparison Table:</p>
</h2>
<div class='content'><table>
<thead>
<tr>
<th>Feature</th>
<th>NIDS</th>
<th>HIDS</th>
</tr>
</thead>
<tbody>
<tr>
<td>Monitoring Scope</td>
<td>Network traffic</td>
<td>Host activities</td>
</tr>
<tr>
<td>Deployment Location</td>
<td>Network points (e.g., routers)</td>
<td>Individual hosts (e.g., servers)</td>
</tr>
<tr>
<td>Examples</td>
<td>Snort, Suricata</td>
<td>OSSEC, Tripwire</td>
</tr>
<tr>
<td>Resource Usage</td>
<td>Network bandwidth</td>
<td>Host resources (CPU, memory)</td>
</tr>
<tr>
<td>Detection Capabilities</td>
<td>Network-based attacks</td>
<td>Host-based attacks</td>
</tr>
</tbody>
</table>
</div><h1><p>Installing and Configuring Snort (NIDS)</p>
</h1>
<div class='content'><p>Snort is a popular open-source NIDS that can perform real-time traffic analysis and packet logging. Below are the steps to install and configure Snort on a Linux system.</p>
</div><h2><p>Installation:</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Update the package list</strong>:</p>
<pre><code class="language-bash">sudo apt-get update
</code></pre>
</li>
<li>
<p><strong>Install Snort</strong>:</p>
<pre><code class="language-bash">sudo apt-get install snort
</code></pre>
</li>
<li>
<p><strong>Verify the installation</strong>:</p>
<pre><code class="language-bash">snort -V
</code></pre>
</li>
</ol>
</div><h2><p>Configuration:</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Edit the Snort configuration file</strong>:</p>
<pre><code class="language-bash">sudo nano /etc/snort/snort.conf
</code></pre>
</li>
<li>
<p><strong>Set the network variables</strong>:</p>
<pre><code class="language-bash">var HOME_NET 192.168.1.0/24
var EXTERNAL_NET any
</code></pre>
</li>
<li>
<p><strong>Define the rules path</strong>:</p>
<pre><code class="language-bash">include $RULE_PATH/local.rules
</code></pre>
</li>
<li>
<p><strong>Create a local rules file</strong>:</p>
<pre><code class="language-bash">sudo nano /etc/snort/rules/local.rules
</code></pre>
</li>
<li>
<p><strong>Add a simple rule to detect ICMP traffic</strong>:</p>
<pre><code class="language-bash">alert icmp any any -&gt; $HOME_NET any (msg:&quot;ICMP Packet Detected&quot;; sid:1000001; rev:1;)
</code></pre>
</li>
<li>
<p><strong>Start Snort in NIDS mode</strong>:</p>
<pre><code class="language-bash">sudo snort -c /etc/snort/snort.conf -i eth0
</code></pre>
</li>
</ol>
</div><h1><p>Installing and Configuring OSSEC (HIDS)</p>
</h1>
<div class='content'><p>OSSEC is a powerful open-source HIDS that provides log analysis, integrity checking, rootkit detection, and real-time alerting.</p>
</div><h2><p>Installation:</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Download and install OSSEC</strong>:</p>
<pre><code class="language-bash">wget -q -O - https://updates.atomicorp.com/installers/atomic | sudo bash
sudo yum install ossec-hids
</code></pre>
</li>
<li>
<p><strong>Run the OSSEC setup script</strong>:</p>
<pre><code class="language-bash">sudo /var/ossec/bin/ossec-control start
</code></pre>
</li>
</ol>
</div><h2><p>Configuration:</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Edit the OSSEC configuration file</strong>:</p>
<pre><code class="language-bash">sudo nano /var/ossec/etc/ossec.conf
</code></pre>
</li>
<li>
<p><strong>Add a new rule for monitoring SSH login attempts</strong>:</p>
<pre><code class="language-xml">&lt;rule id=&quot;100001&quot; level=&quot;10&quot;&gt;
  &lt;decoded_as&gt;ssh&lt;/decoded_as&gt;
  &lt;description&gt;SSH login attempt&lt;/description&gt;
&lt;/rule&gt;
</code></pre>
</li>
<li>
<p><strong>Restart OSSEC to apply the changes</strong>:</p>
<pre><code class="language-bash">sudo /var/ossec/bin/ossec-control restart
</code></pre>
</li>
</ol>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Task:</p>
</h2>
<div class='content'><ol>
<li>Install and configure Snort on your Linux system.</li>
<li>Create a rule to detect HTTP traffic.</li>
<li>Install and configure OSSEC on your Linux system.</li>
<li>Create a rule to monitor changes to the <code>/etc/passwd</code> file.</li>
</ol>
</div><h2><p>Solution:</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Install and configure Snort</strong>:</p>
<ul>
<li>Follow the installation steps provided above.</li>
<li>Add the following rule to detect HTTP traffic:
<pre><code class="language-bash">alert tcp any any -&gt; $HOME_NET 80 (msg:&quot;HTTP Traffic Detected&quot;; sid:1000002; rev:1;)
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Install and configure OSSEC</strong>:</p>
<ul>
<li>Follow the installation steps provided above.</li>
<li>Add the following rule to monitor changes to the <code>/etc/passwd</code> file:
<pre><code class="language-xml">&lt;rule id=&quot;100002&quot; level=&quot;10&quot;&gt;
  &lt;decoded_as&gt;syscheck&lt;/decoded_as&gt;
  &lt;description&gt;Change to /etc/passwd&lt;/description&gt;
  &lt;match&gt;^/etc/passwd$&lt;/match&gt;
&lt;/rule&gt;
</code></pre>
</li>
</ul>
</li>
</ol>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Incorrect Configuration</strong>: Ensure that the configuration files for Snort and OSSEC are correctly edited and saved.</li>
<li><strong>Resource Management</strong>: Monitor the resource usage of IDS tools to avoid performance degradation.</li>
<li><strong>Regular Updates</strong>: Keep IDS rules and signatures updated to detect the latest threats.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this section, we covered the basics of Intrusion Detection Systems, the differences between NIDS and HIDS, and how to install and configure Snort and OSSEC on a Linux system. Understanding and implementing IDS is crucial for maintaining the security and integrity of your Linux environment. In the next section, we will delve into securing Linux systems, building on the knowledge gained here.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-03-ssh-and-remote-access' title="SSH and Remote Access">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-05-securing-linux-systems' title="Securing Linux Systems">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
