<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exploitation of Web Vulnerabilities</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pentesting/04-02-explotacion-web" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pentesting/04-02-explotacion-web" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pentesting/04-02-explotacion-web" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/pentesting/04-02-explotacion-web" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/pentesting/04-02-explotacion-web" class="px-2">CA</a>
					</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Course Content</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Technical Skills</a>
				<a href="/all/conocimientos">Knowledge</a>
				<a href="/all/soft_skills">Social Skills</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-01-introduccion-explotacion' title="Introduction to Exploitation">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Exploitation of Web Vulnerabilities</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-03-explotacion-red' title="Exploitation of Network Vulnerabilities">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this module, we will delve into the exploitation of web vulnerabilities. This is a critical area of penetration testing as web applications are often the most exposed part of an organization's infrastructure. Understanding how to identify and exploit these vulnerabilities is essential for any pentester.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Web Vulnerabilities Overview</strong></p>
<ul>
<li>Definition and importance</li>
<li>Common types of web vulnerabilities</li>
</ul>
</li>
<li>
<p><strong>Injection Attacks</strong></p>
<ul>
<li>SQL Injection</li>
<li>Command Injection</li>
</ul>
</li>
<li>
<p><strong>Cross-Site Scripting (XSS)</strong></p>
<ul>
<li>Stored XSS</li>
<li>Reflected XSS</li>
<li>DOM-based XSS</li>
</ul>
</li>
<li>
<p><strong>Cross-Site Request Forgery (CSRF)</strong></p>
<ul>
<li>Understanding CSRF</li>
<li>Exploiting CSRF</li>
</ul>
</li>
<li>
<p><strong>Insecure Direct Object References (IDOR)</strong></p>
<ul>
<li>Identifying IDOR</li>
<li>Exploiting IDOR</li>
</ul>
</li>
<li>
<p><strong>Security Misconfigurations</strong></p>
<ul>
<li>Common misconfigurations</li>
<li>Exploiting misconfigurations</li>
</ul>
</li>
</ol>
</div><h1><p>Web Vulnerabilities Overview</p>
</h1>
<div class='content'></div><h2><p>Definition and Importance</p>
</h2>
<div class='content'><p>Web vulnerabilities are weaknesses or flaws in web applications that can be exploited by attackers to gain unauthorized access, steal data, or perform other malicious activities. These vulnerabilities are critical because web applications are often publicly accessible and can be a gateway to an organization's internal network.</p>
</div><h2><p>Common Types of Web Vulnerabilities</p>
</h2>
<div class='content'><ul>
<li><strong>Injection Attacks</strong>: Occur when untrusted data is sent to an interpreter as part of a command or query.</li>
<li><strong>Cross-Site Scripting (XSS)</strong>: Allows attackers to inject malicious scripts into web pages viewed by other users.</li>
<li><strong>Cross-Site Request Forgery (CSRF)</strong>: Forces a user to execute unwanted actions on a web application in which they are authenticated.</li>
<li><strong>Insecure Direct Object References (IDOR)</strong>: Occurs when an application exposes a reference to an internal implementation object.</li>
<li><strong>Security Misconfigurations</strong>: Involve improper configuration of security settings in web applications.</li>
</ul>
</div><h1><p>Injection Attacks</p>
</h1>
<div class='content'></div><h2><p>SQL Injection</p>
</h2>
<div class='content'><p><strong>Explanation</strong>: SQL Injection occurs when an attacker can insert or manipulate SQL queries in an application's database.</p>
<p><strong>Example</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSB1c2VybmFtZSA9ICdhZG1pbicgQU5EIHBhc3N3b3JkID0gJ3Bhc3N3b3JkJzs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT * FROM users WHERE username = 'admin' AND password = 'password';</pre></div><div class='content'><p>If the application does not properly sanitize inputs, an attacker could input:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JyBPUiAnMSc9JzE="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>' OR '1'='1</pre></div><div class='content'><p>Resulting in the query:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSB1c2VybmFtZSA9ICdhZG1pbicgQU5EIHBhc3N3b3JkID0gJycgT1IgJzEnPScxJzs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT * FROM users WHERE username = 'admin' AND password = '' OR '1'='1';</pre></div><div class='content'><p>This query always returns true, potentially granting unauthorized access.</p>
<p><strong>Exercise</strong>:</p>
<ol>
<li>Identify a vulnerable SQL query in a sample web application.</li>
<li>Exploit the vulnerability to gain unauthorized access.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol>
<li>Locate the login form and input <code>' OR '1'='1</code> in the username or password field.</li>
<li>Observe if access is granted without valid credentials.</li>
</ol>
</div><h2><p>Command Injection</p>
</h2>
<div class='content'><p><strong>Explanation</strong>: Command Injection allows an attacker to execute arbitrary commands on the host operating system via a vulnerable application.</p>
<p><strong>Example</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJGNtZCA9ICRfR0VUWydjbWQnXTsKc3lzdGVtKCRjbWQpOwo/Pg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$cmd = $_GET['cmd'];
system($cmd);
?&gt;</pre></div><div class='content'><p>If an attacker inputs:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("OyBscyAtbGE="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>; ls -la</pre></div><div class='content'><p>The command <code>ls -la</code> will be executed on the server.</p>
<p><strong>Exercise</strong>:</p>
<ol>
<li>Identify a vulnerable command execution point in a sample web application.</li>
<li>Exploit the vulnerability to execute arbitrary commands.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol>
<li>Locate the input field that passes data to the <code>system</code> function.</li>
<li>Input <code>; ls -la</code> and observe the output.</li>
</ol>
</div><h1><p>Cross-Site Scripting (XSS)</p>
</h1>
<div class='content'></div><h2><p>Stored XSS</p>
</h2>
<div class='content'><p><strong>Explanation</strong>: Stored XSS occurs when malicious scripts are permanently stored on the target server, such as in a database.</p>
<p><strong>Example</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PHNjcmlwdD5hbGVydCgnWFNTJyk7PC9zY3JpcHQ+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;script&gt;alert('XSS');&lt;/script&gt;</pre></div><div class='content'><p>If this script is stored in a comment section, it will execute whenever the page is loaded.</p>
<p><strong>Exercise</strong>:</p>
<ol>
<li>Identify a vulnerable input field in a sample web application.</li>
<li>Inject a script and observe if it is executed when the page is loaded.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol>
<li>Locate the comment section and input <code>&lt;script&gt;alert('XSS');&lt;/script&gt;</code>.</li>
<li>Reload the page and observe if the alert box appears.</li>
</ol>
</div><h2><p>Reflected XSS</p>
</h2>
<div class='content'><p><strong>Explanation</strong>: Reflected XSS occurs when malicious scripts are reflected off a web application to the victim's browser.</p>
<p><strong>Example</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cDovL2V4YW1wbGUuY29tL3NlYXJjaD9xPTxzY3JpcHQ+YWxlcnQoJ1hTUycpOzwvc2NyaXB0Pg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http://example.com/search?q=&lt;script&gt;alert('XSS');&lt;/script&gt;</pre></div><div class='content'><p>If the application reflects the input without sanitization, the script will execute.</p>
<p><strong>Exercise</strong>:</p>
<ol>
<li>Identify a vulnerable search field in a sample web application.</li>
<li>Inject a script and observe if it is executed.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol>
<li>Locate the search field and input <code>&lt;script&gt;alert('XSS');&lt;/script&gt;</code>.</li>
<li>Observe if the alert box appears.</li>
</ol>
</div><h2><p>DOM-based XSS</p>
</h2>
<div class='content'><p><strong>Explanation</strong>: DOM-based XSS occurs when the vulnerability is in the client-side code rather than the server-side code.</p>
<p><strong>Example</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyIHVzZXJJbnB1dCA9IGxvY2F0aW9uLmhhc2g7CmRvY3VtZW50LndyaXRlKHVzZXJJbnB1dCk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var userInput = location.hash;
document.write(userInput);</pre></div><div class='content'><p>If the URL contains <code>#&lt;script&gt;alert('XSS');&lt;/script&gt;</code>, the script will execute.</p>
<p><strong>Exercise</strong>:</p>
<ol>
<li>Identify a vulnerable client-side script in a sample web application.</li>
<li>Inject a script and observe if it is executed.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol>
<li>Locate the client-side script and input <code>#&lt;script&gt;alert('XSS');&lt;/script&gt;</code> in the URL.</li>
<li>Observe if the alert box appears.</li>
</ol>
</div><h1><p>Cross-Site Request Forgery (CSRF)</p>
</h1>
<div class='content'></div><h2><p>Understanding CSRF</p>
</h2>
<div class='content'><p><strong>Explanation</strong>: CSRF forces a user to execute unwanted actions on a web application in which they are authenticated.</p>
<p><strong>Example</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGltZyBzcmM9Imh0dHA6Ly9leGFtcGxlLmNvbS90cmFuc2Zlcj9hbW91bnQ9MTAwMCZ0bz1hdHRhY2tlciIgLz4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;img src=&quot;http://example.com/transfer?amount=1000&amp;to=attacker&quot; /&gt;</pre></div><div class='content'><p>If the user is authenticated, the request will be executed.</p>
</div><h2><p>Exploiting CSRF</p>
</h2>
<div class='content'><p><strong>Exercise</strong>:</p>
<ol>
<li>Identify a vulnerable action in a sample web application.</li>
<li>Create a malicious request to exploit the vulnerability.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol>
<li>Locate the transfer money functionality.</li>
<li>Create an HTML page with an image tag pointing to the transfer URL with parameters.</li>
</ol>
</div><h1><p>Insecure Direct Object References (IDOR)</p>
</h1>
<div class='content'></div><h2><p>Identifying IDOR</p>
</h2>
<div class='content'><p><strong>Explanation</strong>: IDOR occurs when an application exposes a reference to an internal implementation object.</p>
<p><strong>Example</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cDovL2V4YW1wbGUuY29tL3VzZXI/aWQ9MTIz"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http://example.com/user?id=123</pre></div><div class='content'><p>If changing the <code>id</code> parameter to another user's ID grants access to their data, it is an IDOR vulnerability.</p>
</div><h2><p>Exploiting IDOR</p>
</h2>
<div class='content'><p><strong>Exercise</strong>:</p>
<ol>
<li>Identify a vulnerable endpoint in a sample web application.</li>
<li>Change the parameter to access unauthorized data.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol>
<li>Locate the user profile URL and change the <code>id</code> parameter to another user's ID.</li>
<li>Observe if access to another user's data is granted.</li>
</ol>
</div><h1><p>Security Misconfigurations</p>
</h1>
<div class='content'></div><h2><p>Common Misconfigurations</p>
</h2>
<div class='content'><p><strong>Explanation</strong>: Security misconfigurations involve improper configuration of security settings in web applications.</p>
<p><strong>Examples</strong>:</p>
<ul>
<li>Default credentials</li>
<li>Directory listing enabled</li>
<li>Verbose error messages</li>
</ul>
</div><h2><p>Exploiting Misconfigurations</p>
</h2>
<div class='content'><p><strong>Exercise</strong>:</p>
<ol>
<li>Identify a common misconfiguration in a sample web application.</li>
<li>Exploit the misconfiguration to gain unauthorized access.</li>
</ol>
<p><strong>Solution</strong>:</p>
<ol>
<li>Locate the admin panel with default credentials.</li>
<li>Log in using default credentials and observe if access is granted.</li>
</ol>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>In this module, we covered various types of web vulnerabilities, including injection attacks, XSS, CSRF, IDOR, and security misconfigurations. Understanding these vulnerabilities and how to exploit them is crucial for effective penetration testing. In the next module, we will explore the exploitation of network vulnerabilities.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-01-introduccion-explotacion' title="Introduction to Exploitation">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-03-explotacion-red' title="Exploitation of Network Vulnerabilities">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
