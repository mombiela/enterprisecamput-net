<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Covering Tracks</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pentesting/05-03-cobertura-de-huellas" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pentesting/05-03-cobertura-de-huellas" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pentesting/05-03-cobertura-de-huellas" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/pentesting/05-03-cobertura-de-huellas" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/pentesting/05-03-cobertura-de-huellas" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-mantenimiento-del-acceso' title="Maintaining Access">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Covering Tracks</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-01-documentacion-de-hallazgos' title="Documentation of Findings">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Covering tracks is a crucial phase in penetration testing, especially in scenarios where the pentester needs to ensure that their activities remain undetected. This phase involves removing or altering evidence of the pentester's presence and actions on the target system. While this practice is essential for ethical hackers to understand, it is also a technique used by malicious actors to avoid detection.</p>
</div><h1><p>Key Concepts</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Log Files</strong>:</p>
<ul>
<li>Log files record various activities on a system, including user logins, file access, and system errors.</li>
<li>Common log files include system logs, application logs, and security logs.</li>
</ul>
</li>
<li>
<p><strong>Log Manipulation</strong>:</p>
<ul>
<li>Deleting or altering log entries to remove traces of the pentester's activities.</li>
<li>Tools and commands can be used to edit or clear logs.</li>
</ul>
</li>
<li>
<p><strong>File and Process Hiding</strong>:</p>
<ul>
<li>Techniques to hide files and processes from system administrators and security tools.</li>
<li>Rootkits and other stealth tools can be used for this purpose.</li>
</ul>
</li>
<li>
<p><strong>Network Traffic Obfuscation</strong>:</p>
<ul>
<li>Techniques to disguise or encrypt network traffic to avoid detection by network monitoring tools.</li>
<li>Use of VPNs, proxies, and encrypted communication channels.</li>
</ul>
</li>
<li>
<p><strong>Clearing Command History</strong>:</p>
<ul>
<li>Removing or altering the command history to hide executed commands.</li>
<li>Commands like <code>history -c</code> in Linux can clear the command history.</li>
</ul>
</li>
</ol>
</div><h1><p>Practical Examples</p>
</h1>
<div class='content'></div><h2><p>Example 1: Clearing Log Files in Linux</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDbGVhciB0aGUgc3lzdGVtIGxvZyBmaWxlCnN1ZG8gdHJ1bmNhdGUgLXMgMCAvdmFyL2xvZy9zeXNsb2cKCiMgQ2xlYXIgdGhlIGF1dGhlbnRpY2F0aW9uIGxvZyBmaWxlCnN1ZG8gdHJ1bmNhdGUgLXMgMCAvdmFyL2xvZy9hdXRoLmxvZwoKIyBDbGVhciB0aGUgYmFzaCBoaXN0b3J5Cmhpc3RvcnkgLWM="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Clear the system log file
sudo truncate -s 0 /var/log/syslog

# Clear the authentication log file
sudo truncate -s 0 /var/log/auth.log

# Clear the bash history
history -c</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>truncate -s 0 /var/log/syslog</code>: This command sets the size of the syslog file to 0, effectively clearing its contents.</li>
<li><code>truncate -s 0 /var/log/auth.log</code>: Similarly, this command clears the authentication log file.</li>
<li><code>history -c</code>: This command clears the current user's bash command history.</li>
</ul>
</div><h2><p>Example 2: Hiding Files with Rootkits</p>
</h2>
<div class='content'><p><strong>Note</strong>: This example is for educational purposes only. Using rootkits can be illegal and unethical outside of a controlled and authorized environment.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbnN0YWxsIGEgcm9vdGtpdCAoZXhhbXBsZTogYHJrdGh1bnRlcmApCnN1ZG8gYXB0LWdldCBpbnN0YWxsIHJraHVudGVyCgojIFJ1biB0aGUgcm9vdGtpdCB0byBoaWRlIGZpbGVzCnN1ZG8gcmtodW50ZXIgLS1wcm9wdXBk"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Install a rootkit (example: `rkthunter`)
sudo apt-get install rkhunter

# Run the rootkit to hide files
sudo rkhunter --propupd</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>rkhunter</code>: Rootkit Hunter is a tool that scans for rootkits, but some rootkits can be used to hide files and processes.</li>
<li><code>--propupd</code>: This option updates the file properties database, which can be manipulated by a rootkit to hide files.</li>
</ul>
</div><h2><p>Example 3: Obfuscating Network Traffic</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBVc2UgYSBWUE4gdG8gZW5jcnlwdCBhbmQgb2JmdXNjYXRlIG5ldHdvcmsgdHJhZmZpYwpzdWRvIG9wZW52cG4gLS1jb25maWcgbXl2cG5jb25maWcub3Zwbg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Use a VPN to encrypt and obfuscate network traffic
sudo openvpn --config myvpnconfig.ovpn</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>openvpn --config myvpnconfig.ovpn</code>: This command starts an OpenVPN connection using the specified configuration file, encrypting the network traffic and making it harder to detect.</li>
</ul>
</div><h1><p>Practical Exercise</p>
</h1>
<div class='content'></div><h2><p>Exercise: Clear Specific Log Entries</p>
</h2>
<div class='content'><p><strong>Task</strong>: Write a script to clear specific log entries related to a user login event in the <code>/var/log/auth.log</code> file.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyEvYmluL2Jhc2gKCiMgRGVmaW5lIHRoZSB1c2VybmFtZSB0byBzZWFyY2ggZm9yClVTRVJOQU1FPSJ0YXJnZXR1c2VyIgoKIyBCYWNrdXAgdGhlIG9yaWdpbmFsIGxvZyBmaWxlCmNwIC92YXIvbG9nL2F1dGgubG9nIC92YXIvbG9nL2F1dGgubG9nLmJhawoKIyBSZW1vdmUgbG9nIGVudHJpZXMgcmVsYXRlZCB0byB0aGUgc3BlY2lmaWVkIHVzZXJuYW1lCmdyZXAgLXYgIiRVU0VSTkFNRSIgL3Zhci9sb2cvYXV0aC5sb2cuYmFrID4gL3Zhci9sb2cvYXV0aC5sb2cKCiMgQ2xlYXIgdGhlIGJhc2ggaGlzdG9yeQpoaXN0b3J5IC1jCgplY2hvICJMb2cgZW50cmllcyBmb3IgJFVTRVJOQU1FIGhhdmUgYmVlbiByZW1vdmVkLiI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#!/bin/bash

# Define the username to search for
USERNAME=&quot;targetuser&quot;

# Backup the original log file
cp /var/log/auth.log /var/log/auth.log.bak

# Remove log entries related to the specified username
grep -v &quot;$USERNAME&quot; /var/log/auth.log.bak &gt; /var/log/auth.log

# Clear the bash history
history -c

echo &quot;Log entries for $USERNAME have been removed.&quot;</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>USERNAME=&quot;targetuser&quot;</code>: Define the username whose log entries need to be removed.</li>
<li><code>cp /var/log/auth.log /var/log/auth.log.bak</code>: Backup the original log file.</li>
<li><code>grep -v &quot;$USERNAME&quot; /var/log/auth.log.bak &gt; /var/log/auth.log</code>: Use <code>grep -v</code> to filter out lines containing the username and write the result to the original log file.</li>
<li><code>history -c</code>: Clear the bash history to remove traces of the executed commands.</li>
</ul>
</div><h1><p>Common Mistakes and Tips</p>
</h1>
<div class='content'><ul>
<li>
<p><strong>Mistake</strong>: Forgetting to backup log files before modifying them.</p>
<ul>
<li><strong>Tip</strong>: Always create a backup of log files before making any changes to avoid accidental data loss.</li>
</ul>
</li>
<li>
<p><strong>Mistake</strong>: Clearing all logs indiscriminately.</p>
<ul>
<li><strong>Tip</strong>: Target specific log entries to avoid raising suspicion by completely emptying log files.</li>
</ul>
</li>
<li>
<p><strong>Mistake</strong>: Not considering the impact on system stability.</p>
<ul>
<li><strong>Tip</strong>: Ensure that the actions taken to cover tracks do not disrupt normal system operations.</li>
</ul>
</li>
</ul>
</div><h1><p>Conclusion</p>
</h1>
<div class='content'><p>Covering tracks is a critical skill for pentesters to understand, as it helps them simulate real-world attack scenarios where attackers attempt to remain undetected. By learning techniques such as log manipulation, file and process hiding, and network traffic obfuscation, pentesters can better understand the methods used by malicious actors and improve their defensive strategies. Always remember to practice these techniques ethically and within the bounds of the law.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-mantenimiento-del-acceso' title="Maintaining Access">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-01-documentacion-de-hallazgos' title="Documentation of Findings">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
