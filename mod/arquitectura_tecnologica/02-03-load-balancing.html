<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Load Balancing</title>

    <link rel="alternate" href="https://campusempresa.com/mod/arquitectura_tecnologica/02-03-balanceo-carga" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/arquitectura_tecnologica/02-03-balanceo-carga" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/arquitectura_tecnologica/02-03-load-balancing" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/arquitectura_tecnologica/02-03-balanceo-carga" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/arquitectura_tecnologica/02-03-balanceo-carga" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>All the knowledge within your reach</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					 				<a href="/"><i class="bi bi-house-fill"></i> HOME</a>
											</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='02-02-scalable-design-patterns' title="Scalable Design Patterns">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Load Balancing</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='02-04-cache-storage' title="Cache and In-Memory Storage">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Load balancing is a critical concept in designing scalable systems. It involves distributing incoming network traffic across multiple servers to ensure no single server becomes overwhelmed, thereby improving the overall performance and reliability of applications.</p>
</div><h1>Key Concepts of Load Balancing</h1>
<div class='content'><ol>
<li><strong>Definition</strong>: Load balancing is the process of distributing network or application traffic across multiple servers.</li>
<li><strong>Purpose</strong>: The main goals are to improve responsiveness, ensure availability, and provide redundancy.</li>
<li><strong>Types of Load Balancers</strong>:
<ul>
<li><strong>Hardware Load Balancers</strong>: Physical devices dedicated to load balancing.</li>
<li><strong>Software Load Balancers</strong>: Applications or services that perform load balancing.</li>
<li><strong>Cloud Load Balancers</strong>: Load balancing services provided by cloud platforms like AWS, Azure, and Google Cloud.</li>
</ul>
</li>
</ol>
</div><h1>Load Balancing Algorithms</h1>
<div class='content'><p>Different algorithms can be used to determine how traffic is distributed across servers:</p>
<ol>
<li><strong>Round Robin</strong>: Distributes requests sequentially to each server in a loop.</li>
<li><strong>Least Connections</strong>: Directs traffic to the server with the fewest active connections.</li>
<li><strong>IP Hash</strong>: Uses the client's IP address to determine which server receives the request.</li>
<li><strong>Weighted Round Robin</strong>: Similar to Round Robin but assigns more requests to servers with higher capacities.</li>
<li><strong>Random</strong>: Distributes requests randomly among servers.</li>
</ol>
</div><h2>Example: Round Robin Algorithm</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgUm91bmRSb2JpbkxvYWRCYWxhbmNlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzZXJ2ZXJzKToKICAgICAgICBzZWxmLnNlcnZlcnMgPSBzZXJ2ZXJzCiAgICAgICAgc2VsZi5pbmRleCA9IDAKCiAgICBkZWYgZ2V0X25leHRfc2VydmVyKHNlbGYpOgogICAgICAgIHNlcnZlciA9IHNlbGYuc2VydmVyc1tzZWxmLmluZGV4XQogICAgICAgIHNlbGYuaW5kZXggPSAoc2VsZi5pbmRleCArIDEpICUgbGVuKHNlbGYuc2VydmVycykKICAgICAgICByZXR1cm4gc2VydmVyCgojIEV4YW1wbGUgdXNhZ2UKc2VydmVycyA9IFsiU2VydmVyMSIsICJTZXJ2ZXIyIiwgIlNlcnZlcjMiXQpsb2FkX2JhbGFuY2VyID0gUm91bmRSb2JpbkxvYWRCYWxhbmNlcihzZXJ2ZXJzKQoKZm9yIF8gaW4gcmFuZ2UoNik6CiAgICBwcmludChsb2FkX2JhbGFuY2VyLmdldF9uZXh0X3NlcnZlcigpKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class RoundRobinLoadBalancer:
    def __init__(self, servers):
        self.servers = servers
        self.index = 0

    def get_next_server(self):
        server = self.servers[self.index]
        self.index = (self.index + 1) % len(self.servers)
        return server

# Example usage
servers = [&quot;Server1&quot;, &quot;Server2&quot;, &quot;Server3&quot;]
load_balancer = RoundRobinLoadBalancer(servers)

for _ in range(6):
    print(load_balancer.get_next_server())</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The <code>RoundRobinLoadBalancer</code> class initializes with a list of servers.</li>
<li>The <code>get_next_server</code> method returns the next server in the list and updates the index.</li>
<li>The example usage demonstrates distributing six requests across three servers.</li>
</ul>
</div><h1>Load Balancing Strategies</h1>
<div class='content'><ol>
<li><strong>Layer 4 (Transport Layer)</strong>: Balances traffic based on IP address and TCP/UDP ports.</li>
<li><strong>Layer 7 (Application Layer)</strong>: Balances traffic based on application-level data, such as HTTP headers.</li>
</ol>
</div><h2>Example: Layer 7 Load Balancing with NGINX</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICB1cHN0cmVhbSBiYWNrZW5kIHsKICAgICAgICBzZXJ2ZXIgYmFja2VuZDEuZXhhbXBsZS5jb207CiAgICAgICAgc2VydmVyIGJhY2tlbmQyLmV4YW1wbGUuY29tOwogICAgfQoKICAgIHNlcnZlciB7CiAgICAgICAgbGlzdGVuIDgwOwoKICAgICAgICBsb2NhdGlvbiAvIHsKICAgICAgICAgICAgcHJveHlfcGFzcyBodHRwOi8vYmFja2VuZDsKICAgICAgICB9CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    upstream backend {
        server backend1.example.com;
        server backend2.example.com;
    }

    server {
        listen 80;

        location / {
            proxy_pass http://backend;
        }
    }
}</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The <code>upstream</code> directive defines a group of servers (<code>backend1.example.com</code> and <code>backend2.example.com</code>).</li>
<li>The <code>server</code> block listens on port 80 and forwards requests to the <code>backend</code> group.</li>
</ul>
</div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Implement a Least Connections Load Balancer</h2>
<div class='content'><p><strong>Task</strong>: Write a Python class that implements a least connections load balancer.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgTGVhc3RDb25uZWN0aW9uc0xvYWRCYWxhbmNlcjoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBzZXJ2ZXJzKToKICAgICAgICBzZWxmLnNlcnZlcnMgPSB7c2VydmVyOiAwIGZvciBzZXJ2ZXIgaW4gc2VydmVyc30KCiAgICBkZWYgZ2V0X25leHRfc2VydmVyKHNlbGYpOgogICAgICAgIHNlcnZlciA9IG1pbihzZWxmLnNlcnZlcnMsIGtleT1zZWxmLnNlcnZlcnMuZ2V0KQogICAgICAgIHNlbGYuc2VydmVyc1tzZXJ2ZXJdICs9IDEKICAgICAgICByZXR1cm4gc2VydmVyCgogICAgZGVmIHJlbGVhc2Vfc2VydmVyKHNlbGYsIHNlcnZlcik6CiAgICAgICAgaWYgc2VsZi5zZXJ2ZXJzW3NlcnZlcl0gPiAwOgogICAgICAgICAgICBzZWxmLnNlcnZlcnNbc2VydmVyXSAtPSAxCgojIEV4YW1wbGUgdXNhZ2UKc2VydmVycyA9IFsiU2VydmVyMSIsICJTZXJ2ZXIyIiwgIlNlcnZlcjMiXQpsb2FkX2JhbGFuY2VyID0gTGVhc3RDb25uZWN0aW9uc0xvYWRCYWxhbmNlcihzZXJ2ZXJzKQoKIyBTaW11bGF0ZSByZXF1ZXN0cwpmb3IgXyBpbiByYW5nZSg2KToKICAgIHNlcnZlciA9IGxvYWRfYmFsYW5jZXIuZ2V0X25leHRfc2VydmVyKCkKICAgIHByaW50KGYiUmVxdWVzdCBzZW50IHRvIHtzZXJ2ZXJ9IikKCiMgU2ltdWxhdGUgcmVsZWFzaW5nIHNlcnZlcnMKbG9hZF9iYWxhbmNlci5yZWxlYXNlX3NlcnZlcigiU2VydmVyMSIpCmxvYWRfYmFsYW5jZXIucmVsZWFzZV9zZXJ2ZXIoIlNlcnZlcjIiKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class LeastConnectionsLoadBalancer:
    def __init__(self, servers):
        self.servers = {server: 0 for server in servers}

    def get_next_server(self):
        server = min(self.servers, key=self.servers.get)
        self.servers[server] += 1
        return server

    def release_server(self, server):
        if self.servers[server] &gt; 0:
            self.servers[server] -= 1

# Example usage
servers = [&quot;Server1&quot;, &quot;Server2&quot;, &quot;Server3&quot;]
load_balancer = LeastConnectionsLoadBalancer(servers)

# Simulate requests
for _ in range(6):
    server = load_balancer.get_next_server()
    print(f&quot;Request sent to {server}&quot;)

# Simulate releasing servers
load_balancer.release_server(&quot;Server1&quot;)
load_balancer.release_server(&quot;Server2&quot;)</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The <code>LeastConnectionsLoadBalancer</code> class initializes with a dictionary of servers and their connection counts.</li>
<li>The <code>get_next_server</code> method selects the server with the fewest connections.</li>
<li>The <code>release_server</code> method decreases the connection count for a given server.</li>
</ul>
</div><h2>Exercise 2: Configure a Basic Load Balancer with HAProxy</h2>
<div class='content'><p><strong>Task</strong>: Write a basic HAProxy configuration to load balance HTTP traffic across two backend servers.</p>
<p><strong>Solution</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2xvYmFsCiAgICBsb2cgL2Rldi9sb2cgbG9jYWwwCiAgICBsb2cgL2Rldi9sb2cgbG9jYWwxIG5vdGljZQogICAgY2hyb290IC92YXIvbGliL2hhcHJveHkKICAgIHN0YXRzIHNvY2tldCAvcnVuL2hhcHJveHkvYWRtaW4uc29jayBtb2RlIDY2MCBsZXZlbCBhZG1pbgogICAgc3RhdHMgdGltZW91dCAzMHMKICAgIHVzZXIgaGFwcm94eQogICAgZ3JvdXAgaGFwcm94eQogICAgZGFlbW9uCgpkZWZhdWx0cwogICAgbG9nIGdsb2JhbAogICAgbW9kZSBodHRwCiAgICBvcHRpb24gaHR0cGxvZwogICAgb3B0aW9uIGRvbnRsb2dudWxsCiAgICB0aW1lb3V0IGNvbm5lY3QgNTAwMAogICAgdGltZW91dCBjbGllbnQgIDUwMDAwCiAgICB0aW1lb3V0IHNlcnZlciAgNTAwMDAKCmZyb250ZW5kIGh0dHBfZnJvbnQKICAgIGJpbmQgKjo4MAogICAgZGVmYXVsdF9iYWNrZW5kIGh0dHBfYmFjawoKYmFja2VuZCBodHRwX2JhY2sKICAgIGJhbGFuY2Ugcm91bmRyb2JpbgogICAgc2VydmVyIHNlcnZlcjEgMTkyLjE2OC4xLjE6ODAgY2hlY2sKICAgIHNlcnZlciBzZXJ2ZXIyIDE5Mi4xNjguMS4yOjgwIGNoZWNr"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>global
    log /dev/log local0
    log /dev/log local1 notice
    chroot /var/lib/haproxy
    stats socket /run/haproxy/admin.sock mode 660 level admin
    stats timeout 30s
    user haproxy
    group haproxy
    daemon

defaults
    log global
    mode http
    option httplog
    option dontlognull
    timeout connect 5000
    timeout client  50000
    timeout server  50000

frontend http_front
    bind *:80
    default_backend http_back

backend http_back
    balance roundrobin
    server server1 192.168.1.1:80 check
    server server2 192.168.1.2:80 check</pre></div><div class='content'><p><strong>Explanation</strong>:</p>
<ul>
<li>The <code>frontend</code> section defines the entry point for HTTP traffic.</li>
<li>The <code>backend</code> section defines the servers to which traffic will be distributed using the Round Robin algorithm.</li>
</ul>
</div><h1>Common Mistakes and Tips</h1>
<div class='content'><ol>
<li><strong>Overloading a Single Server</strong>: Ensure the load balancing algorithm effectively distributes traffic to avoid overloading any single server.</li>
<li><strong>Health Checks</strong>: Regularly monitor server health to prevent sending traffic to unresponsive servers.</li>
<li><strong>Session Persistence</strong>: Use session persistence (sticky sessions) if necessary to ensure a user's session is consistently handled by the same server.</li>
</ol>
</div><h1>Conclusion</h1>
<div class='content'><p>Load balancing is essential for creating scalable and reliable systems. By understanding different load balancing algorithms and strategies, you can design systems that efficiently distribute traffic and handle high loads. Practice implementing and configuring load balancers to reinforce these concepts and ensure your systems are robust and performant.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='02-02-scalable-design-patterns' title="Scalable Design Patterns">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='02-04-cache-storage' title="Cache and In-Memory Storage">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			









		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
