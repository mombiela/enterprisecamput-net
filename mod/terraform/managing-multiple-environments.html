<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Managing Multiple Environments</title>

    <link rel="alternate" href="https://campusempresa.com/mod/terraform/managing-multiple-environments" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/terraform/managing-multiple-environments" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/terraform/managing-multiple-environments" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/mod/terraform/managing-multiple-environments" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/mod/terraform/managing-multiple-environments" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='terraform-workspaces'>&#x25C4;Terraform Workspaces</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Managing Multiple Environments</a>
	</div>
	<div class='col-4 text-end'>
					<a href='state-management-best-practices'>State Management Best Practices &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Managing multiple environments is a crucial aspect of infrastructure as code (IaC) with Terraform. This topic will guide you through the concepts, best practices, and practical steps to manage different environments such as development, staging, and production using Terraform.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Environment</strong>: A distinct configuration of infrastructure, typically representing different stages of the software development lifecycle (e.g., dev, staging, prod).</li>
<li><strong>Workspaces</strong>: Terraform feature that allows you to manage multiple states within a single configuration.</li>
<li><strong>State Files</strong>: Files where Terraform keeps track of the resources it manages.</li>
<li><strong>Variable Files</strong>: Files used to define environment-specific variables.</li>
</ul>
</div><h1>Setting Up Multiple Environments</h1>
<div class='content'></div><h2>Using Workspaces</h2>
<div class='content'><p>Terraform workspaces allow you to manage multiple states within a single configuration directory. Each workspace has its own state file.</p>
<h4>Creating and Switching Workspaces</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMaXN0IGFsbCB3b3Jrc3BhY2VzCnRlcnJhZm9ybSB3b3Jrc3BhY2UgbGlzdAoKIyBDcmVhdGUgYSBuZXcgd29ya3NwYWNlCnRlcnJhZm9ybSB3b3Jrc3BhY2UgbmV3IGRldgoKIyBTd2l0Y2ggdG8gYW4gZXhpc3Rpbmcgd29ya3NwYWNlCnRlcnJhZm9ybSB3b3Jrc3BhY2Ugc2VsZWN0IGRldg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># List all workspaces
terraform workspace list

# Create a new workspace
terraform workspace new dev

# Switch to an existing workspace
terraform workspace select dev</pre></div><div class='content'></div><h2>Using Separate Configuration Directories</h2>
<div class='content'><p>Another approach is to use separate directories for each environment. This method involves duplicating the configuration files for each environment.</p>
<h4>Directory Structure Example</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LgrilJzilIDilIAgZGV2CuKUgiAgIOKUnOKUgOKUgCBtYWluLnRmCuKUgiAgIOKUnOKUgOKUgCB2YXJpYWJsZXMudGYK4pSCICAg4pSU4pSA4pSAIHRlcnJhZm9ybS50ZnZhcnMK4pSc4pSA4pSAIHN0YWdpbmcK4pSCICAg4pSc4pSA4pSAIG1haW4udGYK4pSCICAg4pSc4pSA4pSAIHZhcmlhYmxlcy50ZgrilIIgICDilJTilIDilIAgdGVycmFmb3JtLnRmdmFycwrilJTilIDilIAgcHJvZAogICAg4pSc4pSA4pSAIG1haW4udGYKICAgIOKUnOKUgOKUgCB2YXJpYWJsZXMudGYKICAgIOKUlOKUgOKUgCB0ZXJyYWZvcm0udGZ2YXJz"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>.
├── dev
│   ├── main.tf
│   ├── variables.tf
│   └── terraform.tfvars
├── staging
│   ├── main.tf
│   ├── variables.tf
│   └── terraform.tfvars
└── prod
    ├── main.tf
    ├── variables.tf
    └── terraform.tfvars</pre></div><div class='content'></div><h2>Using Variable Files</h2>
<div class='content'><p>Variable files (<code>.tfvars</code>) allow you to define environment-specific variables. This approach can be combined with either workspaces or separate directories.</p>
<h4>Example Variable File (dev.tfvars)</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW5zdGFuY2VfdHlwZSA9ICJ0Mi5taWNybyIKcmVnaW9uICAgICAgICA9ICJ1cy13ZXN0LTEi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>instance_type = &quot;t2.micro&quot;
region        = &quot;us-west-1&quot;</pre></div><div class='content'><h4>Applying Configuration with Variable Files</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dGVycmFmb3JtIGFwcGx5IC12YXItZmlsZT0iZGV2LnRmdmFycyI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>terraform apply -var-file=&quot;dev.tfvars&quot;</pre></div><div class='content'></div><h1>Best Practices</h1>
<div class='content'><ul>
<li><strong>Consistent Naming</strong>: Use consistent naming conventions for resources across environments.</li>
<li><strong>Isolation</strong>: Ensure that environments are isolated to prevent unintended interactions.</li>
<li><strong>Version Control</strong>: Keep your Terraform configurations and state files under version control.</li>
<li><strong>Automation</strong>: Automate the deployment process using CI/CD pipelines.</li>
</ul>
</div><h1>Example: Managing Environments with Workspaces</h1>
<div class='content'></div><h2>Step-by-Step Guide</h2>
<div class='content'><ol>
<li>
<p><strong>Initialize Terraform</strong></p>
<pre><code class="language-bash">terraform init
</code></pre>
</li>
<li>
<p><strong>Create Workspaces</strong></p>
<pre><code class="language-bash">terraform workspace new dev
terraform workspace new staging
terraform workspace new prod
</code></pre>
</li>
<li>
<p><strong>Define Variables in <code>variables.tf</code></strong></p>
<pre><code class="language-hcl">variable &quot;instance_type&quot; {
  description = &quot;Type of instance to use&quot;
  type        = string
}

variable &quot;region&quot; {
  description = &quot;AWS region&quot;
  type        = string
}
</code></pre>
</li>
<li>
<p><strong>Create Environment-Specific Variable Files</strong></p>
<ul>
<li>
<p><code>dev.tfvars</code></p>
<pre><code class="language-hcl">instance_type = &quot;t2.micro&quot;
region        = &quot;us-west-1&quot;
</code></pre>
</li>
<li>
<p><code>staging.tfvars</code></p>
<pre><code class="language-hcl">instance_type = &quot;t2.small&quot;
region        = &quot;us-west-2&quot;
</code></pre>
</li>
<li>
<p><code>prod.tfvars</code></p>
<pre><code class="language-hcl">instance_type = &quot;t2.medium&quot;
region        = &quot;us-east-1&quot;
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Apply Configuration for Each Environment</strong></p>
<pre><code class="language-bash">terraform workspace select dev
terraform apply -var-file=&quot;dev.tfvars&quot;

terraform workspace select staging
terraform apply -var-file=&quot;staging.tfvars&quot;

terraform workspace select prod
terraform apply -var-file=&quot;prod.tfvars&quot;
</code></pre>
</li>
</ol>
</div><h1>Conclusion</h1>
<div class='content'><p>Managing multiple environments in Terraform can be efficiently handled using workspaces, separate configuration directories, and variable files. By following best practices and leveraging these tools, you can ensure that your infrastructure is consistent, isolated, and easy to manage across different stages of your development lifecycle.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='terraform-workspaces'>&#x25C4;Terraform Workspaces</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Managing Multiple Environments</a>
	</div>
	<div class='col-4 text-end'>
					<a href='state-management-best-practices'>State Management Best Practices &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
