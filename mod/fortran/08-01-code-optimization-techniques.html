<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Code Optimization Techniques</title>

    <link rel="alternate" href="https://campusempresa.com/mod/fortran/08-01-code-optimization-techniques" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/fortran/08-01-code-optimization-techniques" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/fortran/08-01-code-optimization-techniques" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo-header_enterprise.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<b id="lit_lang_es" class="px-2">EN</b>
	|
	<a href="https://campusempresa.com/mod/fortran/08-01-code-optimization-techniques" class="px-2">ES</a></b>
	|
	<a href="https://campusempresa.cat/mod/fortran/08-01-code-optimization-techniques" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>All the knowledge within your reach</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					 				<a href="/"><i class="bi bi-house-fill"></i> HOME</a>
											</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='07-04-interfacing-with-c' title="Interfacing with C">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Code Optimization Techniques</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-02-debugging-profiling' title="Debugging and Profiling">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>In this section, we will explore various techniques to optimize Fortran code for better performance and efficiency. Code optimization is crucial for scientific computing and high-performance applications where execution speed and resource utilization are critical.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ol>
<li>
<p><strong>Understanding Performance Bottlenecks</strong></p>
<ul>
<li>Identifying parts of the code that consume the most time or resources.</li>
<li>Using profiling tools to pinpoint inefficient code segments.</li>
</ul>
</li>
<li>
<p><strong>Efficient Use of Data Structures</strong></p>
<ul>
<li>Choosing the right data structures for the task.</li>
<li>Minimizing memory usage and access time.</li>
</ul>
</li>
<li>
<p><strong>Loop Optimization</strong></p>
<ul>
<li>Techniques to enhance loop performance.</li>
<li>Avoiding common pitfalls in loop constructs.</li>
</ul>
</li>
<li>
<p><strong>Inlining and Function Calls</strong></p>
<ul>
<li>Reducing the overhead of function calls.</li>
<li>Using inlining to improve performance.</li>
</ul>
</li>
<li>
<p><strong>Memory Management</strong></p>
<ul>
<li>Efficient allocation and deallocation of memory.</li>
<li>Minimizing memory fragmentation.</li>
</ul>
</li>
<li>
<p><strong>Parallelization</strong></p>
<ul>
<li>Utilizing parallel programming constructs.</li>
<li>Distributing workloads across multiple processors.</li>
</ul>
</li>
</ol>
</div><h1>Understanding Performance Bottlenecks</h1>
<div class='content'></div><h2>Profiling Tools</h2>
<div class='content'><p>Profiling tools help identify which parts of your code are the most time-consuming. Common tools for Fortran include:</p>
<ul>
<li><strong>gprof</strong>: A GNU profiler that can be used with Fortran programs.</li>
<li><strong>Intel VTune</strong>: A performance analysis tool that provides detailed insights into code performance.</li>
</ul>
</div><h2>Example: Using gprof</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2ZvcnRyYW4gLXBnIC1vIG15X3Byb2dyYW0gbXlfcHJvZ3JhbS5mOTAKLi9teV9wcm9ncmFtCmdwcm9mIG15X3Byb2dyYW0gZ21vbi5vdXQgPiBhbmFseXNpcy50eHQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gfortran -pg -o my_program my_program.f90
./my_program
gprof my_program gmon.out &gt; analysis.txt</pre></div><div class='content'><p>This sequence of commands compiles the Fortran program with profiling enabled, runs the program, and generates a profiling report.</p>
</div><h1>Efficient Use of Data Structures</h1>
<div class='content'></div><h2>Choosing the Right Data Structures</h2>
<div class='content'><ul>
<li><strong>Arrays</strong>: Use arrays for numerical computations where access patterns are predictable.</li>
<li><strong>Derived Types</strong>: Use derived types for complex data structures to improve readability and maintainability.</li>
</ul>
</div><h2>Example: Using Arrays Efficiently</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJvZ3JhbSBhcnJheV9leGFtcGxlCiAgaW1wbGljaXQgbm9uZQogIGludGVnZXIsIHBhcmFtZXRlciA6OiBuID0gMTAwMAogIHJlYWwgOjogYShuKSwgYihuKSwgYyhuKQogIGludGVnZXIgOjogaQoKICAhIEluaXRpYWxpemUgYXJyYXlzCiAgZG8gaSA9IDEsIG4KICAgIGEoaSkgPSBpICogMS4wCiAgICBiKGkpID0gKG4gLSBpKSAqIDEuMAogIGVuZCBkbwoKICAhIFZlY3Rvcml6ZWQgb3BlcmF0aW9uCiAgYyA9IGEgKyBiCgogIHByaW50ICosICdGaXJzdCBlbGVtZW50IG9mIGM6ICcsIGMoMSkKZW5kIHByb2dyYW0gYXJyYXlfZXhhbXBsZQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>program array_example
  implicit none
  integer, parameter :: n = 1000
  real :: a(n), b(n), c(n)
  integer :: i

  ! Initialize arrays
  do i = 1, n
    a(i) = i * 1.0
    b(i) = (n - i) * 1.0
  end do

  ! Vectorized operation
  c = a + b

  print *, 'First element of c: ', c(1)
end program array_example</pre></div><div class='content'></div><h1>Loop Optimization</h1>
<div class='content'></div><h2>Loop Unrolling</h2>
<div class='content'><p>Loop unrolling reduces the overhead of loop control by increasing the number of operations per iteration.</p>
</div><h2>Example: Loop Unrolling</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJvZ3JhbSBsb29wX3Vucm9sbGluZwogIGltcGxpY2l0IG5vbmUKICBpbnRlZ2VyLCBwYXJhbWV0ZXIgOjogbiA9IDEwMDAKICByZWFsIDo6IGEobiksIGIobikKICBpbnRlZ2VyIDo6IGkKCiAgISBJbml0aWFsaXplIGFycmF5cwogIGRvIGkgPSAxLCBuCiAgICBhKGkpID0gaSAqIDEuMAogIGVuZCBkbwoKICAhIFVucm9sbGVkIGxvb3AKICBkbyBpID0gMSwgbiwgNAogICAgYihpKSA9IGEoaSkgKiAyLjAKICAgIGlmIChpKzEgPD0gbikgYihpKzEpID0gYShpKzEpICogMi4wCiAgICBpZiAoaSsyIDw9IG4pIGIoaSsyKSA9IGEoaSsyKSAqIDIuMAogICAgaWYgKGkrMyA8PSBuKSBiKGkrMykgPSBhKGkrMykgKiAyLjAKICBlbmQgZG8KCiAgcHJpbnQgKiwgJ0ZpcnN0IGVsZW1lbnQgb2YgYjogJywgYigxKQplbmQgcHJvZ3JhbSBsb29wX3Vucm9sbGluZw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>program loop_unrolling
  implicit none
  integer, parameter :: n = 1000
  real :: a(n), b(n)
  integer :: i

  ! Initialize arrays
  do i = 1, n
    a(i) = i * 1.0
  end do

  ! Unrolled loop
  do i = 1, n, 4
    b(i) = a(i) * 2.0
    if (i+1 &lt;= n) b(i+1) = a(i+1) * 2.0
    if (i+2 &lt;= n) b(i+2) = a(i+2) * 2.0
    if (i+3 &lt;= n) b(i+3) = a(i+3) * 2.0
  end do

  print *, 'First element of b: ', b(1)
end program loop_unrolling</pre></div><div class='content'></div><h1>Inlining and Function Calls</h1>
<div class='content'></div><h2>Inlining Functions</h2>
<div class='content'><p>Inlining small functions can reduce the overhead of function calls.</p>
</div><h2>Example: Inlining</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kdWxlIGlubGluZV9leGFtcGxlCiAgaW1wbGljaXQgbm9uZQpjb250YWlucwogIHB1cmUgcmVhbCBmdW5jdGlvbiBzcXVhcmUoeCkKICAgIHJlYWwsIGludGVudChpbikgOjogeAogICAgc3F1YXJlID0geCAqIHgKICBlbmQgZnVuY3Rpb24gc3F1YXJlCmVuZCBtb2R1bGUgaW5saW5lX2V4YW1wbGUKCnByb2dyYW0gdGVzdF9pbmxpbmUKICB1c2UgaW5saW5lX2V4YW1wbGUKICBpbXBsaWNpdCBub25lCiAgcmVhbCA6OiBhLCByZXN1bHQKCiAgYSA9IDMuMAogIHJlc3VsdCA9IHNxdWFyZShhKQogIHByaW50ICosICdTcXVhcmUgb2YgJywgYSwgJyBpcyAnLCByZXN1bHQKZW5kIHByb2dyYW0gdGVzdF9pbmxpbmU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>module inline_example
  implicit none
contains
  pure real function square(x)
    real, intent(in) :: x
    square = x * x
  end function square
end module inline_example

program test_inline
  use inline_example
  implicit none
  real :: a, result

  a = 3.0
  result = square(a)
  print *, 'Square of ', a, ' is ', result
end program test_inline</pre></div><div class='content'></div><h1>Memory Management</h1>
<div class='content'></div><h2>Efficient Allocation</h2>
<div class='content'><p>Avoid frequent allocation and deallocation of memory. Use arrays with fixed sizes when possible.</p>
</div><h2>Example: Preallocating Arrays</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJvZ3JhbSBwcmVhbGxvY2F0ZV9leGFtcGxlCiAgaW1wbGljaXQgbm9uZQogIGludGVnZXIsIHBhcmFtZXRlciA6OiBuID0gMTAwMAogIHJlYWwsIGFsbG9jYXRhYmxlIDo6IGEoOikKICBpbnRlZ2VyIDo6IGkKCiAgYWxsb2NhdGUoYShuKSkKCiAgISBJbml0aWFsaXplIGFycmF5CiAgZG8gaSA9IDEsIG4KICAgIGEoaSkgPSBpICogMS4wCiAgZW5kIGRvCgogIHByaW50ICosICdGaXJzdCBlbGVtZW50IG9mIGE6ICcsIGEoMSkKICBkZWFsbG9jYXRlKGEpCmVuZCBwcm9ncmFtIHByZWFsbG9jYXRlX2V4YW1wbGU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>program preallocate_example
  implicit none
  integer, parameter :: n = 1000
  real, allocatable :: a(:)
  integer :: i

  allocate(a(n))

  ! Initialize array
  do i = 1, n
    a(i) = i * 1.0
  end do

  print *, 'First element of a: ', a(1)
  deallocate(a)
end program preallocate_example</pre></div><div class='content'></div><h1>Parallelization</h1>
<div class='content'></div><h2>Using Coarrays</h2>
<div class='content'><p>Coarrays allow parallel programming in Fortran by distributing data across multiple images (processors).</p>
</div><h2>Example: Coarray</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJvZ3JhbSBjb2FycmF5X2V4YW1wbGUKICBpbXBsaWNpdCBub25lCiAgaW50ZWdlciA6OiBtZSwgbgoKICBtZSA9IHRoaXNfaW1hZ2UoKQogIG4gPSBudW1faW1hZ2VzKCkKCiAgcHJpbnQgKiwgJ0hlbGxvIGZyb20gaW1hZ2UgJywgbWUsICcgb2YgJywgbgplbmQgcHJvZ3JhbSBjb2FycmF5X2V4YW1wbGU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>program coarray_example
  implicit none
  integer :: me, n

  me = this_image()
  n = num_images()

  print *, 'Hello from image ', me, ' of ', n
end program coarray_example</pre></div><div class='content'></div><h1>Practical Exercises</h1>
<div class='content'></div><h2>Exercise 1: Loop Optimization</h2>
<div class='content'><p>Optimize the following loop by unrolling it:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJvZ3JhbSBleGVyY2lzZTEKICBpbXBsaWNpdCBub25lCiAgaW50ZWdlciwgcGFyYW1ldGVyIDo6IG4gPSAxMDAwCiAgcmVhbCA6OiBhKG4pLCBiKG4pCiAgaW50ZWdlciA6OiBpCgogICEgSW5pdGlhbGl6ZSBhcnJheXMKICBkbyBpID0gMSwgbgogICAgYShpKSA9IGkgKiAxLjAKICBlbmQgZG8KCiAgISBPcmlnaW5hbCBsb29wCiAgZG8gaSA9IDEsIG4KICAgIGIoaSkgPSBhKGkpICogMi4wCiAgZW5kIGRvCgogIHByaW50ICosICdGaXJzdCBlbGVtZW50IG9mIGI6ICcsIGIoMSkKZW5kIHByb2dyYW0gZXhlcmNpc2Ux"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>program exercise1
  implicit none
  integer, parameter :: n = 1000
  real :: a(n), b(n)
  integer :: i

  ! Initialize arrays
  do i = 1, n
    a(i) = i * 1.0
  end do

  ! Original loop
  do i = 1, n
    b(i) = a(i) * 2.0
  end do

  print *, 'First element of b: ', b(1)
end program exercise1</pre></div><div class='content'></div><h2>Solution</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJvZ3JhbSBleGVyY2lzZTFfc29sdXRpb24KICBpbXBsaWNpdCBub25lCiAgaW50ZWdlciwgcGFyYW1ldGVyIDo6IG4gPSAxMDAwCiAgcmVhbCA6OiBhKG4pLCBiKG4pCiAgaW50ZWdlciA6OiBpCgogICEgSW5pdGlhbGl6ZSBhcnJheXMKICBkbyBpID0gMSwgbgogICAgYShpKSA9IGkgKiAxLjAKICBlbmQgZG8KCiAgISBVbnJvbGxlZCBsb29wCiAgZG8gaSA9IDEsIG4sIDQKICAgIGIoaSkgPSBhKGkpICogMi4wCiAgICBpZiAoaSsxIDw9IG4pIGIoaSsxKSA9IGEoaSsxKSAqIDIuMAogICAgaWYgKGkrMiA8PSBuKSBiKGkrMikgPSBhKGkrMikgKiAyLjAKICAgIGlmIChpKzMgPD0gbikgYihpKzMpID0gYShpKzMpICogMi4wCiAgZW5kIGRvCgogIHByaW50ICosICdGaXJzdCBlbGVtZW50IG9mIGI6ICcsIGIoMSkKZW5kIHByb2dyYW0gZXhlcmNpc2UxX3NvbHV0aW9u"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>program exercise1_solution
  implicit none
  integer, parameter :: n = 1000
  real :: a(n), b(n)
  integer :: i

  ! Initialize arrays
  do i = 1, n
    a(i) = i * 1.0
  end do

  ! Unrolled loop
  do i = 1, n, 4
    b(i) = a(i) * 2.0
    if (i+1 &lt;= n) b(i+1) = a(i+1) * 2.0
    if (i+2 &lt;= n) b(i+2) = a(i+2) * 2.0
    if (i+3 &lt;= n) b(i+3) = a(i+3) * 2.0
  end do

  print *, 'First element of b: ', b(1)
end program exercise1_solution</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we covered various techniques to optimize Fortran code, including identifying performance bottlenecks, efficient use of data structures, loop optimization, inlining functions, memory management, and parallelization. By applying these techniques, you can significantly improve the performance and efficiency of your Fortran programs. In the next section, we will delve into debugging and profiling to further enhance your code's reliability and performance.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='07-04-interfacing-with-c' title="Interfacing with C">
				<span class="d-none d-md-inline">&#x25C4; Previous</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-02-debugging-profiling' title="Debugging and Profiling">
				<span class="d-none d-md-inline">Next &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Advertising</h1>
<p>This space is reserved for advertising.</p>
<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>Thank you for collaborating!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			









		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">The Project</a> | 
<a href="/about">About Us</a> | 
<a href="/contribute">Contribute</a> | 
<a href="/donate">Donations</a> | 
<a href="/licence">License</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	We use cookies to improve your user experience and offer content tailored to your interests.
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
