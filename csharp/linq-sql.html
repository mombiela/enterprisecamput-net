<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LINQ to SQL</title>

    <link rel="alternate" href="https://campusempresa.com/csharp/linq-sql" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/csharp/linq-sql" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/csharp/linq-sql" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/csharp/linq-sql" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/csharp/linq-sql" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='linq-xml'>&#x25C4;LINQ to XML</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">LINQ to SQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-async'>Introduction to Asynchronous Programming &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to LINQ to SQL</h1>
<div class='content'><p>LINQ to SQL is a component of .NET Framework that provides a run-time infrastructure for managing relational data as objects. It allows you to query databases using LINQ (Language Integrated Query) syntax, which is more intuitive and readable compared to traditional SQL queries.</p>
<ul>
<li><strong>LINQ (Language Integrated Query)</strong>: A set of technologies based on the integration of query capabilities directly into the C# language.</li>
<li><strong>SQL (Structured Query Language)</strong>: A standard language for accessing and manipulating databases.</li>
</ul>
</div><h1>Setting Up LINQ to SQL</h1>
<div class='content'><p>Before diving into LINQ to SQL, you need to set up your environment.</p>
<ol>
<li><strong>Install Visual Studio</strong>: Ensure you have Visual Studio installed.</li>
<li><strong>Create a Database</strong>: Use SQL Server or any other compatible database.</li>
<li><strong>Add LINQ to SQL Classes</strong>: In Visual Studio, add a new LINQ to SQL Classes item to your project.</li>
</ol>
</div><h1>Basic LINQ to SQL Operations</h1>
<h2>Connecting to a Database</h2>
<div class='content'><p>To connect to a database, you need to create a DataContext object.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgU3lzdGVtOwp1c2luZyBTeXN0ZW0uTGlucTsKdXNpbmcgU3lzdGVtLkRhdGEuTGlucTsKCnB1YmxpYyBjbGFzcyBQcm9ncmFtCnsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBNYWluKCkKICAgIHsKICAgICAgICBzdHJpbmcgY29ubmVjdGlvblN0cmluZyA9IEAieW91cl9jb25uZWN0aW9uX3N0cmluZ19oZXJlIjsKICAgICAgICBEYXRhQ29udGV4dCBkYiA9IG5ldyBEYXRhQ29udGV4dChjb25uZWN0aW9uU3RyaW5nKTsKICAgICAgICAKICAgICAgICAvLyBZb3VyIGNvZGUgaGVyZQogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using System;
using System.Linq;
using System.Data.Linq;

public class Program
{
    public static void Main()
    {
        string connectionString = @&quot;your_connection_string_here&quot;;
        DataContext db = new DataContext(connectionString);
        
        // Your code here
    }
}</pre></div><div class='content'></div><h2>Querying Data</h2>
<div class='content'><p>You can query data using LINQ syntax.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyIHF1ZXJ5ID0gZnJvbSBjdXN0b21lciBpbiBkYi5HZXRUYWJsZTxDdXN0b21lcj4oKQogICAgICAgICAgICB3aGVyZSBjdXN0b21lci5DaXR5ID09ICJTZWF0dGxlIgogICAgICAgICAgICBzZWxlY3QgY3VzdG9tZXI7Cgpmb3JlYWNoICh2YXIgY3VzdG9tZXIgaW4gcXVlcnkpCnsKICAgIENvbnNvbGUuV3JpdGVMaW5lKGN1c3RvbWVyLk5hbWUpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var query = from customer in db.GetTable&lt;Customer&gt;()
            where customer.City == &quot;Seattle&quot;
            select customer;

foreach (var customer in query)
{
    Console.WriteLine(customer.Name);
}</pre></div><div class='content'></div><h2>Inserting Data</h2>
<div class='content'><p>To insert data into the database, create an object of the entity and insert it using the <code>InsertOnSubmit</code> method.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q3VzdG9tZXIgbmV3Q3VzdG9tZXIgPSBuZXcgQ3VzdG9tZXIKewogICAgTmFtZSA9ICJKb2huIERvZSIsCiAgICBDaXR5ID0gIk5ldyBZb3JrIgp9OwoKZGIuR2V0VGFibGU8Q3VzdG9tZXI+KCkuSW5zZXJ0T25TdWJtaXQobmV3Q3VzdG9tZXIpOwpkYi5TdWJtaXRDaGFuZ2VzKCk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Customer newCustomer = new Customer
{
    Name = &quot;John Doe&quot;,
    City = &quot;New York&quot;
};

db.GetTable&lt;Customer&gt;().InsertOnSubmit(newCustomer);
db.SubmitChanges();</pre></div><div class='content'></div><h2>Updating Data</h2>
<div class='content'><p>To update data, retrieve the object, modify it, and call <code>SubmitChanges</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyIGN1c3RvbWVyID0gZGIuR2V0VGFibGU8Q3VzdG9tZXI+KCkuRmlyc3QoYyA9PiBjLk5hbWUgPT0gIkpvaG4gRG9lIik7CmN1c3RvbWVyLkNpdHkgPSAiTG9zIEFuZ2VsZXMiOwpkYi5TdWJtaXRDaGFuZ2VzKCk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var customer = db.GetTable&lt;Customer&gt;().First(c =&gt; c.Name == &quot;John Doe&quot;);
customer.City = &quot;Los Angeles&quot;;
db.SubmitChanges();</pre></div><div class='content'></div><h2>Deleting Data</h2>
<div class='content'><p>To delete data, retrieve the object and use the <code>DeleteOnSubmit</code> method.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyIGN1c3RvbWVyID0gZGIuR2V0VGFibGU8Q3VzdG9tZXI+KCkuRmlyc3QoYyA9PiBjLk5hbWUgPT0gIkpvaG4gRG9lIik7CmRiLkdldFRhYmxlPEN1c3RvbWVyPigpLkRlbGV0ZU9uU3VibWl0KGN1c3RvbWVyKTsKZGIuU3VibWl0Q2hhbmdlcygpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var customer = db.GetTable&lt;Customer&gt;().First(c =&gt; c.Name == &quot;John Doe&quot;);
db.GetTable&lt;Customer&gt;().DeleteOnSubmit(customer);
db.SubmitChanges();</pre></div><div class='content'></div><h1>Advanced LINQ to SQL Features</h1>
<h2>Stored Procedures</h2>
<div class='content'><p>You can call stored procedures using LINQ to SQL.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyIHJlc3VsdCA9IGRiLkV4ZWN1dGVRdWVyeTxDdXN0b21lcj4oIkVYRUMgR2V0Q3VzdG9tZXJzQnlDaXR5IEBDaXR5PXswfSIsICJTZWF0dGxlIik7Cgpmb3JlYWNoICh2YXIgY3VzdG9tZXIgaW4gcmVzdWx0KQp7CiAgICBDb25zb2xlLldyaXRlTGluZShjdXN0b21lci5OYW1lKTsKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var result = db.ExecuteQuery&lt;Customer&gt;(&quot;EXEC GetCustomersByCity @City={0}&quot;, &quot;Seattle&quot;);

foreach (var customer in result)
{
    Console.WriteLine(customer.Name);
}</pre></div><div class='content'></div><h2>Transactions</h2>
<div class='content'><p>LINQ to SQL supports transactions to ensure data integrity.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgKHZhciB0cmFuc2FjdGlvbiA9IGRiLkNvbm5lY3Rpb24uQmVnaW5UcmFuc2FjdGlvbigpKQp7CiAgICB0cnkKICAgIHsKICAgICAgICBkYi5UcmFuc2FjdGlvbiA9IHRyYW5zYWN0aW9uOwoKICAgICAgICAvLyBQZXJmb3JtIG11bHRpcGxlIG9wZXJhdGlvbnMKICAgICAgICBkYi5TdWJtaXRDaGFuZ2VzKCk7CgogICAgICAgIHRyYW5zYWN0aW9uLkNvbW1pdCgpOwogICAgfQogICAgY2F0Y2gKICAgIHsKICAgICAgICB0cmFuc2FjdGlvbi5Sb2xsYmFjaygpOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using (var transaction = db.Connection.BeginTransaction())
{
    try
    {
        db.Transaction = transaction;

        // Perform multiple operations
        db.SubmitChanges();

        transaction.Commit();
    }
    catch
    {
        transaction.Rollback();
    }
}</pre></div><div class='content'></div><h2>Deferred Loading</h2>
<div class='content'><p>Deferred loading allows you to load related data only when it is accessed.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGF0YUxvYWRPcHRpb25zIG9wdGlvbnMgPSBuZXcgRGF0YUxvYWRPcHRpb25zKCk7Cm9wdGlvbnMuTG9hZFdpdGg8Q3VzdG9tZXI+KGMgPT4gYy5PcmRlcnMpOwpkYi5Mb2FkT3B0aW9ucyA9IG9wdGlvbnM7Cgp2YXIgY3VzdG9tZXJzID0gZGIuR2V0VGFibGU8Q3VzdG9tZXI+KCkuVG9MaXN0KCk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DataLoadOptions options = new DataLoadOptions();
options.LoadWith&lt;Customer&gt;(c =&gt; c.Orders);
db.LoadOptions = options;

var customers = db.GetTable&lt;Customer&gt;().ToList();</pre></div><div class='content'></div><h1>Performance Considerations</h1>
<div class='content'><ul>
<li><strong>Optimize Queries</strong>: Use projections to select only necessary fields.</li>
<li><strong>Batch Operations</strong>: Group multiple operations to reduce database round-trips.</li>
<li><strong>Indexing</strong>: Ensure proper indexing on database tables to speed up queries.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>LINQ to SQL simplifies database operations by allowing you to use C# syntax to interact with your database. It provides a more readable and maintainable way to perform CRUD operations and supports advanced features like stored procedures and transactions. By understanding and utilizing LINQ to SQL, you can write efficient and effective data access code in your C# applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='linq-xml'>&#x25C4;LINQ to XML</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">LINQ to SQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-async'>Introduction to Asynchronous Programming &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
