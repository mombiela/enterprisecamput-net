<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Async and Await in C#</title>

    <link rel="alternate" href="https://campusempresa.com/csharp/async-await" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/csharp/async-await" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/csharp/async-await" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/csharp/async-await" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/csharp/async-await" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='tasks-tpl'>&#x25C4;Tasks and Task Parallel Library (TPL)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Async and Await in C#</a>
	</div>
	<div class='col-4 text-end'>
					<a href='exceptions-async'>Handling Exceptions in Async Code &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Asynchronous programming is a form of parallel programming that allows a unit of work to run separately from the primary application thread. When the work is complete, it notifies the main thread. In C#, the <code>async</code> and <code>await</code> keywords are used to facilitate asynchronous programming.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Asynchronous Programming</strong>: Allows tasks to run in the background, improving the responsiveness of applications.</li>
<li><strong><code>async</code> Keyword</strong>: Marks a method as asynchronous.</li>
<li><strong><code>await</code> Keyword</strong>: Pauses the execution of an async method until the awaited task completes.</li>
<li><strong>Task</strong>: Represents an asynchronous operation.</li>
</ul>
</div><h1>Basic Usage</h1>
<div class='content'></div><h2>Defining an Async Method</h2>
<div class='content'><p>To define an asynchronous method, use the <code>async</code> keyword in the method signature.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2s8aW50PiBDYWxjdWxhdGVTdW1Bc3luYyhpbnQgYSwgaW50IGIpCnsKICAgIHJldHVybiBhd2FpdCBUYXNrLlJ1bigoKSA9PiBhICsgYik7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task&lt;int&gt; CalculateSumAsync(int a, int b)
{
    return await Task.Run(() =&gt; a + b);
}</pre></div><div class='content'></div><h2>Calling an Async Method</h2>
<div class='content'><p>When calling an async method, use the <code>await</code> keyword to wait for the task to complete.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2sgTWFpbkFzeW5jKCkKewogICAgaW50IHJlc3VsdCA9IGF3YWl0IENhbGN1bGF0ZVN1bUFzeW5jKDUsIDEwKTsKICAgIENvbnNvbGUuV3JpdGVMaW5lKHJlc3VsdCk7Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task MainAsync()
{
    int result = await CalculateSumAsync(5, 10);
    Console.WriteLine(result);
}</pre></div><div class='content'></div><h2>Example: Fetching Data from a Web API</h2>
<div class='content'><p>Here is a simple example of fetching data from a web API using <code>HttpClient</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2s8c3RyaW5nPiBGZXRjaERhdGFBc3luYyhzdHJpbmcgdXJsKQp7CiAgICB1c2luZyAoSHR0cENsaWVudCBjbGllbnQgPSBuZXcgSHR0cENsaWVudCgpKQogICAgewogICAgICAgIEh0dHBSZXNwb25zZU1lc3NhZ2UgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuR2V0QXN5bmModXJsKTsKICAgICAgICByZXNwb25zZS5FbnN1cmVTdWNjZXNzU3RhdHVzQ29kZSgpOwogICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5Db250ZW50LlJlYWRBc1N0cmluZ0FzeW5jKCk7CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task&lt;string&gt; FetchDataAsync(string url)
{
    using (HttpClient client = new HttpClient())
    {
        HttpResponseMessage response = await client.GetAsync(url);
        response.EnsureSuccessStatusCode();
        return await response.Content.ReadAsStringAsync();
    }
}</pre></div><div class='content'></div><h1>Advanced Usage</h1>
<div class='content'></div><h2>Handling Multiple Async Operations</h2>
<div class='content'><p>You can run multiple asynchronous operations concurrently using <code>Task.WhenAll</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2sgRmV0Y2hNdWx0aXBsZURhdGFBc3luYygpCnsKICAgIHZhciB0YXNrMSA9IEZldGNoRGF0YUFzeW5jKCJodHRwczovL2FwaS5leGFtcGxlLmNvbS9kYXRhMSIpOwogICAgdmFyIHRhc2syID0gRmV0Y2hEYXRhQXN5bmMoImh0dHBzOi8vYXBpLmV4YW1wbGUuY29tL2RhdGEyIik7CgogICAgYXdhaXQgVGFzay5XaGVuQWxsKHRhc2sxLCB0YXNrMik7CgogICAgQ29uc29sZS5Xcml0ZUxpbmUoYXdhaXQgdGFzazEpOwogICAgQ29uc29sZS5Xcml0ZUxpbmUoYXdhaXQgdGFzazIpOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task FetchMultipleDataAsync()
{
    var task1 = FetchDataAsync(&quot;https://api.example.com/data1&quot;);
    var task2 = FetchDataAsync(&quot;https://api.example.com/data2&quot;);

    await Task.WhenAll(task1, task2);

    Console.WriteLine(await task1);
    Console.WriteLine(await task2);
}</pre></div><div class='content'></div><h2>Error Handling in Async Methods</h2>
<div class='content'><p>Use try-catch blocks to handle exceptions in async methods.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2s8c3RyaW5nPiBGZXRjaERhdGFXaXRoRXJyb3JIYW5kbGluZ0FzeW5jKHN0cmluZyB1cmwpCnsKICAgIHRyeQogICAgewogICAgICAgIHVzaW5nIChIdHRwQ2xpZW50IGNsaWVudCA9IG5ldyBIdHRwQ2xpZW50KCkpCiAgICAgICAgewogICAgICAgICAgICBIdHRwUmVzcG9uc2VNZXNzYWdlIHJlc3BvbnNlID0gYXdhaXQgY2xpZW50LkdldEFzeW5jKHVybCk7CiAgICAgICAgICAgIHJlc3BvbnNlLkVuc3VyZVN1Y2Nlc3NTdGF0dXNDb2RlKCk7CiAgICAgICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5Db250ZW50LlJlYWRBc1N0cmluZ0FzeW5jKCk7CiAgICAgICAgfQogICAgfQogICAgY2F0Y2ggKEh0dHBSZXF1ZXN0RXhjZXB0aW9uIGUpCiAgICB7CiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoJCJSZXF1ZXN0IGVycm9yOiB7ZS5NZXNzYWdlfSIpOwogICAgICAgIHJldHVybiBudWxsOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task&lt;string&gt; FetchDataWithErrorHandlingAsync(string url)
{
    try
    {
        using (HttpClient client = new HttpClient())
        {
            HttpResponseMessage response = await client.GetAsync(url);
            response.EnsureSuccessStatusCode();
            return await response.Content.ReadAsStringAsync();
        }
    }
    catch (HttpRequestException e)
    {
        Console.WriteLine($&quot;Request error: {e.Message}&quot;);
        return null;
    }
}</pre></div><div class='content'></div><h2>Returning Values from Async Methods</h2>
<div class='content'><p>Async methods can return <code>Task</code>, <code>Task&lt;T&gt;</code>, or <code>void</code>. Use <code>Task&lt;T&gt;</code> when you need to return a value.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2s8aW50PiBHZXREYXRhTGVuZ3RoQXN5bmMoc3RyaW5nIHVybCkKewogICAgc3RyaW5nIGRhdGEgPSBhd2FpdCBGZXRjaERhdGFBc3luYyh1cmwpOwogICAgcmV0dXJuIGRhdGEuTGVuZ3RoOwp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task&lt;int&gt; GetDataLengthAsync(string url)
{
    string data = await FetchDataAsync(url);
    return data.Length;
}</pre></div><div class='content'></div><h1>Best Practices</h1>
<div class='content'><ul>
<li><strong>Avoid Blocking Calls</strong>: Do not use <code>.Result</code> or <code>.Wait()</code> on async methods as it blocks the calling thread.</li>
<li><strong>Use ConfigureAwait</strong>: Use <code>ConfigureAwait(false)</code> to avoid deadlocks in certain synchronization contexts, especially in UI applications.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2s8c3RyaW5nPiBGZXRjaERhdGFXaXRoQ29uZmlndXJlQXdhaXRBc3luYyhzdHJpbmcgdXJsKQp7CiAgICB1c2luZyAoSHR0cENsaWVudCBjbGllbnQgPSBuZXcgSHR0cENsaWVudCgpKQogICAgewogICAgICAgIEh0dHBSZXNwb25zZU1lc3NhZ2UgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuR2V0QXN5bmModXJsKS5Db25maWd1cmVBd2FpdChmYWxzZSk7CiAgICAgICAgcmVzcG9uc2UuRW5zdXJlU3VjY2Vzc1N0YXR1c0NvZGUoKTsKICAgICAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2UuQ29udGVudC5SZWFkQXNTdHJpbmdBc3luYygpLkNvbmZpZ3VyZUF3YWl0KGZhbHNlKTsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task&lt;string&gt; FetchDataWithConfigureAwaitAsync(string url)
{
    using (HttpClient client = new HttpClient())
    {
        HttpResponseMessage response = await client.GetAsync(url).ConfigureAwait(false);
        response.EnsureSuccessStatusCode();
        return await response.Content.ReadAsStringAsync().ConfigureAwait(false);
    }
}</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Asynchronous programming in C# using <code>async</code> and <code>await</code> helps create responsive applications by allowing tasks to run concurrently without blocking the main thread. By understanding and applying these concepts, you can significantly improve the performance and responsiveness of your applications. Remember to handle exceptions properly and follow best practices to avoid common pitfalls.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='tasks-tpl'>&#x25C4;Tasks and Task Parallel Library (TPL)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Async and Await in C#</a>
	</div>
	<div class='col-4 text-end'>
					<a href='exceptions-async'>Handling Exceptions in Async Code &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
