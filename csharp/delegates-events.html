<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delegates and Events in C#</title>

    <link rel="alternate" href="https://campusempresa.com/csharp/delegates-events" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/csharp/delegates-events" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/csharp/delegates-events" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/csharp/delegates-events" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/csharp/delegates-events" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='generics'>&#x25C4;Generics</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Delegates and Events in C#</a>
	</div>
	<div class='col-4 text-end'>
					<a href='lambda-expressions'>Lambda Expressions &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Delegates and events are fundamental concepts in C# that enable developers to write flexible and reusable code. This topic will guide you from the basics of delegates to the advanced usage of events.</p>
</div><h1>What are Delegates?</h1>
<div class='content'><p>Delegates are type-safe function pointers that allow methods to be passed as parameters. They are used to define callback methods and implement event handling.</p>
</div><h2>Key Concepts of Delegates</h2>
<div class='content'><ul>
<li><strong>Type-Safe</strong>: Delegates ensure that the method signature matches the delegate signature.</li>
<li><strong>Multicast</strong>: A delegate can hold references to multiple methods.</li>
<li><strong>Anonymous Methods and Lambda Expressions</strong>: Simplify the use of delegates.</li>
</ul>
</div><h2>Basic Syntax of Delegates</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRGVjbGFyZSBhIGRlbGVnYXRlCnB1YmxpYyBkZWxlZ2F0ZSB2b2lkIE15RGVsZWdhdGUoc3RyaW5nIG1lc3NhZ2UpOwoKLy8gTWV0aG9kIHRoYXQgbWF0Y2hlcyB0aGUgZGVsZWdhdGUgc2lnbmF0dXJlCnB1YmxpYyB2b2lkIFNob3dNZXNzYWdlKHN0cmluZyBtZXNzYWdlKQp7CiAgICBDb25zb2xlLldyaXRlTGluZShtZXNzYWdlKTsKfQoKLy8gVXNpbmcgdGhlIGRlbGVnYXRlCk15RGVsZWdhdGUgZGVsID0gU2hvd01lc3NhZ2U7CmRlbCgiSGVsbG8sIFdvcmxkISIpOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Declare a delegate
public delegate void MyDelegate(string message);

// Method that matches the delegate signature
public void ShowMessage(string message)
{
    Console.WriteLine(message);
}

// Using the delegate
MyDelegate del = ShowMessage;
del(&quot;Hello, World!&quot;);</pre></div><div class='content'></div><h2>Example: Using Delegates</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgU3lzdGVtOwoKcHVibGljIGRlbGVnYXRlIGludCBNYXRoT3BlcmF0aW9uKGludCB4LCBpbnQgeSk7CgpwdWJsaWMgY2xhc3MgUHJvZ3JhbQp7CiAgICBwdWJsaWMgc3RhdGljIGludCBBZGQoaW50IHgsIGludCB5KQogICAgewogICAgICAgIHJldHVybiB4ICsgeTsKICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIGludCBNdWx0aXBseShpbnQgeCwgaW50IHkpCiAgICB7CiAgICAgICAgcmV0dXJuIHggKiB5OwogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBNYWluKCkKICAgIHsKICAgICAgICBNYXRoT3BlcmF0aW9uIGFkZE9wZXJhdGlvbiA9IEFkZDsKICAgICAgICBNYXRoT3BlcmF0aW9uIG11bHRpcGx5T3BlcmF0aW9uID0gTXVsdGlwbHk7CgogICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKCJBZGRpdGlvbjogIiArIGFkZE9wZXJhdGlvbig1LCAzKSk7IC8vIE91dHB1dDogOAogICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKCJNdWx0aXBsaWNhdGlvbjogIiArIG11bHRpcGx5T3BlcmF0aW9uKDUsIDMpKTsgLy8gT3V0cHV0OiAxNQogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using System;

public delegate int MathOperation(int x, int y);

public class Program
{
    public static int Add(int x, int y)
    {
        return x + y;
    }

    public static int Multiply(int x, int y)
    {
        return x * y;
    }

    public static void Main()
    {
        MathOperation addOperation = Add;
        MathOperation multiplyOperation = Multiply;

        Console.WriteLine(&quot;Addition: &quot; + addOperation(5, 3)); // Output: 8
        Console.WriteLine(&quot;Multiplication: &quot; + multiplyOperation(5, 3)); // Output: 15
    }
}</pre></div><div class='content'></div><h1>What are Events?</h1>
<div class='content'><p>Events are a way for a class to notify other classes or objects when something of interest occurs. They are built on top of delegates and provide a more structured way to handle notifications.</p>
</div><h2>Key Concepts of Events</h2>
<div class='content'><ul>
<li><strong>Publisher-Subscriber Model</strong>: The class that sends the notification is called the publisher, and the classes that receive the notification are called subscribers.</li>
<li><strong>Event Handlers</strong>: Methods that handle the event, typically following the convention of <code>void MethodName(object sender, EventArgs e)</code>.</li>
</ul>
</div><h2>Basic Syntax of Events</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRGVjbGFyZSBhIGRlbGVnYXRlIGZvciB0aGUgZXZlbnQKcHVibGljIGRlbGVnYXRlIHZvaWQgTm90aWZ5RXZlbnRIYW5kbGVyKG9iamVjdCBzZW5kZXIsIEV2ZW50QXJncyBlKTsKCi8vIERlY2xhcmUgYW4gZXZlbnQgYmFzZWQgb24gdGhlIGRlbGVnYXRlCnB1YmxpYyBldmVudCBOb3RpZnlFdmVudEhhbmRsZXIgTm90aWZ5RXZlbnQ7CgovLyBNZXRob2QgdG8gcmFpc2UgdGhlIGV2ZW50CnByb3RlY3RlZCB2aXJ0dWFsIHZvaWQgT25Ob3RpZnlFdmVudCgpCnsKICAgIGlmIChOb3RpZnlFdmVudCAhPSBudWxsKQogICAgewogICAgICAgIE5vdGlmeUV2ZW50KHRoaXMsIEV2ZW50QXJncy5FbXB0eSk7CiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Declare a delegate for the event
public delegate void NotifyEventHandler(object sender, EventArgs e);

// Declare an event based on the delegate
public event NotifyEventHandler NotifyEvent;

// Method to raise the event
protected virtual void OnNotifyEvent()
{
    if (NotifyEvent != null)
    {
        NotifyEvent(this, EventArgs.Empty);
    }
}</pre></div><div class='content'></div><h2>Example: Using Events</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgU3lzdGVtOwoKcHVibGljIGNsYXNzIFB1Ymxpc2hlcgp7CiAgICAvLyBEZWNsYXJlIHRoZSBkZWxlZ2F0ZQogICAgcHVibGljIGRlbGVnYXRlIHZvaWQgTm90aWZ5RXZlbnRIYW5kbGVyKG9iamVjdCBzZW5kZXIsIEV2ZW50QXJncyBlKTsKCiAgICAvLyBEZWNsYXJlIHRoZSBldmVudAogICAgcHVibGljIGV2ZW50IE5vdGlmeUV2ZW50SGFuZGxlciBOb3RpZnlFdmVudDsKCiAgICAvLyBNZXRob2QgdG8gcmFpc2UgdGhlIGV2ZW50CiAgICBwdWJsaWMgdm9pZCBSYWlzZUV2ZW50KCkKICAgIHsKICAgICAgICBDb25zb2xlLldyaXRlTGluZSgiRXZlbnQgaXMgYWJvdXQgdG8gYmUgcmFpc2VkLiIpOwogICAgICAgIE9uTm90aWZ5RXZlbnQoKTsKICAgIH0KCiAgICBwcm90ZWN0ZWQgdmlydHVhbCB2b2lkIE9uTm90aWZ5RXZlbnQoKQogICAgewogICAgICAgIGlmIChOb3RpZnlFdmVudCAhPSBudWxsKQogICAgICAgIHsKICAgICAgICAgICAgTm90aWZ5RXZlbnQodGhpcywgRXZlbnRBcmdzLkVtcHR5KTsKICAgICAgICB9CiAgICB9Cn0KCnB1YmxpYyBjbGFzcyBTdWJzY3JpYmVyCnsKICAgIHB1YmxpYyB2b2lkIE9uTm90aWZ5RXZlbnQob2JqZWN0IHNlbmRlciwgRXZlbnRBcmdzIGUpCiAgICB7CiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoIkV2ZW50IHJlY2VpdmVkIGJ5IFN1YnNjcmliZXIuIik7CiAgICB9Cn0KCnB1YmxpYyBjbGFzcyBQcm9ncmFtCnsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBNYWluKCkKICAgIHsKICAgICAgICBQdWJsaXNoZXIgcHVibGlzaGVyID0gbmV3IFB1Ymxpc2hlcigpOwogICAgICAgIFN1YnNjcmliZXIgc3Vic2NyaWJlciA9IG5ldyBTdWJzY3JpYmVyKCk7CgogICAgICAgIC8vIFN1YnNjcmliZSB0byB0aGUgZXZlbnQKICAgICAgICBwdWJsaXNoZXIuTm90aWZ5RXZlbnQgKz0gc3Vic2NyaWJlci5Pbk5vdGlmeUV2ZW50OwoKICAgICAgICAvLyBSYWlzZSB0aGUgZXZlbnQKICAgICAgICBwdWJsaXNoZXIuUmFpc2VFdmVudCgpOwogICAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using System;

public class Publisher
{
    // Declare the delegate
    public delegate void NotifyEventHandler(object sender, EventArgs e);

    // Declare the event
    public event NotifyEventHandler NotifyEvent;

    // Method to raise the event
    public void RaiseEvent()
    {
        Console.WriteLine(&quot;Event is about to be raised.&quot;);
        OnNotifyEvent();
    }

    protected virtual void OnNotifyEvent()
    {
        if (NotifyEvent != null)
        {
            NotifyEvent(this, EventArgs.Empty);
        }
    }
}

public class Subscriber
{
    public void OnNotifyEvent(object sender, EventArgs e)
    {
        Console.WriteLine(&quot;Event received by Subscriber.&quot;);
    }
}

public class Program
{
    public static void Main()
    {
        Publisher publisher = new Publisher();
        Subscriber subscriber = new Subscriber();

        // Subscribe to the event
        publisher.NotifyEvent += subscriber.OnNotifyEvent;

        // Raise the event
        publisher.RaiseEvent();
    }
}</pre></div><div class='content'></div><h1>Advanced Usage of Delegates and Events</h1>
<div class='content'></div><h2>Multicast Delegates</h2>
<div class='content'><p>A multicast delegate can hold references to more than one method. When the delegate is invoked, all the methods it references are called.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGRlbGVnYXRlIHZvaWQgTXVsdGlEZWxlZ2F0ZSgpOwoKcHVibGljIGNsYXNzIFByb2dyYW0KewogICAgcHVibGljIHN0YXRpYyB2b2lkIE1ldGhvZDEoKQogICAgewogICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKCJNZXRob2QxIGNhbGxlZC4iKTsKICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgTWV0aG9kMigpCiAgICB7CiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoIk1ldGhvZDIgY2FsbGVkLiIpOwogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBNYWluKCkKICAgIHsKICAgICAgICBNdWx0aURlbGVnYXRlIGRlbCA9IE1ldGhvZDE7CiAgICAgICAgZGVsICs9IE1ldGhvZDI7CgogICAgICAgIGRlbCgpOyAvLyBPdXRwdXQ6IE1ldGhvZDEgY2FsbGVkLiBNZXRob2QyIGNhbGxlZC4KICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public delegate void MultiDelegate();

public class Program
{
    public static void Method1()
    {
        Console.WriteLine(&quot;Method1 called.&quot;);
    }

    public static void Method2()
    {
        Console.WriteLine(&quot;Method2 called.&quot;);
    }

    public static void Main()
    {
        MultiDelegate del = Method1;
        del += Method2;

        del(); // Output: Method1 called. Method2 called.
    }
}</pre></div><div class='content'></div><h2>Event Accessors</h2>
<div class='content'><p>Custom event accessors allow more control over how events are subscribed to and unsubscribed from.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIEN1c3RvbUV2ZW50CnsKICAgIHByaXZhdGUgRXZlbnRIYW5kbGVyIF9teUV2ZW50OwoKICAgIHB1YmxpYyBldmVudCBFdmVudEhhbmRsZXIgTXlFdmVudAogICAgewogICAgICAgIGFkZAogICAgICAgIHsKICAgICAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoIlN1YnNjcmliZXIgYWRkZWQuIik7CiAgICAgICAgICAgIF9teUV2ZW50ICs9IHZhbHVlOwogICAgICAgIH0KICAgICAgICByZW1vdmUKICAgICAgICB7CiAgICAgICAgICAgIENvbnNvbGUuV3JpdGVMaW5lKCJTdWJzY3JpYmVyIHJlbW92ZWQuIik7CiAgICAgICAgICAgIF9teUV2ZW50IC09IHZhbHVlOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgdm9pZCBSYWlzZUV2ZW50KCkKICAgIHsKICAgICAgICBfbXlFdmVudD8uSW52b2tlKHRoaXMsIEV2ZW50QXJncy5FbXB0eSk7CiAgICB9Cn0KCnB1YmxpYyBjbGFzcyBQcm9ncmFtCnsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBNYWluKCkKICAgIHsKICAgICAgICBDdXN0b21FdmVudCBjdXN0b21FdmVudCA9IG5ldyBDdXN0b21FdmVudCgpOwogICAgICAgIEV2ZW50SGFuZGxlciBoYW5kbGVyID0gKHNlbmRlciwgZSkgPT4gQ29uc29sZS5Xcml0ZUxpbmUoIkV2ZW50IGhhbmRsZWQuIik7CgogICAgICAgIGN1c3RvbUV2ZW50Lk15RXZlbnQgKz0gaGFuZGxlcjsKICAgICAgICBjdXN0b21FdmVudC5SYWlzZUV2ZW50KCk7CgogICAgICAgIGN1c3RvbUV2ZW50Lk15RXZlbnQgLT0gaGFuZGxlcjsKICAgIH0KfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class CustomEvent
{
    private EventHandler _myEvent;

    public event EventHandler MyEvent
    {
        add
        {
            Console.WriteLine(&quot;Subscriber added.&quot;);
            _myEvent += value;
        }
        remove
        {
            Console.WriteLine(&quot;Subscriber removed.&quot;);
            _myEvent -= value;
        }
    }

    public void RaiseEvent()
    {
        _myEvent?.Invoke(this, EventArgs.Empty);
    }
}

public class Program
{
    public static void Main()
    {
        CustomEvent customEvent = new CustomEvent();
        EventHandler handler = (sender, e) =&gt; Console.WriteLine(&quot;Event handled.&quot;);

        customEvent.MyEvent += handler;
        customEvent.RaiseEvent();

        customEvent.MyEvent -= handler;
    }
}</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Delegates and events are powerful features in C# that enable flexible and maintainable code. Delegates allow methods to be passed as parameters, while events provide a structured way to handle notifications between objects. Understanding these concepts is crucial for developing robust C# applications. Practice using delegates and events in various scenarios to become proficient in their usage.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='generics'>&#x25C4;Generics</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Delegates and Events in C#</a>
	</div>
	<div class='col-4 text-end'>
					<a href='lambda-expressions'>Lambda Expressions &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
