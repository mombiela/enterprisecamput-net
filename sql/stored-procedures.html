<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stored Procedures</title>

    <link rel="alternate" href="https://campusempresa.com/sql/stored-procedures" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/sql/stored-procedures" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/sql/stored-procedures" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/sql/stored-procedures" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/sql/stored-procedures" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='indexes'>&#x25C4;Indexes</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Stored Procedures</a>
	</div>
	<div class='col-4 text-end'>
					<a href='triggers'>Triggers &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Stored procedures are a powerful feature in SQL that allow you to encapsulate and reuse SQL code. They can help improve performance, maintainability, and security of your database operations. This section will guide you from the basics to advanced concepts of stored procedures.</p>
</div><h1>Introduction to Stored Procedures</h1>
<div class='content'><ul>
<li><strong>Definition</strong>: A stored procedure is a precompiled collection of one or more SQL statements stored on the database server.</li>
<li><strong>Benefits</strong>:
<ul>
<li><strong>Performance</strong>: Reduced network traffic and improved execution speed.</li>
<li><strong>Maintainability</strong>: Centralized logic that can be reused across multiple applications.</li>
<li><strong>Security</strong>: Controlled access to data through permission management.</li>
</ul>
</li>
</ul>
</div><h1>Creating Stored Procedures</h1>
<div class='content'></div><h2>Basic Syntax</h2>
<div class='content'><p>To create a stored procedure, you use the <code>CREATE PROCEDURE</code> statement followed by the procedure name and the SQL statements it contains.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSBwcm9jZWR1cmVfbmFtZQpBUwpCRUdJTgogICAgLS0gU1FMIHN0YXRlbWVudHMgZ28gaGVyZQpFTkQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE procedure_name
AS
BEGIN
    -- SQL statements go here
END;</pre></div><div class='content'></div><h2>Example: Simple Stored Procedure</h2>
<div class='content'><p>Let's create a simple stored procedure that retrieves all records from a <code>Customers</code> table.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSBHZXRBbGxDdXN0b21lcnMKQVMKQkVHSU4KICAgIFNFTEVDVCAqIEZST00gQ3VzdG9tZXJzOwpFTkQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE GetAllCustomers
AS
BEGIN
    SELECT * FROM Customers;
END;</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>CREATE PROCEDURE GetAllCustomers</code>: Defines a new stored procedure named <code>GetAllCustomers</code>.</li>
<li><code>AS BEGIN ... END;</code>: Encapsulates the SQL statements to be executed.</li>
</ul>
</li>
</ul>
</div><h1>Executing Stored Procedures</h1>
<div class='content'><p>To execute a stored procedure, you use the <code>EXEC</code> or <code>EXECUTE</code> statement.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBHZXRBbGxDdXN0b21lcnM7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC GetAllCustomers;</pre></div><div class='content'></div><h2>Example: Executing a Stored Procedure</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBHZXRBbGxDdXN0b21lcnM7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC GetAllCustomers;</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>EXEC GetAllCustomers;</code>: Executes the <code>GetAllCustomers</code> stored procedure, which retrieves all records from the <code>Customers</code> table.</li>
</ul>
</li>
</ul>
</div><h1>Parameters in Stored Procedures</h1>
<div class='content'><p>Stored procedures can accept parameters, allowing you to pass data into them.</p>
</div><h2>Syntax with Parameters</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSBwcm9jZWR1cmVfbmFtZQogICAgQHBhcmFtZXRlcl9uYW1lIGRhdGF0eXBlLAogICAgQGFub3RoZXJfcGFyYW1ldGVyIGRhdGF0eXBlCkFTCkJFR0lOCiAgICAtLSBTUUwgc3RhdGVtZW50cyB1c2luZyBwYXJhbWV0ZXJzCkVORDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE procedure_name
    @parameter_name datatype,
    @another_parameter datatype
AS
BEGIN
    -- SQL statements using parameters
END;</pre></div><div class='content'></div><h2>Example: Stored Procedure with Parameters</h2>
<div class='content'><p>Let's create a stored procedure that retrieves customer records based on their country.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSBHZXRDdXN0b21lcnNCeUNvdW50cnkKICAgIEBDb3VudHJ5IE5WQVJDSEFSKDUwKQpBUwpCRUdJTgogICAgU0VMRUNUICogRlJPTSBDdXN0b21lcnMgV0hFUkUgQ291bnRyeSA9IEBDb3VudHJ5OwpFTkQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE GetCustomersByCountry
    @Country NVARCHAR(50)
AS
BEGIN
    SELECT * FROM Customers WHERE Country = @Country;
END;</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>@Country NVARCHAR(50)</code>: Defines a parameter named <code>@Country</code> of type <code>NVARCHAR(50)</code>.</li>
<li><code>WHERE Country = @Country;</code>: Filters the <code>Customers</code> table based on the <code>Country</code> parameter.</li>
</ul>
</li>
</ul>
</div><h2>Executing a Stored Procedure with Parameters</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBHZXRDdXN0b21lcnNCeUNvdW50cnkgQENvdW50cnkgPSAnVVNBJzs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC GetCustomersByCountry @Country = 'USA';</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>@Country = 'USA'</code>: Passes the value <code>'USA'</code> to the <code>@Country</code> parameter.</li>
</ul>
</li>
</ul>
</div><h1>Advanced Concepts</h1>
<div class='content'></div><h2>Output Parameters</h2>
<div class='content'><p>Stored procedures can also return values through output parameters.</p>
</div><h2>Syntax with Output Parameters</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSBwcm9jZWR1cmVfbmFtZQogICAgQGlucHV0X3BhcmFtZXRlciBkYXRhdHlwZSwKICAgIEBvdXRwdXRfcGFyYW1ldGVyIGRhdGF0eXBlIE9VVFBVVApBUwpCRUdJTgogICAgLS0gU1FMIHN0YXRlbWVudHMKICAgIFNFVCBAb3V0cHV0X3BhcmFtZXRlciA9IHNvbWVfdmFsdWU7CkVORDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE procedure_name
    @input_parameter datatype,
    @output_parameter datatype OUTPUT
AS
BEGIN
    -- SQL statements
    SET @output_parameter = some_value;
END;</pre></div><div class='content'></div><h2>Example: Stored Procedure with Output Parameters</h2>
<div class='content'><p>Let's create a stored procedure that returns the total number of customers in a specific country.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSBHZXRDdXN0b21lckNvdW50QnlDb3VudHJ5CiAgICBAQ291bnRyeSBOVkFSQ0hBUig1MCksCiAgICBAQ3VzdG9tZXJDb3VudCBJTlQgT1VUUFVUCkFTCkJFR0lOCiAgICBTRUxFQ1QgQEN1c3RvbWVyQ291bnQgPSBDT1VOVCgqKSBGUk9NIEN1c3RvbWVycyBXSEVSRSBDb3VudHJ5ID0gQENvdW50cnk7CkVORDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE GetCustomerCountByCountry
    @Country NVARCHAR(50),
    @CustomerCount INT OUTPUT
AS
BEGIN
    SELECT @CustomerCount = COUNT(*) FROM Customers WHERE Country = @Country;
END;</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>@CustomerCount INT OUTPUT</code>: Defines an output parameter named <code>@CustomerCount</code> of type <code>INT</code>.</li>
<li><code>SELECT @CustomerCount = COUNT(*) ...</code>: Assigns the count of customers to the <code>@CustomerCount</code> parameter.</li>
</ul>
</li>
</ul>
</div><h2>Executing a Stored Procedure with Output Parameters</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRSBAQ291bnQgSU5UOwpFWEVDIEdldEN1c3RvbWVyQ291bnRCeUNvdW50cnkgQENvdW50cnkgPSAnVVNBJywgQEN1c3RvbWVyQ291bnQgPSBAQ291bnQgT1VUUFVUOwpTRUxFQ1QgQENvdW50IEFTIEN1c3RvbWVyQ291bnQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE @Count INT;
EXEC GetCustomerCountByCountry @Country = 'USA', @CustomerCount = @Count OUTPUT;
SELECT @Count AS CustomerCount;</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>DECLARE @Count INT;</code>: Declares a variable to hold the output value.</li>
<li><code>EXEC GetCustomerCountByCountry ...</code>: Executes the stored procedure and assigns the output to <code>@Count</code>.</li>
<li><code>SELECT @Count AS CustomerCount;</code>: Displays the output value.</li>
</ul>
</li>
</ul>
</div><h1>Error Handling in Stored Procedures</h1>
<div class='content'></div><h2>TRY...CATCH Block</h2>
<div class='content'><p>You can use the <code>TRY...CATCH</code> block to handle errors within stored procedures.</p>
</div><h2>Example: Error Handling</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFBST0NFRFVSRSBTYWZlSW5zZXJ0Q3VzdG9tZXIKICAgIEBDdXN0b21lck5hbWUgTlZBUkNIQVIoNTApLAogICAgQENvdW50cnkgTlZBUkNIQVIoNTApCkFTCkJFR0lOCiAgICBCRUdJTiBUUlkKICAgICAgICBJTlNFUlQgSU5UTyBDdXN0b21lcnMgKEN1c3RvbWVyTmFtZSwgQ291bnRyeSkgVkFMVUVTIChAQ3VzdG9tZXJOYW1lLCBAQ291bnRyeSk7CiAgICBFTkQgVFJZCiAgICBCRUdJTiBDQVRDSAogICAgICAgIFNFTEVDVCBFUlJPUl9NRVNTQUdFKCkgQVMgRXJyb3JNZXNzYWdlOwogICAgRU5EIENBVENICkVORDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE PROCEDURE SafeInsertCustomer
    @CustomerName NVARCHAR(50),
    @Country NVARCHAR(50)
AS
BEGIN
    BEGIN TRY
        INSERT INTO Customers (CustomerName, Country) VALUES (@CustomerName, @Country);
    END TRY
    BEGIN CATCH
        SELECT ERROR_MESSAGE() AS ErrorMessage;
    END CATCH
END;</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>BEGIN TRY ... END TRY</code>: Encapsulates the SQL statements that might cause an error.</li>
<li><code>BEGIN CATCH ... END CATCH</code>: Handles any errors that occur in the <code>TRY</code> block.</li>
</ul>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Stored procedures are a fundamental feature in SQL that can greatly enhance the efficiency, maintainability, and security of your database operations. By understanding how to create, execute, and manage stored procedures, you can leverage their full potential to build robust and scalable database applications.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='indexes'>&#x25C4;Indexes</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Stored Procedures</a>
	</div>
	<div class='col-4 text-end'>
					<a href='triggers'>Triggers &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
