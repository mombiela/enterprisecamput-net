<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triggers in SQL</title>

    <link rel="alternate" href="https://campusempresa.com/sql/triggers" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/sql/triggers" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/sql/triggers" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/sql/triggers" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/sql/triggers" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='stored-procedures'>&#x25C4;Stored Procedures</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Triggers in SQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='views'>Views &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction to Triggers</h1>
<div class='content'><p>Triggers are special types of stored procedures that automatically execute or fire when certain events occur in the database. They are used to enforce business rules, validate data, and maintain audit trails.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>Event</strong>: The action that causes the trigger to fire (e.g., INSERT, UPDATE, DELETE).</li>
<li><strong>Timing</strong>: When the trigger is executed in relation to the event (e.g., BEFORE, AFTER).</li>
<li><strong>Scope</strong>: The table or view to which the trigger is attached.</li>
</ul>
</div><h1>Creating Triggers</h1>
<div class='content'><p>To create a trigger, you use the <code>CREATE TRIGGER</code> statement. The basic syntax is:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFRSSUdHRVIgdHJpZ2dlcl9uYW1lCntCRUZPUkUgfCBBRlRFUn0ge0lOU0VSVCB8IFVQREFURSB8IERFTEVURX0KT04gdGFibGVfbmFtZQpGT1IgRUFDSCBST1cKQkVHSU4KICAgIC0tIFRyaWdnZXIgbG9naWMgaGVyZQpFTkQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE TRIGGER trigger_name
{BEFORE | AFTER} {INSERT | UPDATE | DELETE}
ON table_name
FOR EACH ROW
BEGIN
    -- Trigger logic here
END;</pre></div><div class='content'></div><h2>Example: Basic Insert Trigger</h2>
<div class='content'><p>This example demonstrates a trigger that logs insert operations on a <code>users</code> table.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFRBQkxFIHVzZXJzICgKICAgIGlkIElOVCBQUklNQVJZIEtFWSwKICAgIHVzZXJuYW1lIFZBUkNIQVIoNTApLAogICAgY3JlYXRlZF9hdCBUSU1FU1RBTVAKKTsKCkNSRUFURSBUQUJMRSB1c2VyX2xvZyAoCiAgICBsb2dfaWQgSU5UIFBSSU1BUlkgS0VZLAogICAgdXNlcl9pZCBJTlQsCiAgICBhY3Rpb24gVkFSQ0hBUig1MCksCiAgICBsb2dfdGltZSBUSU1FU1RBTVAKKTsKCkNSRUFURSBUUklHR0VSIGxvZ191c2VyX2luc2VydApBRlRFUiBJTlNFUlQgT04gdXNlcnMKRk9SIEVBQ0ggUk9XCkJFR0lOCiAgICBJTlNFUlQgSU5UTyB1c2VyX2xvZyAobG9nX2lkLCB1c2VyX2lkLCBhY3Rpb24sIGxvZ190aW1lKQogICAgVkFMVUVTIChOVUxMLCBORVcuaWQsICdJTlNFUlQnLCBOT1coKSk7CkVORDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE TABLE users (
    id INT PRIMARY KEY,
    username VARCHAR(50),
    created_at TIMESTAMP
);

CREATE TABLE user_log (
    log_id INT PRIMARY KEY,
    user_id INT,
    action VARCHAR(50),
    log_time TIMESTAMP
);

CREATE TRIGGER log_user_insert
AFTER INSERT ON users
FOR EACH ROW
BEGIN
    INSERT INTO user_log (log_id, user_id, action, log_time)
    VALUES (NULL, NEW.id, 'INSERT', NOW());
END;</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Trigger Name</strong>: <code>log_user_insert</code></li>
<li><strong>Timing</strong>: AFTER</li>
<li><strong>Event</strong>: INSERT</li>
<li><strong>Table</strong>: <code>users</code></li>
<li><strong>Logic</strong>: Inserts a log entry into <code>user_log</code> table whenever a new user is added to the <code>users</code> table.</li>
</ul>
</div><h1>Advanced Trigger Concepts</h1>
<h2>Conditional Logic in Triggers</h2>
<div class='content'><p>You can include conditional logic within triggers to perform different actions based on the data being inserted, updated, or deleted.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFRSSUdHRVIgdXBkYXRlX3VzZXJfbG9nCkFGVEVSIFVQREFURSBPTiB1c2VycwpGT1IgRUFDSCBST1cKQkVHSU4KICAgIElGIE9MRC51c2VybmFtZSAhPSBORVcudXNlcm5hbWUgVEhFTgogICAgICAgIElOU0VSVCBJTlRPIHVzZXJfbG9nIChsb2dfaWQsIHVzZXJfaWQsIGFjdGlvbiwgbG9nX3RpbWUpCiAgICAgICAgVkFMVUVTIChOVUxMLCBORVcuaWQsICdVU0VSTkFNRV9DSEFOR0UnLCBOT1coKSk7CiAgICBFTkQgSUY7CkVORDs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE TRIGGER update_user_log
AFTER UPDATE ON users
FOR EACH ROW
BEGIN
    IF OLD.username != NEW.username THEN
        INSERT INTO user_log (log_id, user_id, action, log_time)
        VALUES (NULL, NEW.id, 'USERNAME_CHANGE', NOW());
    END IF;
END;</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Condition</strong>: Checks if the <code>username</code> has changed.</li>
<li><strong>Action</strong>: Logs the change if the condition is met.</li>
</ul>
</div><h2>Using Triggers for Data Validation</h2>
<div class='content'><p>Triggers can also be used to enforce data integrity rules.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFRSSUdHRVIgdmFsaWRhdGVfdXNlcl9hZ2UKQkVGT1JFIElOU0VSVCBPTiB1c2VycwpGT1IgRUFDSCBST1cKQkVHSU4KICAgIElGIE5FVy5hZ2UgPCAxOCBUSEVOCiAgICAgICAgU0lHTkFMIFNRTFNUQVRFICc0NTAwMCcKICAgICAgICBTRVQgTUVTU0FHRV9URVhUID0gJ1VzZXIgbXVzdCBiZSBhdCBsZWFzdCAxOCB5ZWFycyBvbGQnOwogICAgRU5EIElGOwpFTkQ7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE TRIGGER validate_user_age
BEFORE INSERT ON users
FOR EACH ROW
BEGIN
    IF NEW.age &lt; 18 THEN
        SIGNAL SQLSTATE '45000'
        SET MESSAGE_TEXT = 'User must be at least 18 years old';
    END IF;
END;</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Timing</strong>: BEFORE</li>
<li><strong>Event</strong>: INSERT</li>
<li><strong>Validation</strong>: Ensures that the user's age is at least 18.</li>
</ul>
</div><h1>Managing Triggers</h1>
<h2>Viewing Triggers</h2>
<div class='content'><p>You can view existing triggers using the following query:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0hPVyBUUklHR0VSUzs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SHOW TRIGGERS;</pre></div><div class='content'></div><h2>Dropping Triggers</h2>
<div class='content'><p>To remove a trigger, use the <code>DROP TRIGGER</code> statement:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RFJPUCBUUklHR0VSIHRyaWdnZXJfbmFtZTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DROP TRIGGER trigger_name;</pre></div><div class='content'></div><h1>Best Practices</h1>
<div class='content'><ul>
<li><strong>Keep Triggers Simple</strong>: Complex logic can make triggers difficult to maintain and debug.</li>
<li><strong>Minimize Side Effects</strong>: Avoid making changes to other tables unless necessary.</li>
<li><strong>Document Triggers</strong>: Clearly document the purpose and logic of each trigger.</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Triggers are powerful tools in SQL that allow you to automate tasks and enforce rules at the database level. By understanding how to create and manage triggers, you can ensure data integrity, maintain audit trails, and implement complex business logic directly within your database. Remember to use triggers judiciously and keep them as simple and clear as possible to maintain the performance and readability of your database.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='stored-procedures'>&#x25C4;Stored Procedures</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Triggers in SQL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='views'>Views &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
