<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Practical Security Exercises</title>

    <link rel="alternate" href="https://campusempresa.com/owasp/tema-28" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/owasp/tema-28" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/owasp/tema-28" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/owasp/tema-28" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/owasp/tema-28" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introduction</h1>
<div class='content'><p>In this section of the OWASP course, we will focus on practical security exercises. These exercises are designed to help IT professionals identify, understand, and mitigate common vulnerabilities in web applications. Through examples and practical exercises, participants will be able to apply the concepts learned in real-world situations.</p>
</div><h1>Exercise 1: SQL Injection</h1>
<div class='content'></div><h2>Description</h2>
<div class='content'><p>SQL injection is one of the most common and dangerous vulnerabilities in web applications. This exercise will help you identify and mitigate this vulnerability.</p>
</div><h2>Objectives</h2>
<div class='content'><ul>
<li>Understand how SQL injection works.</li>
<li>Learn to identify vulnerable points in a web application.</li>
<li>Implement mitigation measures to prevent SQL injections.</li>
</ul>
</div><h2>Code Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDb2RlIHZ1bG5lcmFibGUgdG8gU1FMIGluamVjdGlvbgppbXBvcnQgc3FsaXRlMwoKZGVmIGdldF91c2VyX2RhdGEodXNlcl9pZCk6CiAgICBjb25uID0gc3FsaXRlMy5jb25uZWN0KCdleGFtcGxlLmRiJykKICAgIGN1cnNvciA9IGNvbm4uY3Vyc29yKCkKICAgIHF1ZXJ5ID0gZiJTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGlkID0ge3VzZXJfaWR9IgogICAgY3Vyc29yLmV4ZWN1dGUocXVlcnkpCiAgICByZXR1cm4gY3Vyc29yLmZldGNoYWxsKCkKCiMgVXNhZ2Ugb2YgdnVsbmVyYWJsZSBjb2RlCnVzZXJfZGF0YSA9IGdldF91c2VyX2RhdGEoIjEgT1IgMT0xIikKcHJpbnQodXNlcl9kYXRhKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Code vulnerable to SQL injection
import sqlite3

def get_user_data(user_id):
    conn = sqlite3.connect('example.db')
    cursor = conn.cursor()
    query = f&quot;SELECT * FROM users WHERE id = {user_id}&quot;
    cursor.execute(query)
    return cursor.fetchall()

# Usage of vulnerable code
user_data = get_user_data(&quot;1 OR 1=1&quot;)
print(user_data)</pre></div><div class='content'></div><h2>Exercise</h2>
<div class='content'><ol>
<li>Identify the problem in the above code.</li>
<li>Modify the code to use parameterized queries and prevent SQL injection.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTZWN1cmUgY29kZSB1c2luZyBwYXJhbWV0ZXJpemVkIHF1ZXJpZXMKaW1wb3J0IHNxbGl0ZTMKCmRlZiBnZXRfdXNlcl9kYXRhKHVzZXJfaWQpOgogICAgY29ubiA9IHNxbGl0ZTMuY29ubmVjdCgnZXhhbXBsZS5kYicpCiAgICBjdXJzb3IgPSBjb25uLmN1cnNvcigpCiAgICBxdWVyeSA9ICJTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGlkID0gPyIKICAgIGN1cnNvci5leGVjdXRlKHF1ZXJ5LCAodXNlcl9pZCwpKQogICAgcmV0dXJuIGN1cnNvci5mZXRjaGFsbCgpCgojIFVzYWdlIG9mIHNlY3VyZSBjb2RlCnVzZXJfZGF0YSA9IGdldF91c2VyX2RhdGEoMSkKcHJpbnQodXNlcl9kYXRhKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Secure code using parameterized queries
import sqlite3

def get_user_data(user_id):
    conn = sqlite3.connect('example.db')
    cursor = conn.cursor()
    query = &quot;SELECT * FROM users WHERE id = ?&quot;
    cursor.execute(query, (user_id,))
    return cursor.fetchall()

# Usage of secure code
user_data = get_user_data(1)
print(user_data)</pre></div><div class='content'></div><h1>Exercise 2: Cross-Site Scripting (XSS)</h1>
<div class='content'></div><h2>Description</h2>
<div class='content'><p>Cross-Site Scripting (XSS) allows attackers to inject malicious scripts into web pages viewed by other users. This exercise will help you identify and mitigate this vulnerability.</p>
</div><h2>Objectives</h2>
<div class='content'><ul>
<li>Understand how XSS works.</li>
<li>Learn to identify vulnerable points in a web application.</li>
<li>Implement mitigation measures to prevent XSS.</li>
</ul>
</div><h2>Code Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PCEtLSBDb2RlIHZ1bG5lcmFibGUgdG8gWFNTIC0tPgo8aHRtbD4KPGJvZHk+CiAgICA8Zm9ybSBtZXRob2Q9IkdFVCI+CiAgICAgICAgPGlucHV0IHR5cGU9InRleHQiIG5hbWU9InVzZXJfaW5wdXQiPgogICAgICAgIDxpbnB1dCB0eXBlPSJzdWJtaXQiIHZhbHVlPSJTdWJtaXQiPgogICAgPC9mb3JtPgogICAgPGRpdj4KICAgICAgICA8P3BocCBlY2hvICRfR0VUWyd1c2VyX2lucHV0J107ID8+CiAgICA8L2Rpdj4KPC9ib2R5Pgo8L2h0bWw+"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;!-- Code vulnerable to XSS --&gt;
&lt;html&gt;
&lt;body&gt;
    &lt;form method=&quot;GET&quot;&gt;
        &lt;input type=&quot;text&quot; name=&quot;user_input&quot;&gt;
        &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;
    &lt;/form&gt;
    &lt;div&gt;
        &lt;?php echo $_GET['user_input']; ?&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><div class='content'></div><h2>Exercise</h2>
<div class='content'><ol>
<li>Identify the problem in the above code.</li>
<li>Modify the code to properly escape user input and prevent XSS.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PCEtLSBTZWN1cmUgY29kZSB1c2luZyBjaGFyYWN0ZXIgZXNjYXBpbmcgLS0+CjxodG1sPgo8Ym9keT4KICAgIDxmb3JtIG1ldGhvZD0iR0VUIj4KICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgbmFtZT0idXNlcl9pbnB1dCI+CiAgICAgICAgPGlucHV0IHR5cGU9InN1Ym1pdCIgdmFsdWU9IlN1Ym1pdCI+CiAgICA8L2Zvcm0+CiAgICA8ZGl2PgogICAgICAgIDw/cGhwIGVjaG8gaHRtbHNwZWNpYWxjaGFycygkX0dFVFsndXNlcl9pbnB1dCddLCBFTlRfUVVPVEVTLCAnVVRGLTgnKTsgPz4KICAgIDwvZGl2Pgo8L2JvZHk+CjwvaHRtbD4="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;!-- Secure code using character escaping --&gt;
&lt;html&gt;
&lt;body&gt;
    &lt;form method=&quot;GET&quot;&gt;
        &lt;input type=&quot;text&quot; name=&quot;user_input&quot;&gt;
        &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;
    &lt;/form&gt;
    &lt;div&gt;
        &lt;?php echo htmlspecialchars($_GET['user_input'], ENT_QUOTES, 'UTF-8'); ?&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><div class='content'></div><h1>Exercise 3: Authentication and Session Management</h1>
<div class='content'></div><h2>Description</h2>
<div class='content'><p>Authentication and session management are crucial for the security of a web application. This exercise will help you implement secure practices for authentication and session management.</p>
</div><h2>Objectives</h2>
<div class='content'><ul>
<li>Understand the principles of secure authentication.</li>
<li>Learn to manage sessions securely.</li>
<li>Implement mitigation measures to prevent attacks related to authentication and sessions.</li>
</ul>
</div><h2>Code Example</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDb2RlIHZ1bG5lcmFibGUgdG8gc2Vzc2lvbiBhdHRhY2tzCmZyb20gZmxhc2sgaW1wb3J0IEZsYXNrLCByZXF1ZXN0LCBzZXNzaW9uCgphcHAgPSBGbGFzayhfX25hbWVfXykKYXBwLnNlY3JldF9rZXkgPSAnc3VwZXJfc2VjcmV0X2tleScKCkBhcHAucm91dGUoJy9sb2dpbicsIG1ldGhvZHM9WydQT1NUJ10pCmRlZiBsb2dpbigpOgogICAgdXNlcm5hbWUgPSByZXF1ZXN0LmZvcm1bJ3VzZXJuYW1lJ10KICAgIHBhc3N3b3JkID0gcmVxdWVzdC5mb3JtWydwYXNzd29yZCddCiAgICBpZiBhdXRoZW50aWNhdGUodXNlcm5hbWUsIHBhc3N3b3JkKToKICAgICAgICBzZXNzaW9uWyd1c2VybmFtZSddID0gdXNlcm5hbWUKICAgICAgICByZXR1cm4gIkxvZ2dlZCBpbiIKICAgIHJldHVybiAiTG9naW4gZmFpbGVkIgoKZGVmIGF1dGhlbnRpY2F0ZSh1c2VybmFtZSwgcGFzc3dvcmQpOgogICAgIyBTaW1wbGUgKG5vdCBzZWN1cmUpIGF1dGhlbnRpY2F0aW9uCiAgICByZXR1cm4gdXNlcm5hbWUgPT0gImFkbWluIiBhbmQgcGFzc3dvcmQgPT0gInBhc3N3b3JkIgoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIGFwcC5ydW4oKQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Code vulnerable to session attacks
from flask import Flask, request, session

app = Flask(__name__)
app.secret_key = 'super_secret_key'

@app.route('/login', methods=['POST'])
def login():
    username = request.form['username']
    password = request.form['password']
    if authenticate(username, password):
        session['username'] = username
        return &quot;Logged in&quot;
    return &quot;Login failed&quot;

def authenticate(username, password):
    # Simple (not secure) authentication
    return username == &quot;admin&quot; and password == &quot;password&quot;

if __name__ == '__main__':
    app.run()</pre></div><div class='content'></div><h2>Exercise</h2>
<div class='content'><ol>
<li>Identify the problems in the above code.</li>
<li>Modify the code to use secure practices for authentication and session management.</li>
</ol>
</div><h2>Solution</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTZWN1cmUgY29kZSB1c2luZyBzZWN1cmUgYXV0aGVudGljYXRpb24gYW5kIHNlc3Npb24gbWFuYWdlbWVudCBwcmFjdGljZXMKZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QsIHNlc3Npb24sIHJlZGlyZWN0LCB1cmxfZm9yCmZyb20gd2Vya3pldWcuc2VjdXJpdHkgaW1wb3J0IGNoZWNrX3Bhc3N3b3JkX2hhc2gsIGdlbmVyYXRlX3Bhc3N3b3JkX2hhc2gKCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQphcHAuc2VjcmV0X2tleSA9ICdzdXBlcl9zZWNyZXRfa2V5JwoKIyBTaW11bGF0ZWQgdXNlciBkYXRhYmFzZQp1c2VycyA9IHsKICAgICJhZG1pbiI6IGdlbmVyYXRlX3Bhc3N3b3JkX2hhc2goInBhc3N3b3JkIikKfQoKQGFwcC5yb3V0ZSgnL2xvZ2luJywgbWV0aG9kcz1bJ1BPU1QnXSkKZGVmIGxvZ2luKCk6CiAgICB1c2VybmFtZSA9IHJlcXVlc3QuZm9ybVsndXNlcm5hbWUnXQogICAgcGFzc3dvcmQgPSByZXF1ZXN0LmZvcm1bJ3Bhc3N3b3JkJ10KICAgIGlmIHVzZXJuYW1lIGluIHVzZXJzIGFuZCBjaGVja19wYXNzd29yZF9oYXNoKHVzZXJzW3VzZXJuYW1lXSwgcGFzc3dvcmQpOgogICAgICAgIHNlc3Npb25bJ3VzZXJuYW1lJ10gPSB1c2VybmFtZQogICAgICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCdkYXNoYm9hcmQnKSkKICAgIHJldHVybiAiTG9naW4gZmFpbGVkIgoKQGFwcC5yb3V0ZSgnL2Rhc2hib2FyZCcpCmRlZiBkYXNoYm9hcmQoKToKICAgIGlmICd1c2VybmFtZScgaW4gc2Vzc2lvbjoKICAgICAgICByZXR1cm4gZiJXZWxjb21lIHtzZXNzaW9uWyd1c2VybmFtZSddfSEiCiAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcignbG9naW4nKSkKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBhcHAucnVuKCk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Secure code using secure authentication and session management practices
from flask import Flask, request, session, redirect, url_for
from werkzeug.security import check_password_hash, generate_password_hash

app = Flask(__name__)
app.secret_key = 'super_secret_key'

# Simulated user database
users = {
    &quot;admin&quot;: generate_password_hash(&quot;password&quot;)
}

@app.route('/login', methods=['POST'])
def login():
    username = request.form['username']
    password = request.form['password']
    if username in users and check_password_hash(users[username], password):
        session['username'] = username
        return redirect(url_for('dashboard'))
    return &quot;Login failed&quot;

@app.route('/dashboard')
def dashboard():
    if 'username' in session:
        return f&quot;Welcome {session['username']}!&quot;
    return redirect(url_for('login'))

if __name__ == '__main__':
    app.run()</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>In this section, we have covered three practical security exercises focused on SQL injection, Cross-Site Scripting (XSS), and authentication and session management. These exercises are designed to provide a deep understanding of how to identify and mitigate common vulnerabilities in web applications. Practicing these exercises will help you apply OWASP concepts in real-world situations, improving the security of your applications.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
