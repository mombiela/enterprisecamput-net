<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integration Testing in Node.js</title>

    <link rel="alternate" href="https://campusempresa.com/nodejs/integration-testing" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/nodejs/integration-testing" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/nodejs/integration-testing" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/nodejs/integration-testing" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/nodejs/integration-testing" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='unit-testing-mocha-chai'>&#x25C4;Unit Testing with Mocha and Chai</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Integration Testing in Node.js</a>
	</div>
	<div class='col-4 text-end'>
					<a href='debugging-nodejs'>Debugging Node.js Applications &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Integration testing is a crucial part of the software development lifecycle. It ensures that different modules or services in your application work together as expected. This topic will guide you through the basics to advanced concepts of integration testing in Node.js.</p>
</div><h1>What is Integration Testing?</h1>
<div class='content'><ul>
<li><strong>Definition</strong>: Integration testing is a level of software testing where individual units are combined and tested as a group.</li>
<li><strong>Purpose</strong>: To identify issues in the interaction between integrated units.</li>
<li><strong>Scope</strong>: It goes beyond unit testing by focusing on the communication between modules.</li>
</ul>
</div><h1>Why Integration Testing is Important</h1>
<div class='content'><ul>
<li><strong>Detects Interface Issues</strong>: Helps in identifying problems in the interaction between different modules.</li>
<li><strong>Ensures Data Integrity</strong>: Verifies that data is correctly passed between modules.</li>
<li><strong>Improves Code Quality</strong>: Enhances the overall quality of the code by catching bugs early in the development process.</li>
</ul>
</div><h1>Tools for Integration Testing in Node.js</h1>
<div class='content'><ul>
<li><strong>Mocha</strong>: A feature-rich JavaScript test framework running on Node.js.</li>
<li><strong>Chai</strong>: A BDD / TDD assertion library for Node.js.</li>
<li><strong>Supertest</strong>: A library for testing Node.js HTTP servers.</li>
</ul>
</div><h1>Setting Up Your Environment</h1>
<div class='content'><p>To get started with integration testing in Node.js, you need to set up your environment with the necessary tools.</p>
</div><h2>Installing Mocha, Chai, and Supertest</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnBtIGluc3RhbGwgLS1zYXZlLWRldiBtb2NoYSBjaGFpIHN1cGVydGVzdA=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>npm install --save-dev mocha chai supertest</pre></div><div class='content'></div><h2>Basic Project Structure</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bXktbm9kZS1hcHAvCuKUnOKUgOKUgCBhcHAuanMK4pSc4pSA4pSAIHBhY2thZ2UuanNvbgrilJzilIDilIAgdGVzdC8K4pSCICAg4pSU4pSA4pSAIGludGVncmF0aW9uLwrilIIgICAgICAg4pSU4pSA4pSAIGFwcC50ZXN0Lmpz"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>my-node-app/
├── app.js
├── package.json
├── test/
│   └── integration/
│       └── app.test.js</pre></div><div class='content'></div><h1>Writing Your First Integration Test</h1>
<div class='content'><p>Let's write a simple integration test for a Node.js application.</p>
</div><h2>Example Application (app.js)</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgYXBwID0gZXhwcmVzcygpOwoKYXBwLmdldCgnL2FwaS9oZWxsbycsIChyZXEsIHJlcykgPT4gewogIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ0hlbGxvLCB3b3JsZCEnIH0pOwp9KTsKCm1vZHVsZS5leHBvcnRzID0gYXBwOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const app = express();

app.get('/api/hello', (req, res) =&gt; {
  res.status(200).json({ message: 'Hello, world!' });
});

module.exports = app;</pre></div><div class='content'></div><h2>Integration Test (test/integration/app.test.js)</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgcmVxdWVzdCA9IHJlcXVpcmUoJ3N1cGVydGVzdCcpOwpjb25zdCBhcHAgPSByZXF1aXJlKCcuLi8uLi9hcHAnKTsKY29uc3QgY2hhaSA9IHJlcXVpcmUoJ2NoYWknKTsKY29uc3QgZXhwZWN0ID0gY2hhaS5leHBlY3Q7CgpkZXNjcmliZSgnR0VUIC9hcGkvaGVsbG8nLCAoKSA9PiB7CiAgaXQoJ3Nob3VsZCByZXR1cm4gYSBtZXNzYWdlICJIZWxsbywgd29ybGQhIicsIChkb25lKSA9PiB7CiAgICByZXF1ZXN0KGFwcCkKICAgICAgLmdldCgnL2FwaS9oZWxsbycpCiAgICAgIC5lbmQoKGVyciwgcmVzKSA9PiB7CiAgICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvLmVxdWFsKDIwMCk7CiAgICAgICAgZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvLmVxdWFsKCdIZWxsbywgd29ybGQhJyk7CiAgICAgICAgZG9uZSgpOwogICAgICB9KTsKICB9KTsKfSk7"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const request = require('supertest');
const app = require('../../app');
const chai = require('chai');
const expect = chai.expect;

describe('GET /api/hello', () =&gt; {
  it('should return a message &quot;Hello, world!&quot;', (done) =&gt; {
    request(app)
      .get('/api/hello')
      .end((err, res) =&gt; {
        expect(res.status).to.equal(200);
        expect(res.body.message).to.equal('Hello, world!');
        done();
      });
  });
});</pre></div><div class='content'></div><h2>Explanation</h2>
<div class='content'><ul>
<li><strong>Setup</strong>: Import necessary modules (<code>supertest</code>, <code>chai</code>, and the app).</li>
<li><strong>Test Case</strong>: Describe the test case using <code>describe</code> and <code>it</code> blocks.</li>
<li><strong>Request</strong>: Use <code>supertest</code> to make a GET request to <code>/api/hello</code>.</li>
<li><strong>Assertions</strong>: Use <code>chai</code> to assert the response status and body.</li>
</ul>
</div><h1>Advanced Integration Testing Concepts</h1>
<div class='content'></div><h2>Testing with Databases</h2>
<div class='content'><p>When your application interacts with a database, you need to ensure that your integration tests cover these interactions.</p>
<h4>Example with MongoDB</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpOwpjb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vLi4vbW9kZWxzL3VzZXInKTsKCmJlZm9yZSgoZG9uZSkgPT4gewogIG1vbmdvb3NlLmNvbm5lY3QoJ21vbmdvZGI6Ly9sb2NhbGhvc3QvdGVzdGRiJywgeyB1c2VOZXdVcmxQYXJzZXI6IHRydWUsIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSB9KTsKICBtb25nb29zZS5jb25uZWN0aW9uLm9uY2UoJ29wZW4nLCAoKSA9PiBkb25lKCkpLm9uKCdlcnJvcicsIChlcnJvcikgPT4gY29uc29sZS53YXJuKCdFcnJvcicsIGVycm9yKSk7Cn0pOwoKYWZ0ZXIoKGRvbmUpID0+IHsKICBtb25nb29zZS5jb25uZWN0aW9uLmNsb3NlKCgpID0+IGRvbmUoKSk7Cn0pOwoKZGVzY3JpYmUoJ1BPU1QgL2FwaS91c2VycycsICgpID0+IHsKICBpdCgnc2hvdWxkIGNyZWF0ZSBhIG5ldyB1c2VyJywgKGRvbmUpID0+IHsKICAgIGNvbnN0IHVzZXIgPSB7IG5hbWU6ICdKb2huIERvZScsIGVtYWlsOiAnam9obkBleGFtcGxlLmNvbScgfTsKICAgIHJlcXVlc3QoYXBwKQogICAgICAucG9zdCgnL2FwaS91c2VycycpCiAgICAgIC5zZW5kKHVzZXIpCiAgICAgIC5lbmQoKGVyciwgcmVzKSA9PiB7CiAgICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvLmVxdWFsKDIwMSk7CiAgICAgICAgZXhwZWN0KHJlcy5ib2R5Lm5hbWUpLnRvLmVxdWFsKCdKb2huIERvZScpOwogICAgICAgIGRvbmUoKTsKICAgICAgfSk7CiAgfSk7Cn0pOw=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const mongoose = require('mongoose');
const User = require('../../models/user');

before((done) =&gt; {
  mongoose.connect('mongodb://localhost/testdb', { useNewUrlParser: true, useUnifiedTopology: true });
  mongoose.connection.once('open', () =&gt; done()).on('error', (error) =&gt; console.warn('Error', error));
});

after((done) =&gt; {
  mongoose.connection.close(() =&gt; done());
});

describe('POST /api/users', () =&gt; {
  it('should create a new user', (done) =&gt; {
    const user = { name: 'John Doe', email: 'john@example.com' };
    request(app)
      .post('/api/users')
      .send(user)
      .end((err, res) =&gt; {
        expect(res.status).to.equal(201);
        expect(res.body.name).to.equal('John Doe');
        done();
      });
  });
});</pre></div><div class='content'></div><h2>Mocking External Services</h2>
<div class='content'><p>Sometimes, your application might depend on external services. You can use libraries like <code>nock</code> to mock these services.</p>
<h4>Example with Nock</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3Qgbm9jayA9IHJlcXVpcmUoJ25vY2snKTsKCmRlc2NyaWJlKCdHRVQgL2FwaS9leHRlcm5hbCcsICgpID0+IHsKICBiZWZvcmUoKCkgPT4gewogICAgbm9jaygnaHR0cHM6Ly9leHRlcm5hbC1zZXJ2aWNlLmNvbScpCiAgICAgIC5nZXQoJy9kYXRhJykKICAgICAgLnJlcGx5KDIwMCwgeyBkYXRhOiAnbW9ja2VkIGRhdGEnIH0pOwogIH0pOwoKICBpdCgnc2hvdWxkIHJldHVybiBtb2NrZWQgZGF0YSBmcm9tIGV4dGVybmFsIHNlcnZpY2UnLCAoZG9uZSkgPT4gewogICAgcmVxdWVzdChhcHApCiAgICAgIC5nZXQoJy9hcGkvZXh0ZXJuYWwnKQogICAgICAuZW5kKChlcnIsIHJlcykgPT4gewogICAgICAgIGV4cGVjdChyZXMuc3RhdHVzKS50by5lcXVhbCgyMDApOwogICAgICAgIGV4cGVjdChyZXMuYm9keS5kYXRhKS50by5lcXVhbCgnbW9ja2VkIGRhdGEnKTsKICAgICAgICBkb25lKCk7CiAgICAgIH0pOwogIH0pOwp9KTs="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const nock = require('nock');

describe('GET /api/external', () =&gt; {
  before(() =&gt; {
    nock('https://external-service.com')
      .get('/data')
      .reply(200, { data: 'mocked data' });
  });

  it('should return mocked data from external service', (done) =&gt; {
    request(app)
      .get('/api/external')
      .end((err, res) =&gt; {
        expect(res.status).to.equal(200);
        expect(res.body.data).to.equal('mocked data');
        done();
      });
  });
});</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Integration testing is essential for ensuring that different parts of your application work together seamlessly. By using tools like Mocha, Chai, and Supertest, you can write effective integration tests for your Node.js applications. As you advance, consider testing interactions with databases and mocking external services to cover all aspects of your application.</p>
<p>By following these practices, you can improve the reliability and quality of your Node.js applications, making them more robust and maintainable.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='unit-testing-mocha-chai'>&#x25C4;Unit Testing with Mocha and Chai</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Integration Testing in Node.js</a>
	</div>
	<div class='col-4 text-end'>
					<a href='debugging-nodejs'>Debugging Node.js Applications &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
