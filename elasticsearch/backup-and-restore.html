<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Backup and Restore</title>

    <link rel="alternate" href="https://campusempresa.com/elasticsearch/backup-and-restore" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/elasticsearch/backup-and-restore" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/elasticsearch/backup-and-restore" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/elasticsearch/backup-and-restore" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/elasticsearch/backup-and-restore" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='monitoring-and-maintenance'>&#x25C4;Monitoring and Maintenance</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Backup and Restore</a>
	</div>
	<div class='col-4 text-end'>
					<a href='securing-elasticsearch'>Securing Elasticsearch &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Backup and restore are critical operations for maintaining data integrity and availability in Elasticsearch. This section will cover the fundamental concepts, tools, and techniques for performing backups and restores in Elasticsearch, from basic to advanced levels.</p>
</div><h1>Key Concepts</h1>
<div class='content'><ul>
<li><strong>Snapshot</strong>: A snapshot is a backup of an index or a cluster in Elasticsearch. It captures the state of the data at a specific point in time.</li>
<li><strong>Repository</strong>: A repository is a storage location where snapshots are stored. It can be a shared filesystem, Amazon S3, HDFS, etc.</li>
<li><strong>Restore</strong>: The process of recovering data from a snapshot.</li>
</ul>
</div><h1>Setting Up a Repository</h1>
<div class='content'><p>Before taking a snapshot, you need to configure a repository where the snapshots will be stored.</p>
</div><h2>Example: Registering a Filesystem Repository</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UFVUIC9fc25hcHNob3QvbXlfYmFja3VwCnsKICAidHlwZSI6ICJmcyIsCiAgInNldHRpbmdzIjogewogICAgImxvY2F0aW9uIjogIi9tb3VudC9iYWNrdXBzL215X2JhY2t1cCIKICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PUT /_snapshot/my_backup
{
  &quot;type&quot;: &quot;fs&quot;,
  &quot;settings&quot;: {
    &quot;location&quot;: &quot;/mount/backups/my_backup&quot;
  }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>PUT /_snapshot/my_backup</code>: Creates a new snapshot repository named <code>my_backup</code>.</li>
<li><code>&quot;type&quot;: &quot;fs&quot;</code>: Specifies that the repository type is a filesystem.</li>
<li><code>&quot;location&quot;: &quot;/mount/backups/my_backup&quot;</code>: The path where snapshots will be stored.</li>
</ul>
</li>
</ul>
</div><h1>Creating a Snapshot</h1>
<div class='content'><p>Once the repository is set up, you can create a snapshot of your indices.</p>
</div><h2>Example: Creating a Snapshot</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UFVUIC9fc25hcHNob3QvbXlfYmFja3VwL3NuYXBzaG90XzEKewogICJpbmRpY2VzIjogImluZGV4XzEsaW5kZXhfMiIsCiAgImlnbm9yZV91bmF2YWlsYWJsZSI6IHRydWUsCiAgImluY2x1ZGVfZ2xvYmFsX3N0YXRlIjogZmFsc2UKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PUT /_snapshot/my_backup/snapshot_1
{
  &quot;indices&quot;: &quot;index_1,index_2&quot;,
  &quot;ignore_unavailable&quot;: true,
  &quot;include_global_state&quot;: false
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>PUT /_snapshot/my_backup/snapshot_1</code>: Creates a snapshot named <code>snapshot_1</code> in the <code>my_backup</code> repository.</li>
<li><code>&quot;indices&quot;: &quot;index_1,index_2&quot;</code>: Specifies the indices to include in the snapshot.</li>
<li><code>&quot;ignore_unavailable&quot;: true</code>: Ignores indices that are unavailable at the time of the snapshot.</li>
<li><code>&quot;include_global_state&quot;: false</code>: Excludes the cluster state from the snapshot.</li>
</ul>
</li>
</ul>
</div><h1>Restoring a Snapshot</h1>
<div class='content'><p>Restoring a snapshot involves recovering the data from a snapshot back into the cluster.</p>
</div><h2>Example: Restoring a Snapshot</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UE9TVCAvX3NuYXBzaG90L215X2JhY2t1cC9zbmFwc2hvdF8xL19yZXN0b3JlCnsKICAiaW5kaWNlcyI6ICJpbmRleF8xIiwKICAiaWdub3JlX3VuYXZhaWxhYmxlIjogdHJ1ZSwKICAiaW5jbHVkZV9nbG9iYWxfc3RhdGUiOiBmYWxzZSwKICAicmVuYW1lX3BhdHRlcm4iOiAiaW5kZXhfKC4rKSIsCiAgInJlbmFtZV9yZXBsYWNlbWVudCI6ICJyZXN0b3JlZF9pbmRleF8kMSIKfQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>POST /_snapshot/my_backup/snapshot_1/_restore
{
  &quot;indices&quot;: &quot;index_1&quot;,
  &quot;ignore_unavailable&quot;: true,
  &quot;include_global_state&quot;: false,
  &quot;rename_pattern&quot;: &quot;index_(.+)&quot;,
  &quot;rename_replacement&quot;: &quot;restored_index_$1&quot;
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>POST /_snapshot/my_backup/snapshot_1/_restore</code>: Initiates the restore process for <code>snapshot_1</code> from the <code>my_backup</code> repository.</li>
<li><code>&quot;indices&quot;: &quot;index_1&quot;</code>: Specifies the indices to restore.</li>
<li><code>&quot;ignore_unavailable&quot;: true</code>: Ignores indices that are unavailable in the snapshot.</li>
<li><code>&quot;include_global_state&quot;: false</code>: Excludes the cluster state from the restore.</li>
<li><code>&quot;rename_pattern&quot;: &quot;index_(.+)&quot;</code>: A regex pattern to match the index names.</li>
<li><code>&quot;rename_replacement&quot;: &quot;restored_index_$1&quot;</code>: The replacement pattern for renaming the restored indices.</li>
</ul>
</li>
</ul>
</div><h1>Advanced Topics</h1>
<h2>Snapshot Lifecycle Management (SLM)</h2>
<div class='content'><p>SLM automates the process of taking snapshots based on a defined policy.</p>
</div><h2>Example: Creating an SLM Policy</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UFVUIC9fc2xtL3BvbGljeS9kYWlseS1zbmFwc2hvdHMKewogICJzY2hlZHVsZSI6ICIwIDMwIDEgKiAqID8iLCAKICAibmFtZSI6ICI8ZGFpbHktc25hcC17bm93L2R9PiIsCiAgInJlcG9zaXRvcnkiOiAibXlfYmFja3VwIiwKICAiY29uZmlnIjogewogICAgImluZGljZXMiOiBbImluZGV4XzEiLCAiaW5kZXhfMiJdLAogICAgImlnbm9yZV91bmF2YWlsYWJsZSI6IGZhbHNlLAogICAgImluY2x1ZGVfZ2xvYmFsX3N0YXRlIjogdHJ1ZQogIH0sCiAgInJldGVudGlvbiI6IHsKICAgICJleHBpcmVfYWZ0ZXIiOiAiMzBkIiwKICAgICJtaW5fY291bnQiOiA1LAogICAgIm1heF9jb3VudCI6IDUwCiAgfQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PUT /_slm/policy/daily-snapshots
{
  &quot;schedule&quot;: &quot;0 30 1 * * ?&quot;, 
  &quot;name&quot;: &quot;&lt;daily-snap-{now/d}&gt;&quot;,
  &quot;repository&quot;: &quot;my_backup&quot;,
  &quot;config&quot;: {
    &quot;indices&quot;: [&quot;index_1&quot;, &quot;index_2&quot;],
    &quot;ignore_unavailable&quot;: false,
    &quot;include_global_state&quot;: true
  },
  &quot;retention&quot;: {
    &quot;expire_after&quot;: &quot;30d&quot;,
    &quot;min_count&quot;: 5,
    &quot;max_count&quot;: 50
  }
}</pre></div><div class='content'><ul>
<li><strong>Explanation</strong>:
<ul>
<li><code>PUT /_slm/policy/daily-snapshots</code>: Creates a new SLM policy named <code>daily-snapshots</code>.</li>
<li><code>&quot;schedule&quot;: &quot;0 30 1 * * ?&quot;</code>: Cron expression to run the policy daily at 1:30 AM.</li>
<li><code>&quot;name&quot;: &quot;&lt;daily-snap-{now/d}&gt;&quot;</code>: Naming pattern for the snapshots.</li>
<li><code>&quot;repository&quot;: &quot;my_backup&quot;</code>: The repository where snapshots will be stored.</li>
<li><code>&quot;config&quot;</code>: Configuration for the snapshots.
<ul>
<li><code>&quot;indices&quot;: [&quot;index_1&quot;, &quot;index_2&quot;]</code>: Indices to include in the snapshots.</li>
<li><code>&quot;ignore_unavailable&quot;: false</code>: Do not ignore unavailable indices.</li>
<li><code>&quot;include_global_state&quot;: true</code>: Include the cluster state in the snapshots.</li>
</ul>
</li>
<li><code>&quot;retention&quot;</code>: Retention policy for the snapshots.
<ul>
<li><code>&quot;expire_after&quot;: &quot;30d&quot;</code>: Expire snapshots older than 30 days.</li>
<li><code>&quot;min_count&quot;: 5</code>: Keep at least 5 snapshots.</li>
<li><code>&quot;max_count&quot;: 50</code>: Keep at most 50 snapshots.</li>
</ul>
</li>
</ul>
</li>
</ul>
</div><h1>Conclusion</h1>
<div class='content'><p>Understanding how to perform backups and restores in Elasticsearch is essential for data management and disaster recovery. By setting up repositories, creating snapshots, and restoring data, you can ensure the integrity and availability of your data. Advanced features like Snapshot Lifecycle Management (SLM) further automate and streamline these processes, making it easier to maintain your Elasticsearch cluster.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='monitoring-and-maintenance'>&#x25C4;Monitoring and Maintenance</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Backup and Restore</a>
	</div>
	<div class='col-4 text-end'>
					<a href='securing-elasticsearch'>Securing Elasticsearch &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
