<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automating Active Directory Tasks with PowerShell</title>

    <link rel="alternate" href="https://campusempresa.com/powershell/automating-active-directory-tasks" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/powershell/automating-active-directory-tasks" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/powershell/automating-active-directory-tasks" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/powershell/automating-active-directory-tasks" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/powershell/automating-active-directory-tasks" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='active-directory-queries'>&#x25C4;Active Directory Queries</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Automating Active Directory Tasks with PowerShell</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-devops'>Introduction to DevOps &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introduction</h1>
<div class='content'><p>Active Directory (AD) is a critical service for managing users, computers, and other resources in a Windows environment. PowerShell provides a powerful way to automate many of the tasks associated with Active Directory, making administration more efficient and less error-prone.</p>
<p>In this topic, we will cover:</p>
<ul>
<li>Connecting to Active Directory</li>
<li>Managing Users</li>
<li>Managing Groups</li>
<li>Managing Computers</li>
<li>Advanced Automation Techniques</li>
</ul>
</div><h1>Connecting to Active Directory</h1>
<div class='content'><p>Before you can manage Active Directory objects, you need to establish a connection to your AD environment.</p>
</div><h2>Installing the Active Directory Module</h2>
<div class='content'><p>First, ensure that the Active Directory module for PowerShell is installed. You can install it using the following command:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW5zdGFsbC1XaW5kb3dzRmVhdHVyZSAtTmFtZSBSU0FULUFELVBvd2VyU2hlbGw="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Install-WindowsFeature -Name RSAT-AD-PowerShell</pre></div><div class='content'></div><h2>Importing the Active Directory Module</h2>
<div class='content'><p>Once installed, import the module into your PowerShell session:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW1wb3J0LU1vZHVsZSBBY3RpdmVEaXJlY3Rvcnk="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Import-Module ActiveDirectory</pre></div><div class='content'></div><h2>Connecting to a Domain Controller</h2>
<div class='content'><p>To connect to a specific domain controller, use the <code>Get-ADDomainController</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGRvbWFpbkNvbnRyb2xsZXIgPSBHZXQtQUREb21haW5Db250cm9sbGVyIC1EaXNjb3ZlciAtU2VydmljZSAiUHJpbWFyeURDIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$domainController = Get-ADDomainController -Discover -Service &quot;PrimaryDC&quot;</pre></div><div class='content'></div><h1>Managing Users</h1>
<div class='content'><p>Managing users is a common task in Active Directory. PowerShell makes it easy to create, modify, and remove user accounts.</p>
</div><h2>Creating a New User</h2>
<div class='content'><p>To create a new user, use the <code>New-ADUser</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("TmV3LUFEVXNlciAtTmFtZSAiSm9obiBEb2UiIC1HaXZlbk5hbWUgIkpvaG4iIC1TdXJuYW1lICJEb2UiIC1TYW1BY2NvdW50TmFtZSAiamRvZSIgLVVzZXJQcmluY2lwYWxOYW1lICJqZG9lQGRvbWFpbi5jb20iIC1QYXRoICJPVT1Vc2VycyxEQz1kb21haW4sREM9Y29tIiAtQWNjb3VudFBhc3N3b3JkIChDb252ZXJ0VG8tU2VjdXJlU3RyaW5nICJQQHNzdzByZCIgLUFzUGxhaW5UZXh0IC1Gb3JjZSkgLUVuYWJsZWQgJHRydWU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>New-ADUser -Name &quot;John Doe&quot; -GivenName &quot;John&quot; -Surname &quot;Doe&quot; -SamAccountName &quot;jdoe&quot; -UserPrincipalName &quot;jdoe@domain.com&quot; -Path &quot;OU=Users,DC=domain,DC=com&quot; -AccountPassword (ConvertTo-SecureString &quot;P@ssw0rd&quot; -AsPlainText -Force) -Enabled $true</pre></div><div class='content'></div><h2>Modifying an Existing User</h2>
<div class='content'><p>To modify an existing user, use the <code>Set-ADUser</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U2V0LUFEVXNlciAtSWRlbnRpdHkgImpkb2UiIC1UaXRsZSAiU2VuaW9yIERldmVsb3BlciIgLURlcGFydG1lbnQgIklUIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Set-ADUser -Identity &quot;jdoe&quot; -Title &quot;Senior Developer&quot; -Department &quot;IT&quot;</pre></div><div class='content'></div><h2>Removing a User</h2>
<div class='content'><p>To remove a user, use the <code>Remove-ADUser</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UmVtb3ZlLUFEVXNlciAtSWRlbnRpdHkgImpkb2Ui"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Remove-ADUser -Identity &quot;jdoe&quot;</pre></div><div class='content'></div><h1>Managing Groups</h1>
<div class='content'><p>Groups are essential for managing permissions and access control. PowerShell provides cmdlets to create, modify, and delete groups.</p>
</div><h2>Creating a New Group</h2>
<div class='content'><p>To create a new group, use the <code>New-ADGroup</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("TmV3LUFER3JvdXAgLU5hbWUgIkRldmVsb3BlcnMiIC1Hcm91cFNjb3BlIEdsb2JhbCAtUGF0aCAiT1U9R3JvdXBzLERDPWRvbWFpbixEQz1jb20i"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>New-ADGroup -Name &quot;Developers&quot; -GroupScope Global -Path &quot;OU=Groups,DC=domain,DC=com&quot;</pre></div><div class='content'></div><h2>Adding a User to a Group</h2>
<div class='content'><p>To add a user to a group, use the <code>Add-ADGroupMember</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QWRkLUFER3JvdXBNZW1iZXIgLUlkZW50aXR5ICJEZXZlbG9wZXJzIiAtTWVtYmVycyAiamRvZSI="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Add-ADGroupMember -Identity &quot;Developers&quot; -Members &quot;jdoe&quot;</pre></div><div class='content'></div><h2>Removing a User from a Group</h2>
<div class='content'><p>To remove a user from a group, use the <code>Remove-ADGroupMember</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UmVtb3ZlLUFER3JvdXBNZW1iZXIgLUlkZW50aXR5ICJEZXZlbG9wZXJzIiAtTWVtYmVycyAiamRvZSIgLUNvbmZpcm06JGZhbHNl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Remove-ADGroupMember -Identity &quot;Developers&quot; -Members &quot;jdoe&quot; -Confirm:$false</pre></div><div class='content'></div><h1>Managing Computers</h1>
<div class='content'><p>Managing computer accounts is another critical task in Active Directory.</p>
</div><h2>Creating a New Computer</h2>
<div class='content'><p>To create a new computer account, use the <code>New-ADComputer</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("TmV3LUFEQ29tcHV0ZXIgLU5hbWUgIlBDMDEiIC1QYXRoICJPVT1Db21wdXRlcnMsREM9ZG9tYWluLERDPWNvbSIgLUVuYWJsZWQgJHRydWU="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>New-ADComputer -Name &quot;PC01&quot; -Path &quot;OU=Computers,DC=domain,DC=com&quot; -Enabled $true</pre></div><div class='content'></div><h2>Resetting a Computer Account</h2>
<div class='content'><p>To reset a computer account, use the <code>Reset-ADComputer</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UmVzZXQtQURDb21wdXRlciAtSWRlbnRpdHkgIlBDMDEi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Reset-ADComputer -Identity &quot;PC01&quot;</pre></div><div class='content'></div><h2>Removing a Computer</h2>
<div class='content'><p>To remove a computer account, use the <code>Remove-ADComputer</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UmVtb3ZlLUFEQ29tcHV0ZXIgLUlkZW50aXR5ICJQQzAxIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Remove-ADComputer -Identity &quot;PC01&quot;</pre></div><div class='content'></div><h1>Advanced Automation Techniques</h1>
<div class='content'><p>For more advanced automation, you can combine multiple cmdlets and use scripting techniques to perform complex tasks.</p>
</div><h2>Bulk User Creation</h2>
<div class='content'><p>You can create multiple users from a CSV file using a script:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JHVzZXJzID0gSW1wb3J0LUNzdiAtUGF0aCAiQzpcVXNlcnNcbmV3X3VzZXJzLmNzdiIKZm9yZWFjaCAoJHVzZXIgaW4gJHVzZXJzKSB7CiAgICBOZXctQURVc2VyIC1OYW1lICR1c2VyLk5hbWUgLUdpdmVuTmFtZSAkdXNlci5HaXZlbk5hbWUgLVN1cm5hbWUgJHVzZXIuU3VybmFtZSAtU2FtQWNjb3VudE5hbWUgJHVzZXIuU2FtQWNjb3VudE5hbWUgLVVzZXJQcmluY2lwYWxOYW1lICR1c2VyLlVzZXJQcmluY2lwYWxOYW1lIC1QYXRoICR1c2VyLlBhdGggLUFjY291bnRQYXNzd29yZCAoQ29udmVydFRvLVNlY3VyZVN0cmluZyAkdXNlci5QYXNzd29yZCAtQXNQbGFpblRleHQgLUZvcmNlKSAtRW5hYmxlZCAkdHJ1ZQp9"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$users = Import-Csv -Path &quot;C:\Users\new_users.csv&quot;
foreach ($user in $users) {
    New-ADUser -Name $user.Name -GivenName $user.GivenName -Surname $user.Surname -SamAccountName $user.SamAccountName -UserPrincipalName $user.UserPrincipalName -Path $user.Path -AccountPassword (ConvertTo-SecureString $user.Password -AsPlainText -Force) -Enabled $true
}</pre></div><div class='content'></div><h2>Scheduled Tasks</h2>
<div class='content'><p>You can schedule PowerShell scripts to run at specific times using Task Scheduler.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGFjdGlvbiA9IE5ldy1TY2hlZHVsZWRUYXNrQWN0aW9uIC1FeGVjdXRlICJQb3dlclNoZWxsLmV4ZSIgLUFyZ3VtZW50ICItRmlsZSBDOlxTY3JpcHRzXERhaWx5VXNlclJlcG9ydC5wczEiCiR0cmlnZ2VyID0gTmV3LVNjaGVkdWxlZFRhc2tUcmlnZ2VyIC1EYWlseSAtQXQgNmFtClJlZ2lzdGVyLVNjaGVkdWxlZFRhc2sgLUFjdGlvbiAkYWN0aW9uIC1UcmlnZ2VyICR0cmlnZ2VyIC1UYXNrTmFtZSAiRGFpbHlVc2VyUmVwb3J0IiAtRGVzY3JpcHRpb24gIkdlbmVyYXRlcyBhIGRhaWx5IHJlcG9ydCBvZiB1c2VyIGFjdGl2aXRpZXMi"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$action = New-ScheduledTaskAction -Execute &quot;PowerShell.exe&quot; -Argument &quot;-File C:\Scripts\DailyUserReport.ps1&quot;
$trigger = New-ScheduledTaskTrigger -Daily -At 6am
Register-ScheduledTask -Action $action -Trigger $trigger -TaskName &quot;DailyUserReport&quot; -Description &quot;Generates a daily report of user activities&quot;</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>PowerShell is a powerful tool for automating Active Directory tasks. By mastering the cmdlets and techniques covered in this topic, you can significantly streamline your AD management processes. Whether you are creating users, managing groups, or automating complex workflows, PowerShell provides the flexibility and control you need to efficiently manage your Active Directory environment.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='active-directory-queries'>&#x25C4;Active Directory Queries</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Automating Active Directory Tasks with PowerShell</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-devops'>Introduction to DevOps &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
