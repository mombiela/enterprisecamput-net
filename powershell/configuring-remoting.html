<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuring Remoting</title>

    <link rel="alternate" href="https://campusempresa.com/powershell/configuring-remoting" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/powershell/configuring-remoting" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/powershell/configuring-remoting" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Building today's and tomorrow's society</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
													<b id="lit_lang_es" class="px-2">EN</b>
				|
				<a href="https://campusempresa.com/powershell/configuring-remoting" class="px-2">ES</a></b>
				|
				<a href="https://campusempresa.cat/powershell/configuring-remoting" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">The Project</a>
				<a href="/about">About Us</a>
				<a href="/contribute">Contribute</a>
				<a href="/donate">Donations</a>
				<a href="/licence">License</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-powershell-remoting'>&#x25C4;Introduction to PowerShell Remoting</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Configuring Remoting</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-invoke-command'>Using Invoke-Command &#x25BA;</a>
			</div>
</div>
<div class='content'><p>PowerShell Remoting is a powerful feature that allows you to run commands on remote systems. This topic will guide you through the process of configuring and using PowerShell Remoting, from basic setup to advanced configurations.</p>
</div><h1>Introduction to PowerShell Remoting</h1>
<div class='content'><p>PowerShell Remoting enables administrators to manage multiple systems from a single console. It uses the WS-Management protocol and can be configured to use HTTP or HTTPS for secure communication.</p>
</div><h2>Key Concepts</h2>
<div class='content'><ul>
<li><strong>WS-Management Protocol</strong>: A standard protocol for remote management.</li>
<li><strong>WinRM (Windows Remote Management)</strong>: The Microsoft implementation of WS-Management.</li>
<li><strong>Endpoints</strong>: Configurations that define what commands can be run remotely.</li>
<li><strong>Sessions</strong>: Connections to remote systems where commands are executed.</li>
</ul>
</div><h1>Enabling PowerShell Remoting</h1>
<div class='content'><p>Before you can use PowerShell Remoting, you need to enable it on the systems you want to manage.</p>
</div><h2>Enabling Remoting on a Single Machine</h2>
<div class='content'><p>To enable PowerShell Remoting on a single machine, use the <code>Enable-PSRemoting</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RW5hYmxlLVBTUmVtb3RpbmcgLUZvcmNl"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Enable-PSRemoting -Force</pre></div><div class='content'><ul>
<li><code>-Force</code>: Skips user prompts and forces the command to run.</li>
</ul>
</div><h2>Enabling Remoting on Multiple Machines</h2>
<div class='content'><p>For enabling remoting on multiple machines, you can use Group Policy or a script that runs the <code>Enable-PSRemoting</code> cmdlet on each machine.</p>
<h4>Using Group Policy</h4>
<ol>
<li>Open the Group Policy Management Console (GPMC).</li>
<li>Create a new Group Policy Object (GPO) or edit an existing one.</li>
<li>Navigate to <code>Computer Configuration -&gt; Administrative Templates -&gt; Windows Components -&gt; Windows Remote Management (WinRM) -&gt; WinRM Service</code>.</li>
<li>Enable the policy <code>Allow remote server management through WinRM</code>.</li>
</ol>
<h4>Using a Script</h4>
<p>You can use a script to enable remoting on multiple machines. Here’s an example using PowerShell:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGNvbXB1dGVycyA9IEAoIkNvbXB1dGVyMSIsICJDb21wdXRlcjIiLCAiQ29tcHV0ZXIzIikKZm9yZWFjaCAoJGNvbXB1dGVyIGluICRjb21wdXRlcnMpIHsKICAgIEludm9rZS1Db21tYW5kIC1Db21wdXRlck5hbWUgJGNvbXB1dGVyIC1TY3JpcHRCbG9jayB7CiAgICAgICAgRW5hYmxlLVBTUmVtb3RpbmcgLUZvcmNlCiAgICB9Cn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$computers = @(&quot;Computer1&quot;, &quot;Computer2&quot;, &quot;Computer3&quot;)
foreach ($computer in $computers) {
    Invoke-Command -ComputerName $computer -ScriptBlock {
        Enable-PSRemoting -Force
    }
}</pre></div><div class='content'></div><h1>Configuring Remoting for HTTPS</h1>
<div class='content'><p>For secure communication, it’s recommended to configure PowerShell Remoting to use HTTPS.</p>
</div><h2>Steps to Configure HTTPS</h2>
<div class='content'><ol>
<li><strong>Create or Obtain a Certificate</strong>: You need a certificate for the server that is trusted by the client machines.</li>
<li><strong>Configure the Listener</strong>: Use the <code>New-WSManInstance</code> cmdlet to create a new listener.</li>
</ol>
<h4>Example: Configuring HTTPS Listener</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcgSFRUUFMgbGlzdGVuZXIKJGNlcnRUaHVtYnByaW50ID0gIllPVVJfQ0VSVF9USFVNQlBSSU5UIgpOZXctV1NNYW5JbnN0YW5jZSAtUmVzb3VyY2VVUkkgd2lucm0vY29uZmlnL0xpc3RlbmVyIC1TZWxlY3RvclNldCBAe0FkZHJlc3M9IioiO1RyYW5zcG9ydD0iSFRUUFMifSAtVmFsdWVTZXQgQHtDZXJ0aWZpY2F0ZVRodW1icHJpbnQ9JGNlcnRUaHVtYnByaW50fQ=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new HTTPS listener
$certThumbprint = &quot;YOUR_CERT_THUMBPRINT&quot;
New-WSManInstance -ResourceURI winrm/config/Listener -SelectorSet @{Address=&quot;*&quot;;Transport=&quot;HTTPS&quot;} -ValueSet @{CertificateThumbprint=$certThumbprint}</pre></div><div class='content'><ul>
<li><code>CertificateThumbprint</code>: The thumbprint of the certificate you are using.</li>
</ul>
</div><h2>Verifying the Listener</h2>
<div class='content'><p>To verify that the listener is configured correctly, use the <code>Get-WSManInstance</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LVdTTWFuSW5zdGFuY2UgLVJlc291cmNlVVJJIHdpbnJtL2NvbmZpZy9MaXN0ZW5lciAtU2VsZWN0b3JTZXQgQHtBZGRyZXNzPSIqIjtUcmFuc3BvcnQ9IkhUVFBTIn0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-WSManInstance -ResourceURI winrm/config/Listener -SelectorSet @{Address=&quot;*&quot;;Transport=&quot;HTTPS&quot;}</pre></div><div class='content'></div><h1>Using PowerShell Remoting</h1>
<div class='content'><p>Once remoting is enabled and configured, you can start using it to run commands on remote systems.</p>
</div><h2>Running Commands on a Single Remote Machine</h2>
<div class='content'><p>Use the <code>Invoke-Command</code> cmdlet to run commands on a remote machine:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAiUmVtb3RlQ29tcHV0ZXIiIC1TY3JpcHRCbG9jayB7IEdldC1Qcm9jZXNzIH0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName &quot;RemoteComputer&quot; -ScriptBlock { Get-Process }</pre></div><div class='content'><ul>
<li><code>-ComputerName</code>: Specifies the remote computer.</li>
<li><code>-ScriptBlock</code>: The commands to run on the remote computer.</li>
</ul>
</div><h2>Running Commands on Multiple Remote Machines</h2>
<div class='content'><p>You can also run commands on multiple remote machines by specifying an array of computer names:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGNvbXB1dGVycyA9IEAoIkNvbXB1dGVyMSIsICJDb21wdXRlcjIiLCAiQ29tcHV0ZXIzIikKSW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAkY29tcHV0ZXJzIC1TY3JpcHRCbG9jayB7IEdldC1Qcm9jZXNzIH0="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$computers = @(&quot;Computer1&quot;, &quot;Computer2&quot;, &quot;Computer3&quot;)
Invoke-Command -ComputerName $computers -ScriptBlock { Get-Process }</pre></div><div class='content'></div><h2>Entering a Remote Session</h2>
<div class='content'><p>To enter an interactive session with a remote computer, use the <code>Enter-PSSession</code> cmdlet:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RW50ZXItUFNTZXNzaW9uIC1Db21wdXRlck5hbWUgIlJlbW90ZUNvbXB1dGVyIg=="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Enter-PSSession -ComputerName &quot;RemoteComputer&quot;</pre></div><div class='content'><ul>
<li><code>Exit-PSSession</code>: To exit the remote session, simply type <code>Exit-PSSession</code>.</li>
</ul>
</div><h1>Advanced Configurations</h1>
<div class='content'></div><h2>Customizing Endpoints</h2>
<div class='content'><p>You can create custom endpoints to control what commands and scripts can be run remotely.</p>
<h4>Example: Creating a Custom Endpoint</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGVuZHBvaW50ID0gQHsKICAgIE5hbWUgPSAiQ3VzdG9tRW5kcG9pbnQiCiAgICBDb25maWd1cmF0aW9uTmFtZSA9ICJDdXN0b21Db25maWciCiAgICBSdW5Bc1VzZXIgPSAiRG9tYWluXFVzZXIiCn0KUmVnaXN0ZXItUFNTZXNzaW9uQ29uZmlndXJhdGlvbiBAZW5kcG9pbnQ="))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$endpoint = @{
    Name = &quot;CustomEndpoint&quot;
    ConfigurationName = &quot;CustomConfig&quot;
    RunAsUser = &quot;Domain\User&quot;
}
Register-PSSessionConfiguration @endpoint</pre></div><div class='content'><ul>
<li><code>Name</code>: The name of the endpoint.</li>
<li><code>ConfigurationName</code>: The configuration to use.</li>
<li><code>RunAsUser</code>: The user account under which the commands will run.</li>
</ul>
</div><h2>Managing Sessions</h2>
<div class='content'><p>You can manage remote sessions using the <code>New-PSSession</code>, <code>Get-PSSession</code>, and <code>Remove-PSSession</code> cmdlets.</p>
<h4>Example: Creating and Managing Sessions</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhdGUgYSBuZXcgc2Vzc2lvbgokc2Vzc2lvbiA9IE5ldy1QU1Nlc3Npb24gLUNvbXB1dGVyTmFtZSAiUmVtb3RlQ29tcHV0ZXIiCgojIFJ1biBhIGNvbW1hbmQgaW4gdGhlIHNlc3Npb24KSW52b2tlLUNvbW1hbmQgLVNlc3Npb24gJHNlc3Npb24gLVNjcmlwdEJsb2NrIHsgR2V0LVByb2Nlc3MgfQoKIyBHZXQgYWxsIGFjdGl2ZSBzZXNzaW9ucwpHZXQtUFNTZXNzaW9uCgojIFJlbW92ZSB0aGUgc2Vzc2lvbgpSZW1vdmUtUFNTZXNzaW9uIC1TZXNzaW9uICRzZXNzaW9u"))));alert("Copied!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Create a new session
$session = New-PSSession -ComputerName &quot;RemoteComputer&quot;

# Run a command in the session
Invoke-Command -Session $session -ScriptBlock { Get-Process }

# Get all active sessions
Get-PSSession

# Remove the session
Remove-PSSession -Session $session</pre></div><div class='content'></div><h1>Conclusion</h1>
<div class='content'><p>Configuring PowerShell Remoting is a crucial skill for managing multiple systems efficiently. By enabling remoting, configuring secure communication, and using cmdlets to run commands and manage sessions, you can streamline administrative tasks and improve productivity. Practice these steps to become proficient in using PowerShell Remoting in your daily operations.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-powershell-remoting'>&#x25C4;Introduction to PowerShell Remoting</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Configuring Remoting</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-invoke-command'>Using Invoke-Command &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Advertising</h1>
			<p>This space is reserved for advertising.</p>
			<p>If you want to be a sponsor, contact us to include links in this area: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Thank you for collaborating!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. All rights reserved</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Accept</a>
    <a href="/cookies">More Information</a>
</div>	

	</div>    
</body>
</html>
